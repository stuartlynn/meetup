function mW(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var gW=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function rD(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lr={},yW={get exports(){return lr},set exports(t){lr=t}},Pv={},ee={},_W={get exports(){return ee},set exports(t){ee=t}},On={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lg=Symbol.for("react.element"),vW=Symbol.for("react.portal"),bW=Symbol.for("react.fragment"),xW=Symbol.for("react.strict_mode"),wW=Symbol.for("react.profiler"),EW=Symbol.for("react.provider"),TW=Symbol.for("react.context"),SW=Symbol.for("react.forward_ref"),AW=Symbol.for("react.suspense"),PW=Symbol.for("react.memo"),CW=Symbol.for("react.lazy"),RM=Symbol.iterator;function IW(t){return t===null||typeof t!="object"?null:(t=RM&&t[RM]||t["@@iterator"],typeof t=="function"?t:null)}var iD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sD=Object.assign,oD={};function yf(t,e,n){this.props=t,this.context=e,this.refs=oD,this.updater=n||iD}yf.prototype.isReactComponent={};yf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};yf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function aD(){}aD.prototype=yf.prototype;function kI(t,e,n){this.props=t,this.context=e,this.refs=oD,this.updater=n||iD}var OI=kI.prototype=new aD;OI.constructor=kI;sD(OI,yf.prototype);OI.isPureReactComponent=!0;var $M=Array.isArray,lD=Object.prototype.hasOwnProperty,DI={current:null},cD={key:!0,ref:!0,__self:!0,__source:!0};function uD(t,e,n){var r,i={},s=null,c=null;if(e!=null)for(r in e.ref!==void 0&&(c=e.ref),e.key!==void 0&&(s=""+e.key),e)lD.call(e,r)&&!cD.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var f=Array(o),m=0;m<o;m++)f[m]=arguments[m+2];i.children=f}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:lg,type:t,key:s,ref:c,props:i,_owner:DI.current}}function LW(t,e){return{$$typeof:lg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function FI(t){return typeof t=="object"&&t!==null&&t.$$typeof===lg}function RW(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var MM=/\/+/g;function F1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?RW(""+t.key):e.toString(36)}function B_(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var c=!1;if(t===null)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case lg:case vW:c=!0}}if(c)return c=t,i=i(c),t=r===""?"."+F1(c,0):r,$M(i)?(n="",t!=null&&(n=t.replace(MM,"$&/")+"/"),B_(i,e,n,"",function(m){return m})):i!=null&&(FI(i)&&(i=LW(i,n+(!i.key||c&&c.key===i.key?"":(""+i.key).replace(MM,"$&/")+"/")+t)),e.push(i)),1;if(c=0,r=r===""?".":r+":",$M(t))for(var o=0;o<t.length;o++){s=t[o];var f=r+F1(s,o);c+=B_(s,e,n,f,i)}else if(f=IW(t),typeof f=="function")for(t=f.call(t),o=0;!(s=t.next()).done;)s=s.value,f=r+F1(s,o++),c+=B_(s,e,n,f,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return c}function By(t,e,n){if(t==null)return t;var r=[],i=0;return B_(t,r,"","",function(s){return e.call(n,s,i++)}),r}function $W(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Rs={current:null},U_={transition:null},MW={ReactCurrentDispatcher:Rs,ReactCurrentBatchConfig:U_,ReactCurrentOwner:DI};On.Children={map:By,forEach:function(t,e,n){By(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return By(t,function(){e++}),e},toArray:function(t){return By(t,function(e){return e})||[]},only:function(t){if(!FI(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};On.Component=yf;On.Fragment=bW;On.Profiler=wW;On.PureComponent=kI;On.StrictMode=xW;On.Suspense=AW;On.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MW;On.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=sD({},t.props),i=t.key,s=t.ref,c=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,c=DI.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(f in e)lD.call(e,f)&&!cD.hasOwnProperty(f)&&(r[f]=e[f]===void 0&&o!==void 0?o[f]:e[f])}var f=arguments.length-2;if(f===1)r.children=n;else if(1<f){o=Array(f);for(var m=0;m<f;m++)o[m]=arguments[m+2];r.children=o}return{$$typeof:lg,type:t.type,key:i,ref:s,props:r,_owner:c}};On.createContext=function(t){return t={$$typeof:TW,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:EW,_context:t},t.Consumer=t};On.createElement=uD;On.createFactory=function(t){var e=uD.bind(null,t);return e.type=t,e};On.createRef=function(){return{current:null}};On.forwardRef=function(t){return{$$typeof:SW,render:t}};On.isValidElement=FI;On.lazy=function(t){return{$$typeof:CW,_payload:{_status:-1,_result:t},_init:$W}};On.memo=function(t,e){return{$$typeof:PW,type:t,compare:e===void 0?null:e}};On.startTransition=function(t){var e=U_.transition;U_.transition={};try{t()}finally{U_.transition=e}};On.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};On.useCallback=function(t,e){return Rs.current.useCallback(t,e)};On.useContext=function(t){return Rs.current.useContext(t)};On.useDebugValue=function(){};On.useDeferredValue=function(t){return Rs.current.useDeferredValue(t)};On.useEffect=function(t,e){return Rs.current.useEffect(t,e)};On.useId=function(){return Rs.current.useId()};On.useImperativeHandle=function(t,e,n){return Rs.current.useImperativeHandle(t,e,n)};On.useInsertionEffect=function(t,e){return Rs.current.useInsertionEffect(t,e)};On.useLayoutEffect=function(t,e){return Rs.current.useLayoutEffect(t,e)};On.useMemo=function(t,e){return Rs.current.useMemo(t,e)};On.useReducer=function(t,e,n){return Rs.current.useReducer(t,e,n)};On.useRef=function(t){return Rs.current.useRef(t)};On.useState=function(t){return Rs.current.useState(t)};On.useSyncExternalStore=function(t,e,n){return Rs.current.useSyncExternalStore(t,e,n)};On.useTransition=function(){return Rs.current.useTransition()};On.version="18.2.0";(function(t){t.exports=On})(_W);const ce=rD(ee);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kW=ee,OW=Symbol.for("react.element"),DW=Symbol.for("react.fragment"),FW=Object.prototype.hasOwnProperty,zW=kW.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,NW={key:!0,ref:!0,__self:!0,__source:!0};function dD(t,e,n){var r,i={},s=null,c=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(c=e.ref);for(r in e)FW.call(e,r)&&!NW.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:OW,type:t,key:s,ref:c,props:i,_owner:zW.current}}Pv.Fragment=DW;Pv.jsx=dD;Pv.jsxs=dD;(function(t){t.exports=Pv})(yW);var Fw={},Gu={},BW={get exports(){return Gu},set exports(t){Gu=t}},Eo={},zw={},UW={get exports(){return zw},set exports(t){zw=t}},hD={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ot,It){var at=ot.length;ot.push(It);e:for(;0<at;){var kt=at-1>>>1,Pe=ot[kt];if(0<i(Pe,It))ot[kt]=It,ot[at]=Pe,at=kt;else break e}}function n(ot){return ot.length===0?null:ot[0]}function r(ot){if(ot.length===0)return null;var It=ot[0],at=ot.pop();if(at!==It){ot[0]=at;e:for(var kt=0,Pe=ot.length,Ke=Pe>>>1;kt<Ke;){var Je=2*(kt+1)-1,Ot=ot[Je],ht=Je+1,Ct=ot[ht];if(0>i(Ot,at))ht<Pe&&0>i(Ct,Ot)?(ot[kt]=Ct,ot[ht]=at,kt=ht):(ot[kt]=Ot,ot[Je]=at,kt=Je);else if(ht<Pe&&0>i(Ct,at))ot[kt]=Ct,ot[ht]=at,kt=ht;else break e}}return It}function i(ot,It){var at=ot.sortIndex-It.sortIndex;return at!==0?at:ot.id-It.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var c=Date,o=c.now();t.unstable_now=function(){return c.now()-o}}var f=[],m=[],x=1,S=null,T=3,C=!1,R=!1,D=!1,H=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(ot){for(var It=n(m);It!==null;){if(It.callback===null)r(m);else if(It.startTime<=ot)r(m),It.sortIndex=It.expirationTime,e(f,It);else break;It=n(m)}}function U(ot){if(D=!1,N(ot),!R)if(n(f)!==null)R=!0,mt(ie);else{var It=n(m);It!==null&&an(U,It.startTime-ot)}}function ie(ot,It){R=!1,D&&(D=!1,F(ve),ve=-1),C=!0;var at=T;try{for(N(It),S=n(f);S!==null&&(!(S.expirationTime>It)||ot&&!Ee());){var kt=S.callback;if(typeof kt=="function"){S.callback=null,T=S.priorityLevel;var Pe=kt(S.expirationTime<=It);It=t.unstable_now(),typeof Pe=="function"?S.callback=Pe:S===n(f)&&r(f),N(It)}else r(f);S=n(f)}if(S!==null)var Ke=!0;else{var Je=n(m);Je!==null&&an(U,Je.startTime-It),Ke=!1}return Ke}finally{S=null,T=at,C=!1}}var he=!1,le=null,ve=-1,Oe=5,Re=-1;function Ee(){return!(t.unstable_now()-Re<Oe)}function $e(){if(le!==null){var ot=t.unstable_now();Re=ot;var It=!0;try{It=le(!0,ot)}finally{It?we():(he=!1,le=null)}}else he=!1}var we;if(typeof k=="function")we=function(){k($e)};else if(typeof MessageChannel<"u"){var Be=new MessageChannel,Jt=Be.port2;Be.port1.onmessage=$e,we=function(){Jt.postMessage(null)}}else we=function(){H($e,0)};function mt(ot){le=ot,he||(he=!0,we())}function an(ot,It){ve=H(function(){ot(t.unstable_now())},It)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ot){ot.callback=null},t.unstable_continueExecution=function(){R||C||(R=!0,mt(ie))},t.unstable_forceFrameRate=function(ot){0>ot||125<ot?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Oe=0<ot?Math.floor(1e3/ot):5},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_getFirstCallbackNode=function(){return n(f)},t.unstable_next=function(ot){switch(T){case 1:case 2:case 3:var It=3;break;default:It=T}var at=T;T=It;try{return ot()}finally{T=at}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ot,It){switch(ot){case 1:case 2:case 3:case 4:case 5:break;default:ot=3}var at=T;T=ot;try{return It()}finally{T=at}},t.unstable_scheduleCallback=function(ot,It,at){var kt=t.unstable_now();switch(typeof at=="object"&&at!==null?(at=at.delay,at=typeof at=="number"&&0<at?kt+at:kt):at=kt,ot){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=at+Pe,ot={id:x++,callback:It,priorityLevel:ot,startTime:at,expirationTime:Pe,sortIndex:-1},at>kt?(ot.sortIndex=at,e(m,ot),n(f)===null&&ot===n(m)&&(D?(F(ve),ve=-1):D=!0,an(U,at-kt))):(ot.sortIndex=Pe,e(f,ot),R||C||(R=!0,mt(ie))),ot},t.unstable_shouldYield=Ee,t.unstable_wrapCallback=function(ot){var It=T;return function(){var at=T;T=It;try{return ot.apply(this,arguments)}finally{T=at}}}})(hD);(function(t){t.exports=hD})(UW);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fD=ee,bo=zw;function ct(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pD=new Set,Cm={};function ld(t,e){jh(t,e),jh(t+"Capture",e)}function jh(t,e){for(Cm[t]=e,t=0;t<e.length;t++)pD.add(e[t])}var Pl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nw=Object.prototype.hasOwnProperty,VW=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,kM={},OM={};function GW(t){return Nw.call(OM,t)?!0:Nw.call(kM,t)?!1:VW.test(t)?OM[t]=!0:(kM[t]=!0,!1)}function jW(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function HW(t,e,n,r){if(e===null||typeof e>"u"||jW(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function $s(t,e,n,r,i,s,c){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=c}var Ji={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ji[t]=new $s(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ji[e]=new $s(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ji[t]=new $s(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ji[t]=new $s(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ji[t]=new $s(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ji[t]=new $s(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ji[t]=new $s(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ji[t]=new $s(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ji[t]=new $s(t,5,!1,t.toLowerCase(),null,!1,!1)});var zI=/[\-:]([a-z])/g;function NI(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(zI,NI);Ji[e]=new $s(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(zI,NI);Ji[e]=new $s(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(zI,NI);Ji[e]=new $s(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ji[t]=new $s(t,1,!1,t.toLowerCase(),null,!1,!1)});Ji.xlinkHref=new $s("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ji[t]=new $s(t,1,!1,t.toLowerCase(),null,!0,!0)});function BI(t,e,n,r){var i=Ji.hasOwnProperty(e)?Ji[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(HW(e,n,i,r)&&(n=null),r||i===null?GW(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var kl=fD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Uy=Symbol.for("react.element"),ph=Symbol.for("react.portal"),mh=Symbol.for("react.fragment"),UI=Symbol.for("react.strict_mode"),Bw=Symbol.for("react.profiler"),mD=Symbol.for("react.provider"),gD=Symbol.for("react.context"),VI=Symbol.for("react.forward_ref"),Uw=Symbol.for("react.suspense"),Vw=Symbol.for("react.suspense_list"),GI=Symbol.for("react.memo"),mc=Symbol.for("react.lazy"),yD=Symbol.for("react.offscreen"),DM=Symbol.iterator;function xp(t){return t===null||typeof t!="object"?null:(t=DM&&t[DM]||t["@@iterator"],typeof t=="function"?t:null)}var Kr=Object.assign,z1;function Xp(t){if(z1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);z1=e&&e[1]||""}return`
`+z1+t}var N1=!1;function B1(t,e){if(!t||N1)return"";N1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(m){var r=m}Reflect.construct(t,[],e)}else{try{e.call()}catch(m){r=m}t.call(e.prototype)}else{try{throw Error()}catch(m){r=m}t()}}catch(m){if(m&&r&&typeof m.stack=="string"){for(var i=m.stack.split(`
`),s=r.stack.split(`
`),c=i.length-1,o=s.length-1;1<=c&&0<=o&&i[c]!==s[o];)o--;for(;1<=c&&0<=o;c--,o--)if(i[c]!==s[o]){if(c!==1||o!==1)do if(c--,o--,0>o||i[c]!==s[o]){var f=`
`+i[c].replace(" at new "," at ");return t.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",t.displayName)),f}while(1<=c&&0<=o);break}}}finally{N1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xp(t):""}function WW(t){switch(t.tag){case 5:return Xp(t.type);case 16:return Xp("Lazy");case 13:return Xp("Suspense");case 19:return Xp("SuspenseList");case 0:case 2:case 15:return t=B1(t.type,!1),t;case 11:return t=B1(t.type.render,!1),t;case 1:return t=B1(t.type,!0),t;default:return""}}function Gw(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case mh:return"Fragment";case ph:return"Portal";case Bw:return"Profiler";case UI:return"StrictMode";case Uw:return"Suspense";case Vw:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gD:return(t.displayName||"Context")+".Consumer";case mD:return(t._context.displayName||"Context")+".Provider";case VI:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case GI:return e=t.displayName||null,e!==null?e:Gw(t.type)||"Memo";case mc:e=t._payload,t=t._init;try{return Gw(t(e))}catch{}}return null}function KW(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gw(e);case 8:return e===UI?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Nc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _D(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function qW(t){var e=_D(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(c){r=""+c,s.call(this,c)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(c){r=""+c},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Vy(t){t._valueTracker||(t._valueTracker=qW(t))}function vD(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_D(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function g0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function jw(t,e){var n=e.checked;return Kr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function FM(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Nc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bD(t,e){e=e.checked,e!=null&&BI(t,"checked",e,!1)}function Hw(t,e){bD(t,e);var n=Nc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ww(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ww(t,e.type,Nc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function zM(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ww(t,e,n){(e!=="number"||g0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Zp=Array.isArray;function Rh(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Nc(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Kw(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ct(91));return Kr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function NM(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ct(92));if(Zp(n)){if(1<n.length)throw Error(ct(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Nc(n)}}function xD(t,e){var n=Nc(e.value),r=Nc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function BM(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function wD(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qw(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?wD(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Gy,ED=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Gy=Gy||document.createElement("div"),Gy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gy.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Im(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var lm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},XW=["Webkit","ms","Moz","O"];Object.keys(lm).forEach(function(t){XW.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),lm[e]=lm[t]})});function TD(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||lm.hasOwnProperty(t)&&lm[t]?(""+e).trim():e+"px"}function SD(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=TD(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var ZW=Kr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xw(t,e){if(e){if(ZW[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ct(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ct(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ct(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ct(62))}}function Zw(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yw=null;function jI(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Jw=null,$h=null,Mh=null;function UM(t){if(t=dg(t)){if(typeof Jw!="function")throw Error(ct(280));var e=t.stateNode;e&&(e=$v(e),Jw(t.stateNode,t.type,e))}}function AD(t){$h?Mh?Mh.push(t):Mh=[t]:$h=t}function PD(){if($h){var t=$h,e=Mh;if(Mh=$h=null,UM(t),e)for(t=0;t<e.length;t++)UM(e[t])}}function CD(t,e){return t(e)}function ID(){}var U1=!1;function LD(t,e,n){if(U1)return t(e,n);U1=!0;try{return CD(t,e,n)}finally{U1=!1,($h!==null||Mh!==null)&&(ID(),PD())}}function Lm(t,e){var n=t.stateNode;if(n===null)return null;var r=$v(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ct(231,e,typeof n));return n}var Qw=!1;if(Pl)try{var wp={};Object.defineProperty(wp,"passive",{get:function(){Qw=!0}}),window.addEventListener("test",wp,wp),window.removeEventListener("test",wp,wp)}catch{Qw=!1}function YW(t,e,n,r,i,s,c,o,f){var m=Array.prototype.slice.call(arguments,3);try{e.apply(n,m)}catch(x){this.onError(x)}}var cm=!1,y0=null,_0=!1,e2=null,JW={onError:function(t){cm=!0,y0=t}};function QW(t,e,n,r,i,s,c,o,f){cm=!1,y0=null,YW.apply(JW,arguments)}function eK(t,e,n,r,i,s,c,o,f){if(QW.apply(this,arguments),cm){if(cm){var m=y0;cm=!1,y0=null}else throw Error(ct(198));_0||(_0=!0,e2=m)}}function cd(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function RD(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function VM(t){if(cd(t)!==t)throw Error(ct(188))}function tK(t){var e=t.alternate;if(!e){if(e=cd(t),e===null)throw Error(ct(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return VM(i),t;if(s===r)return VM(i),e;s=s.sibling}throw Error(ct(188))}if(n.return!==r.return)n=i,r=s;else{for(var c=!1,o=i.child;o;){if(o===n){c=!0,n=i,r=s;break}if(o===r){c=!0,r=i,n=s;break}o=o.sibling}if(!c){for(o=s.child;o;){if(o===n){c=!0,n=s,r=i;break}if(o===r){c=!0,r=s,n=i;break}o=o.sibling}if(!c)throw Error(ct(189))}}if(n.alternate!==r)throw Error(ct(190))}if(n.tag!==3)throw Error(ct(188));return n.stateNode.current===n?t:e}function $D(t){return t=tK(t),t!==null?MD(t):null}function MD(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=MD(t);if(e!==null)return e;t=t.sibling}return null}var kD=bo.unstable_scheduleCallback,GM=bo.unstable_cancelCallback,nK=bo.unstable_shouldYield,rK=bo.unstable_requestPaint,ci=bo.unstable_now,iK=bo.unstable_getCurrentPriorityLevel,HI=bo.unstable_ImmediatePriority,OD=bo.unstable_UserBlockingPriority,v0=bo.unstable_NormalPriority,sK=bo.unstable_LowPriority,DD=bo.unstable_IdlePriority,Cv=null,Ua=null;function oK(t){if(Ua&&typeof Ua.onCommitFiberRoot=="function")try{Ua.onCommitFiberRoot(Cv,t,void 0,(t.current.flags&128)===128)}catch{}}var ca=Math.clz32?Math.clz32:cK,aK=Math.log,lK=Math.LN2;function cK(t){return t>>>=0,t===0?32:31-(aK(t)/lK|0)|0}var jy=64,Hy=4194304;function Yp(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function b0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,c=n&268435455;if(c!==0){var o=c&~i;o!==0?r=Yp(o):(s&=c,s!==0&&(r=Yp(s)))}else c=n&~i,c!==0?r=Yp(c):s!==0&&(r=Yp(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ca(e),i=1<<n,r|=t[n],e&=~i;return r}function uK(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dK(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var c=31-ca(s),o=1<<c,f=i[c];f===-1?(!(o&n)||o&r)&&(i[c]=uK(o,e)):f<=e&&(t.expiredLanes|=o),s&=~o}}function t2(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function FD(){var t=jy;return jy<<=1,!(jy&4194240)&&(jy=64),t}function V1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function cg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ca(e),t[e]=n}function hK(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ca(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function WI(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ca(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var sr=0;function zD(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ND,KI,BD,UD,VD,n2=!1,Wy=[],Pc=null,Cc=null,Ic=null,Rm=new Map,$m=new Map,vc=[],fK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jM(t,e){switch(t){case"focusin":case"focusout":Pc=null;break;case"dragenter":case"dragleave":Cc=null;break;case"mouseover":case"mouseout":Ic=null;break;case"pointerover":case"pointerout":Rm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$m.delete(e.pointerId)}}function Ep(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=dg(e),e!==null&&KI(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function pK(t,e,n,r,i){switch(e){case"focusin":return Pc=Ep(Pc,t,e,n,r,i),!0;case"dragenter":return Cc=Ep(Cc,t,e,n,r,i),!0;case"mouseover":return Ic=Ep(Ic,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Rm.set(s,Ep(Rm.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,$m.set(s,Ep($m.get(s)||null,t,e,n,r,i)),!0}return!1}function GD(t){var e=Ou(t.target);if(e!==null){var n=cd(e);if(n!==null){if(e=n.tag,e===13){if(e=RD(n),e!==null){t.blockedOn=e,VD(t.priority,function(){BD(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function V_(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=r2(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Yw=r,n.target.dispatchEvent(r),Yw=null}else return e=dg(n),e!==null&&KI(e),t.blockedOn=n,!1;e.shift()}return!0}function HM(t,e,n){V_(t)&&n.delete(e)}function mK(){n2=!1,Pc!==null&&V_(Pc)&&(Pc=null),Cc!==null&&V_(Cc)&&(Cc=null),Ic!==null&&V_(Ic)&&(Ic=null),Rm.forEach(HM),$m.forEach(HM)}function Tp(t,e){t.blockedOn===e&&(t.blockedOn=null,n2||(n2=!0,bo.unstable_scheduleCallback(bo.unstable_NormalPriority,mK)))}function Mm(t){function e(i){return Tp(i,t)}if(0<Wy.length){Tp(Wy[0],t);for(var n=1;n<Wy.length;n++){var r=Wy[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Pc!==null&&Tp(Pc,t),Cc!==null&&Tp(Cc,t),Ic!==null&&Tp(Ic,t),Rm.forEach(e),$m.forEach(e),n=0;n<vc.length;n++)r=vc[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<vc.length&&(n=vc[0],n.blockedOn===null);)GD(n),n.blockedOn===null&&vc.shift()}var kh=kl.ReactCurrentBatchConfig,x0=!0;function gK(t,e,n,r){var i=sr,s=kh.transition;kh.transition=null;try{sr=1,qI(t,e,n,r)}finally{sr=i,kh.transition=s}}function yK(t,e,n,r){var i=sr,s=kh.transition;kh.transition=null;try{sr=4,qI(t,e,n,r)}finally{sr=i,kh.transition=s}}function qI(t,e,n,r){if(x0){var i=r2(t,e,n,r);if(i===null)J1(t,e,r,w0,n),jM(t,r);else if(pK(i,t,e,n,r))r.stopPropagation();else if(jM(t,r),e&4&&-1<fK.indexOf(t)){for(;i!==null;){var s=dg(i);if(s!==null&&ND(s),s=r2(t,e,n,r),s===null&&J1(t,e,r,w0,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else J1(t,e,r,null,n)}}var w0=null;function r2(t,e,n,r){if(w0=null,t=jI(r),t=Ou(t),t!==null)if(e=cd(t),e===null)t=null;else if(n=e.tag,n===13){if(t=RD(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return w0=t,null}function jD(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(iK()){case HI:return 1;case OD:return 4;case v0:case sK:return 16;case DD:return 536870912;default:return 16}default:return 16}}var wc=null,XI=null,G_=null;function HD(){if(G_)return G_;var t,e=XI,n=e.length,r,i="value"in wc?wc.value:wc.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var c=n-t;for(r=1;r<=c&&e[n-r]===i[s-r];r++);return G_=i.slice(t,1<r?1-r:void 0)}function j_(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ky(){return!0}function WM(){return!1}function To(t){function e(n,r,i,s,c){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=c,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ky:WM,this.isPropagationStopped=WM,this}return Kr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ky)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ky)},persist:function(){},isPersistent:Ky}),e}var _f={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ZI=To(_f),ug=Kr({},_f,{view:0,detail:0}),_K=To(ug),G1,j1,Sp,Iv=Kr({},ug,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:YI,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Sp&&(Sp&&t.type==="mousemove"?(G1=t.screenX-Sp.screenX,j1=t.screenY-Sp.screenY):j1=G1=0,Sp=t),G1)},movementY:function(t){return"movementY"in t?t.movementY:j1}}),KM=To(Iv),vK=Kr({},Iv,{dataTransfer:0}),bK=To(vK),xK=Kr({},ug,{relatedTarget:0}),H1=To(xK),wK=Kr({},_f,{animationName:0,elapsedTime:0,pseudoElement:0}),EK=To(wK),TK=Kr({},_f,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),SK=To(TK),AK=Kr({},_f,{data:0}),qM=To(AK),PK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},CK={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IK={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function LK(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=IK[t])?!!e[t]:!1}function YI(){return LK}var RK=Kr({},ug,{key:function(t){if(t.key){var e=PK[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=j_(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?CK[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:YI,charCode:function(t){return t.type==="keypress"?j_(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?j_(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$K=To(RK),MK=Kr({},Iv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),XM=To(MK),kK=Kr({},ug,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:YI}),OK=To(kK),DK=Kr({},_f,{propertyName:0,elapsedTime:0,pseudoElement:0}),FK=To(DK),zK=Kr({},Iv,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),NK=To(zK),BK=[9,13,27,32],JI=Pl&&"CompositionEvent"in window,um=null;Pl&&"documentMode"in document&&(um=document.documentMode);var UK=Pl&&"TextEvent"in window&&!um,WD=Pl&&(!JI||um&&8<um&&11>=um),ZM=String.fromCharCode(32),YM=!1;function KD(t,e){switch(t){case"keyup":return BK.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qD(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var gh=!1;function VK(t,e){switch(t){case"compositionend":return qD(e);case"keypress":return e.which!==32?null:(YM=!0,ZM);case"textInput":return t=e.data,t===ZM&&YM?null:t;default:return null}}function GK(t,e){if(gh)return t==="compositionend"||!JI&&KD(t,e)?(t=HD(),G_=XI=wc=null,gh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return WD&&e.locale!=="ko"?null:e.data;default:return null}}var jK={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function JM(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!jK[t.type]:e==="textarea"}function XD(t,e,n,r){AD(r),e=E0(e,"onChange"),0<e.length&&(n=new ZI("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var dm=null,km=null;function HK(t){oF(t,0)}function Lv(t){var e=vh(t);if(vD(e))return t}function WK(t,e){if(t==="change")return e}var ZD=!1;if(Pl){var W1;if(Pl){var K1="oninput"in document;if(!K1){var QM=document.createElement("div");QM.setAttribute("oninput","return;"),K1=typeof QM.oninput=="function"}W1=K1}else W1=!1;ZD=W1&&(!document.documentMode||9<document.documentMode)}function e4(){dm&&(dm.detachEvent("onpropertychange",YD),km=dm=null)}function YD(t){if(t.propertyName==="value"&&Lv(km)){var e=[];XD(e,km,t,jI(t)),LD(HK,e)}}function KK(t,e,n){t==="focusin"?(e4(),dm=e,km=n,dm.attachEvent("onpropertychange",YD)):t==="focusout"&&e4()}function qK(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Lv(km)}function XK(t,e){if(t==="click")return Lv(e)}function ZK(t,e){if(t==="input"||t==="change")return Lv(e)}function YK(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ha=typeof Object.is=="function"?Object.is:YK;function Om(t,e){if(ha(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Nw.call(e,i)||!ha(t[i],e[i]))return!1}return!0}function t4(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function n4(t,e){var n=t4(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=t4(n)}}function JD(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?JD(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function QD(){for(var t=window,e=g0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=g0(t.document)}return e}function QI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function JK(t){var e=QD(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&JD(n.ownerDocument.documentElement,n)){if(r!==null&&QI(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=n4(n,s);var c=n4(n,r);i&&c&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==c.node||t.focusOffset!==c.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(c.node,c.offset)):(e.setEnd(c.node,c.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var QK=Pl&&"documentMode"in document&&11>=document.documentMode,yh=null,i2=null,hm=null,s2=!1;function r4(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;s2||yh==null||yh!==g0(r)||(r=yh,"selectionStart"in r&&QI(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),hm&&Om(hm,r)||(hm=r,r=E0(i2,"onSelect"),0<r.length&&(e=new ZI("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=yh)))}function qy(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var _h={animationend:qy("Animation","AnimationEnd"),animationiteration:qy("Animation","AnimationIteration"),animationstart:qy("Animation","AnimationStart"),transitionend:qy("Transition","TransitionEnd")},q1={},eF={};Pl&&(eF=document.createElement("div").style,"AnimationEvent"in window||(delete _h.animationend.animation,delete _h.animationiteration.animation,delete _h.animationstart.animation),"TransitionEvent"in window||delete _h.transitionend.transition);function Rv(t){if(q1[t])return q1[t];if(!_h[t])return t;var e=_h[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in eF)return q1[t]=e[n];return t}var tF=Rv("animationend"),nF=Rv("animationiteration"),rF=Rv("animationstart"),iF=Rv("transitionend"),sF=new Map,i4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vc(t,e){sF.set(t,e),ld(e,[t])}for(var X1=0;X1<i4.length;X1++){var Z1=i4[X1],eq=Z1.toLowerCase(),tq=Z1[0].toUpperCase()+Z1.slice(1);Vc(eq,"on"+tq)}Vc(tF,"onAnimationEnd");Vc(nF,"onAnimationIteration");Vc(rF,"onAnimationStart");Vc("dblclick","onDoubleClick");Vc("focusin","onFocus");Vc("focusout","onBlur");Vc(iF,"onTransitionEnd");jh("onMouseEnter",["mouseout","mouseover"]);jh("onMouseLeave",["mouseout","mouseover"]);jh("onPointerEnter",["pointerout","pointerover"]);jh("onPointerLeave",["pointerout","pointerover"]);ld("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ld("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ld("onBeforeInput",["compositionend","keypress","textInput","paste"]);ld("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ld("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ld("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nq=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jp));function s4(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,eK(r,e,void 0,t),t.currentTarget=null}function oF(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var c=r.length-1;0<=c;c--){var o=r[c],f=o.instance,m=o.currentTarget;if(o=o.listener,f!==s&&i.isPropagationStopped())break e;s4(i,o,m),s=f}else for(c=0;c<r.length;c++){if(o=r[c],f=o.instance,m=o.currentTarget,o=o.listener,f!==s&&i.isPropagationStopped())break e;s4(i,o,m),s=f}}}if(_0)throw t=e2,_0=!1,e2=null,t}function Ar(t,e){var n=e[u2];n===void 0&&(n=e[u2]=new Set);var r=t+"__bubble";n.has(r)||(aF(e,t,2,!1),n.add(r))}function Y1(t,e,n){var r=0;e&&(r|=4),aF(n,t,r,e)}var Xy="_reactListening"+Math.random().toString(36).slice(2);function Dm(t){if(!t[Xy]){t[Xy]=!0,pD.forEach(function(n){n!=="selectionchange"&&(nq.has(n)||Y1(n,!1,t),Y1(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Xy]||(e[Xy]=!0,Y1("selectionchange",!1,e))}}function aF(t,e,n,r){switch(jD(e)){case 1:var i=gK;break;case 4:i=yK;break;default:i=qI}n=i.bind(null,e,n,t),i=void 0,!Qw||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function J1(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var c=r.tag;if(c===3||c===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(c===4)for(c=r.return;c!==null;){var f=c.tag;if((f===3||f===4)&&(f=c.stateNode.containerInfo,f===i||f.nodeType===8&&f.parentNode===i))return;c=c.return}for(;o!==null;){if(c=Ou(o),c===null)return;if(f=c.tag,f===5||f===6){r=s=c;continue e}o=o.parentNode}}r=r.return}LD(function(){var m=s,x=jI(n),S=[];e:{var T=sF.get(t);if(T!==void 0){var C=ZI,R=t;switch(t){case"keypress":if(j_(n)===0)break e;case"keydown":case"keyup":C=$K;break;case"focusin":R="focus",C=H1;break;case"focusout":R="blur",C=H1;break;case"beforeblur":case"afterblur":C=H1;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":C=KM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":C=bK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":C=OK;break;case tF:case nF:case rF:C=EK;break;case iF:C=FK;break;case"scroll":C=_K;break;case"wheel":C=NK;break;case"copy":case"cut":case"paste":C=SK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":C=XM}var D=(e&4)!==0,H=!D&&t==="scroll",F=D?T!==null?T+"Capture":null:T;D=[];for(var k=m,N;k!==null;){N=k;var U=N.stateNode;if(N.tag===5&&U!==null&&(N=U,F!==null&&(U=Lm(k,F),U!=null&&D.push(Fm(k,U,N)))),H)break;k=k.return}0<D.length&&(T=new C(T,R,null,n,x),S.push({event:T,listeners:D}))}}if(!(e&7)){e:{if(T=t==="mouseover"||t==="pointerover",C=t==="mouseout"||t==="pointerout",T&&n!==Yw&&(R=n.relatedTarget||n.fromElement)&&(Ou(R)||R[Cl]))break e;if((C||T)&&(T=x.window===x?x:(T=x.ownerDocument)?T.defaultView||T.parentWindow:window,C?(R=n.relatedTarget||n.toElement,C=m,R=R?Ou(R):null,R!==null&&(H=cd(R),R!==H||R.tag!==5&&R.tag!==6)&&(R=null)):(C=null,R=m),C!==R)){if(D=KM,U="onMouseLeave",F="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(D=XM,U="onPointerLeave",F="onPointerEnter",k="pointer"),H=C==null?T:vh(C),N=R==null?T:vh(R),T=new D(U,k+"leave",C,n,x),T.target=H,T.relatedTarget=N,U=null,Ou(x)===m&&(D=new D(F,k+"enter",R,n,x),D.target=N,D.relatedTarget=H,U=D),H=U,C&&R)t:{for(D=C,F=R,k=0,N=D;N;N=Hd(N))k++;for(N=0,U=F;U;U=Hd(U))N++;for(;0<k-N;)D=Hd(D),k--;for(;0<N-k;)F=Hd(F),N--;for(;k--;){if(D===F||F!==null&&D===F.alternate)break t;D=Hd(D),F=Hd(F)}D=null}else D=null;C!==null&&o4(S,T,C,D,!1),R!==null&&H!==null&&o4(S,H,R,D,!0)}}e:{if(T=m?vh(m):window,C=T.nodeName&&T.nodeName.toLowerCase(),C==="select"||C==="input"&&T.type==="file")var ie=WK;else if(JM(T))if(ZD)ie=ZK;else{ie=qK;var he=KK}else(C=T.nodeName)&&C.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(ie=XK);if(ie&&(ie=ie(t,m))){XD(S,ie,n,x);break e}he&&he(t,T,m),t==="focusout"&&(he=T._wrapperState)&&he.controlled&&T.type==="number"&&Ww(T,"number",T.value)}switch(he=m?vh(m):window,t){case"focusin":(JM(he)||he.contentEditable==="true")&&(yh=he,i2=m,hm=null);break;case"focusout":hm=i2=yh=null;break;case"mousedown":s2=!0;break;case"contextmenu":case"mouseup":case"dragend":s2=!1,r4(S,n,x);break;case"selectionchange":if(QK)break;case"keydown":case"keyup":r4(S,n,x)}var le;if(JI)e:{switch(t){case"compositionstart":var ve="onCompositionStart";break e;case"compositionend":ve="onCompositionEnd";break e;case"compositionupdate":ve="onCompositionUpdate";break e}ve=void 0}else gh?KD(t,n)&&(ve="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ve="onCompositionStart");ve&&(WD&&n.locale!=="ko"&&(gh||ve!=="onCompositionStart"?ve==="onCompositionEnd"&&gh&&(le=HD()):(wc=x,XI="value"in wc?wc.value:wc.textContent,gh=!0)),he=E0(m,ve),0<he.length&&(ve=new qM(ve,t,null,n,x),S.push({event:ve,listeners:he}),le?ve.data=le:(le=qD(n),le!==null&&(ve.data=le)))),(le=UK?VK(t,n):GK(t,n))&&(m=E0(m,"onBeforeInput"),0<m.length&&(x=new qM("onBeforeInput","beforeinput",null,n,x),S.push({event:x,listeners:m}),x.data=le))}oF(S,e)})}function Fm(t,e,n){return{instance:t,listener:e,currentTarget:n}}function E0(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Lm(t,n),s!=null&&r.unshift(Fm(t,s,i)),s=Lm(t,e),s!=null&&r.push(Fm(t,s,i))),t=t.return}return r}function Hd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function o4(t,e,n,r,i){for(var s=e._reactName,c=[];n!==null&&n!==r;){var o=n,f=o.alternate,m=o.stateNode;if(f!==null&&f===r)break;o.tag===5&&m!==null&&(o=m,i?(f=Lm(n,s),f!=null&&c.unshift(Fm(n,f,o))):i||(f=Lm(n,s),f!=null&&c.push(Fm(n,f,o)))),n=n.return}c.length!==0&&t.push({event:e,listeners:c})}var rq=/\r\n?/g,iq=/\u0000|\uFFFD/g;function a4(t){return(typeof t=="string"?t:""+t).replace(rq,`
`).replace(iq,"")}function Zy(t,e,n){if(e=a4(e),a4(t)!==e&&n)throw Error(ct(425))}function T0(){}var o2=null,a2=null;function l2(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var c2=typeof setTimeout=="function"?setTimeout:void 0,sq=typeof clearTimeout=="function"?clearTimeout:void 0,l4=typeof Promise=="function"?Promise:void 0,oq=typeof queueMicrotask=="function"?queueMicrotask:typeof l4<"u"?function(t){return l4.resolve(null).then(t).catch(aq)}:c2;function aq(t){setTimeout(function(){throw t})}function Q1(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Mm(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Mm(e)}function Lc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function c4(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var vf=Math.random().toString(36).slice(2),Da="__reactFiber$"+vf,zm="__reactProps$"+vf,Cl="__reactContainer$"+vf,u2="__reactEvents$"+vf,lq="__reactListeners$"+vf,cq="__reactHandles$"+vf;function Ou(t){var e=t[Da];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Cl]||n[Da]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=c4(t);t!==null;){if(n=t[Da])return n;t=c4(t)}return e}t=n,n=t.parentNode}return null}function dg(t){return t=t[Da]||t[Cl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function vh(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ct(33))}function $v(t){return t[zm]||null}var d2=[],bh=-1;function Gc(t){return{current:t}}function $r(t){0>bh||(t.current=d2[bh],d2[bh]=null,bh--)}function xr(t,e){bh++,d2[bh]=t.current,t.current=e}var Bc={},fs=Gc(Bc),js=Gc(!1),ju=Bc;function Hh(t,e){var n=t.type.contextTypes;if(!n)return Bc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Hs(t){return t=t.childContextTypes,t!=null}function S0(){$r(js),$r(fs)}function u4(t,e,n){if(fs.current!==Bc)throw Error(ct(168));xr(fs,e),xr(js,n)}function lF(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ct(108,KW(t)||"Unknown",i));return Kr({},n,r)}function A0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Bc,ju=fs.current,xr(fs,t),xr(js,js.current),!0}function d4(t,e,n){var r=t.stateNode;if(!r)throw Error(ct(169));n?(t=lF(t,e,ju),r.__reactInternalMemoizedMergedChildContext=t,$r(js),$r(fs),xr(fs,t)):$r(js),xr(js,n)}var yl=null,Mv=!1,ex=!1;function cF(t){yl===null?yl=[t]:yl.push(t)}function uq(t){Mv=!0,cF(t)}function jc(){if(!ex&&yl!==null){ex=!0;var t=0,e=sr;try{var n=yl;for(sr=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}yl=null,Mv=!1}catch(i){throw yl!==null&&(yl=yl.slice(t+1)),kD(HI,jc),i}finally{sr=e,ex=!1}}return null}var xh=[],wh=0,P0=null,C0=0,Fo=[],zo=0,Hu=null,bl=1,xl="";function Pu(t,e){xh[wh++]=C0,xh[wh++]=P0,P0=t,C0=e}function uF(t,e,n){Fo[zo++]=bl,Fo[zo++]=xl,Fo[zo++]=Hu,Hu=t;var r=bl;t=xl;var i=32-ca(r)-1;r&=~(1<<i),n+=1;var s=32-ca(e)+i;if(30<s){var c=i-i%5;s=(r&(1<<c)-1).toString(32),r>>=c,i-=c,bl=1<<32-ca(e)+i|n<<i|r,xl=s+t}else bl=1<<s|n<<i|r,xl=t}function eL(t){t.return!==null&&(Pu(t,1),uF(t,1,0))}function tL(t){for(;t===P0;)P0=xh[--wh],xh[wh]=null,C0=xh[--wh],xh[wh]=null;for(;t===Hu;)Hu=Fo[--zo],Fo[zo]=null,xl=Fo[--zo],Fo[zo]=null,bl=Fo[--zo],Fo[zo]=null}var _o=null,go=null,Dr=!1,sa=null;function dF(t,e){var n=No(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function h4(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,_o=t,go=Lc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,_o=t,go=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Hu!==null?{id:bl,overflow:xl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=No(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,_o=t,go=null,!0):!1;default:return!1}}function h2(t){return(t.mode&1)!==0&&(t.flags&128)===0}function f2(t){if(Dr){var e=go;if(e){var n=e;if(!h4(t,e)){if(h2(t))throw Error(ct(418));e=Lc(n.nextSibling);var r=_o;e&&h4(t,e)?dF(r,n):(t.flags=t.flags&-4097|2,Dr=!1,_o=t)}}else{if(h2(t))throw Error(ct(418));t.flags=t.flags&-4097|2,Dr=!1,_o=t}}}function f4(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;_o=t}function Yy(t){if(t!==_o)return!1;if(!Dr)return f4(t),Dr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!l2(t.type,t.memoizedProps)),e&&(e=go)){if(h2(t))throw hF(),Error(ct(418));for(;e;)dF(t,e),e=Lc(e.nextSibling)}if(f4(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ct(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){go=Lc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}go=null}}else go=_o?Lc(t.stateNode.nextSibling):null;return!0}function hF(){for(var t=go;t;)t=Lc(t.nextSibling)}function Wh(){go=_o=null,Dr=!1}function nL(t){sa===null?sa=[t]:sa.push(t)}var dq=kl.ReactCurrentBatchConfig;function na(t,e){if(t&&t.defaultProps){e=Kr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var I0=Gc(null),L0=null,Eh=null,rL=null;function iL(){rL=Eh=L0=null}function sL(t){var e=I0.current;$r(I0),t._currentValue=e}function p2(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Oh(t,e){L0=t,rL=Eh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Gs=!0),t.firstContext=null)}function Vo(t){var e=t._currentValue;if(rL!==t)if(t={context:t,memoizedValue:e,next:null},Eh===null){if(L0===null)throw Error(ct(308));Eh=t,L0.dependencies={lanes:0,firstContext:t}}else Eh=Eh.next=t;return e}var Du=null;function oL(t){Du===null?Du=[t]:Du.push(t)}function fF(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,oL(e)):(n.next=i.next,i.next=n),e.interleaved=n,Il(t,r)}function Il(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var gc=!1;function aL(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pF(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Sl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Rc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,jn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Il(t,n)}return i=r.interleaved,i===null?(e.next=e,oL(r)):(e.next=i.next,i.next=e),r.interleaved=e,Il(t,n)}function H_(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,WI(t,n)}}function p4(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var c={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=c:s=s.next=c,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function R0(t,e,n,r){var i=t.updateQueue;gc=!1;var s=i.firstBaseUpdate,c=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var f=o,m=f.next;f.next=null,c===null?s=m:c.next=m,c=f;var x=t.alternate;x!==null&&(x=x.updateQueue,o=x.lastBaseUpdate,o!==c&&(o===null?x.firstBaseUpdate=m:o.next=m,x.lastBaseUpdate=f))}if(s!==null){var S=i.baseState;c=0,x=m=f=null,o=s;do{var T=o.lane,C=o.eventTime;if((r&T)===T){x!==null&&(x=x.next={eventTime:C,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var R=t,D=o;switch(T=e,C=n,D.tag){case 1:if(R=D.payload,typeof R=="function"){S=R.call(C,S,T);break e}S=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=D.payload,T=typeof R=="function"?R.call(C,S,T):R,T==null)break e;S=Kr({},S,T);break e;case 2:gc=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,T=i.effects,T===null?i.effects=[o]:T.push(o))}else C={eventTime:C,lane:T,tag:o.tag,payload:o.payload,callback:o.callback,next:null},x===null?(m=x=C,f=S):x=x.next=C,c|=T;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;T=o,o=T.next,T.next=null,i.lastBaseUpdate=T,i.shared.pending=null}}while(1);if(x===null&&(f=S),i.baseState=f,i.firstBaseUpdate=m,i.lastBaseUpdate=x,e=i.shared.interleaved,e!==null){i=e;do c|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ku|=c,t.lanes=c,t.memoizedState=S}}function m4(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ct(191,i));i.call(r)}}}var mF=new fD.Component().refs;function m2(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Kr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var kv={isMounted:function(t){return(t=t._reactInternals)?cd(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ls(),i=Mc(t),s=Sl(r,i);s.payload=e,n!=null&&(s.callback=n),e=Rc(t,s,i),e!==null&&(ua(e,t,i,r),H_(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ls(),i=Mc(t),s=Sl(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Rc(t,s,i),e!==null&&(ua(e,t,i,r),H_(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ls(),r=Mc(t),i=Sl(n,r);i.tag=2,e!=null&&(i.callback=e),e=Rc(t,i,r),e!==null&&(ua(e,t,r,n),H_(e,t,r))}};function g4(t,e,n,r,i,s,c){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,c):e.prototype&&e.prototype.isPureReactComponent?!Om(n,r)||!Om(i,s):!0}function gF(t,e,n){var r=!1,i=Bc,s=e.contextType;return typeof s=="object"&&s!==null?s=Vo(s):(i=Hs(e)?ju:fs.current,r=e.contextTypes,s=(r=r!=null)?Hh(t,i):Bc),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=kv,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function y4(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&kv.enqueueReplaceState(e,e.state,null)}function g2(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=mF,aL(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Vo(s):(s=Hs(e)?ju:fs.current,i.context=Hh(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(m2(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&kv.enqueueReplaceState(i,i.state,null),R0(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ap(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ct(309));var r=n.stateNode}if(!r)throw Error(ct(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(c){var o=i.refs;o===mF&&(o=i.refs={}),c===null?delete o[s]:o[s]=c},e._stringRef=s,e)}if(typeof t!="string")throw Error(ct(284));if(!n._owner)throw Error(ct(290,t))}return t}function Jy(t,e){throw t=Object.prototype.toString.call(e),Error(ct(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function _4(t){var e=t._init;return e(t._payload)}function yF(t){function e(F,k){if(t){var N=F.deletions;N===null?(F.deletions=[k],F.flags|=16):N.push(k)}}function n(F,k){if(!t)return null;for(;k!==null;)e(F,k),k=k.sibling;return null}function r(F,k){for(F=new Map;k!==null;)k.key!==null?F.set(k.key,k):F.set(k.index,k),k=k.sibling;return F}function i(F,k){return F=kc(F,k),F.index=0,F.sibling=null,F}function s(F,k,N){return F.index=N,t?(N=F.alternate,N!==null?(N=N.index,N<k?(F.flags|=2,k):N):(F.flags|=2,k)):(F.flags|=1048576,k)}function c(F){return t&&F.alternate===null&&(F.flags|=2),F}function o(F,k,N,U){return k===null||k.tag!==6?(k=ax(N,F.mode,U),k.return=F,k):(k=i(k,N),k.return=F,k)}function f(F,k,N,U){var ie=N.type;return ie===mh?x(F,k,N.props.children,U,N.key):k!==null&&(k.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===mc&&_4(ie)===k.type)?(U=i(k,N.props),U.ref=Ap(F,k,N),U.return=F,U):(U=Y_(N.type,N.key,N.props,null,F.mode,U),U.ref=Ap(F,k,N),U.return=F,U)}function m(F,k,N,U){return k===null||k.tag!==4||k.stateNode.containerInfo!==N.containerInfo||k.stateNode.implementation!==N.implementation?(k=lx(N,F.mode,U),k.return=F,k):(k=i(k,N.children||[]),k.return=F,k)}function x(F,k,N,U,ie){return k===null||k.tag!==7?(k=Uu(N,F.mode,U,ie),k.return=F,k):(k=i(k,N),k.return=F,k)}function S(F,k,N){if(typeof k=="string"&&k!==""||typeof k=="number")return k=ax(""+k,F.mode,N),k.return=F,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Uy:return N=Y_(k.type,k.key,k.props,null,F.mode,N),N.ref=Ap(F,null,k),N.return=F,N;case ph:return k=lx(k,F.mode,N),k.return=F,k;case mc:var U=k._init;return S(F,U(k._payload),N)}if(Zp(k)||xp(k))return k=Uu(k,F.mode,N,null),k.return=F,k;Jy(F,k)}return null}function T(F,k,N,U){var ie=k!==null?k.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return ie!==null?null:o(F,k,""+N,U);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Uy:return N.key===ie?f(F,k,N,U):null;case ph:return N.key===ie?m(F,k,N,U):null;case mc:return ie=N._init,T(F,k,ie(N._payload),U)}if(Zp(N)||xp(N))return ie!==null?null:x(F,k,N,U,null);Jy(F,N)}return null}function C(F,k,N,U,ie){if(typeof U=="string"&&U!==""||typeof U=="number")return F=F.get(N)||null,o(k,F,""+U,ie);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Uy:return F=F.get(U.key===null?N:U.key)||null,f(k,F,U,ie);case ph:return F=F.get(U.key===null?N:U.key)||null,m(k,F,U,ie);case mc:var he=U._init;return C(F,k,N,he(U._payload),ie)}if(Zp(U)||xp(U))return F=F.get(N)||null,x(k,F,U,ie,null);Jy(k,U)}return null}function R(F,k,N,U){for(var ie=null,he=null,le=k,ve=k=0,Oe=null;le!==null&&ve<N.length;ve++){le.index>ve?(Oe=le,le=null):Oe=le.sibling;var Re=T(F,le,N[ve],U);if(Re===null){le===null&&(le=Oe);break}t&&le&&Re.alternate===null&&e(F,le),k=s(Re,k,ve),he===null?ie=Re:he.sibling=Re,he=Re,le=Oe}if(ve===N.length)return n(F,le),Dr&&Pu(F,ve),ie;if(le===null){for(;ve<N.length;ve++)le=S(F,N[ve],U),le!==null&&(k=s(le,k,ve),he===null?ie=le:he.sibling=le,he=le);return Dr&&Pu(F,ve),ie}for(le=r(F,le);ve<N.length;ve++)Oe=C(le,F,ve,N[ve],U),Oe!==null&&(t&&Oe.alternate!==null&&le.delete(Oe.key===null?ve:Oe.key),k=s(Oe,k,ve),he===null?ie=Oe:he.sibling=Oe,he=Oe);return t&&le.forEach(function(Ee){return e(F,Ee)}),Dr&&Pu(F,ve),ie}function D(F,k,N,U){var ie=xp(N);if(typeof ie!="function")throw Error(ct(150));if(N=ie.call(N),N==null)throw Error(ct(151));for(var he=ie=null,le=k,ve=k=0,Oe=null,Re=N.next();le!==null&&!Re.done;ve++,Re=N.next()){le.index>ve?(Oe=le,le=null):Oe=le.sibling;var Ee=T(F,le,Re.value,U);if(Ee===null){le===null&&(le=Oe);break}t&&le&&Ee.alternate===null&&e(F,le),k=s(Ee,k,ve),he===null?ie=Ee:he.sibling=Ee,he=Ee,le=Oe}if(Re.done)return n(F,le),Dr&&Pu(F,ve),ie;if(le===null){for(;!Re.done;ve++,Re=N.next())Re=S(F,Re.value,U),Re!==null&&(k=s(Re,k,ve),he===null?ie=Re:he.sibling=Re,he=Re);return Dr&&Pu(F,ve),ie}for(le=r(F,le);!Re.done;ve++,Re=N.next())Re=C(le,F,ve,Re.value,U),Re!==null&&(t&&Re.alternate!==null&&le.delete(Re.key===null?ve:Re.key),k=s(Re,k,ve),he===null?ie=Re:he.sibling=Re,he=Re);return t&&le.forEach(function($e){return e(F,$e)}),Dr&&Pu(F,ve),ie}function H(F,k,N,U){if(typeof N=="object"&&N!==null&&N.type===mh&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case Uy:e:{for(var ie=N.key,he=k;he!==null;){if(he.key===ie){if(ie=N.type,ie===mh){if(he.tag===7){n(F,he.sibling),k=i(he,N.props.children),k.return=F,F=k;break e}}else if(he.elementType===ie||typeof ie=="object"&&ie!==null&&ie.$$typeof===mc&&_4(ie)===he.type){n(F,he.sibling),k=i(he,N.props),k.ref=Ap(F,he,N),k.return=F,F=k;break e}n(F,he);break}else e(F,he);he=he.sibling}N.type===mh?(k=Uu(N.props.children,F.mode,U,N.key),k.return=F,F=k):(U=Y_(N.type,N.key,N.props,null,F.mode,U),U.ref=Ap(F,k,N),U.return=F,F=U)}return c(F);case ph:e:{for(he=N.key;k!==null;){if(k.key===he)if(k.tag===4&&k.stateNode.containerInfo===N.containerInfo&&k.stateNode.implementation===N.implementation){n(F,k.sibling),k=i(k,N.children||[]),k.return=F,F=k;break e}else{n(F,k);break}else e(F,k);k=k.sibling}k=lx(N,F.mode,U),k.return=F,F=k}return c(F);case mc:return he=N._init,H(F,k,he(N._payload),U)}if(Zp(N))return R(F,k,N,U);if(xp(N))return D(F,k,N,U);Jy(F,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,k!==null&&k.tag===6?(n(F,k.sibling),k=i(k,N),k.return=F,F=k):(n(F,k),k=ax(N,F.mode,U),k.return=F,F=k),c(F)):n(F,k)}return H}var Kh=yF(!0),_F=yF(!1),hg={},Va=Gc(hg),Nm=Gc(hg),Bm=Gc(hg);function Fu(t){if(t===hg)throw Error(ct(174));return t}function lL(t,e){switch(xr(Bm,e),xr(Nm,t),xr(Va,hg),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qw(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qw(e,t)}$r(Va),xr(Va,e)}function qh(){$r(Va),$r(Nm),$r(Bm)}function vF(t){Fu(Bm.current);var e=Fu(Va.current),n=qw(e,t.type);e!==n&&(xr(Nm,t),xr(Va,n))}function cL(t){Nm.current===t&&($r(Va),$r(Nm))}var Vr=Gc(0);function $0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var tx=[];function uL(){for(var t=0;t<tx.length;t++)tx[t]._workInProgressVersionPrimary=null;tx.length=0}var W_=kl.ReactCurrentDispatcher,nx=kl.ReactCurrentBatchConfig,Wu=0,Hr=null,Ci=null,Oi=null,M0=!1,fm=!1,Um=0,hq=0;function os(){throw Error(ct(321))}function dL(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ha(t[n],e[n]))return!1;return!0}function hL(t,e,n,r,i,s){if(Wu=s,Hr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,W_.current=t===null||t.memoizedState===null?gq:yq,t=n(r,i),fm){s=0;do{if(fm=!1,Um=0,25<=s)throw Error(ct(301));s+=1,Oi=Ci=null,e.updateQueue=null,W_.current=_q,t=n(r,i)}while(fm)}if(W_.current=k0,e=Ci!==null&&Ci.next!==null,Wu=0,Oi=Ci=Hr=null,M0=!1,e)throw Error(ct(300));return t}function fL(){var t=Um!==0;return Um=0,t}function ka(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Oi===null?Hr.memoizedState=Oi=t:Oi=Oi.next=t,Oi}function Go(){if(Ci===null){var t=Hr.alternate;t=t!==null?t.memoizedState:null}else t=Ci.next;var e=Oi===null?Hr.memoizedState:Oi.next;if(e!==null)Oi=e,Ci=t;else{if(t===null)throw Error(ct(310));Ci=t,t={memoizedState:Ci.memoizedState,baseState:Ci.baseState,baseQueue:Ci.baseQueue,queue:Ci.queue,next:null},Oi===null?Hr.memoizedState=Oi=t:Oi=Oi.next=t}return Oi}function Vm(t,e){return typeof e=="function"?e(t):e}function rx(t){var e=Go(),n=e.queue;if(n===null)throw Error(ct(311));n.lastRenderedReducer=t;var r=Ci,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var c=i.next;i.next=s.next,s.next=c}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=c=null,f=null,m=s;do{var x=m.lane;if((Wu&x)===x)f!==null&&(f=f.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),r=m.hasEagerState?m.eagerState:t(r,m.action);else{var S={lane:x,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};f===null?(o=f=S,c=r):f=f.next=S,Hr.lanes|=x,Ku|=x}m=m.next}while(m!==null&&m!==s);f===null?c=r:f.next=o,ha(r,e.memoizedState)||(Gs=!0),e.memoizedState=r,e.baseState=c,e.baseQueue=f,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Hr.lanes|=s,Ku|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ix(t){var e=Go(),n=e.queue;if(n===null)throw Error(ct(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var c=i=i.next;do s=t(s,c.action),c=c.next;while(c!==i);ha(s,e.memoizedState)||(Gs=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function bF(){}function xF(t,e){var n=Hr,r=Go(),i=e(),s=!ha(r.memoizedState,i);if(s&&(r.memoizedState=i,Gs=!0),r=r.queue,pL(TF.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Oi!==null&&Oi.memoizedState.tag&1){if(n.flags|=2048,Gm(9,EF.bind(null,n,r,i,e),void 0,null),zi===null)throw Error(ct(349));Wu&30||wF(n,e,i)}return i}function wF(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Hr.updateQueue,e===null?(e={lastEffect:null,stores:null},Hr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function EF(t,e,n,r){e.value=n,e.getSnapshot=r,SF(e)&&AF(t)}function TF(t,e,n){return n(function(){SF(e)&&AF(t)})}function SF(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ha(t,n)}catch{return!0}}function AF(t){var e=Il(t,1);e!==null&&ua(e,t,1,-1)}function v4(t){var e=ka();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vm,lastRenderedState:t},e.queue=t,t=t.dispatch=mq.bind(null,Hr,t),[e.memoizedState,t]}function Gm(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Hr.updateQueue,e===null?(e={lastEffect:null,stores:null},Hr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function PF(){return Go().memoizedState}function K_(t,e,n,r){var i=ka();Hr.flags|=t,i.memoizedState=Gm(1|e,n,void 0,r===void 0?null:r)}function Ov(t,e,n,r){var i=Go();r=r===void 0?null:r;var s=void 0;if(Ci!==null){var c=Ci.memoizedState;if(s=c.destroy,r!==null&&dL(r,c.deps)){i.memoizedState=Gm(e,n,s,r);return}}Hr.flags|=t,i.memoizedState=Gm(1|e,n,s,r)}function b4(t,e){return K_(8390656,8,t,e)}function pL(t,e){return Ov(2048,8,t,e)}function CF(t,e){return Ov(4,2,t,e)}function IF(t,e){return Ov(4,4,t,e)}function LF(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function RF(t,e,n){return n=n!=null?n.concat([t]):null,Ov(4,4,LF.bind(null,e,t),n)}function mL(){}function $F(t,e){var n=Go();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&dL(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function MF(t,e){var n=Go();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&dL(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function kF(t,e,n){return Wu&21?(ha(n,e)||(n=FD(),Hr.lanes|=n,Ku|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Gs=!0),t.memoizedState=n)}function fq(t,e){var n=sr;sr=n!==0&&4>n?n:4,t(!0);var r=nx.transition;nx.transition={};try{t(!1),e()}finally{sr=n,nx.transition=r}}function OF(){return Go().memoizedState}function pq(t,e,n){var r=Mc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},DF(t))FF(e,n);else if(n=fF(t,e,n,r),n!==null){var i=Ls();ua(n,t,r,i),zF(n,e,r)}}function mq(t,e,n){var r=Mc(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(DF(t))FF(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var c=e.lastRenderedState,o=s(c,n);if(i.hasEagerState=!0,i.eagerState=o,ha(o,c)){var f=e.interleaved;f===null?(i.next=i,oL(e)):(i.next=f.next,f.next=i),e.interleaved=i;return}}catch{}finally{}n=fF(t,e,i,r),n!==null&&(i=Ls(),ua(n,t,r,i),zF(n,e,r))}}function DF(t){var e=t.alternate;return t===Hr||e!==null&&e===Hr}function FF(t,e){fm=M0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function zF(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,WI(t,n)}}var k0={readContext:Vo,useCallback:os,useContext:os,useEffect:os,useImperativeHandle:os,useInsertionEffect:os,useLayoutEffect:os,useMemo:os,useReducer:os,useRef:os,useState:os,useDebugValue:os,useDeferredValue:os,useTransition:os,useMutableSource:os,useSyncExternalStore:os,useId:os,unstable_isNewReconciler:!1},gq={readContext:Vo,useCallback:function(t,e){return ka().memoizedState=[t,e===void 0?null:e],t},useContext:Vo,useEffect:b4,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,K_(4194308,4,LF.bind(null,e,t),n)},useLayoutEffect:function(t,e){return K_(4194308,4,t,e)},useInsertionEffect:function(t,e){return K_(4,2,t,e)},useMemo:function(t,e){var n=ka();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ka();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=pq.bind(null,Hr,t),[r.memoizedState,t]},useRef:function(t){var e=ka();return t={current:t},e.memoizedState=t},useState:v4,useDebugValue:mL,useDeferredValue:function(t){return ka().memoizedState=t},useTransition:function(){var t=v4(!1),e=t[0];return t=fq.bind(null,t[1]),ka().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Hr,i=ka();if(Dr){if(n===void 0)throw Error(ct(407));n=n()}else{if(n=e(),zi===null)throw Error(ct(349));Wu&30||wF(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,b4(TF.bind(null,r,s,t),[t]),r.flags|=2048,Gm(9,EF.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=ka(),e=zi.identifierPrefix;if(Dr){var n=xl,r=bl;n=(r&~(1<<32-ca(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Um++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=hq++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},yq={readContext:Vo,useCallback:$F,useContext:Vo,useEffect:pL,useImperativeHandle:RF,useInsertionEffect:CF,useLayoutEffect:IF,useMemo:MF,useReducer:rx,useRef:PF,useState:function(){return rx(Vm)},useDebugValue:mL,useDeferredValue:function(t){var e=Go();return kF(e,Ci.memoizedState,t)},useTransition:function(){var t=rx(Vm)[0],e=Go().memoizedState;return[t,e]},useMutableSource:bF,useSyncExternalStore:xF,useId:OF,unstable_isNewReconciler:!1},_q={readContext:Vo,useCallback:$F,useContext:Vo,useEffect:pL,useImperativeHandle:RF,useInsertionEffect:CF,useLayoutEffect:IF,useMemo:MF,useReducer:ix,useRef:PF,useState:function(){return ix(Vm)},useDebugValue:mL,useDeferredValue:function(t){var e=Go();return Ci===null?e.memoizedState=t:kF(e,Ci.memoizedState,t)},useTransition:function(){var t=ix(Vm)[0],e=Go().memoizedState;return[t,e]},useMutableSource:bF,useSyncExternalStore:xF,useId:OF,unstable_isNewReconciler:!1};function Xh(t,e){try{var n="",r=e;do n+=WW(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function sx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function y2(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var vq=typeof WeakMap=="function"?WeakMap:Map;function NF(t,e,n){n=Sl(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){D0||(D0=!0,P2=r),y2(t,e)},n}function BF(t,e,n){n=Sl(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){y2(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){y2(t,e),typeof r!="function"&&($c===null?$c=new Set([this]):$c.add(this));var c=e.stack;this.componentDidCatch(e.value,{componentStack:c!==null?c:""})}),n}function x4(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new vq;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Mq.bind(null,t,e,n),e.then(t,t))}function w4(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function E4(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Sl(-1,1),e.tag=2,Rc(n,e,1))),n.lanes|=1),t)}var bq=kl.ReactCurrentOwner,Gs=!1;function Ss(t,e,n,r){e.child=t===null?_F(e,null,n,r):Kh(e,t.child,n,r)}function T4(t,e,n,r,i){n=n.render;var s=e.ref;return Oh(e,i),r=hL(t,e,n,r,s,i),n=fL(),t!==null&&!Gs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ll(t,e,i)):(Dr&&n&&eL(e),e.flags|=1,Ss(t,e,r,i),e.child)}function S4(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!EL(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,UF(t,e,s,r,i)):(t=Y_(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var c=s.memoizedProps;if(n=n.compare,n=n!==null?n:Om,n(c,r)&&t.ref===e.ref)return Ll(t,e,i)}return e.flags|=1,t=kc(s,r),t.ref=e.ref,t.return=e,e.child=t}function UF(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Om(s,r)&&t.ref===e.ref)if(Gs=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Gs=!0);else return e.lanes=t.lanes,Ll(t,e,i)}return _2(t,e,n,r,i)}function VF(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xr(Sh,uo),uo|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xr(Sh,uo),uo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,xr(Sh,uo),uo|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,xr(Sh,uo),uo|=r;return Ss(t,e,i,n),e.child}function GF(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function _2(t,e,n,r,i){var s=Hs(n)?ju:fs.current;return s=Hh(e,s),Oh(e,i),n=hL(t,e,n,r,s,i),r=fL(),t!==null&&!Gs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ll(t,e,i)):(Dr&&r&&eL(e),e.flags|=1,Ss(t,e,n,i),e.child)}function A4(t,e,n,r,i){if(Hs(n)){var s=!0;A0(e)}else s=!1;if(Oh(e,i),e.stateNode===null)q_(t,e),gF(e,n,r),g2(e,n,r,i),r=!0;else if(t===null){var c=e.stateNode,o=e.memoizedProps;c.props=o;var f=c.context,m=n.contextType;typeof m=="object"&&m!==null?m=Vo(m):(m=Hs(n)?ju:fs.current,m=Hh(e,m));var x=n.getDerivedStateFromProps,S=typeof x=="function"||typeof c.getSnapshotBeforeUpdate=="function";S||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(o!==r||f!==m)&&y4(e,c,r,m),gc=!1;var T=e.memoizedState;c.state=T,R0(e,r,c,i),f=e.memoizedState,o!==r||T!==f||js.current||gc?(typeof x=="function"&&(m2(e,n,x,r),f=e.memoizedState),(o=gc||g4(e,n,o,r,T,f,m))?(S||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(e.flags|=4194308)):(typeof c.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=f),c.props=r,c.state=f,c.context=m,r=o):(typeof c.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{c=e.stateNode,pF(t,e),o=e.memoizedProps,m=e.type===e.elementType?o:na(e.type,o),c.props=m,S=e.pendingProps,T=c.context,f=n.contextType,typeof f=="object"&&f!==null?f=Vo(f):(f=Hs(n)?ju:fs.current,f=Hh(e,f));var C=n.getDerivedStateFromProps;(x=typeof C=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(o!==S||T!==f)&&y4(e,c,r,f),gc=!1,T=e.memoizedState,c.state=T,R0(e,r,c,i);var R=e.memoizedState;o!==S||T!==R||js.current||gc?(typeof C=="function"&&(m2(e,n,C,r),R=e.memoizedState),(m=gc||g4(e,n,m,r,T,R,f)||!1)?(x||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(r,R,f),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(r,R,f)),typeof c.componentDidUpdate=="function"&&(e.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof c.componentDidUpdate!="function"||o===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),c.props=r,c.state=R,c.context=f,r=m):(typeof c.componentDidUpdate!="function"||o===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),r=!1)}return v2(t,e,n,r,s,i)}function v2(t,e,n,r,i,s){GF(t,e);var c=(e.flags&128)!==0;if(!r&&!c)return i&&d4(e,n,!1),Ll(t,e,s);r=e.stateNode,bq.current=e;var o=c&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&c?(e.child=Kh(e,t.child,null,s),e.child=Kh(e,null,o,s)):Ss(t,e,o,s),e.memoizedState=r.state,i&&d4(e,n,!0),e.child}function jF(t){var e=t.stateNode;e.pendingContext?u4(t,e.pendingContext,e.pendingContext!==e.context):e.context&&u4(t,e.context,!1),lL(t,e.containerInfo)}function P4(t,e,n,r,i){return Wh(),nL(i),e.flags|=256,Ss(t,e,n,r),e.child}var b2={dehydrated:null,treeContext:null,retryLane:0};function x2(t){return{baseLanes:t,cachePool:null,transitions:null}}function HF(t,e,n){var r=e.pendingProps,i=Vr.current,s=!1,c=(e.flags&128)!==0,o;if((o=c)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),xr(Vr,i&1),t===null)return f2(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(c=r.children,t=r.fallback,s?(r=e.mode,s=e.child,c={mode:"hidden",children:c},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=c):s=zv(c,r,0,null),t=Uu(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=x2(n),e.memoizedState=b2,t):gL(e,c));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return xq(t,e,c,r,o,i,n);if(s){s=r.fallback,c=e.mode,i=t.child,o=i.sibling;var f={mode:"hidden",children:r.children};return!(c&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=f,e.deletions=null):(r=kc(i,f),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=kc(o,s):(s=Uu(s,c,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,c=t.child.memoizedState,c=c===null?x2(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=t.childLanes&~n,e.memoizedState=b2,r}return s=t.child,t=s.sibling,r=kc(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function gL(t,e){return e=zv({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Qy(t,e,n,r){return r!==null&&nL(r),Kh(e,t.child,null,n),t=gL(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function xq(t,e,n,r,i,s,c){if(n)return e.flags&256?(e.flags&=-257,r=sx(Error(ct(422))),Qy(t,e,c,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=zv({mode:"visible",children:r.children},i,0,null),s=Uu(s,i,c,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Kh(e,t.child,null,c),e.child.memoizedState=x2(c),e.memoizedState=b2,s);if(!(e.mode&1))return Qy(t,e,c,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(ct(419)),r=sx(s,r,void 0),Qy(t,e,c,r)}if(o=(c&t.childLanes)!==0,Gs||o){if(r=zi,r!==null){switch(c&-c){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|c)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Il(t,i),ua(r,t,i,-1))}return wL(),r=sx(Error(ct(421))),Qy(t,e,c,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=kq.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,go=Lc(i.nextSibling),_o=e,Dr=!0,sa=null,t!==null&&(Fo[zo++]=bl,Fo[zo++]=xl,Fo[zo++]=Hu,bl=t.id,xl=t.overflow,Hu=e),e=gL(e,r.children),e.flags|=4096,e)}function C4(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),p2(t.return,e,n)}function ox(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function WF(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Ss(t,e,r.children,n),r=Vr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&C4(t,n,e);else if(t.tag===19)C4(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(xr(Vr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&$0(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),ox(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&$0(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}ox(e,!0,n,null,s);break;case"together":ox(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function q_(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ll(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ku|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ct(153));if(e.child!==null){for(t=e.child,n=kc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=kc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function wq(t,e,n){switch(e.tag){case 3:jF(e),Wh();break;case 5:vF(e);break;case 1:Hs(e.type)&&A0(e);break;case 4:lL(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;xr(I0,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(xr(Vr,Vr.current&1),e.flags|=128,null):n&e.child.childLanes?HF(t,e,n):(xr(Vr,Vr.current&1),t=Ll(t,e,n),t!==null?t.sibling:null);xr(Vr,Vr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return WF(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),xr(Vr,Vr.current),r)break;return null;case 22:case 23:return e.lanes=0,VF(t,e,n)}return Ll(t,e,n)}var KF,w2,qF,XF;KF=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};w2=function(){};qF=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Fu(Va.current);var s=null;switch(n){case"input":i=jw(t,i),r=jw(t,r),s=[];break;case"select":i=Kr({},i,{value:void 0}),r=Kr({},r,{value:void 0}),s=[];break;case"textarea":i=Kw(t,i),r=Kw(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=T0)}Xw(n,r);var c;n=null;for(m in i)if(!r.hasOwnProperty(m)&&i.hasOwnProperty(m)&&i[m]!=null)if(m==="style"){var o=i[m];for(c in o)o.hasOwnProperty(c)&&(n||(n={}),n[c]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(Cm.hasOwnProperty(m)?s||(s=[]):(s=s||[]).push(m,null));for(m in r){var f=r[m];if(o=i!=null?i[m]:void 0,r.hasOwnProperty(m)&&f!==o&&(f!=null||o!=null))if(m==="style")if(o){for(c in o)!o.hasOwnProperty(c)||f&&f.hasOwnProperty(c)||(n||(n={}),n[c]="");for(c in f)f.hasOwnProperty(c)&&o[c]!==f[c]&&(n||(n={}),n[c]=f[c])}else n||(s||(s=[]),s.push(m,n)),n=f;else m==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,o=o?o.__html:void 0,f!=null&&o!==f&&(s=s||[]).push(m,f)):m==="children"?typeof f!="string"&&typeof f!="number"||(s=s||[]).push(m,""+f):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(Cm.hasOwnProperty(m)?(f!=null&&m==="onScroll"&&Ar("scroll",t),s||o===f||(s=[])):(s=s||[]).push(m,f))}n&&(s=s||[]).push("style",n);var m=s;(e.updateQueue=m)&&(e.flags|=4)}};XF=function(t,e,n,r){n!==r&&(e.flags|=4)};function Pp(t,e){if(!Dr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function as(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Eq(t,e,n){var r=e.pendingProps;switch(tL(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return as(e),null;case 1:return Hs(e.type)&&S0(),as(e),null;case 3:return r=e.stateNode,qh(),$r(js),$r(fs),uL(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Yy(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,sa!==null&&(L2(sa),sa=null))),w2(t,e),as(e),null;case 5:cL(e);var i=Fu(Bm.current);if(n=e.type,t!==null&&e.stateNode!=null)qF(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ct(166));return as(e),null}if(t=Fu(Va.current),Yy(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Da]=e,r[zm]=s,t=(e.mode&1)!==0,n){case"dialog":Ar("cancel",r),Ar("close",r);break;case"iframe":case"object":case"embed":Ar("load",r);break;case"video":case"audio":for(i=0;i<Jp.length;i++)Ar(Jp[i],r);break;case"source":Ar("error",r);break;case"img":case"image":case"link":Ar("error",r),Ar("load",r);break;case"details":Ar("toggle",r);break;case"input":FM(r,s),Ar("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ar("invalid",r);break;case"textarea":NM(r,s),Ar("invalid",r)}Xw(n,s),i=null;for(var c in s)if(s.hasOwnProperty(c)){var o=s[c];c==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&Zy(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Zy(r.textContent,o,t),i=["children",""+o]):Cm.hasOwnProperty(c)&&o!=null&&c==="onScroll"&&Ar("scroll",r)}switch(n){case"input":Vy(r),zM(r,s,!0);break;case"textarea":Vy(r),BM(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=T0)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{c=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=wD(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=c.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=c.createElement(n,{is:r.is}):(t=c.createElement(n),n==="select"&&(c=t,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):t=c.createElementNS(t,n),t[Da]=e,t[zm]=r,KF(t,e,!1,!1),e.stateNode=t;e:{switch(c=Zw(n,r),n){case"dialog":Ar("cancel",t),Ar("close",t),i=r;break;case"iframe":case"object":case"embed":Ar("load",t),i=r;break;case"video":case"audio":for(i=0;i<Jp.length;i++)Ar(Jp[i],t);i=r;break;case"source":Ar("error",t),i=r;break;case"img":case"image":case"link":Ar("error",t),Ar("load",t),i=r;break;case"details":Ar("toggle",t),i=r;break;case"input":FM(t,r),i=jw(t,r),Ar("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Kr({},r,{value:void 0}),Ar("invalid",t);break;case"textarea":NM(t,r),i=Kw(t,r),Ar("invalid",t);break;default:i=r}Xw(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var f=o[s];s==="style"?SD(t,f):s==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&ED(t,f)):s==="children"?typeof f=="string"?(n!=="textarea"||f!=="")&&Im(t,f):typeof f=="number"&&Im(t,""+f):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Cm.hasOwnProperty(s)?f!=null&&s==="onScroll"&&Ar("scroll",t):f!=null&&BI(t,s,f,c))}switch(n){case"input":Vy(t),zM(t,r,!1);break;case"textarea":Vy(t),BM(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Nc(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Rh(t,!!r.multiple,s,!1):r.defaultValue!=null&&Rh(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=T0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return as(e),null;case 6:if(t&&e.stateNode!=null)XF(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ct(166));if(n=Fu(Bm.current),Fu(Va.current),Yy(e)){if(r=e.stateNode,n=e.memoizedProps,r[Da]=e,(s=r.nodeValue!==n)&&(t=_o,t!==null))switch(t.tag){case 3:Zy(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Zy(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Da]=e,e.stateNode=r}return as(e),null;case 13:if($r(Vr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Dr&&go!==null&&e.mode&1&&!(e.flags&128))hF(),Wh(),e.flags|=98560,s=!1;else if(s=Yy(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ct(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ct(317));s[Da]=e}else Wh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;as(e),s=!1}else sa!==null&&(L2(sa),sa=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Vr.current&1?Ii===0&&(Ii=3):wL())),e.updateQueue!==null&&(e.flags|=4),as(e),null);case 4:return qh(),w2(t,e),t===null&&Dm(e.stateNode.containerInfo),as(e),null;case 10:return sL(e.type._context),as(e),null;case 17:return Hs(e.type)&&S0(),as(e),null;case 19:if($r(Vr),s=e.memoizedState,s===null)return as(e),null;if(r=(e.flags&128)!==0,c=s.rendering,c===null)if(r)Pp(s,!1);else{if(Ii!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(c=$0(t),c!==null){for(e.flags|=128,Pp(s,!1),r=c.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,c=s.alternate,c===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,t=c.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return xr(Vr,Vr.current&1|2),e.child}t=t.sibling}s.tail!==null&&ci()>Zh&&(e.flags|=128,r=!0,Pp(s,!1),e.lanes=4194304)}else{if(!r)if(t=$0(c),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Pp(s,!0),s.tail===null&&s.tailMode==="hidden"&&!c.alternate&&!Dr)return as(e),null}else 2*ci()-s.renderingStartTime>Zh&&n!==1073741824&&(e.flags|=128,r=!0,Pp(s,!1),e.lanes=4194304);s.isBackwards?(c.sibling=e.child,e.child=c):(n=s.last,n!==null?n.sibling=c:e.child=c,s.last=c)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ci(),e.sibling=null,n=Vr.current,xr(Vr,r?n&1|2:n&1),e):(as(e),null);case 22:case 23:return xL(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?uo&1073741824&&(as(e),e.subtreeFlags&6&&(e.flags|=8192)):as(e),null;case 24:return null;case 25:return null}throw Error(ct(156,e.tag))}function Tq(t,e){switch(tL(e),e.tag){case 1:return Hs(e.type)&&S0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return qh(),$r(js),$r(fs),uL(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return cL(e),null;case 13:if($r(Vr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ct(340));Wh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $r(Vr),null;case 4:return qh(),null;case 10:return sL(e.type._context),null;case 22:case 23:return xL(),null;case 24:return null;default:return null}}var e_=!1,ds=!1,Sq=typeof WeakSet=="function"?WeakSet:Set,Bt=null;function Th(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ti(t,e,r)}else n.current=null}function E2(t,e,n){try{n()}catch(r){ti(t,e,r)}}var I4=!1;function Aq(t,e){if(o2=x0,t=QD(),QI(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var c=0,o=-1,f=-1,m=0,x=0,S=t,T=null;t:for(;;){for(var C;S!==n||i!==0&&S.nodeType!==3||(o=c+i),S!==s||r!==0&&S.nodeType!==3||(f=c+r),S.nodeType===3&&(c+=S.nodeValue.length),(C=S.firstChild)!==null;)T=S,S=C;for(;;){if(S===t)break t;if(T===n&&++m===i&&(o=c),T===s&&++x===r&&(f=c),(C=S.nextSibling)!==null)break;S=T,T=S.parentNode}S=C}n=o===-1||f===-1?null:{start:o,end:f}}else n=null}n=n||{start:0,end:0}}else n=null;for(a2={focusedElem:t,selectionRange:n},x0=!1,Bt=e;Bt!==null;)if(e=Bt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Bt=t;else for(;Bt!==null;){e=Bt;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var D=R.memoizedProps,H=R.memoizedState,F=e.stateNode,k=F.getSnapshotBeforeUpdate(e.elementType===e.type?D:na(e.type,D),H);F.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ct(163))}}catch(U){ti(e,e.return,U)}if(t=e.sibling,t!==null){t.return=e.return,Bt=t;break}Bt=e.return}return R=I4,I4=!1,R}function pm(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&E2(e,n,s)}i=i.next}while(i!==r)}}function Dv(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function T2(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function ZF(t){var e=t.alternate;e!==null&&(t.alternate=null,ZF(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Da],delete e[zm],delete e[u2],delete e[lq],delete e[cq])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function YF(t){return t.tag===5||t.tag===3||t.tag===4}function L4(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||YF(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function S2(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=T0));else if(r!==4&&(t=t.child,t!==null))for(S2(t,e,n),t=t.sibling;t!==null;)S2(t,e,n),t=t.sibling}function A2(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(A2(t,e,n),t=t.sibling;t!==null;)A2(t,e,n),t=t.sibling}var Xi=null,ra=!1;function ac(t,e,n){for(n=n.child;n!==null;)JF(t,e,n),n=n.sibling}function JF(t,e,n){if(Ua&&typeof Ua.onCommitFiberUnmount=="function")try{Ua.onCommitFiberUnmount(Cv,n)}catch{}switch(n.tag){case 5:ds||Th(n,e);case 6:var r=Xi,i=ra;Xi=null,ac(t,e,n),Xi=r,ra=i,Xi!==null&&(ra?(t=Xi,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Xi.removeChild(n.stateNode));break;case 18:Xi!==null&&(ra?(t=Xi,n=n.stateNode,t.nodeType===8?Q1(t.parentNode,n):t.nodeType===1&&Q1(t,n),Mm(t)):Q1(Xi,n.stateNode));break;case 4:r=Xi,i=ra,Xi=n.stateNode.containerInfo,ra=!0,ac(t,e,n),Xi=r,ra=i;break;case 0:case 11:case 14:case 15:if(!ds&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,c=s.destroy;s=s.tag,c!==void 0&&(s&2||s&4)&&E2(n,e,c),i=i.next}while(i!==r)}ac(t,e,n);break;case 1:if(!ds&&(Th(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){ti(n,e,o)}ac(t,e,n);break;case 21:ac(t,e,n);break;case 22:n.mode&1?(ds=(r=ds)||n.memoizedState!==null,ac(t,e,n),ds=r):ac(t,e,n);break;default:ac(t,e,n)}}function R4(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Sq),e.forEach(function(r){var i=Oq.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ea(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,c=e,o=c;e:for(;o!==null;){switch(o.tag){case 5:Xi=o.stateNode,ra=!1;break e;case 3:Xi=o.stateNode.containerInfo,ra=!0;break e;case 4:Xi=o.stateNode.containerInfo,ra=!0;break e}o=o.return}if(Xi===null)throw Error(ct(160));JF(s,c,i),Xi=null,ra=!1;var f=i.alternate;f!==null&&(f.return=null),i.return=null}catch(m){ti(i,e,m)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)QF(e,t),e=e.sibling}function QF(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ea(e,t),Ca(t),r&4){try{pm(3,t,t.return),Dv(3,t)}catch(D){ti(t,t.return,D)}try{pm(5,t,t.return)}catch(D){ti(t,t.return,D)}}break;case 1:ea(e,t),Ca(t),r&512&&n!==null&&Th(n,n.return);break;case 5:if(ea(e,t),Ca(t),r&512&&n!==null&&Th(n,n.return),t.flags&32){var i=t.stateNode;try{Im(i,"")}catch(D){ti(t,t.return,D)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,c=n!==null?n.memoizedProps:s,o=t.type,f=t.updateQueue;if(t.updateQueue=null,f!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&bD(i,s),Zw(o,c);var m=Zw(o,s);for(c=0;c<f.length;c+=2){var x=f[c],S=f[c+1];x==="style"?SD(i,S):x==="dangerouslySetInnerHTML"?ED(i,S):x==="children"?Im(i,S):BI(i,x,S,m)}switch(o){case"input":Hw(i,s);break;case"textarea":xD(i,s);break;case"select":var T=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var C=s.value;C!=null?Rh(i,!!s.multiple,C,!1):T!==!!s.multiple&&(s.defaultValue!=null?Rh(i,!!s.multiple,s.defaultValue,!0):Rh(i,!!s.multiple,s.multiple?[]:"",!1))}i[zm]=s}catch(D){ti(t,t.return,D)}}break;case 6:if(ea(e,t),Ca(t),r&4){if(t.stateNode===null)throw Error(ct(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(D){ti(t,t.return,D)}}break;case 3:if(ea(e,t),Ca(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Mm(e.containerInfo)}catch(D){ti(t,t.return,D)}break;case 4:ea(e,t),Ca(t);break;case 13:ea(e,t),Ca(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(vL=ci())),r&4&&R4(t);break;case 22:if(x=n!==null&&n.memoizedState!==null,t.mode&1?(ds=(m=ds)||x,ea(e,t),ds=m):ea(e,t),Ca(t),r&8192){if(m=t.memoizedState!==null,(t.stateNode.isHidden=m)&&!x&&t.mode&1)for(Bt=t,x=t.child;x!==null;){for(S=Bt=x;Bt!==null;){switch(T=Bt,C=T.child,T.tag){case 0:case 11:case 14:case 15:pm(4,T,T.return);break;case 1:Th(T,T.return);var R=T.stateNode;if(typeof R.componentWillUnmount=="function"){r=T,n=T.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(D){ti(r,n,D)}}break;case 5:Th(T,T.return);break;case 22:if(T.memoizedState!==null){M4(S);continue}}C!==null?(C.return=T,Bt=C):M4(S)}x=x.sibling}e:for(x=null,S=t;;){if(S.tag===5){if(x===null){x=S;try{i=S.stateNode,m?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=S.stateNode,f=S.memoizedProps.style,c=f!=null&&f.hasOwnProperty("display")?f.display:null,o.style.display=TD("display",c))}catch(D){ti(t,t.return,D)}}}else if(S.tag===6){if(x===null)try{S.stateNode.nodeValue=m?"":S.memoizedProps}catch(D){ti(t,t.return,D)}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===t)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===t)break e;for(;S.sibling===null;){if(S.return===null||S.return===t)break e;x===S&&(x=null),S=S.return}x===S&&(x=null),S.sibling.return=S.return,S=S.sibling}}break;case 19:ea(e,t),Ca(t),r&4&&R4(t);break;case 21:break;default:ea(e,t),Ca(t)}}function Ca(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(YF(n)){var r=n;break e}n=n.return}throw Error(ct(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Im(i,""),r.flags&=-33);var s=L4(t);A2(t,s,i);break;case 3:case 4:var c=r.stateNode.containerInfo,o=L4(t);S2(t,o,c);break;default:throw Error(ct(161))}}catch(f){ti(t,t.return,f)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Pq(t,e,n){Bt=t,e8(t)}function e8(t,e,n){for(var r=(t.mode&1)!==0;Bt!==null;){var i=Bt,s=i.child;if(i.tag===22&&r){var c=i.memoizedState!==null||e_;if(!c){var o=i.alternate,f=o!==null&&o.memoizedState!==null||ds;o=e_;var m=ds;if(e_=c,(ds=f)&&!m)for(Bt=i;Bt!==null;)c=Bt,f=c.child,c.tag===22&&c.memoizedState!==null?k4(i):f!==null?(f.return=c,Bt=f):k4(i);for(;s!==null;)Bt=s,e8(s),s=s.sibling;Bt=i,e_=o,ds=m}$4(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Bt=s):$4(t)}}function $4(t){for(;Bt!==null;){var e=Bt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ds||Dv(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ds)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:na(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&m4(e,s,r);break;case 3:var c=e.updateQueue;if(c!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}m4(e,c,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var f=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&n.focus();break;case"img":f.src&&(n.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var m=e.alternate;if(m!==null){var x=m.memoizedState;if(x!==null){var S=x.dehydrated;S!==null&&Mm(S)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ct(163))}ds||e.flags&512&&T2(e)}catch(T){ti(e,e.return,T)}}if(e===t){Bt=null;break}if(n=e.sibling,n!==null){n.return=e.return,Bt=n;break}Bt=e.return}}function M4(t){for(;Bt!==null;){var e=Bt;if(e===t){Bt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Bt=n;break}Bt=e.return}}function k4(t){for(;Bt!==null;){var e=Bt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Dv(4,e)}catch(f){ti(e,n,f)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(f){ti(e,i,f)}}var s=e.return;try{T2(e)}catch(f){ti(e,s,f)}break;case 5:var c=e.return;try{T2(e)}catch(f){ti(e,c,f)}}}catch(f){ti(e,e.return,f)}if(e===t){Bt=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Bt=o;break}Bt=e.return}}var Cq=Math.ceil,O0=kl.ReactCurrentDispatcher,yL=kl.ReactCurrentOwner,Bo=kl.ReactCurrentBatchConfig,jn=0,zi=null,yi=null,Zi=0,uo=0,Sh=Gc(0),Ii=0,jm=null,Ku=0,Fv=0,_L=0,mm=null,Ns=null,vL=0,Zh=1/0,gl=null,D0=!1,P2=null,$c=null,t_=!1,Ec=null,F0=0,gm=0,C2=null,X_=-1,Z_=0;function Ls(){return jn&6?ci():X_!==-1?X_:X_=ci()}function Mc(t){return t.mode&1?jn&2&&Zi!==0?Zi&-Zi:dq.transition!==null?(Z_===0&&(Z_=FD()),Z_):(t=sr,t!==0||(t=window.event,t=t===void 0?16:jD(t.type)),t):1}function ua(t,e,n,r){if(50<gm)throw gm=0,C2=null,Error(ct(185));cg(t,n,r),(!(jn&2)||t!==zi)&&(t===zi&&(!(jn&2)&&(Fv|=n),Ii===4&&bc(t,Zi)),Ws(t,r),n===1&&jn===0&&!(e.mode&1)&&(Zh=ci()+500,Mv&&jc()))}function Ws(t,e){var n=t.callbackNode;dK(t,e);var r=b0(t,t===zi?Zi:0);if(r===0)n!==null&&GM(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&GM(n),e===1)t.tag===0?uq(O4.bind(null,t)):cF(O4.bind(null,t)),oq(function(){!(jn&6)&&jc()}),n=null;else{switch(zD(r)){case 1:n=HI;break;case 4:n=OD;break;case 16:n=v0;break;case 536870912:n=DD;break;default:n=v0}n=l8(n,t8.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function t8(t,e){if(X_=-1,Z_=0,jn&6)throw Error(ct(327));var n=t.callbackNode;if(Dh()&&t.callbackNode!==n)return null;var r=b0(t,t===zi?Zi:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=z0(t,r);else{e=r;var i=jn;jn|=2;var s=r8();(zi!==t||Zi!==e)&&(gl=null,Zh=ci()+500,Bu(t,e));do try{Rq();break}catch(o){n8(t,o)}while(1);iL(),O0.current=s,jn=i,yi!==null?e=0:(zi=null,Zi=0,e=Ii)}if(e!==0){if(e===2&&(i=t2(t),i!==0&&(r=i,e=I2(t,i))),e===1)throw n=jm,Bu(t,0),bc(t,r),Ws(t,ci()),n;if(e===6)bc(t,r);else{if(i=t.current.alternate,!(r&30)&&!Iq(i)&&(e=z0(t,r),e===2&&(s=t2(t),s!==0&&(r=s,e=I2(t,s))),e===1))throw n=jm,Bu(t,0),bc(t,r),Ws(t,ci()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ct(345));case 2:Cu(t,Ns,gl);break;case 3:if(bc(t,r),(r&130023424)===r&&(e=vL+500-ci(),10<e)){if(b0(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Ls(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=c2(Cu.bind(null,t,Ns,gl),e);break}Cu(t,Ns,gl);break;case 4:if(bc(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var c=31-ca(r);s=1<<c,c=e[c],c>i&&(i=c),r&=~s}if(r=i,r=ci()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cq(r/1960))-r,10<r){t.timeoutHandle=c2(Cu.bind(null,t,Ns,gl),r);break}Cu(t,Ns,gl);break;case 5:Cu(t,Ns,gl);break;default:throw Error(ct(329))}}}return Ws(t,ci()),t.callbackNode===n?t8.bind(null,t):null}function I2(t,e){var n=mm;return t.current.memoizedState.isDehydrated&&(Bu(t,e).flags|=256),t=z0(t,e),t!==2&&(e=Ns,Ns=n,e!==null&&L2(e)),t}function L2(t){Ns===null?Ns=t:Ns.push.apply(Ns,t)}function Iq(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ha(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function bc(t,e){for(e&=~_L,e&=~Fv,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ca(e),r=1<<n;t[n]=-1,e&=~r}}function O4(t){if(jn&6)throw Error(ct(327));Dh();var e=b0(t,0);if(!(e&1))return Ws(t,ci()),null;var n=z0(t,e);if(t.tag!==0&&n===2){var r=t2(t);r!==0&&(e=r,n=I2(t,r))}if(n===1)throw n=jm,Bu(t,0),bc(t,e),Ws(t,ci()),n;if(n===6)throw Error(ct(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Cu(t,Ns,gl),Ws(t,ci()),null}function bL(t,e){var n=jn;jn|=1;try{return t(e)}finally{jn=n,jn===0&&(Zh=ci()+500,Mv&&jc())}}function qu(t){Ec!==null&&Ec.tag===0&&!(jn&6)&&Dh();var e=jn;jn|=1;var n=Bo.transition,r=sr;try{if(Bo.transition=null,sr=1,t)return t()}finally{sr=r,Bo.transition=n,jn=e,!(jn&6)&&jc()}}function xL(){uo=Sh.current,$r(Sh)}function Bu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,sq(n)),yi!==null)for(n=yi.return;n!==null;){var r=n;switch(tL(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&S0();break;case 3:qh(),$r(js),$r(fs),uL();break;case 5:cL(r);break;case 4:qh();break;case 13:$r(Vr);break;case 19:$r(Vr);break;case 10:sL(r.type._context);break;case 22:case 23:xL()}n=n.return}if(zi=t,yi=t=kc(t.current,null),Zi=uo=e,Ii=0,jm=null,_L=Fv=Ku=0,Ns=mm=null,Du!==null){for(e=0;e<Du.length;e++)if(n=Du[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var c=s.next;s.next=i,r.next=c}n.pending=r}Du=null}return t}function n8(t,e){do{var n=yi;try{if(iL(),W_.current=k0,M0){for(var r=Hr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}M0=!1}if(Wu=0,Oi=Ci=Hr=null,fm=!1,Um=0,yL.current=null,n===null||n.return===null){Ii=1,jm=e,yi=null;break}e:{var s=t,c=n.return,o=n,f=e;if(e=Zi,o.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var m=f,x=o,S=x.tag;if(!(x.mode&1)&&(S===0||S===11||S===15)){var T=x.alternate;T?(x.updateQueue=T.updateQueue,x.memoizedState=T.memoizedState,x.lanes=T.lanes):(x.updateQueue=null,x.memoizedState=null)}var C=w4(c);if(C!==null){C.flags&=-257,E4(C,c,o,s,e),C.mode&1&&x4(s,m,e),e=C,f=m;var R=e.updateQueue;if(R===null){var D=new Set;D.add(f),e.updateQueue=D}else R.add(f);break e}else{if(!(e&1)){x4(s,m,e),wL();break e}f=Error(ct(426))}}else if(Dr&&o.mode&1){var H=w4(c);if(H!==null){!(H.flags&65536)&&(H.flags|=256),E4(H,c,o,s,e),nL(Xh(f,o));break e}}s=f=Xh(f,o),Ii!==4&&(Ii=2),mm===null?mm=[s]:mm.push(s),s=c;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var F=NF(s,f,e);p4(s,F);break e;case 1:o=f;var k=s.type,N=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&($c===null||!$c.has(N)))){s.flags|=65536,e&=-e,s.lanes|=e;var U=BF(s,o,e);p4(s,U);break e}}s=s.return}while(s!==null)}s8(n)}catch(ie){e=ie,yi===n&&n!==null&&(yi=n=n.return);continue}break}while(1)}function r8(){var t=O0.current;return O0.current=k0,t===null?k0:t}function wL(){(Ii===0||Ii===3||Ii===2)&&(Ii=4),zi===null||!(Ku&268435455)&&!(Fv&268435455)||bc(zi,Zi)}function z0(t,e){var n=jn;jn|=2;var r=r8();(zi!==t||Zi!==e)&&(gl=null,Bu(t,e));do try{Lq();break}catch(i){n8(t,i)}while(1);if(iL(),jn=n,O0.current=r,yi!==null)throw Error(ct(261));return zi=null,Zi=0,Ii}function Lq(){for(;yi!==null;)i8(yi)}function Rq(){for(;yi!==null&&!nK();)i8(yi)}function i8(t){var e=a8(t.alternate,t,uo);t.memoizedProps=t.pendingProps,e===null?s8(t):yi=e,yL.current=null}function s8(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Tq(n,e),n!==null){n.flags&=32767,yi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ii=6,yi=null;return}}else if(n=Eq(n,e,uo),n!==null){yi=n;return}if(e=e.sibling,e!==null){yi=e;return}yi=e=t}while(e!==null);Ii===0&&(Ii=5)}function Cu(t,e,n){var r=sr,i=Bo.transition;try{Bo.transition=null,sr=1,$q(t,e,n,r)}finally{Bo.transition=i,sr=r}return null}function $q(t,e,n,r){do Dh();while(Ec!==null);if(jn&6)throw Error(ct(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ct(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(hK(t,s),t===zi&&(yi=zi=null,Zi=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||t_||(t_=!0,l8(v0,function(){return Dh(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Bo.transition,Bo.transition=null;var c=sr;sr=1;var o=jn;jn|=4,yL.current=null,Aq(t,n),QF(n,t),JK(a2),x0=!!o2,a2=o2=null,t.current=n,Pq(n),rK(),jn=o,sr=c,Bo.transition=s}else t.current=n;if(t_&&(t_=!1,Ec=t,F0=i),s=t.pendingLanes,s===0&&($c=null),oK(n.stateNode),Ws(t,ci()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(D0)throw D0=!1,t=P2,P2=null,t;return F0&1&&t.tag!==0&&Dh(),s=t.pendingLanes,s&1?t===C2?gm++:(gm=0,C2=t):gm=0,jc(),null}function Dh(){if(Ec!==null){var t=zD(F0),e=Bo.transition,n=sr;try{if(Bo.transition=null,sr=16>t?16:t,Ec===null)var r=!1;else{if(t=Ec,Ec=null,F0=0,jn&6)throw Error(ct(331));var i=jn;for(jn|=4,Bt=t.current;Bt!==null;){var s=Bt,c=s.child;if(Bt.flags&16){var o=s.deletions;if(o!==null){for(var f=0;f<o.length;f++){var m=o[f];for(Bt=m;Bt!==null;){var x=Bt;switch(x.tag){case 0:case 11:case 15:pm(8,x,s)}var S=x.child;if(S!==null)S.return=x,Bt=S;else for(;Bt!==null;){x=Bt;var T=x.sibling,C=x.return;if(ZF(x),x===m){Bt=null;break}if(T!==null){T.return=C,Bt=T;break}Bt=C}}}var R=s.alternate;if(R!==null){var D=R.child;if(D!==null){R.child=null;do{var H=D.sibling;D.sibling=null,D=H}while(D!==null)}}Bt=s}}if(s.subtreeFlags&2064&&c!==null)c.return=s,Bt=c;else e:for(;Bt!==null;){if(s=Bt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:pm(9,s,s.return)}var F=s.sibling;if(F!==null){F.return=s.return,Bt=F;break e}Bt=s.return}}var k=t.current;for(Bt=k;Bt!==null;){c=Bt;var N=c.child;if(c.subtreeFlags&2064&&N!==null)N.return=c,Bt=N;else e:for(c=k;Bt!==null;){if(o=Bt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Dv(9,o)}}catch(ie){ti(o,o.return,ie)}if(o===c){Bt=null;break e}var U=o.sibling;if(U!==null){U.return=o.return,Bt=U;break e}Bt=o.return}}if(jn=i,jc(),Ua&&typeof Ua.onPostCommitFiberRoot=="function")try{Ua.onPostCommitFiberRoot(Cv,t)}catch{}r=!0}return r}finally{sr=n,Bo.transition=e}}return!1}function D4(t,e,n){e=Xh(n,e),e=NF(t,e,1),t=Rc(t,e,1),e=Ls(),t!==null&&(cg(t,1,e),Ws(t,e))}function ti(t,e,n){if(t.tag===3)D4(t,t,n);else for(;e!==null;){if(e.tag===3){D4(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&($c===null||!$c.has(r))){t=Xh(n,t),t=BF(e,t,1),e=Rc(e,t,1),t=Ls(),e!==null&&(cg(e,1,t),Ws(e,t));break}}e=e.return}}function Mq(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ls(),t.pingedLanes|=t.suspendedLanes&n,zi===t&&(Zi&n)===n&&(Ii===4||Ii===3&&(Zi&130023424)===Zi&&500>ci()-vL?Bu(t,0):_L|=n),Ws(t,e)}function o8(t,e){e===0&&(t.mode&1?(e=Hy,Hy<<=1,!(Hy&130023424)&&(Hy=4194304)):e=1);var n=Ls();t=Il(t,e),t!==null&&(cg(t,e,n),Ws(t,n))}function kq(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),o8(t,n)}function Oq(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ct(314))}r!==null&&r.delete(e),o8(t,n)}var a8;a8=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||js.current)Gs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Gs=!1,wq(t,e,n);Gs=!!(t.flags&131072)}else Gs=!1,Dr&&e.flags&1048576&&uF(e,C0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;q_(t,e),t=e.pendingProps;var i=Hh(e,fs.current);Oh(e,n),i=hL(null,e,r,t,i,n);var s=fL();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Hs(r)?(s=!0,A0(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,aL(e),i.updater=kv,e.stateNode=i,i._reactInternals=e,g2(e,r,t,n),e=v2(null,e,r,!0,s,n)):(e.tag=0,Dr&&s&&eL(e),Ss(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(q_(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Fq(r),t=na(r,t),i){case 0:e=_2(null,e,r,t,n);break e;case 1:e=A4(null,e,r,t,n);break e;case 11:e=T4(null,e,r,t,n);break e;case 14:e=S4(null,e,r,na(r.type,t),n);break e}throw Error(ct(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:na(r,i),_2(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:na(r,i),A4(t,e,r,i,n);case 3:e:{if(jF(e),t===null)throw Error(ct(387));r=e.pendingProps,s=e.memoizedState,i=s.element,pF(t,e),R0(e,r,null,n);var c=e.memoizedState;if(r=c.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Xh(Error(ct(423)),e),e=P4(t,e,r,n,i);break e}else if(r!==i){i=Xh(Error(ct(424)),e),e=P4(t,e,r,n,i);break e}else for(go=Lc(e.stateNode.containerInfo.firstChild),_o=e,Dr=!0,sa=null,n=_F(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Wh(),r===i){e=Ll(t,e,n);break e}Ss(t,e,r,n)}e=e.child}return e;case 5:return vF(e),t===null&&f2(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,c=i.children,l2(r,i)?c=null:s!==null&&l2(r,s)&&(e.flags|=32),GF(t,e),Ss(t,e,c,n),e.child;case 6:return t===null&&f2(e),null;case 13:return HF(t,e,n);case 4:return lL(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Kh(e,null,r,n):Ss(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:na(r,i),T4(t,e,r,i,n);case 7:return Ss(t,e,e.pendingProps,n),e.child;case 8:return Ss(t,e,e.pendingProps.children,n),e.child;case 12:return Ss(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,c=i.value,xr(I0,r._currentValue),r._currentValue=c,s!==null)if(ha(s.value,c)){if(s.children===i.children&&!js.current){e=Ll(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){c=s.child;for(var f=o.firstContext;f!==null;){if(f.context===r){if(s.tag===1){f=Sl(-1,n&-n),f.tag=2;var m=s.updateQueue;if(m!==null){m=m.shared;var x=m.pending;x===null?f.next=f:(f.next=x.next,x.next=f),m.pending=f}}s.lanes|=n,f=s.alternate,f!==null&&(f.lanes|=n),p2(s.return,n,e),o.lanes|=n;break}f=f.next}}else if(s.tag===10)c=s.type===e.type?null:s.child;else if(s.tag===18){if(c=s.return,c===null)throw Error(ct(341));c.lanes|=n,o=c.alternate,o!==null&&(o.lanes|=n),p2(c,n,e),c=s.sibling}else c=s.child;if(c!==null)c.return=s;else for(c=s;c!==null;){if(c===e){c=null;break}if(s=c.sibling,s!==null){s.return=c.return,c=s;break}c=c.return}s=c}Ss(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Oh(e,n),i=Vo(i),r=r(i),e.flags|=1,Ss(t,e,r,n),e.child;case 14:return r=e.type,i=na(r,e.pendingProps),i=na(r.type,i),S4(t,e,r,i,n);case 15:return UF(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:na(r,i),q_(t,e),e.tag=1,Hs(r)?(t=!0,A0(e)):t=!1,Oh(e,n),gF(e,r,i),g2(e,r,i,n),v2(null,e,r,!0,t,n);case 19:return WF(t,e,n);case 22:return VF(t,e,n)}throw Error(ct(156,e.tag))};function l8(t,e){return kD(t,e)}function Dq(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function No(t,e,n,r){return new Dq(t,e,n,r)}function EL(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Fq(t){if(typeof t=="function")return EL(t)?1:0;if(t!=null){if(t=t.$$typeof,t===VI)return 11;if(t===GI)return 14}return 2}function kc(t,e){var n=t.alternate;return n===null?(n=No(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Y_(t,e,n,r,i,s){var c=2;if(r=t,typeof t=="function")EL(t)&&(c=1);else if(typeof t=="string")c=5;else e:switch(t){case mh:return Uu(n.children,i,s,e);case UI:c=8,i|=8;break;case Bw:return t=No(12,n,e,i|2),t.elementType=Bw,t.lanes=s,t;case Uw:return t=No(13,n,e,i),t.elementType=Uw,t.lanes=s,t;case Vw:return t=No(19,n,e,i),t.elementType=Vw,t.lanes=s,t;case yD:return zv(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case mD:c=10;break e;case gD:c=9;break e;case VI:c=11;break e;case GI:c=14;break e;case mc:c=16,r=null;break e}throw Error(ct(130,t==null?t:typeof t,""))}return e=No(c,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Uu(t,e,n,r){return t=No(7,t,r,e),t.lanes=n,t}function zv(t,e,n,r){return t=No(22,t,r,e),t.elementType=yD,t.lanes=n,t.stateNode={isHidden:!1},t}function ax(t,e,n){return t=No(6,t,null,e),t.lanes=n,t}function lx(t,e,n){return e=No(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function zq(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=V1(0),this.expirationTimes=V1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=V1(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function TL(t,e,n,r,i,s,c,o,f){return t=new zq(t,e,n,o,f),e===1?(e=1,s===!0&&(e|=8)):e=0,s=No(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},aL(s),t}function Nq(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ph,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function c8(t){if(!t)return Bc;t=t._reactInternals;e:{if(cd(t)!==t||t.tag!==1)throw Error(ct(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Hs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ct(171))}if(t.tag===1){var n=t.type;if(Hs(n))return lF(t,n,e)}return e}function u8(t,e,n,r,i,s,c,o,f){return t=TL(n,r,!0,t,i,s,c,o,f),t.context=c8(null),n=t.current,r=Ls(),i=Mc(n),s=Sl(r,i),s.callback=e??null,Rc(n,s,i),t.current.lanes=i,cg(t,i,r),Ws(t,r),t}function Nv(t,e,n,r){var i=e.current,s=Ls(),c=Mc(i);return n=c8(n),e.context===null?e.context=n:e.pendingContext=n,e=Sl(s,c),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Rc(i,e,c),t!==null&&(ua(t,i,c,s),H_(t,i,c)),c}function N0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function F4(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function SL(t,e){F4(t,e),(t=t.alternate)&&F4(t,e)}function Bq(){return null}var d8=typeof reportError=="function"?reportError:function(t){console.error(t)};function AL(t){this._internalRoot=t}Bv.prototype.render=AL.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ct(409));Nv(t,e,null,null)};Bv.prototype.unmount=AL.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;qu(function(){Nv(null,t,null,null)}),e[Cl]=null}};function Bv(t){this._internalRoot=t}Bv.prototype.unstable_scheduleHydration=function(t){if(t){var e=UD();t={blockedOn:null,target:t,priority:e};for(var n=0;n<vc.length&&e!==0&&e<vc[n].priority;n++);vc.splice(n,0,t),n===0&&GD(t)}};function PL(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Uv(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function z4(){}function Uq(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var m=N0(c);s.call(m)}}var c=u8(e,r,t,0,null,!1,!1,"",z4);return t._reactRootContainer=c,t[Cl]=c.current,Dm(t.nodeType===8?t.parentNode:t),qu(),c}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var m=N0(f);o.call(m)}}var f=TL(t,0,!1,null,null,!1,!1,"",z4);return t._reactRootContainer=f,t[Cl]=f.current,Dm(t.nodeType===8?t.parentNode:t),qu(function(){Nv(e,f,n,r)}),f}function Vv(t,e,n,r,i){var s=n._reactRootContainer;if(s){var c=s;if(typeof i=="function"){var o=i;i=function(){var f=N0(c);o.call(f)}}Nv(e,c,t,i)}else c=Uq(n,e,t,i,r);return N0(c)}ND=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Yp(e.pendingLanes);n!==0&&(WI(e,n|1),Ws(e,ci()),!(jn&6)&&(Zh=ci()+500,jc()))}break;case 13:qu(function(){var r=Il(t,1);if(r!==null){var i=Ls();ua(r,t,1,i)}}),SL(t,1)}};KI=function(t){if(t.tag===13){var e=Il(t,134217728);if(e!==null){var n=Ls();ua(e,t,134217728,n)}SL(t,134217728)}};BD=function(t){if(t.tag===13){var e=Mc(t),n=Il(t,e);if(n!==null){var r=Ls();ua(n,t,e,r)}SL(t,e)}};UD=function(){return sr};VD=function(t,e){var n=sr;try{return sr=t,e()}finally{sr=n}};Jw=function(t,e,n){switch(e){case"input":if(Hw(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=$v(r);if(!i)throw Error(ct(90));vD(r),Hw(r,i)}}}break;case"textarea":xD(t,n);break;case"select":e=n.value,e!=null&&Rh(t,!!n.multiple,e,!1)}};CD=bL;ID=qu;var Vq={usingClientEntryPoint:!1,Events:[dg,vh,$v,AD,PD,bL]},Cp={findFiberByHostInstance:Ou,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Gq={bundleType:Cp.bundleType,version:Cp.version,rendererPackageName:Cp.rendererPackageName,rendererConfig:Cp.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:kl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=$D(t),t===null?null:t.stateNode},findFiberByHostInstance:Cp.findFiberByHostInstance||Bq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var n_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!n_.isDisabled&&n_.supportsFiber)try{Cv=n_.inject(Gq),Ua=n_}catch{}}Eo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vq;Eo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!PL(e))throw Error(ct(200));return Nq(t,e,null,n)};Eo.createRoot=function(t,e){if(!PL(t))throw Error(ct(299));var n=!1,r="",i=d8;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=TL(t,1,!1,null,null,n,!1,r,i),t[Cl]=e.current,Dm(t.nodeType===8?t.parentNode:t),new AL(e)};Eo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ct(188)):(t=Object.keys(t).join(","),Error(ct(268,t)));return t=$D(e),t=t===null?null:t.stateNode,t};Eo.flushSync=function(t){return qu(t)};Eo.hydrate=function(t,e,n){if(!Uv(e))throw Error(ct(200));return Vv(null,t,e,!0,n)};Eo.hydrateRoot=function(t,e,n){if(!PL(t))throw Error(ct(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",c=d8;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(c=n.onRecoverableError)),e=u8(e,null,t,1,n??null,i,!1,s,c),t[Cl]=e.current,Dm(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Bv(e)};Eo.render=function(t,e,n){if(!Uv(e))throw Error(ct(200));return Vv(null,t,e,!1,n)};Eo.unmountComponentAtNode=function(t){if(!Uv(t))throw Error(ct(40));return t._reactRootContainer?(qu(function(){Vv(null,null,t,!1,function(){t._reactRootContainer=null,t[Cl]=null})}),!0):!1};Eo.unstable_batchedUpdates=bL;Eo.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Uv(n))throw Error(ct(200));if(t==null||t._reactInternals===void 0)throw Error(ct(38));return Vv(t,e,n,!1,r)};Eo.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=Eo})(BW);const Ah=rD(Gu);var N4=Gu;Fw.createRoot=N4.createRoot,Fw.hydrateRoot=N4.hydrateRoot;function jq(t){const e=new Error(t);if(e.stack===void 0)try{throw e}catch{}return e}var Hq=jq,Tn=Hq;function Wq(t){return!!t&&typeof t.then=="function"}var Rr=Wq;function Kq(t,e){if(t!=null)return t;throw Tn(e??"Got unexpected null or undefined")}var Fr=Kq;function xn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Gv{getValue(){throw Tn("BaseLoadable")}toPromise(){throw Tn("BaseLoadable")}valueMaybe(){throw Tn("BaseLoadable")}valueOrThrow(){throw Tn(`Loadable expected value, but in "${this.state}" state`)}promiseMaybe(){throw Tn("BaseLoadable")}promiseOrThrow(){throw Tn(`Loadable expected promise, but in "${this.state}" state`)}errorMaybe(){throw Tn("BaseLoadable")}errorOrThrow(){throw Tn(`Loadable expected error, but in "${this.state}" state`)}is(e){return e.state===this.state&&e.contents===this.contents}map(e){throw Tn("BaseLoadable")}}class qq extends Gv{constructor(e){super(),xn(this,"state","hasValue"),xn(this,"contents",void 0),this.contents=e}getValue(){return this.contents}toPromise(){return Promise.resolve(this.contents)}valueMaybe(){return this.contents}valueOrThrow(){return this.contents}promiseMaybe(){}errorMaybe(){}map(e){try{const n=e(this.contents);return Rr(n)?Xu(n):Yh(n)?n:fg(n)}catch(n){return Rr(n)?Xu(n.next(()=>this.map(e))):jv(n)}}}class Xq extends Gv{constructor(e){super(),xn(this,"state","hasError"),xn(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return Promise.reject(this.contents)}valueMaybe(){}promiseMaybe(){}errorMaybe(){return this.contents}errorOrThrow(){return this.contents}map(e){return this}}class h8 extends Gv{constructor(e){super(),xn(this,"state","loading"),xn(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return this.contents}valueMaybe(){}promiseMaybe(){return this.contents}promiseOrThrow(){return this.contents}errorMaybe(){}map(e){return Xu(this.contents.then(n=>{const r=e(n);if(Yh(r)){const i=r;switch(i.state){case"hasValue":return i.contents;case"hasError":throw i.contents;case"loading":return i.contents}}return r}).catch(n=>{if(Rr(n))return n.then(()=>this.map(e).contents);throw n}))}}function fg(t){return Object.freeze(new qq(t))}function jv(t){return Object.freeze(new Xq(t))}function Xu(t){return Object.freeze(new h8(t))}function f8(){return Object.freeze(new h8(new Promise(()=>{})))}function Zq(t){return t.every(e=>e.state==="hasValue")?fg(t.map(e=>e.contents)):t.some(e=>e.state==="hasError")?jv(Fr(t.find(e=>e.state==="hasError"),"Invalid loadable passed to loadableAll").contents):Xu(Promise.all(t.map(e=>e.contents)))}function p8(t){const n=(Array.isArray(t)?t:Object.getOwnPropertyNames(t).map(i=>t[i])).map(i=>Yh(i)?i:Rr(i)?Xu(i):fg(i)),r=Zq(n);return Array.isArray(t)?r:r.map(i=>Object.getOwnPropertyNames(t).reduce((s,c,o)=>({...s,[c]:i[o]}),{}))}function Yh(t){return t instanceof Gv}const Yq={of:t=>Rr(t)?Xu(t):Yh(t)?t:fg(t),error:t=>jv(t),loading:()=>f8(),all:p8,isLoadable:Yh};var ud={loadableWithValue:fg,loadableWithError:jv,loadableWithPromise:Xu,loadableLoading:f8,loadableAll:p8,isLoadable:Yh,RecoilLoadable:Yq},Jq=ud.loadableWithValue,Qq=ud.loadableWithError,eX=ud.loadableWithPromise,tX=ud.loadableLoading,nX=ud.loadableAll,rX=ud.isLoadable,iX=ud.RecoilLoadable,pg=Object.freeze({__proto__:null,loadableWithValue:Jq,loadableWithError:Qq,loadableWithPromise:eX,loadableLoading:tX,loadableAll:nX,isLoadable:rX,RecoilLoadable:iX});const R2={RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED:!0,RECOIL_GKS_ENABLED:new Set(["recoil_hamt_2020","recoil_sync_external_store","recoil_suppress_rerender_in_callback","recoil_memory_managament_2020"])};function sX(t,e){var n,r;const i=(n=process.env[t])===null||n===void 0||(r=n.toLowerCase())===null||r===void 0?void 0:r.trim();if(i==null||i==="")return;if(!["true","false"].includes(i))throw Tn(`({}).${t} value must be 'true', 'false', or empty: ${i}`);e(i==="true")}function oX(t,e){var n;const r=(n=process.env[t])===null||n===void 0?void 0:n.trim();r==null||r===""||e(r.split(/\s*,\s*|\s+/))}function aX(){var t;typeof process>"u"||((t=process)===null||t===void 0?void 0:t.env)!=null&&(sX("RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED",e=>{R2.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED=e}),oX("RECOIL_GKS_ENABLED",e=>{e.forEach(n=>{R2.RECOIL_GKS_ENABLED.add(n)})}))}aX();var bf=R2;function Hv(t){return bf.RECOIL_GKS_ENABLED.has(t)}Hv.setPass=t=>{bf.RECOIL_GKS_ENABLED.add(t)};Hv.setFail=t=>{bf.RECOIL_GKS_ENABLED.delete(t)};Hv.clear=()=>{bf.RECOIL_GKS_ENABLED.clear()};var mr=Hv;function lX(t,e,{error:n}={}){return null}var cX=lX,CL=cX,cx,ux,dx;const uX=(cx=ce.createMutableSource)!==null&&cx!==void 0?cx:ce.unstable_createMutableSource,m8=(ux=ce.useMutableSource)!==null&&ux!==void 0?ux:ce.unstable_useMutableSource,g8=(dx=ce.useSyncExternalStore)!==null&&dx!==void 0?dx:ce.unstable_useSyncExternalStore;function dX(){var t;const{ReactCurrentDispatcher:e,ReactCurrentOwner:n}=ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;return((t=e==null?void 0:e.current)!==null&&t!==void 0?t:n.currentDispatcher).useSyncExternalStore!=null}function hX(){return mr("recoil_transition_support")?{mode:"TRANSITION_SUPPORT",early:!0,concurrent:!0}:mr("recoil_sync_external_store")&&g8!=null?{mode:"SYNC_EXTERNAL_STORE",early:!0,concurrent:!1}:mr("recoil_mutable_source")&&m8!=null&&typeof window<"u"&&!window.$disableRecoilValueMutableSource_TEMP_HACK_DO_NOT_USE?mr("recoil_suppress_rerender_in_callback")?{mode:"MUTABLE_SOURCE",early:!0,concurrent:!0}:{mode:"MUTABLE_SOURCE",early:!1,concurrent:!1}:mr("recoil_suppress_rerender_in_callback")?{mode:"LEGACY",early:!0,concurrent:!1}:{mode:"LEGACY",early:!1,concurrent:!1}}function fX(){return!1}var mg={createMutableSource:uX,useMutableSource:m8,useSyncExternalStore:g8,currentRendererSupportsUseSyncExternalStore:dX,reactMode:hX,isFastRefreshEnabled:fX};class IL{constructor(e){xn(this,"key",void 0),this.key=e}toJSON(){return{key:this.key}}}class y8 extends IL{}class _8 extends IL{}function pX(t){return t instanceof y8||t instanceof _8}var Wv={AbstractRecoilValue:IL,RecoilState:y8,RecoilValueReadOnly:_8,isRecoilValue:pX},mX=Wv.AbstractRecoilValue,gX=Wv.RecoilState,yX=Wv.RecoilValueReadOnly,_X=Wv.isRecoilValue,Jh=Object.freeze({__proto__:null,AbstractRecoilValue:mX,RecoilState:gX,RecoilValueReadOnly:yX,isRecoilValue:_X});function vX(t,e){return function*(){let n=0;for(const r of t)yield e(r,n++)}()}var Kv=vX;class v8{}const bX=new v8,Zu=new Map,LL=new Map;function xX(t){return Kv(t,e=>Fr(LL.get(e)))}function wX(t){if(Zu.has(t)){const e=`Duplicate atom key "${t}". This is a FATAL ERROR in
      production. But it is safe to ignore this warning if it occurred because of
      hot module replacement.`;console.warn(e)}}function EX(t){bf.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED&&wX(t.key),Zu.set(t.key,t);const e=t.set==null?new Jh.RecoilValueReadOnly(t.key):new Jh.RecoilState(t.key);return LL.set(t.key,e),e}class b8 extends Error{}function TX(t){const e=Zu.get(t);if(e==null)throw new b8(`Missing definition for RecoilValue: "${t}""`);return e}function SX(t){return Zu.get(t)}const B0=new Map;function AX(t){var e;if(!mr("recoil_memory_managament_2020"))return;const n=Zu.get(t);if(n!=null&&(e=n.shouldDeleteConfigOnRelease)!==null&&e!==void 0&&e.call(n)){var r;Zu.delete(t),(r=x8(t))===null||r===void 0||r(),B0.delete(t)}}function PX(t,e){mr("recoil_memory_managament_2020")&&(e===void 0?B0.delete(t):B0.set(t,e))}function x8(t){return B0.get(t)}var qs={nodes:Zu,recoilValues:LL,registerNode:EX,getNode:TX,getNodeMaybe:SX,deleteNodeConfigIfPossible:AX,setConfigDeletionHandler:PX,getConfigDeletionHandler:x8,recoilValuesForKeys:xX,NodeMissingError:b8,DefaultValue:v8,DEFAULT_VALUE:bX};function CX(t,e){e()}var IX={enqueueExecution:CX};function LX(t,e){return e={exports:{}},t(e,e.exports),e.exports}var RX=LX(function(t){var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Me){return typeof Me}:function(Me){return Me&&typeof Symbol=="function"&&Me.constructor===Symbol&&Me!==Symbol.prototype?"symbol":typeof Me},n={},r=5,i=Math.pow(2,r),s=i-1,c=i/2,o=i/4,f={},m=function(Ae){return function(){return Ae}},x=n.hash=function(Me){var Ae=typeof Me>"u"?"undefined":e(Me);if(Ae==="number")return Me;Ae!=="string"&&(Me+="");for(var Ce=0,Ye=0,Ze=Me.length;Ye<Ze;++Ye){var gt=Me.charCodeAt(Ye);Ce=(Ce<<5)-Ce+gt|0}return Ce},S=function(Ae){return Ae-=Ae>>1&1431655765,Ae=(Ae&858993459)+(Ae>>2&858993459),Ae=Ae+(Ae>>4)&252645135,Ae+=Ae>>8,Ae+=Ae>>16,Ae&127},T=function(Ae,Ce){return Ce>>>Ae&s},C=function(Ae){return 1<<Ae},R=function(Ae,Ce){return S(Ae&Ce-1)},D=function(Ae,Ce,Ye,Ze){var gt=Ze;if(!Ae){var Ht=Ze.length;gt=new Array(Ht);for(var it=0;it<Ht;++it)gt[it]=Ze[it]}return gt[Ce]=Ye,gt},H=function(Ae,Ce,Ye){var Ze=Ye.length-1,gt=0,Ht=0,it=Ye;if(Ae)gt=Ht=Ce;else for(it=new Array(Ze);gt<Ce;)it[Ht++]=Ye[gt++];for(++gt;gt<=Ze;)it[Ht++]=Ye[gt++];return Ae&&(it.length=Ze),it},F=function(Ae,Ce,Ye,Ze){var gt=Ze.length;if(Ae){for(var Ht=gt;Ht>=Ce;)Ze[Ht--]=Ze[Ht];return Ze[Ce]=Ye,Ze}for(var it=0,Ut=0,Wt=new Array(gt+1);it<Ce;)Wt[Ut++]=Ze[it++];for(Wt[Ce]=Ye;it<gt;)Wt[++Ut]=Ze[it++];return Wt},k=1,N=2,U=3,ie=4,he={__hamt_isEmpty:!0},le=function(Ae){return Ae===he||Ae&&Ae.__hamt_isEmpty},ve=function(Ae,Ce,Ye,Ze){return{type:k,edit:Ae,hash:Ce,key:Ye,value:Ze,_modify:ot}},Oe=function(Ae,Ce,Ye){return{type:N,edit:Ae,hash:Ce,children:Ye,_modify:It}},Re=function(Ae,Ce,Ye){return{type:U,edit:Ae,mask:Ce,children:Ye,_modify:at}},Ee=function(Ae,Ce,Ye){return{type:ie,edit:Ae,size:Ce,children:Ye,_modify:kt}},$e=function(Ae){return Ae===he||Ae.type===k||Ae.type===N},we=function(Ae,Ce,Ye,Ze,gt){for(var Ht=[],it=Ze,Ut=0,Wt=0;it;++Wt)it&1&&(Ht[Wt]=gt[Ut++]),it>>>=1;return Ht[Ce]=Ye,Ee(Ae,Ut+1,Ht)},Be=function(Ae,Ce,Ye,Ze){for(var gt=new Array(Ce-1),Ht=0,it=0,Ut=0,Wt=Ze.length;Ut<Wt;++Ut)if(Ut!==Ye){var Dn=Ze[Ut];Dn&&!le(Dn)&&(gt[Ht++]=Dn,it|=1<<Ut)}return Re(Ae,it,gt)},Jt=function Me(Ae,Ce,Ye,Ze,gt,Ht){if(Ye===gt)return Oe(Ae,Ye,[Ht,Ze]);var it=T(Ce,Ye),Ut=T(Ce,gt);return Re(Ae,C(it)|C(Ut),it===Ut?[Me(Ae,Ce+r,Ye,Ze,gt,Ht)]:it<Ut?[Ze,Ht]:[Ht,Ze])},mt=function(Ae,Ce,Ye,Ze,gt,Ht,it,Ut){for(var Wt=gt.length,Dn=0;Dn<Wt;++Dn){var An=gt[Dn];if(Ye(it,An.key)){var Pn=An.value,on=Ht(Pn);return on===Pn?gt:on===f?(--Ut.value,H(Ae,Dn,gt)):D(Ae,Dn,ve(Ce,Ze,it,on),gt)}}var qr=Ht();return qr===f?gt:(++Ut.value,D(Ae,Wt,ve(Ce,Ze,it,qr),gt))},an=function(Ae,Ce){return Ae===Ce.edit},ot=function(Ae,Ce,Ye,Ze,gt,Ht,it){if(Ce(Ht,this.key)){var Ut=Ze(this.value);return Ut===this.value?this:Ut===f?(--it.value,he):an(Ae,this)?(this.value=Ut,this):ve(Ae,gt,Ht,Ut)}var Wt=Ze();return Wt===f?this:(++it.value,Jt(Ae,Ye,this.hash,this,gt,ve(Ae,gt,Ht,Wt)))},It=function(Ae,Ce,Ye,Ze,gt,Ht,it){if(gt===this.hash){var Ut=an(Ae,this),Wt=mt(Ut,Ae,Ce,this.hash,this.children,Ze,Ht,it);return Wt===this.children?this:Wt.length>1?Oe(Ae,this.hash,Wt):Wt[0]}var Dn=Ze();return Dn===f?this:(++it.value,Jt(Ae,Ye,this.hash,this,gt,ve(Ae,gt,Ht,Dn)))},at=function(Ae,Ce,Ye,Ze,gt,Ht,it){var Ut=this.mask,Wt=this.children,Dn=T(Ye,gt),An=C(Dn),Pn=R(Ut,An),on=Ut&An,qr=on?Wt[Pn]:he,ri=qr._modify(Ae,Ce,Ye+r,Ze,gt,Ht,it);if(qr===ri)return this;var xi=an(Ae,this),Gi=Ut,es=void 0;if(on&&le(ri)){if(Gi&=~An,!Gi)return he;if(Wt.length<=2&&$e(Wt[Pn^1]))return Wt[Pn^1];es=H(xi,Pn,Wt)}else if(!on&&!le(ri)){if(Wt.length>=c)return we(Ae,Dn,ri,Ut,Wt);Gi|=An,es=F(xi,Pn,ri,Wt)}else es=D(xi,Pn,ri,Wt);return xi?(this.mask=Gi,this.children=es,this):Re(Ae,Gi,es)},kt=function(Ae,Ce,Ye,Ze,gt,Ht,it){var Ut=this.size,Wt=this.children,Dn=T(Ye,gt),An=Wt[Dn],Pn=(An||he)._modify(Ae,Ce,Ye+r,Ze,gt,Ht,it);if(An===Pn)return this;var on=an(Ae,this),qr=void 0;if(le(An)&&!le(Pn))++Ut,qr=D(on,Dn,Pn,Wt);else if(!le(An)&&le(Pn)){if(--Ut,Ut<=o)return Be(Ae,Ut,Dn,Wt);qr=D(on,Dn,he,Wt)}else qr=D(on,Dn,Pn,Wt);return on?(this.size=Ut,this.children=qr,this):Ee(Ae,Ut,qr)};he._modify=function(Me,Ae,Ce,Ye,Ze,gt,Ht){var it=Ye();return it===f?he:(++Ht.value,ve(Me,Ze,gt,it))};function Pe(Me,Ae,Ce,Ye,Ze){this._editable=Me,this._edit=Ae,this._config=Ce,this._root=Ye,this._size=Ze}Pe.prototype.setTree=function(Me,Ae){return this._editable?(this._root=Me,this._size=Ae,this):Me===this._root?this:new Pe(this._editable,this._edit,this._config,Me,Ae)};var Ke=n.tryGetHash=function(Me,Ae,Ce,Ye){for(var Ze=Ye._root,gt=0,Ht=Ye._config.keyEq;;)switch(Ze.type){case k:return Ht(Ce,Ze.key)?Ze.value:Me;case N:{if(Ae===Ze.hash)for(var it=Ze.children,Ut=0,Wt=it.length;Ut<Wt;++Ut){var Dn=it[Ut];if(Ht(Ce,Dn.key))return Dn.value}return Me}case U:{var An=T(gt,Ae),Pn=C(An);if(Ze.mask&Pn){Ze=Ze.children[R(Ze.mask,Pn)],gt+=r;break}return Me}case ie:{if(Ze=Ze.children[T(gt,Ae)],Ze){gt+=r;break}return Me}default:return Me}};Pe.prototype.tryGetHash=function(Me,Ae,Ce){return Ke(Me,Ae,Ce,this)};var Je=n.tryGet=function(Me,Ae,Ce){return Ke(Me,Ce._config.hash(Ae),Ae,Ce)};Pe.prototype.tryGet=function(Me,Ae){return Je(Me,Ae,this)};var Ot=n.getHash=function(Me,Ae,Ce){return Ke(void 0,Me,Ae,Ce)};Pe.prototype.getHash=function(Me,Ae){return Ot(Me,Ae,this)},n.get=function(Me,Ae){return Ke(void 0,Ae._config.hash(Me),Me,Ae)},Pe.prototype.get=function(Me,Ae){return Je(Ae,Me,this)};var ht=n.has=function(Me,Ae,Ce){return Ke(f,Me,Ae,Ce)!==f};Pe.prototype.hasHash=function(Me,Ae){return ht(Me,Ae,this)};var Ct=n.has=function(Me,Ae){return ht(Ae._config.hash(Me),Me,Ae)};Pe.prototype.has=function(Me){return Ct(Me,this)};var Zt=function(Ae,Ce){return Ae===Ce};n.make=function(Me){return new Pe(0,0,{keyEq:Me&&Me.keyEq||Zt,hash:Me&&Me.hash||x},he,0)},n.empty=n.make();var lt=n.isEmpty=function(Me){return Me&&!!le(Me._root)};Pe.prototype.isEmpty=function(){return lt(this)};var en=n.modifyHash=function(Me,Ae,Ce,Ye){var Ze={value:Ye._size},gt=Ye._root._modify(Ye._editable?Ye._edit:NaN,Ye._config.keyEq,0,Me,Ae,Ce,Ze);return Ye.setTree(gt,Ze.value)};Pe.prototype.modifyHash=function(Me,Ae,Ce){return en(Ce,Me,Ae,this)};var Nn=n.modify=function(Me,Ae,Ce){return en(Me,Ce._config.hash(Ae),Ae,Ce)};Pe.prototype.modify=function(Me,Ae){return Nn(Ae,Me,this)};var Et=n.setHash=function(Me,Ae,Ce,Ye){return en(m(Ce),Me,Ae,Ye)};Pe.prototype.setHash=function(Me,Ae,Ce){return Et(Me,Ae,Ce,this)};var Dt=n.set=function(Me,Ae,Ce){return Et(Ce._config.hash(Me),Me,Ae,Ce)};Pe.prototype.set=function(Me,Ae){return Dt(Me,Ae,this)};var mn=m(f),Mr=n.removeHash=function(Me,Ae,Ce){return en(mn,Me,Ae,Ce)};Pe.prototype.removeHash=Pe.prototype.deleteHash=function(Me,Ae){return Mr(Me,Ae,this)};var Hn=n.remove=function(Me,Ae){return Mr(Ae._config.hash(Me),Me,Ae)};Pe.prototype.remove=Pe.prototype.delete=function(Me){return Hn(Me,this)};var Qn=n.beginMutation=function(Me){return new Pe(Me._editable+1,Me._edit+1,Me._config,Me._root,Me._size)};Pe.prototype.beginMutation=function(){return Qn(this)};var Zs=n.endMutation=function(Me){return Me._editable=Me._editable&&Me._editable-1,Me};Pe.prototype.endMutation=function(){return Zs(this)};var gn=n.mutate=function(Me,Ae){var Ce=Qn(Ae);return Me(Ce),Zs(Ce)};Pe.prototype.mutate=function(Me){return gn(Me,this)};var ni=function(Ae){return Ae&&gr(Ae[0],Ae[1],Ae[2],Ae[3],Ae[4])},gr=function(Ae,Ce,Ye,Ze,gt){for(;Ye<Ae;){var Ht=Ce[Ye++];if(Ht&&!le(Ht))return ms(Ht,Ze,[Ae,Ce,Ye,Ze,gt])}return ni(gt)},ms=function(Ae,Ce,Ye){switch(Ae.type){case k:return{value:Ce(Ae),rest:Ye};case N:case ie:case U:var Ze=Ae.children;return gr(Ze.length,Ze,0,Ce,Ye);default:return ni(Ye)}},Ho={done:!0};function Ui(Me){this.v=Me}Ui.prototype.next=function(){if(!this.v)return Ho;var Me=this.v;return this.v=ni(Me.rest),Me},Ui.prototype[Symbol.iterator]=function(){return this};var Vi=function(Ae,Ce){return new Ui(ms(Ae._root,Ce))},So=function(Ae){return[Ae.key,Ae.value]},Qi=n.entries=function(Me){return Vi(Me,So)};Pe.prototype.entries=Pe.prototype[Symbol.iterator]=function(){return Qi(this)};var je=function(Ae){return Ae.key},dt=n.keys=function(Me){return Vi(Me,je)};Pe.prototype.keys=function(){return dt(this)};var Ms=function(Ae){return Ae.value},di=n.values=Pe.prototype.values=function(Me){return Vi(Me,Ms)};Pe.prototype.values=function(){return di(this)};var ln=n.fold=function(Me,Ae,Ce){var Ye=Ce._root;if(Ye.type===k)return Me(Ae,Ye.value,Ye.key);for(var Ze=[Ye.children],gt=void 0;gt=Ze.pop();)for(var Ht=0,it=gt.length;Ht<it;){var Ut=gt[Ht++];Ut&&Ut.type&&(Ut.type===k?Ae=Me(Ae,Ut.value,Ut.key):Ze.push(Ut.children))}return Ae};Pe.prototype.fold=function(Me,Ae){return ln(Me,Ae,this)};var Li=n.forEach=function(Me,Ae){return ln(function(Ce,Ye,Ze){return Me(Ye,Ze,Ae)},null,Ae)};Pe.prototype.forEach=function(Me){return Li(Me,this)};var bi=n.count=function(Me){return Me._size};Pe.prototype.count=function(){return bi(this)},Object.defineProperty(Pe.prototype,"size",{get:Pe.prototype.count}),t.exports?t.exports=n:(void 0).hamt=n});class $X{constructor(e){xn(this,"_map",void 0),this._map=new Map(e==null?void 0:e.entries())}keys(){return this._map.keys()}entries(){return this._map.entries()}get(e){return this._map.get(e)}has(e){return this._map.has(e)}set(e,n){return this._map.set(e,n),this}delete(e){return this._map.delete(e),this}clone(){return $L(this)}toMap(){return new Map(this._map)}}class RL{constructor(e){if(xn(this,"_hamt",RX.empty.beginMutation()),e instanceof RL){const n=e._hamt.endMutation();e._hamt=n.beginMutation(),this._hamt=n.beginMutation()}else if(e)for(const[n,r]of e.entries())this._hamt.set(n,r)}keys(){return this._hamt.keys()}entries(){return this._hamt.entries()}get(e){return this._hamt.get(e)}has(e){return this._hamt.has(e)}set(e,n){return this._hamt.set(e,n),this}delete(e){return this._hamt.delete(e),this}clone(){return $L(this)}toMap(){return new Map(this._hamt)}}function $L(t){return mr("recoil_hamt_2020")?new RL(t):new $X(t)}var MX={persistentMap:$L},kX=MX.persistentMap,OX=Object.freeze({__proto__:null,persistentMap:kX});function DX(t,...e){const n=new Set;e:for(const r of t){for(const i of e)if(i.has(r))continue e;n.add(r)}return n}var ym=DX;function FX(t,e){const n=new Map;return t.forEach((r,i)=>{n.set(i,e(r,i))}),n}var U0=FX;function zX(){return{nodeDeps:new Map,nodeToNodeSubscriptions:new Map}}function NX(t){return{nodeDeps:U0(t.nodeDeps,e=>new Set(e)),nodeToNodeSubscriptions:U0(t.nodeToNodeSubscriptions,e=>new Set(e))}}function hx(t,e,n,r){const{nodeDeps:i,nodeToNodeSubscriptions:s}=n,c=i.get(t);if(c&&r&&c!==r.nodeDeps.get(t))return;i.set(t,e);const o=c==null?e:ym(e,c);for(const f of o)s.has(f)||s.set(f,new Set),Fr(s.get(f)).add(t);if(c){const f=ym(c,e);for(const m of f){if(!s.has(m))return;const x=Fr(s.get(m));x.delete(t),x.size===0&&s.delete(m)}}}function BX(t,e,n,r){var i,s,c,o;const f=n.getState();r===f.currentTree.version||r===((i=f.nextTree)===null||i===void 0?void 0:i.version)||((s=f.previousTree)===null||s===void 0||s.version);const m=n.getGraph(r);if(hx(t,e,m),r===((c=f.previousTree)===null||c===void 0?void 0:c.version)){const S=n.getGraph(f.currentTree.version);hx(t,e,S,m)}if(r===((o=f.previousTree)===null||o===void 0?void 0:o.version)||r===f.currentTree.version){var x;const S=(x=f.nextTree)===null||x===void 0?void 0:x.version;if(S!==void 0){const T=n.getGraph(S);hx(t,e,T,m)}}}var gg={cloneGraph:NX,graph:zX,saveDepsToStore:BX};let UX=0;const VX=()=>UX++;let GX=0;const jX=()=>GX++;let HX=0;const WX=()=>HX++;var qv={getNextTreeStateVersion:VX,getNextStoreID:jX,getNextComponentID:WX};const{persistentMap:B4}=OX,{graph:KX}=gg,{getNextTreeStateVersion:w8}=qv;function E8(){const t=w8();return{version:t,stateID:t,transactionMetadata:{},dirtyAtoms:new Set,atomValues:B4(),nonvalidatedAtoms:B4()}}function qX(){const t=E8();return{currentTree:t,nextTree:null,previousTree:null,commitDepth:0,knownAtoms:new Set,knownSelectors:new Set,transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(t.version,KX()),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map}}var T8={makeEmptyTreeState:E8,makeEmptyStoreState:qX,getNextTreeStateVersion:w8};class S8{}function XX(){return new S8}var Xv={RetentionZone:S8,retentionZone:XX};function ZX(t,e){const n=new Set(t);return n.add(e),n}function YX(t,e){const n=new Set(t);return n.delete(e),n}function JX(t,e,n){const r=new Map(t);return r.set(e,n),r}function QX(t,e,n){const r=new Map(t);return r.set(e,n(r.get(e))),r}function eZ(t,e){const n=new Map(t);return n.delete(e),n}function tZ(t,e){const n=new Map(t);return e.forEach(r=>n.delete(r)),n}var A8={setByAddingToSet:ZX,setByDeletingFromSet:YX,mapBySettingInMap:JX,mapByUpdatingInMap:QX,mapByDeletingFromMap:eZ,mapByDeletingMultipleFromMap:tZ};function*nZ(t,e){let n=0;for(const r of t)e(r,n++)&&(yield r)}var ML=nZ;function rZ(t,e){return new Proxy(t,{get:(r,i)=>(!(i in r)&&i in e&&(r[i]=e[i]()),r[i]),ownKeys:r=>Object.keys(r)})}var P8=rZ;const{getNode:yg,getNodeMaybe:iZ,recoilValuesForKeys:U4}=qs,{RetentionZone:V4}=Xv,{setByAddingToSet:sZ}=A8,oZ=Object.freeze(new Set);class aZ extends Error{}function lZ(t,e,n){if(!mr("recoil_memory_managament_2020"))return()=>{};const{nodesRetainedByZone:r}=t.getState().retention;function i(s){let c=r.get(s);c||r.set(s,c=new Set),c.add(e)}if(n instanceof V4)i(n);else if(Array.isArray(n))for(const s of n)i(s);return()=>{if(!mr("recoil_memory_managament_2020"))return;const{retention:s}=t.getState();function c(o){const f=s.nodesRetainedByZone.get(o);f==null||f.delete(e),f&&f.size===0&&s.nodesRetainedByZone.delete(o)}if(n instanceof V4)c(n);else if(Array.isArray(n))for(const o of n)c(o)}}function kL(t,e,n,r){const i=t.getState();if(i.nodeCleanupFunctions.has(n))return;const s=yg(n),c=lZ(t,n,s.retainedBy),o=s.init(t,e,r);i.nodeCleanupFunctions.set(n,()=>{o(),c()})}function cZ(t,e,n){kL(t,t.getState().currentTree,e,n)}function uZ(t,e){var n;const r=t.getState();(n=r.nodeCleanupFunctions.get(e))===null||n===void 0||n(),r.nodeCleanupFunctions.delete(e)}function dZ(t,e,n){return kL(t,e,n,"get"),yg(n).get(t,e)}function C8(t,e,n){return yg(n).peek(t,e)}function hZ(t,e,n){var r;const i=iZ(e);return i==null||(r=i.invalidate)===null||r===void 0||r.call(i,t),{...t,atomValues:t.atomValues.clone().delete(e),nonvalidatedAtoms:t.nonvalidatedAtoms.clone().set(e,n),dirtyAtoms:sZ(t.dirtyAtoms,e)}}function fZ(t,e,n,r){const i=yg(n);if(i.set==null)throw new aZ(`Attempt to set read-only RecoilValue: ${n}`);const s=i.set;return kL(t,e,n,"set"),s(t,e,r)}function pZ(t,e,n){const r=t.getState(),i=t.getGraph(e.version),s=yg(n).nodeType;return P8({type:s},{loadable:()=>C8(t,e,n),isActive:()=>r.knownAtoms.has(n)||r.knownSelectors.has(n),isSet:()=>s==="selector"?!1:e.atomValues.has(n),isModified:()=>e.dirtyAtoms.has(n),deps:()=>{var c;return U4((c=i.nodeDeps.get(n))!==null&&c!==void 0?c:[])},subscribers:()=>{var c,o;return{nodes:U4(ML(I8(t,e,new Set([n])),f=>f!==n)),components:Kv((c=(o=r.nodeToComponentSubscriptions.get(n))===null||o===void 0?void 0:o.values())!==null&&c!==void 0?c:[],([f])=>({name:f}))}}})}function I8(t,e,n){const r=new Set,i=Array.from(n),s=t.getGraph(e.version);for(let o=i.pop();o;o=i.pop()){var c;r.add(o);const f=(c=s.nodeToNodeSubscriptions.get(o))!==null&&c!==void 0?c:oZ;for(const m of f)r.has(m)||i.push(m)}return r}var Hc={getNodeLoadable:dZ,peekNodeLoadable:C8,setNodeValue:fZ,initializeNode:cZ,cleanUpNode:uZ,setUnvalidatedAtomValue_DEPRECATED:hZ,peekNodeInfo:pZ,getDownstreamNodes:I8};let L8=null;function mZ(t){L8=t}function gZ(){var t;(t=L8)===null||t===void 0||t()}var R8={setInvalidateMemoizedSnapshot:mZ,invalidateMemoizedSnapshot:gZ};const{getDownstreamNodes:yZ,getNodeLoadable:$8,setNodeValue:_Z}=Hc,{getNextComponentID:vZ}=qv,{getNode:bZ,getNodeMaybe:M8}=qs,{DefaultValue:OL}=qs,{reactMode:xZ}=mg,{AbstractRecoilValue:wZ,RecoilState:EZ,RecoilValueReadOnly:TZ,isRecoilValue:SZ}=Jh,{invalidateMemoizedSnapshot:AZ}=R8;function PZ(t,{key:e},n=t.getState().currentTree){var r,i;const s=t.getState();n.version===s.currentTree.version||n.version===((r=s.nextTree)===null||r===void 0?void 0:r.version)||(n.version,(i=s.previousTree)===null||i===void 0||i.version);const c=$8(t,n,e);return c.state==="loading"&&c.contents.catch(()=>{}),c}function CZ(t,e){const n=t.clone();return e.forEach((r,i)=>{r.state==="hasValue"&&r.contents instanceof OL?n.delete(i):n.set(i,r)}),n}function IZ(t,e,{key:n},r){if(typeof r=="function"){const i=$8(t,e,n);if(i.state==="loading"){const s=`Tried to set atom or selector "${n}" using an updater function while the current state is pending, this is not currently supported.`;throw Tn(s)}else if(i.state==="hasError")throw i.contents;return r(i.contents)}else return r}function LZ(t,e,n){if(n.type==="set"){const{recoilValue:i,valueOrUpdater:s}=n,c=IZ(t,e,i,s),o=_Z(t,e,i.key,c);for(const[f,m]of o.entries())$2(e,f,m)}else if(n.type==="setLoadable"){const{recoilValue:{key:i},loadable:s}=n;$2(e,i,s)}else if(n.type==="markModified"){const{recoilValue:{key:i}}=n;e.dirtyAtoms.add(i)}else if(n.type==="setUnvalidated"){var r;const{recoilValue:{key:i},unvalidatedValue:s}=n,c=M8(i);c==null||(r=c.invalidate)===null||r===void 0||r.call(c,e),e.atomValues.delete(i),e.nonvalidatedAtoms.set(i,s),e.dirtyAtoms.add(i)}else CL(`Unknown action ${n.type}`)}function $2(t,e,n){n.state==="hasValue"&&n.contents instanceof OL?t.atomValues.delete(e):t.atomValues.set(e,n),t.dirtyAtoms.add(e),t.nonvalidatedAtoms.delete(e)}function k8(t,e){t.replaceState(n=>{const r=O8(n);for(const i of e)LZ(t,r,i);return D8(t,r),AZ(),r})}function Zv(t,e){if(_m.length){const n=_m[_m.length-1];let r=n.get(t);r||n.set(t,r=[]),r.push(e)}else k8(t,[e])}const _m=[];function RZ(){const t=new Map;return _m.push(t),()=>{for(const[e,n]of t)k8(e,n);_m.pop()}}function O8(t){return{...t,atomValues:t.atomValues.clone(),nonvalidatedAtoms:t.nonvalidatedAtoms.clone(),dirtyAtoms:new Set(t.dirtyAtoms)}}function D8(t,e){const n=yZ(t,e,e.dirtyAtoms);for(const s of n){var r,i;(r=M8(s))===null||r===void 0||(i=r.invalidate)===null||i===void 0||i.call(r,e)}}function F8(t,e,n){Zv(t,{type:"set",recoilValue:e,valueOrUpdater:n})}function $Z(t,e,n){if(n instanceof OL)return F8(t,e,n);Zv(t,{type:"setLoadable",recoilValue:e,loadable:n})}function MZ(t,e){Zv(t,{type:"markModified",recoilValue:e})}function kZ(t,e,n){Zv(t,{type:"setUnvalidated",recoilValue:e,unvalidatedValue:n})}function OZ(t,{key:e},n,r=null){const i=vZ(),s=t.getState();s.nodeToComponentSubscriptions.has(e)||s.nodeToComponentSubscriptions.set(e,new Map),Fr(s.nodeToComponentSubscriptions.get(e)).set(i,[r??"<not captured>",n]);const c=xZ();if(c.early&&(c.mode==="LEGACY"||c.mode==="MUTABLE_SOURCE")){const o=t.getState().nextTree;o&&o.dirtyAtoms.has(e)&&n(o)}return{release:()=>{const o=t.getState(),f=o.nodeToComponentSubscriptions.get(e);f===void 0||!f.has(i)||(f.delete(i),f.size===0&&o.nodeToComponentSubscriptions.delete(e))}}}function DZ(t,e){var n;const{currentTree:r}=t.getState(),i=bZ(e.key);(n=i.clearCache)===null||n===void 0||n.call(i,t,r)}var Ha={RecoilValueReadOnly:TZ,AbstractRecoilValue:wZ,RecoilState:EZ,getRecoilValueAsLoadable:PZ,setRecoilValue:F8,setRecoilValueLoadable:$Z,markRecoilValueModified:MZ,setUnvalidatedRecoilValue:kZ,subscribeToRecoilValue:OZ,isRecoilValue:SZ,applyAtomValueWrites:CZ,batchStart:RZ,writeLoadableToTreeState:$2,invalidateDownstreams:D8,copyTreeState:O8,refreshRecoilValue:DZ};function FZ(t,e,n){const r=t.entries();let i=r.next();for(;!i.done;){const s=i.value;if(e.call(n,s[1],s[0],t))return!0;i=r.next()}return!1}var zZ=FZ;const{cleanUpNode:NZ}=Hc,{deleteNodeConfigIfPossible:BZ,getNode:z8}=qs,{RetentionZone:N8}=Xv,UZ=12e4,B8=new Set;function U8(t,e){const n=t.getState(),r=n.currentTree;if(n.nextTree)return;const i=new Set;for(const c of e)if(c instanceof N8)for(const o of HZ(n,c))i.add(o);else i.add(c);const s=VZ(t,i);for(const c of s)jZ(t,r,c)}function VZ(t,e){const n=t.getState(),r=n.currentTree,i=t.getGraph(r.version),s=new Set,c=new Set;return o(e),s;function o(f){const m=new Set,x=GZ(t,r,f,s,c);for(const R of x){var S;if(z8(R).retainedBy==="recoilRoot"){c.add(R);continue}if(((S=n.retention.referenceCounts.get(R))!==null&&S!==void 0?S:0)>0){c.add(R);continue}if(V8(R).some(H=>n.retention.referenceCounts.get(H))){c.add(R);continue}const D=i.nodeToNodeSubscriptions.get(R);if(D&&zZ(D,H=>c.has(H))){c.add(R);continue}s.add(R),m.add(R)}const T=new Set;for(const R of m)for(const D of(C=i.nodeDeps.get(R))!==null&&C!==void 0?C:B8){var C;s.has(D)||T.add(D)}T.size&&o(T)}}function GZ(t,e,n,r,i){const s=t.getGraph(e.version),c=[],o=new Set;for(;n.size>0;)f(Fr(n.values().next().value));return c;function f(m){if(r.has(m)||i.has(m)){n.delete(m);return}if(o.has(m))return;const x=s.nodeToNodeSubscriptions.get(m);if(x)for(const S of x)f(S);o.add(m),n.delete(m),c.push(m)}}function jZ(t,e,n){if(!mr("recoil_memory_managament_2020"))return;NZ(t,n);const r=t.getState();r.knownAtoms.delete(n),r.knownSelectors.delete(n),r.nodeTransactionSubscriptions.delete(n),r.retention.referenceCounts.delete(n);const i=V8(n);for(const f of i){var s;(s=r.retention.nodesRetainedByZone.get(f))===null||s===void 0||s.delete(n)}e.atomValues.delete(n),e.dirtyAtoms.delete(n),e.nonvalidatedAtoms.delete(n);const c=r.graphsByVersion.get(e.version);if(c){const f=c.nodeDeps.get(n);if(f!==void 0){c.nodeDeps.delete(n);for(const m of f){var o;(o=c.nodeToNodeSubscriptions.get(m))===null||o===void 0||o.delete(n)}}c.nodeToNodeSubscriptions.delete(n)}BZ(n)}function HZ(t,e){var n;return(n=t.retention.nodesRetainedByZone.get(e))!==null&&n!==void 0?n:B8}function V8(t){const e=z8(t).retainedBy;return e===void 0||e==="components"||e==="recoilRoot"?[]:e instanceof N8?[e]:e}function WZ(t,e){const n=t.getState();n.nextTree?n.retention.retainablesToCheckForRelease.add(e):U8(t,new Set([e]))}function KZ(t,e,n){var r;if(!mr("recoil_memory_managament_2020"))return;const i=t.getState().retention.referenceCounts,s=((r=i.get(e))!==null&&r!==void 0?r:0)+n;s===0?G8(t,e):i.set(e,s)}function G8(t,e){if(!mr("recoil_memory_managament_2020"))return;t.getState().retention.referenceCounts.delete(e),WZ(t,e)}function qZ(t){if(!mr("recoil_memory_managament_2020"))return;const e=t.getState();U8(t,e.retention.retainablesToCheckForRelease),e.retention.retainablesToCheckForRelease.clear()}function XZ(t){return t===void 0?"recoilRoot":t}var dd={SUSPENSE_TIMEOUT_MS:UZ,updateRetainCount:KZ,updateRetainCountToZero:G8,releaseScheduledRetainablesNow:qZ,retainedByOptionWithDefault:XZ};const{unstable_batchedUpdates:ZZ}=Ah;var YZ={unstable_batchedUpdates:ZZ};const{unstable_batchedUpdates:JZ}=YZ;var QZ={unstable_batchedUpdates:JZ};const{batchStart:eY}=Ha,{unstable_batchedUpdates:tY}=QZ;let DL=tY||(t=>t());const nY=t=>{DL=t},rY=()=>DL,iY=t=>{DL(()=>{let e=()=>{};try{e=eY(),t()}finally{e()}})};var Yv={getBatcher:rY,setBatcher:nY,batchUpdates:iY};function*sY(t){for(const e of t)for(const n of e)yield n}var j8=sY;const H8=typeof Window>"u"||typeof window>"u",oY=t=>!H8&&(t===window||t instanceof Window),aY=typeof navigator<"u"&&navigator.product==="ReactNative";var Jv={isSSR:H8,isReactNative:aY,isWindow:oY};function lY(t,e){let n;return(...r)=>{n||(n={});const i=e(...r);return Object.hasOwnProperty.call(n,i)||(n[i]=t(...r)),n[i]}}function cY(t,e){let n,r;return(...i)=>{const s=e(...i);return n===s||(n=s,r=t(...i)),r}}function uY(t,e){let n,r;return[(...c)=>{const o=e(...c);return n===o||(n=o,r=t(...c)),r},()=>{n=null}]}var dY={memoizeWithArgsHash:lY,memoizeOneWithArgsHash:cY,memoizeOneWithArgsHashAndInvalidation:uY};const{batchUpdates:M2}=Yv,{initializeNode:hY,peekNodeInfo:fY}=Hc,{graph:pY}=gg,{getNextStoreID:mY}=qv,{DEFAULT_VALUE:gY,recoilValues:G4,recoilValuesForKeys:j4}=qs,{AbstractRecoilValue:yY,getRecoilValueAsLoadable:_Y,setRecoilValue:H4,setUnvalidatedRecoilValue:vY}=Ha,{updateRetainCount:J_}=dd,{setInvalidateMemoizedSnapshot:bY}=R8,{getNextTreeStateVersion:xY,makeEmptyStoreState:wY}=T8,{isSSR:EY}=Jv,{memoizeOneWithArgsHashAndInvalidation:TY}=dY;class Qv{constructor(e,n){xn(this,"_store",void 0),xn(this,"_refCount",1),xn(this,"getLoadable",r=>(this.checkRefCount_INTERNAL(),_Y(this._store,r))),xn(this,"getPromise",r=>(this.checkRefCount_INTERNAL(),this.getLoadable(r).toPromise())),xn(this,"getNodes_UNSTABLE",r=>{if(this.checkRefCount_INTERNAL(),(r==null?void 0:r.isModified)===!0){if((r==null?void 0:r.isInitialized)===!1)return[];const c=this._store.getState().currentTree;return j4(c.dirtyAtoms)}const i=this._store.getState().knownAtoms,s=this._store.getState().knownSelectors;return(r==null?void 0:r.isInitialized)==null?G4.values():r.isInitialized===!0?j4(j8([i,s])):ML(G4.values(),({key:c})=>!i.has(c)&&!s.has(c))}),xn(this,"getInfo_UNSTABLE",({key:r})=>(this.checkRefCount_INTERNAL(),fY(this._store,this._store.getState().currentTree,r))),xn(this,"map",r=>{this.checkRefCount_INTERNAL();const i=new k2(this,M2);return r(i),i}),xn(this,"asyncMap",async r=>{this.checkRefCount_INTERNAL();const i=new k2(this,M2);return i.retain(),await r(i),i.autoRelease_INTERNAL(),i}),this._store={storeID:mY(),parentStoreID:n,getState:()=>e,replaceState:r=>{e.currentTree=r(e.currentTree)},getGraph:r=>{const i=e.graphsByVersion;if(i.has(r))return Fr(i.get(r));const s=pY();return i.set(r,s),s},subscribeToTransactions:()=>({release:()=>{}}),addTransactionMetadata:()=>{throw Tn("Cannot subscribe to Snapshots")}};for(const r of this._store.getState().knownAtoms)hY(this._store,r,"get"),J_(this._store,r,1);this.autoRelease_INTERNAL()}retain(){this._refCount<=0,this._refCount++;let e=!1;return()=>{e||(e=!0,this._release())}}autoRelease_INTERNAL(){EY||window.setTimeout(()=>this._release(),10)}_release(){if(this._refCount--,this._refCount===0){if(this._store.getState().nodeCleanupFunctions.forEach(e=>e()),this._store.getState().nodeCleanupFunctions.clear(),!mr("recoil_memory_managament_2020"))return}else this._refCount<0}isRetained(){return this._refCount>0}checkRefCount_INTERNAL(){mr("recoil_memory_managament_2020")&&this._refCount<=0}getStore_INTERNAL(){return this.checkRefCount_INTERNAL(),this._store}getID(){return this.checkRefCount_INTERNAL(),this._store.getState().currentTree.stateID}getStoreID(){return this.checkRefCount_INTERNAL(),this._store.storeID}}function W8(t,e,n=!1){const r=t.getState(),i=n?xY():e.version;return{currentTree:{version:n?i:e.version,stateID:n?i:e.stateID,transactionMetadata:{...e.transactionMetadata},dirtyAtoms:new Set(e.dirtyAtoms),atomValues:e.atomValues.clone(),nonvalidatedAtoms:e.nonvalidatedAtoms.clone()},commitDepth:0,nextTree:null,previousTree:null,knownAtoms:new Set(r.knownAtoms),knownSelectors:new Set(r.knownSelectors),transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(i,t.getGraph(e.version)),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map(Kv(r.nodeCleanupFunctions.entries(),([s])=>[s,()=>{}]))}}function SY(t){const e=new Qv(wY());return t!=null?e.map(t):e}const[W4,K8]=TY((t,e)=>{var n;const r=t.getState(),i=e==="latest"?(n=r.nextTree)!==null&&n!==void 0?n:r.currentTree:Fr(r.previousTree);return new Qv(W8(t,i),t.storeID)},(t,e)=>{var n,r;return String(e)+String(t.storeID)+String((n=t.getState().nextTree)===null||n===void 0?void 0:n.version)+String(t.getState().currentTree.version)+String((r=t.getState().previousTree)===null||r===void 0?void 0:r.version)});bY(K8);function AY(t,e="latest"){const n=W4(t,e);return n.isRetained()?n:(K8(),W4(t,e))}class k2 extends Qv{constructor(e,n){super(W8(e.getStore_INTERNAL(),e.getStore_INTERNAL().getState().currentTree,!0),e.getStoreID()),xn(this,"_batch",void 0),xn(this,"set",(r,i)=>{this.checkRefCount_INTERNAL();const s=this.getStore_INTERNAL();this._batch(()=>{J_(s,r.key,1),H4(this.getStore_INTERNAL(),r,i)})}),xn(this,"reset",r=>{this.checkRefCount_INTERNAL();const i=this.getStore_INTERNAL();this._batch(()=>{J_(i,r.key,1),H4(this.getStore_INTERNAL(),r,gY)})}),xn(this,"setUnvalidatedAtomValues_DEPRECATED",r=>{this.checkRefCount_INTERNAL();const i=this.getStore_INTERNAL();M2(()=>{for(const[s,c]of r.entries())J_(i,s,1),vY(i,new yY(s),c)})}),this._batch=n}}var eb={Snapshot:Qv,MutableSnapshot:k2,freshSnapshot:SY,cloneSnapshot:AY},PY=eb.Snapshot,CY=eb.MutableSnapshot,IY=eb.freshSnapshot,LY=eb.cloneSnapshot,tb=Object.freeze({__proto__:null,Snapshot:PY,MutableSnapshot:CY,freshSnapshot:IY,cloneSnapshot:LY});function RY(...t){const e=new Set;for(const n of t)for(const r of n)e.add(r);return e}var $Y=RY;const{useRef:MY}=ce;function kY(t){const e=MY(t);return e.current===t&&typeof t=="function"&&(e.current=t()),e}var K4=kY;const{getNextTreeStateVersion:OY,makeEmptyStoreState:q8}=T8,{cleanUpNode:DY,getDownstreamNodes:FY,initializeNode:zY,setNodeValue:NY,setUnvalidatedAtomValue_DEPRECATED:BY}=Hc,{graph:UY}=gg,{cloneGraph:VY}=gg,{getNextStoreID:X8}=qv,{createMutableSource:fx,reactMode:Z8}=mg,{applyAtomValueWrites:GY}=Ha,{releaseScheduledRetainablesNow:Y8}=dd,{freshSnapshot:jY}=tb,{useCallback:HY,useContext:J8,useEffect:O2,useMemo:WY,useRef:KY,useState:qY}=ce;function Ip(){throw Tn("This component must be used inside a <RecoilRoot> component.")}const Q8=Object.freeze({storeID:X8(),getState:Ip,replaceState:Ip,getGraph:Ip,subscribeToTransactions:Ip,addTransactionMetadata:Ip});let D2=!1;function q4(t){if(D2)throw Tn("An atom update was triggered within the execution of a state updater function. State updater functions provided to Recoil must be pure functions.");const e=t.getState();if(e.nextTree===null){mr("recoil_memory_managament_2020")&&mr("recoil_release_on_cascading_update_killswitch_2021")&&e.commitDepth>0&&Y8(t);const n=e.currentTree.version,r=OY();e.nextTree={...e.currentTree,version:r,stateID:r,dirtyAtoms:new Set,transactionMetadata:{}},e.graphsByVersion.set(r,VY(Fr(e.graphsByVersion.get(n))))}}const ez=ce.createContext({current:Q8}),nb=()=>J8(ez),tz=ce.createContext(null);function XY(){return J8(tz)}function FL(t,e,n){const r=FY(t,n,n.dirtyAtoms);for(const i of r){const s=e.nodeToComponentSubscriptions.get(i);if(s)for(const[c,[o,f]]of s)f(n)}}function nz(t){const e=t.getState(),n=e.currentTree,r=n.dirtyAtoms;if(r.size){for(const[i,s]of e.nodeTransactionSubscriptions)if(r.has(i))for(const[c,o]of s)o(t);for(const[i,s]of e.transactionSubscriptions)s(t);(!Z8().early||e.suspendedComponentResolvers.size>0)&&(FL(t,e,n),e.suspendedComponentResolvers.forEach(i=>i()),e.suspendedComponentResolvers.clear())}e.queuedComponentCallbacks_DEPRECATED.forEach(i=>i(n)),e.queuedComponentCallbacks_DEPRECATED.splice(0,e.queuedComponentCallbacks_DEPRECATED.length)}function ZY(t){const e=t.getState();e.commitDepth++;try{const{nextTree:n}=e;if(n==null)return;e.previousTree=e.currentTree,e.currentTree=n,e.nextTree=null,nz(t),e.previousTree!=null?e.graphsByVersion.delete(e.previousTree.version):CL("Ended batch with no previous state, which is unexpected","recoil"),e.previousTree=null,mr("recoil_memory_managament_2020")&&n==null&&Y8(t)}finally{e.commitDepth--}}function YY({setNotifyBatcherOfChange:t}){const e=nb(),[,n]=qY([]);return t(()=>n({})),O2(()=>(t(()=>n({})),()=>{t(()=>{})}),[t]),O2(()=>{IX.enqueueExecution("Batcher",()=>{ZY(e.current)})}),null}function JY(t,e){const n=q8();return e({set:(r,i)=>{const s=n.currentTree,c=NY(t,s,r.key,i),o=new Set(c.keys()),f=s.nonvalidatedAtoms.clone();for(const m of o)f.delete(m);n.currentTree={...s,dirtyAtoms:$Y(s.dirtyAtoms,o),atomValues:GY(s.atomValues,c),nonvalidatedAtoms:f}},setUnvalidatedAtomValues:r=>{r.forEach((i,s)=>{n.currentTree=BY(n.currentTree,s,i)})}}),n}function QY(t){const e=jY(t),n=e.getStore_INTERNAL().getState();return e.retain(),n.nodeCleanupFunctions.forEach(r=>r()),n.nodeCleanupFunctions.clear(),n}let X4=0;function eJ({initializeState_DEPRECATED:t,initializeState:e,store_INTERNAL:n,children:r}){let i;const s=C=>{const R=i.current.graphsByVersion;if(R.has(C))return Fr(R.get(C));const D=UY();return R.set(C,D),D},c=(C,R)=>{if(R==null){const{transactionSubscriptions:D}=S.current.getState(),H=X4++;return D.set(H,C),{release:()=>{D.delete(H)}}}else{const{nodeTransactionSubscriptions:D}=S.current.getState();D.has(R)||D.set(R,new Map);const H=X4++;return Fr(D.get(R)).set(H,C),{release:()=>{const F=D.get(R);F&&(F.delete(H),F.size===0&&D.delete(R))}}}},o=C=>{q4(S.current);for(const R of Object.keys(C))Fr(S.current.getState().nextTree).transactionMetadata[R]=C[R]},f=C=>{q4(S.current);const R=Fr(i.current.nextTree);let D;try{D2=!0,D=C(R)}finally{D2=!1}D!==R&&(i.current.nextTree=D,Z8().early&&FL(S.current,i.current,D),Fr(m.current)())},m=KY(null),x=HY(C=>{m.current=C},[m]),S=K4(()=>n??{storeID:X8(),getState:()=>i.current,replaceState:f,getGraph:s,subscribeToTransactions:c,addTransactionMetadata:o});n!=null&&(S.current=n),i=K4(()=>t!=null?JY(S.current,t):e!=null?QY(e):q8());const T=WY(()=>fx==null?void 0:fx(i,()=>i.current.currentTree.version),[i]);return O2(()=>{const C=S.current;for(const R of new Set(C.getState().knownAtoms))zY(C,R,"get");return()=>{for(const R of C.getState().knownAtoms)DY(C,R)}},[S]),ce.createElement(ez.Provider,{value:S},ce.createElement(tz.Provider,{value:T},ce.createElement(YY,{setNotifyBatcherOfChange:x}),r))}function tJ(t){const{override:e,...n}=t,r=nb();return e===!1&&r.current!==Q8?t.children:ce.createElement(eJ,n)}function nJ(){return nb().current.storeID}var Ol={RecoilRoot:tJ,useStoreRef:nb,useRecoilMutableSource:XY,useRecoilStoreID:nJ,notifyComponents_FOR_TESTING:FL,sendEndOfBatchNotifications_FOR_TESTING:nz};function rJ(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}var iJ=rJ;const{useEffect:sJ,useRef:oJ}=ce;function aJ(t){const e=oJ();return sJ(()=>{e.current=t}),e.current}var rz=aJ;const{useStoreRef:lJ}=Ol,{SUSPENSE_TIMEOUT_MS:cJ}=dd,{updateRetainCount:Lp}=dd,{RetentionZone:uJ}=Xv,{useEffect:dJ,useRef:hJ}=ce,{isSSR:Z4}=Jv;function fJ(t){if(mr("recoil_memory_managament_2020"))return pJ(t)}function pJ(t){const n=(Array.isArray(t)?t:[t]).map(c=>c instanceof uJ?c:c.key),r=lJ();dJ(()=>{if(!mr("recoil_memory_managament_2020"))return;const c=r.current;if(i.current&&!Z4)window.clearTimeout(i.current),i.current=null;else for(const o of n)Lp(c,o,1);return()=>{for(const o of n)Lp(c,o,-1)}},[r,...n]);const i=hJ(),s=rz(n);if(!Z4&&(s===void 0||!iJ(s,n))){const c=r.current;for(const o of n)Lp(c,o,1);if(s)for(const o of s)Lp(c,o,-1);i.current&&window.clearTimeout(i.current),i.current=window.setTimeout(()=>{i.current=null;for(const o of n)Lp(c,o,-1)},cJ)}}var zL=fJ;function mJ(){return"<component name not available>"}var _g=mJ;const{batchUpdates:gJ}=Yv,{DEFAULT_VALUE:iz}=qs,{currentRendererSupportsUseSyncExternalStore:yJ,reactMode:xf,useMutableSource:_J,useSyncExternalStore:vJ}=mg,{useRecoilMutableSource:bJ,useStoreRef:Wa}=Ol,{AbstractRecoilValue:F2,getRecoilValueAsLoadable:vg,setRecoilValue:V0,setUnvalidatedRecoilValue:xJ,subscribeToRecoilValue:Qh}=Ha,{useCallback:Ks,useEffect:ef,useMemo:sz,useRef:vm,useState:NL}=ce,{setByAddingToSet:wJ}=A8,{isSSR:EJ}=Jv;function BL(t,e,n){if(t.state==="hasValue")return t.contents;throw t.state==="loading"?new Promise(i=>{const s=n.current.getState().suspendedComponentResolvers;s.add(i),EJ&&Rr(t.contents)&&t.contents.finally(()=>{s.delete(i)})}):t.state==="hasError"?t.contents:Tn(`Invalid value of loadable atom "${e.key}"`)}function TJ(){const t=_g(),e=Wa(),[,n]=NL([]),r=vm(new Set);r.current=new Set;const i=vm(new Set),s=vm(new Map),c=Ks(f=>{const m=s.current.get(f);m&&(m.release(),s.current.delete(f))},[s]),o=Ks((f,m)=>{s.current.has(m)&&n([])},[]);return ef(()=>{const f=e.current;ym(r.current,i.current).forEach(m=>{if(s.current.has(m))return;const x=Qh(f,new F2(m),T=>o(T,m),t);s.current.set(m,x),f.getState().nextTree?f.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{o(f.getState(),m)}):o(f.getState(),m)}),ym(i.current,r.current).forEach(m=>{c(m)}),i.current=r.current}),ef(()=>{const f=s.current;return ym(r.current,new Set(f.keys())).forEach(m=>{const x=Qh(e.current,new F2(m),S=>o(S,m),t);f.set(m,x)}),()=>f.forEach((m,x)=>c(x))},[t,e,c,o]),sz(()=>{function f(R){return D=>{V0(e.current,R,D)}}function m(R){return()=>V0(e.current,R,iz)}function x(R){var D;r.current.has(R.key)||(r.current=wJ(r.current,R.key));const H=e.current.getState();return vg(e.current,R,xf().early&&(D=H.nextTree)!==null&&D!==void 0?D:H.currentTree)}function S(R){const D=x(R);return BL(D,R,e)}function T(R){return[S(R),f(R)]}function C(R){return[x(R),f(R)]}return{getRecoilValue:S,getRecoilValueLoadable:x,getRecoilState:T,getRecoilStateLoadable:C,getSetRecoilState:f,getResetRecoilState:m}},[r,e])}const SJ={current:0};function AJ(t){const e=Wa(),n=_g(),r=Ks(()=>{var o;const f=e.current,m=f.getState(),x=xf().early&&(o=m.nextTree)!==null&&o!==void 0?o:m.currentTree;return{loadable:vg(f,t,x),key:t.key}},[e,t]),i=Ks(o=>{let f;return()=>{var m,x;const S=o();return(m=f)!==null&&m!==void 0&&m.loadable.is(S.loadable)&&((x=f)===null||x===void 0?void 0:x.key)===S.key?f:(f=S,S)}},[]),s=sz(()=>i(r),[r,i]),c=Ks(o=>{const f=e.current;return Qh(f,t,o,n).release},[e,t,n]);return vJ(c,s,s).loadable}function PJ(t){const e=Wa(),n=Ks(()=>{var m;const x=e.current,S=x.getState(),T=xf().early&&(m=S.nextTree)!==null&&m!==void 0?m:S.currentTree;return vg(x,t,T)},[e,t]),r=Ks(()=>n(),[n]),i=_g(),s=Ks((m,x)=>{const S=e.current;return Qh(S,t,()=>{if(!mr("recoil_suppress_rerender_in_callback"))return x();const C=n();f.current.is(C)||x(),f.current=C},i).release},[e,t,i,n]),c=bJ();if(c==null)throw Tn("Recoil hooks must be used in components contained within a <RecoilRoot> component.");const o=_J(c,r,s),f=vm(o);return ef(()=>{f.current=o}),o}function z2(t){const e=Wa(),n=_g(),r=Ks(()=>{var f;const m=e.current,x=m.getState(),S=xf().early&&(f=x.nextTree)!==null&&f!==void 0?f:x.currentTree;return vg(m,t,S)},[e,t]),i=Ks(()=>({loadable:r(),key:t.key}),[r,t.key]),s=Ks(f=>{const m=i();return f.loadable.is(m.loadable)&&f.key===m.key?f:m},[i]);ef(()=>{const f=Qh(e.current,t,m=>{o(s)},n);return o(s),f.release},[n,t,e,s]);const[c,o]=NL(i);return c.key!==t.key?i().loadable:c.loadable}function CJ(t){const e=Wa(),[,n]=NL([]),r=_g(),i=Ks(()=>{var o;const f=e.current,m=f.getState(),x=xf().early&&(o=m.nextTree)!==null&&o!==void 0?o:m.currentTree;return vg(f,t,x)},[e,t]),s=i(),c=vm(s);return ef(()=>{c.current=s}),ef(()=>{const o=e.current,f=o.getState(),m=Qh(o,t,S=>{var T;if(!mr("recoil_suppress_rerender_in_callback"))return n([]);const C=i();(T=c.current)!==null&&T!==void 0&&T.is(C)||n(C),c.current=C},r);if(f.nextTree)o.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{c.current=null,n([])});else{var x;if(!mr("recoil_suppress_rerender_in_callback"))return n([]);const S=i();(x=c.current)!==null&&x!==void 0&&x.is(S)||n(S),c.current=S}return m.release},[r,i,t,e]),s}function UL(t){return mr("recoil_memory_managament_2020")&&zL(t),{TRANSITION_SUPPORT:z2,SYNC_EXTERNAL_STORE:yJ()?AJ:z2,MUTABLE_SOURCE:PJ,LEGACY:CJ}[xf().mode](t)}function oz(t){const e=Wa(),n=UL(t);return BL(n,t,e)}function rb(t){const e=Wa();return Ks(n=>{V0(e.current,t,n)},[e,t])}function IJ(t){const e=Wa();return Ks(()=>{V0(e.current,t,iz)},[e,t])}function LJ(t){return[oz(t),rb(t)]}function RJ(t){return[UL(t),rb(t)]}function $J(){const t=Wa();return(e,n={})=>{gJ(()=>{t.current.addTransactionMetadata(n),e.forEach((r,i)=>xJ(t.current,new F2(i),r))})}}function az(t){return mr("recoil_memory_managament_2020")&&zL(t),z2(t)}function lz(t){const e=Wa(),n=az(t);return BL(n,t,e)}function MJ(t){return[lz(t),rb(t)]}var kJ={recoilComponentGetRecoilValueCount_FOR_TESTING:SJ,useRecoilInterface:TJ,useRecoilState:LJ,useRecoilStateLoadable:RJ,useRecoilValue:oz,useRecoilValueLoadable:UL,useResetRecoilState:IJ,useSetRecoilState:rb,useSetUnvalidatedAtomValues:$J,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:az,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:lz,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:MJ};function OJ(t,e){const n=new Map;for(const[r,i]of t)e(i,r)&&n.set(r,i);return n}var DJ=OJ;function FJ(t,e){const n=new Set;for(const r of t)e(r)&&n.add(r);return n}var zJ=FJ;function NJ(...t){const e=new Map;for(let n=0;n<t.length;n++){const r=t[n].keys();let i;for(;!(i=r.next()).done;)e.set(i.value,t[n].get(i.value))}return e}var BJ=NJ;const{batchUpdates:UJ}=Yv,{DEFAULT_VALUE:VJ,getNode:cz,nodes:GJ}=qs,{useStoreRef:VL}=Ol,{AbstractRecoilValue:jJ,setRecoilValueLoadable:HJ}=Ha,{SUSPENSE_TIMEOUT_MS:WJ}=dd,{cloneSnapshot:G0}=tb,{useCallback:ib,useEffect:uz,useRef:Y4,useState:KJ}=ce,{isSSR:J4}=Jv;function sb(t){const e=VL();uz(()=>e.current.subscribeToTransactions(t).release,[t,e])}function Q4(t){const e=t.atomValues.toMap(),n=U0(DJ(e,(r,i)=>{const c=cz(i).persistence_UNSTABLE;return c!=null&&c.type!=="none"&&r.state==="hasValue"}),r=>r.contents);return BJ(t.nonvalidatedAtoms.toMap(),n)}function qJ(t){sb(ib(e=>{let n=e.getState().previousTree;const r=e.getState().currentTree;n||(n=e.getState().currentTree);const i=Q4(r),s=Q4(n),c=U0(GJ,f=>{var m,x,S,T;return{persistence_UNSTABLE:{type:(m=(x=f.persistence_UNSTABLE)===null||x===void 0?void 0:x.type)!==null&&m!==void 0?m:"none",backButton:(S=(T=f.persistence_UNSTABLE)===null||T===void 0?void 0:T.backButton)!==null&&S!==void 0?S:!1}}}),o=zJ(r.dirtyAtoms,f=>i.has(f)||s.has(f));t({atomValues:i,previousAtomValues:s,atomInfo:c,modifiedAtoms:o,transactionMetadata:{...r.transactionMetadata}})},[t]))}function XJ(t){sb(ib(e=>{const n=G0(e,"latest"),r=G0(e,"previous");t({snapshot:n,previousSnapshot:r})},[t]))}function ZJ(){const t=VL(),[e,n]=KJ(()=>G0(t.current)),r=rz(e),i=Y4(),s=Y4();if(sb(ib(o=>n(G0(o)),[])),uz(()=>{const o=e.retain();if(i.current&&!J4){var f;window.clearTimeout(i.current),i.current=null,(f=s.current)===null||f===void 0||f.call(s),s.current=null}return()=>{window.setTimeout(o,10)}},[e]),r!==e&&!J4){if(i.current){var c;window.clearTimeout(i.current),i.current=null,(c=s.current)===null||c===void 0||c.call(s),s.current=null}s.current=e.retain(),i.current=window.setTimeout(()=>{var o;i.current=null,(o=s.current)===null||o===void 0||o.call(s),s.current=null},WJ)}return e}function dz(t,e){var n;const r=t.getState(),i=(n=r.nextTree)!==null&&n!==void 0?n:r.currentTree,s=e.getStore_INTERNAL().getState().currentTree;UJ(()=>{const c=new Set;for(const m of[i.atomValues.keys(),s.atomValues.keys()])for(const x of m){var o,f;((o=i.atomValues.get(x))===null||o===void 0?void 0:o.contents)!==((f=s.atomValues.get(x))===null||f===void 0?void 0:f.contents)&&cz(x).shouldRestoreFromSnapshots&&c.add(x)}c.forEach(m=>{HJ(t,new jJ(m),s.atomValues.has(m)?Fr(s.atomValues.get(m)):VJ)}),t.replaceState(m=>({...m,stateID:e.getID()}))})}function YJ(){const t=VL();return ib(e=>dz(t.current,e),[t])}var hz={useRecoilSnapshot:ZJ,gotoSnapshot:dz,useGotoRecoilSnapshot:YJ,useRecoilTransactionObserver:XJ,useTransactionObservation_DEPRECATED:qJ,useTransactionSubscription_DEPRECATED:sb};const{peekNodeInfo:JJ}=Hc,{useStoreRef:QJ}=Ol;function eQ(){const t=QJ();return({key:e})=>JJ(t.current,t.current.getState().currentTree,e)}var tQ=eQ;const{reactMode:nQ}=mg,{RecoilRoot:rQ,useStoreRef:iQ}=Ol,{useMemo:sQ}=ce;function oQ(){nQ().mode==="MUTABLE_SOURCE"&&console.warn("Warning: There are known issues using useRecoilBridgeAcrossReactRoots() in recoil_mutable_source rendering mode.  Please consider upgrading to recoil_sync_external_store mode.");const t=iQ().current;return sQ(()=>{function e({children:n}){return ce.createElement(rQ,{store_INTERNAL:t},n)}return e},[t])}var aQ=oQ;const{loadableWithValue:lQ}=pg,{initializeNode:cQ}=Hc,{DEFAULT_VALUE:uQ,getNode:dQ}=qs,{copyTreeState:hQ,getRecoilValueAsLoadable:fQ,invalidateDownstreams:pQ,writeLoadableToTreeState:mQ}=Ha;function ek(t){return dQ(t.key).nodeType==="atom"}class gQ{constructor(e,n){xn(this,"_store",void 0),xn(this,"_treeState",void 0),xn(this,"_changes",void 0),xn(this,"get",r=>{if(this._changes.has(r.key))return this._changes.get(r.key);if(!ek(r))throw Tn("Reading selectors within atomicUpdate is not supported");const i=fQ(this._store,r,this._treeState);if(i.state==="hasValue")return i.contents;throw i.state==="hasError"?i.contents:Tn(`Expected Recoil atom ${r.key} to have a value, but it is in a loading state.`)}),xn(this,"set",(r,i)=>{if(!ek(r))throw Tn("Setting selectors within atomicUpdate is not supported");if(typeof i=="function"){const s=this.get(r);this._changes.set(r.key,i(s))}else cQ(this._store,r.key,"set"),this._changes.set(r.key,i)}),xn(this,"reset",r=>{this.set(r,uQ)}),this._store=e,this._treeState=n,this._changes=new Map}newTreeState_INTERNAL(){if(this._changes.size===0)return this._treeState;const e=hQ(this._treeState);for(const[n,r]of this._changes)mQ(e,n,lQ(r));return pQ(this._store,e),e}}function yQ(t){return e=>{t.replaceState(n=>{const r=new gQ(t,n);return e(r),r.newTreeState_INTERNAL()})}}var _Q={atomicUpdater:yQ},vQ=_Q.atomicUpdater,fz=Object.freeze({__proto__:null,atomicUpdater:vQ});function bQ(t,e){if(!t)throw new Error(e)}var xQ=bQ,Qp=xQ;const{atomicUpdater:wQ}=fz,{batchUpdates:EQ}=Yv,{DEFAULT_VALUE:TQ}=qs,{useStoreRef:SQ}=Ol,{refreshRecoilValue:AQ,setRecoilValue:tk}=Ha,{cloneSnapshot:PQ}=tb,{gotoSnapshot:CQ}=hz,{useCallback:IQ}=ce;class pz{}const LQ=new pz;function mz(t,e,n,r){let i=LQ,s;if(EQ(()=>{const o="useRecoilCallback() expects a function that returns a function: it accepts a function of the type (RecoilInterface) => (Args) => ReturnType and returns a callback function (Args) => ReturnType, where RecoilInterface is an object {snapshot, set, ...} and Args and ReturnType are the argument and return types of the callback you want to create.  Please see the docs at recoiljs.org for details.";if(typeof e!="function")throw Tn(o);const f=P8({...r??{},set:(x,S)=>tk(t,x,S),reset:x=>tk(t,x,TQ),refresh:x=>AQ(t,x),gotoSnapshot:x=>CQ(t,x),transact_UNSTABLE:x=>wQ(t)(x)},{snapshot:()=>{const x=PQ(t);return s=x.retain(),x}}),m=e(f);if(typeof m!="function")throw Tn(o);i=m(...n)}),i instanceof pz&&Qp(!1),Rr(i))i=i.finally(()=>{var o;(o=s)===null||o===void 0||o()});else{var c;(c=s)===null||c===void 0||c()}return i}function RQ(t,e){const n=SQ();return IQ((...r)=>mz(n.current,t,r),e!=null?[...e,n]:void 0)}var gz={recoilCallback:mz,useRecoilCallback:RQ};const{useStoreRef:$Q}=Ol,{refreshRecoilValue:MQ}=Ha,{useCallback:kQ}=ce;function OQ(t){const e=$Q();return kQ(()=>{const n=e.current;MQ(n,t)},[t,e])}var DQ=OQ;const{atomicUpdater:FQ}=fz,{useStoreRef:zQ}=Ol,{useMemo:NQ}=ce;function BQ(t,e){const n=zQ();return NQ(()=>(...r)=>{FQ(n.current)(s=>{t(s)(...r)})},e!=null?[...e,n]:void 0)}var UQ=BQ;class VQ{constructor(e){xn(this,"value",void 0),this.value=e}}var GQ={WrappedValue:VQ},jQ=GQ.WrappedValue,yz=Object.freeze({__proto__:null,WrappedValue:jQ});const{isFastRefreshEnabled:HQ}=mg;class nk extends Error{}class WQ{constructor(e){var n,r,i;xn(this,"_name",void 0),xn(this,"_numLeafs",void 0),xn(this,"_root",void 0),xn(this,"_onHit",void 0),xn(this,"_onSet",void 0),xn(this,"_mapNodeValue",void 0),this._name=e==null?void 0:e.name,this._numLeafs=0,this._root=null,this._onHit=(n=e==null?void 0:e.onHit)!==null&&n!==void 0?n:()=>{},this._onSet=(r=e==null?void 0:e.onSet)!==null&&r!==void 0?r:()=>{},this._mapNodeValue=(i=e==null?void 0:e.mapNodeValue)!==null&&i!==void 0?i:s=>s}size(){return this._numLeafs}root(){return this._root}get(e,n){var r;return(r=this.getLeafNode(e,n))===null||r===void 0?void 0:r.value}getLeafNode(e,n){if(this._root==null)return;let r=this._root;for(;r;){if(n==null||n.onNodeVisit(r),r.type==="leaf")return this._onHit(r),r;const i=this._mapNodeValue(e(r.nodeKey));r=r.branches.get(i)}}set(e,n,r){const i=()=>{var s,c,o,f;let m,x;for(const[H,F]of e){var S,T,C;const k=this._root;if((k==null?void 0:k.type)==="leaf")throw this.invalidCacheError();const N=m;if(m=N?N.branches.get(x):k,m=(S=m)!==null&&S!==void 0?S:{type:"branch",nodeKey:H,parent:N,branches:new Map,branchKey:x},m.type!=="branch"||m.nodeKey!==H)throw this.invalidCacheError();N==null||N.branches.set(x,m),r==null||(T=r.onNodeVisit)===null||T===void 0||T.call(r,m),x=this._mapNodeValue(F),this._root=(C=this._root)!==null&&C!==void 0?C:m}const R=m?(s=m)===null||s===void 0?void 0:s.branches.get(x):this._root;if(R!=null&&(R.type!=="leaf"||R.branchKey!==x))throw this.invalidCacheError();const D={type:"leaf",value:n,parent:m,branchKey:x};(c=m)===null||c===void 0||c.branches.set(x,D),this._root=(o=this._root)!==null&&o!==void 0?o:D,this._numLeafs++,this._onSet(D),r==null||(f=r.onNodeVisit)===null||f===void 0||f.call(r,D)};try{i()}catch(s){if(s instanceof nk)this.clear(),i();else throw s}}delete(e){const n=this.root();if(!n)return!1;if(e===n)return this._root=null,this._numLeafs=0,!0;let r=e.parent,i=e.branchKey;for(;r;){var s;if(r.branches.delete(i),r===n)return r.branches.size===0?(this._root=null,this._numLeafs=0):this._numLeafs--,!0;if(r.branches.size>0)break;i=(s=r)===null||s===void 0?void 0:s.branchKey,r=r.parent}for(;r!==n;r=r.parent)if(r==null)return!1;return this._numLeafs--,!0}clear(){this._numLeafs=0,this._root=null}invalidCacheError(){const e=HQ()?"Possible Fast Refresh module reload detected.  This may also be caused by an selector returning inconsistent values. Resetting cache.":"Invalid cache values.  This happens when selectors do not return consistent values for the same input dependency values.  That may also be caused when using Fast Refresh to change a selector implementation.  Resetting cache.";throw CL(e+(this._name!=null?` - ${this._name}`:"")),new nk}}var KQ={TreeCache:WQ},qQ=KQ.TreeCache,_z=Object.freeze({__proto__:null,TreeCache:qQ});let XQ=class{constructor(e){var n;xn(this,"_maxSize",void 0),xn(this,"_size",void 0),xn(this,"_head",void 0),xn(this,"_tail",void 0),xn(this,"_map",void 0),xn(this,"_keyMapper",void 0),this._maxSize=e.maxSize,this._size=0,this._head=null,this._tail=null,this._map=new Map,this._keyMapper=(n=e.mapKey)!==null&&n!==void 0?n:r=>r}head(){return this._head}tail(){return this._tail}size(){return this._size}maxSize(){return this._maxSize}has(e){return this._map.has(this._keyMapper(e))}get(e){const n=this._keyMapper(e),r=this._map.get(n);if(r)return this.set(e,r.value),r.value}set(e,n){const r=this._keyMapper(e);this._map.get(r)&&this.delete(e);const s=this.head(),c={key:e,right:s,left:null,value:n};s?s.left=c:this._tail=c,this._map.set(r,c),this._head=c,this._size++,this._maybeDeleteLRU()}_maybeDeleteLRU(){this.size()>this.maxSize()&&this.deleteLru()}deleteLru(){const e=this.tail();e&&this.delete(e.key)}delete(e){const n=this._keyMapper(e);if(!this._size||!this._map.has(n))return;const r=Fr(this._map.get(n)),i=r.right,s=r.left;i&&(i.left=r.left),s&&(s.right=r.right),r===this.head()&&(this._head=i),r===this.tail()&&(this._tail=s),this._map.delete(n),this._size--}clear(){this._size=0,this._head=null,this._tail=null,this._map=new Map}};var ZQ={LRUCache:XQ},YQ=ZQ.LRUCache,vz=Object.freeze({__proto__:null,LRUCache:YQ});const{LRUCache:JQ}=vz,{TreeCache:QQ}=_z;function eee({name:t,maxSize:e,mapNodeValue:n=r=>r}){const r=new JQ({maxSize:e}),i=new QQ({name:t,mapNodeValue:n,onHit:s=>{r.set(s,!0)},onSet:s=>{const c=r.tail();r.set(s,!0),c&&i.size()>e&&i.delete(c.key)}});return i}var rk=eee;function ta(t,e,n){if(typeof t=="string"&&!t.includes('"')&&!t.includes("\\"))return`"${t}"`;switch(typeof t){case"undefined":return"";case"boolean":return t?"true":"false";case"number":case"symbol":return String(t);case"string":return JSON.stringify(t);case"function":if((e==null?void 0:e.allowFunctions)!==!0)throw Tn("Attempt to serialize function in a Recoil cache key");return`__FUNCTION(${t.name})__`}if(t===null)return"null";if(typeof t!="object"){var r;return(r=JSON.stringify(t))!==null&&r!==void 0?r:""}if(Rr(t))return"__PROMISE__";if(Array.isArray(t))return`[${t.map((i,s)=>ta(i,e,s.toString()))}]`;if(typeof t.toJSON=="function")return ta(t.toJSON(n),e,n);if(t instanceof Map){const i={};for(const[s,c]of t)i[typeof s=="string"?s:ta(s,e)]=c;return ta(i,e,n)}return t instanceof Set?ta(Array.from(t).sort((i,s)=>ta(i,e).localeCompare(ta(s,e))),e,n):Symbol!==void 0&&t[Symbol.iterator]!=null&&typeof t[Symbol.iterator]=="function"?ta(Array.from(t),e,n):`{${Object.keys(t).filter(i=>t[i]!==void 0).sort().map(i=>`${ta(i,e)}:${ta(t[i],e,i)}`).join(",")}}`}function tee(t,e={allowFunctions:!1}){return ta(t,e)}var ob=tee;const{TreeCache:nee}=_z,r_={equality:"reference",eviction:"keep-all",maxSize:1/0};function ree({equality:t=r_.equality,eviction:e=r_.eviction,maxSize:n=r_.maxSize}=r_,r){const i=iee(t);return see(e,n,i,r)}function iee(t){switch(t){case"reference":return e=>e;case"value":return e=>ob(e)}throw Tn(`Unrecognized equality policy ${t}`)}function see(t,e,n,r){switch(t){case"keep-all":return new nee({name:r,mapNodeValue:n});case"lru":return rk({name:r,maxSize:Fr(e),mapNodeValue:n});case"most-recent":return rk({name:r,maxSize:1,mapNodeValue:n})}throw Tn(`Unrecognized eviction policy ${t}`)}var oee=ree;function aee(t){return()=>null}var lee={startPerfBlock:aee};const{isLoadable:cee,loadableWithError:i_,loadableWithPromise:uee,loadableWithValue:px}=pg,{WrappedValue:bz}=yz,{getNodeLoadable:s_,peekNodeLoadable:dee,setNodeValue:hee}=Hc,{saveDepsToStore:fee}=gg,{DEFAULT_VALUE:pee,getConfigDeletionHandler:mee,getNode:gee,registerNode:ik}=qs,{isRecoilValue:yee}=Jh,{markRecoilValueModified:sk}=Ha,{retainedByOptionWithDefault:_ee}=dd,{recoilCallback:vee}=gz,{startPerfBlock:bee}=lee;class xz{}const Rp=new xz,$p=[],o_=new Map,xee=(()=>{let t=0;return()=>t++})();function wz(t){let e=null;const{key:n,get:r,cachePolicy_UNSTABLE:i}=t,s=t.set!=null?t.set:void 0,c=new Set,o=oee(i??{equality:"reference",eviction:"keep-all"},n),f=_ee(t.retainedBy_UNSTABLE),m=new Map;let x=0;function S(){return!mr("recoil_memory_managament_2020")||x>0}function T(Pe){return Pe.getState().knownSelectors.add(n),x++,()=>{x--}}function C(){return mee(n)!==void 0&&!S()}function R(Pe,Ke,Je,Ot,ht){mt(Ke,Ot,ht),D(Pe,Je)}function D(Pe,Ke){Be(Pe,Ke)&&we(Pe),F(Ke,!0)}function H(Pe,Ke){Be(Pe,Ke)&&(Fr(Re(Pe)).stateVersions.clear(),F(Ke,!1))}function F(Pe,Ke){const Je=o_.get(Pe);if(Je!=null){for(const Ot of Je)sk(Ot,Fr(e));Ke&&o_.delete(Pe)}}function k(Pe,Ke){let Je=o_.get(Ke);Je==null&&o_.set(Ke,Je=new Set),Je.add(Pe)}function N(Pe,Ke,Je,Ot,ht,Ct){return Ke.then(Zt=>{if(!S())throw we(Pe),Rp;const lt=px(Zt);return R(Pe,Je,ht,lt,Ot),Zt}).catch(Zt=>{if(!S())throw we(Pe),Rp;if(Rr(Zt))return U(Pe,Zt,Je,Ot,ht,Ct);const lt=i_(Zt);throw R(Pe,Je,ht,lt,Ot),Zt})}function U(Pe,Ke,Je,Ot,ht,Ct){return Ke.then(Zt=>{if(!S())throw we(Pe),Rp;Ct.loadingDepKey!=null&&Ct.loadingDepPromise===Ke?Je.atomValues.set(Ct.loadingDepKey,px(Zt)):Pe.getState().knownSelectors.forEach(Et=>{Je.atomValues.delete(Et)});const lt=le(Pe,Je);if(lt&&lt.state!=="loading"){if((Be(Pe,ht)||Re(Pe)==null)&&D(Pe,ht),lt.state==="hasValue")return lt.contents;throw lt.contents}if(!Be(Pe,ht)){const Et=Oe(Pe,Je);if(Et!=null)return Et.loadingLoadable.contents}const[en,Nn]=he(Pe,Je,ht);if(en.state!=="loading"&&R(Pe,Je,ht,en,Nn),en.state==="hasError")throw en.contents;return en.contents}).catch(Zt=>{if(Zt instanceof xz)throw Rp;if(!S())throw we(Pe),Rp;const lt=i_(Zt);throw R(Pe,Je,ht,lt,Ot),Zt})}function ie(Pe,Ke,Je,Ot){var ht,Ct,Zt,lt;if(Be(Pe,Ot)||Ke.version===((ht=Pe.getState())===null||ht===void 0||(Ct=ht.currentTree)===null||Ct===void 0?void 0:Ct.version)||Ke.version===((Zt=Pe.getState())===null||Zt===void 0||(lt=Zt.nextTree)===null||lt===void 0?void 0:lt.version)){var en,Nn,Et;fee(n,Je,Pe,(en=(Nn=Pe.getState())===null||Nn===void 0||(Et=Nn.nextTree)===null||Et===void 0?void 0:Et.version)!==null&&en!==void 0?en:Pe.getState().currentTree.version)}for(const Dt of Je)c.add(Dt)}function he(Pe,Ke,Je){const Ot=bee(n);let ht=!0,Ct=!0;const Zt=()=>{Ot(),Ct=!1};let lt,en=!1,Nn;const Et={loadingDepKey:null,loadingDepPromise:null},Dt=new Map;function mn({key:Hn}){const Qn=s_(Pe,Ke,Hn);switch(Dt.set(Hn,Qn),ht||(ie(Pe,Ke,new Set(Dt.keys()),Je),H(Pe,Je)),Qn.state){case"hasValue":return Qn.contents;case"hasError":throw Qn.contents;case"loading":throw Et.loadingDepKey=Hn,Et.loadingDepPromise=Qn.contents,Qn.contents}throw Tn("Invalid Loadable state")}const Mr=Hn=>(...Qn)=>{if(Ct)throw Tn("Callbacks from getCallback() should only be called asynchronously after the selector is evalutated.  It can be used for selectors to return objects with callbacks that can work with Recoil state without a subscription.");return e==null&&Qp(!1),vee(Pe,Hn,Qn,{node:e})};try{lt=r({get:mn,getCallback:Mr}),lt=yee(lt)?mn(lt):lt,cee(lt)&&(lt.state==="hasError"&&(en=!0),lt=lt.contents),Rr(lt)?lt=N(Pe,lt,Ke,Dt,Je,Et).finally(Zt):Zt(),lt=lt instanceof bz?lt.value:lt}catch(Hn){lt=Hn,Rr(lt)?lt=U(Pe,lt,Ke,Dt,Je,Et).finally(Zt):(en=!0,Zt())}return en?Nn=i_(lt):Rr(lt)?Nn=uee(lt):Nn=px(lt),ht=!1,$e(Pe,Je,Dt),ie(Pe,Ke,new Set(Dt.keys()),Je),[Nn,Dt]}function le(Pe,Ke){let Je=Ke.atomValues.get(n);if(Je!=null)return Je;const Ot=new Set;try{Je=o.get(Ct=>(typeof Ct!="string"&&Qp(!1),s_(Pe,Ke,Ct).contents),{onNodeVisit:Ct=>{Ct.type==="branch"&&Ct.nodeKey!==n&&Ot.add(Ct.nodeKey)}})}catch(Ct){throw Tn(`Problem with cache lookup for selector "${n}": ${Ct.message}`)}if(Je){var ht;Ke.atomValues.set(n,Je),ie(Pe,Ke,Ot,(ht=Re(Pe))===null||ht===void 0?void 0:ht.executionID)}return Je}function ve(Pe,Ke){const Je=le(Pe,Ke);if(Je!=null)return we(Pe),Je;const Ot=Oe(Pe,Ke);if(Ot!=null){var ht;return((ht=Ot.loadingLoadable)===null||ht===void 0?void 0:ht.state)==="loading"&&k(Pe,Ot.executionID),Ot.loadingLoadable}const Ct=xee(),[Zt,lt]=he(Pe,Ke,Ct);return Zt.state==="loading"?(Ee(Pe,Ct,Zt,lt,Ke),k(Pe,Ct)):(we(Pe),mt(Ke,Zt,lt)),Zt}function Oe(Pe,Ke){const Je=j8([m.has(Pe)?[Fr(m.get(Pe))]:[],Kv(ML(m,([ht])=>ht!==Pe),([,ht])=>ht)]);function Ot(ht){for(const[Ct,Zt]of ht)if(!s_(Pe,Ke,Ct).is(Zt))return!0;return!1}for(const ht of Je){if(ht.stateVersions.get(Ke.version)||!Ot(ht.depValuesDiscoveredSoFarDuringAsyncWork))return ht.stateVersions.set(Ke.version,!0),ht;ht.stateVersions.set(Ke.version,!1)}}function Re(Pe){return m.get(Pe)}function Ee(Pe,Ke,Je,Ot,ht){m.set(Pe,{depValuesDiscoveredSoFarDuringAsyncWork:Ot,executionID:Ke,loadingLoadable:Je,stateVersions:new Map([[ht.version,!0]])})}function $e(Pe,Ke,Je){if(Be(Pe,Ke)){const Ot=Re(Pe);Ot!=null&&(Ot.depValuesDiscoveredSoFarDuringAsyncWork=Je)}}function we(Pe){m.delete(Pe)}function Be(Pe,Ke){var Je;return Ke===((Je=Re(Pe))===null||Je===void 0?void 0:Je.executionID)}function Jt(Pe){return Array.from(Pe.entries()).map(([Ke,Je])=>[Ke,Je.contents])}function mt(Pe,Ke,Je){Pe.atomValues.set(n,Ke);try{o.set(Jt(Je),Ke)}catch(Ot){throw Tn(`Problem with setting cache for selector "${n}": ${Ot.message}`)}}function an(Pe){if($p.includes(n)){const Ke=`Recoil selector has circular dependencies: ${$p.slice($p.indexOf(n)).join(" → ")}`;return i_(Tn(Ke))}$p.push(n);try{return Pe()}finally{$p.pop()}}function ot(Pe,Ke){const Je=Ke.atomValues.get(n);return Je??o.get(Ot=>{var ht;return typeof Ot!="string"&&Qp(!1),(ht=dee(Pe,Ke,Ot))===null||ht===void 0?void 0:ht.contents})}function It(Pe,Ke){return an(()=>ve(Pe,Ke))}function at(Pe){Pe.atomValues.delete(n)}function kt(Pe,Ke){e==null&&Qp(!1);for(const Ot of c){var Je;const ht=gee(Ot);(Je=ht.clearCache)===null||Je===void 0||Je.call(ht,Pe,Ke)}c.clear(),at(Ke),o.clear(),sk(Pe,e)}return s!=null?e=ik({key:n,nodeType:"selector",peek:ot,get:It,set:(Ke,Je,Ot)=>{let ht=!1;const Ct=new Map;function Zt({key:Et}){if(ht)throw Tn("Recoil: Async selector sets are not currently supported.");const Dt=s_(Ke,Je,Et);if(Dt.state==="hasValue")return Dt.contents;if(Dt.state==="loading"){const mn=`Getting value of asynchronous atom or selector "${Et}" in a pending state while setting selector "${n}" is not yet supported.`;throw Tn(mn)}else throw Dt.contents}function lt(Et,Dt){if(ht)throw Tn("Recoil: Async selector sets are not currently supported.");const mn=typeof Dt=="function"?Dt(Zt(Et)):Dt;hee(Ke,Je,Et.key,mn).forEach((Hn,Qn)=>Ct.set(Qn,Hn))}function en(Et){lt(Et,pee)}const Nn=s({set:lt,get:Zt,reset:en},Ot);if(Nn!==void 0)throw Rr(Nn)?Tn("Recoil: Async selector sets are not currently supported."):Tn("Recoil: selector set should be a void function.");return ht=!0,Ct},init:T,invalidate:at,clearCache:kt,shouldDeleteConfigOnRelease:C,dangerouslyAllowMutability:t.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:f}):e=ik({key:n,nodeType:"selector",peek:ot,get:It,init:T,invalidate:at,clearCache:kt,shouldDeleteConfigOnRelease:C,dangerouslyAllowMutability:t.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:f})}wz.value=t=>new bz(t);var tf=wz;const{isLoadable:wee,loadableWithError:mx,loadableWithPromise:gx,loadableWithValue:Wd}=pg,{WrappedValue:Ez}=yz,{peekNodeInfo:Eee}=Hc,{DEFAULT_VALUE:Mu,DefaultValue:yc,getConfigDeletionHandler:Tz,registerNode:Tee,setConfigDeletionHandler:See}=qs,{isRecoilValue:Aee}=Jh,{getRecoilValueAsLoadable:Pee,markRecoilValueModified:Cee,setRecoilValue:ok,setRecoilValueLoadable:Iee}=Ha,{retainedByOptionWithDefault:Lee}=dd,Mp=t=>t instanceof Ez?t.value:t;function Ree(t){const{key:e,persistence_UNSTABLE:n}=t,r=Lee(t.retainedBy_UNSTABLE);let i=0;function s(k){return gx(k.then(N=>(c=Wd(N),N)).catch(N=>{throw c=mx(N),N}))}let c=Rr(t.default)?s(t.default):wee(t.default)?t.default.state==="loading"?s(t.default.contents):t.default:Wd(Mp(t.default));c.contents;let o;const f=new Map;function m(k){return k}function x(k,N){const U=N.then(ie=>{var he,le;return((le=((he=k.getState().nextTree)!==null&&he!==void 0?he:k.getState().currentTree).atomValues.get(e))===null||le===void 0?void 0:le.contents)===U&&ok(k,F,ie),ie}).catch(ie=>{var he,le;throw((le=((he=k.getState().nextTree)!==null&&he!==void 0?he:k.getState().currentTree).atomValues.get(e))===null||le===void 0?void 0:le.contents)===U&&Iee(k,F,mx(ie)),ie});return U}function S(k,N,U){var ie;i++;const he=()=>{var Re;i--,(Re=f.get(k))===null||Re===void 0||Re.forEach(Ee=>Ee()),f.delete(k)};if(k.getState().knownAtoms.add(e),c.state==="loading"){const Re=()=>{var Ee;((Ee=k.getState().nextTree)!==null&&Ee!==void 0?Ee:k.getState().currentTree).atomValues.has(e)||Cee(k,F)};c.contents.finally(Re)}const le=(ie=t.effects)!==null&&ie!==void 0?ie:t.effects_UNSTABLE;if(le!=null){let Be=function(at){if(Ee&&at.key===e){const kt=Re;return kt instanceof yc?T(k,N):Rr(kt)?gx(kt.then(Pe=>Pe instanceof yc?c.toPromise():Pe)):Wd(kt)}return Pee(k,at)},Jt=function(at){return Be(at).toPromise()},mt=function(at){var kt;const Pe=Eee(k,(kt=k.getState().nextTree)!==null&&kt!==void 0?kt:k.getState().currentTree,at.key);return Ee&&at.key===e&&!(Re instanceof yc)?{...Pe,isSet:!0,loadable:Be(at)}:Pe},Re=Mu,Ee=!0,$e=!1,we=null;const an=at=>kt=>{if(Ee){const Pe=Be(F),Ke=Pe.state==="hasValue"?Pe.contents:Mu;Re=typeof kt=="function"?kt(Ke):kt,Rr(Re)&&(Re=Re.then(Je=>(we={effect:at,value:Je},Je)))}else{if(Rr(kt))throw Tn("Setting atoms to async values is not implemented.");typeof kt!="function"&&(we={effect:at,value:Mp(kt)}),ok(k,F,typeof kt=="function"?Pe=>{const Ke=Mp(kt(Pe));return we={effect:at,value:Ke},Ke}:Mp(kt))}},ot=at=>()=>an(at)(Mu),It=at=>kt=>{var Pe;const{release:Ke}=k.subscribeToTransactions(Je=>{var Ot;let{currentTree:ht,previousTree:Ct}=Je.getState();Ct||(Ct=ht);const Zt=(Ot=ht.atomValues.get(e))!==null&&Ot!==void 0?Ot:c;if(Zt.state==="hasValue"){var lt,en,Nn,Et;const Dt=Zt.contents,mn=(lt=Ct.atomValues.get(e))!==null&&lt!==void 0?lt:c,Mr=mn.state==="hasValue"?mn.contents:Mu;((en=we)===null||en===void 0?void 0:en.effect)!==at||((Nn=we)===null||Nn===void 0?void 0:Nn.value)!==Dt?kt(Dt,Mr,!ht.atomValues.has(e)):((Et=we)===null||Et===void 0?void 0:Et.effect)===at&&(we=null)}},e);f.set(k,[...(Pe=f.get(k))!==null&&Pe!==void 0?Pe:[],Ke])};for(const at of le)try{const kt=at({node:F,storeID:k.storeID,parentStoreID_UNSTABLE:k.parentStoreID,trigger:U,setSelf:an(at),resetSelf:ot(at),onSet:It(at),getPromise:Jt,getLoadable:Be,getInfo_UNSTABLE:mt});if(kt!=null){var ve;f.set(k,[...(ve=f.get(k))!==null&&ve!==void 0?ve:[],kt])}}catch(kt){Re=kt,$e=!0}if(Ee=!1,!(Re instanceof yc)){var Oe;const at=$e?mx(Re):Rr(Re)?gx(x(k,Re)):Wd(Mp(Re));at.contents,N.atomValues.set(e,at),(Oe=k.getState().nextTree)===null||Oe===void 0||Oe.atomValues.set(e,at)}}return he}function T(k,N){var U,ie;return(U=(ie=N.atomValues.get(e))!==null&&ie!==void 0?ie:o)!==null&&U!==void 0?U:c}function C(k,N){if(N.atomValues.has(e))return Fr(N.atomValues.get(e));if(N.nonvalidatedAtoms.has(e)){if(o!=null)return o;if(n==null)return c;const U=N.nonvalidatedAtoms.get(e),ie=n.validator(U,Mu);return o=ie instanceof yc?c:Wd(ie),o}else return c}function R(){o=void 0}function D(k,N,U){if(N.atomValues.has(e)){const ie=Fr(N.atomValues.get(e));if(ie.state==="hasValue"&&U===ie.contents)return new Map}else if(!N.nonvalidatedAtoms.has(e)&&U instanceof yc)return new Map;return o=void 0,new Map().set(e,Wd(U))}function H(){return Tz(e)!==void 0&&i<=0}const F=Tee({key:e,nodeType:"atom",peek:T,get:C,set:D,init:S,invalidate:R,shouldDeleteConfigOnRelease:H,dangerouslyAllowMutability:t.dangerouslyAllowMutability,persistence_UNSTABLE:t.persistence_UNSTABLE?{type:t.persistence_UNSTABLE.type,backButton:t.persistence_UNSTABLE.backButton}:void 0,shouldRestoreFromSnapshots:!0,retainedBy:r});return F}function GL(t){const{...e}=t,n="default"in t?t.default:new Promise(()=>{});return Aee(n)?$ee({...e,default:n}):Ree({...e,default:n})}function $ee(t){const e=GL({...t,default:Mu,persistence_UNSTABLE:t.persistence_UNSTABLE===void 0?void 0:{...t.persistence_UNSTABLE,validator:r=>r instanceof yc?r:Fr(t.persistence_UNSTABLE).validator(r,Mu)},effects:t.effects,effects_UNSTABLE:t.effects_UNSTABLE}),n=tf({key:`${t.key}__withFallback`,get:({get:r})=>{const i=r(e);return i instanceof yc?t.default:i},set:({set:r},i)=>r(e,i),cachePolicy_UNSTABLE:{eviction:"most-recent"},dangerouslyAllowMutability:t.dangerouslyAllowMutability});return See(n.key,Tz(t.key)),n}GL.value=t=>new Ez(t);var Sz=GL;class Mee{constructor(e){var n;xn(this,"_map",void 0),xn(this,"_keyMapper",void 0),this._map=new Map,this._keyMapper=(n=e==null?void 0:e.mapKey)!==null&&n!==void 0?n:r=>r}size(){return this._map.size}has(e){return this._map.has(this._keyMapper(e))}get(e){return this._map.get(this._keyMapper(e))}set(e,n){this._map.set(this._keyMapper(e),n)}delete(e){this._map.delete(this._keyMapper(e))}clear(){this._map.clear()}}var kee={MapCache:Mee},Oee=kee.MapCache,Dee=Object.freeze({__proto__:null,MapCache:Oee});const{LRUCache:ak}=vz,{MapCache:Fee}=Dee,a_={equality:"reference",eviction:"none",maxSize:1/0};function zee({equality:t=a_.equality,eviction:e=a_.eviction,maxSize:n=a_.maxSize}=a_){const r=Nee(t);return Bee(e,n,r)}function Nee(t){switch(t){case"reference":return e=>e;case"value":return e=>ob(e)}throw Tn(`Unrecognized equality policy ${t}`)}function Bee(t,e,n){switch(t){case"keep-all":return new Fee({mapKey:n});case"lru":return new ak({mapKey:n,maxSize:Fr(e)});case"most-recent":return new ak({mapKey:n,maxSize:1})}throw Tn(`Unrecognized eviction policy ${t}`)}var Az=zee;const{setConfigDeletionHandler:Uee}=qs;function Vee(t){var e,n;const r=Az({equality:(e=(n=t.cachePolicyForParams_UNSTABLE)===null||n===void 0?void 0:n.equality)!==null&&e!==void 0?e:"value",eviction:"keep-all"});return i=>{var s,c;const o=r.get(i);if(o!=null)return o;const{cachePolicyForParams_UNSTABLE:f,...m}=t,x="default"in t?t.default:new Promise(()=>{}),S=Sz({...m,key:`${t.key}__${(s=ob(i))!==null&&s!==void 0?s:"void"}`,default:typeof x=="function"?x(i):x,retainedBy_UNSTABLE:typeof t.retainedBy_UNSTABLE=="function"?t.retainedBy_UNSTABLE(i):t.retainedBy_UNSTABLE,effects:typeof t.effects=="function"?t.effects(i):typeof t.effects_UNSTABLE=="function"?t.effects_UNSTABLE(i):(c=t.effects)!==null&&c!==void 0?c:t.effects_UNSTABLE});return r.set(i,S),Uee(S.key,()=>{r.delete(i)}),S}}var Gee=Vee;const{setConfigDeletionHandler:jee}=qs;let Hee=0;function Wee(t){var e,n;const r=Az({equality:(e=(n=t.cachePolicyForParams_UNSTABLE)===null||n===void 0?void 0:n.equality)!==null&&e!==void 0?e:"value",eviction:"keep-all"});return i=>{var s;let c;try{c=r.get(i)}catch(T){throw Tn(`Problem with cache lookup for selector ${t.key}: ${T.message}`)}if(c!=null)return c;const o=`${t.key}__selectorFamily/${(s=ob(i,{allowFunctions:!0}))!==null&&s!==void 0?s:"void"}/${Hee++}`,f=T=>t.get(i)(T),m=t.cachePolicy_UNSTABLE,x=typeof t.retainedBy_UNSTABLE=="function"?t.retainedBy_UNSTABLE(i):t.retainedBy_UNSTABLE;let S;if(t.set!=null){const T=t.set;S=tf({key:o,get:f,set:(R,D)=>T(i)(R,D),cachePolicy_UNSTABLE:m,dangerouslyAllowMutability:t.dangerouslyAllowMutability,retainedBy_UNSTABLE:x})}else S=tf({key:o,get:f,cachePolicy_UNSTABLE:m,dangerouslyAllowMutability:t.dangerouslyAllowMutability,retainedBy_UNSTABLE:x});return r.set(i,S),jee(S.key,()=>{r.delete(i)}),S}}var Wc=Wee;const Kee=Wc({key:"__constant",get:t=>()=>t,cachePolicyForParams_UNSTABLE:{equality:"reference"}});function qee(t){return Kee(t)}var Xee=qee;const Zee=Wc({key:"__error",get:t=>()=>{throw Tn(t)},cachePolicyForParams_UNSTABLE:{equality:"reference"}});function Yee(t){return Zee(t)}var Jee=Yee;function Qee(t){return t}var ete=Qee;const{loadableWithError:Pz,loadableWithPromise:Cz,loadableWithValue:Iz}=pg;function ab(t,e){const n=Array(e.length).fill(void 0),r=Array(e.length).fill(void 0);for(const[i,s]of e.entries())try{n[i]=t(s)}catch(c){r[i]=c}return[n,r]}function tte(t){return t!=null&&!Rr(t)}function lb(t){return Array.isArray(t)?t:Object.getOwnPropertyNames(t).map(e=>t[e])}function N2(t,e){return Array.isArray(t)?e:Object.getOwnPropertyNames(t).reduce((n,r,i)=>({...n,[r]:e[i]}),{})}function Fh(t,e,n){const r=n.map((i,s)=>i==null?Iz(e[s]):Rr(i)?Cz(i):Pz(i));return N2(t,r)}function nte(t,e){return e.map((n,r)=>n===void 0?t[r]:n)}const rte=Wc({key:"__waitForNone",get:t=>({get:e})=>{const n=lb(t),[r,i]=ab(e,n);return Fh(t,r,i)},dangerouslyAllowMutability:!0}),ite=Wc({key:"__waitForAny",get:t=>({get:e})=>{const n=lb(t),[r,i]=ab(e,n);return i.some(s=>!Rr(s))?Fh(t,r,i):new Promise(s=>{for(const[c,o]of i.entries())Rr(o)&&o.then(f=>{r[c]=f,i[c]=void 0,s(Fh(t,r,i))}).catch(f=>{i[c]=f,s(Fh(t,r,i))})})},dangerouslyAllowMutability:!0}),ste=Wc({key:"__waitForAll",get:t=>({get:e})=>{const n=lb(t),[r,i]=ab(e,n);if(i.every(c=>c==null))return N2(t,r);const s=i.find(tte);if(s!=null)throw s;return Promise.all(i).then(c=>N2(t,nte(r,c)))},dangerouslyAllowMutability:!0}),ote=Wc({key:"__waitForAllSettled",get:t=>({get:e})=>{const n=lb(t),[r,i]=ab(e,n);return i.every(s=>!Rr(s))?Fh(t,r,i):Promise.all(i.map((s,c)=>Rr(s)?s.then(o=>{r[c]=o,i[c]=void 0}).catch(o=>{r[c]=void 0,i[c]=o}):null)).then(()=>Fh(t,r,i))},dangerouslyAllowMutability:!0}),ate=Wc({key:"__noWait",get:t=>({get:e})=>{try{return tf.value(Iz(e(t)))}catch(n){return tf.value(Rr(n)?Cz(n):Pz(n))}},dangerouslyAllowMutability:!0});var lte={waitForNone:rte,waitForAny:ite,waitForAll:ste,waitForAllSettled:ote,noWait:ate};const{RecoilLoadable:cte}=pg,{DefaultValue:ute}=qs,{RecoilRoot:dte,useRecoilStoreID:hte}=Ol,{isRecoilValue:fte}=Jh,{retentionZone:pte}=Xv,{freshSnapshot:mte}=tb,{useRecoilState:gte,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:yte,useRecoilStateLoadable:_te,useRecoilValue:vte,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:bte,useRecoilValueLoadable:xte,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:wte,useResetRecoilState:Ete,useSetRecoilState:Tte}=kJ,{useGotoRecoilSnapshot:Ste,useRecoilSnapshot:Ate,useRecoilTransactionObserver:Pte}=hz,{useRecoilCallback:Cte}=gz,{noWait:Ite,waitForAll:Lte,waitForAllSettled:Rte,waitForAny:$te,waitForNone:Mte}=lte;var bg={DefaultValue:ute,isRecoilValue:fte,RecoilLoadable:cte,RecoilEnv:bf,RecoilRoot:dte,useRecoilStoreID:hte,useRecoilBridgeAcrossReactRoots_UNSTABLE:aQ,atom:Sz,selector:tf,atomFamily:Gee,selectorFamily:Wc,constSelector:Xee,errorSelector:Jee,readOnlySelector:ete,noWait:Ite,waitForNone:Mte,waitForAny:$te,waitForAll:Lte,waitForAllSettled:Rte,useRecoilValue:vte,useRecoilValueLoadable:xte,useRecoilState:gte,useRecoilStateLoadable:_te,useSetRecoilState:Tte,useResetRecoilState:Ete,useGetRecoilValueInfo_UNSTABLE:tQ,useRecoilRefresher_UNSTABLE:DQ,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:wte,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:bte,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:yte,useRecoilCallback:Cte,useRecoilTransaction_UNSTABLE:UQ,useGotoRecoilSnapshot:Ste,useRecoilSnapshot:Ate,useRecoilTransactionObserver_UNSTABLE:Pte,snapshot_UNSTABLE:mte,useRetain:zL,retentionZone:pte},kte=bg.RecoilRoot,Lz=bg.atom,hd=bg.selector,_c=bg.useRecoilValue,B2=bg.useRecoilState;const Ote="modulepreload",Dte=function(t){return"/"+t},lk={},Fte=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=Dte(s),s in lk)return;lk[s]=!0;const c=s.endsWith(".css"),o=c?'[rel="stylesheet"]':"";if(!!r)for(let x=i.length-1;x>=0;x--){const S=i[x];if(S.href===s&&(!c||S.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const m=document.createElement("link");if(m.rel=c?"stylesheet":Ote,c||(m.as="script",m.crossOrigin=""),m.href=s,document.head.appendChild(m),c)return new Promise((x,S)=>{m.addEventListener("load",x),m.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())},zte=ee.createContext(null);function Nte(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function ck(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function uk(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const Bte=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function dk(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{const i=e[r.ref];let s=null;if("interactive"in r&&(s={...r},delete s.interactive),i){s=s||{...r},delete s.ref;for(const c of Bte)c in i&&(s[c]=i[c])}return s||r});return{...t,layers:n}}function Ute(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function xc(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!xc(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!xc(t[i],e[i]))return!1;return!0}return!1}const hk={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},yx={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},fk={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Vte=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Gte=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class nf{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[fk[i.type]];s&&s(i)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[hk[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[yx[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=nf.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n,r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:c}=e;return c&&(c.bounds?i.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):r._updateViewState(c,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i.triggerRepaint(),r}_initialize(e){const{props:n}=this,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||jte()||null,container:e,style:dk(n.mapStyle)},i=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),n.gl){const m=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=m,n.gl)}const s=new this._MapClass(r);i.padding&&s.setPadding(i.padding),n.cursor&&(s.getCanvas().style.cursor=n.cursor),this._createShadowTransform(s);const c=s._render;s._render=m=>{this._inRender=!0,c.call(s,m),this._inRender=!1};const o=s._renderTaskQueue.run;s._renderTaskQueue.run=m=>{o.call(s._renderTaskQueue,m),this._onBeforeRepaint()},s.on("render",()=>this._onAfterRepaint());const f=s.fire;s.fire=this._fireEvent.bind(this,f),s.on("resize",()=>{this._renderTransform.resize(s.transform.width,s.transform.height)}),s.on("styledata",()=>this._updateStyleComponents(this.props,{})),s.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const m in hk)s.on(m,this._onPointerEvent);for(const m in yx)s.on(m,this._onCameraEvent);for(const m in fk)s.on(m,this._onEvent);this._map=s}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),nf.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=Nte(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:c,bearing:o}=i,f=r.isMoving();f&&(i.cameraElevationReference="sea");const m=uk(i,{...ck(r.transform),...e});if(f&&(i.cameraElevationReference="ground"),m&&n){const x=this._deferredEvents;x.move=!0,x.zoom||(x.zoom=s!==i.zoom),x.rotate||(x.rotate=o!==i.bearing),x.pitch||(x.pitch=c!==i.pitch)}return f||uk(r.transform,e),m}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of Vte)s in e&&!xc(e[s],n[s])&&(i=!0,r[`set${s[0].toUpperCase()}${s.slice(1)}`](e[s]));return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==n.mapStyle){const r={diff:e.styleDiffing};return"localIdeographFontFamily"in e&&(r.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(dk(e.mapStyle),r),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.style.loaded()&&("light"in e&&!xc(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&!xc(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&!xc(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){const r=this._map;let i=!1;for(const s of Gte){const c=e[s];xc(c,n[s])||(i=!0,c?r[s].enable(c):r[s].disable())}return i}_queryRenderedFeatures(e){const n=this._map,{interactiveLayerIds:r=[]}=this.props;try{return n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,c=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,o=this._queryRenderedFeatures(e.point),f=o.length>0;!f&&c&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=o,f&&!c&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,c=typeof n=="string"?n:n.type;return c==="move"&&this._updateViewState(this.props,!1),c in yx&&(typeof n=="object"&&(n.viewState=ck(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=n}}}nf.savedMaps=[];function jte(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const Hte=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Wte(t,e){if(!t)return null;const n=t.map,r={getMap:()=>n,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:i=>t.transform.locationPoint(e.LngLat.convert(i)),unproject:i=>t.transform.pointLocation(e.Point.convert(i)),queryTerrainElevation:(i,s)=>{const c=n.transform;n.transform=t.transform;const o=n.queryTerrainElevation(i,s);return n.transform=c,o}};for(const i of Kte(n))!(i in r)&&!Hte.includes(i)&&(r[i]=n[i].bind(n));return r}function Kte(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const qte=typeof document<"u"?ee.useLayoutEffect:ee.useEffect,Xte=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function Zte(t,e){for(const n of Xte)n in e&&(t[n]=e[n]);e.RTLTextPlugin&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(e.RTLTextPlugin,n=>{n&&console.error(n)},!1)}const cb=ee.createContext(null),Yte={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:t=>console.error(t.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},jL=ee.forwardRef((t,e)=>{const n=ee.useContext(zte),[r,i]=ee.useState(null),s=ee.useRef(),{current:c}=ee.useRef({mapLib:null,map:null});ee.useEffect(()=>{const m=t.mapLib;let x=!0,S;return Promise.resolve(m||Fte(()=>import("./mapbox-gl-a4f0deaa.js").then(T=>T.m),[])).then(T=>{if(x){if(T.Map||(T=T.default),!T||!T.Map)throw new Error("Invalid mapLib");if(Zte(T,t),T.supported(t))t.reuseMaps&&(S=nf.reuse(t,s.current)),S||(S=new nf(T.Map,t,s.current)),c.map=Wte(S,T),c.mapLib=T,i(S),n==null||n.onMapMount(c.map,t.id);else throw new Error("Map is not supported by this browser")}}).catch(T=>{t.onError({type:"error",target:null,originalEvent:null,error:T})}),()=>{x=!1,S&&(n==null||n.onMapUnmount(t.id),t.reuseMaps?S.recycle():S.destroy())}},[]),qte(()=>{r&&r.setProps(t)}),ee.useImperativeHandle(e,()=>c.map,[r]);const o=ee.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),f={height:"100%"};return ee.createElement("div",{id:t.id,ref:s,style:o},r&&ee.createElement(cb.Provider,{value:c},ee.createElement("div",{"mapboxgl-children":"",style:f},t.children)))});jL.displayName="Map";jL.defaultProps=Yte;const Jte=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function fd(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!Jte.test(r)?n[r]=`${i}px`:n[r]=i}}const Qte={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function Rz(t){const{map:e,mapLib:n}=ee.useContext(cb),r=ee.useRef({props:t});r.current.props=t;const i=ee.useMemo(()=>{let s=!1;ee.Children.forEach(t.children,f=>{f&&(s=!0)});const c={...t,element:s?document.createElement("div"):null},o=new n.Marker(c).setLngLat([t.longitude,t.latitude]);return o.getElement().addEventListener("click",f=>{var m,x;(x=(m=r.current.props).onClick)===null||x===void 0||x.call(m,{type:"click",target:o,originalEvent:f})}),o.on("dragstart",f=>{var m,x;const S=f;S.lngLat=i.getLngLat(),(x=(m=r.current.props).onDragStart)===null||x===void 0||x.call(m,S)}),o.on("drag",f=>{var m,x;const S=f;S.lngLat=i.getLngLat(),(x=(m=r.current.props).onDrag)===null||x===void 0||x.call(m,S)}),o.on("dragend",f=>{var m,x;const S=f;S.lngLat=i.getLngLat(),(x=(m=r.current.props).onDragEnd)===null||x===void 0||x.call(m,S)}),o},[]);return ee.useEffect(()=>(i.addTo(e.getMap()),()=>{i.remove()}),[]),ee.useEffect(()=>{fd(i.getElement(),t.style)},[t.style]),(i.getLngLat().lng!==t.longitude||i.getLngLat().lat!==t.latitude)&&i.setLngLat([t.longitude,t.latitude]),t.offset&&!Ute(i.getOffset(),t.offset)&&i.setOffset(t.offset),i.isDraggable()!==t.draggable&&i.setDraggable(t.draggable),i.getRotation()!==t.rotation&&i.setRotation(t.rotation),i.getRotationAlignment()!==t.rotationAlignment&&i.setRotationAlignment(t.rotationAlignment),i.getPitchAlignment()!==t.pitchAlignment&&i.setPitchAlignment(t.pitchAlignment),i.getPopup()!==t.popup&&i.setPopup(t.popup),Gu.createPortal(t.children,i.getElement())}Rz.defaultProps=Qte;ee.memo(Rz);function pk(t){return new Set(t?t.trim().split(/\s+/):[])}function ene(t){const{map:e,mapLib:n}=ee.useContext(cb),r=ee.useMemo(()=>document.createElement("div"),[]),i=ee.useRef({props:t});i.current.props=t;const s=ee.useMemo(()=>{const c={...t},o=new n.Popup(c).setLngLat([t.longitude,t.latitude]);return o.once("open",f=>{var m,x;(x=(m=i.current.props).onOpen)===null||x===void 0||x.call(m,f)}),o},[]);if(ee.useEffect(()=>{const c=o=>{var f,m;(m=(f=i.current.props).onClose)===null||m===void 0||m.call(f,o)};return s.on("close",c),s.setDOMContent(r).addTo(e.getMap()),()=>{s.off("close",c),s.isOpen()&&s.remove()}},[]),ee.useEffect(()=>{fd(s.getElement(),t.style)},[t.style]),s.isOpen()&&((s.getLngLat().lng!==t.longitude||s.getLngLat().lat!==t.latitude)&&s.setLngLat([t.longitude,t.latitude]),t.offset&&!xc(s.options.offset,t.offset)&&s.setOffset(t.offset),(s.options.anchor!==t.anchor||s.options.maxWidth!==t.maxWidth)&&(s.options.anchor=t.anchor,s.setMaxWidth(t.maxWidth)),s.options.className!==t.className)){const c=pk(s.options.className),o=pk(t.className);for(const f of c)o.has(f)||s.removeClassName(f);for(const f of o)c.has(f)||s.addClassName(f);s.options.className=t.className}return Gu.createPortal(t.children,r)}ee.memo(ene);function xg(t,e,n,r){const i=ee.useContext(cb),s=ee.useMemo(()=>t(i),[]);return ee.useEffect(()=>{const c=r||n||e,o=typeof e=="function"&&typeof n=="function"?e:null,f=typeof n=="function"?n:typeof e=="function"?e:null,{map:m}=i;return m.hasControl(s)||(m.addControl(s,c==null?void 0:c.position),o&&o(i)),()=>{f&&f(i),m.hasControl(s)&&m.removeControl(s)}},[]),s}function tne(t){const e=xg(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return ee.useEffect(()=>{fd(e._container,t.style)},[t.style]),null}ee.memo(tne);function nne(t){const e=xg(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return ee.useEffect(()=>{fd(e._controlContainer,t.style)},[t.style]),null}ee.memo(nne);const $z=ee.forwardRef((t,e)=>{const n=ee.useRef({props:t}),r=xg(({mapLib:i})=>{const s=new i.GeolocateControl(t),c=s._setupUI;return s._setupUI=o=>{s._container.hasChildNodes()||c(o)},s.on("geolocate",o=>{var f,m;(m=(f=n.current.props).onGeolocate)===null||m===void 0||m.call(f,o)}),s.on("error",o=>{var f,m;(m=(f=n.current.props).onError)===null||m===void 0||m.call(f,o)}),s.on("outofmaxbounds",o=>{var f,m;(m=(f=n.current.props).onOutOfMaxBounds)===null||m===void 0||m.call(f,o)}),s.on("trackuserlocationstart",o=>{var f,m;(m=(f=n.current.props).onTrackUserLocationStart)===null||m===void 0||m.call(f,o)}),s.on("trackuserlocationend",o=>{var f,m;(m=(f=n.current.props).onTrackUserLocationEnd)===null||m===void 0||m.call(f,o)}),s},{position:t.position});return n.current.props=t,ee.useImperativeHandle(e,()=>({trigger:()=>r.trigger()}),[]),ee.useEffect(()=>{fd(r._container,t.style)},[t.style]),null});$z.displayName="GeolocateControl";ee.memo($z);function rne(t){const e=xg(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return ee.useEffect(()=>{fd(e._container,t.style)},[t.style]),null}const ine=ee.memo(rne),sne={unit:"metric",maxWidth:100};function Mz(t){const e=xg(({mapLib:n})=>new n.ScaleControl(t),{position:t.position});return(e.options.unit!==t.unit||e.options.maxWidth!==t.maxWidth)&&(e.options.maxWidth=t.maxWidth,e.setUnit(t.unit)),ee.useEffect(()=>{fd(e._container,t.style)},[t.style]),null}Mz.defaultProps=sne;ee.memo(Mz);function j0(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const HL=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),mk=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);mk&&parseFloat(mk[1]);const one="3.3.5";function Rl(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Q_=typeof process!="object"||String(process)!=="[object process]"||process.browser,ane=typeof window<"u"&&typeof window.orientation<"u",gk=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);gk&&parseFloat(gk[1]);function Hm(t){"@babel/helpers - typeof";return Hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Hm(t)}function lne(t,e){if(Hm(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Hm(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cne(t){var e=lne(t,"string");return Hm(e)==="symbol"?e:String(e)}function K(t,e,n){return e=cne(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class une{constructor(e,n){K(this,"name",void 0),K(this,"workerThread",void 0),K(this,"isRunning",!0),K(this,"result",void 0),K(this,"_resolve",()=>{}),K(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){Rl(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Rl(this.isRunning),this.isRunning=!1,this._reject(e)}}let _x=class{terminate(){}};const vx=new Map;function dne(t){Rl(t.source&&!t.url||!t.source&&t.url);let e=vx.get(t.source||t.url);return e||(t.url&&(e=hne(t.url),vx.set(t.url,e)),t.source&&(e=kz(t.source),vx.set(t.source,e))),Rl(e),e}function hne(t){if(!t.startsWith("http"))return t;const e=fne(t);return kz(e)}function kz(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function fne(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function Oz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(yk(t))r.add(t);else if(yk(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)Oz(t[i],e,r)}}return n===void 0?Array.from(r):[]}function yk(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const bx=()=>{};class U2{static isSupported(){return typeof Worker<"u"&&Q_||typeof _x<"u"&&!Q_}constructor(e){K(this,"name",void 0),K(this,"source",void 0),K(this,"url",void 0),K(this,"terminated",!1),K(this,"worker",void 0),K(this,"onMessage",void 0),K(this,"onError",void 0),K(this,"_loadableURL","");const{name:n,source:r,url:i}=e;Rl(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=bx,this.onError=s=>console.log(s),this.worker=Q_?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=bx,this.onError=bx,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||Oz(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=dne({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new _x(r,{eval:!1})}else if(this.source)e=new _x(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class pne{static isSupported(){return U2.isSupported()}constructor(e){K(this,"name","unnamed"),K(this,"source",void 0),K(this,"url",void 0),K(this,"maxConcurrency",1),K(this,"maxMobileConcurrency",1),K(this,"onDebug",()=>{}),K(this,"reuseWorkers",!0),K(this,"props",{}),K(this,"jobQueue",[]),K(this,"idleQueue",[]),K(this,"count",0),K(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,c,o)=>s.done(o),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,c)=>s.error(c);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new une(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new U2({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return ane?this.maxMobileConcurrency:this.maxConcurrency}}const mne={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class vl{static isSupported(){return U2.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return vl._workerFarm=vl._workerFarm||new vl({}),vl._workerFarm.setProps(e),vl._workerFarm}constructor(e){K(this,"props",void 0),K(this,"workerPools",new Map),this.props={...mne},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new pne({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}K(vl,"_workerFarm",void 0);const gne="latest";function yne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=gne);const c=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(c,"/dist/").concat(r)}return Rl(i),i}function _ne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:one;Rl(t,"no worker provided");const n=t.version;return!(!e||!n)}function vne(t,e){return!vl.isSupported()||!Q_&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function bne(t,e,n,r,i){const s=t.id,c=yne(t,n),f=vl.getWorkerFarm(n).getWorkerPool({name:s,url:c});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const m=await f.startJob("process-on-worker",xne.bind(null,i));return m.postMessage("process",{input:e,options:n,context:r}),await(await m.result).result}async function xne(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:c}=r;try{const o=await t(s,c);e.postMessage("done",{id:i,result:o})}catch(o){const f=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:f})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function wne(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function Ene(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),i=r.reduce((o,f)=>o+f.byteLength,0),s=new Uint8Array(i);let c=0;for(const o of r)s.set(o,c),c+=o.byteLength;return s.buffer}async function Tne(t){const e=[];for await(const n of t)e.push(n);return Ene(...e)}function _k(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let vk=class{constructor(e,n){K(this,"name",void 0),K(this,"type",void 0),K(this,"sampleSize",1),K(this,"time",void 0),K(this,"count",void 0),K(this,"samples",void 0),K(this,"lastTiming",void 0),K(this,"lastSampleTime",void 0),K(this,"lastSampleCount",void 0),K(this,"_count",0),K(this,"_time",0),K(this,"_samples",0),K(this,"_startTime",0),K(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=_k(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(_k()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},WL=class{constructor(e){K(this,"id",void 0),K(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof vk?this.stats[n]=e:this.stats[n]=new vk(n,r)),this.stats[n]}},Sne="";const bk={};function Ane(t){for(const e in bk)if(t.startsWith(e)){const n=bk[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(Sne).concat(t)),t}function Pne(t){return t&&typeof t=="object"&&t.isBuffer}function Dz(t){if(Pne(t))return(void 0)(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function Cne(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}const Ine=t=>typeof t=="boolean",bm=t=>typeof t=="function",wg=t=>t!==null&&typeof t=="object",xk=t=>wg(t)&&t.constructor==={}.constructor,Lne=t=>t&&typeof t[Symbol.iterator]=="function",Rne=t=>t&&typeof t[Symbol.asyncIterator]=="function",wf=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Ef=t=>typeof Blob<"u"&&t instanceof Blob,$ne=t=>t&&typeof t=="object"&&t.isBuffer,Mne=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||wg(t)&&bm(t.tee)&&bm(t.cancel)&&bm(t.getReader),kne=t=>wg(t)&&bm(t.read)&&bm(t.pipe)&&Ine(t.readable),Fz=t=>Mne(t)||kne(t),One=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Dne=/^([-\w.]+\/[-\w.+]+)/;function Fne(t){const e=Dne.exec(t);return e?e[1]:t}function wk(t){const e=One.exec(t);return e?e[1]:""}const zne=/\?.*/;function ub(t){if(wf(t)){const e=xx(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:Fne(n)||wk(e)}}return Ef(t)?{url:xx(t.name||""),type:t.type||""}:typeof t=="string"?{url:xx(t),type:wk(t)}:{url:"",type:""}}function Nne(t){return wf(t)?t.headers["content-length"]||-1:Ef(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function xx(t){return t.replace(zne,"")}async function zz(t){if(wf(t))return t;const e={},n=Nne(t);n>=0&&(e["content-length"]=String(n));const{url:r,type:i}=ub(t);i&&(e["content-type"]=i);const s=await Vne(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const c=new Response(t,{headers:e});return Object.defineProperty(c,"url",{value:r}),c}async function Bne(t){if(!t.ok){const e=await Une(t);throw new Error(e)}}async function Une(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function Vne(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var c;return r(s==null||(c=s.target)===null||c===void 0?void 0:c.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=Gne(n);return"data:base64,".concat(r)}return null}function Gne(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function Ek(t,e){if(typeof t=="string"){t=Ane(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await zz(t)}function Nz(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Dl(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||Nz()}const e0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},l_=e0.window||e0.self||e0.global,kp=e0.process||{},Bz=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Dl();const wx=globalThis;function Uz(t){if(!t&&!Dl())return"Node";if(Nz(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":wx.chrome?"Chrome":wx.safari?"Safari":wx.mozInnerScreenX?"Firefox":"Unknown"}function jne(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let Hne=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";K(this,"storage",void 0),K(this,"id",void 0),K(this,"config",void 0),this.storage=jne(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function Wne(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function Kne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Ex(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,c=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(c/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(c,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(c,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let H0;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(H0||(H0={}));function Tk(t){return typeof t=="string"?H0[t.toUpperCase()]||H0.WHITE:t}function qne(t,e,n){return!Dl&&typeof t=="string"&&(e&&(e=Tk(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=Tk(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function Xne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function W0(t,e){if(!t)throw new Error(e||"Assertion failed")}function Kd(){let t;if(Dl&&"performance"in l_){var e,n;t=l_==null||(e=l_.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in kp){var r;const i=kp==null||(r=kp.hrtime)===null||r===void 0?void 0:r.call(kp);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const qd={debug:Dl&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Zne={enabled:!0,level:0};function Oo(){}const Sk={},Ak={once:!0};let Eg=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};K(this,"id",void 0),K(this,"VERSION",Bz),K(this,"_startTs",Kd()),K(this,"_deltaTs",Kd()),K(this,"_storage",void 0),K(this,"userData",{}),K(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new Hne("__probe-".concat(this.id,"__"),Zne),this.timeStamp("".concat(this.id," started")),Xne(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Kd()-this._startTs).toPrecision(10))}getDelta(){return Number((Kd()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){W0(e,n)}warn(e){return this._getLogFunction(0,e,qd.warn,arguments,Ak)}error(e){return this._getLogFunction(0,e,qd.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,qd.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,qd.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,qd.debug||qd.info,arguments,Ak)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Oo,r&&[r],{tag:ere(n)}):Oo}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:c=1}=e;return this._shouldLog(n||r)?Dl?Qne({image:i,message:s,scale:c}):Jne():Oo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Oo)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=Pk({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Oo)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Vz(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=Pk({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,W0(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Kd();const c=s.tag||s.message;if(s.once)if(!Sk[c])Sk[c]=Kd();else return Oo;return n=Yne(this.id,s.message,s),r.bind(console,n,...s.args)}return Oo}};K(Eg,"VERSION",Bz);function Vz(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return W0(Number.isFinite(e)&&e>=0),e}function Pk(t){const{logLevel:e,message:n}=t;t.logLevel=Vz(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return W0(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function Yne(t,e,n){if(typeof e=="string"){const r=n.time?Kne(Wne(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=qne(e,n.color,n.background)}return e}function Jne(t){return console.warn("removed"),Oo}function Qne(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const c=Ex(s,n,r);console.log(...c)},s.src=e,Oo}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...Ex(e,n,r)),Oo;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Ex(s,n,r)),s.src=e.toDataURL(),Oo}return Oo}function ere(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Ck=new Eg({id:"loaders.gl"});class tre{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class nre{constructor(){K(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const Gz={fetch:null,mimeType:void 0,nothrow:!1,log:new nre,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:HL,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},rre={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function jz(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const Hz=()=>{const t=jz();return t.globalOptions=t.globalOptions||{...Gz},t.globalOptions};function ire(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],sre(t,n),are(e,t,r)}function Wz(t,e){const n=Hz(),r=t||n;return typeof r.fetch=="function"?r.fetch:wg(r.fetch)?i=>Ek(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:Ek}function sre(t,e){Ik(t,null,Gz,rre,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Ik(r,n.id,i,s,e)}}function Ik(t,e,n,r,i){const s=e||"Top level",c=e?"".concat(e,"."):"";for(const o in t){const f=!e&&wg(t[o]),m=o==="baseUri"&&!e,x=o==="workerUrl"&&e;if(!(o in n)&&!m&&!x){if(o in r)Ck.warn("".concat(s," loader option '").concat(c).concat(o,"' no longer supported, use '").concat(r[o],"'"))();else if(!f){const S=ore(o,i);Ck.warn("".concat(s," loader option '").concat(c).concat(o,"' not recognized. ").concat(S))()}}}}function ore(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const c=s.toLowerCase();(n.startsWith(c)||c.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function are(t,e,n){const i={...t.options||{}};return lre(i,n),i.log===null&&(i.log=new tre),Lk(i,Hz()),Lk(i,e),i}function Lk(t,e){for(const n in e)if(n in e){const r=e[n];xk(r)&&xk(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function lre(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function KL(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function qL(t){var e,n;j0(t,"null loader"),j0(KL(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Kz=()=>{const t=jz();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function cre(t){const e=Kz();t=Array.isArray(t)?t:[t];for(const n of t){const r=qL(n);e.find(i=>r===i)||e.unshift(r)}}function ure(){return Kz()}const dre=new Eg({id:"loaders.gl"}),hre=/\.([^.]+)$/;async function fre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!qz(t))return null;let i=Rk(t,e,{...n,nothrow:!0},r);if(i)return i;if(Ef(t)&&(t=await t.slice(0,10).arrayBuffer(),i=Rk(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(Xz(t));return i}function Rk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!qz(t))return null;if(e&&!Array.isArray(e))return qL(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...ure()),mre(i);const s=pre(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(Xz(t));return s}function pre(t,e,n,r){const{url:i,type:s}=ub(t),c=i||(r==null?void 0:r.url);let o=null,f="";if(n!=null&&n.mimeType&&(o=Tx(e,n==null?void 0:n.mimeType),f="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),o=o||gre(e,c),f=f||(o?"matched url ".concat(c):""),o=o||Tx(e,s),f=f||(o?"matched MIME type ".concat(s):""),o=o||_re(e,t),f=f||(o?"matched initial data ".concat(Zz(t)):""),o=o||Tx(e,n==null?void 0:n.fallbackMimeType),f=f||(o?"matched fallback MIME type ".concat(s):""),f){var m;dre.log(1,"selectLoader selected ".concat((m=o)===null||m===void 0?void 0:m.name,": ").concat(f,"."))}return o}function qz(t){return!(t instanceof Response&&t.status===204)}function Xz(t){const{url:e,type:n}=ub(t);let r="No valid loader found (";r+=e?"".concat(Cne(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?Zz(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function mre(t){for(const e of t)qL(e)}function gre(t,e){const n=e&&hre.exec(e),r=n&&n[1];return r?yre(t,r):null}function yre(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function Tx(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function _re(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(vre(e,n))return n}else if(ArrayBuffer.isView(e)){if($k(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&$k(e,0,n))return n;return null}function vre(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function $k(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>bre(t,e,n,i))}function bre(t,e,n,r){if(r instanceof ArrayBuffer)return wne(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=V2(t,e,r.length);return r===i;default:return!1}}function Zz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?V2(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?V2(t,0,e):""}function V2(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const xre=256*1024;function*wre(t,e){const n=(e==null?void 0:e.chunkSize)||xre;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),c=t.slice(r,r+s);r+=s,yield i.encode(c)}}const Ere=256*1024;function*Tre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{chunkSize:n=Ere}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),c=new Uint8Array(t,r,i);new Uint8Array(s).set(c),r+=i,yield s}}const Sre=1024*1024;async function*Are(t,e){const n=(e==null?void 0:e.chunkSize)||Sre;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function Mk(t,e){return HL?Pre(t,e):Cre(t)}async function*Pre(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:c}=await i;if(s)return;yield Dz(c)}}catch{n.releaseLock()}}async function*Cre(t,e){for await(const n of t)yield Dz(n)}function Ire(t,e){if(typeof t=="string")return wre(t,e);if(t instanceof ArrayBuffer)return Tre(t,e);if(Ef(t))return Are(t,e);if(Fz(t))return Mk(t,e);if(wf(t))return Mk(t.body,e);throw new Error("makeIterator")}const Yz="Cannot convert supplied data type";function Lre(t,e,n){if(e.text&&typeof t=="string")return t;if($ne(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(Yz)}async function Rre(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return Lre(t,e);if(Ef(t)&&(t=await zz(t)),wf(t)){const i=t;return await Bne(i),e.binary?await i.arrayBuffer():await i.text()}if(Fz(t)&&(t=Ire(t,n)),Lne(t)||Rne(t))return Tne(t);throw new Error(Yz)}function $re(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(n)return n;const r={fetch:Wz(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}function Mre(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function XL(t,e,n,r){Rl(!r||typeof r=="object"),e&&!Array.isArray(e)&&!KL(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:i}=ub(t),c=Mre(e,r),o=await fre(t,c,n);return o?(n=ire(n,o,c,i),r=$re({url:i,parse:XL,loaders:c},n,r),await kre(o,t,n,r)):null}async function kre(t,e,n,r){if(_ne(t),wf(e)){const i=e,{ok:s,redirected:c,status:o,statusText:f,type:m,url:x}=i,S=Object.fromEntries(i.headers.entries());r.response={headers:S,ok:s,redirected:c,status:o,statusText:f,type:m,url:x}}if(e=await Rre(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(vne(t,n))return await bne(t,e,n,r,XL);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw Rl(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function K0(t,e,n,r){!Array.isArray(e)&&!KL(e)&&(n=e,e=void 0);const i=Wz(n);let s=t;return typeof t=="string"&&(s=await i(t)),Ef(t)&&(s=await i(t)),await XL(s,e,n)}const Ore="3.3.5",{_parseImageNode:Dre}=globalThis,G2=typeof Image<"u",j2=typeof ImageBitmap<"u",Fre=!!Dre,H2=HL?!0:Fre;function zre(t){switch(t){case"auto":return j2||G2||H2;case"imagebitmap":return j2;case"image":return G2;case"data":return H2;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function Nre(){if(j2)return"imagebitmap";if(G2)return"image";if(H2)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function Bre(t){const e=Vre(t);if(!e)throw new Error("Not an image");return e}function Ure(t){switch(Bre(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function Vre(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const Gre=/^data:image\/svg\+xml/,jre=/\.svg((\?|#).*)?$/;function ZL(t){return t&&(Gre.test(t)||jre.test(t))}function Hre(t,e){if(ZL(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return Jz(t,e)}function Jz(t,e){if(ZL(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Qz(t,e,n){const r=Hre(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await Wre(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function Wre(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const Kre={};let kk=!0;async function qre(t,e,n){let r;ZL(n)?r=await Qz(t,e,n):r=Jz(t,n);const i=e&&e.imagebitmap;return await Xre(r,i)}async function Xre(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((Zre(e)||!kk)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),kk=!1}return await createImageBitmap(t)}function Zre(t){for(const e in t||Kre)return!1;return!0}const Fa=!1,xm=!0;function eN(t){const e=Tg(t);return Yre(e)||eie(e)||Jre(e)||Qre(e)}function Yre(t){const e=Tg(t);return e.byteLength>=24&&e.getUint32(0,Fa)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Fa),height:e.getUint32(20,Fa)}:null}function Jre(t){const e=Tg(t);return e.byteLength>=10&&e.getUint32(0,Fa)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,xm),height:e.getUint16(8,xm)}:null}function Qre(t){const e=Tg(t);return e.byteLength>=14&&e.getUint16(0,Fa)===16973&&e.getUint32(2,xm)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,xm),height:e.getUint32(22,xm)}:null}function eie(t){const e=Tg(t);if(!(e.byteLength>=3&&e.getUint16(0,Fa)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=tie();let s=2;for(;s+9<e.byteLength;){const c=e.getUint16(s,Fa);if(i.has(c))return{mimeType:"image/jpeg",height:e.getUint16(s+5,Fa),width:e.getUint16(s+7,Fa)};if(!r.has(c))return null;s+=2,s+=e.getUint16(s,Fa)}return null}function tie(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Tg(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function nie(t,e){const{mimeType:n}=eN(t)||{},r=globalThis._parseImageNode;return j0(r),await r(t,n)}async function rie(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},c=iie(i);let o;switch(c){case"imagebitmap":o=await qre(t,e,s);break;case"image":o=await Qz(t,e,s);break;case"data":o=await nie(t);break;default:j0(!1)}return i==="data"&&(o=Ure(o)),o}function iie(t){switch(t){case"auto":case"data":return Nre();default:return zre(t),t}}const sie=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],oie=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],aie={image:{type:"auto",decode:!0}},lie={id:"image",module:"images",name:"Images",version:Ore,mimeTypes:oie,extensions:sie,parse:rie,tests:[t=>!!eN(new DataView(t))],options:aie},Ln=new Eg({id:"deck"});let W2={};function cie(t){W2=t}function us(t,e,n,r){Ln.level>0&&W2[t]&&W2[t].call(null,e,n,r)}function uie(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const die={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:uie,parseTextSync:JSON.parse};function hie(){const t="8.9.15",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(Ln.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Ln,_registerLoggers:cie},cre([die,[lie,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const fie=hie(),qn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(qn,"IDENTITY",{get:()=>(Ln.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const za={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Yu={common:0,meters:1,pixels:2},Ok={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Yt=new Eg({id:"luma.gl"});function Ps(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const pie="Invalid WebGLRenderingContext",mie="Requires WebGL2";function db(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Mn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function gie(t){return Mn(t)?t:null}function hb(t){return Ps(db(t),pie),t}function hs(t){return Ps(Mn(t),mie),t}const em={};function yie(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function _ie(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function vie(t,e){em[t]=!0,e!==void 0&&yie(e)}function bie(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(em[r]=!0);while(r!==0);for(r in em)if(em[r])return delete em[r],parseInt(r,10);return 0}}const Sg=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Sg.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Sg.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const pd=function(e){const n=this;this.gl=e,bie(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const c=n.currentVertexArrayObject;c.maxAttrib=Math.max(c.maxAttrib,s);const o=c.attribs[s];return o.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const c=n.currentVertexArrayObject;c.maxAttrib=Math.max(c.maxAttrib,s);const o=c.attribs[s];return o.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,c){switch(s){case 34962:n.currentArrayBuffer=c;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=c;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,c){const f=n.currentVertexArrayObject.attribs[s];switch(c){case 34975:return f.buffer;case 34338:return f.enabled;case 34339:return f.size;case 34340:return f.stride;case 34341:return f.type;case 34922:return f.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,c,o,f,m,x){const S=n.currentVertexArrayObject;S.maxAttrib=Math.max(S.maxAttrib,s);const T=S.attribs[s];return T.buffer=n.currentArrayBuffer,T.size=c,T.type=o,T.normalized=f,T.stride=m,T.offset=x,T.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{_ie("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};pd.prototype.VERTEX_ARRAY_BINDING_OES=34229;pd.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Sg(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};pd.prototype.createVertexArrayOES=function(){const e=new Sg(this);return this.vertexArrayObjects.push(e),e};pd.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};pd.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Sg&&e.hasBeenBound&&e.ext===this)};pd.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){vie(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let c=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let f=0;f<=o;f++){const m=s.attribs[f],x=i?i.attribs[f]:null;if((!i||m.enabled!==x.enabled)&&(m.enabled?r.enableVertexAttribArray.call(n,f):r.disableVertexAttribArray.call(n,f)),m.enabled){let S=!1;(!i||m.buffer!==x.buffer)&&(c!==m.buffer&&(r.bindBuffer.call(n,34962,m.buffer),c=m.buffer),S=!0),(S||m.cached!==x.cached)&&r.vertexAttribPointer.call(n,f,m.size,m.type,m.normalized,m.stride,m.offset)}}this.currentArrayBuffer!==c&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function xie(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new pd(this)),this.__OESVertexArrayObject))}}const Dk="OES_element_index",Fk="WEBGL_draw_buffers",wie="EXT_disjoint_timer_query",Eie="EXT_disjoint_timer_query_webgl2",Tie="EXT_texture_filter_anisotropic",zk="WEBGL_debug_renderer_info",Sie=35723,Aie=4352,Pie=36795,Cie=34047,Iie=37445,Lie=37446,vr=t=>Mn(t)?void 0:0,Rie={[3074]:t=>Mn(t)?void 0:36064,[Sie]:t=>Mn(t)?void 0:Aie,[35977]:vr,[32937]:vr,[Pie]:(t,e)=>{const n=Mn(t)?t.getExtension(Eie):t.getExtension(wie);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[Iie]:(t,e)=>{const n=t.getExtension(zk);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[Lie]:(t,e)=>{const n=t.getExtension(zk);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[Cie]:(t,e)=>{const n=t.luma.extensions[Tie];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:vr,[35071]:vr,[37447]:vr,[36063]:(t,e)=>{if(!Mn(t)){const n=t.getExtension(Fk);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:vr,[35374]:vr,[35377]:vr,[34852]:t=>{if(!Mn(t)){const e=t.getExtension(Fk);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(Dk)?2147483647:65535,[33001]:t=>t.getExtension(Dk)?16777216:65535,[33e3]:t=>16777216,[37157]:vr,[35373]:vr,[35657]:vr,[36183]:vr,[37137]:vr,[34045]:vr,[35978]:vr,[35979]:vr,[35968]:vr,[35376]:vr,[35375]:vr,[35659]:vr,[37154]:vr,[35371]:vr,[35658]:vr,[35076]:vr,[35077]:vr,[35380]:vr};function $ie(t,e,n){const r=Rie[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const Mie="OES_vertex_array_object",tN="ANGLE_instanced_arrays",kie="WEBGL_draw_buffers",Oie="EXT_disjoint_timer_query",Die="EXT_texture_filter_anisotropic",Fie="VertexArray requires WebGL2 or OES_vertex_array_object extension";function zie(t,e){return{webgl2:Mn(t),ext:t.getExtension(e)}}const nN={[Mie]:{meta:{suffix:"OES"},createVertexArray:()=>{Ps(!1,Fie)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[tN]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Ps(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[kie]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Ps(!1)}},[Oie]:{meta:{suffix:"EXT"},createQuery:()=>{Ps(!1)},deleteQuery:()=>{Ps(!1)},beginQuery:()=>{Ps(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},Sx={readBuffer:(t,e,n)=>{Mn(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=zie(t,tN);let c;switch(r){case 35069:c=i?void 0:!1;break;case 35070:c=!i&&!s?0:void 0;break}return c!==void 0?c:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Mn(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!Mn(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[Die];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:$ie,hint(t,e,n,r){return e(n,r)}};function Nie(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(xie(t),Bie(t),Vie(t,nN),Uie(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=Nie;function Bie(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function Uie(t,e){let{target:n,target2:r}=e;Object.keys(Sx).forEach(i=>{if(typeof Sx[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},c=Sx[i].bind(null,t,s);n[i]=c,r[i]=c}})}function Vie(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&Gie(t,{extension:n,target:t.luma,target2:t})}function Gie(t,e){let{extension:n,target:r,target2:i}=e;const s=nN[n];Ps(s);const{meta:c={}}=s,{suffix:o=""}=c,f=t.getExtension(n);for(const m of Object.keys(s)){const x="".concat(m).concat(o);let S=null;m==="meta"||typeof t[m]=="function"||(f&&typeof f[x]=="function"?S=function(){return f[x](...arguments)}:typeof s[m]=="function"&&(S=s[m].bind(r))),S&&(r[m]=S,i[m]=S)}}const YL={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},lc=(t,e,n)=>e?t.enable(n):t.disable(n),Nk=(t,e,n)=>t.hint(n,e),so=(t,e,n)=>t.pixelStorei(n,e),jie=(t,e)=>{const n=Mn(t)?36009:36160;return t.bindFramebuffer(n,e)},Hie=(t,e)=>t.bindFramebuffer(36008,e);function Op(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const Wie={[3042]:lc,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:lc,[2885]:(t,e)=>t.cullFace(e),[2929]:lc,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:lc,[35723]:Nk,[36006]:jie,[2886]:(t,e)=>t.frontFace(e),[33170]:Nk,[2849]:(t,e)=>t.lineWidth(e),[32823]:lc,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:lc,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:lc,[3088]:(t,e)=>t.scissor(...e),[2960]:lc,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:so,[3317]:so,[37440]:so,[37441]:so,[37443]:so,[3330]:so,[3332]:so,[3331]:so,[36010]:Hie,[3314]:so,[32878]:so,[3316]:so,[3315]:so,[32877]:so,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Op(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Op(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Op(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Op(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,c,o]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,c,o)},stencilOp:(t,e)=>{e=Op(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,c,o]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,c,o)},viewport:(t,e)=>t.viewport(...e)};function Jr(t,e,n){return e[t]!==void 0?e[t]:n[t]}const Kie={blendEquation:(t,e,n)=>t.blendEquationSeparate(Jr(32777,e,n),Jr(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Jr(32969,e,n),Jr(32968,e,n),Jr(32971,e,n),Jr(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Jr(32824,e,n),Jr(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Jr(32938,e,n),Jr(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Jr(2962,e,n),Jr(2967,e,n),Jr(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Jr(34816,e,n),Jr(36003,e,n),Jr(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Jr(2964,e,n),Jr(2965,e,n),Jr(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Jr(34817,e,n),Jr(34818,e,n),Jr(34819,e,n))},Bk={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,i)=>t({[32773]:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,i)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:i}),clearColor:(t,e,n,r,i)=>t({[3106]:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,i)=>t({[3107]:[e,n,r,i]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,i)=>t({[3088]:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({[2978]:[e,n,r,i]})},Ia=(t,e)=>t.isEnabled(e),Uk={[3042]:Ia,[2884]:Ia,[2929]:Ia,[3024]:Ia,[32823]:Ia,[32926]:Ia,[32928]:Ia,[3089]:Ia,[2960]:Ia,[35977]:Ia};function rN(t){for(const e in t)return!1;return!0}function qie(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function Vk(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function Xie(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,c=new Array(s),o=0;o<s;o++)c[o]=arguments[o];const{valueChanged:f,oldValue:m}=n(t.state._updateCache,...c);return f&&r(...c),m},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function Zie(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}let Yie=class{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?Qie(e):Object.assign({},YL),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Ps(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];$l(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Ps(s!==void 0);const c=e[s],o=this.cache[s];qie(c,o)||(n=!0,r=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=c)}return{valueChanged:n,oldValue:r}}};function iN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Ps(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new Yie(t,{copyState:r}),Zie(t);for(const s in Bk){const c=Bk[s];Xie(t,s,c)}Vk(t,"getParameter"),Vk(t,"isEnabled")}return t.state.enable=n,t}function Jie(t){t.state||iN(t,{copyState:!1}),t.state.push()}function Gk(t){Ps(t.state),t.state.pop()}function $l(t,e){if(Ps(db(t),"setParameters requires a WebGL context"),rN(e))return;const n={};for(const i in e){const s=Number(i),c=Wie[i];c&&(typeof c=="string"?n[c]=!0:c(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=Kie[i];s(t,e,r)}}function Qie(t,e){if(e=e||YL,typeof e=="number"){const i=e,s=Uk[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=Uk[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function ese(t){$l(t,YL)}function da(t,e,n){if(rN(e))return n(t);const{nocatch:r=!0}=e;Jie(t),$l(t,e);let i;if(r)i=n(t),Gk(t);else try{i=n(t)}finally{Gk(t)}return i}function rf(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function Ax(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=rf(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return nse(e,r,i,s,n)}function tse(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function nse(t,e,n,r,i){const s=jk(t[0],e,n);let c=Hk(t[1],e,r,i),o=jk(t[0]+1,e,n);const f=o===n-1?o:o-1;o=Hk(t[1]+1,e,r,i);let m;return i?(o=o===0?o:o+1,m=c,c=o):m=o===r-1?o:o-1,{x:s,y:c,width:Math.max(f-s+1,1),height:Math.max(m-c+1,1)}}function jk(t,e,n){return Math.min(Math.round(t*e),n-1)}function Hk(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const JL=Dl(),rse=JL&&typeof document<"u",sN={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function oN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ps(JL,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},sN,t);const{width:e,height:n}=t;function r(o){if(t.throwOnError)throw new Error(o);return console.error(o),null}t.onError=r;let i;const{canvas:s}=t,c=ase({canvas:s,width:e,height:n,onError:r});return i=ose(c,t),i?(i=QL(i,t),lse(i),i):null}function QL(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||cse(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},sN,e);const{manageState:n,debug:r}=e;return n&&iN(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),c=0;c<i;c++)s[c]=arguments[c];return Yt.log(1,...s)()}}),JL&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),Yt.level=Math.max(Yt.level,1)):Yt.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function ise(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function sse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=tse(e.useDevicePixels);use(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function ose(t,e){const{onError:n}=e;let r=null;const i=f=>r=f.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:c=!0}=e;let o=null;return c&&(o=o||t.getContext("webgl2",e),o=o||t.getContext("experimental-webgl2",e)),s&&(o=o||t.getContext("webgl",e),o=o||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),o?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),o):n("Failed to create ".concat(c&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function ase(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(rse&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function lse(t){const e=Mn(t)?"WebGL2":"WebGL1",n=ise(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";Yt.info(1,"".concat(e).concat(i," context ").concat(r))()}function cse(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function use(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(Yt.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let c=e;const o=Math.floor(r*c),f=Math.floor(i*c);t.canvas.width=o,t.canvas.height=f,(t.drawingBufferWidth!==o||t.drawingBufferHeight!==f)&&(Yt.warn("Device pixel ratio clamped")(),c=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*c),t.canvas.height=Math.floor(i*c)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const wm="8.5.20",dse="set luma.log.level=1 (or higher) to trace rendering";let hse=class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new WL({id:e})),this.stats.get(e)}};const zu=new hse;if(globalThis.luma&&globalThis.luma.VERSION!==wm)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(wm));globalThis.luma||(Dl()&&Yt.log(1,"luma.gl ".concat(wm," - ").concat(dse))(),globalThis.luma=globalThis.luma||{VERSION:wm,version:wm,log:Yt,stats:zu,globals:{modules:{},nodeIO:{}}});function fse(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function pse(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Mt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Px(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return Mt(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function Oc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const Cx={};function Uc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";Cx[t]=Cx[t]||1;const e=Cx[t]++;return"".concat(t,"-").concat(e)}function Wk(t){return Mt(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function sf(t){let e=!0;for(const n in t){e=!1;break}return e}function aN(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(c=>{s.methodName||(s[c]=()=>{throw Yt.removed("Calling removed method ".concat(e,".").concat(c,": "),i)(),new Error(c)})})}const Xd="Resource subclass must define virtual methods";let Fl=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};hb(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Uc(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=Px(this.gl,e),Mt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=Mn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,f="webgl2"in i?i.webgl2:i.webgl1;return s?f:o}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=Mn(this.gl),c={},o=n||Object.keys(i);for(const f of o){const m=i[f];if(m&&(!("webgl2"in m)||s)&&(!("extension"in m)||this.gl.getExtension(m.extension))){const S=r?Oc(this.gl,f):f;c[S]=this.getParameter(f,e),r&&m.type==="GLenum"&&(c[S]=Oc(this.gl,c[S]))}}return c}setParameter(e,n){e=Px(this.gl,e),Mt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=Mn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=Px(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return aN(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Xd)}_deleteHandle(){throw new Error(Xd)}_bindHandle(e){throw new Error(Xd)}_getOptsFromHandle(){throw new Error(Xd)}_getParameter(e,n){throw new Error(Xd)}_setParameter(e,n){throw new Error(Xd)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=zu.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];zu.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=zu.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=zu.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const mse="Failed to deduce GL constant from typed array";function K2(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(mse)}}function Wm(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function gse(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const c=n*i;s=s||new Uint8Array(c);for(let o=0;o<r/2;++o){const f=o*c,m=(r-o-1)*c;s.set(e.subarray(f,f+c)),e.copyWithin(f,m,m+c),e.set(s,m)}}function yse(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),c=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let f=0;f<i;f++)for(let m=0;m<4;m++)c[(o*i+f)*4+m]=e[(o*2*n+f*2)*4+m];return{data:c,width:i,height:s}}function q2(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const o in r)if(o in e){const m=r[o]?"".concat(t,".").concat(r[o]):"N/A";Yt.removed("".concat(t,".").concat(o),m)()}for(const o in i)if(o in e){const f=i[o];Yt.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(f))()}let c=null;for(const o in s)if(o in e){const f=s[o];Yt.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(f))(),c=c||Object.assign({},e),c[f]=e[o],delete c[o]}return c||e}const _se={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},vse={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};let _l=class t0{static getBytesPerElement(e){return Wm(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Mt(e.size),Wm(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new t0(_se,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return t0.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return t0.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=q2("Accessor",e,vse),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}};const Kk=10,lN={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},bse={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:lN},xse={removedProps:lN};let cr=class extends Fl{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/_l.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/_l.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=q2("Buffer",e,bse),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=q2("Buffer",e,xse),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new _l(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;Mt(n);const c=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(c,this.handle),i!==0||s!==void 0?(hs(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(c,r,n),this.gl.bindBuffer(c,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:c}=this;return hs(c),c.bindBuffer(36662,n.handle),c.bindBuffer(36663,this.handle),c.copyBufferSubData(36662,36663,r,i,s),c.bindBuffer(36662,null),c.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};hs(this.gl);const s=Wm(this.accessor.type||5126,{clamped:!1}),c=this._getAvailableElementCount(n),o=r;let f,m;e?(m=e.length,f=m-o):(f=Math.min(c,i||c),m=o+f);const x=Math.min(c,f);return i=i||x,Mt(i<=x),e=e||new s(m),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(Mt(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(Kk,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Mt(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,Kk),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=K2(e);return Mt(s),this.setAccessor(new _l(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Mt(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Wm(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new _l(this.accessor,{type:K2(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return Yt.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Yt.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Yt.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Yt.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new _l(this.accessor,e),this}};const eR={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},cN={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},uN={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function wse(t,e){const n=eR[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=Mn(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function Ese(t,e){const n=eR[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const Tse=[9729,9728],qk=globalThis.WebGLBuffer||function(){};let Ju=class extends Fl{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&wse(e,r),s=s&&(!i||Ese(e,r))),s}constructor(e,n){const{id:r=Uc("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(k=>this.initialize(Object.assign({},e,{pixels:k,data:k}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:c=0,recreate:o=!1,parameters:f={},pixelStore:m={},textureUnit:x=void 0}=e;n||(n=i);let{width:S,height:T,dataFormat:C,type:R,compressed:D=!1,mipmaps:H=!0}=e;const{depth:F=0}=e;return{width:S,height:T,compressed:D,dataFormat:C,type:R}=this._deduceParameters({format:s,type:R,dataFormat:C,compressed:D,data:n,width:S,height:T}),this.width=S,this.height=T,this.depth=F,this.format=s,this.type=R,this.dataFormat=C,this.border=c,this.textureUnit=x,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),H&&this._isNPOT()&&(Yt.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),H=!1,this._updateForNPOT(f)),this.mipmaps=H,this.setImageData({data:n,width:S,height:T,depth:F,format:s,type:R,dataFormat:C,border:c,mipmaps:H,parameters:m,compressed:D}),H&&this.generateMipmap(),this.setParameters(f),o&&(this.data=n),r&&(this._video={video:n,parameters:f,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(Yt.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),da(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:c=this.border,offset:o=0,parameters:f={}}=e;let{data:m=null,type:x=this.type,width:S=this.width,height:T=this.height,dataFormat:C=this.dataFormat,compressed:R=!1}=e;m||(m=r),{type:x,dataFormat:C,compressed:R,width:S,height:T}=this._deduceParameters({format:s,type:x,dataFormat:C,compressed:R,data:m,width:S,height:T});const{gl:D}=this;D.bindTexture(this.target,this.handle);let H=null;({data:m,dataType:H}=this._getDataType({data:m,compressed:R}));let F,k=0;if(da(this.gl,f,()=>{switch(H){case"null":D.texImage2D(n,i,s,S,T,c,C,x,m);break;case"typed-array":D.texImage2D(n,i,s,S,T,c,C,x,m,o);break;case"buffer":F=hs(D),F.bindBuffer(35052,m.handle||m),F.texImage2D(n,i,s,S,T,c,C,x,o),F.bindBuffer(35052,null);break;case"browser-object":Mn(D)?D.texImage2D(n,i,s,S,T,c,C,x,m):D.texImage2D(n,i,s,C,x,m);break;case"compressed":for(const[N,U]of m.entries())D.compressedTexImage2D(n,N,U.format,U.width,U.height,c,U.data),k+=U.levelSize;break;default:Mt(!1,"Unknown image data type")}}),H==="compressed")this._trackAllocatedMemory(k,"Texture");else if(m&&m.byteLength)this._trackAllocatedMemory(m.byteLength,"Texture");else{const N=cN[this.dataFormat]||4,U=uN[this.type]||1;this._trackAllocatedMemory(this.width*this.height*N*U,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:c=0,width:o=this.width,height:f=this.height,level:m=0,format:x=this.format,type:S=this.type,dataFormat:T=this.dataFormat,compressed:C=!1,offset:R=0,border:D=this.border,parameters:H={}}=e;if({type:S,dataFormat:T,compressed:C,width:o,height:f}=this._deduceParameters({format:x,type:S,dataFormat:T,compressed:C,data:i,width:o,height:f}),Mt(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const F=i;i=F.data,o=F.shape[0],f=F.shape[1]}i instanceof cr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),da(this.gl,H,()=>{if(C)this.gl.compressedTexSubImage2D(n,m,s,c,o,f,x,i);else if(i===null)this.gl.texSubImage2D(n,m,s,c,o,f,T,S,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,m,s,c,o,f,T,S,i,R);else if(i instanceof qk){const F=hs(this.gl);F.bindBuffer(35052,i),F.texSubImage2D(n,m,s,c,o,f,T,S,R),F.bindBuffer(35052,null)}else Mn(this.gl)?hs(this.gl).texSubImage2D(n,m,s,c,o,f,T,S,i):this.gl.texSubImage2D(n,m,s,c,T,S,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return Yt.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof cr?{data:n.handle,dataType:"buffer"}:n instanceof qk?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:c,type:o,compressed:f}=e;const m=eR[n];return c=c||m&&m.dataFormat,o=o||m&&m.types[0],f=f||m&&m.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:c,type:o,compressed:f,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},Mt(i,"Could not deduced texture size"),Mt(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),Mt(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Mt(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Mn(this.gl)||!this.width||!this.height?!1:!Wk(this.width)||!Wk(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:Tse.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}},Sse="";function Ase(t,e){return Mt(typeof t=="string"),t=Sse+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}let xo=class extends Ju{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Ju.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};hb(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:Ase(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}};const X2=[34069,34070,34071,34072,34073,34074];class dN extends Ju{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};hb(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:c=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:c})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:c=0,format:o=6408,type:f=5121}=e;const{gl:m}=this,x=i||s,S=await Promise.all(X2.map(T=>{const C=x[T];return Promise.all(Array.isArray(C)?C:[C])}));this.bind(),X2.forEach((T,C)=>{S[C].length>1&&this.opts.mipmaps!==!1&&Yt.warn("".concat(this.id," has mipmap and multiple LODs."))(),S[C].forEach((R,D)=>{n&&r?m.texImage2D(T,D,o,n,r,c,o,f,R):m.texImage2D(T,D,o,o,f,R)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:c,border:o=0,format:f=6408,type:m=5121}=e,{gl:x}=this,S=s||c;return this.bind(),S instanceof Promise?S.then(T=>this.setImageDataForFace(Object.assign({},e,{face:n,data:T,pixels:T}))):this.width||this.height?x.texImage2D(n,0,f,r,i,o,f,m,S):x.texImage2D(n,0,f,f,m,S),this}}dN.FACES=X2;class Pse extends Ju{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Mn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};hs(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:c=1,border:o=0,format:f,type:m=5121,offset:x=0,data:S,parameters:T={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),da(this.gl,T,()=>{ArrayBuffer.isView(S)&&this.gl.texImage3D(this.target,n,r,i,s,c,o,f,m,S),S instanceof cr&&(this.gl.bindBuffer(35052,S.handle),this.gl.texImage3D(this.target,n,r,i,s,c,o,f,m,x))}),S&&S.byteLength)this._trackAllocatedMemory(S.byteLength,"Texture");else{const C=cN[this.dataFormat]||4,R=uN[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*C*R,"Texture")}return this.loaded=!0,this}}const Eu="EXT_color_buffer_float",Xk={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:Eu,bpp:2},[33327]:{gl2:Eu,bpp:4},[34842]:{gl2:Eu,bpp:8},[33326]:{gl2:Eu,bpp:4},[33328]:{gl2:Eu,bpp:8},[34836]:{gl2:Eu,bpp:16},[35898]:{gl2:Eu,bpp:4}};function Cse(t,e,n){const r=n[e];if(!r)return!1;const i=Mn(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}let Ph=class extends Fl{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||Cse(e,n,Xk)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return Mt(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&Mn(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Xk[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}};const Ise=256,Lse=1024,Rse=16384,Zk=6144,Yk=6145,Jk=6146,Qk=34041,hN="clear: bad arguments";function tR(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let c=0;n&&(c|=Rse,n!==!0&&(s.clearColor=n)),r&&(c|=Ise,r!==!0&&(s.clearDepth=r)),i&&(c|=Lse,r!==!0&&(s.clearStencil=r)),Mt(c!==0,hN),da(t,s,()=>{t.clear(c)})}function $se(t){let{framebuffer:e=null,buffer:n=Zk,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};hs(t),da(t,{framebuffer:e},()=>{switch(n){case Zk:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case Yk:t.clearBufferfv(Yk,0,[i]);break;case Jk:t.clearBufferiv(Jk,0,[i]);break;case Qk:const[s,c]=i;t.clearBufferfi(Qk,0,s,c);break;default:Mt(!1,hN)}})}function Mse(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Mt(!1),0}}function fb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:c=null,sourceWidth:o,sourceHeight:f,sourceType:m}=e;const{framebuffer:x,deleteFramebuffer:S}=fN(t);Mt(x);const{gl:T,handle:C,attachments:R}=x;o=o||x.width,f=f||x.height,s===36064&&C===null&&(s=1028),Mt(R[s]),m=m||R[s].type,c=Ose(c,m,i,o,f),m=m||K2(c);const D=T.bindFramebuffer(36160,C);return T.readPixels(n,r,o,f,i,m,c),T.bindFramebuffer(36160,D||null),S&&x.delete(),c}function e6(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=fb(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=yse({data:r,width:i,height:s}));gse({data:r,width:i,height:s});const c=document.createElement("canvas");c.width=i,c.height=s;const o=c.getContext("2d"),f=o.createImageData(i,s);return f.data.set(r),o.putImageData(f,0,0),c.toDataURL()}function kse(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:c=6408}=n;let{targetX:o,targetY:f,targetZ:m,width:x,height:S}=n;const{framebuffer:T,deleteFramebuffer:C}=fN(t);Mt(T);const{gl:R,handle:D}=T,H=typeof o<"u"||typeof f<"u"||typeof m<"u";o=o||0,f=f||0,m=m||0;const F=R.bindFramebuffer(36160,D);Mt(e);let k=null;if(e instanceof Ju&&(k=e,x=Number.isFinite(x)?x:k.width,S=Number.isFinite(S)?S:k.height,k.bind(0),e=k.target),!H)R.copyTexImage2D(e,s,c,r,i,x,S,0);else switch(e){case 3553:case 34067:R.copyTexSubImage2D(e,s,o,f,r,i,x,S);break;case 35866:case 32879:hs(R).copyTexSubImage3D(e,s,o,f,m,r,i,x,S);break}return k&&k.unbind(),R.bindFramebuffer(36160,F||null),C&&T.delete(),k}function fN(t){return t instanceof Yi?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:Hse(t),deleteFramebuffer:!0}}function Ose(t,e,n,r,i){if(t)return t;e=e||5121;const s=Wm(e,{clamped:!1}),c=Mse(n);return new s(r*i*c)}const Pr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function Dse(t){const e=new xo(t,{format:6408,type:5126,dataFormat:6408}),n=new Yi(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const pN={[Pr.WEBGL2]:[!1,!0],[Pr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Pr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Pr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Pr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Pr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Pr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Pr.FLOAT_BLEND]:["EXT_float_blend"],[Pr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Pr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Pr.TEXTURE_FLOAT]:["OES_texture_float",!0],[Pr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Pr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Pr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Pr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Pr.COLOR_ATTACHMENT_RGBA32F]:[Dse,"EXT_color_buffer_float"],[Pr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Pr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Pr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Pr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Pr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Pr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},Fse=2;function zse(t,e){return nR(t,e)}function nR(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>mN(t,n))}function Nse(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in pN)t.luma.caps[e]===void 0&&(t.luma.caps[e]=mN(t,e));return t.luma.caps}function mN(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=Bse(t,e)),t.luma.caps[e]||Yt.log(Fse,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function Bse(t,e){const n=pN[e];Mt(n,e);let r;const i=Mn(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:Mt(!1);return r}const t6="Multiple render targets not supported";let Yi=class gN extends Fl{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new gN(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=hs(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=hs(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:c=!0,stencil:o=!1,check:f=!0,readBuffer:m=void 0,drawBuffers:x=void 0}=e;if(Mt(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const S in i){const T=i[S];(Array.isArray(T)?T[0]:T).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,c,o,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:m,drawBuffers:x}),i&&f&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:c=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:c});const{gl:o}=this,f=o.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,f||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return Mt(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&Yt.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(c=>{i[c]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const c in i){Mt(c!==void 0,"Misspelled framebuffer binding point?");const o=Number(c),f=i[o];let m=f;if(!m)this._unattach(o);else if(m instanceof Ph)this._attachRenderbuffer({attachment:o,renderbuffer:m});else if(Array.isArray(f)){const[x,S=0,T=0]=f;m=x,this._attachTexture({attachment:o,texture:x,layer:S,level:T})}else this._attachTexture({attachment:o,texture:m,layer:0,level:0});r&&m&&m.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(c=>!this.attachments[c]).forEach(c=>{delete this.attachments[c]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(Vse(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,c=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&tR(this.gl,{color:n,depth:r,stencil:i}),s.forEach((o,f)=>{$se(this.gl,{drawBuffer:f,value:o})}),this.gl.bindFramebuffer(36160,c||null),this}readPixels(){return Yt.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return Yt.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return Yt.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return Yt.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return Yt.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return Yt.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:c}=e;const o=hs(this.gl),f=o.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&c===void 0?o.invalidateFramebuffer(36008,n):o.invalidateFramebuffer(36008,n,r,i,s,c),o.bindFramebuffer(36008,f),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=Oc(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const c=n?Oc(this.gl,s):s;i[c]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),c=e?Oc(this.gl,s):s;r[c]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(e6(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>Yt.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=e6(this,{targetMaxHeight:100});return Yt.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let c=null;return e&&(c=c||{},c[36064]=new xo(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(c[36064])),n&&r?(c=c||{},c[33306]=new Ph(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(c[33306])):n?(c=c||{},c[36096]=new Ph(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(c[36096])):r&&Mt(!1),c}_unattach(e){const n=this.attachments[e];n&&(n instanceof Ph?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:c}=this;switch(c.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:hs(c).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const f=Use(i);c.framebufferTexture2D(36160,n,f,r.handle,s);break;case 3553:c.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:Mt(!1,"Illegal texture type")}c.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=gie(this.gl);n?n.readBuffer(e):Mt(e===36064||e===1029,t6),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=hs(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):Mt(e.length===1&&(e[0]===36064||e[0]===1029),t6)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=Nse(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}};function Use(t){return t<34069?t+34069:t}function Vse(t){return(Yi.STATUS||{})[t]||"Framebuffer error ".concat(t)}const Gse=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Yi.ATTACHMENT_PARAMETERS=Gse;function jse(t,e){Mt(t instanceof xo||t instanceof dN||t instanceof Pse);const n=t.constructor,{gl:r,width:i,height:s,format:c,type:o,dataFormat:f,border:m,mipmaps:x}=t,S=Object.assign({width:i,height:s,format:c,type:o,dataFormat:f,border:m,mipmaps:x},e);return new n(r,S)}function Hse(t,e){const{gl:n,width:r,height:i,id:s}=t;return new Yi(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{[36064]:t}}))}function n0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const Wse=35632,Kse=35633;function qse(t){switch(t){case Wse:return"fragment";case Kse:return"vertex";default:return"unknown type"}}function Xse(t,e,n,r){const i=t.split(/\r?\n/),s={},c={},o=r||n0(e)||"(unnamed)",f="".concat(qse(n)," shader ").concat(o);for(let x=0;x<i.length;x++){const S=i[x];if(S.length<=1)continue;const T=S.split(":"),C=T[0],R=parseInt(T[2],10);if(isNaN(R))throw new Error("GLSL compilation error in ".concat(f,": ").concat(t));C!=="WARNING"?s[R]=S:c[R]=S}const m=Zse(e);return{shaderName:f,errors:n6(s,m),warnings:n6(c,m)}}function n6(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],c=s.split(":",3),o=c[0],f=parseInt(c[1],10)||0,m=s.substring(c.join(":").length+1).trim();n+=yN("^^^ ".concat(o,": ").concat(m,`

`),f)}}return n}function Zse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,c)=>{const o=String(c+e),f=o.length;return yN(o,i-f)+n+s})}function yN(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function _N(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const Yse="Shader: GLSL source code must be a JavaScript string";let vN=class Z2 extends Fl{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Mt(!1),"unknown"}}constructor(e,n){hb(e),Mt(typeof n.source=="string",Yse);const r=n0(n.source,null)||n.id||Uc("unnamed ".concat(Z2.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=n0(n,null);r&&(this.id=Uc(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Z2.getTypeName(this.shaderType),":").concat(this.id)}getName(){return n0(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:c}=Xse(r,this.source,this.shaderType,this.id);throw Yt.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),Yt.warn("GLSL compilation warnings in ".concat(i,`
`).concat(c))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}},Ix=class extends vN{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}},Lx=class extends vN{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}};const Jse={[5126]:Tr.bind(null,"uniform1fv",oo,1,ls),[35664]:Tr.bind(null,"uniform2fv",oo,2,ls),[35665]:Tr.bind(null,"uniform3fv",oo,3,ls),[35666]:Tr.bind(null,"uniform4fv",oo,4,ls),[5124]:Tr.bind(null,"uniform1iv",cc,1,ls),[35667]:Tr.bind(null,"uniform2iv",cc,2,ls),[35668]:Tr.bind(null,"uniform3iv",cc,3,ls),[35669]:Tr.bind(null,"uniform4iv",cc,4,ls),[35670]:Tr.bind(null,"uniform1iv",cc,1,ls),[35671]:Tr.bind(null,"uniform2iv",cc,2,ls),[35672]:Tr.bind(null,"uniform3iv",cc,3,ls),[35673]:Tr.bind(null,"uniform4iv",cc,4,ls),[35674]:Tr.bind(null,"uniformMatrix2fv",oo,4,ll),[35675]:Tr.bind(null,"uniformMatrix3fv",oo,9,ll),[35676]:Tr.bind(null,"uniformMatrix4fv",oo,16,ll),[35678]:Ki,[35680]:Ki,[5125]:Tr.bind(null,"uniform1uiv",c_,1,ls),[36294]:Tr.bind(null,"uniform2uiv",c_,2,ls),[36295]:Tr.bind(null,"uniform3uiv",c_,3,ls),[36296]:Tr.bind(null,"uniform4uiv",c_,4,ls),[35685]:Tr.bind(null,"uniformMatrix2x3fv",oo,6,ll),[35686]:Tr.bind(null,"uniformMatrix2x4fv",oo,8,ll),[35687]:Tr.bind(null,"uniformMatrix3x2fv",oo,6,ll),[35688]:Tr.bind(null,"uniformMatrix3x4fv",oo,12,ll),[35689]:Tr.bind(null,"uniformMatrix4x2fv",oo,8,ll),[35690]:Tr.bind(null,"uniformMatrix4x3fv",oo,12,ll),[35678]:Ki,[35680]:Ki,[35679]:Ki,[35682]:Ki,[36289]:Ki,[36292]:Ki,[36293]:Ki,[36298]:Ki,[36299]:Ki,[36300]:Ki,[36303]:Ki,[36306]:Ki,[36307]:Ki,[36308]:Ki,[36311]:Ki},Qse={},eoe={},toe={},r6=[0];function rR(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(r6[0]=t,t=r6);const i=t.length;if(i%e&&Yt.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let c=0;c<i;c++)s[c]=t[c];return s}function oo(t,e){return rR(t,e,Float32Array,Qse)}function cc(t,e){return rR(t,e,Int32Array,eoe)}function c_(t,e){return rR(t,e,Uint32Array,toe)}function i6(t,e,n){const r=Jse[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function noe(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function roe(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!ioe(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function ioe(t){return Array.isArray(t)||ArrayBuffer.isView(t)?ooe(t):isFinite(t)||t===!0||t===!1||t instanceof Ju||t instanceof Ph?!0:t instanceof Yi?!!t.texture:!1}function soe(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function ooe(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ki(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Tr(t,e,n,r){let i=null,s=null;return(c,o,f)=>{const m=e(f,n),x=m.length;let S=!1;if(i===null)i=new Float32Array(x),s=x,S=!0;else{Mt(s===x,"Uniform length cannot change.");for(let T=0;T<x;++T)if(m[T]!==i[T]){S=!0;break}}return S&&(r(c,t,o,m),i.set(m)),S}}function ls(t,e,n,r){t[e](n,r)}function ll(t,e,n,r){t[e](n,!1,r)}const aoe=5120,loe=5121,coe=5122,uoe=5123,s6=0,u_=1,doe=2,hoe=3,d_=4,foe=5,poe=6,Si=5126,moe=35664,goe=35665,yoe=35666,Dp=5124,_oe=35667,voe=35668,boe=35669,Fp=5125,xoe=36294,woe=36295,Eoe=36296,Toe=35670,Soe=35671,Aoe=35672,Poe=35673,Coe=35674,Ioe=35675,Loe=35676,Roe=35685,$oe=35686,Moe=35687,koe=35688,Ooe=35689,Doe=35690,Y2={[Si]:[Si,1,"float"],[moe]:[Si,2,"vec2"],[goe]:[Si,3,"vec3"],[yoe]:[Si,4,"vec4"],[Dp]:[Dp,1,"int"],[_oe]:[Dp,2,"ivec2"],[voe]:[Dp,3,"ivec3"],[boe]:[Dp,4,"ivec4"],[Fp]:[Fp,1,"uint"],[xoe]:[Fp,2,"uvec2"],[woe]:[Fp,3,"uvec3"],[Eoe]:[Fp,4,"uvec4"],[Toe]:[Si,1,"bool"],[Soe]:[Si,2,"bvec2"],[Aoe]:[Si,3,"bvec3"],[Poe]:[Si,4,"bvec4"],[Coe]:[Si,8,"mat2"],[Roe]:[Si,8,"mat2x3"],[$oe]:[Si,8,"mat2x4"],[Ioe]:[Si,12,"mat3"],[Moe]:[Si,12,"mat3x2"],[koe]:[Si,12,"mat3x4"],[Loe]:[Si,16,"mat4"],[Ooe]:[Si,16,"mat4x2"],[Doe]:[Si,16,"mat4x3"]};function Foe(t){switch(t){case s6:return s6;case u_:return u_;case hoe:return u_;case doe:return u_;case d_:return d_;case foe:return d_;case poe:return d_;default:return Mt(!1),0}}function o6(t){const e=Y2[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function bN(t,e){switch(t){case aoe:case loe:case coe:case uoe:t=Si;break}for(const n in Y2){const[r,i,s]=Y2[n];if(r===t&&i===e)return{glType:n,name:s}}return null}let zoe=class{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:c,size:o}=n.getActiveAttrib(e.handle,i),f=n.getAttribLocation(e.handle,s);f>=0&&this._addAttribute(f,s,c,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Mn(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:c,size:o}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,c,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:c}=o6(r),o={type:s,size:i*c};this._inferProperties(e,n,o);const f={location:e,name:n,accessor:new _l(o)};this.attributeInfos.push(f),this.attributeInfosByLocation[e]=f,this.attributeInfosByName[f.name]=f}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:c}=o6(r),o=new _l({type:s,size:i*c}),f={location:e,name:n,accessor:o};this.varyingInfos.push(f),this.varyingInfosByName[f.name]=f}};const a6=4,Noe=35981,Boe=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];let xN=class extends Fl{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",Boe),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:c=Noe}=e;return this.hash=n||"",this.vs=typeof r=="string"?new Ix(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new Lx(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,Mt(this.vs instanceof Ix),Mt(this.fs instanceof Lx),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(hs(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,c)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new zoe(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:c,end:o,isIndexed:f=!1,indexType:m=5123,instanceCount:x=0,isInstanced:S=x>0,vertexArray:T=null,transformFeedback:C,framebuffer:R,parameters:D={},uniforms:H,samplers:F}=e;if((H||F)&&(Yt.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(H||{})),Yt.priority>=n){const k=R?R.id:"default",N="mode=".concat(Oc(this.gl,r)," verts=").concat(i," ")+"instances=".concat(x," indexType=").concat(Oc(this.gl,m)," ")+"isInstanced=".concat(S," isIndexed=").concat(f," ")+"Framebuffer=".concat(k);Yt.log(n,N)()}return Mt(T),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||S&&x===0?!1:(T.bindForDraw(i,x,()=>{if(R!==void 0&&(D=Object.assign({},D,{framebuffer:R})),C){const k=Foe(r);C.begin(k)}this._bindTextures(),da(this.gl,D,()=>{f&&S?this.gl2.drawElementsInstanced(r,i,m,s,x):f&&Mn(this.gl)&&!isNaN(c)&&!isNaN(o)?this.gl2.drawRangeElements(r,c,o,i,m,s):f?this.gl.drawElements(r,i,m,s):S?this.gl2.drawArraysInstanced(r,s,i,x):this.gl.drawArrays(r,s,i)}),C&&C.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Yt.priority>=2&&roe(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,c=!1;if(s instanceof Yi&&(s=s.texture),s instanceof Ju)if(c=this.uniforms[n]!==r,c){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:f}=i;o.bind(f),s=f,this._textureUniforms[n]=o}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||c)&&soe(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new Ix({handle:i});break;case 35632:r.fs=new Lx({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Uc(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Yt.time(a6,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),Yt.timeEnd(a6,"linkProgram for ".concat(this._getName()))(),e.debug||Yt.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=noe(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=i6(e,s,r),r.size>1)for(let c=0;c<r.size;c++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(c,"]")),this._uniformSetters["".concat(i,"[").concat(c,"]")]=i6(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}};const Uoe=34918,Voe=34919,Goe=35007,joe=36795,Hoe=35976,Woe=35887,Koe=36202;class q0 extends Fl{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=Mn(e),i=nR(e,Pr.TIMER_QUERY);let s=r||i;for(const c of n)switch(c){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:Mt(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(Goe)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?Koe:Woe)}beginTransformFeedbackQuery(){return this.begin(Hoe)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,Voe);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(joe)}getResult(){return this.gl2.getQueryParameter(this.handle,Uoe)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return q0.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}let wN=class extends Fl{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Mn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};hs(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,sf(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:c}=this._getBufferParams(n);return r<0?(this.unused[e]=i,Yt.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,c,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof cr?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}},h_=null;function qoe(t){return(!h_||h_.byteLength<t)&&(h_=new ArrayBuffer(t)),h_}function Xoe(t,e){const n=qoe(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function Zoe(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,c=i*s;let o=0;for(let f=r;o<s;o++)e[f++]=n[o];for(;o<c;)o<c-o?(e.copyWithin(r+o,r,r+o),o*=2):(e.copyWithin(r+o,r,r+c-o),o=c);return e}const Yoe="elements must be GL.ELEMENT_ARRAY_BUFFER";let Rx=class Ma extends Fl{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Mn(e)||Uz()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Ma(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Ma.MAX_ATTRIBUTES=Ma.MAX_ATTRIBUTES||e.getParameter(34921),Ma.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Ma._setConstantFloatArray(e,n,r);break;case Int32Array:Ma._setConstantIntArray(e,n,r);break;case Uint32Array:Ma._setConstantUintArray(e,n,r);break;default:Mt(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Ma.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Mt(!e||e.target===34963,Yoe),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:c,offset:o,normalized:f,integer:m,divisor:x}=r,{gl:S,gl2:T}=this;return e=Number(e),this.bind(()=>{S.bindBuffer(34962,n.handle),m?(Mt(Mn(S)),T.vertexAttribIPointer(e,i,s,c,o)):S.vertexAttribPointer(e,i,s,f,c,o),S.enableVertexAttribArray(e),T.vertexAttribDivisor(e,x||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Ma.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let c=!this.buffer;if(this.buffer=this.buffer||new cr(this.gl,i),c=c||this.buffer.reallocate(i),c=c||!this._compareConstantArrayValues(r,this.bufferValue),c){const o=Xoe(n.constructor,s);Zoe({target:o,source:r,start:0,count:s}),this.buffer.subData(o),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:Mt(!1)}}static _setConstantIntArray(e,n,r){switch(Mt(Mn(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:Mt(!1)}}static _setConstantUintArray(e,n,r){switch(Mt(Mn(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:Mt(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return Mt(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}};const Joe="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Qoe=/^(.+)__LOCATION_([0-9]+)$/,eae=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];let tae=class{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Rx(e),aN(this,"VertexArray","v6.0",eae),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new cr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof cr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof cr&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:c,name:o}=this._getAttributeIndex(e);if(!Number.isFinite(c)||c<0)return this.unused[e]=n,Yt.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const f=this._getAttributeInfo(o||c);if(!f)return s;const m=this.accessors[c]||{},x=_l.resolve(f.accessor,m,r,i),{size:S,type:T}=x;return Mt(Number.isFinite(S)&&Number.isFinite(T)),{location:c,accessor:x}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=Qoe.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof cr)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof cr){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof cr){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(Joe)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(Rx.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){Rx.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,c=s>0;if(e.isInstanced=e.isInstanced||c,r instanceof cr){const o=r;if(c){const f=o.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,f)}else{const f=o.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,f)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Yt.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}};function nae(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let c=0;c<t.length&&c<n;++c)c>0&&(i+=",".concat(c%r===0?" ":"")),i+=Km(t[c],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function Km(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return nae(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function l6(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;Mt(n);const s=".*_.*",c=".*Matrix",o=n._uniformSetters,f={},m=Object.keys(o).sort();let x=0;for(const C of m)!C.match(s)&&!C.match(c)&&$x({table:f,header:e,uniforms:r,uniformName:C,undefinedOnly:i})&&x++;for(const C of m)C.match(c)&&$x({table:f,header:e,uniforms:r,uniformName:C,undefinedOnly:i})&&x++;for(const C of m)f[C]||$x({table:f,header:e,uniforms:r,uniformName:C,undefinedOnly:i})&&x++;let S=0;const T={};if(!i)for(const C in r){const R=r[C];f[C]||(S++,T[C]={Type:"NOT USED: ".concat(R),[e]:Km(R)})}return{table:f,count:x,unusedTable:T,unusedCount:S}}function $x(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const c=r[i],o=rae(c);return!s||!o?(e[i]={[n]:o?Km(c):"N/A","Uniform Type":o?c:"NOT PROVIDED"},!0):!1}function rae(t){return t!=null}function iae(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=c6(e,e.elements,null,n));const i=e.values;for(const s in i){const c=e._getAttributeInfo(s);if(c){let o="".concat(s,": ").concat(c.name);const f=e.accessors[c.location];f&&(o="".concat(s,": ").concat(sae(c.name,f))),r[o]=c6(e,i[s],f,n)}}return r}function c6(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",c=1,o=0,f=0,m,x,S;if(n&&(s=n.type,c=n.size,s=String(s).replace("Array",""),m=s.indexOf("nt")!==-1),e instanceof cr){const T=e,{data:C,changed:R}=T.getDebugData();x=R?"*":"",S=C,f=T.byteLength,o=f/C.BYTES_PER_ELEMENT/c;let D;if(n){const H=n.divisor>0;D="".concat(H?"I ":"P "," ").concat(o," (x").concat(c,"=").concat(f," bytes ").concat(Oc(i,s),")")}else m=!0,D="".concat(f," bytes");return{[r]:"".concat(x).concat(Km(S,{size:c,isInteger:m})),"Format ":D}}return S=e,c=e.length,s=String(e.constructor.name).replace("Array",""),m=s.indexOf("nt")!==-1,{[r]:"".concat(Km(S,{size:c,isInteger:m})," (constant)"),"Format ":"".concat(c,"x").concat(s," (constant)")}}function sae(t,e){const{type:n,size:r}=e,i=bN(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function oae(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=u6(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=u6(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function u6(t){const{type:e,size:n}=t.accessor,r=bN(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const d6=Dl()&&typeof document<"u";let aae=0;class lae{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=H=>oN(H),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:c=()=>{},onError:o,gl:f=null,glOptions:m={},debug:x=!1,createFramebuffer:S=!1,autoResizeViewport:T=!0,autoResizeDrawingBuffer:C=!0,stats:R=zu.get("animation-loop-".concat(aae++))}=e;let{useDevicePixels:D=!0}=e;"useDevicePixelRatio"in e&&(Yt.deprecated("useDevicePixelRatio","useDevicePixels")(),D=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:c,onError:o,gl:f,glOptions:m,debug:x,createFramebuffer:S},this.gl=f,this.needsRedraw=null,this.timeline=null,this.stats=R,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:T,autoResizeDrawingBuffer:C,useDevicePixels:D}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Mt(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=q0.isSupported(this.gl,["timers"])?new q0(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return Yt.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=d6?new Promise((e,n)=>{if(d6&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):pse(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):fse(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?QL(this.props.gl,e):this.onCreateContext(e),!db(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");ese(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&sse(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Yi(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Ag="vs",iR="fs";function vo(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const Mx={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function cae(t){const e={};for(const n in t){const r=t[n],i=uae(r);e[n]=i}return e}function uae(t){let e=h6(t);return e==="object"?t?"type"in t?Object.assign({},t,Mx[t.type]):"value"in t?(e=h6(t.value),Object.assign({type:e},t,Mx[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},Mx[e])}function h6(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const dae="vs",hae="fs";let f6=class{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:c,getUniforms:o,deprecations:f=[],defines:m={},inject:x={},vertexShader:S,fragmentShader:T}=e;vo(typeof n=="string"),this.name=n,this.vs=r||S,this.fs=i||T,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(f),this.defines=m,this.injections=fae(x),c&&(this.uniforms=cae(c))}getModuleSource(e){let n;switch(e){case dae:n=this.vs||"";break;case hae:n=this.fs||"";break;default:vo(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&vo(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}};function fae(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function pae(t){return mae(TN(t))}function mae(t){const e={},n={};return EN({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function EN(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&EN({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function TN(t,e){return t.map(n=>(n instanceof f6||(vo(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),vo(n.name,"shader module has no name"),n=new f6(n),n.dependencies=TN(n.dependencies)),n))}function gae(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const yae=7936,_ae=7937,vae=7938,bae=35724,sR={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Iu={};Object.keys(sR).forEach(t=>{Iu[t]=t});function xae(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function wae(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||yae),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||_ae);return{gpuVendor:Eae(n,r),vendor:n,renderer:r,version:t.getParameter(vae),shadingLanguageVersion:t.getParameter(bae)}}function Eae(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const kx={};function p6(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=sR[e];if(vo(r,e),!gae(n))return!0;if(e in kx)return kx[e];const i=r[0],s=n.behavior||"enable",c="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=t.createShader(35633);t.shaderSource(o,c),t.compileShader(o);const f=t.getShaderParameter(o,35713);return t.deleteShader(o),kx[e]=f,f}function Tae(t,e){const n=sR[e];vo(n,e);const r=xae(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return vo(i===!1||i===!0),i}function f_(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Tae(t,n))}function Sae(t){switch(wae(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Aae(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return f_(t,Iu.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),f_(t,Iu.GLSL_DERIVATIVES)&&p6(t,Iu.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),f_(t,Iu.GLSL_FRAG_DATA)&&p6(t,Iu.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),f_(t,Iu.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const Pae=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,Cae=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,Iae={[Ag]:Pae,[iR]:Cae},r0="__LUMA_INJECT_DECLARATIONS__",m6=/void\s+main\s*\([^)]*\)\s*\{\n?/,g6=/}\n?[^{}]*$/,Ox=[];function y6(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Ag;for(const s in n){const c=n[s];c.sort((f,m)=>f.order-m.order),Ox.length=c.length;for(let f=0,m=c.length;f<m;++f)Ox[f]=c[f].injection;const o="".concat(Ox.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(r0,o));break;case"vs:#main-start":i&&(t=t.replace(m6,f=>f+o));break;case"vs:#main-end":i&&(t=t.replace(g6,f=>o+f));break;case"fs:#decl":i||(t=t.replace(r0,o));break;case"fs:#main-start":i||(t=t.replace(m6,f=>f+o));break;case"fs:#main-end":i||(t=t.replace(g6,f=>o+f));break;default:t=t.replace(s,f=>f+o)}}return t=t.replace(r0,""),r&&(t=t.replace(/\}\s*$/,s=>s+Iae[e])),t}function J2(t){const e={};return vo(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function of(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const SN=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Lae=[...SN,[of("attribute"),"in $1"],[of("varying"),"out $1"]],Rae=[...SN,[of("varying"),"in $1"]],AN=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],$ae=[...AN,[of("in"),"attribute $1"],[of("out"),"varying $1"]],Mae=[...AN,[of("in"),"varying $1"]],Q2="gl_FragColor",eE=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,kae=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Oae(t,e,n){switch(e){case 300:return n?X0(t,Lae):Dae(t);case 100:return n?X0(t,$ae):Fae(t);default:throw new Error("unknown GLSL version ".concat(e))}}function X0(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function Dae(t){t=X0(t,Rae);const e=t.match(eE);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(Q2,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(kae,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(Q2,"\\b"),"g"),n)}return t}function Fae(t){t=X0(t,Mae);const e=t.match(eE);if(e){const n=e[1];t=t.replace(eE,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),Q2)}return t}const zae=`

`.concat(r0,`

`),PN={[Ag]:"vertex",[iR]:"fragment"},Nae=`precision highp float;

`;function Bae(t,e){const{vs:n,fs:r}=e,i=pae(e.modules||[]);return{gl:t,vs:_6(t,Object.assign({},e,{source:n,type:Ag,modules:i})),fs:_6(t,Object.assign({},e,{source:r,type:iR,modules:i})),getUniforms:Uae(i)}}function _6(t,e){let{id:n,source:r,type:i,modules:s,defines:c={},hookFunctions:o=[],inject:f={},transpileToGLSL100:m=!1,prologue:x=!0,log:S}=e;vo(typeof r=="string","shader source must be a string");const T=i===Ag,C=r.split(`
`);let R=100,D="",H=r;C[0].indexOf("#version ")===0?(R=300,D=C[0],H=C.slice(1).join(`
`)):D="#version ".concat(R);const F={};s.forEach(le=>{Object.assign(F,le.getDefines())}),Object.assign(F,c);let k=x?"".concat(D,`
`).concat(Gae({id:n,source:r,type:i}),`
`).concat(Vae({type:i}),`
`).concat(Sae(t),`
`).concat(Aae(t),`
`).concat(jae(F),`
`).concat(T?"":Nae,`
`):"".concat(D,`
`);const N=Wae(o),U={},ie={},he={};for(const le in f){const ve=typeof f[le]=="string"?{injection:f[le],order:0}:f[le],Oe=le.match(/^(v|f)s:(#)?([\w-]+)$/);if(Oe){const Re=Oe[2],Ee=Oe[3];Re?Ee==="decl"?ie[le]=[ve]:he[le]=[ve]:U[le]=[ve]}else he[le]=[ve]}for(const le of s){S&&le.checkDeprecations(H,S);const ve=le.getModuleSource(i,R);k+=ve;const Oe=le.injections[i];for(const Re in Oe){const Ee=Re.match(/^(v|f)s:#([\w-]+)$/);if(Ee){const we=Ee[2]==="decl"?ie:he;we[Re]=we[Re]||[],we[Re].push(Oe[Re])}else U[Re]=U[Re]||[],U[Re].push(Oe[Re])}}return k+=zae,k=y6(k,i,ie),k+=Hae(N[i],U),k+=H,k=y6(k,i,he),k=Oae(k,m?100:R,T),k}function Uae(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function Vae(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(PN[e].toUpperCase(),`
`)}function Gae(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(PN[r],`

`):""}function jae(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function Hae(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((c,o)=>c.order-o.order);for(const c of s)n+="  ".concat(c.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function Wae(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),c=n.replace(/\(.+/,"");e[i][c]=Object.assign(r,{signature:s})}),e}const Kae="void main() {gl_FragColor = vec4(0);}",CN=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,qae=`#version 300 es
`.concat(CN);function IN(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const c=s.split(";")[0];return{qualifier:r,type:i,name:c}}function LN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?qae:e>300?"#version ".concat(e,`
`).concat(CN):Kae;const s=Yae(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function Xae(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return vo(!1),null}}function Zae(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return vo(!1),null}}function Yae(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return vo(!1),null}}const Jae=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,Qae={name:"fp32",vs:Jae,fs:null};function v6(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const yo={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function ele(t,{precision:e=yo.precision}={}){return t=tle(t),"".concat(parseFloat(t.toPrecision(e)))}function af(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Tc(t,e,n){return rle(t,r=>Math.max(e,Math.min(n,r)))}function Z0(t,e,n){return af(t)?t.map((r,i)=>Z0(r,e[i],n)):n*e+(1-n)*t}function qm(t,e,n){const r=yo.EPSILON;n&&(yo.EPSILON=n);try{if(t===e)return!0;if(af(t)&&af(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!qm(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=yo.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{yo.EPSILON=r}}function tle(t){return Math.round(t/yo.EPSILON)*yo.EPSILON}function nle(t){return t.clone?t.clone():new Array(t.length)}function rle(t,e,n){if(af(t)){const r=t;n=n||nle(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function ile(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class RN extends ile(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:af(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(yo)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+ele(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!qm(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(yo.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function sle(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ho(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Dx(t,e,n=""){if(yo.debug&&!sle(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class ole extends RN{get x(){return this[0]}set x(e){this[0]=ho(e)}get y(){return this[1]}set y(e){this[1]=ho(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return ho(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return ho(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return v6(e>=0&&e<this.ELEMENTS,"index is out of range"),ho(this[e])}setComponent(e,n){return v6(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var i0=1e-6,lf=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function ale(){var t=new lf(2);return lf!=Float32Array&&(t[0]=0,t[1]=0),t}function b6(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function lle(t,e){return t[0]=-e[0],t[1]=-e[1],t}function $N(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function cle(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){var t=ale();return function(e,n,r,i,s,c){var o,f;for(n||(n=2),r||(r=0),i?f=Math.min(i*n+r,e.length):f=e.length,o=r;o<f;o+=n)t[0]=e[o],t[1]=e[o+1],s(t,t,c),e[o]=t[0],e[o+1]=t[1];return e}})();function ule(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function MN(t,e,n){const r=e[0],i=e[1],s=e[2],c=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/c,t[1]=(n[1]*r+n[5]*i+n[9]*s)/c,t[2]=(n[2]*r+n[6]*i+n[10]*s)/c,t}function dle(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function hle(){var t=new lf(3);return lf!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function fle(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function ple(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function mle(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function gle(t,e,n){var r=e[0],i=e[1],s=e[2],c=n[0],o=n[1],f=n[2];return t[0]=i*f-s*o,t[1]=s*c-r*f,t[2]=r*o-i*c,t}function kN(t,e,n){var r=e[0],i=e[1],s=e[2],c=n[3]*r+n[7]*i+n[11]*s+n[15];return c=c||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/c,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/c,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/c,t}function yle(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function _le(t,e,n){var r=n[0],i=n[1],s=n[2],c=n[3],o=e[0],f=e[1],m=e[2],x=i*m-s*f,S=s*o-r*m,T=r*f-i*o,C=i*T-s*S,R=s*x-r*T,D=r*S-i*x,H=c*2;return x*=H,S*=H,T*=H,C*=2,R*=2,D*=2,t[0]=o+x+C,t[1]=f+S+R,t[2]=m+T+D,t}function vle(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function ble(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function xle(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function wle(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],c=e[1],o=e[2],f=Math.sqrt(n*n+r*r+i*i),m=Math.sqrt(s*s+c*c+o*o),x=f*m,S=x&&mle(t,e)/x;return Math.acos(Math.min(Math.max(S,-1),1))}var Ele=fle;(function(){var t=hle();return function(e,n,r,i,s,c){var o,f;for(n||(n=3),r||(r=0),i?f=Math.min(i*n+r,e.length):f=e.length,o=r;o<f;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,c),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const Fx=[0,0,0];let p_;class Ga extends ole{static get ZERO(){return p_||(p_=new Ga(0,0,0),Object.freeze(p_)),p_}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&af(e)?this.copy(e):(yo.debug&&(ho(e),ho(n),ho(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return yo.debug&&(ho(e.x),ho(e.y),ho(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=ho(e)}angle(e){return wle(this,e)}cross(e){return gle(this,this,e),this.check()}rotateX({radians:e,origin:n=Fx}){return vle(this,this,n,e),this.check()}rotateY({radians:e,origin:n=Fx}){return ble(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=Fx}){return xle(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return kN(this,this,e),this.check()}transformAsVector(e){return MN(this,this,e),this.check()}transformByMatrix3(e){return yle(this,this,e),this.check()}transformByMatrix2(e){return dle(this,this,e),this.check()}transformByQuaternion(e){return _le(this,this,e),this.check()}}class Tle extends RN{toString(){let e="[";if(yo.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=ho(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function Sle(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ale(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],c=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=c,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function tE(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],c=e[4],o=e[5],f=e[6],m=e[7],x=e[8],S=e[9],T=e[10],C=e[11],R=e[12],D=e[13],H=e[14],F=e[15],k=n*o-r*c,N=n*f-i*c,U=n*m-s*c,ie=r*f-i*o,he=r*m-s*o,le=i*m-s*f,ve=x*D-S*R,Oe=x*H-T*R,Re=x*F-C*R,Ee=S*H-T*D,$e=S*F-C*D,we=T*F-C*H,Be=k*we-N*$e+U*Ee+ie*Re-he*Oe+le*ve;return Be?(Be=1/Be,t[0]=(o*we-f*$e+m*Ee)*Be,t[1]=(i*$e-r*we-s*Ee)*Be,t[2]=(D*le-H*he+F*ie)*Be,t[3]=(T*he-S*le-C*ie)*Be,t[4]=(f*Re-c*we-m*Oe)*Be,t[5]=(n*we-i*Re+s*Oe)*Be,t[6]=(H*U-R*le-F*N)*Be,t[7]=(x*le-T*U+C*N)*Be,t[8]=(c*$e-o*Re+m*ve)*Be,t[9]=(r*Re-n*$e-s*ve)*Be,t[10]=(R*he-D*U+F*k)*Be,t[11]=(S*U-x*he-C*k)*Be,t[12]=(o*Oe-c*Ee-f*ve)*Be,t[13]=(n*Ee-r*Oe+i*ve)*Be,t[14]=(D*N-R*ie-H*k)*Be,t[15]=(x*ie-S*N+T*k)*Be,t):null}function Ple(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],c=t[5],o=t[6],f=t[7],m=t[8],x=t[9],S=t[10],T=t[11],C=t[12],R=t[13],D=t[14],H=t[15],F=e*c-n*s,k=e*o-r*s,N=e*f-i*s,U=n*o-r*c,ie=n*f-i*c,he=r*f-i*o,le=m*R-x*C,ve=m*D-S*C,Oe=m*H-T*C,Re=x*D-S*R,Ee=x*H-T*R,$e=S*H-T*D;return F*$e-k*Ee+N*Re+U*Oe-ie*ve+he*le}function Vu(t,e,n){var r=e[0],i=e[1],s=e[2],c=e[3],o=e[4],f=e[5],m=e[6],x=e[7],S=e[8],T=e[9],C=e[10],R=e[11],D=e[12],H=e[13],F=e[14],k=e[15],N=n[0],U=n[1],ie=n[2],he=n[3];return t[0]=N*r+U*o+ie*S+he*D,t[1]=N*i+U*f+ie*T+he*H,t[2]=N*s+U*m+ie*C+he*F,t[3]=N*c+U*x+ie*R+he*k,N=n[4],U=n[5],ie=n[6],he=n[7],t[4]=N*r+U*o+ie*S+he*D,t[5]=N*i+U*f+ie*T+he*H,t[6]=N*s+U*m+ie*C+he*F,t[7]=N*c+U*x+ie*R+he*k,N=n[8],U=n[9],ie=n[10],he=n[11],t[8]=N*r+U*o+ie*S+he*D,t[9]=N*i+U*f+ie*T+he*H,t[10]=N*s+U*m+ie*C+he*F,t[11]=N*c+U*x+ie*R+he*k,N=n[12],U=n[13],ie=n[14],he=n[15],t[12]=N*r+U*o+ie*S+he*D,t[13]=N*i+U*f+ie*T+he*H,t[14]=N*s+U*m+ie*C+he*F,t[15]=N*c+U*x+ie*R+he*k,t}function Y0(t,e,n){var r=n[0],i=n[1],s=n[2],c,o,f,m,x,S,T,C,R,D,H,F;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(c=e[0],o=e[1],f=e[2],m=e[3],x=e[4],S=e[5],T=e[6],C=e[7],R=e[8],D=e[9],H=e[10],F=e[11],t[0]=c,t[1]=o,t[2]=f,t[3]=m,t[4]=x,t[5]=S,t[6]=T,t[7]=C,t[8]=R,t[9]=D,t[10]=H,t[11]=F,t[12]=c*r+x*i+R*s+e[12],t[13]=o*r+S*i+D*s+e[13],t[14]=f*r+T*i+H*s+e[14],t[15]=m*r+C*i+F*s+e[15]),t}function oR(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Cle(t,e,n,r){var i=r[0],s=r[1],c=r[2],o=Math.hypot(i,s,c),f,m,x,S,T,C,R,D,H,F,k,N,U,ie,he,le,ve,Oe,Re,Ee,$e,we,Be,Jt;return o<i0?null:(o=1/o,i*=o,s*=o,c*=o,f=Math.sin(n),m=Math.cos(n),x=1-m,S=e[0],T=e[1],C=e[2],R=e[3],D=e[4],H=e[5],F=e[6],k=e[7],N=e[8],U=e[9],ie=e[10],he=e[11],le=i*i*x+m,ve=s*i*x+c*f,Oe=c*i*x-s*f,Re=i*s*x-c*f,Ee=s*s*x+m,$e=c*s*x+i*f,we=i*c*x+s*f,Be=s*c*x-i*f,Jt=c*c*x+m,t[0]=S*le+D*ve+N*Oe,t[1]=T*le+H*ve+U*Oe,t[2]=C*le+F*ve+ie*Oe,t[3]=R*le+k*ve+he*Oe,t[4]=S*Re+D*Ee+N*$e,t[5]=T*Re+H*Ee+U*$e,t[6]=C*Re+F*Ee+ie*$e,t[7]=R*Re+k*Ee+he*$e,t[8]=S*we+D*Be+N*Jt,t[9]=T*we+H*Be+U*Jt,t[10]=C*we+F*Be+ie*Jt,t[11]=R*we+k*Be+he*Jt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ON(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],c=e[5],o=e[6],f=e[7],m=e[8],x=e[9],S=e[10],T=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+m*r,t[5]=c*i+x*r,t[6]=o*i+S*r,t[7]=f*i+T*r,t[8]=m*i-s*r,t[9]=x*i-c*r,t[10]=S*i-o*r,t[11]=T*i-f*r,t}function Ile(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],c=e[1],o=e[2],f=e[3],m=e[8],x=e[9],S=e[10],T=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-m*r,t[1]=c*i-x*r,t[2]=o*i-S*r,t[3]=f*i-T*r,t[8]=s*r+m*i,t[9]=c*r+x*i,t[10]=o*r+S*i,t[11]=f*r+T*i,t}function DN(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],c=e[1],o=e[2],f=e[3],m=e[4],x=e[5],S=e[6],T=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+m*r,t[1]=c*i+x*r,t[2]=o*i+S*r,t[3]=f*i+T*r,t[4]=m*i-s*r,t[5]=x*i-c*r,t[6]=S*i-o*r,t[7]=T*i-f*r,t}function Lle(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],c=n+n,o=r+r,f=i+i,m=n*c,x=r*c,S=r*o,T=i*c,C=i*o,R=i*f,D=s*c,H=s*o,F=s*f;return t[0]=1-S-R,t[1]=x+F,t[2]=T-H,t[3]=0,t[4]=x-F,t[5]=1-m-R,t[6]=C+D,t[7]=0,t[8]=T+H,t[9]=C-D,t[10]=1-m-S,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Rle(t,e,n,r,i,s,c){var o=1/(n-e),f=1/(i-r),m=1/(s-c);return t[0]=s*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*f,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(i+r)*f,t[10]=(c+s)*m,t[11]=-1,t[12]=0,t[13]=0,t[14]=c*s*2*m,t[15]=0,t}function $le(t,e,n,r,i){var s=1/Math.tan(e/2),c;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(c=1/(r-i),t[10]=(i+r)*c,t[14]=2*i*r*c):(t[10]=-1,t[14]=-2*r),t}var Mle=$le;function kle(t,e,n,r,i,s,c){var o=1/(e-n),f=1/(r-i),m=1/(s-c);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*m,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*f,t[14]=(c+s)*m,t[15]=1,t}var Ole=kle;function Dle(t,e,n,r){var i,s,c,o,f,m,x,S,T,C,R=e[0],D=e[1],H=e[2],F=r[0],k=r[1],N=r[2],U=n[0],ie=n[1],he=n[2];return Math.abs(R-U)<i0&&Math.abs(D-ie)<i0&&Math.abs(H-he)<i0?Sle(t):(x=R-U,S=D-ie,T=H-he,C=1/Math.hypot(x,S,T),x*=C,S*=C,T*=C,i=k*T-N*S,s=N*x-F*T,c=F*S-k*x,C=Math.hypot(i,s,c),C?(C=1/C,i*=C,s*=C,c*=C):(i=0,s=0,c=0),o=S*c-T*s,f=T*i-x*c,m=x*s-S*i,C=Math.hypot(o,f,m),C?(C=1/C,o*=C,f*=C,m*=C):(o=0,f=0,m=0),t[0]=i,t[1]=o,t[2]=x,t[3]=0,t[4]=s,t[5]=f,t[6]=S,t[7]=0,t[8]=c,t[9]=m,t[10]=T,t[11]=0,t[12]=-(i*R+s*D+c*H),t[13]=-(o*R+f*D+m*H),t[14]=-(x*R+S*D+T*H),t[15]=1,t)}function Fle(){var t=new lf(4);return lf!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function zle(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Pg(t,e,n){var r=e[0],i=e[1],s=e[2],c=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*c,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*c,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*c,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*c,t}(function(){var t=Fle();return function(e,n,r,i,s,c){var o,f;for(n||(n=4),r||(r=0),i?f=Math.min(i*n+r,e.length):f=e.length,o=r;o<f;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,c),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var nE;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(nE||(nE={}));const Nle=45*Math.PI/180,Ble=1,zx=.1,Nx=500,Ule=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class ja extends Tle{static get IDENTITY(){return Gle()}static get ZERO(){return Vle()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return nE}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,c,o,f,m,x,S,T,C,R,D,H){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=c,this[6]=o,this[7]=f,this[8]=m,this[9]=x,this[10]=S,this[11]=T,this[12]=C,this[13]=R,this[14]=D,this[15]=H,this.check()}setRowMajor(e,n,r,i,s,c,o,f,m,x,S,T,C,R,D,H){return this[0]=e,this[1]=s,this[2]=m,this[3]=C,this[4]=n,this[5]=c,this[6]=x,this[7]=R,this[8]=r,this[9]=o,this[10]=S,this[11]=D,this[12]=i,this[13]=f,this[14]=T,this[15]=H,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Ule)}fromObject(e){return this.check()}fromQuaternion(e){return Lle(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:c=zx,far:o=Nx}=e;return o===1/0?jle(this,n,r,i,s,c):Rle(this,n,r,i,s,c,o),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return Dle(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:c=zx,far:o=Nx}=e;return Ole(this,n,r,i,s,c,o),this.check()}orthographic(e){const{fovy:n=Nle,aspect:r=Ble,focalDistance:i=1,near:s=zx,far:c=Nx}=e;x6(n);const o=n/2,f=i*Math.tan(o),m=f*r;return this.ortho({left:-m,right:m,bottom:-f,top:f,near:s,far:c})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return x6(n),Mle(this,n,r,i,s),this.check()}determinant(){return Ple(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],c=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*c,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*c,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],c=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*c,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*c,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*c,e}transpose(){return Ale(this,this),this.check()}invert(){return tE(this,this),this.check()}multiplyLeft(e){return Vu(this,e,this),this.check()}multiplyRight(e){return Vu(this,this,e),this.check()}rotateX(e){return ON(this,this,e),this.check()}rotateY(e){return Ile(this,this,e),this.check()}rotateZ(e){return DN(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Cle(this,this,e,n),this.check()}scale(e){return oR(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Y0(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Pg(n||[-0,-0,-0,-0],e,this),Dx(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=cle(n||[-0,-0],e,this);break;case 3:i=kN(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Dx(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=ule(n||[-0,-0],e,this);break;case 3:r=MN(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Dx(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let m_,g_;function Vle(){return m_||(m_=new ja([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(m_)),m_}function Gle(){return g_||(g_=new ja,Object.freeze(g_)),g_}function x6(t){if(t>Math.PI*2)throw Error("expected radians")}function jle(t,e,n,r,i,s){const c=2*s/(n-e),o=2*s/(i-r),f=(n+e)/(n-e),m=(i+r)/(i-r),x=-1,S=-1,T=-2*s;return t[0]=c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=f,t[9]=m,t[10]=x,t[11]=S,t[12]=0,t[13]=0,t[14]=T,t[15]=0,t}const w6=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,Hle={lightSources:{}};function Bx(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function Wle(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=Bx(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,c)=>{i["lighting_uPointLight[".concat(c,"].color")]=Bx(s),i["lighting_uPointLight[".concat(c,"].position")]=s.position,i["lighting_uPointLight[".concat(c,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,c)=>{i["lighting_uDirectionalLight[".concat(c,"].color")]=Bx(s),i["lighting_uDirectionalLight[".concat(c,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function FN(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Hle;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},Wle({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return FN({lightSources:e})}return{}}const Kle={name:"lights",vs:w6,fs:w6,getUniforms:FN,defines:{MAX_LIGHTS:3}},qle=new Uint8Array([0,255,255,255]),Xle={pickingSelectedColor:null,pickingHighlightColor:qle,pickingActive:!1,pickingAttribute:!1};function Zle(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xle;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const Yle=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,Jle=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,Qle={name:"picking",vs:Yle,fs:Jle,getUniforms:Zle},ece=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,tce={};function nce(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function rce(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:tce;if(!("material"in t))return{};const{material:e}=t;return e?nce(e):{lighting_uEnabled:!1}}const ice={name:"gouraud-lighting",dependencies:[Kle],vs:ece,defines:{LIGHTING_VERTEX:1},getUniforms:rce},sce=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,oce={name:"transform",vs:sce,fs:null};let aR=class zN{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new zN(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:c=[],bufferMode:o=35981,transpileToGLSL100:f=!1}=e,m=this._getModuleList(e.modules),x=this._getHash(n),S=this._getHash(r),T=m.map(N=>this._getHash(N.name)).sort(),C=c.map(N=>this._getHash(N)),R=Object.keys(i).sort(),D=Object.keys(s).sort(),H=[],F=[];for(const N of R)H.push(this._getHash(N)),H.push(this._getHash(i[N]));for(const N of D)F.push(this._getHash(N)),F.push(this._getHash(s[N]));const k="".concat(x,"/").concat(S,"D").concat(H.join("/"),"M").concat(T.join("/"),"I").concat(F.join("/"),"V").concat(C.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(f?"T":"");if(!this._programCache[k]){const N=Bae(this.gl,{vs:n,fs:r,modules:m,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:f});this._programCache[k]=new xN(this.gl,{hash:k,vs:N.vs,fs:N.fs,varyings:c,bufferMode:o}),this._getUniforms[k]=N.getUniforms||(U=>{}),this._useCounts[k]=0}return this._useCounts[k]++,this._programCache[k]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,c=this._defaultModules.length;s<c;++s){const o=this._defaultModules[s],f=o.name;n[i++]=o,r[f]=!0}for(let s=0,c=e.length;s<c;++s){const o=e[s],f=o.name;r[f]||(n[i++]=o,r[f]=!0)}return n.length=i,n}};const ace={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function lce(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const c=e.attributes[s],o=cce(s,n);if(s==="indices")i=c;else if(c.constant)r[o]=c.value;else{const f=c.value,m={...c};delete m.value,r[o]=[new cr(t,f),m],uce(s,m)}}if(i){const s=i.value||i;Mt(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const c={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new cr(t,{data:s,target:34963}),c]}return r}function cce(t,e){const{attributeMap:n=ace}=e||{};return n&&n[t]||t}function uce(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Mt(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Zd=2,dce=1e4,hce="Model needs drawMode and vertexCount",E6=()=>{},fce={};let Qu=class{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Uc("model")}=n;Mt(db(e)),this.id=r,this.gl=e,this.id=n.id||Uc("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||aR.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:c,inject:o,varyings:f,bufferMode:m,transpileToGLSL100:x}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:c,inject:o,varyings:f,bufferMode:m,transpileToGLSL100:x},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Mt(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),hce)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:c,inject:o,varyings:f,bufferMode:m,transpileToGLSL100:x}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:c,inject:o,varyings:f,bufferMode:m,transpileToGLSL100:x},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Mt(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Mt(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=lce(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(sf(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return tR(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:c=this.transformFeedback,parameters:o={},vertexArray:f=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let m;Yt.priority>=Zd&&(m=this._logDrawCallStart(Zd));const x=this.vertexArray.getDrawParams(),{isIndexed:S=x.isIndexed,indexType:T=x.indexType,indexOffset:C=x.indexOffset,vertexArrayInstanced:R=x.isInstanced}=this.props;R&&!this.isInstanced&&Yt.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:D,instanceCount:H}=this,{onBeforeRender:F=E6,onAfterRender:k=E6}=this.props;F(),this.program.setUniforms(this.uniforms);const N=this.program.draw(Object.assign(fce,e,{logPriority:m,uniforms:null,framebuffer:r,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:f,transformFeedback:c,isIndexed:S,indexType:T,isInstanced:D,instanceCount:H,offset:S?C:0}));return k(),Yt.priority>=Zd&&this._logDrawCallEnd(m,f,r),N}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{[35977]:n})),i.forEach(c=>c.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(c=>c.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Yt.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:c,defines:o,varyings:f,bufferMode:m,transpileToGLSL100:x}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:c,defines:o,varyings:f,bufferMode:m,transpileToGLSL100:x}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Mt(n instanceof xN,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new tae(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof cr&&n.delete()}}_setAnimationProps(e){this.animated&&Mt(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(sf(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new wN(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:dce;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),Yt.group(Zd,">>> DRAWING MODEL ".concat(this.id),{collapsed:Yt.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=iae({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:c,unusedTable:o,unusedCount:f}=l6({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:m,count:x}=l6({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});x>0&&Yt.log("MISSING UNIFORMS",Object.keys(m))(),f>0&&Yt.log("UNUSED UNIFORMS",Object.keys(o))();const S=oae(this.vertexArray.configuration);Yt.table(e,s)(),Yt.table(e,c)(),Yt.table(e+1,S)(),i&&i.log({logLevel:Zd,message:"Rendered to ".concat(i.id)}),Yt.groupEnd(Zd)()}};class pce{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof cr?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Mt(Mn(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const c=n[s],{byteLength:o,usage:f,accessor:m}=c;r[i]=this._createNewBuffer(i,{byteLength:o,usage:f,accessor:m})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new wN(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],Mt(r[s]instanceof cr)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new cr(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const mce="transform_uSampler_",J0="transform_uSize_",T6="transform_position";function gce(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,c=Object.keys(n).length,o=null;const f={};let m=e,x={};if(c>0||r){const S=m.split(`
`),T=S.slice();if(S.forEach((C,R,D)=>{if(c>0){const H=xce(C,n);if(H){const{updatedLine:F,inject:k}=H;T[R]=F,x=J2([x,k]),Object.assign(f,H.samplerTextureMap),c--}}r&&!o&&(o=bce(C,r))}),r){Mt(i);const C="".concat(J0).concat(r),R="uniform vec2 ".concat(C,`;
`),D="     vec2 ".concat(T6," = transform_getPos(").concat(C,`);
     gl_Position = vec4(`).concat(T6,`, 0, 1.);
`);x=J2([x,{"vs:#decl":R,"vs:#main-start":D}])}m=T.join(`
`)}return{vs:m,targetTextureType:o,inject:x,samplerTextureMap:f}}function yce(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,c;n&&({width:s,height:c}=r,i["".concat(J0).concat(n)]=[s,c]);for(const o in e)({width:s,height:c}=e[o]),i["".concat(J0).concat(o)]=[s,c];return i}function _ce(t){return IN(t,["attribute","in"])}function vce(t){const e="".concat(mce).concat(t),n="".concat(J0).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function bce(t,e){const n=IN(t,["varying","out"]);return n&&n.name===e?n.type:null}function xce(t,e){const n={},r=_ce(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const c="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:o,sizeName:f,uniformDeclerations:m}=vce(s),x=Xae(i),S="  ".concat(i," ").concat(s," = transform_getInput(").concat(o,", ").concat(f,").").concat(x,`;
`);return n[o]=s,{updatedLine:c,inject:{"vs:#decl":m,"vs:#main-start":S},samplerTextureMap:n}}return null}const wce={[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},Ece="transform_output";class Tce{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],c=Object.assign({},n,e.attributes),o=Object.assign({},e.uniforms),f=Object.assign({},e.parameters);let m=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){c.transform_elementID=this.elementIDBuffer;for(const S in this.samplerTextureMap){const T=this.samplerTextureMap[S];o[S]=r[T]}this._setSourceTextureParameters();const x=yce({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(o,x)}return this.hasTargetTexture&&(m=!1,f.viewport=[0,0,i.width,i.height]),{attributes:c,framebuffer:i,uniforms:o,discard:m,parameters:f}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=fb(n);if(!e)return r;const i=r.constructor,s=Zae(this.targetTextureType),c=new i(r.length*s/4);let o=0;for(let f=0;f<r.length;f+=4)for(let m=0;m<s;m++)c[o++]=r[f+m];return c}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof xo)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new cr(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:c,height:o}=s,{framebuffer:f}=e;f?(f.update({attachments:{[36064]:s},resizeAttachments:!1}),f.resize({width:c,height:o})):e.framebuffer=new Yi(this.gl,{id:"transform-framebuffer",width:c,height:o,attachments:{[36064]:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(wce)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=jse(e,{parameters:{[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},pixelStore:{[37440]:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:c,inject:o,samplerTextureMap:f}=gce({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),m=J2([e.inject||{},o]);this.targetTextureType=c,this.samplerTextureMap=f;const x=e._fs||LN({version:_N(i),input:this.targetTextureVarying,inputType:c,output:Ece}),S=this.hasSourceTextures||this.targetTextureVarying?[oce].concat(e.modules||[]):e.modules;return{vs:i,fs:x,modules:S,uniforms:s,inject:m}}}class lR{static isSupported(e){return Mn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();Mt(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Qu(n,Object.assign({},e,{fs:e.fs||LN({version:_N(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){Sce(n)&&(this.bufferTransform=new pce(e,n)),Ace(n)&&(this.textureTransform=new Tce(e,n)),Mt(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function Sce(t){return!!(!sf(t.feedbackBuffers)||!sf(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function Ace(t){return!!(!sf(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const S6={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Cg{static get DRAW_MODE(){return S6}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Uc("geometry"),drawMode:r=S6.TRIANGLES,attributes:i={},indices:s=null,vertexCount:c=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=c||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,Mt(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(Mt(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:c,size:o,constant:f}=s;!f&&c&&o>=1&&(r=Math.min(r,c.length/o))}return Mt(Number.isFinite(r)),r}}let Pce=1,Cce=1;class NN{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,c=Pce++,o={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(c,o),c}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:c}=i;s.setTime(this.getTime(c))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=Cce++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const Ice=[255,255,255],Lce=1;let Rce=0;class $ce{constructor(e={}){K(this,"id",void 0),K(this,"color",void 0),K(this,"intensity",void 0),K(this,"type","ambient");const{color:n=Ice}=e,{intensity:r=Lce}=e;this.id=e.id||"ambient-".concat(Rce++),this.color=n,this.intensity=r}}const Mce=[255,255,255],kce=1,Oce=[0,0,-1];let Dce=0;class A6{constructor(e={}){K(this,"id",void 0),K(this,"color",void 0),K(this,"intensity",void 0),K(this,"type","directional"),K(this,"direction",void 0),K(this,"shadow",void 0);const{color:n=Mce}=e,{intensity:r=kce}=e,{direction:i=Oce}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(Dce++),this.color=n,this.intensity=r,this.type="directional",this.direction=new Ga(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class Fce{constructor(e,n={id:"pass"}){K(this,"id",void 0),K(this,"gl",void 0),K(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class cR extends Fce{constructor(...e){super(...e),K(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return $l(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:c,clearStack:o=!0,clearCanvas:f=!0}=e;e.pass=e.pass||"unknown";const m=this.gl;f&&Nce(m,n),o&&(this._lastRenderIndex=-1);const x=[];for(const S of i){const T=s&&s[S.id];c==null||c(S);const C=this._getDrawLayerParams(S,e),R=S.subViewports||[S];for(const D of R){const H=this._drawLayersInViewport(m,{target:n,moduleParameters:r,viewport:D,view:T,pass:e.pass,layers:e.layers},C);x.push(H)}}return x}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:c,effects:o,moduleParameters:f},m=!1){const x=[],S=BN(this._lastRenderIndex+1),T={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:c},C={};for(let R=0;R<n.length;R++){const D=n[R],H=this._shouldDrawLayer(D,T,s,C),F={shouldDrawLayer:H};H&&!m&&(F.layerRenderIndex=S(D,H),F.moduleParameters=this._getModuleParameters(D,o,r,f),F.layerParameters=this.getLayerParameters(D,R,e)),x[R]=F}return x}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:c,view:o},f){const m=zce(e,{moduleParameters:r,target:s,viewport:c});if(o&&o.props.clear){const S=o.props.clear===!0?{color:!0,depth:!0}:o.props.clear;da(e,{scissorTest:!0,scissor:m},()=>tR(e,S))}const x={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};$l(e,{viewport:m});for(let S=0;S<n.length;S++){const T=n[S],{shouldDrawLayer:C,layerRenderIndex:R,moduleParameters:D,layerParameters:H}=f[S];if(C&&T.props.pickable&&x.pickableCount++,T.isComposite)x.compositeCount++;else if(C){x.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,R),D.viewport=c;try{T._drawLayer({moduleParameters:D,uniforms:{layerIndex:R},parameters:H})}catch(F){T.raiseError(F,"drawing ".concat(T," to ").concat(i))}}}return x}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let c=e.parent;for(;c;){if(!c.props.visible||!c.filterSubLayer(n))return!1;n.layer=c,c=c.parent}if(r){const o=n.layer.id;if(o in i||(i[o]=r(n)),!i[o])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const c=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:rf(this.gl)});if(n)for(const f of n){var o;Object.assign(c,(o=f.getModuleParameters)===null||o===void 0?void 0:o.call(f,e))}return Object.assign(c,this.getModuleParameters(e,n),i)}}function BN(t=0,e={}){const n={},r=(i,s)=>{const c=i.props._offset,o=i.id,f=i.parent&&i.parent.id;let m;if(f&&!(f in e)&&r(i.parent,!1),f in n){const x=n[f]=n[f]||BN(e[f],e);m=x(i,s),n[o]=x}else Number.isFinite(c)?(m=c+(e[f]||0),n[o]=null):m=t;return s&&m>=t&&(t=m+1),e[o]=m,m};return r}function zce(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||rf(t),c=i?n.height:t.drawingBufferHeight,o=r;return[o.x*s,c-(o.y+o.height)*s,o.width*s,o.height*s]}function Nce(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;$l(t,{viewport:[0,0,n,r]}),t.clear(16640)}class Bce extends cR{constructor(e,n){super(e,n),K(this,"shadowMap",void 0),K(this,"depthBuffer",void 0),K(this,"fbo",void 0),this.shadowMap=new xo(e,{width:1,height:1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.depthBuffer=new Ph(e,{format:33189,width:1,height:1}),this.fbo=new Yi(e,{id:"shadowmap",width:1,height:1,attachments:{[36064]:this.shadowMap,[36096]:this.depthBuffer}})}render(e){const n=this.fbo;da(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=rf(this.gl),s=r.width*i,c=r.height*i;(s!==n.width||c!==n.height)&&n.resize({width:s,height:c}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const UN="#define SMOOTH_EDGE_RADIUS 0.5",Uce=`
`.concat(UN,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),Vce=`
`.concat(UN,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),Gce={name:"geometry",vs:Uce,fs:Vce},jce=Object.keys(qn).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(qn[t],";")).join(""),Hce=Object.keys(za).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(za[t],";")).join(""),Wce=Object.keys(Yu).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Yu[t],";")).join(""),Kce="".concat(jce,`
`).concat(Hce,`
`).concat(Wce,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function qce(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Ig(t){let e={},n;return r=>{for(const i in r)if(!qce(r[i],e[i])){n=t(r),e=r;break}return n}}const P6=[0,0,0,0],Xce=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],VN=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Zce=[0,0,0],GN=[0,0,0],Yce=Ig(eue);function jN(t,e,n=GN){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===qn.LNGLAT_OFFSETS||e===qn.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case za.WEB_MERCATOR:(e===qn.LNGLAT||e===qn.CARTESIAN)&&(i=[0,0,0],s=!1);break;case za.WEB_MERCATOR_AUTO_OFFSET:e===qn.LNGLAT?r=i:e===qn.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case za.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case za.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function Jce(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:c}=t,o=P6,f=P6,m=t.cameraPosition;const{geospatialOrigin:x,shaderCoordinateOrigin:S,offsetMode:T}=jN(t,e,n);return T&&(f=t.projectPosition(x||S),m=[m[0]-f[0],m[1]-f[1],m[2]-f[2]],f[3]=1,o=Pg([],f,c),s=r||s,c=Vu([],i,s),c=Vu([],c,Xce)),{viewMatrix:s,viewProjectionMatrix:c,projectionCenter:o,originCommon:f,cameraPosCommon:m,shaderCoordinateOrigin:S,geospatialOrigin:x}}function Qce({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=qn.DEFAULT,coordinateOrigin:i=GN,autoWrapLongitude:s=!1}){r===qn.DEFAULT&&(r=t.isGeospatial?qn.LNGLAT:qn.CARTESIAN);const c=Yce({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return c.project_uWrapLongitude=s,c.project_uModelMatrix=n||VN,c}function eue({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:c,cameraPosCommon:o,shaderCoordinateOrigin:f,geospatialOrigin:m}=Jce(t,n,r),x=t.getDistanceScales(),S=[t.width*e,t.height*e],T=Pg([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,C={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:f,project_uCommonOrigin:c.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:S,project_uDevicePixelRatio:e,project_uFocalDistance:T,project_uCommonUnitsPerMeter:x.unitsPerMeter,project_uCommonUnitsPerWorldUnit:x.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Zce,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:VN,project_uCameraPosition:o};if(m){const R=t.getDistanceScales(m);switch(n){case qn.METER_OFFSETS:C.project_uCommonUnitsPerWorldUnit=R.unitsPerMeter,C.project_uCommonUnitsPerWorldUnit2=R.unitsPerMeter2;break;case qn.LNGLAT:case qn.LNGLAT_OFFSETS:t._pseudoMeters||(C.project_uCommonUnitsPerMeter=R.unitsPerMeter),C.project_uCommonUnitsPerWorldUnit=R.unitsPerDegree,C.project_uCommonUnitsPerWorldUnit2=R.unitsPerDegree2;break;case qn.CARTESIAN:C.project_uCommonUnitsPerWorldUnit=[1,1,R.unitsPerMeter[2]],C.project_uCommonUnitsPerWorldUnit2=[0,0,R.unitsPerMeter2[2]];break}}return C}const tue={};function nue(t=tue){return"viewport"in t?Qce(t):{}}const uR={name:"project",dependencies:[Qae,Gce],vs:Kce,getUniforms:nue};function rue(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function zh(t,e){const n=Pg([],e,t);return zle(n,n,1/n[3]),n}function C6(t,e){const n=t%e;return n<0?e+n:n}function rE(t,e,n){return t<e?e:t>n?n:t}function iue(t){return Math.log(t)*Math.LOG2E}const dR=Math.log2||iue;function Ml(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const aa=Math.PI,HN=aa/4,Uo=aa/180,iE=180/aa,cf=512,Q0=4003e4,y_=85.051129,sue=1.5;function oue(t){return dR(t)}function ev(t){const[e,n]=t;Ml(Number.isFinite(e)),Ml(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Uo,i=n*Uo,s=cf*(r+aa)/(2*aa),c=cf*(aa+Math.log(Math.tan(HN+i*.5)))/(2*aa);return[s,c]}function uf(t){const[e,n]=t,r=e/cf*(2*aa)-aa,i=2*(Math.atan(Math.exp(n/cf*(2*aa)-aa))-HN);return[r*iE,i*iE]}function aue(t){const{latitude:e}=t;Ml(Number.isFinite(e));const n=Math.cos(e*Uo);return oue(Q0*n)-9}function Ux(t){const e=Math.cos(t*Uo);return cf/Q0/e}function sE(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;Ml(Number.isFinite(e)&&Number.isFinite(n));const i=cf,s=Math.cos(e*Uo),c=i/360,o=c/s,f=i/Q0/s,m={unitsPerMeter:[f,f,f],metersPerUnit:[1/f,1/f,1/f],unitsPerDegree:[c,o,f],degreesPerUnit:[1/c,1/o,1/f]};if(r){const x=Uo*Math.tan(e*Uo)/s,S=c*x/2,T=i/Q0*x,C=T/o*f;m.unitsPerDegree2=[0,S,T],m.unitsPerMeter2=[C,0,C]}return m}function WN(t,e){const[n,r,i]=t,[s,c,o]=e,{unitsPerMeter:f,unitsPerMeter2:m}=sE({longitude:n,latitude:r,highPrecision:!0}),x=ev(t);x[0]+=s*(f[0]+m[0]*c),x[1]+=c*(f[1]+m[1]*c);const S=uf(x),T=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[S[0],S[1],T]:S}function lue(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:c}=t,o=rue();Y0(o,o,[0,0,-i]),ON(o,o,-n*Uo),DN(o,o,r*Uo);const f=s/e;return oR(o,o,[f,f,f]),c&&Y0(o,o,ple([],c)),o}function cue(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:c,scale:o,nearZMultiplier:f=1,farZMultiplier:m=1}=t;let{fovy:x=tv(sue)}=t;r!==void 0&&(x=tv(r));const S=x*Uo,T=i*Uo,C=KN(x);let R=C;c&&(R+=c[2]*o/Math.cos(T)/n);const D=S*(.5+(s?s[1]:0)/n),H=Math.sin(D)*R/Math.sin(rE(Math.PI/2-T-D,.01,Math.PI-.01)),F=Math.sin(T)*H+R,k=R*10,N=Math.min(F*m,k);return{fov:S,aspect:e/n,focalDistance:C,near:f,far:N}}function tv(t){return 2*Math.atan(.5/t)*iE}function KN(t){return .5/Math.tan(.5*t*Uo)}function qN(t,e){const[n,r,i=0]=t;return Ml(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),zh(e,[n,r,i,1])}function hR(t,e,n=0){const[r,i,s]=t;if(Ml(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return zh(e,[r,i,s,1]);const c=zh(e,[r,i,0,1]),o=zh(e,[r,i,1,1]),f=c[2],m=o[2],x=f===m?0:((n||0)-f)/(m-f);return $N([],c,o,x)}function uue(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:c=[0,0]}=t,[[o,f],[m,x]]=r,S=due(t.padding),T=ev([o,rE(x,-y_,y_)]),C=ev([m,rE(f,-y_,y_)]),R=[Math.max(Math.abs(C[0]-T[0]),i),Math.max(Math.abs(C[1]-T[1]),i)],D=[e-S.left-S.right-Math.abs(c[0])*2,n-S.top-S.bottom-Math.abs(c[1])*2];Ml(D[0]>0&&D[1]>0);const H=D[0]/R[0],F=D[1]/R[1],k=(S.right-S.left)/2/H,N=(S.top-S.bottom)/2/F,U=[(C[0]+T[0])/2+k,(C[1]+T[1])/2+N],ie=uf(U),he=Math.min(s,dR(Math.abs(Math.min(H,F))));return Ml(Number.isFinite(he)),{longitude:ie[0],latitude:ie[1],zoom:he}}function due(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Ml(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const I6=Math.PI/180;function hue(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},c=i([0,r],s),o=i([n,r],s);let f,m;const x=t.fovy?.5*t.fovy*I6:Math.atan(.5/t.altitude),S=(90-t.pitch)*I6;return x>S-.01?(f=L6(t,0,e),m=L6(t,n,e)):(f=i([0,0],s),m=i([n,0],s)),[c,o,m,f]}function L6(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=zh(r,[e,0,1,1]),s=zh(r,[e,t.height,1,1]),o=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),f=$N([],i,s,o),m=uf(f);return m.push(n),m}const R6=512;function fue(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:c,bearing:o=0}=t;(i<-180||i>180)&&(i=C6(i+180,360)-180),(o<-180||o>180)&&(o=C6(o+180,360)-180);const f=dR(n/R6);if(c<=f)c=f,s=0;else{const m=n/2/Math.pow(2,c),x=uf([0,m])[1];if(s<x)s=x;else{const S=uf([0,R6-m])[1];s>S&&(s=S)}}return{width:e,height:n,longitude:i,latitude:s,zoom:c,pitch:r,bearing:o}}const pue=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,mue=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,gue=Ig(xue),yue=Ig(wue),_ue=[0,0,0,1],vue=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function bue(t,e){const[n,r,i]=t,s=hR([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function xue({viewport:t,center:e}){return new ja(t.viewProjectionMatrix).invert().transform(e)}function wue({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(c=>bue(c,r));for(const c of e){const o=c.clone().translate(new Ga(t.center).negate()),f=s.map(x=>o.transform(x)),m=new ja().ortho({left:Math.min(...f.map(x=>x[0])),right:Math.max(...f.map(x=>x[0])),bottom:Math.min(...f.map(x=>x[1])),top:Math.max(...f.map(x=>x[1])),near:Math.min(...f.map(x=>-x[2])),far:Math.max(...f.map(x=>-x[2]))});n.push(m.multiplyRight(c))}return n}function Eue(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||_ue,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=gue({viewport:t.viewport,center:e.project_uCenter}),s=[],c=yue({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let o=0;o<t.shadowMatrices.length;o++){const f=c[o],m=f.clone().translate(new Ga(t.viewport.center).negate());e.project_uCoordinateSystem===qn.LNGLAT&&e.project_uProjectionMode===za.WEB_MERCATOR?(c[o]=m,s[o]=i):(c[o]=f.clone().multiplyRight(vue),s[o]=m.transform(i))}for(let o=0;o<c.length;o++)r["shadow_uViewProjectionMatrices[".concat(o,"]")]=c[o],r["shadow_uProjectCenters[".concat(o,"]")]=s[o],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(o)]=t.shadowMaps[o]:r["shadow_uShadowMap".concat(o)]=t.dummyShadowMap;return r}const Vx={name:"shadow",dependencies:[uR],vs:pue,fs:mue,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?Eue(t,e):{}},Tue={color:[255,255,255],intensity:1},$6=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Sue=[0,0,0,200/255];class XN{constructor(e={}){K(this,"id","lighting-effect"),K(this,"props",void 0),K(this,"shadowColor",Sue),K(this,"shadow",void 0),K(this,"ambientLight",void 0),K(this,"directionalLights",void 0),K(this,"pointLights",void 0),K(this,"shadowPasses",[]),K(this,"shadowMaps",[]),K(this,"dummyShadowMap",null),K(this,"programManager",void 0),K(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:c}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=aR.getDefaultProgramManager(e),Vx&&this.programManager.addDefaultModule(Vx)),this.dummyShadowMap||(this.dummyShadowMap=new xo(e,{width:1,height:1}));for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:c,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(Vx),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new ja().lookAt({eye:new Ga(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new Bce(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new $ce(Tue),this.directionalLights.push(new A6($6[0]),new A6($6[1])))}}class Aue{constructor(e={}){K(this,"_pool",[]),K(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:c=!1,initialize:o=!1,maxCount:f}){const m=i||e&&e.constructor||Float32Array,x=n*r+s;if(ArrayBuffer.isView(e)){if(x<=e.length)return e;if(x*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new m(e.buffer,0,x)}let S=1/0;f&&(S=f*r+s);const T=this._allocate(m,x,o,S);return e&&c?T.set(e):o||T.fill(0,0,4),this._release(e),T}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const c=this._pool,o=e.BYTES_PER_ELEMENT*s,f=c.findIndex(m=>m.byteLength>=o);if(f>=0){const m=new e(c.splice(f,1)[0],0,s);return r&&m.fill(0),m}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(c=>c.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const df=new Aue;function tm(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Pue(t){return[t[12],t[13],t[14]]}function Cue(t){return{left:Yd(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Yd(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Yd(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Yd(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Yd(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Yd(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const M6=new Ga;function Yd(t,e,n,r){M6.set(t,e,n);const i=M6.len();return{distance:r/i,normal:new Ga(-t/i,-e/i,-n/i)}}function Iue(t){return t-Math.fround(t)}let zp;function Gx(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;zp=df.allocate(zp,s,{type:Float32Array,size:n*2});let c=r,o=0;for(;c<i;){for(let f=0;f<n;f++){const m=t[c++];zp[o+f]=m,zp[o+f+n]=Iue(m)}o+=n*2}return zp.subarray(0,s*n*2)}function Lue(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const Rue=Math.PI/180,$ue=tm(),k6=[0,0,0],Mue={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function kue({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:c,far:o}){const f=t/e,m=n?new ja().orthographic({fovy:r,aspect:f,focalDistance:i,near:c,far:o}):new ja().perspective({fovy:r,aspect:f,near:c,far:o});if(s){const{left:x=0,right:S=0,top:T=0,bottom:C=0}=s,R=Tc((x+t-S)/2,0,t)-t/2,D=Tc((T+e-C)/2,0,e)-e/2;m[8]-=R*2/t,m[9]+=D*2/e}return m}class Tf{constructor(e={}){K(this,"id",void 0),K(this,"x",void 0),K(this,"y",void 0),K(this,"width",void 0),K(this,"height",void 0),K(this,"padding",void 0),K(this,"isGeospatial",void 0),K(this,"zoom",void 0),K(this,"focalDistance",void 0),K(this,"position",void 0),K(this,"modelMatrix",void 0),K(this,"distanceScales",void 0),K(this,"scale",void 0),K(this,"center",void 0),K(this,"cameraPosition",void 0),K(this,"projectionMatrix",void 0),K(this,"viewMatrix",void 0),K(this,"viewMatrixUncentered",void 0),K(this,"viewMatrixInverse",void 0),K(this,"viewProjectionMatrix",void 0),K(this,"pixelProjectionMatrix",void 0),K(this,"pixelUnprojectionMatrix",void 0),K(this,"resolution",void 0),K(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||Mue,this.focalDistance=e.focalDistance||1,this.position=e.position||k6,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?za.WEB_MERCATOR:za.WEB_MERCATOR_AUTO_OFFSET:za.IDENTITY}equals(e){return e instanceof Tf?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&qm(e.projectionMatrix,this.projectionMatrix)&&qm(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=qN(r,this.pixelProjectionMatrix),[s,c]=i,o=n?c:this.height-c;return e.length===2?[s,o]:[s,o,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,c]=e,o=n?s:this.height-s,f=r&&r*this.distanceScales.unitsPerMeter[2],m=hR([i,o,c],this.pixelUnprojectionMatrix,f),[x,S,T]=this.unprojectPosition(m);return Number.isFinite(c)?[x,S,T]:Number.isFinite(r)?[x,S,r]:[x,S]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=ev(e);return n[1]=Tc(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?uf(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),c=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],c[0]),Math.min(r[1],i[1],s[1],c[1]),Math.max(r[0],i[0],s[0],c[0]),Math.max(r[1],i[1],s[1],c[1])]}getDistanceScales(e){return e?sE({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,Cue(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=aue({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||sE({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:c}=e;let o=k6;if(s&&(o=c?new ja(c).transformAsVector(s,[]):s),this.isGeospatial){const f=this.projectPosition([n,r,0]);this.center=new Ga(o).scale(this.distanceScales.unitsPerMeter).add(f)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:n=$ue,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:c=75,near:o=.1,far:f=1e3,padding:m=null,focalDistance:x=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new ja().multiplyRight(n).translate(new Ga(this.center).negate()),this.projectionMatrix=r||kue({width:this.width,height:this.height,orthographic:i,fovyRadians:s||c*Rue,focalDistance:x,padding:m,near:o,far:f});const S=tm();Vu(S,S,this.projectionMatrix),Vu(S,S,this.viewMatrix),this.viewProjectionMatrix=S,this.viewMatrixInverse=tE([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=Pue(this.viewMatrixInverse);const T=tm(),C=tm();oR(T,T,[this.width/2,-this.height/2,1]),Y0(T,T,[1,-1,0]),Vu(C,T,this.viewProjectionMatrix),this.pixelProjectionMatrix=C,this.pixelUnprojectionMatrix=tE(tm(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Ln.warn("Pixel project matrix not invertible")()}}K(Tf,"displayName","Viewport");class ed extends Tf{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:c=0,nearZMultiplier:o=.1,farZMultiplier:f=1.01,orthographic:m=!1,projectionMatrix:x,repeat:S=!1,worldOffset:T=0,position:C,padding:R,legacyMeterSizes:D=!1}=e;let{width:H,height:F,altitude:k=1.5}=e;const N=Math.pow(2,i);H=H||1,F=F||1;let U,ie=null;if(x)k=x[5]/2,U=tv(k);else{e.fovy?(U=e.fovy,k=KN(U)):U=tv(k);let le;if(R){const{top:ve=0,bottom:Oe=0}=R;le=[0,Tc((ve+F-Oe)/2,0,F)-F/2]}ie=cue({width:H,height:F,scale:N,center:C&&[0,0,C[2]*Ux(n)],offset:le,pitch:s,fovy:U,nearZMultiplier:o,farZMultiplier:f})}let he=lue({height:F,pitch:s,bearing:c,scale:N,altitude:k});T&&(he=new ja().translate([512*T,0,0]).multiplyLeft(he)),super({...e,width:H,height:F,viewMatrix:he,longitude:r,latitude:n,zoom:i,...ie,fovy:U,focalDistance:k}),K(this,"longitude",void 0),K(this,"latitude",void 0),K(this,"pitch",void 0),K(this,"bearing",void 0),K(this,"altitude",void 0),K(this,"fovy",void 0),K(this,"orthographic",void 0),K(this,"_subViewports",void 0),K(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=c,this.altitude=k,this.fovy=U,this.orthographic=m,this._subViewports=S?[]:null,this._pseudoMeters=D,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new ed({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Ux(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Ux(r);return[n,r,i]}addMetersToLngLat(e,n){return WN(e,n)}panByPosition(e,n){const r=hR(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=b6([],i,lle([],r)),c=b6([],this.center,s),[o,f]=this.unprojectFlat(c);return{longitude:o,latitude:f}}getBounds(e={}){const n=hue(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:c,zoom:o}=uue({width:r,height:i,bounds:e,...n});return new ed({width:r,height:i,longitude:s,latitude:c,zoom:o})}}K(ed,"displayName","WebMercatorViewport");const O6=[0,0,0];function jx(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof ed){const[i,s,c=0]=t,o=e.getDistanceScales([i,s]);r[2]=c*o.unitsPerMeter[2]}return r}function Oue(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:c}=t;return i===qn.DEFAULT&&(i=e.isGeospatial?qn.LNGLAT:qn.CARTESIAN),s===void 0&&(s=i),c===void 0&&(c=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:c}}function ZN(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[c,o,f=0]=t;switch(n&&([c,o,f]=Pg([],[c,o,f,1],n)),r){case qn.LNGLAT:return jx([c,o,f],e,s);case qn.LNGLAT_OFFSETS:return jx([c+i[0],o+i[1],f+(i[2]||0)],e,s);case qn.METER_OFFSETS:return jx(WN(i,[c,o,f]),e,s);case qn.CARTESIAN:default:return e.isGeospatial?[c+i[0],o+i[1],f+i[2]]:e.projectPosition([c,o,f])}}function Due(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:c,fromCoordinateOrigin:o}=Oue(e),{autoOffset:f=!0}=e,{geospatialOrigin:m=O6,shaderCoordinateOrigin:x=O6,offsetMode:S=!1}=f?jN(n,r,i):{},T=ZN(t,{viewport:n,modelMatrix:s,coordinateSystem:c,coordinateOrigin:o,offsetMode:S});if(S){const C=n.projectPosition(m||x);Ele(T,T,C)}return T}const D6={blendFunc:[1,0,32771,0],blendEquation:32774};class YN extends cR{constructor(...e){super(...e),K(this,"pickZ",void 0),K(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:c,deviceRect:{x:o,y:f,width:m,height:x},cullRect:S,effects:T,pass:C="picking",pickZ:R,moduleParameters:D}){const H=this.gl;this.pickZ=R;const F=this._resetColorEncoder(R),k=da(H,{scissorTest:!0,scissor:[o,f,m,x],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...D6,blend:!R},()=>super.render({target:c,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:S,effects:T==null?void 0:T.filter(U=>U.useInPicking),pass:C,isPicking:!0,moduleParameters:D}));return this._colorEncoderState=null,{decodePickingColor:F&&zue.bind(null,F),stats:k}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:c}=e.props;return this._colorEncoderState?s&&c.includes("draw")&&(Object.assign(i,D6),i.blend=!0,i.blendColor=Fue(this._colorEncoderState,e,r)):i.blend=!1,c.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function Fue(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,c=r.get(e);return c?(c.viewports.push(n),s=c.a):(s=r.size+1,s<=255?(c={a:s,layer:e,viewports:[n]},r.set(e,c),i[s]=c):(Ln.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function zue(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const ch={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},nv=Symbol.for("component"),Dc=Symbol.for("propTypes"),Hx=Symbol.for("deprecatedProps"),Nh=Symbol.for("asyncPropDefaults"),td=Symbol.for("asyncPropOriginal"),Sc=Symbol.for("asyncPropResolved");function fR(t,e=()=>!0){return Array.isArray(t)?JN(t,e,[]):e(t)?[t]:[]}function JN(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?JN(i,e,n):e(i)&&n.push(i)}return n}function Nue({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let c=0;for(let o=n;c<i;c++)t[o++]=e[c];for(;c<s;)c<s-c?(t.copyWithin(n+c,n,n+c),c*=2):(t.copyWithin(n+c,n,n+s-c),c=s);return t}let Bue=class{constructor(e,n,r){K(this,"id",void 0),K(this,"context",void 0),K(this,"isLoaded",void 0),K(this,"persistent",void 0),K(this,"_loadCount",0),K(this,"_subscribers",new Set),K(this,"_data",void 0),K(this,"_loader",void 0),K(this,"_error",void 0),K(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=K0(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}};class Uue{constructor({gl:e,protocol:n}){K(this,"protocol",void 0),K(this,"_context",void 0),K(this,"_resources",void 0),K(this,"_consumers",void 0),K(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new Bue(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:c}=this;e.startsWith(c)&&(e=e.replace(c,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=s[e];if(this._track(r,i,o,n),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,c=s[e]=s[e]||{},o=c[n]||{},f=o.resourceId&&this._resources[o.resourceId];f&&(f.unsubscribe(o),this.prune()),r&&(c[n]=o,o.onChange=i,o.resourceId=r.id,r.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const Vue=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Lg={name:"project32",dependencies:[uR],vs:Vue},Rg={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...Qle},Gue=[uR],jue=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function Hue(t){const e=aR.getDefaultProgramManager(t);for(const n of Gue)e.addDefaultModule(n);for(const n of jue)e.addShaderHook(n);return e}const Wue="layerManager.setLayers",Kue="layerManager.activateViewport";class que{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){K(this,"layers",void 0),K(this,"context",void 0),K(this,"resourceManager",void 0),K(this,"_lastRenderedLayers",[]),K(this,"_needsRedraw",!1),K(this,"_needsUpdate",!1),K(this,"_nextLayers",null),K(this,"_debug",!1),K(this,"activateViewport",c=>{us(Kue,this,c),c&&(this.context.viewport=c)}),this.layers=[],this.resourceManager=new Uue({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&Hue(e),stats:r||new WL({id:"deck.gl"}),viewport:i||new Tf({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new NN,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){us(Wue,this,n,e),this._lastRenderedLayers=e;const r=fR(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const c of e)r[c.id]?Ln.warn("Multiple old layers with same id ".concat(c.id))():r[c.id]=c;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const c of i)if(c.hasUniformTransition()){s="Uniform transition in ".concat(c);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&Ln.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let c=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),c=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}c&&this._updateSublayersRecursively(c,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=ch.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=ch.MATCHED,n!==e&&(e.lifecycle=ch.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=ch.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=ch.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Na(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Na(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Na(t[s],e[s],n-1))return!1;return!0}return!1}class Xue{constructor(e){K(this,"width",void 0),K(this,"height",void 0),K(this,"views",void 0),K(this,"viewState",void 0),K(this,"controllers",void 0),K(this,"timeline",void 0),K(this,"_viewports",void 0),K(this,"_viewportMap",void 0),K(this,"_isUpdating",void 0),K(this,"_needsRedraw",void 0),K(this,"_needsUpdate",void 0),K(this,"_eventManager",void 0),K(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const c=r[s];if(c.containsPixel(i)){const o=e.slice();return o[0]-=c.x,o[1]-=c.y,c.unproject(o,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=fR(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Na(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Ln.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var c;return(c=this.getView(e.id))===null||c===void 0?void 0:c.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const c={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return i||(i=this._createController(e,c)),i&&i.setProps(c),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],c=this.getViewState(s),o=s.makeViewport({viewState:c,width:this.width,height:this.height});let f=n[s.id];const m=!!s.controller;m&&!f&&(r=!0),(r||!m)&&f&&(f.finalize(),f=null),this.controllers[s.id]=this._updateController(s,c,o,f),o&&this._viewports.unshift(o)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const Zue=/([0-9]+\.?[0-9]*)(%|px)/;function uc(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=Zue.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function dc(t,e){return t.relative?Math.round(t.position*e):t.position}function Di(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class hf{constructor(e){K(this,"id",void 0),K(this,"viewportInstance",void 0),K(this,"_x",void 0),K(this,"_y",void 0),K(this,"_width",void 0),K(this,"_height",void 0),K(this,"_padding",void 0),K(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:c="100%",padding:o=null,viewportInstance:f}=e||{};Di(!f||f instanceof Tf),this.viewportInstance=f,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=uc(r),this._y=uc(i),this._width=uc(s),this._height=uc(c),this._padding=o&&{left:uc(o.left||0),right:uc(o.right||0),top:uc(o.top||0),bottom:uc(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&Na(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:dc(this._x,e),y:dc(this._y,n),width:dc(this._width,e),height:dc(this._height,n)};return this._padding&&(r.padding={left:dc(this._padding.left,e),top:dc(this._padding.top,n),right:dc(this._padding.right,e),bottom:dc(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let $g=class{constructor(e){K(this,"_inProgress",void 0),K(this,"_handle",void 0),K(this,"_timeline",void 0),K(this,"time",void 0),K(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const F6=()=>{},oE={BREAK:1,SNAP_TO_END:2,IGNORE:3},Yue=t=>t,Jue=oE.BREAK;class Que{constructor(e){K(this,"getControllerState",void 0),K(this,"props",void 0),K(this,"propsInTransition",void 0),K(this,"transition",void 0),K(this,"onViewStateChange",void 0),K(this,"onStateChange",void 0),K(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:c,duration:o,easing:f}}=n,m=f(r/o),x=i.interpolateProps(s,c,m);this.propsInTransition=this.getControllerState({...this.props,...x}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new $g(e.timeline),this.onViewStateChange=e.onViewStateChange||F6,this.onStateChange=e.onStateChange||F6}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:c}=this.transition.settings;i={...r,...s===oE.SNAP_TO_END?c:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===oE.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,c=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(c===0)return;const o=s.initializeProps(e,i);this.propsInTransition={};const f={duration:c,easing:n.transitionEasing||Yue,interpolator:s,interruption:n.transitionInterruption||Jue,startProps:o.start,endProps:o.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(f),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class ede{constructor(e){K(this,"_propsToCompare",void 0),K(this,"_propsToExtract",void 0),K(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!qm(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Di(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const tde=["longitude","latitude","zoom","bearing","pitch"],nde=["longitude","latitude","zoom"];class QN extends ede{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:tde,required:nde},super(r.transitionProps),K(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const c=i(e),o=i(n),f=c.unproject(s);r.start.around=s,Object.assign(r.end,{around:o.project(f),aroundPosition:f,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Z0(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Z0(e.around,n.around,r)))}return i}}const hc={transitionDuration:0},rde=300,__=t=>1-(1-t)*(1-t),Jd={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Tu={};class ide{constructor(e){K(this,"props",void 0),K(this,"state",{}),K(this,"transitionManager",void 0),K(this,"eventManager",void 0),K(this,"onViewStateChange",void 0),K(this,"onStateChange",void 0),K(this,"makeViewport",void 0),K(this,"_controllerState",void 0),K(this,"_events",{}),K(this,"_interactionState",{isDragging:!1}),K(this,"_customEvents",[]),K(this,"_eventStartBlocked",null),K(this,"_panMove",!1),K(this,"invertPan",!1),K(this,"dragMode","rotate"),K(this,"inertia",0),K(this,"scrollZoom",!0),K(this,"dragPan",!0),K(this,"dragRotate",!0),K(this,"doubleClickZoom",!0),K(this,"touchZoom",!0),K(this,"touchRotate",!1),K(this,"keyboard",!0),this.transitionManager=new Que({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?rde:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:c=!0,touchZoom:o=!0,touchRotate:f=!1,keyboard:m=!0}=e,x=!!this.onViewStateChange;this.toggleEvents(Jd.WHEEL,x&&r),this.toggleEvents(Jd.PAN,x&&(i||s)),this.toggleEvents(Jd.PINCH,x&&(o||f)),this.toggleEvents(Jd.TRIPLE_PAN,x&&f),this.toggleEvents(Jd.DOUBLE_TAP,x&&c),this.toggleEvents(Jd.KEYBOARD,x&&m),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=c,this.touchZoom=o,this.touchRotate=f,this.keyboard=m}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const c=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:c})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,hc,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,hc,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:__},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,hc,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:__},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let c=2/(1+Math.exp(-Math.abs(s*r)));s<0&&c!==0&&(c=1/c);const o=this.controllerState.zoom({pos:n,scale:c});return this.updateViewport(o,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,hc,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,hc,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:__},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Tu._startPinchRotation=e.rotation,Tu._lastPinchEvent=e,this.updateViewport(r,hc,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Tu._startPinchRotation-r})}return this.updateViewport(n,hc,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Tu._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Tu;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const c=Math.log2(e.scale),o=(c-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),f=Math.pow(2,c+o*n/2);s=s.zoom({pos:i,scale:f}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:__},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Tu._startPinchRotation=null,Tu._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:c}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let f;const m={};switch(e.srcEvent.code){case"Minus":f=n?o.zoomOut(r).zoomOut(r):o.zoomOut(r),m.isZooming=!0;break;case"Equal":f=n?o.zoomIn(r).zoomIn(r):o.zoomIn(r),m.isZooming=!0;break;case"ArrowLeft":n?(f=o.rotateLeft(s),m.isRotating=!0):(f=o.moveLeft(i),m.isPanning=!0);break;case"ArrowRight":n?(f=o.rotateRight(s),m.isRotating=!0):(f=o.moveRight(i),m.isPanning=!0);break;case"ArrowUp":n?(f=o.rotateUp(c),m.isRotating=!0):(f=o.moveUp(i),m.isPanning=!0);break;case"ArrowDown":n?(f=o.rotateDown(c),m.isRotating=!0):(f=o.moveDown(i),m.isPanning=!0);break;default:return!1}return this.updateViewport(f,this._getTransitionProps(),m),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?hc:e?{...n,transitionInterpolator:new QN({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class sde{constructor(e,n){K(this,"_viewportProps",void 0),K(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const z6=5,ode=1.2;class ade extends sde{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:c,bearing:o=0,pitch:f=0,altitude:m=1.5,position:x=[0,0,0],maxZoom:S=20,minZoom:T=0,maxPitch:C=60,minPitch:R=0,startPanLngLat:D,startZoomLngLat:H,startRotatePos:F,startBearing:k,startPitch:N,startZoom:U,normalize:ie=!0}=e;Di(Number.isFinite(s)),Di(Number.isFinite(i)),Di(Number.isFinite(c)),super({width:n,height:r,latitude:i,longitude:s,zoom:c,bearing:o,pitch:f,altitude:m,maxZoom:S,minZoom:T,maxPitch:C,minPitch:R,normalize:ie,position:x},{startPanLngLat:D,startZoomLngLat:H,startRotatePos:F,startBearing:k,startPitch:N,startZoom:U}),K(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:c}=this.getState();if(!i||s===void 0||c===void 0)return this;let o;return e?o=this._getNewRotation(e,i,c,s):o={bearing:s+n,pitch:c+r},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:c,minZoom:o}=this.getViewportProps();let f=i+Math.log2(r);f=Tc(f,o,c);const m=this.makeViewport({...this.getViewportProps(),zoom:f});return this._getUpdatedState({zoom:f,...m.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Tc(i,r,n);const{maxPitch:s,minPitch:c,pitch:o}=e;e.pitch=Tc(o,c,s);const{normalize:f=!0}=e;return f&&Object.assign(e,fue(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],c=e[1]-n[1],o=e[1],f=n[1],{width:m,height:x}=this.getViewportProps(),S=s/m;let T=0;c>0?Math.abs(x-f)>z6&&(T=c/(f-x)*ode):c<0&&f>z6&&(T=1-o/f),T=Tc(T,-1,1);const{minPitch:C,maxPitch:R}=this.getViewportProps(),D=i+180*S;let H=r;return T>0?H=r+T*(R-r):T<0&&(H=r-T*(C-r)),{pitch:H,bearing:D}}}class lde extends ide{constructor(...e){super(...e),K(this,"ControllerState",ade),K(this,"transition",{transitionDuration:300,transitionInterpolator:new QN({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),K(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}let eB=class extends hf{get ViewportType(){return ed}get ControllerType(){return lde}};K(eB,"displayName","MapView");const cde=new XN;function ude(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class dde{constructor(){K(this,"effects",void 0),K(this,"_resolvedEffects",[]),K(this,"_defaultEffects",[]),K(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>ude(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Na(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof XN)||this._resolvedEffects.push(cde),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class hde extends cR{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const fde="deckRenderer.renderLayers";class pde{constructor(e){K(this,"gl",void 0),K(this,"layerFilter",void 0),K(this,"drawPickingColors",void 0),K(this,"drawLayersPass",void 0),K(this,"pickLayersPass",void 0),K(this,"renderCount",void 0),K(this,"_needsRedraw",void 0),K(this,"renderBuffers",void 0),K(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new hde(e),this.pickLayersPass=new YN(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||Yi.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,us(fde,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new Yi(this.gl),new Yi(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const c=s.postRender(this.gl,i);i.inputBuffer=c,i.swapBuffer=c===r[0]?r[1]:r[0]}}}const mde={pickedColor:null,pickedObjectIndex:-1};function gde({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:c,y:o,width:f,height:m}=s;let x=i*i,S=-1,T=0;for(let C=0;C<m;C++){const R=C+o-r,D=R*R;if(D>x)T+=4*f;else for(let H=0;H<f;H++){if(t[T+3]-1>=0){const k=H+c-n,N=k*k+D;N<=x&&(x=N,S=T)}T+=4}}if(S>=0){const C=t.slice(S,S+4),R=e(C);if(R){const D=Math.floor(S/4/f),H=S/4-D*f;return{...R,pickedColor:C,pickedX:c+H,pickedY:o+D}}Ln.error("Picked non-existent layer. Is picking buffer corrupt?")()}return mde}function yde({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),c=s.join(",");if(!n.has(c)){const o=e(s);o?n.set(c,{...o,color:s}):Ln.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function tB({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let c=e[0];e.length>1&&(c=vde((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let o;if(c){const f=[r-c.x,i-c.y];s!==void 0&&(f[2]=s),o=c.unproject(f)}return{color:null,layer:null,viewport:c,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function _de(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:c,pickedObjectIndex:o}=e,f=c?[c]:[];if(r==="hover"){const S=n.index,T=n.layerId,C=c?c.props.id:null;if(C!==T||o!==S){if(C!==T){const R=i.find(D=>D.props.id===T);R&&f.unshift(R)}n.layerId=C,n.index=o,n.info=null}}const m=tB(t),x=new Map;return x.set(null,m),f.forEach(S=>{let T={...m};S===c&&(T.color=s,T.index=o,T.picked=!0),T=nB({layer:S,info:T,mode:r});const C=T.layer;S===c&&r==="hover"&&(n.info=T),x.set(C.id,T),r==="hover"&&C.updateAutoHighlight(T)}),x}function nB({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function vde(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class bde{constructor(e){K(this,"gl",void 0),K(this,"pickingFBO",void 0),K(this,"depthFBO",void 0),K(this,"pickLayersPass",void 0),K(this,"layerFilter",void 0),K(this,"lastPickedInfo",void 0),K(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new YN(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const c=s&&s.layer&&s.layer.id,o=s&&s.viewport&&s.viewport.id,f=c?r.find(T=>T.id===c):null,m=o&&i.find(T=>T.id===o)||i[0],x=m&&m.unproject([e-m.x,n-m.y]);return{...s,...{x:e,y:n,viewport:m,coordinate:x,layer:f}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new Yi(r),Yi.isSupported(r,{colorBufferFloat:!0}))){const i=new Yi(r);i.attach({[36064]:new xo(r,{format:Mn(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:c=0,depth:o=1,mode:f="query",unproject3D:m,onViewportActive:x,effects:S}){const T=this._getPickable(e),C=rf(this.gl);if(!T)return{result:[],emptyInfo:tB({viewports:r,x:i,y:s,pixelRatio:C})};this._resizeBuffer();const R=Ax(this.gl,[i,s],!0),D=[R.x+Math.floor(R.width/2),R.y+Math.floor(R.height/2)],H=Math.round(c*C),{width:F,height:k}=this.pickingFBO,N=this._getPickingRect({deviceX:D[0],deviceY:D[1],deviceRadius:H,deviceWidth:F,deviceHeight:k}),U={x:i-c,y:s-c,width:c*2+1,height:c*2+1};let ie;const he=[],le=new Set;for(let ve=0;ve<o;ve++){let Oe;if(N){const Ee=this._drawAndSample({layers:T,views:n,viewports:r,onViewportActive:x,deviceRect:N,cullRect:U,effects:S,pass:"picking:".concat(f)});Oe=gde({...Ee,deviceX:D[0],deviceY:D[1],deviceRadius:H,deviceRect:N})}else Oe={pickedColor:null,pickedObjectIndex:-1};let Re;if(Oe.pickedLayer&&m&&this.depthFBO){const{pickedColors:Ee}=this._drawAndSample({layers:[Oe.pickedLayer],views:n,viewports:r,onViewportActive:x,deviceRect:{x:Oe.pickedX,y:Oe.pickedY,width:1,height:1},cullRect:U,effects:S,pass:"picking:".concat(f,":z")},!0);Ee[3]&&(Re=Ee[0])}Oe.pickedLayer&&ve+1<o&&(le.add(Oe.pickedLayer),Oe.pickedLayer.disablePickingIndex(Oe.pickedObjectIndex)),ie=_de({pickInfo:Oe,lastPickedInfo:this.lastPickedInfo,mode:f,layers:T,viewports:r,x:i,y:s,z:Re,pixelRatio:C});for(const Ee of ie.values())Ee.layer&&he.push(Ee);if(!Oe.pickedColor)break}for(const ve of le)ve.restorePickingColors();return{result:he,emptyInfo:ie.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:c=1,height:o=1,mode:f="query",maxObjects:m=null,onViewportActive:x,effects:S}){const T=this._getPickable(e);if(!T)return[];this._resizeBuffer();const C=rf(this.gl),R=Ax(this.gl,[i,s],!0),D=R.x,H=R.y+R.height,F=Ax(this.gl,[i+c,s+o],!0),k=F.x+F.width,N=F.y,U={x:D,y:N,width:k-D,height:H-N},ie=this._drawAndSample({layers:T,views:n,viewports:r,onViewportActive:x,deviceRect:U,cullRect:{x:i,y:s,width:c,height:o},effects:S,pass:"picking:".concat(f)}),he=yde(ie),le=new Map,ve=Number.isFinite(m);for(let Oe=0;Oe<he.length&&!(ve&&m&&le.size>=m);Oe++){const Re=he[Oe];let Ee={color:Re.pickedColor,layer:null,index:Re.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:C};Ee=nB({layer:Re.pickedLayer,info:Ee,mode:f}),le.has(Ee.object)||le.set(Ee.object,Ee)}return Array.from(le.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:c,effects:o,pass:f},m=!1){const x=m?this.depthFBO:this.pickingFBO,S={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:x,deviceRect:s,cullRect:c,effects:o,pass:f,pickZ:m,preRenderStats:{}};for(const k of o)k.useInPicking&&(S.preRenderStats[k.id]=k.preRender(this.gl,S));const{decodePickingColor:T}=this.pickLayersPass.render(S),{x:C,y:R,width:D,height:H}=s,F=new(m?Float32Array:Uint8Array)(D*H*4);return fb(x,{sourceX:C,sourceY:R,sourceWidth:D,sourceHeight:H,target:F}),{pickedColors:F,decodePickingColor:T}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const c=Math.max(0,e-r),o=Math.max(0,n-r),f=Math.min(i,e+r+1)-c,m=Math.min(s,n+r+1)-o;return f<=0||m<=0?null:{x:c,y:o,width:f,height:m}}}const xde={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class wde{constructor(e){K(this,"el",null),K(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,xde),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className),Object.assign(i.style,e.style);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}var nd={},Ede={get exports(){return nd},set exports(t){nd=t}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],c=n.createElement("div"),o="function",f=Math.round,m=Math.abs,x=Date.now;function S(Z,ne,ge){return setTimeout(N(Z,ge),ne)}function T(Z,ne,ge){return Array.isArray(Z)?(C(Z,ge[ne],ge),!0):!1}function C(Z,ne,ge){var Ne;if(Z)if(Z.forEach)Z.forEach(ne,ge);else if(Z.length!==i)for(Ne=0;Ne<Z.length;)ne.call(ge,Z[Ne],Ne,Z),Ne++;else for(Ne in Z)Z.hasOwnProperty(Ne)&&ne.call(ge,Z[Ne],Ne,Z)}function R(Z,ne,ge){var Ne="DEPRECATED METHOD: "+ne+`
`+ge+` AT 
`;return function(){var nt=new Error("get-stack-trace"),Lt=nt&&nt.stack?nt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",pn=e.console&&(e.console.warn||e.console.log);return pn&&pn.call(e.console,Ne,Lt),Z.apply(this,arguments)}}var D;typeof Object.assign!="function"?D=function(ne){if(ne===i||ne===null)throw new TypeError("Cannot convert undefined or null to object");for(var ge=Object(ne),Ne=1;Ne<arguments.length;Ne++){var nt=arguments[Ne];if(nt!==i&&nt!==null)for(var Lt in nt)nt.hasOwnProperty(Lt)&&(ge[Lt]=nt[Lt])}return ge}:D=Object.assign;var H=R(function(ne,ge,Ne){for(var nt=Object.keys(ge),Lt=0;Lt<nt.length;)(!Ne||Ne&&ne[nt[Lt]]===i)&&(ne[nt[Lt]]=ge[nt[Lt]]),Lt++;return ne},"extend","Use `assign`."),F=R(function(ne,ge){return H(ne,ge,!0)},"merge","Use `assign`.");function k(Z,ne,ge){var Ne=ne.prototype,nt;nt=Z.prototype=Object.create(Ne),nt.constructor=Z,nt._super=Ne,ge&&D(nt,ge)}function N(Z,ne){return function(){return Z.apply(ne,arguments)}}function U(Z,ne){return typeof Z==o?Z.apply(ne&&ne[0]||i,ne):Z}function ie(Z,ne){return Z===i?ne:Z}function he(Z,ne,ge){C(Re(ne),function(Ne){Z.addEventListener(Ne,ge,!1)})}function le(Z,ne,ge){C(Re(ne),function(Ne){Z.removeEventListener(Ne,ge,!1)})}function ve(Z,ne){for(;Z;){if(Z==ne)return!0;Z=Z.parentNode}return!1}function Oe(Z,ne){return Z.indexOf(ne)>-1}function Re(Z){return Z.trim().split(/\s+/g)}function Ee(Z,ne,ge){if(Z.indexOf&&!ge)return Z.indexOf(ne);for(var Ne=0;Ne<Z.length;){if(ge&&Z[Ne][ge]==ne||!ge&&Z[Ne]===ne)return Ne;Ne++}return-1}function $e(Z){return Array.prototype.slice.call(Z,0)}function we(Z,ne,ge){for(var Ne=[],nt=[],Lt=0;Lt<Z.length;){var pn=ne?Z[Lt][ne]:Z[Lt];Ee(nt,pn)<0&&Ne.push(Z[Lt]),nt[Lt]=pn,Lt++}return ge&&(ne?Ne=Ne.sort(function(un,Nr){return un[ne]>Nr[ne]}):Ne=Ne.sort()),Ne}function Be(Z,ne){for(var ge,Ne,nt=ne[0].toUpperCase()+ne.slice(1),Lt=0;Lt<s.length;){if(ge=s[Lt],Ne=ge?ge+nt:ne,Ne in Z)return Ne;Lt++}return i}var Jt=1;function mt(){return Jt++}function an(Z){var ne=Z.ownerDocument||Z;return ne.defaultView||ne.parentWindow||e}var ot=/mobile|tablet|ip(ad|hone|od)|android/i,It="ontouchstart"in e,at=Be(e,"PointerEvent")!==i,kt=It&&ot.test(navigator.userAgent),Pe="touch",Ke="pen",Je="mouse",Ot="kinect",ht=25,Ct=1,Zt=2,lt=4,en=8,Nn=1,Et=2,Dt=4,mn=8,Mr=16,Hn=Et|Dt,Qn=mn|Mr,Zs=Hn|Qn,gn=["x","y"],ni=["clientX","clientY"];function gr(Z,ne){var ge=this;this.manager=Z,this.callback=ne,this.element=Z.element,this.target=Z.options.inputTarget,this.domHandler=function(Ne){U(Z.options.enable,[Z])&&ge.handler(Ne)},this.init()}gr.prototype={handler:function(){},init:function(){this.evEl&&he(this.element,this.evEl,this.domHandler),this.evTarget&&he(this.target,this.evTarget,this.domHandler),this.evWin&&he(an(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&le(this.element,this.evEl,this.domHandler),this.evTarget&&le(this.target,this.evTarget,this.domHandler),this.evWin&&le(an(this.element),this.evWin,this.domHandler)}};function ms(Z){var ne,ge=Z.options.inputClass;return ge?ne=ge:at?ne=Ut:kt?ne=xi:It?ne=re:ne=Ye,new ne(Z,Ho)}function Ho(Z,ne,ge){var Ne=ge.pointers.length,nt=ge.changedPointers.length,Lt=ne&Ct&&Ne-nt===0,pn=ne&(lt|en)&&Ne-nt===0;ge.isFirst=!!Lt,ge.isFinal=!!pn,Lt&&(Z.session={}),ge.eventType=ne,Ui(Z,ge),Z.emit("hammer.input",ge),Z.recognize(ge),Z.session.prevInput=ge}function Ui(Z,ne){var ge=Z.session,Ne=ne.pointers,nt=Ne.length;ge.firstInput||(ge.firstInput=Qi(ne)),nt>1&&!ge.firstMultiple?ge.firstMultiple=Qi(ne):nt===1&&(ge.firstMultiple=!1);var Lt=ge.firstInput,pn=ge.firstMultiple,yr=pn?pn.center:Lt.center,un=ne.center=je(Ne);ne.timeStamp=x(),ne.deltaTime=ne.timeStamp-Lt.timeStamp,ne.angle=ln(yr,un),ne.distance=di(yr,un),Vi(ge,ne),ne.offsetDirection=Ms(ne.deltaX,ne.deltaY);var Nr=dt(ne.deltaTime,ne.deltaX,ne.deltaY);ne.overallVelocityX=Nr.x,ne.overallVelocityY=Nr.y,ne.overallVelocity=m(Nr.x)>m(Nr.y)?Nr.x:Nr.y,ne.scale=pn?bi(pn.pointers,Ne):1,ne.rotation=pn?Li(pn.pointers,Ne):0,ne.maxPointers=ge.prevInput?ne.pointers.length>ge.prevInput.maxPointers?ne.pointers.length:ge.prevInput.maxPointers:ne.pointers.length,So(ge,ne);var gs=Z.element;ve(ne.srcEvent.target,gs)&&(gs=ne.srcEvent.target),ne.target=gs}function Vi(Z,ne){var ge=ne.center,Ne=Z.offsetDelta||{},nt=Z.prevDelta||{},Lt=Z.prevInput||{};(ne.eventType===Ct||Lt.eventType===lt)&&(nt=Z.prevDelta={x:Lt.deltaX||0,y:Lt.deltaY||0},Ne=Z.offsetDelta={x:ge.x,y:ge.y}),ne.deltaX=nt.x+(ge.x-Ne.x),ne.deltaY=nt.y+(ge.y-Ne.y)}function So(Z,ne){var ge=Z.lastInterval||ne,Ne=ne.timeStamp-ge.timeStamp,nt,Lt,pn,yr;if(ne.eventType!=en&&(Ne>ht||ge.velocity===i)){var un=ne.deltaX-ge.deltaX,Nr=ne.deltaY-ge.deltaY,gs=dt(Ne,un,Nr);Lt=gs.x,pn=gs.y,nt=m(gs.x)>m(gs.y)?gs.x:gs.y,yr=Ms(un,Nr),Z.lastInterval=ne}else nt=ge.velocity,Lt=ge.velocityX,pn=ge.velocityY,yr=ge.direction;ne.velocity=nt,ne.velocityX=Lt,ne.velocityY=pn,ne.direction=yr}function Qi(Z){for(var ne=[],ge=0;ge<Z.pointers.length;)ne[ge]={clientX:f(Z.pointers[ge].clientX),clientY:f(Z.pointers[ge].clientY)},ge++;return{timeStamp:x(),pointers:ne,center:je(ne),deltaX:Z.deltaX,deltaY:Z.deltaY}}function je(Z){var ne=Z.length;if(ne===1)return{x:f(Z[0].clientX),y:f(Z[0].clientY)};for(var ge=0,Ne=0,nt=0;nt<ne;)ge+=Z[nt].clientX,Ne+=Z[nt].clientY,nt++;return{x:f(ge/ne),y:f(Ne/ne)}}function dt(Z,ne,ge){return{x:ne/Z||0,y:ge/Z||0}}function Ms(Z,ne){return Z===ne?Nn:m(Z)>=m(ne)?Z<0?Et:Dt:ne<0?mn:Mr}function di(Z,ne,ge){ge||(ge=gn);var Ne=ne[ge[0]]-Z[ge[0]],nt=ne[ge[1]]-Z[ge[1]];return Math.sqrt(Ne*Ne+nt*nt)}function ln(Z,ne,ge){ge||(ge=gn);var Ne=ne[ge[0]]-Z[ge[0]],nt=ne[ge[1]]-Z[ge[1]];return Math.atan2(nt,Ne)*180/Math.PI}function Li(Z,ne){return ln(ne[1],ne[0],ni)+ln(Z[1],Z[0],ni)}function bi(Z,ne){return di(ne[0],ne[1],ni)/di(Z[0],Z[1],ni)}var Me={mousedown:Ct,mousemove:Zt,mouseup:lt},Ae="mousedown",Ce="mousemove mouseup";function Ye(){this.evEl=Ae,this.evWin=Ce,this.pressed=!1,gr.apply(this,arguments)}k(Ye,gr,{handler:function(ne){var ge=Me[ne.type];ge&Ct&&ne.button===0&&(this.pressed=!0),ge&Zt&&ne.which!==1&&(ge=lt),this.pressed&&(ge&lt&&(this.pressed=!1),this.callback(this.manager,ge,{pointers:[ne],changedPointers:[ne],pointerType:Je,srcEvent:ne}))}});var Ze={pointerdown:Ct,pointermove:Zt,pointerup:lt,pointercancel:en,pointerout:en},gt={2:Pe,3:Ke,4:Je,5:Ot},Ht="pointerdown",it="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ht="MSPointerDown",it="MSPointerMove MSPointerUp MSPointerCancel");function Ut(){this.evEl=Ht,this.evWin=it,gr.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}k(Ut,gr,{handler:function(ne){var ge=this.store,Ne=!1,nt=ne.type.toLowerCase().replace("ms",""),Lt=Ze[nt],pn=gt[ne.pointerType]||ne.pointerType,yr=pn==Pe,un=Ee(ge,ne.pointerId,"pointerId");Lt&Ct&&(ne.button===0||yr)?un<0&&(ge.push(ne),un=ge.length-1):Lt&(lt|en)&&(Ne=!0),!(un<0)&&(ge[un]=ne,this.callback(this.manager,Lt,{pointers:ge,changedPointers:[ne],pointerType:pn,srcEvent:ne}),Ne&&ge.splice(un,1))}});var Wt={touchstart:Ct,touchmove:Zt,touchend:lt,touchcancel:en},Dn="touchstart",An="touchstart touchmove touchend touchcancel";function Pn(){this.evTarget=Dn,this.evWin=An,this.started=!1,gr.apply(this,arguments)}k(Pn,gr,{handler:function(ne){var ge=Wt[ne.type];if(ge===Ct&&(this.started=!0),!!this.started){var Ne=on.call(this,ne,ge);ge&(lt|en)&&Ne[0].length-Ne[1].length===0&&(this.started=!1),this.callback(this.manager,ge,{pointers:Ne[0],changedPointers:Ne[1],pointerType:Pe,srcEvent:ne})}}});function on(Z,ne){var ge=$e(Z.touches),Ne=$e(Z.changedTouches);return ne&(lt|en)&&(ge=we(ge.concat(Ne),"identifier",!0)),[ge,Ne]}var qr={touchstart:Ct,touchmove:Zt,touchend:lt,touchcancel:en},ri="touchstart touchmove touchend touchcancel";function xi(){this.evTarget=ri,this.targetIds={},gr.apply(this,arguments)}k(xi,gr,{handler:function(ne){var ge=qr[ne.type],Ne=Gi.call(this,ne,ge);Ne&&this.callback(this.manager,ge,{pointers:Ne[0],changedPointers:Ne[1],pointerType:Pe,srcEvent:ne})}});function Gi(Z,ne){var ge=$e(Z.touches),Ne=this.targetIds;if(ne&(Ct|Zt)&&ge.length===1)return Ne[ge[0].identifier]=!0,[ge,ge];var nt,Lt,pn=$e(Z.changedTouches),yr=[],un=this.target;if(Lt=ge.filter(function(Nr){return ve(Nr.target,un)}),ne===Ct)for(nt=0;nt<Lt.length;)Ne[Lt[nt].identifier]=!0,nt++;for(nt=0;nt<pn.length;)Ne[pn[nt].identifier]&&yr.push(pn[nt]),ne&(lt|en)&&delete Ne[pn[nt].identifier],nt++;if(yr.length)return[we(Lt.concat(yr),"identifier",!0),yr]}var es=2500,Ao=25;function re(){gr.apply(this,arguments);var Z=N(this.handler,this);this.touch=new xi(this.manager,Z),this.mouse=new Ye(this.manager,Z),this.primaryTouch=null,this.lastTouches=[]}k(re,gr,{handler:function(ne,ge,Ne){var nt=Ne.pointerType==Pe,Lt=Ne.pointerType==Je;if(!(Lt&&Ne.sourceCapabilities&&Ne.sourceCapabilities.firesTouchEvents)){if(nt)z.call(this,ge,Ne);else if(Lt&&Q.call(this,Ne))return;this.callback(ne,ge,Ne)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function z(Z,ne){Z&Ct?(this.primaryTouch=ne.changedPointers[0].identifier,j.call(this,ne)):Z&(lt|en)&&j.call(this,ne)}function j(Z){var ne=Z.changedPointers[0];if(ne.identifier===this.primaryTouch){var ge={x:ne.clientX,y:ne.clientY};this.lastTouches.push(ge);var Ne=this.lastTouches,nt=function(){var Lt=Ne.indexOf(ge);Lt>-1&&Ne.splice(Lt,1)};setTimeout(nt,es)}}function Q(Z){for(var ne=Z.srcEvent.clientX,ge=Z.srcEvent.clientY,Ne=0;Ne<this.lastTouches.length;Ne++){var nt=this.lastTouches[Ne],Lt=Math.abs(ne-nt.x),pn=Math.abs(ge-nt.y);if(Lt<=Ao&&pn<=Ao)return!0}return!1}var te=Be(c.style,"touchAction"),me=te!==i,be="compute",ye="auto",pe="manipulation",xe="none",Ve="pan-x",Qe="pan-y",Ue=_t();function At(Z,ne){this.manager=Z,this.set(ne)}At.prototype={set:function(Z){Z==be&&(Z=this.compute()),me&&this.manager.element.style&&Ue[Z]&&(this.manager.element.style[te]=Z),this.actions=Z.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Z=[];return C(this.manager.recognizers,function(ne){U(ne.options.enable,[ne])&&(Z=Z.concat(ne.getTouchAction()))}),Rt(Z.join(" "))},preventDefaults:function(Z){var ne=Z.srcEvent,ge=Z.offsetDirection;if(this.manager.session.prevented){ne.preventDefault();return}var Ne=this.actions,nt=Oe(Ne,xe)&&!Ue[xe],Lt=Oe(Ne,Qe)&&!Ue[Qe],pn=Oe(Ne,Ve)&&!Ue[Ve];if(nt){var yr=Z.pointers.length===1,un=Z.distance<2,Nr=Z.deltaTime<250;if(yr&&un&&Nr)return}if(!(pn&&Lt)&&(nt||Lt&&ge&Hn||pn&&ge&Qn))return this.preventSrc(ne)},preventSrc:function(Z){this.manager.session.prevented=!0,Z.preventDefault()}};function Rt(Z){if(Oe(Z,xe))return xe;var ne=Oe(Z,Ve),ge=Oe(Z,Qe);return ne&&ge?xe:ne||ge?ne?Ve:Qe:Oe(Z,pe)?pe:ye}function _t(){if(!me)return!1;var Z={},ne=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(ge){Z[ge]=ne?e.CSS.supports("touch-action",ge):!0}),Z}var Vt=1,zt=2,cn=4,Kt=8,Qt=Kt,fn=16,vn=32;function er(Z){this.options=D({},this.defaults,Z||{}),this.id=mt(),this.manager=null,this.options.enable=ie(this.options.enable,!0),this.state=Vt,this.simultaneous={},this.requireFail=[]}er.prototype={defaults:{},set:function(Z){return D(this.options,Z),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Z){if(T(Z,"recognizeWith",this))return this;var ne=this.simultaneous;return Z=Ys(Z,this),ne[Z.id]||(ne[Z.id]=Z,Z.recognizeWith(this)),this},dropRecognizeWith:function(Z){return T(Z,"dropRecognizeWith",this)?this:(Z=Ys(Z,this),delete this.simultaneous[Z.id],this)},requireFailure:function(Z){if(T(Z,"requireFailure",this))return this;var ne=this.requireFail;return Z=Ys(Z,this),Ee(ne,Z)===-1&&(ne.push(Z),Z.requireFailure(this)),this},dropRequireFailure:function(Z){if(T(Z,"dropRequireFailure",this))return this;Z=Ys(Z,this);var ne=Ee(this.requireFail,Z);return ne>-1&&this.requireFail.splice(ne,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Z){return!!this.simultaneous[Z.id]},emit:function(Z){var ne=this,ge=this.state;function Ne(nt){ne.manager.emit(nt,Z)}ge<Kt&&Ne(ne.options.event+tr(ge)),Ne(ne.options.event),Z.additionalEvent&&Ne(Z.additionalEvent),ge>=Kt&&Ne(ne.options.event+tr(ge))},tryEmit:function(Z){if(this.canEmit())return this.emit(Z);this.state=vn},canEmit:function(){for(var Z=0;Z<this.requireFail.length;){if(!(this.requireFail[Z].state&(vn|Vt)))return!1;Z++}return!0},recognize:function(Z){var ne=D({},Z);if(!U(this.options.enable,[this,ne])){this.reset(),this.state=vn;return}this.state&(Qt|fn|vn)&&(this.state=Vt),this.state=this.process(ne),this.state&(zt|cn|Kt|fn)&&this.tryEmit(ne)},process:function(Z){},getTouchAction:function(){},reset:function(){}};function tr(Z){return Z&fn?"cancel":Z&Kt?"end":Z&cn?"move":Z&zt?"start":""}function ii(Z){return Z==Mr?"down":Z==mn?"up":Z==Et?"left":Z==Dt?"right":""}function Ys(Z,ne){var ge=ne.manager;return ge?ge.get(Z):Z}function wi(){er.apply(this,arguments)}k(wi,er,{defaults:{pointers:1},attrTest:function(Z){var ne=this.options.pointers;return ne===0||Z.pointers.length===ne},process:function(Z){var ne=this.state,ge=Z.eventType,Ne=ne&(zt|cn),nt=this.attrTest(Z);return Ne&&(ge&en||!nt)?ne|fn:Ne||nt?ge&lt?ne|Kt:ne&zt?ne|cn:zt:vn}});function Rn(){wi.apply(this,arguments),this.pX=null,this.pY=null}k(Rn,wi,{defaults:{event:"pan",threshold:10,pointers:1,direction:Zs},getTouchAction:function(){var Z=this.options.direction,ne=[];return Z&Hn&&ne.push(Qe),Z&Qn&&ne.push(Ve),ne},directionTest:function(Z){var ne=this.options,ge=!0,Ne=Z.distance,nt=Z.direction,Lt=Z.deltaX,pn=Z.deltaY;return nt&ne.direction||(ne.direction&Hn?(nt=Lt===0?Nn:Lt<0?Et:Dt,ge=Lt!=this.pX,Ne=Math.abs(Z.deltaX)):(nt=pn===0?Nn:pn<0?mn:Mr,ge=pn!=this.pY,Ne=Math.abs(Z.deltaY))),Z.direction=nt,ge&&Ne>ne.threshold&&nt&ne.direction},attrTest:function(Z){return wi.prototype.attrTest.call(this,Z)&&(this.state&zt||!(this.state&zt)&&this.directionTest(Z))},emit:function(Z){this.pX=Z.deltaX,this.pY=Z.deltaY;var ne=ii(Z.direction);ne&&(Z.additionalEvent=this.options.event+ne),this._super.emit.call(this,Z)}});function Ka(){wi.apply(this,arguments)}k(Ka,wi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[xe]},attrTest:function(Z){return this._super.attrTest.call(this,Z)&&(Math.abs(Z.scale-1)>this.options.threshold||this.state&zt)},emit:function(Z){if(Z.scale!==1){var ne=Z.scale<1?"in":"out";Z.additionalEvent=this.options.event+ne}this._super.emit.call(this,Z)}});function qa(){er.apply(this,arguments),this._timer=null,this._input=null}k(qa,er,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ye]},process:function(Z){var ne=this.options,ge=Z.pointers.length===ne.pointers,Ne=Z.distance<ne.threshold,nt=Z.deltaTime>ne.time;if(this._input=Z,!Ne||!ge||Z.eventType&(lt|en)&&!nt)this.reset();else if(Z.eventType&Ct)this.reset(),this._timer=S(function(){this.state=Qt,this.tryEmit()},ne.time,this);else if(Z.eventType&lt)return Qt;return vn},reset:function(){clearTimeout(this._timer)},emit:function(Z){this.state===Qt&&(Z&&Z.eventType&lt?this.manager.emit(this.options.event+"up",Z):(this._input.timeStamp=x(),this.manager.emit(this.options.event,this._input)))}});function Ul(){wi.apply(this,arguments)}k(Ul,wi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[xe]},attrTest:function(Z){return this._super.attrTest.call(this,Z)&&(Math.abs(Z.rotation)>this.options.threshold||this.state&zt)}});function Vl(){wi.apply(this,arguments)}k(Vl,wi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Hn|Qn,pointers:1},getTouchAction:function(){return Rn.prototype.getTouchAction.call(this)},attrTest:function(Z){var ne=this.options.direction,ge;return ne&(Hn|Qn)?ge=Z.overallVelocity:ne&Hn?ge=Z.overallVelocityX:ne&Qn&&(ge=Z.overallVelocityY),this._super.attrTest.call(this,Z)&&ne&Z.offsetDirection&&Z.distance>this.options.threshold&&Z.maxPointers==this.options.pointers&&m(ge)>this.options.velocity&&Z.eventType&lt},emit:function(Z){var ne=ii(Z.offsetDirection);ne&&this.manager.emit(this.options.event+ne,Z),this.manager.emit(this.options.event,Z)}});function _a(){er.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}k(_a,er,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[pe]},process:function(Z){var ne=this.options,ge=Z.pointers.length===ne.pointers,Ne=Z.distance<ne.threshold,nt=Z.deltaTime<ne.time;if(this.reset(),Z.eventType&Ct&&this.count===0)return this.failTimeout();if(Ne&&nt&&ge){if(Z.eventType!=lt)return this.failTimeout();var Lt=this.pTime?Z.timeStamp-this.pTime<ne.interval:!0,pn=!this.pCenter||di(this.pCenter,Z.center)<ne.posThreshold;this.pTime=Z.timeStamp,this.pCenter=Z.center,!pn||!Lt?this.count=1:this.count+=1,this._input=Z;var yr=this.count%ne.taps;if(yr===0)return this.hasRequireFailures()?(this._timer=S(function(){this.state=Qt,this.tryEmit()},ne.interval,this),zt):Qt}return vn},failTimeout:function(){return this._timer=S(function(){this.state=vn},this.options.interval,this),vn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Qt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Js(Z,ne){return ne=ne||{},ne.recognizers=ie(ne.recognizers,Js.defaults.preset),new Hl(Z,ne)}Js.VERSION="2.0.7",Js.defaults={domEvents:!1,touchAction:be,enable:!0,inputTarget:null,inputClass:null,preset:[[Ul,{enable:!1}],[Ka,{enable:!1},["rotate"]],[Vl,{direction:Hn}],[Rn,{direction:Hn},["swipe"]],[_a],[_a,{event:"doubletap",taps:2},["tap"]],[qa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Gl=1,jl=2;function Hl(Z,ne){this.options=D({},Js.defaults,ne||{}),this.options.inputTarget=this.options.inputTarget||Z,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Z,this.input=ms(this),this.touchAction=new At(this,this.options.touchAction),Yc(this,!0),C(this.options.recognizers,function(ge){var Ne=this.add(new ge[0](ge[1]));ge[2]&&Ne.recognizeWith(ge[2]),ge[3]&&Ne.requireFailure(ge[3])},this)}Hl.prototype={set:function(Z){return D(this.options,Z),Z.touchAction&&this.touchAction.update(),Z.inputTarget&&(this.input.destroy(),this.input.target=Z.inputTarget,this.input.init()),this},stop:function(Z){this.session.stopped=Z?jl:Gl},recognize:function(Z){var ne=this.session;if(!ne.stopped){this.touchAction.preventDefaults(Z);var ge,Ne=this.recognizers,nt=ne.curRecognizer;(!nt||nt&&nt.state&Qt)&&(nt=ne.curRecognizer=null);for(var Lt=0;Lt<Ne.length;)ge=Ne[Lt],ne.stopped!==jl&&(!nt||ge==nt||ge.canRecognizeWith(nt))?ge.recognize(Z):ge.reset(),!nt&&ge.state&(zt|cn|Kt)&&(nt=ne.curRecognizer=ge),Lt++}},get:function(Z){if(Z instanceof er)return Z;for(var ne=this.recognizers,ge=0;ge<ne.length;ge++)if(ne[ge].options.event==Z)return ne[ge];return null},add:function(Z){if(T(Z,"add",this))return this;var ne=this.get(Z.options.event);return ne&&this.remove(ne),this.recognizers.push(Z),Z.manager=this,this.touchAction.update(),Z},remove:function(Z){if(T(Z,"remove",this))return this;if(Z=this.get(Z),Z){var ne=this.recognizers,ge=Ee(ne,Z);ge!==-1&&(ne.splice(ge,1),this.touchAction.update())}return this},on:function(Z,ne){if(Z!==i&&ne!==i){var ge=this.handlers;return C(Re(Z),function(Ne){ge[Ne]=ge[Ne]||[],ge[Ne].push(ne)}),this}},off:function(Z,ne){if(Z!==i){var ge=this.handlers;return C(Re(Z),function(Ne){ne?ge[Ne]&&ge[Ne].splice(Ee(ge[Ne],ne),1):delete ge[Ne]}),this}},emit:function(Z,ne){this.options.domEvents&&_d(Z,ne);var ge=this.handlers[Z]&&this.handlers[Z].slice();if(!(!ge||!ge.length)){ne.type=Z,ne.preventDefault=function(){ne.srcEvent.preventDefault()};for(var Ne=0;Ne<ge.length;)ge[Ne](ne),Ne++}},destroy:function(){this.element&&Yc(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Yc(Z,ne){var ge=Z.element;if(ge.style){var Ne;C(Z.options.cssProps,function(nt,Lt){Ne=Be(ge.style,Lt),ne?(Z.oldCssProps[Ne]=ge.style[Ne],ge.style[Ne]=nt):ge.style[Ne]=Z.oldCssProps[Ne]||""}),ne||(Z.oldCssProps={})}}function _d(Z,ne){var ge=n.createEvent("Event");ge.initEvent(Z,!0,!0),ge.gesture=ne,ne.target.dispatchEvent(ge)}D(Js,{INPUT_START:Ct,INPUT_MOVE:Zt,INPUT_END:lt,INPUT_CANCEL:en,STATE_POSSIBLE:Vt,STATE_BEGAN:zt,STATE_CHANGED:cn,STATE_ENDED:Kt,STATE_RECOGNIZED:Qt,STATE_CANCELLED:fn,STATE_FAILED:vn,DIRECTION_NONE:Nn,DIRECTION_LEFT:Et,DIRECTION_RIGHT:Dt,DIRECTION_UP:mn,DIRECTION_DOWN:Mr,DIRECTION_HORIZONTAL:Hn,DIRECTION_VERTICAL:Qn,DIRECTION_ALL:Zs,Manager:Hl,Input:gr,TouchAction:At,TouchInput:xi,MouseInput:Ye,PointerEventInput:Ut,TouchMouseInput:re,SingleTouchInput:Pn,Recognizer:er,AttrRecognizer:wi,Tap:_a,Pan:Rn,Swipe:Vl,Pinch:Ka,Rotate:Ul,Press:qa,on:he,off:le,each:C,merge:F,extend:H,assign:D,inherit:k,bindFn:N,prefixed:Be});var Wo=typeof e<"u"?e:typeof self<"u"?self:{};Wo.Hammer=Js,typeof i=="function"&&i.amd?i(function(){return Js}):t.exports?t.exports=Js:e[r]=Js})(window,document,"Hammer")})(Ede);const Tde=nd,La=mW({__proto__:null,default:Tde},[nd]),rB=1,iB=2,aE=4,Sde={mousedown:rB,mousemove:iB,mouseup:aE};function Ade(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function Pde(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(Ade(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function Cde(t){t.prototype.handler=function(n){let r=Sde[n.type];r&rB&&n.button>=0&&(this.pressed=!0),r&iB&&n.which===0&&(r=aE),this.pressed&&(r&aE&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}Pde(nd.PointerEventInput);Cde(nd.MouseInput);const Ide=nd.Manager;class pb{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const Lde=La?[[La.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[La.Rotate,{enable:!1}],[La.Pinch,{enable:!1}],[La.Swipe,{enable:!1}],[La.Pan,{threshold:0,enable:!1}],[La.Press,{enable:!1}],[La.Tap,{event:"doubletap",taps:2,enable:!1}],[La.Tap,{event:"anytap",enable:!1}],[La.Tap,{enable:!1}]]:null,N6={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Rde={doubletap:["tap"]},$de={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},pR={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},Mde={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},B6={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},kde=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Ch=typeof window<"u"?window:global;let lE=!1;try{const t={get passive(){return lE=!0,!0}};Ch.addEventListener("test",null,t),Ch.removeEventListener("test",null)}catch{lE=!1}const Ode=kde.indexOf("firefox")!==-1,{WHEEL_EVENTS:Dde}=pR,U6="wheel",V6=4.000244140625,Fde=40,zde=.25;class Nde extends pb{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;Ch.WheelEvent&&(Ode&&i.deltaMode===Ch.WheelEvent.DOM_DELTA_PIXEL&&(s/=Ch.devicePixelRatio),i.deltaMode===Ch.WheelEvent.DOM_DELTA_LINE&&(s*=Fde)),s!==0&&s%V6===0&&(s=Math.floor(s/V6)),i.shiftKey&&s&&(s=s*zde),this.callback({type:U6,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(Dde),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,lE?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===U6&&(this.options.enable=n)}}const{MOUSE_EVENTS:Bde}=pR,G6="pointermove",j6="pointerover",H6="pointerout",W6="pointerenter",K6="pointerleave";class Ude extends pb{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(Bde),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===G6&&(this.enableMoveEvent=n),e===j6&&(this.enableOverEvent=n),e===H6&&(this.enableOutEvent=n),e===W6&&(this.enableEnterEvent=n),e===K6&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(j6,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(H6,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(W6,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(K6,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(G6,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:Vde}=pR,q6="keydown",X6="keyup";class Gde extends pb{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:q6,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:X6,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Vde),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===q6&&(this.enableDownEvent=n),e===X6&&(this.enableUpEvent=n)}}const Z6="contextmenu";class jde extends pb{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:Z6,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===Z6&&(this.options.enable=n)}}const cE=1,rv=2,uE=4,Hde={pointerdown:cE,pointermove:rv,pointerup:uE,mousedown:cE,mousemove:rv,mouseup:uE},Wde=1,Kde=2,qde=3,Xde=0,Zde=1,Yde=2,Jde=1,Qde=2,ehe=4;function the(t){const e=Hde[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,c=!1,o=!1;return e===uE||e===rv&&!Number.isFinite(n)?(s=i===Wde,c=i===Kde,o=i===qde):e===rv?(s=!!(n&Jde),c=!!(n&ehe),o=!!(n&Qde)):e===cE&&(s=r===Xde,c=r===Zde,o=r===Yde),{leftButton:s,middleButton:c,rightButton:o}}function nhe(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,c={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:c}}const Wx={srcElement:"root",priority:0};class rhe{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:c,handlersByElement:o}=this;let f=Wx;typeof r=="string"||r&&r.addEventListener?f={...Wx,srcElement:r}:r&&(f={...Wx,...r});let m=o.get(f.srcElement);m||(m=[],o.set(f.srcElement,m));const x={type:e,handler:n,srcElement:f.srcElement,priority:f.priority};i&&(x.once=!0),s&&(x.passive=!0),c.push(x),this._active=this._active||!x.passive;let S=m.length-1;for(;S>=0&&!(m[S].priority>=x.priority);)S--;m.splice(S+1,0,x)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const c=r[s];if(c.type===e&&c.handler===n){r.splice(s,1);const o=i.get(c.srcElement);o.splice(o.indexOf(c),1),o.length===0&&i.delete(c.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},c=()=>{e.handled=!0,i=!0},o=[];for(let f=0;f<r.length;f++){const{type:m,handler:x,once:S}=r[f];if(x({...e,type:m,stopPropagation:s,stopImmediatePropagation:c}),S&&o.push(r[f]),i)break}for(let f=0;f<o.length;f++){const{type:m,handler:x}=o[f];this.remove(m,x)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...the(e),...nhe(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const ihe={events:null,recognizers:null,recognizerOptions:{},Manager:Ide,touchAction:"none",tabIndex:0};class she{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,c=$de[s.type];c&&this.manager.emit(c,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...ihe,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||Lde}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(N6).forEach(i=>{const s=this.manager.get(i);s&&N6[i].forEach(c=>{s.recognizeWith(c)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const c=n.recognizerOptions[i];delete c.enable,s.set(c)}}this.wheelInput=new Nde(e,this._onOtherEvent,{enable:!1}),this.moveInput=new Ude(e,this._onOtherEvent,{enable:!1}),this.keyInput=new Gde(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new jde(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=Rde[e];s&&!this.options.recognizers&&s.forEach(c=>{const o=r.get(c);n?(o.requireFailure(e),i.dropRequireFailure(c)):o.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const x in e)this._addEventHandler(x,e[x],r,i,s);return}const{manager:c,events:o}=this,f=B6[e]||e;let m=o.get(f);m||(m=new rhe(this),o.set(f,m),m.recognizerName=Mde[f]||f,c&&c.on(f,m.handleEvent)),m.add(e,n,r,i,s),m.isEmpty()||this._toggleRecognizer(m.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const c in e)this._removeEventHandler(c,e[c]);return}const{events:r}=this,i=B6[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:c}=s;let o=!1;for(const f of r.values())if(f.recognizerName===c&&!f.isEmpty()){o=!0;break}o||this._toggleRecognizer(c,!1)}}}function Su(){}const ohe=({isDragging:t})=>t?"grabbing":"grab",sB={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Su,onResize:Su,onViewStateChange:Su,onInteractionStateChange:Su,onBeforeRender:Su,onAfterRender:Su,onLoad:Su,onError:t=>Ln.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:ohe,getTooltip:null,debug:!1,drawPickingColors:!1};class mb{constructor(e){K(this,"props",void 0),K(this,"width",0),K(this,"height",0),K(this,"userData",{}),K(this,"canvas",null),K(this,"viewManager",null),K(this,"layerManager",null),K(this,"effectManager",null),K(this,"deckRenderer",null),K(this,"deckPicker",null),K(this,"eventManager",null),K(this,"tooltip",null),K(this,"metrics",void 0),K(this,"animationLoop",void 0),K(this,"stats",void 0),K(this,"viewState",void 0),K(this,"cursorState",void 0),K(this,"_needsRedraw",void 0),K(this,"_pickRequest",void 0),K(this,"_lastPointerDownInfo",null),K(this,"_metricsCounter",void 0),K(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),K(this,"_onEvent",n=>{const r=Ok[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),c=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=c,f=o&&(o[r.handler]||o.props[r.handler]),m=this.props[r.handler];let x=!1;f&&(x=f.call(o,c,n)),!x&&m&&m(c,n)}),K(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...sB,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Ln.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),Uz()==="IE"&&Ln.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new WL({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&df.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,c,o;if(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(i=this.deckRenderer)===null||i===void 0||i.finalize(),this.deckRenderer=null,(s=this.deckPicker)===null||s===void 0||s.finalize(),this.deckPicker=null,(c=this.eventManager)===null||c===void 0||c.destroy(),this.eventManager=null,(o=this.tooltip)===null||o===void 0||o.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var f;(f=this.canvas.parentElement)===null||f===void 0||f.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Ln.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Ln.removed("onLayerClick","onClick")(),e.initialViewState&&!Na(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),c=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||c,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Di(this.viewManager),this.viewManager.views}getViewports(e){return Di(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Di(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Di(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var c;this.width=i,this.height=s,(c=this.viewManager)===null||c===void 0||c.setProps({width:i,height:s}),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:c,onError:o,onBeforeRender:f,onAfterRender:m,useDevicePixels:x}=e;return new lae({width:n,height:r,useDevicePixels:x,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:S=>oN({...s,...S,canvas:this.canvas,debug:c,onContextLost:()=>this._onContextLost()}),onInitialize:S=>this._setGLContext(S.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:f,onAfterRender:m,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new eB({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,c=!1;for(const o of r){var n;s=o,c=((n=o.layer)===null||n===void 0?void 0:n.onHover(o,e.event))||c}if(!c&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const o=this.props.getTooltip(s);this.tooltip.setTooltip(o,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,QL(e,{enable:!0,copyState:!0})),this.tooltip=new wde(this.canvas),$l(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new NN;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new she(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in Ok)this.eventManager.on(i,this._onEvent);this.viewManager=new Xue({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new que(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new dde,this.deckRenderer=new pde(e),this.deckPicker=new bde(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;$l(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Ln.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=zu.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}K(mb,"defaultProps",sB);K(mb,"VERSION",fie);class Kx{constructor(e,n){K(this,"opts",void 0),K(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const c=n.elementOffset||0;for(let o=0;o<i;++o)s[o]=r[c+o]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function ahe(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function s0(t){return t.stride||t.size*t.bytesPerElement}function oB(t,e){e.offset&&Ln.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=s0(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function lhe(t,e){const n=oB(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class che{constructor(e,n,r){K(this,"gl",void 0),K(this,"id",void 0),K(this,"size",void 0),K(this,"settings",void 0),K(this,"value",void 0),K(this,"doublePrecision",void 0),K(this,"_buffer",void 0),K(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:c}=n;c=Number.isFinite(c)?[c]:c||new Array(this.size).fill(0);let o;s?o=5126:!i&&n.isIndexed?o=e&&zse(e,Pr.ELEMENT_INDEX_UINT32)?5125:5123:o=i||5126;let f=ahe(i||o||5126);this.doublePrecision=s,s&&n.fp64===!1&&(f=Float32Array),this.value=null,this.settings={...n,defaultType:f,defaultValue:c,logicalType:i,type:o,size:this.size,bytesPerElement:f.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new cr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*s0(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),df.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=lhe(this.getAccessor(),n||{});return r[e]=new Kx(this,s.high),r["".concat(e,"64Low")]=i?new Kx(this,s.low):new Float32Array(this.size),r}if(n){const r=oB(this.getAccessor(),n);return{[e]:new Kx(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const c=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let f=0;f<s;)for(let m=0;m<i;m++){const x=n[f++];x<c[m]&&(c[m]=x),x>o[m]&&(o[m]=x)}e=[c,o]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof cr?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const c=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(c?2:1),i.stride=s0(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=s0(i);const{buffer:c,byteOffset:o}=this;this.doublePrecision&&s instanceof Float64Array&&(s=Gx(s,i));const f=s.byteLength+o+i.stride*2;c.byteLength<f&&c.reallocate(f),c.setAccessor(null),c.subData({data:s,offset:o}),i.type=r.type||c.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?Gx(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=df.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:c,byteOffset:o}=this;return c.byteLength<s.byteLength+o&&(c.reallocate(s.byteLength+o),n&&i&&c.subData({data:i instanceof Float64Array?Gx(i,this):i,offset:o})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&Ln.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let c=s;for(;--c>=0;)n[r+c]=i[c];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let c=s;for(;--c>=0;)n[r+c]=Number.isFinite(e[c])?e[c]:i[c]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const Y6=[],J6=[];function gb(t,e=0,n=1/0){let r=Y6;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(J6.length=t.length,r=J6):r=Y6,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function aB(t){return t&&t[Symbol.asyncIterator]}function lB(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:c}=e,o=t.BYTES_PER_ELEMENT,f=r?r/o:n,m=i?i/o:0,x=Math.floor((t.length-m)/f);return(S,{index:T,target:C})=>{if(!s){const F=T*f+m;for(let k=0;k<n;k++)C[k]=t[F+k];return C}const R=s[T],D=s[T+1]||x;let H;if(c){H=new Array(D-R);for(let F=R;F<D;F++){const k=F*f+m;C=new Array(n);for(let N=0;N<n;N++)C[N]=t[k+N];H[F-R]=C}}else if(f===n)H=t.subarray(R*n+m,D*n+m);else{H=new t.constructor((D-R)*n);let F=0;for(let k=R;k<D;k++){const N=k*f+m;for(let U=0;U<n;U++)H[F++]=t[N+U]}}return H}}const uhe=[],o0=[[0,1/0]];function dhe(t,e){if(t===o0||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const c=t[s];c[1]<e[0]?(n.push(c),i=s+1):c[0]>e[1]?n.push(c):e=[Math.min(c[0],e[0]),Math.max(c[1],e[1])]}return n.splice(i,0,e),n}function qx(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,c=t.end||n.length,o=e.length,f=c-r;if(o>f){n.set(e.subarray(0,f),r);return}if(n.set(e,r),!s)return;let m=o;for(;m<f;){const x=s(m,e);for(let S=0;S<i;S++)n[r+m]=x[S]||0,m++}}function hhe({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return qx({source:t,target:e,size:n,getData:r}),e;let c=0,o=0;const f=r&&((x,S)=>r(x+o,S)),m=Math.min(i.length,s.length);for(let x=1;x<m;x++){const S=i[x]*n,T=s[x]*n;qx({source:t.subarray(c,S),target:e,start:o,end:T,size:n,getData:f}),c=S,o=T}return o<e.length&&qx({source:[],target:e,start:o,size:n,getData:f}),e}const fhe={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function cB(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...fhe[n],...e,...t,type:n}}function uB(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function dB(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function hB(t){t.push(t.shift())}function mR(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,c=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*c}function fB({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=c=>c}){const c=n.doublePrecision&&n.value instanceof Float64Array?2:1,o=n.size*c,f=n.byteOffset,m=n.startIndices,x=i&&m,S=mR(n,e),T=n.isConstant;if(!x&&r>=S)return;const C=T?n.value:n.getBuffer().getData({srcByteOffset:f});if(n.settings.normalized&&!T){const F=s;s=(k,N)=>n.normalizeConstant(F(k,N))}const R=T?(F,k)=>s(C,k):(F,k)=>s(C.subarray(F,F+o),k),D=t.getData({length:r}),H=new Float32Array(S);hhe({source:D,target:H,sourceStartIndices:i,targetStartIndices:m,size:o,getData:R}),t.byteLength<H.byteLength+f&&t.reallocate(H.byteLength+f),t.subData({data:H,offset:f})}class gR extends che{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:o0}),K(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return cB(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=dhe(this.state.updateRanges,[r,i])}else this.state.updateRanges=o0}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=uhe}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==o0),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:c,noAlloc:o}}=this;let f=!0;if(c){for(const[m,x]of s)c.call(i,this,{data:n,startRow:m,endRow:x,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[m,x]of s){const S=Number.isFinite(m)?this.getVertexOffset(m):0,T=Number.isFinite(x)?this.getVertexOffset(x):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:S,endOffset:T})}this._checkAttributeArray()}else f=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),f}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const c=e;Di(ArrayBuffer.isView(c.value),"invalid ".concat(i.accessor));const o=!!c.size&&c.size!==this.size;return r.binaryAccessor=lB(c.value,{size:c.size||this.size,stride:c.stride,offset:c.offset,startIndices:n,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:c}){if(e.constant)return;const{settings:o,state:f,value:m,size:x,startIndices:S}=e,{accessor:T,transform:C}=o,R=f.binaryAccessor||(typeof T=="function"?T:s[T]);Di(typeof R=="function",'accessor "'.concat(T,'" is not a function'));let D=e.getVertexOffset(r);const{iterable:H,objectInfo:F}=gb(n,r,i);for(const k of H){F.index++;let N=R(k,F);if(C&&(N=C.call(this,N)),S){const U=(F.index<S.length-1?S[F.index+1]:c)-S[F.index];if(N&&Array.isArray(N[0])){let ie=D;for(const he of N)e._normalizeValue(he,m,ie),ie+=x}else N&&N.length>x?m.set(N,D):(e._normalizeValue(N,F.target,0),Nue({target:m,source:F.target,start:D,count:U}));D+=U*x}else e._normalizeValue(N,m,D),D+=x}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class phe{constructor({gl:e,attribute:n,timeline:r}){K(this,"gl",void 0),K(this,"type","interpolation"),K(this,"attributeInTransition",void 0),K(this,"settings",void 0),K(this,"attribute",void 0),K(this,"transition",void 0),K(this,"currentStartIndices",void 0),K(this,"currentLength",void 0),K(this,"transform",void 0),K(this,"buffers",void 0),this.gl=e,this.transition=new $g(r),this.attribute=n,this.attributeInTransition=new gR(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=ghe(e,n);const i={byteLength:0,usage:35050};this.buffers=[new cr(e,i),new cr(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;hB(i);const c={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)fB({buffer:o,...c});this.currentStartIndices=s.startIndices,this.currentLength=mR(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:uB(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const mhe=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function ghe(t,e){const n=dB(e.size);return new lR(t,{vs:mhe,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class yhe{constructor({gl:e,attribute:n,timeline:r}){K(this,"gl",void 0),K(this,"type","spring"),K(this,"attributeInTransition",void 0),K(this,"settings",void 0),K(this,"attribute",void 0),K(this,"transition",void 0),K(this,"currentStartIndices",void 0),K(this,"currentLength",void 0),K(this,"texture",void 0),K(this,"framebuffer",void 0),K(this,"transform",void 0),K(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new $g(r),this.attribute=n,this.attributeInTransition=new gR(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=vhe(e),this.framebuffer=bhe(e,this.texture),this.transform=_he(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new cr(e,i),new cr(e,i),new cr(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,c={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)fB({buffer:o,...c});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=mR(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:uB(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const c=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:c.stiffness,damping:c.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),hB(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),fb(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function _he(t,e,n){const r=dB(e.size);return new lR(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function vhe(t){return new xo(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function bhe(t,e){return new Yi(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{[36064]:e}})}const xhe={interpolation:phe,spring:yhe};class whe{constructor(e,{id:n,timeline:r}){K(this,"id",void 0),K(this,"isSupported",void 0),K(this,"gl",void 0),K(this,"timeline",void 0),K(this,"transitions",void 0),K(this,"needsRedraw",void 0),K(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=lR.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],c=s.getTransitionSetting(n);c&&this._updateAttribute(i,s,c)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){Ln.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const c=xhe[r.type];c?this.transitions[e]=new c({attribute:n,timeline:this.timeline,gl:this.gl}):(Ln.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const Q6="attributeManager.invalidate",Ehe="attributeManager.updateStart",The="attributeManager.updateEnd",She="attribute.updateStart",Ahe="attribute.allocate",Phe="attribute.updateEnd";class Che{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){K(this,"id",void 0),K(this,"gl",void 0),K(this,"attributes",void 0),K(this,"updateTriggers",void 0),K(this,"needsRedraw",void 0),K(this,"userData",void 0),K(this,"stats",void 0),K(this,"attributeTransitionManager",void 0),K(this,"mergeBoundsMemoized",Ig(Lue)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new whe(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);us(Q6,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);us(Q6,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:c={},context:o={}}){let f=!1;us(Ehe,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const m in this.attributes){const x=this.attributes[m],S=x.settings.accessor;x.startIndices=r,x.numInstances=n,s[m]&&Ln.removed("props.".concat(m),"data.attributes.".concat(m))(),x.setExternalBuffer(c[m])||x.setBinaryValue(typeof S=="string"?c[S]:void 0,e.startIndices)||typeof S=="string"&&!c[S]&&x.setConstantValue(s[S])||x.needsUpdate()&&(f=!0,this._updateAttribute({attribute:x,numInstances:n,data:e,props:s,context:o})),this.needsRedraw=this.needsRedraw||x.needsRedraw()}f&&us(The,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const c=n[s];c.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=c)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new gR(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(c=>{const o=r[c];o&&o.setNeedsUpdate(o.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(us(She,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&us(Ahe,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,us(Phe,n,r))}}class Ihe extends $g{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,c=s(e/i);this._value=Z0(n,r,c)}}const e5=1e-5;function t5(t,e,n,r,i){const s=e-t,o=(n-e)*i,f=-s*r;return o+f+s+e}function Lhe(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let c=0;c<n.length;c++)s[c]=t5(t[c],e[c],n[c],r,i);return s}return t5(t,e,n,r,i)}function n5(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class Rhe extends $g{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:c=e}=this;let o=Lhe(s,c,n,r,i);const f=n5(o,n),m=n5(o,c);f<e5&&m<e5&&(o=n,this.end()),this._prevValue=c,this._currValue=o}}const $he={interpolation:Ihe,spring:Rhe};class Mhe{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const f=s.get(e),{value:m=f.settings.fromValue}=f;n=m,this.remove(e)}if(i=cB(i),!i)return;const c=$he[i.type];if(!c){Ln.error("unsupported transition type '".concat(i.type,"'"))();return}const o=new c(this.timeline);o.start({...i,fromValue:n,toValue:r}),s.set(e,o)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function khe(t){const e=t[Dc];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function Ohe(t,e){const n=pB({newProps:t,oldProps:e,propTypes:t[Dc],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=Fhe(t,e);let i=!1;return r||(i=zhe(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:Nhe(t,e),transitionsChanged:Dhe(t,e)}}function Dhe(t,e){if(!t.transitions)return!1;const n={},r=t[Dc];let i=!1;for(const s in t.transitions){const c=r[s],o=c&&c.type;(o==="number"||o==="color"||o==="array")&&dE(t[s],e[s],c)&&(n[s]=!0,i=!0)}return i?n:!1}function pB({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const c=dE(t[s],e[s],r[s]);if(c)return"".concat(i,".").concat(s," ").concat(c)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const c=dE(t[s],e[s],r[s]);if(c)return"".concat(i,".").concat(s," ").concat(c)}}return!1}function dE(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function Fhe(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function zhe(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&r5(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&r5(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function Nhe(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function r5(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},pB({oldProps:i,newProps:r,triggerName:n})}const Bhe="count(): argument not an object",Uhe="count(): argument not a container";function Vhe(t){if(!jhe(t))throw new Error(Bhe);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(Ghe(t))return Object.keys(t).length;throw new Error(Uhe)}function Ghe(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function jhe(t){return t!==null&&typeof t=="object"}function Hhe(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const Whe={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071},hE={};function Khe(t,e,n,r){if(n instanceof xo)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={[10241]:n.data.length>1?9985:9729});const s=new xo(e,{...n,parameters:{...Whe,...i,...r}});return hE[s.id]=t,s}function qhe(t,e){!e||!(e instanceof xo)||hE[e.id]===t&&(e.delete(),delete hE[e.id])}const Xhe={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||fE(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Na(t,e,1)}},accessor:{validate(t,e){const n=iv(t);return n==="function"||n===iv(e.value)},equal(t,e,n){return typeof e=="function"?!0:Na(t,e,1)}},array:{validate(t,e){return e.optional&&!t||fE(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Na(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Na(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:Khe(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{qhe(n.id,t)}}};function Zhe(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const c=s==null?void 0:s.deprecatedFor;if(c)r[i]=Array.isArray(c)?c:[c];else{const o=Yhe(i,s);e[i]=o,n[i]=o.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function Yhe(t,e){switch(iv(e)){case"object":return Np(t,e);case"array":return Np(t,{type:"array",value:e,compare:!1});case"boolean":return Np(t,{type:"boolean",value:e});case"number":return Np(t,{type:"number",value:e});case"function":return Np(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Np(t,e){return"type"in e?{name:t,...Xhe[e.type],...e}:"value"in e?{name:t,type:iv(e.value),...e}:{name:t,type:"object",value:e}}function fE(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function iv(t){return fE(t)?"array":t===null?"null":typeof t}function Jhe(t,e){let n;for(let s=e.length-1;s>=0;s--){const c=e[s];"extensions"in c&&(n=c.extensions)}const r=pE(t.constructor,n),i=Object.create(r);i[nv]=t,i[td]={},i[Sc]={};for(let s=0;s<e.length;++s){const c=e[s];for(const o in c)i[o]=c[o]}return Object.freeze(i),i}const Qhe="_mergedDefaultProps";function pE(t,e){let n=Qhe;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=mB(t,n);return r||(t[n]=efe(t,e||[]))}function efe(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=pE(r),s=mB(t,"defaultProps")||{},c=Zhe(s),o=Object.assign(Object.create(null),i,c.defaultProps),f=Object.assign(Object.create(null),i==null?void 0:i[Dc],c.propTypes),m=Object.assign(Object.create(null),i==null?void 0:i[Hx],c.deprecatedProps);for(const x of e){const S=pE(x.constructor);S&&(Object.assign(o,S),Object.assign(f,S[Dc]),Object.assign(m,S[Hx]))}return tfe(o,t),rfe(o,f),nfe(o,m),o[Dc]=f,o[Hx]=m,e.length===0&&!yR(t,"_propTypes")&&(t._propTypes=f),o}function tfe(t,e){const n=sfe(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function nfe(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])yR(this,s)||(this[s]=r);Ln.deprecated(i,e[n].join("/"))()}})}function rfe(t,e){const n={},r={};for(const i in e){const s=e[i],{name:c,value:o}=s;s.async&&(n[c]=o,r[c]=ife(c))}t[Nh]=n,t[td]={},Object.defineProperties(t,r)}function ife(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||aB(e)?this[td][t]=e:this[Sc][t]=e},get(){if(this[Sc]){if(t in this[Sc])return this[Sc][t]||this[Nh][t];if(t in this[td]){const e=this[nv]&&this[nv].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Nh][t]}}return this[Nh][t]}}}function yR(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function mB(t,e){return yR(t,e)&&t[e]}function sfe(t){const e=t.componentName;return e||Ln.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let ofe=0;class _R{constructor(...e){K(this,"id",void 0),K(this,"props",void 0),K(this,"count",void 0),this.props=Jhe(this,e),this.id=this.props.id,this.count=ofe++}clone(e){const{props:n}=this,r={};for(const i in n[Nh])i in n[Sc]?r[i]=n[Sc][i]:i in n[td]&&(r[i]=n[td][i]);return new this.constructor({...n,...r,...e})}}K(_R,"componentName","Component");K(_R,"defaultProps",{});const afe=Object.freeze({});class lfe{constructor(e){K(this,"component",void 0),K(this,"onAsyncPropUpdated",void 0),K(this,"asyncProps",void 0),K(this,"oldProps",void 0),K(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||afe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[nv]||this.component;const n=e[Sc]||{},r=e[td]||e,i=e[Nh]||{};for(const s in n){const c=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,c),n[s]=this.getAsyncProp(s)}for(const s in r){const c=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,c)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(aB(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],c=0;for await(const o of n){if(!this.component)return;const{dataTransform:f}=this.component.props;f?s=f(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:c,endRow:s.length}]}),c=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Dc];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class cfe extends lfe{constructor({attributeManager:e,layer:n}){super(n),K(this,"attributeManager",void 0),K(this,"needsRedraw",void 0),K(this,"needsUpdate",void 0),K(this,"subLayers",void 0),K(this,"usesPickingColorCache",void 0),K(this,"hasPickingBuffer",void 0),K(this,"changeFlags",void 0),K(this,"viewport",void 0),K(this,"uniformTransitions",void 0),K(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const ufe="layer.changeFlag",dfe="layer.initialize",hfe="layer.update",ffe="layer.finalize",pfe="layer.matched",i5=2**24-1,mfe=Object.freeze([]),gfe=Ig(({oldViewport:t,viewport:e})=>t.equals(e));let Ra=new Uint8ClampedArray(0);const yfe={data:{type:"data",value:mfe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:c}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var o;i={...i,fetch:{...(o=i)===null||o===void 0?void 0:o.fetch,signal:s}}}let f=c.contains(t);return!f&&!i&&(c.add({resourceId:t,data:K0(t,r),persistent:!1}),f=!0),f?c.subscribe({resourceId:t,onChange:m=>{var x;return(x=n.internalState)===null||x===void 0?void 0:x.reloadAsyncProp(e,m)},consumerId:n.id,requestId:e}):K0(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:qn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class zl extends _R{constructor(...e){super(...e),K(this,"internalState",null),K(this,"lifecycle",ch.NO_STATE),K(this,"context",void 0),K(this,"state",void 0),K(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Di(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=ZN(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,c]=qN(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,c]}unproject(e){return Di(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Di(this.internalState);const r=this.internalState.viewport||this.context.viewport;return Due(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===qn.DEFAULT||e===qn.LNGLAT||e===qn.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Di(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Vhe(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=Hhe(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,c=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==c){this.internalState.hasPickingBuffer=c;const{pickingColors:o,instancePickingColors:f}=n.attributes,m=o||f;m&&(c&&m.constant&&(m.constant=!1,n.invalidate(m.id)),!m.value&&!c&&(m.constant=!0,m.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e.message="".concat(n,": ").concat(e.message)),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,c;(s=this.context)===null||s===void 0||(c=s.onError)===null||c===void 0||c.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!gfe({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Ra.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>i5&&Ln.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Ra=df.allocate(Ra,n,{size:3,copy:!0,maxCount:Math.max(n,i5)});const i=Math.floor(Ra.length/3),s=[];for(let c=r;c<i;c++)this.encodePickingColor(c,s),Ra[c*3+0]=s[0],Ra[c*3+1]=s[1],Ra[c*3+2]=s[2]}e.value=Ra.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,c=s&&n.attributes&&n.attributes[s.id];if(c&&c.value){const o=c.value,f=this.encodePickingColor(e);for(let m=0;m<n.length;m++){const x=s.getVertexOffset(m);o[x]===f[0]&&o[x+1]===f[1]&&o[x+2]===f[2]&&this._disablePickingIndex(m)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),c=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(c-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Ra.buffer&&(r.value=Ra.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Di(!this.internalState),Di(Number.isFinite(this.props.coordinateSystem)),us(dfe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new cfe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Ln.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Mhe(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){us(pfe,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(us(hfe,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,c=this._updateUniformTransition();i.propsInTransition=c,r.viewport=i.viewport||s,this.props=c;try{const o=this._getUpdateParams(),f=this.getModels();if(r.gl)this.updateState(o);else try{this.updateState(o)}catch{}for(const x of this.props.extensions)x.updateState.call(this,o,x);const m=this.getModels()[0]!==f[0];this._postUpdate(o,m)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){us(ffe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const c=this.props.opacity;n.opacity=Math.pow(c,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:o}=this.props,f=o&&o(n)||[0,0];$l(s.gl,{polygonOffset:f}),da(s.gl,r,()=>{const m={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const x of this.props.extensions)x.draw.call(this,m,x);this.draw(m)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const c=e[i],o=n[i];c&&Array.isArray(o)&&(n.dataChanged=Array.isArray(c)?o.concat(c):c,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&us(ufe,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=Ohe(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){khe(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Che(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:c,highlightedObjectIndex:o,highlightColor:f}=r;if(n||i.autoHighlight!==c||i.highlightedObjectIndex!==o||i.highlightColor!==f){const m={};c||(m.pickingSelectedColor=null),Array.isArray(f)&&(m.pickingHighlightColor=f),(n||o!==i.highlightedObjectIndex)&&(m.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(m)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}K(zl,"defaultProps",yfe);K(zl,"layerName","Layer");const _fe="compositeLayer.renderLayers";class vR extends zl{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:c,getPolygonOffset:o,highlightedObjectIndex:f,autoHighlight:m,highlightColor:x,coordinateSystem:S,coordinateOrigin:T,wrapLongitude:C,positionFormat:R,modelMatrix:D,extensions:H,fetch:F,operation:k,_subLayerProps:N}=this.props,U={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:c,getPolygonOffset:o,highlightedObjectIndex:f,autoHighlight:m,highlightColor:x,coordinateSystem:S,coordinateOrigin:T,wrapLongitude:C,positionFormat:R,modelMatrix:D,extensions:H,fetch:F,operation:k},ie=N&&e.id&&N[e.id],he=ie&&ie.updateTriggers,le=e.id||"sublayer";if(ie){const ve=this.props[Dc],Oe=e.type?e.type._propTypes:{};for(const Re in ie){const Ee=Oe[Re]||ve[Re];Ee&&Ee.type==="accessor"&&(ie[Re]=this.getSubLayerAccessor(ie[Re]))}}Object.assign(U,e,ie),U.id="".concat(this.props.id,"-").concat(le),U.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...he};for(const ve of H){const Oe=ve.getSubLayerProps.call(this,ve);Oe&&Object.assign(U,Oe,{updateTriggers:Object.assign(U.updateTriggers,Oe.updateTriggers)})}return U}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=fR(s,Boolean),this.internalState.subLayers=r}us(_fe,this,i,r);for(const s of r)s.parent=this}}K(vR,"layerName","CompositeLayer");class gB{constructor(e){K(this,"opts",void 0),K(this,"typedArrayManager",void 0),K(this,"indexStarts",[0]),K(this,"vertexStarts",[0]),K(this,"vertexCount",0),K(this,"instanceCount",0),K(this,"attributes",void 0),K(this,"_attributeDefs",void 0),K(this,"data",void 0),K(this,"getGeometry",void 0),K(this,"geometryBuffer",void 0),K(this,"buffers",void 0),K(this,"positionSize",void 0),K(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=df,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:c,dataChanged:o,normalize:f=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(c==="XY"?2:3),this.buffers=r,this.normalize=f,s&&(Di(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),f||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(o))for(const m of o)this._rebuildGeometry(m);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?lB(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:c}=this;for(const o in s)if(o in i)c.release(r[o]),r[o]=null;else{const f=s[o];f.copy=n,r[o]=c.allocate(r[o],e,f)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:c,objectInfo:o}=gb(i,n,r);for(const f of c){o.index++;const m=s?s(f,o):null;e(m,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:c}=this,{startRow:o=0,endRow:f=1/0}=e||{},m={};if(e||(n=[0],r=[0]),this.normalize||!c)this._forEachGeometry((S,T)=>{const C=S&&this.normalizeGeometry(S);m[T]=C,r[T+1]=r[T]+(C?this.getGeometrySize(C):0)},o,f),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(c))i=i||c.length/this.positionSize;else if(c instanceof cr){const S=c.accessor.stride||this.positionSize*4;i=i||c.byteLength/S}else if(c.buffer){const S=c.stride||this.positionSize*4;i=i||c.buffer.byteLength/S}else if(c.value){const S=c.value,T=c.stride/S.BYTES_PER_ELEMENT||this.positionSize;i=i||S.length/T}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const x={};this._forEachGeometry((S,T)=>{const C=m[T]||S;x.vertexStart=r[T],x.indexStart=n[T];const R=T<r.length-1?r[T+1]:i;x.geometrySize=R-r[T],x.geometryIndex=T,this.updateGeometryAttributes(C,x)},o,f),this.vertexCount=n[n.length-1]}}const vfe=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,bfe=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,xfe=1024,wfe=4,s5=()=>{},o5={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071};function Efe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Tfe(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),c=Math.floor(e.height*i);return i===1?{data:e,width:s,height:c}:(t.canvas.height=c,t.canvas.width=s,t.clearRect(0,0,s,c),t.drawImage(e,0,0,e.width,e.height,0,0,s,c),{data:t.canvas,width:s,height:c})}function Xm(t){return t&&(t.id||t.url)}function Sfe(t,e,n,r){const i=t.width,s=t.height,c=new xo(t.gl,{width:e,height:n,parameters:r});return kse(t,c,{targetY:0,width:i,height:s}),t.delete(),c}function a5(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],c=Xm(i);t[c]={...i,x:s,y:n}}}function Afe({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:c}){let o=[];for(let f=0;f<t.length;f++){const m=t[f],x=Xm(m);if(!n[x]){const{height:S,width:T}=m;r+T+e>c&&(a5(n,o,i),r=0,i=s+i+e,s=0,o=[]),o.push({icon:m,xOffset:r}),r=r+T+e,s=Math.max(s,S)}}return o.length>0&&a5(n,o,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:c,canvasHeight:Efe(s+i+e)}}function Pfe(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=gb(t);for(const c of i){s.index++;const o=e(c,s),f=Xm(o);if(!o)throw new Error("Icon is missing.");if(!o.url)throw new Error("Icon url is missing.");!r[f]&&(!n[f]||o.url!==n[f].url)&&(r[f]={...o,source:c,sourceIndex:s.index})}return r}class Cfe{constructor(e,{onUpdate:n=s5,onError:r=s5}){K(this,"gl",void 0),K(this,"onUpdate",void 0),K(this,"onError",void 0),K(this,"_loadOptions",null),K(this,"_texture",null),K(this,"_externalTexture",null),K(this,"_mapping",{}),K(this,"_textureParameters",null),K(this,"_pendingCount",0),K(this,"_autoPacking",!1),K(this,"_xOffset",0),K(this,"_yOffset",0),K(this,"_rowHeight",0),K(this,"_buffer",wfe),K(this,"_canvasWidth",xfe),K(this,"_canvasHeight",0),K(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Xm(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var c;(c=this._texture)===null||c===void 0||c.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(Pfe(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:c,rowHeight:o,canvasHeight:f}=Afe({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=s,this._yOffset=c,this._canvasHeight=f,this._texture||(this._texture=new xo(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||o5})),this._texture.height!==this._canvasHeight&&(this._texture=Sfe(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||o5)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,K0(r.url,this._loadOptions).then(i=>{const s=Xm(r),c=this._mapping[s],{x:o,y:f,width:m,height:x}=c,{data:S,width:T,height:C}=Tfe(n,i,m,x);this._texture.setSubImageData({data:S,x:o+(m-T)/2,y:f+(x-C)/2,width:T,height:C}),c.width=T,c.height=C,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const yB=[0,0,0,255],Ife={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:yB},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class yb extends zl{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(){return super.getShaders({vs:vfe,fs:bfe,modules:[Lg,Rg]})}initializeState(){this.state={iconManager:new Cfe(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:yB},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:c,iconMapping:o,data:f,getIcon:m,textureParameters:x}=n,{iconManager:S}=this.state,T=c||this.internalState.isAsyncPropLoading("iconAtlas");if(S.setProps({loadOptions:n.loadOptions,autoPacking:!T,iconAtlas:c,iconMapping:T?o:null,textureParameters:x}),T?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&S.packIcons(f,m),i.extensionsChanged){var C;const{gl:R}=this.context;(C=this.state.model)===null||C===void 0||C.delete(),this.state.model=this._getModel(R),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:c,alphaCutoff:o}=this.props,{iconManager:f}=this.state,m=f.getTexture();m&&this.state.model.setUniforms(e).setUniforms({iconsTexture:m,iconsTextureDim:[m.width,m.height],sizeUnits:Yu[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:c,alphaCutoff:o}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Qu(e,{...this.getShaders(),id:this.props.id,geometry:new Cg({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):Ln.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}K(yb,"defaultProps",Ife);K(yb,"layerName","IconLayer");const Lfe=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,Rfe=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (filled) {
    gl_FragColor = vFillColor;
  } else {
    discard;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,l5=[0,0,0,255],$fe={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:l5},getLineColor:{type:"accessor",value:l5},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class bR extends zl{getShaders(){return super.getShaders({vs:Lfe,fs:Rfe,modules:[Lg,Rg]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:c,filled:o,billboard:f,antialiasing:m,lineWidthUnits:x,lineWidthScale:S,lineWidthMinPixels:T,lineWidthMaxPixels:C}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:c?1:0,filled:o,billboard:f,antialiasing:m,radiusUnits:Yu[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:Yu[x],lineWidthScale:S,lineWidthMinPixels:T,lineWidthMaxPixels:C}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Qu(e,{...this.getShaders(),id:this.props.id,geometry:new Cg({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}K(bR,"defaultProps",$fe);K(bR,"layerName","ScatterplotLayer");const _B={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function vB(t,e,n={}){return Mfe(t,n)!==e?(Ofe(t,n),!0):!1}function Mfe(t,e={}){return Math.sign(kfe(t,e))}function kfe(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let c=n,o=r-i;c<r;c+=i)s+=(t[c]-t[o])*(t[c+1]+t[o+1]),o=c;return s/2}function Ofe(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,c=Math.floor(s/2);for(let o=0;o<c;++o){const f=n+o*i,m=n+(s-1-o)*i;for(let x=0;x<i;++x){const S=t[f+x];t[f+x]=t[m+x],t[m+x]=S}}}function la(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function mE(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Zm(t,e,n,r,i=[]){const s=r+e*n;for(let c=0;c<n;c++)i[c]=t[s+c];return i}function gE(t,e,n,r,i=[]){let s,c;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),c=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),c=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),c=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),c=0;else return null;for(let o=0;o<t.length;o++)i[o]=(c&1)===o?r[c]:s*(e[o]-t[o])+t[o];return i}function a0(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function bB(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:c=0,endIndex:o=t.length}=e||{},f=(o-c)/n;let m=[];const x=[m],S=Zm(t,0,n,c);let T,C;const R=wB(S,i,s,[]),D=[];la(m,S);for(let H=1;H<f;H++){for(T=Zm(t,H,n,c,T),C=a0(T,R);C;){gE(S,T,C,R,D);const F=a0(D,R);F&&(gE(S,D,F,R,D),C=F),la(m,D),mE(S,D),Ffe(R,i,C),r&&m.length>n&&(m=[],x.push(m),la(m,S)),C=a0(T,R)}la(m,T),mE(S,T)}return r?x:x[0]}const c5=0,Dfe=1;function v_(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function xB(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:c=!1}=n||{},o=[],f=[{pos:t,types:c?new Array(t.length/r).fill(Dfe):null,holes:e||[]}],m=[[],[]];let x=[];for(;f.length;){const{pos:S,types:T,holes:C}=f.shift();zfe(S,r,C[0]||S.length,m),x=wB(m[0],i,s,x);const R=a0(m[1],x);if(R){let D=u5(S,T,r,0,C[0]||S.length,x,R);const H={pos:D[0].pos,types:D[0].types,holes:[]},F={pos:D[1].pos,types:D[1].types,holes:[]};f.push(H,F);for(let k=0;k<C.length;k++)D=u5(S,T,r,C[k],C[k+1]||S.length,x,R),D[0]&&(H.holes.push(H.pos.length),H.pos=v_(H.pos,D[0].pos),c&&(H.types=v_(H.types,D[0].types))),D[1]&&(F.holes.push(F.pos.length),F.pos=v_(F.pos,D[1].pos),c&&(F.types=v_(F.types,D[1].types)))}else{const D={positions:S};c&&(D.edgeTypes=T),C.length&&(D.holeIndices=C),o.push(D)}}return o}function u5(t,e,n,r,i,s,c){const o=(i-r)/n,f=[],m=[],x=[],S=[],T=[];let C,R,D;const H=Zm(t,o-1,n,r);let F=Math.sign(c&8?H[1]-s[3]:H[0]-s[2]),k=e&&e[o-1],N=0,U=0;for(let ie=0;ie<o;ie++)C=Zm(t,ie,n,r,C),R=Math.sign(c&8?C[1]-s[3]:C[0]-s[2]),D=e&&e[r/n+ie],R&&F&&F!==R&&(gE(H,C,c,s,T),la(f,T)&&x.push(k),la(m,T)&&S.push(k)),R<=0?(la(f,C)&&x.push(D),N-=R):x.length&&(x[x.length-1]=c5),R>=0?(la(m,C)&&S.push(D),U+=R):S.length&&(S[S.length-1]=c5),mE(H,C),F=R,k=D;return[N?{pos:f,types:e&&x}:null,U?{pos:m,types:e&&S}:null]}function wB(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function Ffe(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function zfe(t,e,n,r){let i=1/0,s=-1/0,c=1/0,o=-1/0;for(let f=0;f<n;f+=e){const m=t[f],x=t[f+1];i=m<i?m:i,s=m>s?m:s,c=x<c?x:c,o=x>o?x:o}return r[0][0]=i,r[0][1]=c,r[1][0]=s,r[1][1]=o,r}const Nfe=85.051129;function Bfe(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},c=t.slice(r,i);EB(c,n,0,i-r);const o=bB(c,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const f of o)TB(f,n);return o}function Ufe(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const c=[],o=[];let f=0,m=0;for(let S=0;S<=e.length;S++){const T=e[S]||t.length,C=m,R=Vfe(t,r,f,T);for(let D=R;D<T;D++)c[m++]=t[D];for(let D=f;D<R;D++)c[m++]=t[D];EB(c,r,C,m),Gfe(c,r,C,m,n==null?void 0:n.maxLatitude),f=T,o[S]=m}o.pop();const x=xB(c,o,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const S of x)TB(S.positions,r);return x}function Vfe(t,e,n,r){let i=-1,s=-1;for(let c=n+1;c<r;c+=e){const o=Math.abs(t[c]);o>i&&(i=o,s=c-1)}return s}function Gfe(t,e,n,r,i=Nfe){const s=t[n],c=t[r-e];if(Math.abs(s-c)>180){const o=Zm(t,0,e,n);o[0]+=Math.round((c-s)/360)*360,la(t,o),o[1]=Math.sign(o[1])*i,la(t,o),o[0]=s,la(t,o)}}function EB(t,e,n,r){let i=t[0],s;for(let c=n;c<r;c+=e){s=t[c];const o=s-i;(o>180||o<-180)&&(s-=Math.round(o/360)*360),t[c]=i=s}}function TB(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function jfe(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let c=0;c<t.length;c++)for(let o=0;o<e;o++)i[c*e+o]=t[c][o]||0}else i=t;return n?bB(i,{size:e,gridResolution:n}):r?Bfe(i,{size:e}):i}const Hfe=1,Wfe=2,Xx=4;class Kfe extends gB{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?jfe(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(d5(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&d5(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:c}=n;r.fill(0,s,s+c),i?(r[s]=Xx,r[s+c-2]=Xx):(r[s]+=Hfe,r[s+c-2]+=Wfe),r[s+c-1]=Xx}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,c=new Array(3);for(let o=i,f=0;f<s;o++,f++)this.getPointOnPath(e,f,c),r[o*3]=c[0],r[o*3+1]=c[1],r[o*3+2]=c[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function d5(t){return Array.isArray(t[0])}const qfe=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Xfe=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,SB=[0,0,0,255],Zfe={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:SB},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Zx={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class xR extends zl{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(){return super.getShaders({vs:qfe,fs:Xfe,modules:[Lg,Rg]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:Zx,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Zx,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:Zx,defaultValue:SB},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new Kfe({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:o}=this.state,f=n.data.attributes||{};o.updateGeometry({data:n.data,geometryBuffer:f.getPath,buffers:f,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var c;const{gl:o}=this.context;(c=this.state.model)===null||c===void 0||c.delete(),this.state.model=this._getModel(o),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:c,widthScale:o,widthMinPixels:f,widthMaxPixels:m}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Yu[c],widthScale:o,miterLimit:s,widthMinPixels:f,widthMaxPixels:m}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Qu(e,{...this.getShaders(),id:this.props.id,geometry:new Cg({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}K(xR,"defaultProps",Zfe);K(xR,"layerName","PathLayer");var sv={},Yfe={get exports(){return sv},set exports(t){sv=t}};Yfe.exports=_b;sv.default=_b;function _b(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=AB(t,0,i,n,!0),c=[];if(!s||s.next===s.prev)return c;var o,f,m,x,S,T,C;if(r&&(s=npe(t,e,s,n)),t.length>80*n){o=m=t[0],f=x=t[1];for(var R=n;R<i;R+=n)S=t[R],T=t[R+1],S<o&&(o=S),T<f&&(f=T),S>m&&(m=S),T>x&&(x=T);C=Math.max(m-o,x-f),C=C!==0?32767/C:0}return Ym(s,c,n,o,f,C,0),c}function AB(t,e,n,r,i){var s,c;if(i===vE(t,e,n,r)>0)for(s=e;s<n;s+=r)c=h5(s,t[s],t[s+1],c);else for(s=n-r;s>=e;s-=r)c=h5(s,t[s],t[s+1],c);return c&&vb(c,c.next)&&(Qm(c),c=c.next),c}function rd(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(vb(n,n.next)||Gr(n.prev,n,n.next)===0)){if(Qm(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Ym(t,e,n,r,i,s,c){if(t){!c&&s&&ape(t,r,i,s);for(var o=t,f,m;t.prev!==t.next;){if(f=t.prev,m=t.next,s?Qfe(t,r,i,s):Jfe(t)){e.push(f.i/n|0),e.push(t.i/n|0),e.push(m.i/n|0),Qm(t),t=m.next,o=m.next;continue}if(t=m,t===o){c?c===1?(t=epe(rd(t),e,n),Ym(t,e,n,r,i,s,2)):c===2&&tpe(t,e,n,r,i,s):Ym(rd(t),e,n,r,i,s,1);break}}}}function Jfe(t){var e=t.prev,n=t,r=t.next;if(Gr(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,c=r.x,o=e.y,f=n.y,m=r.y,x=i<s?i<c?i:c:s<c?s:c,S=o<f?o<m?o:m:f<m?f:m,T=i>s?i>c?i:c:s>c?s:c,C=o>f?o>m?o:m:f>m?f:m,R=r.next;R!==e;){if(R.x>=x&&R.x<=T&&R.y>=S&&R.y<=C&&Ih(i,o,s,f,c,m,R.x,R.y)&&Gr(R.prev,R,R.next)>=0)return!1;R=R.next}return!0}function Qfe(t,e,n,r){var i=t.prev,s=t,c=t.next;if(Gr(i,s,c)>=0)return!1;for(var o=i.x,f=s.x,m=c.x,x=i.y,S=s.y,T=c.y,C=o<f?o<m?o:m:f<m?f:m,R=x<S?x<T?x:T:S<T?S:T,D=o>f?o>m?o:m:f>m?f:m,H=x>S?x>T?x:T:S>T?S:T,F=yE(C,R,e,n,r),k=yE(D,H,e,n,r),N=t.prevZ,U=t.nextZ;N&&N.z>=F&&U&&U.z<=k;){if(N.x>=C&&N.x<=D&&N.y>=R&&N.y<=H&&N!==i&&N!==c&&Ih(o,x,f,S,m,T,N.x,N.y)&&Gr(N.prev,N,N.next)>=0||(N=N.prevZ,U.x>=C&&U.x<=D&&U.y>=R&&U.y<=H&&U!==i&&U!==c&&Ih(o,x,f,S,m,T,U.x,U.y)&&Gr(U.prev,U,U.next)>=0))return!1;U=U.nextZ}for(;N&&N.z>=F;){if(N.x>=C&&N.x<=D&&N.y>=R&&N.y<=H&&N!==i&&N!==c&&Ih(o,x,f,S,m,T,N.x,N.y)&&Gr(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;U&&U.z<=k;){if(U.x>=C&&U.x<=D&&U.y>=R&&U.y<=H&&U!==i&&U!==c&&Ih(o,x,f,S,m,T,U.x,U.y)&&Gr(U.prev,U,U.next)>=0)return!1;U=U.nextZ}return!0}function epe(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!vb(i,s)&&PB(i,r,r.next,s)&&Jm(i,s)&&Jm(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),Qm(r),Qm(r.next),r=t=s),r=r.next}while(r!==t);return rd(r)}function tpe(t,e,n,r,i,s){var c=t;do{for(var o=c.next.next;o!==c.prev;){if(c.i!==o.i&&upe(c,o)){var f=CB(c,o);c=rd(c,c.next),f=rd(f,f.next),Ym(c,e,n,r,i,s,0),Ym(f,e,n,r,i,s,0);return}o=o.next}c=c.next}while(c!==t)}function npe(t,e,n,r){var i=[],s,c,o,f,m;for(s=0,c=e.length;s<c;s++)o=e[s]*r,f=s<c-1?e[s+1]*r:t.length,m=AB(t,o,f,r,!1),m===m.next&&(m.steiner=!0),i.push(cpe(m));for(i.sort(rpe),s=0;s<i.length;s++)n=ipe(i[s],n);return n}function rpe(t,e){return t.x-e.x}function ipe(t,e){var n=spe(t,e);if(!n)return e;var r=CB(n,t);return rd(r,r.next),rd(n,n.next)}function spe(t,e){var n=e,r=t.x,i=t.y,s=-1/0,c;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var o=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>s&&(s=o,c=n.x<n.next.x?n:n.next,o===r))return c}n=n.next}while(n!==e);if(!c)return null;var f=c,m=c.x,x=c.y,S=1/0,T;n=c;do r>=n.x&&n.x>=m&&r!==n.x&&Ih(i<x?r:s,i,m,x,i<x?s:r,i,n.x,n.y)&&(T=Math.abs(i-n.y)/(r-n.x),Jm(n,t)&&(T<S||T===S&&(n.x>c.x||n.x===c.x&&ope(c,n)))&&(c=n,S=T)),n=n.next;while(n!==f);return c}function ope(t,e){return Gr(t.prev,t,e.prev)<0&&Gr(e.next,t,t.next)<0}function ape(t,e,n,r){var i=t;do i.z===0&&(i.z=yE(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,lpe(i)}function lpe(t){var e,n,r,i,s,c,o,f,m=1;do{for(n=t,t=null,s=null,c=0;n;){for(c++,r=n,o=0,e=0;e<m&&(o++,r=r.nextZ,!!r);e++);for(f=m;o>0||f>0&&r;)o!==0&&(f===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,f--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,m*=2}while(c>1);return t}function yE(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function cpe(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Ih(t,e,n,r,i,s,c,o){return(i-c)*(e-o)>=(t-c)*(s-o)&&(t-c)*(r-o)>=(n-c)*(e-o)&&(n-c)*(s-o)>=(i-c)*(r-o)}function upe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!dpe(t,e)&&(Jm(t,e)&&Jm(e,t)&&hpe(t,e)&&(Gr(t.prev,t,e.prev)||Gr(t,e.prev,e))||vb(t,e)&&Gr(t.prev,t,t.next)>0&&Gr(e.prev,e,e.next)>0)}function Gr(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function vb(t,e){return t.x===e.x&&t.y===e.y}function PB(t,e,n,r){var i=x_(Gr(t,e,n)),s=x_(Gr(t,e,r)),c=x_(Gr(n,r,t)),o=x_(Gr(n,r,e));return!!(i!==s&&c!==o||i===0&&b_(t,n,e)||s===0&&b_(t,r,e)||c===0&&b_(n,t,r)||o===0&&b_(n,e,r))}function b_(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function x_(t){return t>0?1:t<0?-1:0}function dpe(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&PB(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Jm(t,e){return Gr(t.prev,t,t.next)<0?Gr(t,e,t.next)>=0&&Gr(t,t.prev,e)>=0:Gr(t,e,t.prev)<0||Gr(t,t.next,e)<0}function hpe(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function CB(t,e){var n=new _E(t.i,t.x,t.y),r=new _E(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function h5(t,e,n,r){var i=new _E(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Qm(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function _E(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}_b.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,c=Math.abs(vE(t,0,s,n));if(i)for(var o=0,f=e.length;o<f;o++){var m=e[o]*n,x=o<f-1?e[o+1]*n:t.length;c-=Math.abs(vE(t,m,x,n))}var S=0;for(o=0;o<r.length;o+=3){var T=r[o]*n,C=r[o+1]*n,R=r[o+2]*n;S+=Math.abs((t[T]-t[R])*(t[C+1]-t[T+1])-(t[T]-t[C])*(t[R+1]-t[T+1]))}return c===0&&S===0?0:Math.abs((S-c)/c)};function vE(t,e,n,r){for(var i=0,s=e,c=n-r;s<n;s+=r)i+=(t[c]-t[s])*(t[s+1]+t[c+1]),c=s;return i}_b.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var c=0;c<e;c++)n.vertices.push(t[i][s][c]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};const w_=_B.CLOCKWISE,f5=_B.COUNTER_CLOCKWISE,Ac={isClosed:!0};function fpe(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function nm(t){return"positions"in t?t.positions:t}function l0(t){return"holeIndices"in t?t.holeIndices:null}function ppe(t){return Array.isArray(t[0])}function mpe(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function gpe(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function ype(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function p5(t,e,n,r,i){let s=e;const c=n.length;for(let o=0;o<c;o++)for(let f=0;f<r;f++)t[s++]=n[o][f]||0;if(!gpe(n))for(let o=0;o<r;o++)t[s++]=n[0][o]||0;return Ac.start=e,Ac.end=s,Ac.size=r,vB(t,i,Ac),s}function m5(t,e,n,r,i=0,s,c){s=s||n.length;const o=s-i;if(o<=0)return e;let f=e;for(let m=0;m<o;m++)t[f++]=n[i+m];if(!ype(n,r,i,s))for(let m=0;m<r;m++)t[f++]=n[i+m];return Ac.start=e,Ac.end=f,Ac.size=r,vB(t,c,Ac),f}function _pe(t,e){fpe(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let c=0;for(let o=0;o<=s.length;o++)c=m5(n,c,i,e,s[o-1],s[o],o===0?w_:f5),r.push(c);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!ppe(t))return m5(n,0,t,e,0,n.length,w_),n;if(!mpe(t)){let i=0;for(const[s,c]of t.entries())i=p5(n,i,c,e,s===0?w_:f5),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return p5(n,0,t,e,w_),n}function Yx(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const c=(s+1)%r;i+=t[s*3+e]*t[c*3+n],i-=t[c*3+e]*t[s*3+n]}return Math.abs(i/2)}function g5(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const c=s*3,o=t[c+0],f=t[c+1],m=t[c+2];t[c+e]=o,t[c+n]=f,t[c+r]=m}}function vpe(t,e,n,r){let i=l0(t);i&&(i=i.map(o=>o/e));let s=nm(t);const c=r&&e===3;if(n){const o=s.length;s=s.slice();const f=[];for(let m=0;m<o;m+=e){f[0]=s[m],f[1]=s[m+1],c&&(f[2]=s[m+2]);const x=n(f);s[m]=x[0],s[m+1]=x[1],c&&(s[m+2]=x[2])}}if(c){const o=Yx(s,0,1),f=Yx(s,0,2),m=Yx(s,1,2);if(!o&&!f&&!m)return[];o>f&&o>m||(f>m?(n||(s=s.slice()),g5(s,0,2,1)):(n||(s=s.slice()),g5(s,2,0,1)))}return sv(s,i,e)}class bpe extends gB{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=_pe(e,this.positionSize);return this.opts.resolution?xB(nm(n),l0(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Ufe(nm(n),l0(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(y5(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return nm(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&y5(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:c,typedArrayManager:o}=this;let f=s.indices;if(!f||!e)return;let m=i;const x=vpe(e,this.positionSize,this.opts.preproject,this.opts.full3d);f=o.allocate(f,i+x.length,{copy:!0});for(let S=0;S<x.length;S++)f[m++]=x[S]+r;c[n+1]=i+x.length,s.indices=f}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const c=nm(e);for(let o=n,f=0;f<r;o++,f++){const m=c[f*s],x=c[f*s+1],S=s>2?c[f*s+2]:0;i[o*3]=m,i[o*3+1]=x,i[o*3+2]=S}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,c=e&&l0(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),c)for(let o=0;o<c.length;o++)s[n+c[o]/i-1]=0;s[n+r-1]=0}}function y5(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const IB=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,xpe=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(IB,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),wpe=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(IB,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Epe=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,ov=[0,0,0,255],Tpe={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:ov},getLineColor:{type:"accessor",value:ov},material:!0},E_={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class wR extends zl{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?xpe:wpe,fs:Epe,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Lg,ice,Rg]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===qn.DEFAULT&&(r=qn.LNGLAT);let s;r===qn.LNGLAT&&(i?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new bpe({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||nR(e,Pr.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const c=this.getAttributeManager(),o=!0;c.remove(["instancePickingColors"]),c.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:E_,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,transition:E_,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:E_,accessor:"getFillColor",defaultValue:ov,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:E_,accessor:"getLineColor",defaultValue:ov,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(f,{index:m,target:x})=>this.encodePickingColor(f&&f.__source?f.__source.index:m,x),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:c,sideModel:o,polygonTesselator:f}=this.state,m={...e,extruded:!!n,elevationScale:s};o&&(o.setInstanceCount(f.instanceCount-1),o.setUniforms(m),i&&(o.setDrawMode(3),o.setUniforms({isWireframe:!0}).draw()),r&&(o.setDrawMode(6),o.setUniforms({isWireframe:!1}).draw())),c&&(c.setVertexCount(f.vertexCount),c.setUniforms(m).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var o;(o=this.state.models)===null||o===void 0||o.forEach(f=>f.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,c=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:c.getPolygon,buffers:c,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,c;if(r){const o=this.getShaders("top");o.defines.NON_INSTANCED_MODEL=1,s=new Qu(e,{...o,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(c=new Qu(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Cg({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),c.userData.excludeAttributes={indices:!0}),{models:[c,s].filter(Boolean),topModel:s,sideModel:c}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}K(wR,"defaultProps",Tpe);K(wR,"layerName","SolidPolygonLayer");function Spe({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,c=t.length;let o=c,f=c;for(let T=0;T<c;T++){const C=e(t[T]);if(o>T&&C>=i&&(o=T),C>=s){f=T;break}}let m=o;const S=f-o!==r.length?t.slice(f):void 0;for(let T=0;T<r.length;T++)t[m++]=r[T];if(S){for(let T=0;T<S.length;T++)t[m++]=S[T];t.length=m}return{startRow:o,endRow:o+r.length}}function Ape(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?Ppe(t,r,n):null}function Ppe(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function Cpe(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let c=0;c<i.length;c++)e(i[c],s),n[r][c*3+0]=s[0],n[r][c*3+1]=s[1],n[r][c*3+2]=s[2]}return n}const Ipe=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Jx=192/256,_5=[],Lpe={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class ER extends yb{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:Ipe}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&Ln.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,c=i?Math.max(r,Jx*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:Jx,outlineBuffer:c,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:o}=this.state;o.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:Jx}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):_5}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):_5}}K(ER,"defaultProps",Lpe);K(ER,"layerName","MultiIconLayer");const Em=1e20;class Rpe{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:c="normal",fontStyle:o="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const f=this.size=e+n*4,m=this._createCanvas(f),x=this.ctx=m.getContext("2d",{willReadFrequently:!0});x.font=`${o} ${c} ${e}px ${s}`,x.textBaseline="alphabetic",x.textAlign="left",x.fillStyle="black",this.gridOuter=new Float64Array(f*f),this.gridInner=new Float64Array(f*f),this.f=new Float64Array(f),this.z=new Float64Array(f+1),this.v=new Uint16Array(f)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:c}=this.ctx.measureText(e),o=Math.ceil(r),f=0,m=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(c-s))),x=Math.min(this.size-this.buffer,o+Math.ceil(i)),S=m+2*this.buffer,T=x+2*this.buffer,C=Math.max(S*T,0),R=new Uint8ClampedArray(C),D={data:R,width:S,height:T,glyphWidth:m,glyphHeight:x,glyphTop:o,glyphLeft:f,glyphAdvance:n};if(m===0||x===0)return D;const{ctx:H,buffer:F,gridInner:k,gridOuter:N}=this;H.clearRect(F,F,m,x),H.fillText(e,F,F+o);const U=H.getImageData(F,F,m,x);N.fill(Em,0,C),k.fill(0,0,C);for(let ie=0;ie<x;ie++)for(let he=0;he<m;he++){const le=U.data[4*(ie*m+he)+3]/255;if(le===0)continue;const ve=(ie+F)*S+he+F;if(le===1)N[ve]=0,k[ve]=Em;else{const Oe=.5-le;N[ve]=Oe>0?Oe*Oe:0,k[ve]=Oe<0?Oe*Oe:0}}v5(N,0,0,S,T,S,this.f,this.v,this.z),v5(k,F,F,m,x,S,this.f,this.v,this.z);for(let ie=0;ie<C;ie++){const he=Math.sqrt(N[ie])-Math.sqrt(k[ie]);R[ie]=Math.round(255-255*(he/this.radius+this.cutoff))}return D}}function v5(t,e,n,r,i,s,c,o,f){for(let m=e;m<e+r;m++)b5(t,n*s+m,s,i,c,o,f);for(let m=n;m<n+i;m++)b5(t,m*s+e,1,r,c,o,f)}function b5(t,e,n,r,i,s,c){s[0]=0,c[0]=-Em,c[1]=Em,i[0]=t[e];for(let o=1,f=0,m=0;o<r;o++){i[o]=t[e+o*n];const x=o*o;do{const S=s[f];m=(i[o]-i[S]+x-S*S)/(o-S)/2}while(m<=c[f]&&--f>-1);f++,s[f]=o,c[f]=m,c[f+1]=Em}for(let o=0,f=0;o<r;o++){for(;c[f+1]<o;)f++;const m=s[f],x=o-m;t[e+o*n]=i[m]+x*x}}const $pe=32,Mpe=[];function kpe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Ope({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:c=0,yOffset:o=0}){let f=0,m=c;const x=n+r*2;for(const S of t)if(!s[S]){const T=e(S);m+T+r*2>i&&(m=0,f++),s[S]={x:m+r,y:o+f*x+r,width:T,height:x,layoutWidth:T,layoutHeight:n},m+=T+r*2}return{mapping:s,xOffset:m,yOffset:o+f*x,canvasHeight:kpe(o+(f+1)*x)}}function LB(t,e,n,r){let i=0;for(let c=e;c<n;c++){var s;const o=t[c];i+=((s=r[o])===null||s===void 0?void 0:s.layoutWidth)||0}return i}function RB(t,e,n,r,i,s){let c=e,o=0;for(let f=e;f<n;f++){const m=LB(t,f,f+1,i);o+m>r&&(c<f&&s.push(f),c=f,o=0),o+=m}return o}function Dpe(t,e,n,r,i,s){let c=e,o=e,f=e,m=0;for(let x=e;x<n;x++)if((t[x]===" "||t[x+1]===" "||x+1===n)&&(f=x+1),f>o){let S=LB(t,o,f,i);m+S>r&&(c<o&&(s.push(o),c=o,m=0),S>r&&(S=RB(t,o,f,r,i,s),c=s[s.length-1])),o=f,m+=S}return m}function Fpe(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const c=[];return e==="break-all"?RB(t,i,s,n,r,c):Dpe(t,i,s,n,r,c),c}function zpe(t,e,n,r,i,s){let c=0,o=0;for(let f=e;f<n;f++){const m=t[f],x=r[m];x?(o||(o=x.layoutHeight),i[f]=c+x.layoutWidth/2,c+=x.layoutWidth):(Ln.warn("Missing character: ".concat(m," (").concat(m.codePointAt(0),")"))(),i[f]=c,c+=$pe)}s[0]=c,s[1]=o}function Npe(t,e,n,r,i){const s=Array.from(t),c=s.length,o=new Array(c),f=new Array(c),m=new Array(c),x=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,S=[0,0],T=[0,0];let C=0,R=0,D=0;for(let F=0;F<=c;F++){const k=s[F];if((k===`
`||F===c)&&(D=F),D>R){const N=x?Fpe(s,n,r,i,R,D):Mpe;for(let U=0;U<=N.length;U++){const ie=U===0?R:N[U-1],he=U<N.length?N[U]:D;zpe(s,ie,he,i,o,T);for(let le=ie;le<he;le++){var H;const ve=s[le],Oe=((H=i[ve])===null||H===void 0?void 0:H.layoutOffsetY)||0;f[le]=C+T[1]/2+Oe,m[le]=T[0]}C=C+T[1]*e,S[0]=Math.max(S[0],T[0])}R=D}k===`
`&&(o[R]=0,f[R]=0,m[R]=0,R++)}return S[1]=C,{x:o,y:f,rowWidth:m,size:S}}function Bpe({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const c=t.BYTES_PER_ELEMENT,o=n?n/c:1,f=r?r/c:0,m=i[e]||Math.ceil((t.length-f)/o),x=s&&new Set,S=new Array(e);let T=t;if(o>1||f>0){const C=t.constructor;T=new C(m);for(let R=0;R<m;R++)T[R]=t[R*o+f]}for(let C=0;C<e;C++){const R=i[C],D=i[C+1]||m,H=T.subarray(R,D);S[C]=String.fromCodePoint.apply(null,H),x&&H.forEach(x.add,x)}if(x)for(const C of x)s.add(String.fromCodePoint(C));return{texts:S,characterCount:m}}class $B{constructor(e=5){K(this,"limit",void 0),K(this,"_cache",{}),K(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function Upe(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const Bh={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:Upe(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},x5=1024,w5=.9,E5=1.2,MB=3;let av=new $B(MB);function Vpe(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=av.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function Gpe(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function T5(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function jpe(t){Ln.assert(Number.isFinite(t)&&t>=MB,"Invalid cache limit"),av=new $B(t)}class Hpe{constructor(){K(this,"props",{...Bh}),K(this,"_key",void 0),K(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*E5+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=Vpe(this._key,this.props.characterSet),r=av.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,av.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:c,sdf:o,radius:f,cutoff:m}=this.props;let x=n&&n.data;x||(x=document.createElement("canvas"),x.width=x5);const S=x.getContext("2d",{willReadFrequently:!0});T5(S,r,s,i);const{mapping:T,canvasHeight:C,xOffset:R,yOffset:D}=Ope({getFontWidth:H=>S.measureText(H).width,fontHeight:s*E5,buffer:c,characterSet:e,maxCanvasWidth:x5,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(x.height!==C){const H=S.getImageData(0,0,x.width,x.height);x.height=C,S.putImageData(H,0,0)}if(T5(S,r,s,i),o){const H=new Rpe({fontSize:s,buffer:c,radius:f,cutoff:m,fontFamily:r,fontWeight:"".concat(i)});for(const F of e){const{data:k,width:N,height:U,glyphTop:ie}=H.draw(F);T[F].width=N,T[F].layoutOffsetY=s*w5-ie;const he=S.createImageData(N,U);Gpe(k,he),S.putImageData(he,T[F].x,T[F].y)}}else for(const H of e)S.fillText(H,T[H].x,T[H].y+c+s*w5);return{xOffset:R,yOffset:D,mapping:T,data:x,width:x.width,height:x.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:c,cutoff:o}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(c," ").concat(o):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const Wpe=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,Kpe=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,qpe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class TR extends zl{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(){return super.getShaders({vs:Wpe,fs:Kpe,modules:[Lg,Rg]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:c,getLineWidth:o}=this.props;let{padding:f}=this.props;f.length<4&&(f=[f[0],f[1],f[0],f[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!o,padding:f,sizeUnits:Yu[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:c}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Qu(e,{...this.getShaders(),id:this.props.id,geometry:new Cg({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}K(TR,"defaultProps",qpe);K(TR,"layerName","TextBackgroundLayer");const S5={start:1,middle:0,end:-1},A5={top:1,center:0,bottom:-1},Qx=[0,0,0,255],Xpe=1,Zpe={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Qx},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Bh.characterSet},fontFamily:Bh.fontFamily,fontWeight:Bh.fontWeight,lineHeight:Xpe,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Qx},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Qx},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class SR extends vR{constructor(...e){super(...e),K(this,"state",void 0),K(this,"getBoundingRect",(n,r)=>{let{size:[i,s]}=this.transformParagraph(n,r);const{fontSize:c}=this.state.fontAtlasManager.props;i/=c,s/=c;const{getTextAnchor:o,getAlignmentBaseline:f}=this.props,m=S5[typeof o=="function"?o(n,r):o],x=A5[typeof f=="function"?f(n,r):f];return[(m-1)*i/2,(x-1)*s/2,i,s]}),K(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:c,y:o,rowWidth:f,size:[m,x]}=this.transformParagraph(n,r),S=S5[typeof i=="function"?i(n,r):i],T=A5[typeof s=="function"?s(n,r):s],C=c.length,R=new Array(C*2);let D=0;for(let H=0;H<C;H++){const F=(1-S)*(m-f[H])/2;R[D++]=(S-1)*m/2+F+c[H],R[D++]=(T-1)*x/2+o[H]}return R})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new Hpe},this.props.maxWidth>0&&Ln.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,c={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(c),!0;for(const o in c)if(c[o]!==i.props[o])return i.setProps(c),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,c=n.startIndices,o;const f=r==="auto"&&new Set;if(i&&c){const{texts:m,characterCount:x}=Bpe({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:c,characterSet:f});o=x,s=(S,{index:T})=>m[T]}else{const{iterable:m,objectInfo:x}=gb(n);c=[0],o=0;for(const S of m){x.index++;const T=Array.from(s(S,x)||"");f&&T.forEach(f.add,f),o+=T.length,c.push(o)}}this.setState({getText:s,startIndices:c,numInstances:o,characterSet:f||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:c,lineHeight:o,maxWidth:f}=this.props,m=s(e,n)||"";return Npe(m,o,c,f*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:c},styleVersion:o}=this.state,{data:f,_dataDiff:m,getPosition:x,getColor:S,getSize:T,getAngle:C,getPixelOffset:R,getBackgroundColor:D,getBorderColor:H,getBorderWidth:F,backgroundPadding:k,background:N,billboard:U,fontSettings:ie,outlineWidth:he,outlineColor:le,sizeScale:ve,sizeUnits:Oe,sizeMinPixels:Re,sizeMaxPixels:Ee,transitions:$e,updateTriggers:we}=this.props,Be=this.getSubLayerClass("characters",ER),Jt=this.getSubLayerClass("background",TR);return[N&&new Jt({getFillColor:D,getLineColor:H,getLineWidth:F,padding:k,getPosition:x,getSize:T,getAngle:C,getPixelOffset:R,billboard:U,sizeScale:ve,sizeUnits:Oe,sizeMinPixels:Re,sizeMaxPixels:Ee,transitions:$e&&{getPosition:$e.getPosition,getAngle:$e.getAngle,getSize:$e.getSize,getFillColor:$e.getBackgroundColor,getLineColor:$e.getBorderColor,getLineWidth:$e.getBorderWidth,getPixelOffset:$e.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:we.getPosition,getAngle:we.getAngle,getSize:we.getSize,getFillColor:we.getBackgroundColor,getLineColor:we.getBorderColor,getLineWidth:we.getBorderWidth,getPixelOffset:we.getPixelOffset,getBoundingRect:{getText:we.getText,getTextAnchor:we.getTextAnchor,getAlignmentBaseline:we.getAlignmentBaseline,styleVersion:o}}}),{data:f.attributes&&f.attributes.background?{length:f.length,attributes:f.attributes.background}:f,_dataDiff:m,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new Be({sdf:ie.sdf,smoothing:Number.isFinite(ie.smoothing)?ie.smoothing:Bh.smoothing,outlineWidth:he/(ie.radius||Bh.radius),outlineColor:le,iconAtlas:s,iconMapping:c,getPosition:x,getColor:S,getSize:T,getAngle:C,getPixelOffset:R,billboard:U,sizeScale:ve*i,sizeUnits:Oe,sizeMinPixels:Re*i,sizeMaxPixels:Ee*i,transitions:$e&&{getPosition:$e.getPosition,getAngle:$e.getAngle,getColor:$e.getColor,getSize:$e.getSize,getPixelOffset:$e.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:we.getText,getPosition:we.getPosition,getAngle:we.getAngle,getColor:we.getColor,getSize:we.getSize,getPixelOffset:we.getPixelOffset,getIconOffsets:{getTextAnchor:we.getTextAnchor,getAlignmentBaseline:we.getAlignmentBaseline,styleVersion:o}}}),{data:f,_dataDiff:m,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){jpe(e)}}K(SR,"defaultProps",Zpe);K(SR,"layerName","TextLayer");const c0={circle:{type:bR,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:yb,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:SR,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},u0={type:xR,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},bE={type:wR,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Bp({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function ew(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const c=e[s];let o=t.props[s];s.startsWith("get")&&(o=t.getSubLayerAccessor(o),i.updateTriggers[c]=r[s],n&&(i.transitions[c]=n[s])),i[c]=o}return i}function Ype(t){if(Array.isArray(t))return t;switch(Ln.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Ln.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function P5(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let c=i;c<s;c++){const o=t[c],{geometry:f}=o;if(f)if(f.type==="GeometryCollection"){Ln.assert(Array.isArray(f.geometries),"GeoJSON does not have geometries array");const{geometries:m}=f;for(let x=0;x<m.length;x++){const S=m[x];C5(S,r,e,o,c)}}else C5(f,r,e,o,c)}return r}function C5(t,e,n,r,i){const{type:s,coordinates:c}=t,{pointFeatures:o,lineFeatures:f,polygonFeatures:m,polygonOutlineFeatures:x}=e;if(!Qpe(s,c)){Ln.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":o.push(n({geometry:t},r,i));break;case"MultiPoint":c.forEach(S=>{o.push(n({geometry:{type:"Point",coordinates:S}},r,i))});break;case"LineString":f.push(n({geometry:t},r,i));break;case"MultiLineString":c.forEach(S=>{f.push(n({geometry:{type:"LineString",coordinates:S}},r,i))});break;case"Polygon":m.push(n({geometry:t},r,i)),c.forEach(S=>{x.push(n({geometry:{type:"LineString",coordinates:S}},r,i))});break;case"MultiPolygon":c.forEach(S=>{m.push(n({geometry:{type:"Polygon",coordinates:S}},r,i)),S.forEach(T=>{x.push(n({geometry:{type:"LineString",coordinates:T}},r,i))})});break}}const Jpe={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function Qpe(t,e){let n=Jpe[t];for(Ln.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function kB(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function T_(t){return t.geometry.coordinates}function eme(t,e){const n=kB(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:c}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=T_,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=T_,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=T_,n.polygonsOutline.data=c,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=T_,n}function tme(t,e){const n=kB(),{points:r,lines:i,polygons:s}=t,c=Cpe(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:c.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:c.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:c.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:c.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const nme=["points","linestrings","polygons"],rme={...Bp(c0.circle),...Bp(c0.icon),...Bp(c0.text),...Bp(u0),...Bp(bE),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Tm extends vR{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=tme(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=Ype(e.data),i=this.getSubLayerRow.bind(this);let s={};const c={};if(Array.isArray(n.dataChanged)){const f=this.state.features;for(const m in f)s[m]=f[m].slice(),c[m]=[];for(const m of n.dataChanged){const x=P5(r,i,m);for(const S in f)c[S].push(Spe({data:s[S],getIndex:T=>T.__source.index,dataRange:m,replace:x[S]}))}}else s=P5(r,i);const o=eme(s,c);this.setState({features:s,featuresDiff:c,layerProps:o})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=nme.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,bE.type);if(s){const c=ew(this,bE.props),o=e&&n;return o||delete c.getLineColor,c.updateTriggers.lineColors=o,new s(c,this.getSubLayerProps({id:i,updateTriggers:c.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",c=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,u0.type),o=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,u0.type);if(c||o){const f=ew(this,u0.props);return[c&&new c(f,this.getSubLayerProps({id:i,updateTriggers:f.updateTriggers}),r.polygonsOutline),o&&new o(f,this.getSubLayerProps({id:s,updateTriggers:f.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(o=>o.__source.index===i));const s=new Set(e.split("+")),c=[];for(const o of s){const f="points-".concat(o),m=c0[o],x=m&&this.shouldRenderSubLayer(f,n.points.data)&&this.getSubLayerClass(f,m.type);if(x){const S=ew(this,m.props);let T=n.points;if(o==="text"&&r){const{instancePickingColors:C,...R}=T.data.attributes;T={...T,data:{...T.data,attributes:R}}}c.push(new x(S,this.getSubLayerProps({id:f,updateTriggers:S.updateTriggers,highlightedObjectIndex:i}),T))}}return c}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:c}=i,o=Ape(s,c);return e(o,i)}}}K(Tm,"layerName","GeoJsonLayer");K(Tm,"defaultProps",rme);const ime=typeof window<"u"?ee.useLayoutEffect:ee.useEffect,sme=ime;function lv(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const ome={position:"absolute",zIndex:-1};function OB(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>OB(n,e));if(bb(t)){if(ame(t))return e.style=ome,ee.cloneElement(t,e);if(lme(t))return ee.cloneElement(t,e)}return t}function bb(t){return t&&typeof t=="object"&&"type"in t||!1}function ame(t){const e=t.type,n=e&&e.defaultProps;return n&&n.mapStyle}function lme(t){const e=t.type;return e&&e.deckGLViewProps}function xE(t){if(typeof t=="function")return ee.createElement(hf,{},t);if(Array.isArray(t))return t.map(xE);if(bb(t)){if(t.type===ee.Fragment)return xE(t.props.children);if(lv(t.type,hf))return t}return t}function cme({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return ee.Children.forEach(xE(t),c=>{if(bb(c)){const o=c.type;if(lv(o,zl)){const f=ume(o,c.props);i.push(f)}else r.push(c);if(lv(o,hf)&&o!==hf&&c.props.id){const f=new o(c.props);s[f.id]=f}}else c&&r.push(c)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(c=>{s[c.id]=c}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function ume(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function dme({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const c of t){let o=s,f=c;bb(c)&&lv(c.type,hf)&&(o=c.props.id||s,f=c.props.children);const m=r.getViewport(o),x=r.getViewState(o);if(m){x.padding=m.padding;const{x:S,y:T,width:C,height:R}=m;f=OB(f,{x:S,y:T,width:C,height:R,viewport:m,viewState:x}),i[o]||(i[o]={viewport:m,children:[]}),i[o].children.push(f)}}return Object.keys(i).map(c=>{const{viewport:o,children:f}=i[c],{x:m,y:x,width:S,height:T}=o,C={position:"absolute",left:m,top:x,width:S,height:T},R="view-".concat(c),D=ee.createElement("div",{key:R,id:R,style:C},...f);if(n){const H={viewport:o,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:F=>{F.viewId=c,e._onViewStateChange(F)}};return ee.createElement(n,{key:R,value:H},D)}return D})}const hme={mixBlendMode:null};function fme({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in hme?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function pme(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function DB(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function mme(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():DB(t)}});return r}const FB=ee.forwardRef((t,e)=>{const[n,r]=ee.useState(0),s=ee.useRef({control:null,version:n,forceUpdate:()=>r(ie=>ie+1)}).current,c=ee.useRef(null),o=ee.useRef(null),f=ee.useMemo(()=>cme(t),[t.layers,t.views,t.children]);let m=!0;const x=ie=>{var he;return m&&t.viewState?(s.viewStateUpdateRequested=ie,null):(s.viewStateUpdateRequested=null,(he=t.onViewStateChange)===null||he===void 0?void 0:he.call(t,ie))},S=ie=>{if(m)s.interactionStateUpdateRequested=ie;else{var he;s.interactionStateUpdateRequested=null,(he=t.onInteractionStateChange)===null||he===void 0||he.call(t,ie)}},T=ee.useMemo(()=>{const ie={...t,style:null,width:"100%",height:"100%",parent:c.current,canvas:o.current,layers:f.layers,views:f.views,onViewStateChange:x,onInteractionStateChange:S};return delete ie._customRender,s.deck&&s.deck.setProps(ie),ie},[t]);ee.useEffect(()=>{const ie=t.Deck||mb;return s.deck=mme(s,ie,{...T,parent:c.current,canvas:o.current}),()=>{var he;return(he=s.deck)===null||he===void 0?void 0:he.finalize()}},[]),sme(()=>{DB(s);const{viewStateUpdateRequested:ie,interactionStateUpdateRequested:he}=s;ie&&x(ie),he&&S(he)}),ee.useImperativeHandle(e,()=>pme(s),[]);const C=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:R,width:D,height:H,id:F,style:k}=t,{containerStyle:N,canvasStyle:U}=ee.useMemo(()=>fme({width:D,height:H,style:k}),[D,H,k]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===C||s.version!==n){s.lastRenderedViewports=C,s.version=n;const ie=dme({children:f.children,deck:s.deck,ContextProvider:R}),he=ee.createElement("canvas",{key:"canvas",id:F||"deckgl-overlay",ref:o,style:U});s.control=ee.createElement("div",{id:"".concat(F||"deckgl","-wrapper"),ref:c,style:N},[he,ie])}return m=!1,s.control});FB.defaultProps=mb.defaultProps;const gme=FB;function eg(t){"@babel/helpers - typeof";return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eg(t)}function yme(t,e){if(eg(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(eg(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _me(t){var e=yme(t,"string");return eg(e)==="symbol"?e:String(e)}function Kn(t,e,n){return e=_me(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I5(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class L5{constructor(e,n){Kn(this,"name",void 0),Kn(this,"type",void 0),Kn(this,"sampleSize",1),Kn(this,"time",void 0),Kn(this,"count",void 0),Kn(this,"samples",void 0),Kn(this,"lastTiming",void 0),Kn(this,"lastSampleTime",void 0),Kn(this,"lastSampleCount",void 0),Kn(this,"_count",0),Kn(this,"_time",0),Kn(this,"_samples",0),Kn(this,"_startTime",0),Kn(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=I5(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(I5()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class vme{constructor(e){Kn(this,"id",void 0),Kn(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof L5?this.stats[n]=e:this.stats[n]=new L5(n,r)),this.stats[n]}}function zB(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Kc(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||zB()}const d0={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},S_=d0.window||d0.self||d0.global,Up=d0.process||{},NB=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Kc();const tw=globalThis;function bme(t){if(!t&&!Kc())return"Node";if(zB(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":tw.chrome?"Chrome":tw.safari?"Safari":tw.mozInnerScreenX?"Firefox":"Unknown"}function xme(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class wme{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";Kn(this,"storage",void 0),Kn(this,"id",void 0),Kn(this,"config",void 0),this.storage=xme(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function Eme(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function Tme(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function nw(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,c=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(c/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(c,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(c,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let cv;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(cv||(cv={}));function R5(t){return typeof t=="string"?cv[t.toUpperCase()]||cv.WHITE:t}function Sme(t,e,n){return!Kc&&typeof t=="string"&&(e&&(e=R5(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=R5(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function Ame(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function uv(t,e){if(!t)throw new Error(e||"Assertion failed")}function Qd(){let t;if(Kc&&"performance"in S_){var e,n;t=S_==null||(e=S_.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Up){var r;const i=Up==null||(r=Up.hrtime)===null||r===void 0?void 0:r.call(Up);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const eh={debug:Kc&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Pme={enabled:!0,level:0};function Do(){}const $5={},M5={once:!0};class BB{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};Kn(this,"id",void 0),Kn(this,"VERSION",NB),Kn(this,"_startTs",Qd()),Kn(this,"_deltaTs",Qd()),Kn(this,"_storage",void 0),Kn(this,"userData",{}),Kn(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new wme("__probe-".concat(this.id,"__"),Pme),this.timeStamp("".concat(this.id," started")),Ame(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Qd()-this._startTs).toPrecision(10))}getDelta(){return Number((Qd()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){uv(e,n)}warn(e){return this._getLogFunction(0,e,eh.warn,arguments,M5)}error(e){return this._getLogFunction(0,e,eh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,eh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,eh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,eh.debug||eh.info,arguments,M5)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Do,r&&[r],{tag:Rme(n)}):Do}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:c=1}=e;return this._shouldLog(n||r)?Kc?Lme({image:i,message:s,scale:c}):Ime():Do}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Do)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=k5({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Do)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=UB(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=k5({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,uv(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Qd();const c=s.tag||s.message;if(s.once)if(!$5[c])$5[c]=Qd();else return Do;return n=Cme(this.id,s.message,s),r.bind(console,n,...s.args)}return Do}}Kn(BB,"VERSION",NB);function UB(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return uv(Number.isFinite(e)&&e>=0),e}function k5(t){const{logLevel:e,message:n}=t;t.logLevel=UB(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return uv(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function Cme(t,e,n){if(typeof e=="string"){const r=n.time?Tme(Eme(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=Sme(e,n.color,n.background)}return e}function Ime(t){return console.warn("removed"),Do}function Lme(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const c=nw(s,n,r);console.log(...c)},s.src=e,Do}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...nw(e,n,r)),Do;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...nw(s,n,r)),s.src=e.toDataURL(),Do}return Do}function Rme(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const rn=new BB({id:"luma.gl"});function Bs(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const $me="Invalid WebGLRenderingContext",Mme="Requires WebGL2";function AR(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Yn(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function kme(t){return Yn(t)?t:null}function PR(t){return Bs(AR(t),$me),t}function Us(t){return Bs(Yn(t),Mme),t}const rm={};function Ome(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function Dme(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function Fme(t,e){rm[t]=!0,e!==void 0&&Ome(e)}function zme(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(rm[r]=!0);while(r!==0);for(r in rm)if(rm[r])return delete rm[r],parseInt(r,10);return 0}}const Mg=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Mg.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Mg.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const md=function(e){const n=this;this.gl=e,zme(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const c=n.currentVertexArrayObject;c.maxAttrib=Math.max(c.maxAttrib,s);const o=c.attribs[s];return o.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const c=n.currentVertexArrayObject;c.maxAttrib=Math.max(c.maxAttrib,s);const o=c.attribs[s];return o.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,c){switch(s){case 34962:n.currentArrayBuffer=c;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=c;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,c){const f=n.currentVertexArrayObject.attribs[s];switch(c){case 34975:return f.buffer;case 34338:return f.enabled;case 34339:return f.size;case 34340:return f.stride;case 34341:return f.type;case 34922:return f.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,c,o,f,m,x){const S=n.currentVertexArrayObject;S.maxAttrib=Math.max(S.maxAttrib,s);const T=S.attribs[s];return T.buffer=n.currentArrayBuffer,T.size=c,T.type=o,T.normalized=f,T.stride=m,T.offset=x,T.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{Dme("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};md.prototype.VERTEX_ARRAY_BINDING_OES=34229;md.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Mg(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};md.prototype.createVertexArrayOES=function(){const e=new Mg(this);return this.vertexArrayObjects.push(e),e};md.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};md.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Mg&&e.hasBeenBound&&e.ext===this)};md.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){Fme(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let c=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let f=0;f<=o;f++){const m=s.attribs[f],x=i?i.attribs[f]:null;if((!i||m.enabled!==x.enabled)&&(m.enabled?r.enableVertexAttribArray.call(n,f):r.disableVertexAttribArray.call(n,f)),m.enabled){let S=!1;(!i||m.buffer!==x.buffer)&&(c!==m.buffer&&(r.bindBuffer.call(n,34962,m.buffer),c=m.buffer),S=!0),(S||m.cached!==x.cached)&&r.vertexAttribPointer.call(n,f,m.size,m.type,m.normalized,m.stride,m.offset)}}this.currentArrayBuffer!==c&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function Nme(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new md(this)),this.__OESVertexArrayObject))}}const O5="OES_element_index",D5="WEBGL_draw_buffers",Bme="EXT_disjoint_timer_query",Ume="EXT_disjoint_timer_query_webgl2",Vme="EXT_texture_filter_anisotropic",F5="WEBGL_debug_renderer_info",Gme=35723,jme=4352,Hme=36795,Wme=34047,Kme=37445,qme=37446,br=t=>Yn(t)?void 0:0,Xme={[3074]:t=>Yn(t)?void 0:36064,[Gme]:t=>Yn(t)?void 0:jme,[35977]:br,[32937]:br,[Hme]:(t,e)=>{const n=Yn(t)?t.getExtension(Ume):t.getExtension(Bme);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[Kme]:(t,e)=>{const n=t.getExtension(F5);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[qme]:(t,e)=>{const n=t.getExtension(F5);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[Wme]:(t,e)=>{const n=t.luma.extensions[Vme];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:br,[35071]:br,[37447]:br,[36063]:(t,e)=>{if(!Yn(t)){const n=t.getExtension(D5);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:br,[35374]:br,[35377]:br,[34852]:t=>{if(!Yn(t)){const e=t.getExtension(D5);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(O5)?2147483647:65535,[33001]:t=>t.getExtension(O5)?16777216:65535,[33e3]:t=>16777216,[37157]:br,[35373]:br,[35657]:br,[36183]:br,[37137]:br,[34045]:br,[35978]:br,[35979]:br,[35968]:br,[35376]:br,[35375]:br,[35659]:br,[37154]:br,[35371]:br,[35658]:br,[35076]:br,[35077]:br,[35380]:br};function Zme(t,e,n){const r=Xme[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const Yme="OES_vertex_array_object",VB="ANGLE_instanced_arrays",Jme="WEBGL_draw_buffers",Qme="EXT_disjoint_timer_query",ege="EXT_texture_filter_anisotropic",tge="VertexArray requires WebGL2 or OES_vertex_array_object extension";function nge(t,e){return{webgl2:Yn(t),ext:t.getExtension(e)}}const GB={[Yme]:{meta:{suffix:"OES"},createVertexArray:()=>{Bs(!1,tge)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[VB]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Bs(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[Jme]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Bs(!1)}},[Qme]:{meta:{suffix:"EXT"},createQuery:()=>{Bs(!1)},deleteQuery:()=>{Bs(!1)},beginQuery:()=>{Bs(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},rw={readBuffer:(t,e,n)=>{Yn(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=nge(t,VB);let c;switch(r){case 35069:c=i?void 0:!1;break;case 35070:c=!i&&!s?0:void 0;break}return c!==void 0?c:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Yn(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!Yn(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[ege];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:Zme,hint(t,e,n,r){return e(n,r)}};function rge(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(Nme(t),ige(t),oge(t,GB),sge(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=rge;function ige(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function sge(t,e){let{target:n,target2:r}=e;Object.keys(rw).forEach(i=>{if(typeof rw[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},c=rw[i].bind(null,t,s);n[i]=c,r[i]=c}})}function oge(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&age(t,{extension:n,target:t.luma,target2:t})}function age(t,e){let{extension:n,target:r,target2:i}=e;const s=GB[n];Bs(s);const{meta:c={}}=s,{suffix:o=""}=c,f=t.getExtension(n);for(const m of Object.keys(s)){const x="".concat(m).concat(o);let S=null;m==="meta"||typeof t[m]=="function"||(f&&typeof f[x]=="function"?S=function(){return f[x](...arguments)}:typeof s[m]=="function"&&(S=s[m].bind(r))),S&&(r[m]=S,i[m]=S)}}const jB={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},fc=(t,e,n)=>e?t.enable(n):t.disable(n),z5=(t,e,n)=>t.hint(n,e),ao=(t,e,n)=>t.pixelStorei(n,e),lge=(t,e)=>{const n=Yn(t)?36009:36160;return t.bindFramebuffer(n,e)},cge=(t,e)=>t.bindFramebuffer(36008,e);function Vp(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const uge={[3042]:fc,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:fc,[2885]:(t,e)=>t.cullFace(e),[2929]:fc,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:fc,[35723]:z5,[36006]:lge,[2886]:(t,e)=>t.frontFace(e),[33170]:z5,[2849]:(t,e)=>t.lineWidth(e),[32823]:fc,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:fc,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:fc,[3088]:(t,e)=>t.scissor(...e),[2960]:fc,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:ao,[3317]:ao,[37440]:ao,[37441]:ao,[37443]:ao,[3330]:ao,[3332]:ao,[3331]:ao,[36010]:cge,[3314]:ao,[32878]:ao,[3316]:ao,[3315]:ao,[32877]:ao,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Vp(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Vp(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Vp(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Vp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,c,o]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,c,o)},stencilOp:(t,e)=>{e=Vp(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,c,o]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,c,o)},viewport:(t,e)=>t.viewport(...e)};function Qr(t,e,n){return e[t]!==void 0?e[t]:n[t]}const dge={blendEquation:(t,e,n)=>t.blendEquationSeparate(Qr(32777,e,n),Qr(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Qr(32969,e,n),Qr(32968,e,n),Qr(32971,e,n),Qr(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Qr(32824,e,n),Qr(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Qr(32938,e,n),Qr(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Qr(2962,e,n),Qr(2967,e,n),Qr(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Qr(34816,e,n),Qr(36003,e,n),Qr(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Qr(2964,e,n),Qr(2965,e,n),Qr(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Qr(34817,e,n),Qr(34818,e,n),Qr(34819,e,n))},N5={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,i)=>t({[32773]:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,i)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:i}),clearColor:(t,e,n,r,i)=>t({[3106]:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,i)=>t({[3107]:[e,n,r,i]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,i)=>t({[3088]:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({[2978]:[e,n,r,i]})},$a=(t,e)=>t.isEnabled(e),B5={[3042]:$a,[2884]:$a,[2929]:$a,[3024]:$a,[32823]:$a,[32926]:$a,[32928]:$a,[3089]:$a,[2960]:$a,[35977]:$a};function HB(t){for(const e in t)return!1;return!0}function hge(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function U5(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function fge(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,c=new Array(s),o=0;o<s;o++)c[o]=arguments[o];const{valueChanged:f,oldValue:m}=n(t.state._updateCache,...c);return f&&r(...c),m},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function pge(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class mge{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?_ge(e):Object.assign({},jB),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Bs(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];WB(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Bs(s!==void 0);const c=e[s],o=this.cache[s];hge(c,o)||(n=!0,r=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=c)}return{valueChanged:n,oldValue:r}}}function gge(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Bs(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new mge(t,{copyState:r}),pge(t);for(const s in N5){const c=N5[s];fge(t,s,c)}U5(t,"getParameter"),U5(t,"isEnabled")}return t.state.enable=n,t}function yge(t){t.state||gge(t,{copyState:!1}),t.state.push()}function V5(t){Bs(t.state),t.state.pop()}function WB(t,e){if(Bs(AR(t),"setParameters requires a WebGL context"),HB(e))return;const n={};for(const i in e){const s=Number(i),c=uge[i];c&&(typeof c=="string"?n[c]=!0:c(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=dge[i];s(t,e,r)}}function _ge(t,e){if(e=e||jB,typeof e=="number"){const i=e,s=B5[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=B5[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function Uh(t,e,n){if(HB(e))return n(t);const{nocatch:r=!0}=e;yge(t),WB(t,e);let i;if(r)i=n(t),V5(t);else try{i=n(t)}finally{V5(t)}return i}Kc();const Sm="8.5.20",vge="set luma.log.level=1 (or higher) to trace rendering";class bge{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new vme({id:e})),this.stats.get(e)}}const im=new bge;if(globalThis.luma&&globalThis.luma.VERSION!==Sm)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Sm));globalThis.luma||(Kc()&&rn.log(1,"luma.gl ".concat(Sm," - ").concat(vge))(),globalThis.luma=globalThis.luma||{VERSION:Sm,version:Sm,log:rn,stats:im,globals:{modules:{},nodeIO:{}}});function Xt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function iw(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return Xt(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function Fc(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const sw={};function id(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";sw[t]=sw[t]||1;const e=sw[t]++;return"".concat(t,"-").concat(e)}function G5(t){return Xt(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function wE(t){let e=!0;for(const n in t){e=!1;break}return e}function KB(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(c=>{s.methodName||(s[c]=()=>{throw rn.removed("Calling removed method ".concat(e,".").concat(c,": "),i)(),new Error(c)})})}const th="Resource subclass must define virtual methods";class qc{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};PR(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||id(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=iw(this.gl,e),Xt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=Yn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,f="webgl2"in i?i.webgl2:i.webgl1;return s?f:o}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=Yn(this.gl),c={},o=n||Object.keys(i);for(const f of o){const m=i[f];if(m&&(!("webgl2"in m)||s)&&(!("extension"in m)||this.gl.getExtension(m.extension))){const S=r?Fc(this.gl,f):f;c[S]=this.getParameter(f,e),r&&m.type==="GLenum"&&(c[S]=Fc(this.gl,c[S]))}}return c}setParameter(e,n){e=iw(this.gl,e),Xt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=Yn(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=iw(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return KB(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(th)}_deleteHandle(){throw new Error(th)}_bindHandle(e){throw new Error(th)}_getOptsFromHandle(){throw new Error(th)}_getParameter(e,n){throw new Error(th)}_setParameter(e,n){throw new Error(th)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=im.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];im.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=im.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=im.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}}const xge="Failed to deduce GL constant from typed array";function EE(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(xge)}}function tg(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function wge(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const c=n*i;s=s||new Uint8Array(c);for(let o=0;o<r/2;++o){const f=o*c,m=(r-o-1)*c;s.set(e.subarray(f,f+c)),e.copyWithin(f,m,m+c),e.set(s,m)}}function Ege(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),c=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let f=0;f<i;f++)for(let m=0;m<4;m++)c[(o*i+f)*4+m]=e[(o*2*n+f*2)*4+m];return{data:c,width:i,height:s}}function TE(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const o in r)if(o in e){const m=r[o]?"".concat(t,".").concat(r[o]):"N/A";rn.removed("".concat(t,".").concat(o),m)()}for(const o in i)if(o in e){const f=i[o];rn.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(f))()}let c=null;for(const o in s)if(o in e){const f=s[o];rn.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(f))(),c=c||Object.assign({},e),c[f]=e[o],delete c[o]}return c||e}const Tge={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Sge={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class po{static getBytesPerElement(e){return tg(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Xt(e.size),tg(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new po(Tge,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return po.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return po.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=TE("Accessor",e,Sge),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const j5=10,qB={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Age={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:qB},Pge={removedProps:qB};class As extends qc{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/po.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/po.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=TE("Buffer",e,Age),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=TE("Buffer",e,Pge),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new po(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;Xt(n);const c=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(c,this.handle),i!==0||s!==void 0?(Us(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(c,r,n),this.gl.bindBuffer(c,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:c}=this;return Us(c),c.bindBuffer(36662,n.handle),c.bindBuffer(36663,this.handle),c.copyBufferSubData(36662,36663,r,i,s),c.bindBuffer(36662,null),c.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Us(this.gl);const s=tg(this.accessor.type||5126,{clamped:!1}),c=this._getAvailableElementCount(n),o=r;let f,m;e?(m=e.length,f=m-o):(f=Math.min(c,i||c),m=o+f);const x=Math.min(c,f);return i=i||x,Xt(i<=x),e=e||new s(m),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(Xt(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(j5,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Xt(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,j5),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=EE(e);return Xt(s),this.setAccessor(new po(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Xt(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=tg(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new po(this.accessor,{type:EE(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return rn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return rn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return rn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return rn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new po(this.accessor,e),this}}const CR={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},Cge={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},Ige={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function Lge(t,e){const n=CR[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=Yn(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function Rge(t,e){const n=CR[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const $ge=[9729,9728],H5=globalThis.WebGLBuffer||function(){};class dv extends qc{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&Lge(e,r),s=s&&(!i||Rge(e,r))),s}constructor(e,n){const{id:r=id("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(k=>this.initialize(Object.assign({},e,{pixels:k,data:k}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:c=0,recreate:o=!1,parameters:f={},pixelStore:m={},textureUnit:x=void 0}=e;n||(n=i);let{width:S,height:T,dataFormat:C,type:R,compressed:D=!1,mipmaps:H=!0}=e;const{depth:F=0}=e;return{width:S,height:T,compressed:D,dataFormat:C,type:R}=this._deduceParameters({format:s,type:R,dataFormat:C,compressed:D,data:n,width:S,height:T}),this.width=S,this.height=T,this.depth=F,this.format=s,this.type=R,this.dataFormat=C,this.border=c,this.textureUnit=x,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),H&&this._isNPOT()&&(rn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),H=!1,this._updateForNPOT(f)),this.mipmaps=H,this.setImageData({data:n,width:S,height:T,depth:F,format:s,type:R,dataFormat:C,border:c,mipmaps:H,parameters:m,compressed:D}),H&&this.generateMipmap(),this.setParameters(f),o&&(this.data=n),r&&(this._video={video:n,parameters:f,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(rn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Uh(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:c=this.border,offset:o=0,parameters:f={}}=e;let{data:m=null,type:x=this.type,width:S=this.width,height:T=this.height,dataFormat:C=this.dataFormat,compressed:R=!1}=e;m||(m=r),{type:x,dataFormat:C,compressed:R,width:S,height:T}=this._deduceParameters({format:s,type:x,dataFormat:C,compressed:R,data:m,width:S,height:T});const{gl:D}=this;D.bindTexture(this.target,this.handle);let H=null;({data:m,dataType:H}=this._getDataType({data:m,compressed:R}));let F,k=0;if(Uh(this.gl,f,()=>{switch(H){case"null":D.texImage2D(n,i,s,S,T,c,C,x,m);break;case"typed-array":D.texImage2D(n,i,s,S,T,c,C,x,m,o);break;case"buffer":F=Us(D),F.bindBuffer(35052,m.handle||m),F.texImage2D(n,i,s,S,T,c,C,x,o),F.bindBuffer(35052,null);break;case"browser-object":Yn(D)?D.texImage2D(n,i,s,S,T,c,C,x,m):D.texImage2D(n,i,s,C,x,m);break;case"compressed":for(const[N,U]of m.entries())D.compressedTexImage2D(n,N,U.format,U.width,U.height,c,U.data),k+=U.levelSize;break;default:Xt(!1,"Unknown image data type")}}),H==="compressed")this._trackAllocatedMemory(k,"Texture");else if(m&&m.byteLength)this._trackAllocatedMemory(m.byteLength,"Texture");else{const N=Cge[this.dataFormat]||4,U=Ige[this.type]||1;this._trackAllocatedMemory(this.width*this.height*N*U,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:c=0,width:o=this.width,height:f=this.height,level:m=0,format:x=this.format,type:S=this.type,dataFormat:T=this.dataFormat,compressed:C=!1,offset:R=0,border:D=this.border,parameters:H={}}=e;if({type:S,dataFormat:T,compressed:C,width:o,height:f}=this._deduceParameters({format:x,type:S,dataFormat:T,compressed:C,data:i,width:o,height:f}),Xt(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const F=i;i=F.data,o=F.shape[0],f=F.shape[1]}i instanceof As&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Uh(this.gl,H,()=>{if(C)this.gl.compressedTexSubImage2D(n,m,s,c,o,f,x,i);else if(i===null)this.gl.texSubImage2D(n,m,s,c,o,f,T,S,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,m,s,c,o,f,T,S,i,R);else if(i instanceof H5){const F=Us(this.gl);F.bindBuffer(35052,i),F.texSubImage2D(n,m,s,c,o,f,T,S,R),F.bindBuffer(35052,null)}else Yn(this.gl)?Us(this.gl).texSubImage2D(n,m,s,c,o,f,T,S,i):this.gl.texSubImage2D(n,m,s,c,T,S,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return rn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof As?{data:n.handle,dataType:"buffer"}:n instanceof H5?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:c,type:o,compressed:f}=e;const m=CR[n];return c=c||m&&m.dataFormat,o=o||m&&m.types[0],f=f||m&&m.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:c,type:o,compressed:f,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},Xt(i,"Could not deduced texture size"),Xt(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),Xt(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Xt(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Yn(this.gl)||!this.width||!this.height?!1:!G5(this.width)||!G5(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:$ge.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let Mge="";function kge(t,e){return Xt(typeof t=="string"),t=Mge+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class IR extends dv{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return dv.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};PR(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:kge(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const Au="EXT_color_buffer_float",W5={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:Au,bpp:2},[33327]:{gl2:Au,bpp:4},[34842]:{gl2:Au,bpp:8},[33326]:{gl2:Au,bpp:4},[33328]:{gl2:Au,bpp:8},[34836]:{gl2:Au,bpp:16},[35898]:{gl2:Au,bpp:4}};function Oge(t,e,n){const r=n[e];if(!r)return!1;const i=Yn(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class sm extends qc{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||Oge(e,n,W5)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return Xt(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&Yn(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*W5[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const Dge=256,Fge=1024,zge=16384,K5=6144,q5=6145,X5=6146,Z5=34041,XB="clear: bad arguments";function LR(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let c=0;n&&(c|=zge,n!==!0&&(s.clearColor=n)),r&&(c|=Dge,r!==!0&&(s.clearDepth=r)),i&&(c|=Fge,r!==!0&&(s.clearStencil=r)),Xt(c!==0,XB),Uh(t,s,()=>{t.clear(c)})}function Nge(t){let{framebuffer:e=null,buffer:n=K5,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Us(t),Uh(t,{framebuffer:e},()=>{switch(n){case K5:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case q5:t.clearBufferfv(q5,0,[i]);break;case X5:t.clearBufferiv(X5,0,[i]);break;case Z5:const[s,c]=i;t.clearBufferfi(Z5,0,s,c);break;default:Xt(!1,XB)}})}function Bge(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Xt(!1),0}}function ZB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:c=null,sourceWidth:o,sourceHeight:f,sourceType:m}=e;const{framebuffer:x,deleteFramebuffer:S}=Uge(t);Xt(x);const{gl:T,handle:C,attachments:R}=x;o=o||x.width,f=f||x.height,s===36064&&C===null&&(s=1028),Xt(R[s]),m=m||R[s].type,c=Vge(c,m,i,o,f),m=m||EE(c);const D=T.bindFramebuffer(36160,C);return T.readPixels(n,r,o,f,i,m,c),T.bindFramebuffer(36160,D||null),S&&x.delete(),c}function Y5(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=ZB(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=Ege({data:r,width:i,height:s}));wge({data:r,width:i,height:s});const c=document.createElement("canvas");c.width=i,c.height=s;const o=c.getContext("2d"),f=o.createImageData(i,s);return f.data.set(r),o.putImageData(f,0,0),c.toDataURL()}function Uge(t){return t instanceof fa?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:Yge(t),deleteFramebuffer:!0}}function Vge(t,e,n,r,i){if(t)return t;e=e||5121;const s=tg(e,{clamped:!1}),c=Bge(n);return new s(r*i*c)}const ei={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function Gge(t){const e=new IR(t,{format:6408,type:5126,dataFormat:6408}),n=new fa(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const YB={[ei.WEBGL2]:[!1,!0],[ei.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[ei.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[ei.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[ei.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[ei.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[ei.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[ei.FLOAT_BLEND]:["EXT_float_blend"],[ei.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[ei.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[ei.TEXTURE_FLOAT]:["OES_texture_float",!0],[ei.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[ei.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[ei.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[ei.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[ei.COLOR_ATTACHMENT_RGBA32F]:[Gge,"EXT_color_buffer_float"],[ei.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[ei.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[ei.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[ei.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[ei.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[ei.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},jge=2;function Hge(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in YB)t.luma.caps[e]===void 0&&(t.luma.caps[e]=Wge(t,e));return t.luma.caps}function Wge(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=Kge(t,e)),t.luma.caps[e]||rn.log(jge,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function Kge(t,e){const n=YB[e];Xt(n,e);let r;const i=Yn(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:Xt(!1);return r}const J5="Multiple render targets not supported";class fa extends qc{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new fa(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Us(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Us(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:c=!0,stencil:o=!1,check:f=!0,readBuffer:m=void 0,drawBuffers:x=void 0}=e;if(Xt(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const S in i){const T=i[S];(Array.isArray(T)?T[0]:T).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,c,o,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:m,drawBuffers:x}),i&&f&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:c=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:c});const{gl:o}=this,f=o.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,f||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return Xt(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&rn.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(c=>{i[c]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const c in i){Xt(c!==void 0,"Misspelled framebuffer binding point?");const o=Number(c),f=i[o];let m=f;if(!m)this._unattach(o);else if(m instanceof sm)this._attachRenderbuffer({attachment:o,renderbuffer:m});else if(Array.isArray(f)){const[x,S=0,T=0]=f;m=x,this._attachTexture({attachment:o,texture:x,layer:S,level:T})}else this._attachTexture({attachment:o,texture:m,layer:0,level:0});r&&m&&m.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(c=>!this.attachments[c]).forEach(c=>{delete this.attachments[c]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(Xge(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,c=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&LR(this.gl,{color:n,depth:r,stencil:i}),s.forEach((o,f)=>{Nge(this.gl,{drawBuffer:f,value:o})}),this.gl.bindFramebuffer(36160,c||null),this}readPixels(){return rn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return rn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return rn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return rn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return rn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return rn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:c}=e;const o=Us(this.gl),f=o.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&c===void 0?o.invalidateFramebuffer(36008,n):o.invalidateFramebuffer(36008,n,r,i,s,c),o.bindFramebuffer(36008,f),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=Fc(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const c=n?Fc(this.gl,s):s;i[c]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),c=e?Fc(this.gl,s):s;r[c]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(Y5(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>rn.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=Y5(this,{targetMaxHeight:100});return rn.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let c=null;return e&&(c=c||{},c[36064]=new IR(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(c[36064])),n&&r?(c=c||{},c[33306]=new sm(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(c[33306])):n?(c=c||{},c[36096]=new sm(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(c[36096])):r&&Xt(!1),c}_unattach(e){const n=this.attachments[e];n&&(n instanceof sm?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:c}=this;switch(c.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Us(c).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const f=qge(i);c.framebufferTexture2D(36160,n,f,r.handle,s);break;case 3553:c.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:Xt(!1,"Illegal texture type")}c.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=kme(this.gl);n?n.readBuffer(e):Xt(e===36064||e===1029,J5),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=Us(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):Xt(e.length===1&&(e[0]===36064||e[0]===1029),J5)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=Hge(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function qge(t){return t<34069?t+34069:t}function Xge(t){return(fa.STATUS||{})[t]||"Framebuffer error ".concat(t)}const Zge=[36049,36048,33296,33298,33299,33300,33301,33302,33303];fa.ATTACHMENT_PARAMETERS=Zge;function Yge(t,e){const{gl:n,width:r,height:i,id:s}=t;return new fa(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{[36064]:t}}))}function h0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const Jge=35632,Qge=35633;function eye(t){switch(t){case Jge:return"fragment";case Qge:return"vertex";default:return"unknown type"}}function tye(t,e,n,r){const i=t.split(/\r?\n/),s={},c={},o=r||h0(e)||"(unnamed)",f="".concat(eye(n)," shader ").concat(o);for(let x=0;x<i.length;x++){const S=i[x];if(S.length<=1)continue;const T=S.split(":"),C=T[0],R=parseInt(T[2],10);if(isNaN(R))throw new Error("GLSL compilation error in ".concat(f,": ").concat(t));C!=="WARNING"?s[R]=S:c[R]=S}const m=nye(e);return{shaderName:f,errors:Q5(s,m),warnings:Q5(c,m)}}function Q5(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],c=s.split(":",3),o=c[0],f=parseInt(c[1],10)||0,m=s.substring(c.join(":").length+1).trim();n+=JB("^^^ ".concat(o,": ").concat(m,`

`),f)}}return n}function nye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,c)=>{const o=String(c+e),f=o.length;return JB(o,i-f)+n+s})}function JB(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}const rye="Shader: GLSL source code must be a JavaScript string";class ng extends qc{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Xt(!1),"unknown"}}constructor(e,n){PR(e),Xt(typeof n.source=="string",rye);const r=h0(n.source,null)||n.id||id("unnamed ".concat(ng.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=h0(n,null);r&&(this.id=id(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(ng.getTypeName(this.shaderType),":").concat(this.id)}getName(){return h0(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:c}=tye(r,this.source,this.shaderType,this.id);throw rn.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),rn.warn("GLSL compilation warnings in ".concat(i,`
`).concat(c))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class ow extends ng{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class aw extends ng{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const iye={[5126]:Sr.bind(null,"uniform1fv",lo,1,cs),[35664]:Sr.bind(null,"uniform2fv",lo,2,cs),[35665]:Sr.bind(null,"uniform3fv",lo,3,cs),[35666]:Sr.bind(null,"uniform4fv",lo,4,cs),[5124]:Sr.bind(null,"uniform1iv",pc,1,cs),[35667]:Sr.bind(null,"uniform2iv",pc,2,cs),[35668]:Sr.bind(null,"uniform3iv",pc,3,cs),[35669]:Sr.bind(null,"uniform4iv",pc,4,cs),[35670]:Sr.bind(null,"uniform1iv",pc,1,cs),[35671]:Sr.bind(null,"uniform2iv",pc,2,cs),[35672]:Sr.bind(null,"uniform3iv",pc,3,cs),[35673]:Sr.bind(null,"uniform4iv",pc,4,cs),[35674]:Sr.bind(null,"uniformMatrix2fv",lo,4,cl),[35675]:Sr.bind(null,"uniformMatrix3fv",lo,9,cl),[35676]:Sr.bind(null,"uniformMatrix4fv",lo,16,cl),[35678]:qi,[35680]:qi,[5125]:Sr.bind(null,"uniform1uiv",A_,1,cs),[36294]:Sr.bind(null,"uniform2uiv",A_,2,cs),[36295]:Sr.bind(null,"uniform3uiv",A_,3,cs),[36296]:Sr.bind(null,"uniform4uiv",A_,4,cs),[35685]:Sr.bind(null,"uniformMatrix2x3fv",lo,6,cl),[35686]:Sr.bind(null,"uniformMatrix2x4fv",lo,8,cl),[35687]:Sr.bind(null,"uniformMatrix3x2fv",lo,6,cl),[35688]:Sr.bind(null,"uniformMatrix3x4fv",lo,12,cl),[35689]:Sr.bind(null,"uniformMatrix4x2fv",lo,8,cl),[35690]:Sr.bind(null,"uniformMatrix4x3fv",lo,12,cl),[35678]:qi,[35680]:qi,[35679]:qi,[35682]:qi,[36289]:qi,[36292]:qi,[36293]:qi,[36298]:qi,[36299]:qi,[36300]:qi,[36303]:qi,[36306]:qi,[36307]:qi,[36308]:qi,[36311]:qi},sye={},oye={},aye={},eO=[0];function RR(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(eO[0]=t,t=eO);const i=t.length;if(i%e&&rn.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let c=0;c<i;c++)s[c]=t[c];return s}function lo(t,e){return RR(t,e,Float32Array,sye)}function pc(t,e){return RR(t,e,Int32Array,oye)}function A_(t,e){return RR(t,e,Uint32Array,aye)}function tO(t,e,n){const r=iye[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function lye(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function cye(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!uye(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function uye(t){return Array.isArray(t)||ArrayBuffer.isView(t)?hye(t):isFinite(t)||t===!0||t===!1||t instanceof dv||t instanceof sm?!0:t instanceof fa?!!t.texture:!1}function dye(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function hye(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function qi(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Sr(t,e,n,r){let i=null,s=null;return(c,o,f)=>{const m=e(f,n),x=m.length;let S=!1;if(i===null)i=new Float32Array(x),s=x,S=!0;else{Xt(s===x,"Uniform length cannot change.");for(let T=0;T<x;++T)if(m[T]!==i[T]){S=!0;break}}return S&&(r(c,t,o,m),i.set(m)),S}}function cs(t,e,n,r){t[e](n,r)}function cl(t,e,n,r){t[e](n,!1,r)}const fye=5120,pye=5121,mye=5122,gye=5123,nO=0,P_=1,yye=2,_ye=3,C_=4,vye=5,bye=6,Ai=5126,xye=35664,wye=35665,Eye=35666,Gp=5124,Tye=35667,Sye=35668,Aye=35669,jp=5125,Pye=36294,Cye=36295,Iye=36296,Lye=35670,Rye=35671,$ye=35672,Mye=35673,kye=35674,Oye=35675,Dye=35676,Fye=35685,zye=35686,Nye=35687,Bye=35688,Uye=35689,Vye=35690,SE={[Ai]:[Ai,1,"float"],[xye]:[Ai,2,"vec2"],[wye]:[Ai,3,"vec3"],[Eye]:[Ai,4,"vec4"],[Gp]:[Gp,1,"int"],[Tye]:[Gp,2,"ivec2"],[Sye]:[Gp,3,"ivec3"],[Aye]:[Gp,4,"ivec4"],[jp]:[jp,1,"uint"],[Pye]:[jp,2,"uvec2"],[Cye]:[jp,3,"uvec3"],[Iye]:[jp,4,"uvec4"],[Lye]:[Ai,1,"bool"],[Rye]:[Ai,2,"bvec2"],[$ye]:[Ai,3,"bvec3"],[Mye]:[Ai,4,"bvec4"],[kye]:[Ai,8,"mat2"],[Fye]:[Ai,8,"mat2x3"],[zye]:[Ai,8,"mat2x4"],[Oye]:[Ai,12,"mat3"],[Nye]:[Ai,12,"mat3x2"],[Bye]:[Ai,12,"mat3x4"],[Dye]:[Ai,16,"mat4"],[Uye]:[Ai,16,"mat4x2"],[Vye]:[Ai,16,"mat4x3"]};function Gye(t){switch(t){case nO:return nO;case P_:return P_;case _ye:return P_;case yye:return P_;case C_:return C_;case vye:return C_;case bye:return C_;default:return Xt(!1),0}}function rO(t){const e=SE[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function QB(t,e){switch(t){case fye:case pye:case mye:case gye:t=Ai;break}for(const n in SE){const[r,i,s]=SE[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class jye{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:c,size:o}=n.getActiveAttrib(e.handle,i),f=n.getAttribLocation(e.handle,s);f>=0&&this._addAttribute(f,s,c,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Yn(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:c,size:o}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,c,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:c}=rO(r),o={type:s,size:i*c};this._inferProperties(e,n,o);const f={location:e,name:n,accessor:new po(o)};this.attributeInfos.push(f),this.attributeInfosByLocation[e]=f,this.attributeInfosByName[f.name]=f}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:c}=rO(r),o=new po({type:s,size:i*c}),f={location:e,name:n,accessor:o};this.varyingInfos.push(f),this.varyingInfosByName[f.name]=f}}const iO=4,Hye=35981,Wye=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class e9 extends qc{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",Wye),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:c=Hye}=e;return this.hash=n||"",this.vs=typeof r=="string"?new ow(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new aw(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,Xt(this.vs instanceof ow),Xt(this.fs instanceof aw),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Us(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,c)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new jye(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:c,end:o,isIndexed:f=!1,indexType:m=5123,instanceCount:x=0,isInstanced:S=x>0,vertexArray:T=null,transformFeedback:C,framebuffer:R,parameters:D={},uniforms:H,samplers:F}=e;if((H||F)&&(rn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(H||{})),rn.priority>=n){const k=R?R.id:"default",N="mode=".concat(Fc(this.gl,r)," verts=").concat(i," ")+"instances=".concat(x," indexType=").concat(Fc(this.gl,m)," ")+"isInstanced=".concat(S," isIndexed=").concat(f," ")+"Framebuffer=".concat(k);rn.log(n,N)()}return Xt(T),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||S&&x===0?!1:(T.bindForDraw(i,x,()=>{if(R!==void 0&&(D=Object.assign({},D,{framebuffer:R})),C){const k=Gye(r);C.begin(k)}this._bindTextures(),Uh(this.gl,D,()=>{f&&S?this.gl2.drawElementsInstanced(r,i,m,s,x):f&&Yn(this.gl)&&!isNaN(c)&&!isNaN(o)?this.gl2.drawRangeElements(r,c,o,i,m,s):f?this.gl.drawElements(r,i,m,s):S?this.gl2.drawArraysInstanced(r,s,i,x):this.gl.drawArrays(r,s,i)}),C&&C.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};rn.priority>=2&&cye(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,c=!1;if(s instanceof fa&&(s=s.texture),s instanceof dv)if(c=this.uniforms[n]!==r,c){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:f}=i;o.bind(f),s=f,this._textureUniforms[n]=o}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||c)&&dye(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new ow({handle:i});break;case 35632:r.fs=new aw({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=id(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),rn.time(iO,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),rn.timeEnd(iO,"linkProgram for ".concat(this._getName()))(),e.debug||rn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=lye(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=tO(e,s,r),r.size>1)for(let c=0;c<r.size;c++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(c,"]")),this._uniformSetters["".concat(i,"[").concat(c,"]")]=tO(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}class Kye extends qc{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Yn(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Us(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,wE(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:c}=this._getBufferParams(n);return r<0?(this.unused[e]=i,rn.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,c,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof As?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let I_=null;function qye(t){return(!I_||I_.byteLength<t)&&(I_=new ArrayBuffer(t)),I_}function Xye(t,e){const n=qye(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function Zye(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,c=i*s;let o=0;for(let f=r;o<s;o++)e[f++]=n[o];for(;o<c;)o<c-o?(e.copyWithin(r+o,r,r+o),o*=2):(e.copyWithin(r+o,r,r+c-o),o=c);return e}const Yye="elements must be GL.ELEMENT_ARRAY_BUFFER";class co extends qc{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Yn(e)||bme()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new co(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return co.MAX_ATTRIBUTES=co.MAX_ATTRIBUTES||e.getParameter(34921),co.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:co._setConstantFloatArray(e,n,r);break;case Int32Array:co._setConstantIntArray(e,n,r);break;case Uint32Array:co._setConstantUintArray(e,n,r);break;default:Xt(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return co.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Xt(!e||e.target===34963,Yye),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:c,offset:o,normalized:f,integer:m,divisor:x}=r,{gl:S,gl2:T}=this;return e=Number(e),this.bind(()=>{S.bindBuffer(34962,n.handle),m?(Xt(Yn(S)),T.vertexAttribIPointer(e,i,s,c,o)):S.vertexAttribPointer(e,i,s,f,c,o),S.enableVertexAttribArray(e),T.vertexAttribDivisor(e,x||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!co.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let c=!this.buffer;if(this.buffer=this.buffer||new As(this.gl,i),c=c||this.buffer.reallocate(i),c=c||!this._compareConstantArrayValues(r,this.bufferValue),c){const o=Xye(n.constructor,s);Zye({target:o,source:r,start:0,count:s}),this.buffer.subData(o),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:Xt(!1)}}static _setConstantIntArray(e,n,r){switch(Xt(Yn(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:Xt(!1)}}static _setConstantUintArray(e,n,r){switch(Xt(Yn(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:Xt(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return Xt(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const Jye="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Qye=/^(.+)__LOCATION_([0-9]+)$/,e_e=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class t_e{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new co(e),KB(this,"VertexArray","v6.0",e_e),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new As(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof As&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof As&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:c,name:o}=this._getAttributeIndex(e);if(!Number.isFinite(c)||c<0)return this.unused[e]=n,rn.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const f=this._getAttributeInfo(o||c);if(!f)return s;const m=this.accessors[c]||{},x=po.resolve(f.accessor,m,r,i),{size:S,type:T}=x;return Xt(Number.isFinite(S)&&Number.isFinite(T)),{location:c,accessor:x}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=Qye.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof As)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof As){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof As){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(Jye)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(co.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){co.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,c=s>0;if(e.isInstanced=e.isInstanced||c,r instanceof As){const o=r;if(c){const f=o.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,f)}else{const f=o.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,f)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return rn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function n_e(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let c=0;c<t.length&&c<n;++c)c>0&&(i+=",".concat(c%r===0?" ":"")),i+=rg(t[c],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function rg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return n_e(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function sO(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;Xt(n);const s=".*_.*",c=".*Matrix",o=n._uniformSetters,f={},m=Object.keys(o).sort();let x=0;for(const C of m)!C.match(s)&&!C.match(c)&&lw({table:f,header:e,uniforms:r,uniformName:C,undefinedOnly:i})&&x++;for(const C of m)C.match(c)&&lw({table:f,header:e,uniforms:r,uniformName:C,undefinedOnly:i})&&x++;for(const C of m)f[C]||lw({table:f,header:e,uniforms:r,uniformName:C,undefinedOnly:i})&&x++;let S=0;const T={};if(!i)for(const C in r){const R=r[C];f[C]||(S++,T[C]={Type:"NOT USED: ".concat(R),[e]:rg(R)})}return{table:f,count:x,unusedTable:T,unusedCount:S}}function lw(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const c=r[i],o=r_e(c);return!s||!o?(e[i]={[n]:o?rg(c):"N/A","Uniform Type":o?c:"NOT PROVIDED"},!0):!1}function r_e(t){return t!=null}function i_e(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=oO(e,e.elements,null,n));const i=e.values;for(const s in i){const c=e._getAttributeInfo(s);if(c){let o="".concat(s,": ").concat(c.name);const f=e.accessors[c.location];f&&(o="".concat(s,": ").concat(s_e(c.name,f))),r[o]=oO(e,i[s],f,n)}}return r}function oO(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",c=1,o=0,f=0,m,x,S;if(n&&(s=n.type,c=n.size,s=String(s).replace("Array",""),m=s.indexOf("nt")!==-1),e instanceof As){const T=e,{data:C,changed:R}=T.getDebugData();x=R?"*":"",S=C,f=T.byteLength,o=f/C.BYTES_PER_ELEMENT/c;let D;if(n){const H=n.divisor>0;D="".concat(H?"I ":"P "," ").concat(o," (x").concat(c,"=").concat(f," bytes ").concat(Fc(i,s),")")}else m=!0,D="".concat(f," bytes");return{[r]:"".concat(x).concat(rg(S,{size:c,isInteger:m})),"Format ":D}}return S=e,c=e.length,s=String(e.constructor.name).replace("Array",""),m=s.indexOf("nt")!==-1,{[r]:"".concat(rg(S,{size:c,isInteger:m})," (constant)"),"Format ":"".concat(c,"x").concat(s," (constant)")}}function s_e(t,e){const{type:n,size:r}=e,i=QB(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function o_e(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=aO(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=aO(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function aO(t){const{type:e,size:n}=t.accessor,r=QB(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const kg="vs",$R="fs";function Al(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const cw={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function a_e(t){const e={};for(const n in t){const r=t[n],i=l_e(r);e[n]=i}return e}function l_e(t){let e=lO(t);return e==="object"?t?"type"in t?Object.assign({},t,cw[t.type]):"value"in t?(e=lO(t.value),Object.assign({type:e},t,cw[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},cw[e])}function lO(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const c_e="vs",u_e="fs";class cO{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:c,getUniforms:o,deprecations:f=[],defines:m={},inject:x={},vertexShader:S,fragmentShader:T}=e;Al(typeof n=="string"),this.name=n,this.vs=r||S,this.fs=i||T,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(f),this.defines=m,this.injections=d_e(x),c&&(this.uniforms=a_e(c))}getModuleSource(e){let n;switch(e){case c_e:n=this.vs||"";break;case u_e:n=this.fs||"";break;default:Al(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Al(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function d_e(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function h_e(t){return f_e(n9(t))}function f_e(t){const e={},n={};return t9({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function t9(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&t9({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function n9(t,e){return t.map(n=>(n instanceof cO||(Al(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Al(n.name,"shader module has no name"),n=new cO(n),n.dependencies=n9(n.dependencies)),n))}function p_e(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const m_e=7936,g_e=7937,y_e=7938,__e=35724,MR={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Lu={};Object.keys(MR).forEach(t=>{Lu[t]=t});function v_e(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function b_e(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||m_e),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||g_e);return{gpuVendor:x_e(n,r),vendor:n,renderer:r,version:t.getParameter(y_e),shadingLanguageVersion:t.getParameter(__e)}}function x_e(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const uw={};function uO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=MR[e];if(Al(r,e),!p_e(n))return!0;if(e in uw)return uw[e];const i=r[0],s=n.behavior||"enable",c="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=t.createShader(35633);t.shaderSource(o,c),t.compileShader(o);const f=t.getShaderParameter(o,35713);return t.deleteShader(o),uw[e]=f,f}function w_e(t,e){const n=MR[e];Al(n,e);const r=v_e(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return Al(i===!1||i===!0),i}function L_(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>w_e(t,n))}function E_e(t){switch(b_e(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function T_e(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return L_(t,Lu.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),L_(t,Lu.GLSL_DERIVATIVES)&&uO(t,Lu.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),L_(t,Lu.GLSL_FRAG_DATA)&&uO(t,Lu.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),L_(t,Lu.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const S_e=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,A_e=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,P_e={[kg]:S_e,[$R]:A_e},f0="__LUMA_INJECT_DECLARATIONS__",dO=/void\s+main\s*\([^)]*\)\s*\{\n?/,hO=/}\n?[^{}]*$/,dw=[];function fO(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===kg;for(const s in n){const c=n[s];c.sort((f,m)=>f.order-m.order),dw.length=c.length;for(let f=0,m=c.length;f<m;++f)dw[f]=c[f].injection;const o="".concat(dw.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(f0,o));break;case"vs:#main-start":i&&(t=t.replace(dO,f=>f+o));break;case"vs:#main-end":i&&(t=t.replace(hO,f=>o+f));break;case"fs:#decl":i||(t=t.replace(f0,o));break;case"fs:#main-start":i||(t=t.replace(dO,f=>f+o));break;case"fs:#main-end":i||(t=t.replace(hO,f=>o+f));break;default:t=t.replace(s,f=>f+o)}}return t=t.replace(f0,""),r&&(t=t.replace(/\}\s*$/,s=>s+P_e[e])),t}function ff(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const r9=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],C_e=[...r9,[ff("attribute"),"in $1"],[ff("varying"),"out $1"]],I_e=[...r9,[ff("varying"),"in $1"]],i9=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],L_e=[...i9,[ff("in"),"attribute $1"],[ff("out"),"varying $1"]],R_e=[...i9,[ff("in"),"varying $1"]],AE="gl_FragColor",PE=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,$_e=/void\s+main\s*\([^)]*\)\s*\{\n?/;function M_e(t,e,n){switch(e){case 300:return n?hv(t,C_e):k_e(t);case 100:return n?hv(t,L_e):O_e(t);default:throw new Error("unknown GLSL version ".concat(e))}}function hv(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function k_e(t){t=hv(t,I_e);const e=t.match(PE);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(AE,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace($_e,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(AE,"\\b"),"g"),n)}return t}function O_e(t){t=hv(t,R_e);const e=t.match(PE);if(e){const n=e[1];t=t.replace(PE,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),AE)}return t}const D_e=`

`.concat(f0,`

`),s9={[kg]:"vertex",[$R]:"fragment"},F_e=`precision highp float;

`;function z_e(t,e){const{vs:n,fs:r}=e,i=h_e(e.modules||[]);return{gl:t,vs:pO(t,Object.assign({},e,{source:n,type:kg,modules:i})),fs:pO(t,Object.assign({},e,{source:r,type:$R,modules:i})),getUniforms:N_e(i)}}function pO(t,e){let{id:n,source:r,type:i,modules:s,defines:c={},hookFunctions:o=[],inject:f={},transpileToGLSL100:m=!1,prologue:x=!0,log:S}=e;Al(typeof r=="string","shader source must be a string");const T=i===kg,C=r.split(`
`);let R=100,D="",H=r;C[0].indexOf("#version ")===0?(R=300,D=C[0],H=C.slice(1).join(`
`)):D="#version ".concat(R);const F={};s.forEach(le=>{Object.assign(F,le.getDefines())}),Object.assign(F,c);let k=x?"".concat(D,`
`).concat(U_e({id:n,source:r,type:i}),`
`).concat(B_e({type:i}),`
`).concat(E_e(t),`
`).concat(T_e(t),`
`).concat(V_e(F),`
`).concat(T?"":F_e,`
`):"".concat(D,`
`);const N=j_e(o),U={},ie={},he={};for(const le in f){const ve=typeof f[le]=="string"?{injection:f[le],order:0}:f[le],Oe=le.match(/^(v|f)s:(#)?([\w-]+)$/);if(Oe){const Re=Oe[2],Ee=Oe[3];Re?Ee==="decl"?ie[le]=[ve]:he[le]=[ve]:U[le]=[ve]}else he[le]=[ve]}for(const le of s){S&&le.checkDeprecations(H,S);const ve=le.getModuleSource(i,R);k+=ve;const Oe=le.injections[i];for(const Re in Oe){const Ee=Re.match(/^(v|f)s:#([\w-]+)$/);if(Ee){const we=Ee[2]==="decl"?ie:he;we[Re]=we[Re]||[],we[Re].push(Oe[Re])}else U[Re]=U[Re]||[],U[Re].push(Oe[Re])}}return k+=D_e,k=fO(k,i,ie),k+=G_e(N[i],U),k+=H,k=fO(k,i,he),k=M_e(k,m?100:R,T),k}function N_e(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function B_e(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(s9[e].toUpperCase(),`
`)}function U_e(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(s9[r],`

`):""}function V_e(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function G_e(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((c,o)=>c.order-o.order);for(const c of s)n+="  ".concat(c.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function j_e(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),c=n.replace(/\(.+/,"");e[i][c]=Object.assign(r,{signature:s})}),e}class kR{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new kR(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:c=[],bufferMode:o=35981,transpileToGLSL100:f=!1}=e,m=this._getModuleList(e.modules),x=this._getHash(n),S=this._getHash(r),T=m.map(N=>this._getHash(N.name)).sort(),C=c.map(N=>this._getHash(N)),R=Object.keys(i).sort(),D=Object.keys(s).sort(),H=[],F=[];for(const N of R)H.push(this._getHash(N)),H.push(this._getHash(i[N]));for(const N of D)F.push(this._getHash(N)),F.push(this._getHash(s[N]));const k="".concat(x,"/").concat(S,"D").concat(H.join("/"),"M").concat(T.join("/"),"I").concat(F.join("/"),"V").concat(C.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(f?"T":"");if(!this._programCache[k]){const N=z_e(this.gl,{vs:n,fs:r,modules:m,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:f});this._programCache[k]=new e9(this.gl,{hash:k,vs:N.vs,fs:N.fs,varyings:c,bufferMode:o}),this._getUniforms[k]=N.getUniforms||(U=>{}),this._useCounts[k]=0}return this._useCounts[k]++,this._programCache[k]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,c=this._defaultModules.length;s<c;++s){const o=this._defaultModules[s],f=o.name;n[i++]=o,r[f]=!0}for(let s=0,c=e.length;s<c;++s){const o=e[s],f=o.name;r[f]||(n[i++]=o,r[f]=!0)}return n.length=i,n}}const H_e={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function W_e(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const c=e.attributes[s],o=K_e(s,n);if(s==="indices")i=c;else if(c.constant)r[o]=c.value;else{const f=c.value,m={...c};delete m.value,r[o]=[new As(t,f),m],q_e(s,m)}}if(i){const s=i.value||i;Xt(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const c={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new As(t,{data:s,target:34963}),c]}return r}function K_e(t,e){const{attributeMap:n=H_e}=e||{};return n&&n[t]||t}function q_e(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Xt(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const nh=2,X_e=1e4,Z_e="Model needs drawMode and vertexCount",mO=()=>{},Y_e={};class J_e{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=id("model")}=n;Xt(AR(e)),this.id=r,this.gl=e,this.id=n.id||id("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||kR.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:c,inject:o,varyings:f,bufferMode:m,transpileToGLSL100:x}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:c,inject:o,varyings:f,bufferMode:m,transpileToGLSL100:x},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Xt(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),Z_e)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:c,inject:o,varyings:f,bufferMode:m,transpileToGLSL100:x}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:c,inject:o,varyings:f,bufferMode:m,transpileToGLSL100:x},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Xt(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Xt(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=W_e(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(wE(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return LR(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:c=this.transformFeedback,parameters:o={},vertexArray:f=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let m;rn.priority>=nh&&(m=this._logDrawCallStart(nh));const x=this.vertexArray.getDrawParams(),{isIndexed:S=x.isIndexed,indexType:T=x.indexType,indexOffset:C=x.indexOffset,vertexArrayInstanced:R=x.isInstanced}=this.props;R&&!this.isInstanced&&rn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:D,instanceCount:H}=this,{onBeforeRender:F=mO,onAfterRender:k=mO}=this.props;F(),this.program.setUniforms(this.uniforms);const N=this.program.draw(Object.assign(Y_e,e,{logPriority:m,uniforms:null,framebuffer:r,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:f,transformFeedback:c,isIndexed:S,indexType:T,isInstanced:D,instanceCount:H,offset:S?C:0}));return k(),rn.priority>=nh&&this._logDrawCallEnd(m,f,r),N}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{[35977]:n})),i.forEach(c=>c.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(c=>c.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return rn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:c,defines:o,varyings:f,bufferMode:m,transpileToGLSL100:x}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:c,defines:o,varyings:f,bufferMode:m,transpileToGLSL100:x}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Xt(n instanceof e9,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new t_e(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof As&&n.delete()}}_setAnimationProps(e){this.animated&&Xt(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(wE(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new Kye(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:X_e;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),rn.group(nh,">>> DRAWING MODEL ".concat(this.id),{collapsed:rn.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=i_e({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:c,unusedTable:o,unusedCount:f}=sO({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:m,count:x}=sO({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});x>0&&rn.log("MISSING UNIFORMS",Object.keys(m))(),f>0&&rn.log("UNUSED UNIFORMS",Object.keys(o))();const S=o_e(this.vertexArray.configuration);rn.table(e,s)(),rn.table(e,c)(),rn.table(e+1,S)(),i&&i.log({logLevel:nh,message:"Rendered to ".concat(i.id)}),rn.groupEnd(nh)()}}function CE(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!CE(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!CE(t[s],e[s],n-1))return!1;return!0}return!1}class OR{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){Kn(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&CE(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const s=n[i],c=this.props[i];r[i]=c,s&&s.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof c=="function"&&(r[i]=this.getSubLayerAccessor(c)))}return r}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}}Kn(OR,"defaultProps",{});Kn(OR,"extensionName","LayerExtension");const o9=`
uniform DATAFILTER_TYPE filter_min;
uniform DATAFILTER_TYPE filter_softMin;
uniform DATAFILTER_TYPE filter_softMax;
uniform DATAFILTER_TYPE filter_max;
uniform bool filter_useSoftMargin;
uniform bool filter_enabled;
uniform bool filter_transformSize;

#ifdef NON_INSTANCED_MODEL
  #define DATAFILTER_ATTRIB filterValues
  #define DATAFILTER_ATTRIB_64LOW filterValues64Low
#else
  #define DATAFILTER_ATTRIB instanceFilterValues
  #define DATAFILTER_ATTRIB_64LOW instanceFilterValues64Low
#endif

attribute DATAFILTER_TYPE DATAFILTER_ATTRIB;
#ifdef DATAFILTER_DOUBLE
  attribute DATAFILTER_TYPE DATAFILTER_ATTRIB_64LOW;

  uniform DATAFILTER_TYPE filter_min64High;
  uniform DATAFILTER_TYPE filter_max64High;
#endif

varying float dataFilter_value;

float dataFilter_reduceValue(float value) {
  return value;
}
float dataFilter_reduceValue(vec2 value) {
  return min(value.x, value.y);
}
float dataFilter_reduceValue(vec3 value) {
  return min(min(value.x, value.y), value.z);
}
float dataFilter_reduceValue(vec4 value) {
  return min(min(value.x, value.y), min(value.z, value.w));
}
void dataFilter_setValue(DATAFILTER_TYPE valueFromMin, DATAFILTER_TYPE valueFromMax) {
  if (filter_enabled) {
    if (filter_useSoftMargin) {
      dataFilter_value = dataFilter_reduceValue(
        smoothstep(filter_min, filter_softMin, valueFromMin) *
        (1.0 - smoothstep(filter_softMax, filter_max, valueFromMax))
      );
    } else {
      dataFilter_value = dataFilter_reduceValue(
        step(filter_min, valueFromMin) * step(valueFromMax, filter_max)
      );
    }
  } else {
    dataFilter_value = 1.0;
  }
}
`,a9=`
uniform bool filter_transformColor;
varying float dataFilter_value;
`;function l9(t){if(!t||!("extensions"in t))return{};const{filterRange:e=[-1,1],filterEnabled:n=!0,filterTransformSize:r=!0,filterTransformColor:i=!0}=t,s=t.filterSoftRange||e;return{...Number.isFinite(e[0])?{filter_min:e[0],filter_softMin:s[0],filter_softMax:s[1],filter_max:e[1]}:{filter_min:e.map(c=>c[0]),filter_softMin:s.map(c=>c[0]),filter_softMax:s.map(c=>c[1]),filter_max:e.map(c=>c[1])},filter_enabled:n,filter_useSoftMargin:!!t.filterSoftRange,filter_transformSize:n&&r,filter_transformColor:n&&i}}function Q_e(t){if(!t||!("extensions"in t))return{};const e=l9(t);if(Number.isFinite(e.filter_min)){const n=Math.fround(e.filter_min);e.filter_min-=n,e.filter_softMin-=n,e.filter_min64High=n;const r=Math.fround(e.filter_max);e.filter_max-=r,e.filter_softMax-=r,e.filter_max64High=r}else{const n=e.filter_min.map(Math.fround);e.filter_min=e.filter_min.map((i,s)=>i-n[s]),e.filter_softMin=e.filter_softMin.map((i,s)=>i-n[s]),e.filter_min64High=n;const r=e.filter_max.map(Math.fround);e.filter_max=e.filter_max.map((i,s)=>i-r[s]),e.filter_softMax=e.filter_softMax.map((i,s)=>i-r[s]),e.filter_max64High=r}return e}const c9={"vs:#main-start":`
    #ifdef DATAFILTER_DOUBLE
      dataFilter_setValue(
        DATAFILTER_ATTRIB - filter_min64High + DATAFILTER_ATTRIB_64LOW,
        DATAFILTER_ATTRIB - filter_max64High + DATAFILTER_ATTRIB_64LOW
      );
    #else
      dataFilter_setValue(DATAFILTER_ATTRIB, DATAFILTER_ATTRIB);
    #endif
  `,"vs:#main-end":`
    if (dataFilter_value == 0.0) {
      gl_Position = vec4(0.);
    }
  `,"vs:DECKGL_FILTER_SIZE":`
    if (filter_transformSize) {
      size = size * dataFilter_value;
    }
  `,"fs:DECKGL_FILTER_COLOR":`
    if (dataFilter_value == 0.0) discard;
    if (filter_transformColor) {
      color.a *= dataFilter_value;
    }
  `},e0e={name:"data-filter",vs:o9,fs:a9,inject:c9,getUniforms:l9},t0e={name:"data-filter-fp64",vs:o9,fs:a9,inject:c9,getUniforms:Q_e},n0e=`#define SHADER_NAME data-filter-vertex-shader

#ifdef FLOAT_TARGET
  attribute float filterIndices;
  attribute float filterPrevIndices;
#else
  attribute vec2 filterIndices;
  attribute vec2 filterPrevIndices;
#endif

varying vec4 vColor;
const float component = 1.0 / 255.0;

void main() {
  #ifdef FLOAT_TARGET
    dataFilter_value *= float(filterIndices != filterPrevIndices);
    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
    vColor = vec4(0.0, 0.0, 0.0, 1.0);
  #else
    // Float texture is not supported: pack result into 4 channels x 256 px x 64px
    dataFilter_value *= float(filterIndices.x != filterPrevIndices.x);
    float col = filterIndices.x;
    float row = filterIndices.y * 4.0;
    float channel = floor(row);
    row = fract(row);
    vColor = component * vec4(bvec4(channel == 0.0, channel == 1.0, channel == 2.0, channel == 3.0));
    gl_Position = vec4(col * 2.0 - 1.0, row * 2.0 - 1.0, 0.0, 1.0);
  #endif
  gl_PointSize = 1.0;
}
`,r0e=`#define SHADER_NAME data-filter-fragment-shader
precision highp float;

varying vec4 vColor;

void main() {
  if (dataFilter_value < 0.5) {
    discard;
  }
  gl_FragColor = vColor;
}
`;function i0e(t){return!!(t.getExtension("EXT_float_blend")&&(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")))}function s0e(t,e){return e?new fa(t,{width:1,height:1,attachments:{[36064]:new IR(t,{format:Yn(t)?34836:6408,type:5126,mipmaps:!1})}}):new fa(t,{width:256,height:64,depth:!1})}function o0e(t,e,n){return e.defines.NON_INSTANCED_MODEL=1,n&&(e.defines.FLOAT_TARGET=1),new J_e(t,{id:"data-filter-aggregation-model",vertexCount:1,isInstanced:!1,drawMode:0,vs:n0e,fs:r0e,...e})}const a0e={blend:!0,blendFunc:[1,1,1,1],blendEquation:[32774,32774],depthTest:!1},l0e={getFilterValue:{type:"accessor",value:0},onFilteredItemsChange:{type:"function",value:null,optional:!0},filterEnabled:!0,filterRange:[-1,1],filterSoftRange:null,filterTransformSize:!0,filterTransformColor:!0},gO={1:"float",2:"vec2",3:"vec3",4:"vec4"};class Am extends OR{constructor({filterSize:e=1,fp64:n=!1,countItems:r=!1}={}){if(!gO[e])throw new Error("filterSize out of range");super({filterSize:e,fp64:n,countItems:r})}getShaders(e){const{filterSize:n,fp64:r}=e.opts;return{modules:[r?t0e:e0e],defines:{DATAFILTER_TYPE:gO[n],DATAFILTER_DOUBLE:!!r}}}initializeState(e,n){const r=this.getAttributeManager();r&&r.add({filterValues:{size:n.opts.filterSize,type:n.opts.fp64?5130:5126,accessor:"getFilterValue",shaderAttributes:{filterValues:{divisor:0},instanceFilterValues:{divisor:1}}}});const{gl:i}=this.context;if(r&&n.opts.countItems){const s=i0e(i);r.add({filterIndices:{size:s?1:2,vertexOffset:1,type:5121,normalized:!0,accessor:(f,{index:m})=>{const x=f&&f.__source?f.__source.index:m;return s?(x+1)%255:[(x+1)%255,Math.floor(x/255)%255]},shaderAttributes:{filterPrevIndices:{vertexOffset:0},filterIndices:{vertexOffset:1}}}});const c=s0e(i,s),o=o0e(i,n.getShaders.call(this,n),s);this.setState({filterFBO:c,filterModel:o})}}updateState({props:e,oldProps:n}){if(this.state.filterModel){const i=this.getAttributeManager().attributes.filterValues.needsUpdate()||e.filterEnabled!==n.filterEnabled||e.filterRange!==n.filterRange||e.filterSoftRange!==n.filterSoftRange;i&&this.setState({filterNeedsUpdate:i})}}draw(e,n){const{filterFBO:r,filterModel:i,filterNeedsUpdate:s}=this.state,{onFilteredItemsChange:c}=this.props;if(s&&c&&i){const{attributes:{filterValues:o,filterIndices:f}}=this.getAttributeManager();i.setVertexCount(this.getNumInstances());const{gl:m}=this.context;LR(m,{framebuffer:r,color:[0,0,0,0]}),i.updateModuleSettings(e.moduleParameters).setAttributes({...o.getShaderAttributes(),...f&&f.getShaderAttributes()}).draw({framebuffer:r,parameters:{...a0e,viewport:[0,0,r.width,r.height]}});const x=ZB(r);let S=0;for(let T=0;T<x.length;T++)S+=x[T];c({id:this.id,count:S}),this.state.filterNeedsUpdate=!1}}finalizeState(){const{filterFBO:e,filterModel:n}=this.state;e&&(e.color.delete(),e.delete(),n.delete())}}Kn(Am,"defaultProps",l0e);Kn(Am,"extensionName","DataFilterExtension");var IE={},c0e={get exports(){return IE},set exports(t){IE=t}};(function(t,e){(function(n,r){t.exports=r()})(gW,function(){var n,r,i;function s(o,f){if(!n)n=f;else if(!r)r=f;else{var m="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",x={};n(x),i=f(x),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([m],{type:"text/javascript"})))}}s(["exports"],function(o){var f=m;function m(u,a,d,p){this.cx=3*u,this.bx=3*(d-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(p-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=a,this.p2x=d,this.p2y=p}function x(u,a,d,p){const _=new f(u,a,d,p);return function(b){return _.solve(b)}}m.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,a){if(a===void 0&&(a=1e-6),u<0)return 0;if(u>1)return 1;for(var d=u,p=0;p<8;p++){var _=this.sampleCurveX(d)-u;if(Math.abs(_)<a)return d;var b=this.sampleCurveDerivativeX(d);if(Math.abs(b)<1e-6)break;d-=_/b}var E=0,P=1;for(d=u,p=0;p<20&&(_=this.sampleCurveX(d),!(Math.abs(_-u)<a));p++)u>_?E=d:P=d,d=.5*(P-E)+E;return d},solve:function(u,a){return this.sampleCurveY(this.solveCurveX(u,a))}};const S=x(.25,.1,.25,1);function T(u,a,d){return Math.min(d,Math.max(a,u))}function C(u,a,d){const p=d-a,_=((u-a)%p+p)%p+a;return _===a?d:_}function R(u,...a){for(const d of a)for(const p in d)u[p]=d[p];return u}let D=1;function H(u,a){u.forEach(d=>{a[d]&&(a[d]=a[d].bind(a))})}function F(u,a,d){const p={};for(const _ in u)p[_]=a.call(d||this,u[_],_,u);return p}function k(u,a,d){const p={};for(const _ in u)a.call(d||this,u[_],_,u)&&(p[_]=u[_]);return p}function N(u){return Array.isArray(u)?u.map(N):typeof u=="object"&&u?F(u,N):u}const U={};function ie(u){U[u]||(typeof console<"u"&&console.warn(u),U[u]=!0)}function he(u,a,d){return(d.y-u.y)*(a.x-u.x)>(a.y-u.y)*(d.x-u.x)}function le(u){let a=0;for(let d,p,_=0,b=u.length,E=b-1;_<b;E=_++)d=u[_],p=u[E],a+=(p.x-d.x)*(d.y+p.y);return a}function ve(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Oe(u){const a={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(d,p,_,b)=>{const E=_||b;return a[p]=!E||E.toLowerCase(),""}),a["max-age"]){const d=parseInt(a["max-age"],10);isNaN(d)?delete a["max-age"]:a["max-age"]=d}return a}let Re,Ee,$e=null;function we(u){if($e==null){const a=u.navigator?u.navigator.userAgent:null;$e=!!u.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return $e}function Be(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const Jt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(u){const a=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(a)}},getImageData(u,a=0){const d=window.document.createElement("canvas"),p=d.getContext("2d");if(!p)throw new Error("failed to create canvas 2d context");return d.width=u.width,d.height=u.height,p.drawImage(u,0,0,u.width,u.height),p.getImageData(-a,-a,u.width+2*a,u.height+2*a)},resolveURL:u=>(Re||(Re=document.createElement("a")),Re.href=u,Re.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ee==null&&(Ee=matchMedia("(prefers-reduced-motion: reduce)")),Ee.matches)}};var mt=an;function an(u,a){this.x=u,this.y=a}an.prototype={clone:function(){return new an(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,a){return this.clone()._rotateAround(u,a)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var a=u.x-this.x,d=u.y-this.y;return a*a+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,a){return Math.atan2(this.x*a-this.y*u,this.x*u+this.y*a)},_matMult:function(u){var a=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=a,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var a=Math.cos(u),d=Math.sin(u),p=d*this.x+a*this.y;return this.x=a*this.x-d*this.y,this.y=p,this},_rotateAround:function(u,a){var d=Math.cos(u),p=Math.sin(u),_=a.y+p*(this.x-a.x)+d*(this.y-a.y);return this.x=a.x+d*(this.x-a.x)-p*(this.y-a.y),this.y=_,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},an.convert=function(u){return u instanceof an?u:Array.isArray(u)?new an(u[0],u[1]):u};const ot={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},It="mapbox-tiles";let at,kt,Pe=500,Ke=50;function Je(){typeof caches>"u"||at||(at=caches.open(It))}let Ot=1/0;const ht={supported:!1,testSupport:function(u){!lt&&Zt&&(en?Nn(u):Ct=u)}};let Ct,Zt,lt=!1,en=!1;function Nn(u){const a=u.createTexture();u.bindTexture(u.TEXTURE_2D,a);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,Zt),u.isContextLost())return;ht.supported=!0}catch{}u.deleteTexture(a),lt=!0}typeof document<"u"&&(Zt=document.createElement("img"),Zt.onload=function(){Ct&&Nn(Ct),Ct=null,en=!0},Zt.onerror=function(){lt=!0,Ct=null},Zt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Et={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Et);class Dt extends Error{constructor(a,d,p,_){super(`AJAXError: ${d} (${a}): ${p}`),this.status=a,this.statusText=d,this.url=p,this.body=_}}const mn=ve()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function Mr(u,a){const d=new AbortController,p=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:mn(),signal:d.signal});let _=!1,b=!1;return u.type==="json"&&p.headers.set("Accept","application/json"),((E,P,I)=>{if(b)return;const M=Date.now();fetch(p).then(B=>B.ok?((G,q,Y)=>{(u.type==="arrayBuffer"?G.arrayBuffer():u.type==="json"?G.json():G.text()).then(J=>{b||(q&&Y&&function(fe,de,Ie){if(Je(),!at)return;const ze={status:de.status,statusText:de.statusText,headers:new Headers};de.headers.forEach((De,Xe)=>ze.headers.set(Xe,De));const Se=Oe(de.headers.get("Cache-Control")||"");Se["no-store"]||(Se["max-age"]&&ze.headers.set("Expires",new Date(Ie+1e3*Se["max-age"]).toUTCString()),new Date(ze.headers.get("Expires")).getTime()-Ie<42e4||function(De,Xe){if(kt===void 0)try{new Response(new ReadableStream),kt=!0}catch{kt=!1}kt?Xe(De.body):De.blob().then(Xe)}(de,De=>{const Xe=new Response(De,ze);Je(),at&&at.then(qe=>qe.put(function(St){const $t=St.indexOf("?");return $t<0?St:St.slice(0,$t)}(fe.url),Xe)).catch(qe=>ie(qe.message))}))}(p,q,Y),_=!0,a(null,J,G.headers.get("Cache-Control"),G.headers.get("Expires")))}).catch(J=>{b||a(new Error(J.message))})})(B,null,M):B.blob().then(G=>a(new Dt(B.status,B.statusText,u.url,G)))).catch(B=>{B.code!==20&&a(new Error(B.message))})})(),{cancel:()=>{b=!0,_||d.abort()}}}const Hn=function(u,a){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){if(ve()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,a);if(!ve()){const p=u.url.substring(0,u.url.indexOf("://"));return(ot.REGISTERED_PROTOCOLS[p]||Mr)(u,a)}}if(!(/^file:/.test(d=u.url)||/^file:/.test(mn())&&!/^\w+:/.test(d))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Mr(u,a);if(ve()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,a,void 0,!0)}var d;return function(p,_){const b=new XMLHttpRequest;b.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(b.responseType="arraybuffer");for(const E in p.headers)b.setRequestHeader(E,p.headers[E]);return p.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=p.credentials==="include",b.onerror=()=>{_(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let E=b.response;if(p.type==="json")try{E=JSON.parse(b.response)}catch(P){return _(P)}_(null,E,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else{const E=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});_(new Dt(b.status,b.statusText,p.url,E))}},b.send(p.body),{cancel:()=>b.abort()}}(u,a)},Qn=function(u,a){return Hn(R(u,{type:"arrayBuffer"}),a)};function Zs(u){const a=window.document.createElement("a");return a.href=u,a.protocol===window.document.location.protocol&&a.host===window.document.location.host}const gn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ni,gr;ni=[],gr=0;const ms=function(u,a){if(ht.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),gr>=ot.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:u,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return ni.push(b),b}gr++;let d=!1;const p=()=>{if(!d)for(d=!0,gr--;ni.length&&gr<ot.MAX_PARALLEL_IMAGE_REQUESTS;){const b=ni.shift(),{requestParameters:E,callback:P,cancelled:I}=b;I||(b.cancel=ms(E,P).cancel)}},_=Qn(u,(b,E,P,I)=>{p(),b?a(b):E&&function(M,B){typeof createImageBitmap=="function"?function(G,q){const Y=new Blob([new Uint8Array(G)],{type:"image/png"});createImageBitmap(Y).then(J=>{q(null,J)}).catch(J=>{q(new Error(`Could not load image because of ${J.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(M,B):function(G,q){const Y=new Image;Y.onload=()=>{q(null,Y),URL.revokeObjectURL(Y.src),Y.onload=null,window.requestAnimationFrame(()=>{Y.src=gn})},Y.onerror=()=>q(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const J=new Blob([new Uint8Array(G)],{type:"image/png"});Y.src=G.byteLength?URL.createObjectURL(J):gn}(M,B)}(E,(M,B)=>{M!=null?a(M):B!=null&&a(null,B,{cacheControl:P,expires:I})})});return{cancel:()=>{_.cancel(),p()}}};function Ho(u,a,d){d[u]&&d[u].indexOf(a)!==-1||(d[u]=d[u]||[],d[u].push(a))}function Ui(u,a,d){if(d&&d[u]){const p=d[u].indexOf(a);p!==-1&&d[u].splice(p,1)}}class Vi{constructor(a,d={}){R(this,d),this.type=a}}class So extends Vi{constructor(a,d={}){super("error",R({error:a},d))}}class Qi{on(a,d){return this._listeners=this._listeners||{},Ho(a,d,this._listeners),this}off(a,d){return Ui(a,d,this._listeners),Ui(a,d,this._oneTimeListeners),this}once(a,d){return this._oneTimeListeners=this._oneTimeListeners||{},Ho(a,d,this._oneTimeListeners),this}fire(a,d){typeof a=="string"&&(a=new Vi(a,d||{}));const p=a.type;if(this.listens(p)){a.target=this;const _=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const P of _)P.call(this,a);const b=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const P of b)Ui(p,P,this._oneTimeListeners),P.call(this,a);const E=this._eventedParent;E&&(R(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(a))}else a instanceof So&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,d){return this._eventedParent=a,this._eventedParentData=d,this}}var je={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class dt{constructor(a,d,p,_){this.message=(a?`${a}: `:"")+p,_&&(this.identifier=_),d!=null&&d.__line__&&(this.line=d.__line__)}}function Ms(u){const a=u.value;return a?[new dt(u.key,a,"constants have been deprecated as of v8")]:[]}function di(u,...a){for(const d of a)for(const p in d)u[p]=d[p];return u}function ln(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Li(u){if(Array.isArray(u))return u.map(Li);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const a={};for(const d in u)a[d]=Li(u[d]);return a}return ln(u)}class bi extends Error{constructor(a,d){super(d),this.message=d,this.key=a}}class Me{constructor(a,d=[]){this.parent=a,this.bindings={};for(const[p,_]of d)this.bindings[p]=_}concat(a){return new Me(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}const Ae={kind:"null"},Ce={kind:"number"},Ye={kind:"string"},Ze={kind:"boolean"},gt={kind:"color"},Ht={kind:"object"},it={kind:"value"},Ut={kind:"collator"},Wt={kind:"formatted"},Dn={kind:"padding"},An={kind:"resolvedImage"};function Pn(u,a){return{kind:"array",itemType:u,N:a}}function on(u){if(u.kind==="array"){const a=on(u.itemType);return typeof u.N=="number"?`array<${a}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${a}>`}return u.kind}const qr=[Ae,Ce,Ye,Ze,gt,Wt,Ht,Pn(it),Dn,An];function ri(u,a){if(a.kind==="error")return null;if(u.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!ri(u.itemType,a.itemType))&&(typeof u.N!="number"||u.N===a.N))return null}else{if(u.kind===a.kind)return null;if(u.kind==="value"){for(const d of qr)if(!ri(d,a))return null}}return`Expected ${on(u)} but found ${on(a)} instead.`}function xi(u,a){return a.some(d=>d.kind===u.kind)}function Gi(u,a){return a.some(d=>d==="null"?u===null:d==="array"?Array.isArray(u):d==="object"?u&&!Array.isArray(u)&&typeof u=="object":d===typeof u)}var es,Ao={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function re(u){return(u=Math.round(u))<0?0:u>255?255:u}function z(u){return re(u[u.length-1]==="%"?parseFloat(u)/100*255:parseInt(u))}function j(u){return(a=u[u.length-1]==="%"?parseFloat(u)/100:parseFloat(u))<0?0:a>1?1:a;var a}function Q(u,a,d){return d<0?d+=1:d>1&&(d-=1),6*d<1?u+(a-u)*d*6:2*d<1?a:3*d<2?u+(a-u)*(2/3-d)*6:u}try{es={}.parseCSSColor=function(u){var a,d=u.replace(/ /g,"").toLowerCase();if(d in Ao)return Ao[d].slice();if(d[0]==="#")return d.length===4?(a=parseInt(d.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:d.length===7&&(a=parseInt(d.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var p=d.indexOf("("),_=d.indexOf(")");if(p!==-1&&_+1===d.length){var b=d.substr(0,p),E=d.substr(p+1,_-(p+1)).split(","),P=1;switch(b){case"rgba":if(E.length!==4)return null;P=j(E.pop());case"rgb":return E.length!==3?null:[z(E[0]),z(E[1]),z(E[2]),P];case"hsla":if(E.length!==4)return null;P=j(E.pop());case"hsl":if(E.length!==3)return null;var I=(parseFloat(E[0])%360+360)%360/360,M=j(E[1]),B=j(E[2]),G=B<=.5?B*(M+1):B+M-B*M,q=2*B-G;return[re(255*Q(q,G,I+1/3)),re(255*Q(q,G,I)),re(255*Q(q,G,I-1/3)),P];default:return null}}return null}}catch{}class te{constructor(a,d,p,_=1){this.r=a,this.g=d,this.b=p,this.a=_}static parse(a){if(!a)return;if(a instanceof te)return a;if(typeof a!="string")return;const d=es(a);return d?new te(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3]):void 0}toString(){const[a,d,p,_]=this.toArray();return`rgba(${Math.round(a)},${Math.round(d)},${Math.round(p)},${_})`}toArray(){const{r:a,g:d,b:p,a:_}=this;return _===0?[0,0,0,0]:[255*a/_,255*d/_,255*p/_,_]}}te.black=new te(0,0,0,1),te.white=new te(1,1,1,1),te.transparent=new te(0,0,0,0),te.red=new te(1,0,0,1);class me{constructor(a,d,p){this.sensitivity=a?d?"variant":"case":d?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,d){return this.collator.compare(a,d)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class be{constructor(a,d,p,_,b){this.text=a,this.image=d,this.scale=p,this.fontStack=_,this.textColor=b}}class ye{constructor(a){this.sections=a}static fromString(a){return new ye([new be(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof ye?a:ye.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class pe{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof pe)return a;if(typeof a=="number")return new pe([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(const d of a)if(typeof d!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new pe(a)}}toString(){return JSON.stringify(this.values)}}class xe{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new xe({name:a,available:!1}):null}}function Ve(u,a,d,p){return typeof u=="number"&&u>=0&&u<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof d=="number"&&d>=0&&d<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[u,a,d,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[u,a,d,p]:[u,a,d]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qe(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof te||u instanceof me||u instanceof ye||u instanceof pe||u instanceof xe)return!0;if(Array.isArray(u)){for(const a of u)if(!Qe(a))return!1;return!0}if(typeof u=="object"){for(const a in u)if(!Qe(u[a]))return!1;return!0}return!1}function Ue(u){if(u===null)return Ae;if(typeof u=="string")return Ye;if(typeof u=="boolean")return Ze;if(typeof u=="number")return Ce;if(u instanceof te)return gt;if(u instanceof me)return Ut;if(u instanceof ye)return Wt;if(u instanceof pe)return Dn;if(u instanceof xe)return An;if(Array.isArray(u)){const a=u.length;let d;for(const p of u){const _=Ue(p);if(d){if(d===_)continue;d=it;break}d=_}return Pn(d||it,a)}return Ht}function At(u){const a=typeof u;return u===null?"":a==="string"||a==="number"||a==="boolean"?String(u):u instanceof te||u instanceof ye||u instanceof pe||u instanceof xe?u.toString():JSON.stringify(u)}class Rt{constructor(a,d){this.type=a,this.value=d}static parse(a,d){if(a.length!==2)return d.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Qe(a[1]))return d.error("invalid value");const p=a[1];let _=Ue(p);const b=d.expectedType;return _.kind!=="array"||_.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(_=b),new Rt(_,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class _t{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}}const Vt={string:Ye,number:Ce,boolean:Ze,object:Ht};class zt{constructor(a,d){this.type=a,this.args=d}static parse(a,d){if(a.length<2)return d.error("Expected at least one argument.");let p,_=1;const b=a[0];if(b==="array"){let P,I;if(a.length>2){const M=a[1];if(typeof M!="string"||!(M in Vt)||M==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);P=Vt[M],_++}else P=it;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return d.error('The length argument to "array" must be a positive integer literal',2);I=a[2],_++}p=Pn(P,I)}else{if(!Vt[b])throw new Error(`Types doesn't contain name = ${b}`);p=Vt[b]}const E=[];for(;_<a.length;_++){const P=d.parse(a[_],_,it);if(!P)return null;E.push(P)}return new zt(p,E)}evaluate(a){for(let d=0;d<this.args.length;d++){const p=this.args[d].evaluate(a);if(!ri(this.type,Ue(p)))return p;if(d===this.args.length-1)throw new _t(`Expected value to be of type ${on(this.type)}, but found ${on(Ue(p))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const cn={"to-boolean":Ze,"to-color":gt,"to-number":Ce,"to-string":Ye};class Kt{constructor(a,d){this.type=a,this.args=d}static parse(a,d){if(a.length<2)return d.error("Expected at least one argument.");const p=a[0];if(!cn[p])throw new Error(`Can't parse ${p} as it is not part of the known types`);if((p==="to-boolean"||p==="to-string")&&a.length!==2)return d.error("Expected one argument.");const _=cn[p],b=[];for(let E=1;E<a.length;E++){const P=d.parse(a[E],E,it);if(!P)return null;b.push(P)}return new Kt(_,b)}evaluate(a){if(this.type.kind==="boolean")return!!this.args[0].evaluate(a);if(this.type.kind==="color"){let d,p;for(const _ of this.args){if(d=_.evaluate(a),p=null,d instanceof te)return d;if(typeof d=="string"){const b=a.parseColor(d);if(b)return b}else if(Array.isArray(d)&&(p=d.length<3||d.length>4?`Invalid rbga value ${JSON.stringify(d)}: expected an array containing either three or four numeric values.`:Ve(d[0],d[1],d[2],d[3]),!p))return new te(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new _t(p||`Could not parse color from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}if(this.type.kind==="padding"){let d;for(const p of this.args){d=p.evaluate(a);const _=pe.parse(d);if(_)return _}throw new _t(`Could not parse padding from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}if(this.type.kind==="number"){let d=null;for(const p of this.args){if(d=p.evaluate(a),d===null)return 0;const _=Number(d);if(!isNaN(_))return _}throw new _t(`Could not convert ${JSON.stringify(d)} to number.`)}return this.type.kind==="formatted"?ye.fromString(At(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?xe.fromString(At(this.args[0].evaluate(a))):At(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const Qt=["Unknown","Point","LineString","Polygon"];class fn{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Qt[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let d=this._parseColorCache[a];return d||(d=this._parseColorCache[a]=te.parse(a)),d}}class vn{constructor(a,d,p,_){this.name=a,this.type=d,this._evaluate=p,this.args=_}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,d){const p=a[0],_=vn.definitions[p];if(!_)return d.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(_)?_[0]:_.type,E=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,P=E.filter(([M])=>!Array.isArray(M)||M.length===a.length-1);let I=null;for(const[M,B]of P){I=new nt(d.registry,d.path,null,d.scope);const G=[];let q=!1;for(let Y=1;Y<a.length;Y++){const J=a[Y],fe=Array.isArray(M)?M[Y-1]:M.type,de=I.parse(J,1+G.length,fe);if(!de){q=!0;break}G.push(de)}if(!q)if(Array.isArray(M)&&M.length!==G.length)I.error(`Expected ${M.length} arguments, but found ${G.length} instead.`);else{for(let Y=0;Y<G.length;Y++){const J=Array.isArray(M)?M[Y]:M.type,fe=G[Y];I.concat(Y+1).checkSubtype(J,fe.type)}if(I.errors.length===0)return new vn(p,b,B,G)}}if(P.length===1)d.errors.push(...I.errors);else{const M=(P.length?P:E).map(([G])=>{return q=G,Array.isArray(q)?`(${q.map(on).join(", ")})`:`(${on(q.type)}...)`;var q}).join(" | "),B=[];for(let G=1;G<a.length;G++){const q=d.parse(a[G],1+B.length);if(!q)return null;B.push(on(q.type))}d.error(`Expected arguments of type ${M}, but found (${B.join(", ")}) instead.`)}return null}static register(a,d){vn.definitions=d;for(const p in d)a[p]=vn}}class er{constructor(a,d,p){this.type=Ut,this.locale=p,this.caseSensitive=a,this.diacriticSensitive=d}static parse(a,d){if(a.length!==2)return d.error("Expected one argument.");const p=a[1];if(typeof p!="object"||Array.isArray(p))return d.error("Collator options argument must be an object.");const _=d.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Ze);if(!_)return null;const b=d.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Ze);if(!b)return null;let E=null;return p.locale&&(E=d.parse(p.locale,1,Ye),!E)?null:new er(_,b,E)}evaluate(a){return new me(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}const tr=8192;function ii(u,a){u[0]=Math.min(u[0],a[0]),u[1]=Math.min(u[1],a[1]),u[2]=Math.max(u[2],a[0]),u[3]=Math.max(u[3],a[1])}function Ys(u,a){return!(u[0]<=a[0]||u[2]>=a[2]||u[1]<=a[1]||u[3]>=a[3])}function wi(u,a){const d=(180+u[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,_=Math.pow(2,a.z);return[Math.round(d*_*tr),Math.round(p*_*tr)]}function Rn(u,a,d){const p=u[0]-a[0],_=u[1]-a[1],b=u[0]-d[0],E=u[1]-d[1];return p*E-b*_==0&&p*b<=0&&_*E<=0}function Ka(u,a){let d=!1;for(let E=0,P=a.length;E<P;E++){const I=a[E];for(let M=0,B=I.length;M<B-1;M++){if(Rn(u,I[M],I[M+1]))return!1;(_=I[M])[1]>(p=u)[1]!=(b=I[M+1])[1]>p[1]&&p[0]<(b[0]-_[0])*(p[1]-_[1])/(b[1]-_[1])+_[0]&&(d=!d)}}var p,_,b;return d}function qa(u,a){for(let d=0;d<a.length;d++)if(Ka(u,a[d]))return!0;return!1}function Ul(u,a,d,p){const _=p[0]-d[0],b=p[1]-d[1],E=(u[0]-d[0])*b-_*(u[1]-d[1]),P=(a[0]-d[0])*b-_*(a[1]-d[1]);return E>0&&P<0||E<0&&P>0}function Vl(u,a,d){for(const M of d)for(let B=0;B<M.length-1;++B)if((P=[(E=M[B+1])[0]-(b=M[B])[0],E[1]-b[1]])[0]*(I=[(_=a)[0]-(p=u)[0],_[1]-p[1]])[1]-P[1]*I[0]!=0&&Ul(p,_,b,E)&&Ul(b,E,p,_))return!0;var p,_,b,E,P,I;return!1}function _a(u,a){for(let d=0;d<u.length;++d)if(!Ka(u[d],a))return!1;for(let d=0;d<u.length-1;++d)if(Vl(u[d],u[d+1],a))return!1;return!0}function Js(u,a){for(let d=0;d<a.length;d++)if(_a(u,a[d]))return!0;return!1}function Gl(u,a,d){const p=[];for(let _=0;_<u.length;_++){const b=[];for(let E=0;E<u[_].length;E++){const P=wi(u[_][E],d);ii(a,P),b.push(P)}p.push(b)}return p}function jl(u,a,d){const p=[];for(let _=0;_<u.length;_++){const b=Gl(u[_],a,d);p.push(b)}return p}function Hl(u,a,d,p){if(u[0]<d[0]||u[0]>d[2]){const _=.5*p;let b=u[0]-d[0]>_?-p:d[0]-u[0]>_?p:0;b===0&&(b=u[0]-d[2]>_?-p:d[2]-u[0]>_?p:0),u[0]+=b}ii(a,u)}function Yc(u,a,d,p){const _=Math.pow(2,p.z)*tr,b=[p.x*tr,p.y*tr],E=[];for(const P of u)for(const I of P){const M=[I.x+b[0],I.y+b[1]];Hl(M,a,d,_),E.push(M)}return E}function _d(u,a,d,p){const _=Math.pow(2,p.z)*tr,b=[p.x*tr,p.y*tr],E=[];for(const I of u){const M=[];for(const B of I){const G=[B.x+b[0],B.y+b[1]];ii(a,G),M.push(G)}E.push(M)}if(a[2]-a[0]<=_/2){(P=a)[0]=P[1]=1/0,P[2]=P[3]=-1/0;for(const I of E)for(const M of I)Hl(M,a,d,_)}var P;return E}class Wo{constructor(a,d){this.type=Ze,this.geojson=a,this.geometries=d}static parse(a,d){if(a.length!==2)return d.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Qe(a[1])){const p=a[1];if(p.type==="FeatureCollection")for(let _=0;_<p.features.length;++_){const b=p.features[_].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Wo(p,p.features[_].geometry)}else if(p.type==="Feature"){const _=p.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Wo(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Wo(p,p)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(d,p){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],E=d.canonicalID();if(p.type==="Polygon"){const P=Gl(p.coordinates,b,E),I=Yc(d.geometry(),_,b,E);if(!Ys(_,b))return!1;for(const M of I)if(!Ka(M,P))return!1}if(p.type==="MultiPolygon"){const P=jl(p.coordinates,b,E),I=Yc(d.geometry(),_,b,E);if(!Ys(_,b))return!1;for(const M of I)if(!qa(M,P))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(d,p){const _=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],E=d.canonicalID();if(p.type==="Polygon"){const P=Gl(p.coordinates,b,E),I=_d(d.geometry(),_,b,E);if(!Ys(_,b))return!1;for(const M of I)if(!_a(M,P))return!1}if(p.type==="MultiPolygon"){const P=jl(p.coordinates,b,E),I=_d(d.geometry(),_,b,E);if(!Ys(_,b))return!1;for(const M of I)if(!Js(M,P))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function Z(u){if(u instanceof vn&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Wo)return!1;let a=!0;return u.eachChild(d=>{a&&!Z(d)&&(a=!1)}),a}function ne(u){if(u instanceof vn&&u.name==="feature-state")return!1;let a=!0;return u.eachChild(d=>{a&&!ne(d)&&(a=!1)}),a}function ge(u,a){if(u instanceof vn&&a.indexOf(u.name)>=0)return!1;let d=!0;return u.eachChild(p=>{d&&!ge(p,a)&&(d=!1)}),d}class Ne{constructor(a,d){this.type=d.type,this.name=a,this.boundExpression=d}static parse(a,d){if(a.length!==2||typeof a[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");const p=a[1];return d.scope.has(p)?new Ne(p,d.scope.get(p)):d.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class nt{constructor(a,d=[],p,_=new Me,b=[]){this.registry=a,this.path=d,this.key=d.map(E=>`[${E}]`).join(""),this.scope=_,this.errors=b,this.expectedType=p}parse(a,d,p,_,b={}){return d?this.concat(d,p,_)._parse(a,b):this._parse(a,b)}_parse(a,d){function p(_,b,E){return E==="assert"?new zt(b,[_]):E==="coerce"?new Kt(b,[_]):_}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=a[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[_];if(b){let E=b.parse(a,this);if(!E)return null;if(this.expectedType){const P=this.expectedType,I=E.type;if(P.kind!=="string"&&P.kind!=="number"&&P.kind!=="boolean"&&P.kind!=="object"&&P.kind!=="array"||I.kind!=="value")if(P.kind!=="color"&&P.kind!=="formatted"&&P.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string")if(P.kind!=="padding"||I.kind!=="value"&&I.kind!=="number"&&I.kind!=="array"){if(this.checkSubtype(P,I))return null}else E=p(E,P,d.typeAnnotation||"coerce");else E=p(E,P,d.typeAnnotation||"coerce");else E=p(E,P,d.typeAnnotation||"assert")}if(!(E instanceof Rt)&&E.type.kind!=="resolvedImage"&&Lt(E)){const P=new fn;try{E=new Rt(E.type,E.evaluate(P))}catch(I){return this.error(I.message),null}}return E}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,d,p){const _=typeof a=="number"?this.path.concat(a):this.path,b=p?this.scope.concat(p):this.scope;return new nt(this.registry,_,d||null,b,this.errors)}error(a,...d){const p=`${this.key}${d.map(_=>`[${_}]`).join("")}`;this.errors.push(new bi(p,a))}checkSubtype(a,d){const p=ri(a,d);return p&&this.error(p),p}}function Lt(u){if(u instanceof Ne)return Lt(u.boundExpression);if(u instanceof vn&&u.name==="error"||u instanceof er||u instanceof Wo)return!1;const a=u instanceof Kt||u instanceof zt;let d=!0;return u.eachChild(p=>{d=a?d&&Lt(p):d&&p instanceof Rt}),!!d&&Z(u)&&ge(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function pn(u,a){const d=u.length-1;let p,_,b=0,E=d,P=0;for(;b<=E;)if(P=Math.floor((b+E)/2),p=u[P],_=u[P+1],p<=a){if(P===d||a<_)return P;b=P+1}else{if(!(p>a))throw new _t("Input is not a number.");E=P-1}return 0}class yr{constructor(a,d,p){this.type=a,this.input=d,this.labels=[],this.outputs=[];for(const[_,b]of p)this.labels.push(_),this.outputs.push(b)}static parse(a,d){if(a.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return d.error("Expected an even number of arguments.");const p=d.parse(a[1],1,Ce);if(!p)return null;const _=[];let b=null;d.expectedType&&d.expectedType.kind!=="value"&&(b=d.expectedType);for(let E=1;E<a.length;E+=2){const P=E===1?-1/0:a[E],I=a[E+1],M=E,B=E+1;if(typeof P!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(_.length&&_[_.length-1][0]>=P)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const G=d.parse(I,B,b);if(!G)return null;b=b||G.type,_.push([P,G])}return new yr(b,p,_)}evaluate(a){const d=this.labels,p=this.outputs;if(d.length===1)return p[0].evaluate(a);const _=this.input.evaluate(a);if(_<=d[0])return p[0].evaluate(a);const b=d.length;return _>=d[b-1]?p[b-1].evaluate(a):p[pn(d,_)].evaluate(a)}eachChild(a){a(this.input);for(const d of this.outputs)a(d)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function un(u,a,d){return u*(1-d)+a*d}var Nr=Object.freeze({__proto__:null,number:un,color:function(u,a,d){return new te(un(u.r,a.r,d),un(u.g,a.g,d),un(u.b,a.b,d),un(u.a,a.a,d))},array:function(u,a,d){return u.map((p,_)=>un(p,a[_],d))},padding:function(u,a,d){const p=u.values,_=a.values;return new pe([un(p[0],_[0],d),un(p[1],_[1],d),un(p[2],_[2],d),un(p[3],_[3],d)])}});const gs=.95047,Ng=1.08883,If=4/29,vd=6/29,Bg=3*vd*vd,kb=Math.PI/180,Ob=180/Math.PI;function Lf(u){return u>.008856451679035631?Math.pow(u,1/3):u/Bg+If}function Rf(u){return u>vd?u*u*u:Bg*(u-If)}function $f(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function Mf(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Fn(u){const a=Mf(u.r),d=Mf(u.g),p=Mf(u.b),_=Lf((.4124564*a+.3575761*d+.1804375*p)/gs),b=Lf((.2126729*a+.7151522*d+.072175*p)/1);return{l:116*b-16,a:500*(_-b),b:200*(b-Lf((.0193339*a+.119192*d+.9503041*p)/Ng)),alpha:u.a}}function Ug(u){let a=(u.l+16)/116,d=isNaN(u.a)?a:a+u.a/500,p=isNaN(u.b)?a:a-u.b/200;return a=1*Rf(a),d=gs*Rf(d),p=Ng*Rf(p),new te($f(3.2404542*d-1.5371385*a-.4985314*p),$f(-.969266*d+1.8760108*a+.041556*p),$f(.0556434*d-.2040259*a+1.0572252*p),u.alpha)}function Db(u,a,d){const p=a-u;return u+d*(p>180||p<-180?p-360*Math.round(p/360):p)}const Jc={forward:Fn,reverse:Ug,interpolate:function(u,a,d){return{l:un(u.l,a.l,d),a:un(u.a,a.a,d),b:un(u.b,a.b,d),alpha:un(u.alpha,a.alpha,d)}}},Qc={forward:function(u){const{l:a,a:d,b:p}=Fn(u),_=Math.atan2(p,d)*Ob;return{h:_<0?_+360:_,c:Math.sqrt(d*d+p*p),l:a,alpha:u.a}},reverse:function(u){const a=u.h*kb,d=u.c;return Ug({l:u.l,a:Math.cos(a)*d,b:Math.sin(a)*d,alpha:u.alpha})},interpolate:function(u,a,d){return{h:Db(u.h,a.h,d),c:un(u.c,a.c,d),l:un(u.l,a.l,d),alpha:un(u.alpha,a.alpha,d)}}};var Vg=Object.freeze({__proto__:null,lab:Jc,hcl:Qc});class ys{constructor(a,d,p,_,b){this.type=a,this.operator=d,this.interpolation=p,this.input=_,this.labels=[],this.outputs=[];for(const[E,P]of b)this.labels.push(E),this.outputs.push(P)}static interpolationFactor(a,d,p,_){let b=0;if(a.name==="exponential")b=kf(d,a.base,p,_);else if(a.name==="linear")b=kf(d,1,p,_);else if(a.name==="cubic-bezier"){const E=a.controlPoints;b=new f(E[0],E[1],E[2],E[3]).solve(kf(d,1,p,_))}return b}static parse(a,d){let[p,_,b,...E]=a;if(!Array.isArray(_)||_.length===0)return d.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const M=_[1];if(typeof M!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:M}}else{if(_[0]!=="cubic-bezier")return d.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const M=_.slice(1);if(M.length!==4||M.some(B=>typeof B!="number"||B<0||B>1))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:M}}}if(a.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(b=d.parse(b,2,Ce),!b)return null;const P=[];let I=null;p==="interpolate-hcl"||p==="interpolate-lab"?I=gt:d.expectedType&&d.expectedType.kind!=="value"&&(I=d.expectedType);for(let M=0;M<E.length;M+=2){const B=E[M],G=E[M+1],q=M+3,Y=M+4;if(typeof B!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(P.length&&P[P.length-1][0]>=B)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const J=d.parse(G,Y,I);if(!J)return null;I=I||J.type,P.push([B,J])}return I.kind==="number"||I.kind==="color"||I.kind==="padding"||I.kind==="array"&&I.itemType.kind==="number"&&typeof I.N=="number"?new ys(I,p,_,b,P):d.error(`Type ${on(I)} is not interpolatable.`)}evaluate(a){const d=this.labels,p=this.outputs;if(d.length===1)return p[0].evaluate(a);const _=this.input.evaluate(a);if(_<=d[0])return p[0].evaluate(a);const b=d.length;if(_>=d[b-1])return p[b-1].evaluate(a);const E=pn(d,_),P=ys.interpolationFactor(this.interpolation,_,d[E],d[E+1]),I=p[E].evaluate(a),M=p[E+1].evaluate(a);return this.operator==="interpolate"?Nr[this.type.kind.toLowerCase()](I,M,P):this.operator==="interpolate-hcl"?Qc.reverse(Qc.interpolate(Qc.forward(I),Qc.forward(M),P)):Jc.reverse(Jc.interpolate(Jc.forward(I),Jc.forward(M),P))}eachChild(a){a(this.input);for(const d of this.outputs)a(d)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function kf(u,a,d,p){const _=p-d,b=u-d;return _===0?0:a===1?b/_:(Math.pow(a,b)-1)/(Math.pow(a,_)-1)}class bd{constructor(a,d){this.type=a,this.args=d}static parse(a,d){if(a.length<2)return d.error("Expectected at least one argument.");let p=null;const _=d.expectedType;_&&_.kind!=="value"&&(p=_);const b=[];for(const P of a.slice(1)){const I=d.parse(P,1+b.length,p,void 0,{typeAnnotation:"omit"});if(!I)return null;p=p||I.type,b.push(I)}if(!p)throw new Error("No output type");const E=_&&b.some(P=>ri(_,P.type));return new bd(E?it:p,b)}evaluate(a){let d,p=null,_=0;for(const b of this.args)if(_++,p=b.evaluate(a),p&&p instanceof xe&&!p.available&&(d||(d=p.name),p=null,_===this.args.length&&(p=d)),p!==null)break;return p}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}class xd{constructor(a,d){this.type=d.type,this.bindings=[].concat(a),this.result=d}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const d of this.bindings)a(d[1]);a(this.result)}static parse(a,d){if(a.length<4)return d.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const p=[];for(let b=1;b<a.length-1;b+=2){const E=a[b];if(typeof E!="string")return d.error(`Expected string, but found ${typeof E} instead.`,b);if(/[^a-zA-Z0-9_]/.test(E))return d.error("Variable names must contain only alphanumeric characters or '_'.",b);const P=d.parse(a[b+1],b+1);if(!P)return null;p.push([E,P])}const _=d.parse(a[a.length-1],a.length-1,d.expectedType,p);return _?new xd(p,_):null}outputDefined(){return this.result.outputDefined()}}class Of{constructor(a,d,p){this.type=a,this.index=d,this.input=p}static parse(a,d){if(a.length!==3)return d.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const p=d.parse(a[1],1,Ce),_=d.parse(a[2],2,Pn(d.expectedType||it));return p&&_?new Of(_.type.itemType,p,_):null}evaluate(a){const d=this.index.evaluate(a),p=this.input.evaluate(a);if(d<0)throw new _t(`Array index out of bounds: ${d} < 0.`);if(d>=p.length)throw new _t(`Array index out of bounds: ${d} > ${p.length-1}.`);if(d!==Math.floor(d))throw new _t(`Array index must be an integer, but found ${d} instead.`);return p[d]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class Df{constructor(a,d){this.type=Ze,this.needle=a,this.haystack=d}static parse(a,d){if(a.length!==3)return d.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const p=d.parse(a[1],1,it),_=d.parse(a[2],2,it);return p&&_?xi(p.type,[Ze,Ye,Ce,Ae,it])?new Df(p,_):d.error(`Expected first argument to be of type boolean, string, number or null, but found ${on(p.type)} instead`):null}evaluate(a){const d=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(!p)return!1;if(!Gi(d,["boolean","string","number","null"]))throw new _t(`Expected first argument to be of type boolean, string, number or null, but found ${on(Ue(d))} instead.`);if(!Gi(p,["string","array"]))throw new _t(`Expected second argument to be of type array or string, but found ${on(Ue(p))} instead.`);return p.indexOf(d)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class wd{constructor(a,d,p){this.type=Ce,this.needle=a,this.haystack=d,this.fromIndex=p}static parse(a,d){if(a.length<=2||a.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const p=d.parse(a[1],1,it),_=d.parse(a[2],2,it);if(!p||!_)return null;if(!xi(p.type,[Ze,Ye,Ce,Ae,it]))return d.error(`Expected first argument to be of type boolean, string, number or null, but found ${on(p.type)} instead`);if(a.length===4){const b=d.parse(a[3],3,Ce);return b?new wd(p,_,b):null}return new wd(p,_)}evaluate(a){const d=this.needle.evaluate(a),p=this.haystack.evaluate(a);if(!Gi(d,["boolean","string","number","null"]))throw new _t(`Expected first argument to be of type boolean, string, number or null, but found ${on(Ue(d))} instead.`);if(!Gi(p,["string","array"]))throw new _t(`Expected second argument to be of type array or string, but found ${on(Ue(p))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(a);return p.indexOf(d,_)}return p.indexOf(d)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class Ff{constructor(a,d,p,_,b,E){this.inputType=a,this.type=d,this.input=p,this.cases=_,this.outputs=b,this.otherwise=E}static parse(a,d){if(a.length<5)return d.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return d.error("Expected an even number of arguments.");let p,_;d.expectedType&&d.expectedType.kind!=="value"&&(_=d.expectedType);const b={},E=[];for(let M=2;M<a.length-1;M+=2){let B=a[M];const G=a[M+1];Array.isArray(B)||(B=[B]);const q=d.concat(M);if(B.length===0)return q.error("Expected at least one branch label.");for(const J of B){if(typeof J!="number"&&typeof J!="string")return q.error("Branch labels must be numbers or strings.");if(typeof J=="number"&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof J=="number"&&Math.floor(J)!==J)return q.error("Numeric branch labels must be integer values.");if(p){if(q.checkSubtype(p,Ue(J)))return null}else p=Ue(J);if(b[String(J)]!==void 0)return q.error("Branch labels must be unique.");b[String(J)]=E.length}const Y=d.parse(G,M,_);if(!Y)return null;_=_||Y.type,E.push(Y)}const P=d.parse(a[1],1,it);if(!P)return null;const I=d.parse(a[a.length-1],a.length-1,_);return I?P.type.kind!=="value"&&d.concat(1).checkSubtype(p,P.type)?null:new Ff(p,_,P,b,E,I):null}evaluate(a){const d=this.input.evaluate(a);return(Ue(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class zf{constructor(a,d,p){this.type=a,this.branches=d,this.otherwise=p}static parse(a,d){if(a.length<4)return d.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return d.error("Expected an odd number of arguments.");let p;d.expectedType&&d.expectedType.kind!=="value"&&(p=d.expectedType);const _=[];for(let E=1;E<a.length-1;E+=2){const P=d.parse(a[E],E,Ze);if(!P)return null;const I=d.parse(a[E+1],E+1,p);if(!I)return null;_.push([P,I]),p=p||I.type}const b=d.parse(a[a.length-1],a.length-1,p);if(!b)return null;if(!p)throw new Error("Can't infer output type");return new zf(p,_,b)}evaluate(a){for(const[d,p]of this.branches)if(d.evaluate(a))return p.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[d,p]of this.branches)a(d),a(p);a(this.otherwise)}outputDefined(){return this.branches.every(([a,d])=>d.outputDefined())&&this.otherwise.outputDefined()}}class Ed{constructor(a,d,p,_){this.type=a,this.input=d,this.beginIndex=p,this.endIndex=_}static parse(a,d){if(a.length<=2||a.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const p=d.parse(a[1],1,it),_=d.parse(a[2],2,Ce);if(!p||!_)return null;if(!xi(p.type,[Pn(it),Ye,it]))return d.error(`Expected first argument to be of type array or string, but found ${on(p.type)} instead`);if(a.length===4){const b=d.parse(a[3],3,Ce);return b?new Ed(p.type,p,_,b):null}return new Ed(p.type,p,_)}evaluate(a){const d=this.input.evaluate(a),p=this.beginIndex.evaluate(a);if(!Gi(d,["string","array"]))throw new _t(`Expected first argument to be of type array or string, but found ${on(Ue(d))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(a);return d.slice(p,_)}return d.slice(p)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function Gg(u,a){return u==="=="||u==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function jg(u,a,d,p){return p.compare(a,d)===0}function Wl(u,a,d){const p=u!=="=="&&u!=="!=";return class u9{constructor(b,E,P){this.type=Ze,this.lhs=b,this.rhs=E,this.collator=P,this.hasUntypedArgument=b.type.kind==="value"||E.type.kind==="value"}static parse(b,E){if(b.length!==3&&b.length!==4)return E.error("Expected two or three arguments.");const P=b[0];let I=E.parse(b[1],1,it);if(!I)return null;if(!Gg(P,I.type))return E.concat(1).error(`"${P}" comparisons are not supported for type '${on(I.type)}'.`);let M=E.parse(b[2],2,it);if(!M)return null;if(!Gg(P,M.type))return E.concat(2).error(`"${P}" comparisons are not supported for type '${on(M.type)}'.`);if(I.type.kind!==M.type.kind&&I.type.kind!=="value"&&M.type.kind!=="value")return E.error(`Cannot compare types '${on(I.type)}' and '${on(M.type)}'.`);p&&(I.type.kind==="value"&&M.type.kind!=="value"?I=new zt(M.type,[I]):I.type.kind!=="value"&&M.type.kind==="value"&&(M=new zt(I.type,[M])));let B=null;if(b.length===4){if(I.type.kind!=="string"&&M.type.kind!=="string"&&I.type.kind!=="value"&&M.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(B=E.parse(b[3],3,Ut),!B)return null}return new u9(I,M,B)}evaluate(b){const E=this.lhs.evaluate(b),P=this.rhs.evaluate(b);if(p&&this.hasUntypedArgument){const I=Ue(E),M=Ue(P);if(I.kind!==M.kind||I.kind!=="string"&&I.kind!=="number")throw new _t(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${I.kind}, ${M.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const I=Ue(E),M=Ue(P);if(I.kind!=="string"||M.kind!=="string")return a(b,E,P)}return this.collator?d(b,E,P,this.collator.evaluate(b)):a(b,E,P)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const Fb=Wl("==",function(u,a,d){return a===d},jg),zb=Wl("!=",function(u,a,d){return a!==d},function(u,a,d,p){return!jg(0,a,d,p)}),Nb=Wl("<",function(u,a,d){return a<d},function(u,a,d,p){return p.compare(a,d)<0}),Bb=Wl(">",function(u,a,d){return a>d},function(u,a,d,p){return p.compare(a,d)>0}),Ub=Wl("<=",function(u,a,d){return a<=d},function(u,a,d,p){return p.compare(a,d)<=0}),Vb=Wl(">=",function(u,a,d){return a>=d},function(u,a,d,p){return p.compare(a,d)>=0});class Nf{constructor(a,d,p,_,b){this.type=Ye,this.number=a,this.locale=d,this.currency=p,this.minFractionDigits=_,this.maxFractionDigits=b}static parse(a,d){if(a.length!==3)return d.error("Expected two arguments.");const p=d.parse(a[1],1,Ce);if(!p)return null;const _=a[2];if(typeof _!="object"||Array.isArray(_))return d.error("NumberFormat options argument must be an object.");let b=null;if(_.locale&&(b=d.parse(_.locale,1,Ye),!b))return null;let E=null;if(_.currency&&(E=d.parse(_.currency,1,Ye),!E))return null;let P=null;if(_["min-fraction-digits"]&&(P=d.parse(_["min-fraction-digits"],1,Ce),!P))return null;let I=null;return _["max-fraction-digits"]&&(I=d.parse(_["max-fraction-digits"],1,Ce),!I)?null:new Nf(p,b,E,P,I)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class Td{constructor(a){this.type=Wt,this.sections=a}static parse(a,d){if(a.length<2)return d.error("Expected at least one argument.");const p=a[1];if(!Array.isArray(p)&&typeof p=="object")return d.error("First argument must be an image or text section.");const _=[];let b=!1;for(let E=1;E<=a.length-1;++E){const P=a[E];if(b&&typeof P=="object"&&!Array.isArray(P)){b=!1;let I=null;if(P["font-scale"]&&(I=d.parse(P["font-scale"],1,Ce),!I))return null;let M=null;if(P["text-font"]&&(M=d.parse(P["text-font"],1,Pn(Ye)),!M))return null;let B=null;if(P["text-color"]&&(B=d.parse(P["text-color"],1,gt),!B))return null;const G=_[_.length-1];G.scale=I,G.font=M,G.textColor=B}else{const I=d.parse(a[E],1,it);if(!I)return null;const M=I.type.kind;if(M!=="string"&&M!=="value"&&M!=="null"&&M!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,_.push({content:I,scale:null,font:null,textColor:null})}}return new Td(_)}evaluate(a){return new ye(this.sections.map(d=>{const p=d.content.evaluate(a);return Ue(p)===An?new be("",p,null,null,null):new be(At(p),null,d.scale?d.scale.evaluate(a):null,d.font?d.font.evaluate(a).join(","):null,d.textColor?d.textColor.evaluate(a):null)}))}eachChild(a){for(const d of this.sections)a(d.content),d.scale&&a(d.scale),d.font&&a(d.font),d.textColor&&a(d.textColor)}outputDefined(){return!1}}class Bf{constructor(a){this.type=An,this.input=a}static parse(a,d){if(a.length!==2)return d.error("Expected two arguments.");const p=d.parse(a[1],1,Ye);return p?new Bf(p):d.error("No image name provided.")}evaluate(a){const d=this.input.evaluate(a),p=xe.fromString(d);return p&&a.availableImages&&(p.available=a.availableImages.indexOf(d)>-1),p}eachChild(a){a(this.input)}outputDefined(){return!1}}class Uf{constructor(a){this.type=Ce,this.input=a}static parse(a,d){if(a.length!==2)return d.error(`Expected 1 argument, but found ${a.length-1} instead.`);const p=d.parse(a[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?d.error(`Expected argument of type string or array, but found ${on(p.type)} instead.`):new Uf(p):null}evaluate(a){const d=this.input.evaluate(a);if(typeof d=="string"||Array.isArray(d))return d.length;throw new _t(`Expected value to be of type string or array, but found ${on(Ue(d))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}const Kl={"==":Fb,"!=":zb,">":Bb,"<":Nb,">=":Vb,"<=":Ub,array:zt,at:Of,boolean:zt,case:zf,coalesce:bd,collator:er,format:Td,image:Bf,in:Df,"index-of":wd,interpolate:ys,"interpolate-hcl":ys,"interpolate-lab":ys,length:Uf,let:xd,literal:Rt,match:Ff,number:zt,"number-format":Nf,object:zt,slice:Ed,step:yr,string:zt,"to-boolean":Kt,"to-color":Kt,"to-number":Kt,"to-string":Kt,var:Ne,within:Wo};function Hg(u,[a,d,p,_]){a=a.evaluate(u),d=d.evaluate(u),p=p.evaluate(u);const b=_?_.evaluate(u):1,E=Ve(a,d,p,b);if(E)throw new _t(E);return new te(a/255*b,d/255*b,p/255*b,b)}function Wg(u,a){return u in a}function Sd(u,a){const d=a[u];return d===void 0?null:d}function Xa(u){return{type:u}}function Kg(u){return{result:"success",value:u}}function ql(u){return{result:"error",value:u}}function or(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function qg(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function wn(u){return!!u.expression&&u.expression.interpolated}function zn(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function ir(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function dr(u){return u}function eu(u,a){const d=a.type==="color",p=u.stops&&typeof u.stops[0][0]=="object",_=p||!(p||u.property!==void 0),b=u.type||(wn(a)?"exponential":"interval");if(d||a.type==="padding"){const M=d?te.parse:pe.parse;(u=di({},u)).stops&&(u.stops=u.stops.map(B=>[B[0],M(B[1])])),u.default=M(u.default?u.default:a.default)}if(u.colorSpace&&u.colorSpace!=="rgb"&&!Vg[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let E,P,I;if(b==="exponential")E=Xg;else if(b==="interval")E=jb;else if(b==="categorical"){E=Gb,P=Object.create(null);for(const M of u.stops)P[M[0]]=M[1];I=typeof u.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);E=Hb}if(p){const M={},B=[];for(let Y=0;Y<u.stops.length;Y++){const J=u.stops[Y],fe=J[0].zoom;M[fe]===void 0&&(M[fe]={zoom:fe,type:u.type,property:u.property,default:u.default,stops:[]},B.push(fe)),M[fe].stops.push([J[0].value,J[1]])}const G=[];for(const Y of B)G.push([M[Y].zoom,eu(M[Y],a)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:ys.interpolationFactor.bind(void 0,q),zoomStops:G.map(Y=>Y[0]),evaluate:({zoom:Y},J)=>Xg({stops:G,base:u.base},a,Y).evaluate(Y,J)}}if(_){const M=b==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:ys.interpolationFactor.bind(void 0,M),zoomStops:u.stops.map(B=>B[0]),evaluate:({zoom:B})=>E(u,a,B,P,I)}}return{kind:"source",evaluate(M,B){const G=B&&B.properties?B.properties[u.property]:void 0;return G===void 0?Xl(u.default,a.default):E(u,a,G,P,I)}}}function Xl(u,a,d){return u!==void 0?u:a!==void 0?a:d!==void 0?d:void 0}function Gb(u,a,d,p,_){return Xl(typeof d===_?p[d]:void 0,u.default,a.default)}function jb(u,a,d){if(zn(d)!=="number")return Xl(u.default,a.default);const p=u.stops.length;if(p===1||d<=u.stops[0][0])return u.stops[0][1];if(d>=u.stops[p-1][0])return u.stops[p-1][1];const _=pn(u.stops.map(b=>b[0]),d);return u.stops[_][1]}function Xg(u,a,d){const p=u.base!==void 0?u.base:1;if(zn(d)!=="number")return Xl(u.default,a.default);const _=u.stops.length;if(_===1||d<=u.stops[0][0])return u.stops[0][1];if(d>=u.stops[_-1][0])return u.stops[_-1][1];const b=pn(u.stops.map(B=>B[0]),d),E=function(B,G,q,Y){const J=Y-q,fe=B-q;return J===0?0:G===1?fe/J:(Math.pow(G,fe)-1)/(Math.pow(G,J)-1)}(d,p,u.stops[b][0],u.stops[b+1][0]),P=u.stops[b][1],I=u.stops[b+1][1];let M=Nr[a.type]||dr;if(u.colorSpace&&u.colorSpace!=="rgb"){const B=Vg[u.colorSpace];M=(G,q)=>B.reverse(B.interpolate(B.forward(G),B.forward(q),E))}return typeof P.evaluate=="function"?{evaluate(...B){const G=P.evaluate.apply(void 0,B),q=I.evaluate.apply(void 0,B);if(G!==void 0&&q!==void 0)return M(G,q,E)}}:M(P,I,E)}function Hb(u,a,d){switch(a.type){case"color":d=te.parse(d);break;case"formatted":d=ye.fromString(d.toString());break;case"resolvedImage":d=xe.fromString(d.toString());break;case"padding":d=pe.parse(d);break;default:zn(d)===a.type||a.type==="enum"&&a.values[d]||(d=void 0)}return Xl(d,u.default,a.default)}vn.register(Kl,{error:[{kind:"error"},[Ye],(u,[a])=>{throw new _t(a.evaluate(u))}],typeof:[Ye,[it],(u,[a])=>on(Ue(a.evaluate(u)))],"to-rgba":[Pn(Ce,4),[gt],(u,[a])=>a.evaluate(u).toArray()],rgb:[gt,[Ce,Ce,Ce],Hg],rgba:[gt,[Ce,Ce,Ce,Ce],Hg],has:{type:Ze,overloads:[[[Ye],(u,[a])=>Wg(a.evaluate(u),u.properties())],[[Ye,Ht],(u,[a,d])=>Wg(a.evaluate(u),d.evaluate(u))]]},get:{type:it,overloads:[[[Ye],(u,[a])=>Sd(a.evaluate(u),u.properties())],[[Ye,Ht],(u,[a,d])=>Sd(a.evaluate(u),d.evaluate(u))]]},"feature-state":[it,[Ye],(u,[a])=>Sd(a.evaluate(u),u.featureState||{})],properties:[Ht,[],u=>u.properties()],"geometry-type":[Ye,[],u=>u.geometryType()],id:[it,[],u=>u.id()],zoom:[Ce,[],u=>u.globals.zoom],"heatmap-density":[Ce,[],u=>u.globals.heatmapDensity||0],"line-progress":[Ce,[],u=>u.globals.lineProgress||0],accumulated:[it,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Ce,Xa(Ce),(u,a)=>{let d=0;for(const p of a)d+=p.evaluate(u);return d}],"*":[Ce,Xa(Ce),(u,a)=>{let d=1;for(const p of a)d*=p.evaluate(u);return d}],"-":{type:Ce,overloads:[[[Ce,Ce],(u,[a,d])=>a.evaluate(u)-d.evaluate(u)],[[Ce],(u,[a])=>-a.evaluate(u)]]},"/":[Ce,[Ce,Ce],(u,[a,d])=>a.evaluate(u)/d.evaluate(u)],"%":[Ce,[Ce,Ce],(u,[a,d])=>a.evaluate(u)%d.evaluate(u)],ln2:[Ce,[],()=>Math.LN2],pi:[Ce,[],()=>Math.PI],e:[Ce,[],()=>Math.E],"^":[Ce,[Ce,Ce],(u,[a,d])=>Math.pow(a.evaluate(u),d.evaluate(u))],sqrt:[Ce,[Ce],(u,[a])=>Math.sqrt(a.evaluate(u))],log10:[Ce,[Ce],(u,[a])=>Math.log(a.evaluate(u))/Math.LN10],ln:[Ce,[Ce],(u,[a])=>Math.log(a.evaluate(u))],log2:[Ce,[Ce],(u,[a])=>Math.log(a.evaluate(u))/Math.LN2],sin:[Ce,[Ce],(u,[a])=>Math.sin(a.evaluate(u))],cos:[Ce,[Ce],(u,[a])=>Math.cos(a.evaluate(u))],tan:[Ce,[Ce],(u,[a])=>Math.tan(a.evaluate(u))],asin:[Ce,[Ce],(u,[a])=>Math.asin(a.evaluate(u))],acos:[Ce,[Ce],(u,[a])=>Math.acos(a.evaluate(u))],atan:[Ce,[Ce],(u,[a])=>Math.atan(a.evaluate(u))],min:[Ce,Xa(Ce),(u,a)=>Math.min(...a.map(d=>d.evaluate(u)))],max:[Ce,Xa(Ce),(u,a)=>Math.max(...a.map(d=>d.evaluate(u)))],abs:[Ce,[Ce],(u,[a])=>Math.abs(a.evaluate(u))],round:[Ce,[Ce],(u,[a])=>{const d=a.evaluate(u);return d<0?-Math.round(-d):Math.round(d)}],floor:[Ce,[Ce],(u,[a])=>Math.floor(a.evaluate(u))],ceil:[Ce,[Ce],(u,[a])=>Math.ceil(a.evaluate(u))],"filter-==":[Ze,[Ye,it],(u,[a,d])=>u.properties()[a.value]===d.value],"filter-id-==":[Ze,[it],(u,[a])=>u.id()===a.value],"filter-type-==":[Ze,[Ye],(u,[a])=>u.geometryType()===a.value],"filter-<":[Ze,[Ye,it],(u,[a,d])=>{const p=u.properties()[a.value],_=d.value;return typeof p==typeof _&&p<_}],"filter-id-<":[Ze,[it],(u,[a])=>{const d=u.id(),p=a.value;return typeof d==typeof p&&d<p}],"filter->":[Ze,[Ye,it],(u,[a,d])=>{const p=u.properties()[a.value],_=d.value;return typeof p==typeof _&&p>_}],"filter-id->":[Ze,[it],(u,[a])=>{const d=u.id(),p=a.value;return typeof d==typeof p&&d>p}],"filter-<=":[Ze,[Ye,it],(u,[a,d])=>{const p=u.properties()[a.value],_=d.value;return typeof p==typeof _&&p<=_}],"filter-id-<=":[Ze,[it],(u,[a])=>{const d=u.id(),p=a.value;return typeof d==typeof p&&d<=p}],"filter->=":[Ze,[Ye,it],(u,[a,d])=>{const p=u.properties()[a.value],_=d.value;return typeof p==typeof _&&p>=_}],"filter-id->=":[Ze,[it],(u,[a])=>{const d=u.id(),p=a.value;return typeof d==typeof p&&d>=p}],"filter-has":[Ze,[it],(u,[a])=>a.value in u.properties()],"filter-has-id":[Ze,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Ze,[Pn(Ye)],(u,[a])=>a.value.indexOf(u.geometryType())>=0],"filter-id-in":[Ze,[Pn(it)],(u,[a])=>a.value.indexOf(u.id())>=0],"filter-in-small":[Ze,[Ye,Pn(it)],(u,[a,d])=>d.value.indexOf(u.properties()[a.value])>=0],"filter-in-large":[Ze,[Ye,Pn(it)],(u,[a,d])=>function(p,_,b,E){for(;b<=E;){const P=b+E>>1;if(_[P]===p)return!0;_[P]>p?E=P-1:b=P+1}return!1}(u.properties()[a.value],d.value,0,d.value.length-1)],all:{type:Ze,overloads:[[[Ze,Ze],(u,[a,d])=>a.evaluate(u)&&d.evaluate(u)],[Xa(Ze),(u,a)=>{for(const d of a)if(!d.evaluate(u))return!1;return!0}]]},any:{type:Ze,overloads:[[[Ze,Ze],(u,[a,d])=>a.evaluate(u)||d.evaluate(u)],[Xa(Ze),(u,a)=>{for(const d of a)if(d.evaluate(u))return!0;return!1}]]},"!":[Ze,[Ze],(u,[a])=>!a.evaluate(u)],"is-supported-script":[Ze,[Ye],(u,[a])=>{const d=u.globals&&u.globals.isSupportedScript;return!d||d(a.evaluate(u))}],upcase:[Ye,[Ye],(u,[a])=>a.evaluate(u).toUpperCase()],downcase:[Ye,[Ye],(u,[a])=>a.evaluate(u).toLowerCase()],concat:[Ye,Xa(it),(u,a)=>a.map(d=>At(d.evaluate(u))).join("")],"resolved-locale":[Ye,[Ut],(u,[a])=>a.evaluate(u).resolvedLocale()]});class Ad{constructor(a,d){this.expression=a,this._warningHistory={},this._evaluator=new fn,this._defaultValue=d?function(p){return p.type==="color"&&ir(p.default)?new te(0,0,0,0):p.type==="color"?te.parse(p.default)||null:p.type==="padding"?pe.parse(p.default)||null:p.default===void 0?null:p.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null}evaluateWithoutErrorHandling(a,d,p,_,b,E){return this._evaluator.globals=a,this._evaluator.feature=d,this._evaluator.featureState=p,this._evaluator.canonical=_,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(a,d,p,_,b,E){this._evaluator.globals=a,this._evaluator.feature=d||null,this._evaluator.featureState=p||null,this._evaluator.canonical=_,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=E||null;try{const P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new _t(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(P)} instead.`);return P}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console<"u"&&console.warn(P.message)),this._defaultValue}}}function tu(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in Kl}function nu(u,a){const d=new nt(Kl,[],a?function(_){const b={color:gt,string:Ye,number:Ce,enum:Ye,boolean:Ze,formatted:Wt,padding:Dn,resolvedImage:An};return _.type==="array"?Pn(b[_.value]||it,_.length):b[_.type]}(a):void 0),p=d.parse(u,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?Kg(new Ad(p,a)):ql(d.errors)}class ru{constructor(a,d){this.kind=a,this._styleExpression=d,this.isStateDependent=a!=="constant"&&!ne(d.expression)}evaluateWithoutErrorHandling(a,d,p,_,b,E){return this._styleExpression.evaluateWithoutErrorHandling(a,d,p,_,b,E)}evaluate(a,d,p,_,b,E){return this._styleExpression.evaluate(a,d,p,_,b,E)}}class Vf{constructor(a,d,p,_){this.kind=a,this.zoomStops=p,this._styleExpression=d,this.isStateDependent=a!=="camera"&&!ne(d.expression),this.interpolationType=_}evaluateWithoutErrorHandling(a,d,p,_,b,E){return this._styleExpression.evaluateWithoutErrorHandling(a,d,p,_,b,E)}evaluate(a,d,p,_,b,E){return this._styleExpression.evaluate(a,d,p,_,b,E)}interpolationFactor(a,d,p){return this.interpolationType?ys.interpolationFactor(this.interpolationType,a,d,p):0}}function Zg(u,a){const d=nu(u,a);if(d.result==="error")return d;const p=d.value.expression,_=Z(p);if(!_&&!or(a))return ql([new bi("","data expressions not supported")]);const b=ge(p,["zoom"]);if(!b&&!qg(a))return ql([new bi("","zoom expressions not supported")]);const E=Cd(p);return E||b?E instanceof bi?ql([E]):E instanceof ys&&!wn(a)?ql([new bi("",'"interpolate" expressions cannot be used with this property')]):Kg(E?new Vf(_?"camera":"composite",d.value,E.labels,E instanceof ys?E.interpolation:void 0):new ru(_?"constant":"source",d.value)):ql([new bi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Pd{constructor(a,d){this._parameters=a,this._specification=d,di(this,eu(this._parameters,this._specification))}static deserialize(a){return new Pd(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function Cd(u){let a=null;if(u instanceof xd)a=Cd(u.result);else if(u instanceof bd){for(const d of u.args)if(a=Cd(d),a)break}else(u instanceof yr||u instanceof ys)&&u.input instanceof vn&&u.input.name==="zoom"&&(a=u);return a instanceof bi||u.eachChild(d=>{const p=Cd(d);p instanceof bi?a=p:!a&&p?a=new bi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&p&&a!==p&&(a=new bi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function Qs(u){const a=u.key,d=u.value,p=u.valueSpec||{},_=u.objectElementValidators||{},b=u.style,E=u.styleSpec;let P=[];const I=zn(d);if(I!=="object")return[new dt(a,d,`object expected, ${I} found`)];for(const M in d){const B=M.split(".")[0],G=p[B]||p["*"];let q;if(_[B])q=_[B];else if(p[B])q=vs;else if(_["*"])q=_["*"];else{if(!p["*"]){P.push(new dt(a,d[M],`unknown property "${M}"`));continue}q=vs}P=P.concat(q({key:(a&&`${a}.`)+M,value:d[M],valueSpec:G,style:b,styleSpec:E,object:d,objectKey:M},d))}for(const M in p)_[M]||p[M].required&&p[M].default===void 0&&d[M]===void 0&&P.push(new dt(a,d,`missing required property "${M}"`));return P}function Yg(u){const a=u.value,d=u.valueSpec,p=u.style,_=u.styleSpec,b=u.key,E=u.arrayElementValidator||vs;if(zn(a)!=="array")return[new dt(b,a,`array expected, ${zn(a)} found`)];if(d.length&&a.length!==d.length)return[new dt(b,a,`array length ${d.length} expected, length ${a.length} found`)];if(d["min-length"]&&a.length<d["min-length"])return[new dt(b,a,`array length at least ${d["min-length"]} expected, length ${a.length} found`)];let P={type:d.value,values:d.values};_.$version<7&&(P.function=d.function),zn(d.value)==="object"&&(P=d.value);let I=[];for(let M=0;M<a.length;M++)I=I.concat(E({array:a,arrayIndex:M,value:a[M],valueSpec:P,style:p,styleSpec:_,key:`${b}[${M}]`}));return I}function Gf(u){const a=u.key,d=u.value,p=u.valueSpec;let _=zn(d);return _==="number"&&d!=d&&(_="NaN"),_!=="number"?[new dt(a,d,`number expected, ${_} found`)]:"minimum"in p&&d<p.minimum?[new dt(a,d,`${d} is less than the minimum value ${p.minimum}`)]:"maximum"in p&&d>p.maximum?[new dt(a,d,`${d} is greater than the maximum value ${p.maximum}`)]:[]}function Jg(u){const a=u.valueSpec,d=ln(u.value.type);let p,_,b,E={};const P=d!=="categorical"&&u.value.property===void 0,I=!P,M=zn(u.value.stops)==="array"&&zn(u.value.stops[0])==="array"&&zn(u.value.stops[0][0])==="object",B=Qs({key:u.key,value:u.value,valueSpec:u.styleSpec.function,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(Y){if(d==="identity")return[new dt(Y.key,Y.value,'identity function may not have a "stops" property')];let J=[];const fe=Y.value;return J=J.concat(Yg({key:Y.key,value:fe,valueSpec:Y.valueSpec,style:Y.style,styleSpec:Y.styleSpec,arrayElementValidator:G})),zn(fe)==="array"&&fe.length===0&&J.push(new dt(Y.key,fe,"array must have at least one stop")),J},default:function(Y){return vs({key:Y.key,value:Y.value,valueSpec:a,style:Y.style,styleSpec:Y.styleSpec})}}});return d==="identity"&&P&&B.push(new dt(u.key,u.value,'missing required property "property"')),d==="identity"||u.value.stops||B.push(new dt(u.key,u.value,'missing required property "stops"')),d==="exponential"&&u.valueSpec.expression&&!wn(u.valueSpec)&&B.push(new dt(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(I&&!or(u.valueSpec)?B.push(new dt(u.key,u.value,"property functions not supported")):P&&!qg(u.valueSpec)&&B.push(new dt(u.key,u.value,"zoom functions not supported"))),d!=="categorical"&&!M||u.value.property!==void 0||B.push(new dt(u.key,u.value,'"property" property is required')),B;function G(Y){let J=[];const fe=Y.value,de=Y.key;if(zn(fe)!=="array")return[new dt(de,fe,`array expected, ${zn(fe)} found`)];if(fe.length!==2)return[new dt(de,fe,`array length 2 expected, length ${fe.length} found`)];if(M){if(zn(fe[0])!=="object")return[new dt(de,fe,`object expected, ${zn(fe[0])} found`)];if(fe[0].zoom===void 0)return[new dt(de,fe,"object stop key must have zoom")];if(fe[0].value===void 0)return[new dt(de,fe,"object stop key must have value")];if(b&&b>ln(fe[0].zoom))return[new dt(de,fe[0].zoom,"stop zoom values must appear in ascending order")];ln(fe[0].zoom)!==b&&(b=ln(fe[0].zoom),_=void 0,E={}),J=J.concat(Qs({key:`${de}[0]`,value:fe[0],valueSpec:{zoom:{}},style:Y.style,styleSpec:Y.styleSpec,objectElementValidators:{zoom:Gf,value:q}}))}else J=J.concat(q({key:`${de}[0]`,value:fe[0],valueSpec:{},style:Y.style,styleSpec:Y.styleSpec},fe));return tu(Li(fe[1]))?J.concat([new dt(`${de}[1]`,fe[1],"expressions are not allowed in function stops.")]):J.concat(vs({key:`${de}[1]`,value:fe[1],valueSpec:a,style:Y.style,styleSpec:Y.styleSpec}))}function q(Y,J){const fe=zn(Y.value),de=ln(Y.value),Ie=Y.value!==null?Y.value:J;if(p){if(fe!==p)return[new dt(Y.key,Ie,`${fe} stop domain type must match previous stop domain type ${p}`)]}else p=fe;if(fe!=="number"&&fe!=="string"&&fe!=="boolean")return[new dt(Y.key,Ie,"stop domain value must be a number, string, or boolean")];if(fe!=="number"&&d!=="categorical"){let ze=`number expected, ${fe} found`;return or(a)&&d===void 0&&(ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new dt(Y.key,Ie,ze)]}return d!=="categorical"||fe!=="number"||isFinite(de)&&Math.floor(de)===de?d!=="categorical"&&fe==="number"&&_!==void 0&&de<_?[new dt(Y.key,Ie,"stop domain values must appear in ascending order")]:(_=de,d==="categorical"&&de in E?[new dt(Y.key,Ie,"stop domain values must be unique")]:(E[de]=!0,[])):[new dt(Y.key,Ie,`integer expected, found ${de}`)]}}function Za(u){const a=(u.expressionContext==="property"?Zg:nu)(Li(u.value),u.valueSpec);if(a.result==="error")return a.value.map(p=>new dt(`${u.key}${p.key}`,u.value,p.message));const d=a.value.expression||a.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!d.outputDefined())return[new dt(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!ne(d))return[new dt(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!ne(d))return[new dt(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!ge(d,["zoom","feature-state"]))return[new dt(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!Z(d))return[new dt(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function iu(u){const a=u.key,d=u.value,p=u.valueSpec,_=[];return Array.isArray(p.values)?p.values.indexOf(ln(d))===-1&&_.push(new dt(a,d,`expected one of [${p.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(p.values).indexOf(ln(d))===-1&&_.push(new dt(a,d,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(d)} found`)),_}function Zl(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const a of u.slice(1))if(!Zl(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}const Wb={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Id(u){if(u==null)return{filter:()=>!0,needGeometry:!1};Zl(u)||(u=su(u));const a=nu(u,Wb);if(a.result==="error")throw new Error(a.value.map(d=>`${d.key}: ${d.message}`).join(", "));return{filter:(d,p,_)=>a.value.evaluate(d,p,{},_),needGeometry:ey(u)}}function Qg(u,a){return u<a?-1:u>a?1:0}function ey(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let a=1;a<u.length;a++)if(ey(u[a]))return!0;return!1}function su(u){if(!u)return!0;const a=u[0];return u.length<=1?a!=="any":a==="=="?jf(u[1],u[2],"=="):a==="!="?Yl(jf(u[1],u[2],"==")):a==="<"||a===">"||a==="<="||a===">="?jf(u[1],u[2],a):a==="any"?(d=u.slice(1),["any"].concat(d.map(su))):a==="all"?["all"].concat(u.slice(1).map(su)):a==="none"?["all"].concat(u.slice(1).map(su).map(Yl)):a==="in"?Ld(u[1],u.slice(2)):a==="!in"?Yl(Ld(u[1],u.slice(2))):a==="has"?ou(u[1]):a==="!has"?Yl(ou(u[1])):a!=="within"||u;var d}function jf(u,a,d){switch(u){case"$type":return[`filter-type-${d}`,a];case"$id":return[`filter-id-${d}`,a];default:return[`filter-${d}`,u,a]}}function Ld(u,a){if(a.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(d=>typeof d!=typeof a[0])?["filter-in-large",u,["literal",a.sort(Qg)]]:["filter-in-small",u,["literal",a]]}}function ou(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Yl(u){return["!",u]}function au(u){return Zl(Li(u.value))?Za(di({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ty(u)}function ty(u){const a=u.value,d=u.key;if(zn(a)!=="array")return[new dt(d,a,`array expected, ${zn(a)} found`)];const p=u.styleSpec;let _,b=[];if(a.length<1)return[new dt(d,a,"filter array must have at least 1 element")];switch(b=b.concat(iu({key:`${d}[0]`,value:a[0],valueSpec:p.filter_operator,style:u.style,styleSpec:u.styleSpec})),ln(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&ln(a[1])==="$type"&&b.push(new dt(d,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&b.push(new dt(d,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(_=zn(a[1]),_!=="string"&&b.push(new dt(`${d}[1]`,a[1],`string expected, ${_} found`)));for(let E=2;E<a.length;E++)_=zn(a[E]),ln(a[1])==="$type"?b=b.concat(iu({key:`${d}[${E}]`,value:a[E],valueSpec:p.geometry_type,style:u.style,styleSpec:u.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&b.push(new dt(`${d}[${E}]`,a[E],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let E=1;E<a.length;E++)b=b.concat(ty({key:`${d}[${E}]`,value:a[E],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":_=zn(a[1]),a.length!==2?b.push(new dt(d,a,`filter array for "${a[0]}" operator must have 2 elements`)):_!=="string"&&b.push(new dt(`${d}[1]`,a[1],`string expected, ${_} found`));break;case"within":_=zn(a[1]),a.length!==2?b.push(new dt(d,a,`filter array for "${a[0]}" operator must have 2 elements`)):_!=="object"&&b.push(new dt(`${d}[1]`,a[1],`object expected, ${_} found`))}return b}function lu(u,a){const d=u.key,p=u.style,_=u.styleSpec,b=u.value,E=u.objectKey,P=_[`${a}_${u.layerType}`];if(!P)return[];const I=E.match(/^(.*)-transition$/);if(a==="paint"&&I&&P[I[1]]&&P[I[1]].transition)return vs({key:d,value:b,valueSpec:_.transition,style:p,styleSpec:_});const M=u.valueSpec||P[E];if(!M)return[new dt(d,b,`unknown property "${E}"`)];let B;if(zn(b)==="string"&&or(M)&&!M.tokens&&(B=/^{([^}]+)}$/.exec(b)))return[new dt(d,b,`"${E}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(B[1])} }\`.`)];const G=[];return u.layerType==="symbol"&&(E==="text-field"&&p&&!p.glyphs&&G.push(new dt(d,b,'use of "text-field" requires a style "glyphs" property')),E==="text-font"&&ir(Li(b))&&ln(b.type)==="identity"&&G.push(new dt(d,b,'"text-font" does not support identity functions'))),G.concat(vs({key:u.key,value:b,valueSpec:M,style:p,styleSpec:_,expressionContext:"property",propertyType:a,propertyKey:E}))}function ny(u){return lu(u,"paint")}function ry(u){return lu(u,"layout")}function iy(u){let a=[];const d=u.value,p=u.key,_=u.style,b=u.styleSpec;d.type||d.ref||a.push(new dt(p,d,'either "type" or "ref" is required'));let E=ln(d.type);const P=ln(d.ref);if(d.id){const I=ln(d.id);for(let M=0;M<u.arrayIndex;M++){const B=_.layers[M];ln(B.id)===I&&a.push(new dt(p,d.id,`duplicate layer id "${d.id}", previously used at line ${B.id.__line__}`))}}if("ref"in d){let I;["type","source","source-layer","filter","layout"].forEach(M=>{M in d&&a.push(new dt(p,d[M],`"${M}" is prohibited for ref layers`))}),_.layers.forEach(M=>{ln(M.id)===P&&(I=M)}),I?I.ref?a.push(new dt(p,d.ref,"ref cannot reference another ref layer")):E=ln(I.type):a.push(new dt(p,d.ref,`ref layer "${P}" not found`))}else if(E!=="background")if(d.source){const I=_.sources&&_.sources[d.source],M=I&&ln(I.type);I?M==="vector"&&E==="raster"?a.push(new dt(p,d.source,`layer "${d.id}" requires a raster source`)):M==="raster"&&E!=="raster"?a.push(new dt(p,d.source,`layer "${d.id}" requires a vector source`)):M!=="vector"||d["source-layer"]?M==="raster-dem"&&E!=="hillshade"?a.push(new dt(p,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!d.paint||!d.paint["line-gradient"]||M==="geojson"&&I.lineMetrics||a.push(new dt(p,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new dt(p,d,`layer "${d.id}" must specify a "source-layer"`)):a.push(new dt(p,d.source,`source "${d.source}" not found`))}else a.push(new dt(p,d,'missing required property "source"'));return a=a.concat(Qs({key:p,value:d,valueSpec:b.layer,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{"*":()=>[],type:()=>vs({key:`${p}.type`,value:d.type,valueSpec:b.layer.type,style:u.style,styleSpec:u.styleSpec,object:d,objectKey:"type"}),filter:au,layout:I=>Qs({layer:d,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":M=>ry(di({layerType:E},M))}}),paint:I=>Qs({layer:d,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":M=>ny(di({layerType:E},M))}})}})),a}function Jl(u){const a=u.value,d=u.key,p=zn(a);return p!=="string"?[new dt(d,a,`string expected, ${p} found`)]:[]}const sy={promoteId:function({key:u,value:a}){if(zn(a)==="string")return Jl({key:u,value:a});{const d=[];for(const p in a)d.push(...Jl({key:`${u}.${p}`,value:a[p]}));return d}}};function cu(u){const a=u.value,d=u.key,p=u.styleSpec,_=u.style;if(!a.type)return[new dt(d,a,'"type" is required')];const b=ln(a.type);let E;switch(b){case"vector":case"raster":case"raster-dem":return E=Qs({key:d,value:a,valueSpec:p[`source_${b.replace("-","_")}`],style:u.style,styleSpec:p,objectElementValidators:sy}),E;case"geojson":if(E=Qs({key:d,value:a,valueSpec:p.source_geojson,style:_,styleSpec:p,objectElementValidators:sy}),a.cluster)for(const P in a.clusterProperties){const[I,M]=a.clusterProperties[P],B=typeof I=="string"?[I,["accumulated"],["get",P]]:I;E.push(...Za({key:`${d}.${P}.map`,value:M,expressionContext:"cluster-map"})),E.push(...Za({key:`${d}.${P}.reduce`,value:B,expressionContext:"cluster-reduce"}))}return E;case"video":return Qs({key:d,value:a,valueSpec:p.source_video,style:_,styleSpec:p});case"image":return Qs({key:d,value:a,valueSpec:p.source_image,style:_,styleSpec:p});case"canvas":return[new dt(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return iu({key:`${d}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:_,styleSpec:p})}}function uu(u){const a=u.value,d=u.styleSpec,p=d.light,_=u.style;let b=[];const E=zn(a);if(a===void 0)return b;if(E!=="object")return b=b.concat([new dt("light",a,`object expected, ${E} found`)]),b;for(const P in a){const I=P.match(/^(.*)-transition$/);b=b.concat(I&&p[I[1]]&&p[I[1]].transition?vs({key:P,value:a[P],valueSpec:d.transition,style:_,styleSpec:d}):p[P]?vs({key:P,value:a[P],valueSpec:p[P],style:_,styleSpec:d}):[new dt(P,a[P],`unknown property "${P}"`)])}return b}function _s(u){const a=u.value,d=u.styleSpec,p=d.terrain,_=u.style;let b=[];const E=zn(a);if(a===void 0)return b;if(E!=="object")return b=b.concat([new dt("terrain",a,`object expected, ${E} found`)]),b;for(const P in a)b=b.concat(p[P]?vs({key:P,value:a[P],valueSpec:p[P],style:_,styleSpec:d}):[new dt(P,a[P],`unknown property "${P}"`)]);return b}const du={"*":()=>[],array:Yg,boolean:function(u){const a=u.value,d=u.key,p=zn(a);return p!=="boolean"?[new dt(d,a,`boolean expected, ${p} found`)]:[]},number:Gf,color:function(u){const a=u.key,d=u.value,p=zn(d);return p!=="string"?[new dt(a,d,`color expected, ${p} found`)]:es(d)===null?[new dt(a,d,`color expected, "${d}" found`)]:[]},constants:Ms,enum:iu,filter:au,function:Jg,layer:iy,object:Qs,source:cu,light:uu,terrain:_s,string:Jl,formatted:function(u){return Jl(u).length===0?[]:Za(u)},resolvedImage:function(u){return Jl(u).length===0?[]:Za(u)},padding:function(u){const a=u.key,d=u.value;if(zn(d)==="array"){if(d.length<1||d.length>4)return[new dt(a,d,`padding requires 1 to 4 values; ${d.length} values found`)];const p={type:"number"};let _=[];for(let b=0;b<d.length;b++)_=_.concat(vs({key:`${a}[${b}]`,value:d[b],valueSpec:p}));return _}return Gf({key:a,value:d,valueSpec:{}})}};function vs(u){const a=u.value,d=u.valueSpec,p=u.styleSpec;return d.expression&&ir(ln(a))?Jg(u):d.expression&&tu(Li(a))?Za(u):d.type&&du[d.type]?du[d.type](u):Qs(di({},u,{valueSpec:d.type?p[d.type]:d}))}function Kb(u){const a=u.value,d=u.key,p=Jl(u);return p.length||(a.indexOf("{fontstack}")===-1&&p.push(new dt(d,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&p.push(new dt(d,a,'"glyphs" url must include a "{range}" token'))),p}function va(u,a=je){let d=[];return d=d.concat(vs({key:"",value:u,valueSpec:a.$root,styleSpec:a,style:u,objectElementValidators:{glyphs:Kb,"*":()=>[]}})),u.constants&&(d=d.concat(Ms({key:"constants",value:u.constants,style:u,styleSpec:a}))),oy(d)}function oy(u){return[].concat(u).sort((a,d)=>a.line-d.line)}function Ko(u){return function(...a){return oy(u.apply(this,a))}}va.source=Ko(cu),va.light=Ko(uu),va.terrain=Ko(_s),va.layer=Ko(iy),va.filter=Ko(au),va.paintProperty=Ko(ny),va.layoutProperty=Ko(ry);const hu=va,Hf=hu.light,qb=hu.paintProperty,Xb=hu.layoutProperty;function Rd(u,a){let d=!1;if(a&&a.length)for(const p of a)u.fire(new So(new Error(p.message))),d=!0;return d}class fu{constructor(a,d,p){const _=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;const E=new Int32Array(this.arrayBuffer);a=E[0],this.d=(d=E[1])+2*(p=E[2]);for(let I=0;I<this.d*this.d;I++){const M=E[3+I],B=E[3+I+1];_.push(M===B?null:E.subarray(M,B))}const P=E[3+_.length+1];this.keys=E.subarray(E[3+_.length],P),this.bboxes=E.subarray(P),this.insert=this._insertReadonly}else{this.d=d+2*p;for(let E=0;E<this.d*this.d;E++)_.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=a,this.padding=p,this.scale=d/a,this.uid=0;const b=p/d*a;this.min=-b,this.max=a+b}insert(a,d,p,_,b){this._forEachCell(d,p,_,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(d),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(a,d,p,_,b,E){this.cells[b].push(E)}query(a,d,p,_,b){const E=this.min,P=this.max;if(a<=E&&d<=E&&P<=p&&P<=_&&!b)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(a,d,p,_,this._queryCell,I,{},b),I}}_queryCell(a,d,p,_,b,E,P,I){const M=this.cells[b];if(M!==null){const B=this.keys,G=this.bboxes;for(let q=0;q<M.length;q++){const Y=M[q];if(P[Y]===void 0){const J=4*Y;(I?I(G[J+0],G[J+1],G[J+2],G[J+3]):a<=G[J+2]&&d<=G[J+3]&&p>=G[J+0]&&_>=G[J+1])?(P[Y]=!0,E.push(B[Y])):P[Y]=!1}}}}_forEachCell(a,d,p,_,b,E,P,I){const M=this._convertToCellCoord(a),B=this._convertToCellCoord(d),G=this._convertToCellCoord(p),q=this._convertToCellCoord(_);for(let Y=M;Y<=G;Y++)for(let J=B;J<=q;J++){const fe=this.d*J+Y;if((!I||I(this._convertFromCellCoord(Y),this._convertFromCellCoord(J),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(J+1)))&&b.call(this,a,d,p,_,fe,E,P,I))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const a=this.cells,d=3+this.cells.length+1+1;let p=0;for(let E=0;E<this.cells.length;E++)p+=this.cells[E].length;const _=new Int32Array(d+p+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let b=d;for(let E=0;E<a.length;E++){const P=a[E];_[3+E]=b,_.set(P,b),b+=P.length}return _[3+a.length]=b,_.set(this.keys,b),b+=this.keys.length,_[3+a.length+1]=b,_.set(this.bboxes,b),b+=this.bboxes.length,_.buffer}static serialize(a,d){const p=a.toArrayBuffer();return d&&d.push(p),{buffer:p}}static deserialize(a){return new fu(a.buffer)}}const qo={};function Pt(u,a,d={}){if(qo[u])throw new Error(`${u} is already registered.`);Object.defineProperty(a,"_classRegistryKey",{value:u,writeable:!1}),qo[u]={klass:a,omit:d.omit||[],shallow:d.shallow||[]}}Pt("Object",Object),Pt("TransferableGridIndex",fu),Pt("Color",te),Pt("Error",Error),Pt("AJAXError",Dt),Pt("ResolvedImage",xe),Pt("StylePropertyFunction",Pd),Pt("StyleExpression",Ad,{omit:["_evaluator"]}),Pt("ZoomDependentExpression",Vf),Pt("ZoomConstantExpression",ru),Pt("CompoundExpression",vn,{omit:["_evaluate"]});for(const u in Kl)Kl[u]._classRegistryKey||Pt(`Expression_${u}`,Kl[u]);function ay(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function Ya(u,a){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob)return u;if(ay(u)||Be(u))return a&&a.push(u),u;if(ArrayBuffer.isView(u)){const d=u;return a&&a.push(d.buffer),d}if(u instanceof ImageData)return a&&a.push(u.data.buffer),u;if(Array.isArray(u)){const d=[];for(const p of u)d.push(Ya(p,a));return d}if(typeof u=="object"){const d=u.constructor,p=d._classRegistryKey;if(!p)throw new Error("can't serialize object of unregistered class");if(!qo[p])throw new Error(`${p} is not registered.`);const _=d.serialize?d.serialize(u,a):{};if(d.serialize){if(a&&_===a[a.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in u){if(!u.hasOwnProperty(b)||qo[p].omit.indexOf(b)>=0)continue;const E=u[b];_[b]=qo[p].shallow.indexOf(b)>=0?E:Ya(E,a)}u instanceof Error&&(_.message=u.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(_.$name=p),_}throw new Error("can't serialize object of type "+typeof u)}function ba(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||ay(u)||Be(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(ba);if(typeof u=="object"){const a=u.$name||"Object";if(!qo[a])throw new Error(`can't deserialize unregistered class ${a}`);const{klass:d}=qo[a];if(!d)throw new Error(`can't deserialize unregistered class ${a}`);if(d.deserialize)return d.deserialize(u);const p=Object.create(d.prototype);for(const _ of Object.keys(u)){if(_==="$name")continue;const b=u[_];p[_]=qo[a].shallow.indexOf(_)>=0?b:ba(b)}return p}throw new Error("can't deserialize object of type "+typeof u)}class Wf{constructor(){this.first=!0}update(a,d){const p=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=p,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=p,!0):(this.lastFloorZoom>p?(this.lastIntegerZoom=p+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<p&&(this.lastIntegerZoom=p,this.lastIntegerZoomTime=d),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=p,!0))}}const vt={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function $d(u){for(const a of u)if(qf(a.charCodeAt(0)))return!0;return!1}function Zb(u){for(const a of u)if(!Kf(a.charCodeAt(0)))return!1;return!0}function Kf(u){return!(vt.Arabic(u)||vt["Arabic Supplement"](u)||vt["Arabic Extended-A"](u)||vt["Arabic Presentation Forms-A"](u)||vt["Arabic Presentation Forms-B"](u))}function qf(u){return!(u!==746&&u!==747&&(u<4352||!(vt["Bopomofo Extended"](u)||vt.Bopomofo(u)||vt["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||vt["CJK Compatibility Ideographs"](u)||vt["CJK Compatibility"](u)||vt["CJK Radicals Supplement"](u)||vt["CJK Strokes"](u)||!(!vt["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||vt["CJK Unified Ideographs Extension A"](u)||vt["CJK Unified Ideographs"](u)||vt["Enclosed CJK Letters and Months"](u)||vt["Hangul Compatibility Jamo"](u)||vt["Hangul Jamo Extended-A"](u)||vt["Hangul Jamo Extended-B"](u)||vt["Hangul Jamo"](u)||vt["Hangul Syllables"](u)||vt.Hiragana(u)||vt["Ideographic Description Characters"](u)||vt.Kanbun(u)||vt["Kangxi Radicals"](u)||vt["Katakana Phonetic Extensions"](u)||vt.Katakana(u)&&u!==12540||!(!vt["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!vt["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||vt["Unified Canadian Aboriginal Syllabics"](u)||vt["Unified Canadian Aboriginal Syllabics Extended"](u)||vt["Vertical Forms"](u)||vt["Yijing Hexagram Symbols"](u)||vt["Yi Syllables"](u)||vt["Yi Radicals"](u))))}function ly(u){return!(qf(u)||function(a){return!!(vt["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||vt["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||vt["Letterlike Symbols"](a)||vt["Number Forms"](a)||vt["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||vt["Control Pictures"](a)&&a!==9251||vt["Optical Character Recognition"](a)||vt["Enclosed Alphanumerics"](a)||vt["Geometric Shapes"](a)||vt["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||vt["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||vt["CJK Symbols and Punctuation"](a)||vt.Katakana(a)||vt["Private Use Area"](a)||vt["CJK Compatibility Forms"](a)||vt["Small Form Variants"](a)||vt["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(u))}function cy(u){return u>=1424&&u<=2303||vt["Arabic Presentation Forms-A"](u)||vt["Arabic Presentation Forms-B"](u)}function Yb(u,a){return!(!a&&cy(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||vt.Khmer(u))}function uy(u){for(const a of u)if(cy(a.charCodeAt(0)))return!0;return!1}const Xf="deferred",Zf="loading",Yf="loaded";let Jf=null,ts="unavailable",xa=null;const dy=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(ts="error"),Jf&&Jf(u)};function Ql(){Qf.fire(new Vi("pluginStateChange",{pluginStatus:ts,pluginURL:xa}))}const Qf=new Qi,pu=function(){return ts},hy=function(){if(ts!==Xf||!xa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ts=Zf,Ql(),xa&&Qn({url:xa},u=>{u?dy(u):(ts=Yf,Ql())})},ks={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ts===Yf||ks.applyArabicShaping!=null,isLoading:()=>ts===Zf,setState(u){if(!ve())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");ts=u.pluginStatus,xa=u.pluginURL},isParsed(){if(!ve())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ks.applyArabicShaping!=null&&ks.processBidirectionalText!=null&&ks.processStyledBidirectionalText!=null},getPluginURL(){if(!ve())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return xa}};class hr{constructor(a,d){this.zoom=a,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Wf,this.transition={})}isSupportedScript(a){return function(d,p){for(const _ of d)if(!Yb(_.charCodeAt(0),p))return!1;return!0}(a,ks.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const a=this.zoom,d=a-Math.floor(a),p=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*p}:{fromScale:.5,toScale:1,t:1-(1-p)*d}}}class mu{constructor(a,d){this.property=a,this.value=d,this.expression=function(p,_){if(ir(p))return new Pd(p,_);if(tu(p)){const b=Zg(p,_);if(b.result==="error")throw new Error(b.value.map(E=>`${E.key}: ${E.message}`).join(", "));return b.value}{let b=p;return _.type==="color"&&typeof p=="string"?b=te.parse(p):_.type!=="padding"||typeof p!="number"&&!Array.isArray(p)||(b=pe.parse(p)),{kind:"constant",evaluate:()=>b}}}(d===void 0?a.specification.default:d,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,d,p){return this.property.possiblyEvaluate(this,a,d,p)}}class Md{constructor(a){this.property=a,this.value=new mu(a,void 0)}transitioned(a,d){return new py(this.property,this.value,d,R({},a.transition,this.transition),a.now)}untransitioned(){return new py(this.property,this.value,null,{},0)}}class fy{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return N(this._values[a].value.value)}setValue(a,d){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new Md(this._values[a].property)),this._values[a].value=new mu(this._values[a].property,d===null?void 0:N(d))}getTransition(a){return N(this._values[a].transition)}setTransition(a,d){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new Md(this._values[a].property)),this._values[a].transition=N(d)||void 0}serialize(){const a={};for(const d of Object.keys(this._values)){const p=this.getValue(d);p!==void 0&&(a[d]=p);const _=this.getTransition(d);_!==void 0&&(a[`${d}-transition`]=_)}return a}transitioned(a,d){const p=new my(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].transitioned(a,d._values[_]);return p}untransitioned(){const a=new my(this._properties);for(const d of Object.keys(this._values))a._values[d]=this._values[d].untransitioned();return a}}class py{constructor(a,d,p,_,b){this.property=a,this.value=d,this.begin=b+_.delay||0,this.end=this.begin+_.duration||0,a.specification.transition&&(_.delay||_.duration)&&(this.prior=p)}possiblyEvaluate(a,d,p){const _=a.now||0,b=this.value.possiblyEvaluate(a,d,p),E=this.prior;if(E){if(_>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(_<this.begin)return E.possiblyEvaluate(a,d,p);{const P=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(a,d,p),b,function(I){if(I<=0)return 0;if(I>=1)return 1;const M=I*I,B=M*I;return 4*(I<.5?B:3*(I-M)+B-.75)}(P))}}return b}}class my{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,d,p){const _=new gu(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(a,d,p);return _}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class Jb{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}getValue(a){return N(this._values[a].value)}setValue(a,d){this._values[a]=new mu(this._values[a].property,d===null?void 0:N(d))}serialize(){const a={};for(const d of Object.keys(this._values)){const p=this.getValue(d);p!==void 0&&(a[d]=p)}return a}possiblyEvaluate(a,d,p){const _=new gu(this._properties);for(const b of Object.keys(this._values))_._values[b]=this._values[b].possiblyEvaluate(a,d,p);return _}}class Po{constructor(a,d,p){this.property=a,this.value=d,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,d,p,_){return this.property.evaluate(this.value,this.parameters,a,d,p,_)}}class gu{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class Ft{constructor(a){this.specification=a}possiblyEvaluate(a,d){if(a.isDataDriven())throw new Error("Value should not be data driven");return a.expression.evaluate(d)}interpolate(a,d,p){const _=Nr[this.specification.type];return _?_(a,d,p):a}}class qt{constructor(a,d){this.specification=a,this.overrides=d}possiblyEvaluate(a,d,p,_){return new Po(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(d,null,{},p,_)}:a.expression,d)}interpolate(a,d,p){if(a.value.kind!=="constant"||d.value.kind!=="constant")return a;if(a.value.value===void 0||d.value.value===void 0)return new Po(this,{kind:"constant",value:void 0},a.parameters);const _=Nr[this.specification.type];return _?new Po(this,{kind:"constant",value:_(a.value.value,d.value.value,p)},a.parameters):a}evaluate(a,d,p,_,b,E){return a.kind==="constant"?a.value:a.evaluate(d,p,_,b,E)}}class ec extends qt{possiblyEvaluate(a,d,p,_){if(a.value===void 0)return new Po(this,{kind:"constant",value:void 0},d);if(a.expression.kind==="constant"){const b=a.expression.evaluate(d,null,{},p,_),E=a.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,P=this._calculate(E,E,E,d);return new Po(this,{kind:"constant",value:P},d)}if(a.expression.kind==="camera"){const b=this._calculate(a.expression.evaluate({zoom:d.zoom-1}),a.expression.evaluate({zoom:d.zoom}),a.expression.evaluate({zoom:d.zoom+1}),d);return new Po(this,{kind:"constant",value:b},d)}return new Po(this,a.expression,d)}evaluate(a,d,p,_,b,E){if(a.kind==="source"){const P=a.evaluate(d,p,_,b,E);return this._calculate(P,P,P,d)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(d.zoom)-1},p,_),a.evaluate({zoom:Math.floor(d.zoom)},p,_),a.evaluate({zoom:Math.floor(d.zoom)+1},p,_),d):a.value}_calculate(a,d,p,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:a,to:d}:{from:p,to:d}}interpolate(a){return a}}class ep{constructor(a){this.specification=a}possiblyEvaluate(a,d,p,_){if(a.value!==void 0){if(a.expression.kind==="constant"){const b=a.expression.evaluate(d,null,{},p,_);return this._calculate(b,b,b,d)}return this._calculate(a.expression.evaluate(new hr(Math.floor(d.zoom-1),d)),a.expression.evaluate(new hr(Math.floor(d.zoom),d)),a.expression.evaluate(new hr(Math.floor(d.zoom+1),d)),d)}}_calculate(a,d,p,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:a,to:d}:{from:p,to:d}}interpolate(a){return a}}class wa{constructor(a){this.specification=a}possiblyEvaluate(a,d,p,_){return!!a.expression.evaluate(d,null,{},p,_)}interpolate(){return!1}}class Ei{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const d in a){const p=a[d];p.specification.overridable&&this.overridableProperties.push(d);const _=this.defaultPropertyValues[d]=new mu(p,void 0),b=this.defaultTransitionablePropertyValues[d]=new Md(p);this.defaultTransitioningPropertyValues[d]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=_.possiblyEvaluate({})}}}Pt("DataDrivenProperty",qt),Pt("DataConstantProperty",Ft),Pt("CrossFadedDataDrivenProperty",ec),Pt("CrossFadedProperty",ep),Pt("ColorRampProperty",wa);const Ea="-transition";class Co extends Qi{constructor(a,d){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1},a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),d.layout&&(this._unevaluatedLayout=new Jb(d.layout)),d.paint)){this._transitionablePaint=new fy(d.paint);for(const p in a.paint)this.setPaintProperty(p,a.paint[p],{validate:!1});for(const p in a.layout)this.setLayoutProperty(p,a.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gu(d.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,d,p={}){d!=null&&this._validate(Xb,`layers.${this.id}.layout.${a}`,a,d,p)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,d):this.visibility=d)}getPaintProperty(a){return a.endsWith(Ea)?this._transitionablePaint.getTransition(a.slice(0,-Ea.length)):this._transitionablePaint.getValue(a)}setPaintProperty(a,d,p={}){if(d!=null&&this._validate(qb,`layers.${this.id}.paint.${a}`,a,d,p))return!1;if(a.endsWith(Ea))return this._transitionablePaint.setTransition(a.slice(0,-Ea.length),d||void 0),!1;{const _=this._transitionablePaint._values[a],b=_.property.specification["property-type"]==="cross-faded-data-driven",E=_.value.isDataDriven(),P=_.value;this._transitionablePaint.setValue(a,d),this._handleSpecialPaintPropertyUpdate(a);const I=this._transitionablePaint._values[a].value;return I.isDataDriven()||E||b||this._handleOverridablePaintPropertyUpdate(a,P,I)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,d,p){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,d){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,d)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),k(a,(d,p)=>!(d===void 0||p==="layout"&&!Object.keys(d).length||p==="paint"&&!Object.keys(d).length))}_validate(a,d,p,_,b={}){return(!b||b.validate!==!1)&&Rd(this,a.call(hu,{key:d,layerType:this.type,objectKey:p,value:_,styleSpec:je,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const d=this.paint.get(a);if(d instanceof Po&&or(d.property.specification)&&(d.value.kind==="source"||d.value.kind==="composite")&&d.value.isStateDependent)return!0}return!1}}const gy={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ta{constructor(a,d){this._structArray=a,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class kr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,d){return a._trim(),d&&(a.isTransferred=!0,d.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const d=Object.create(this.prototype);return d.arrayBuffer=a.arrayBuffer,d.length=a.length,d.capacity=a.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Xr(u,a=1){let d=0,p=0;return{members:u.map(_=>{const b=gy[_.type].BYTES_PER_ELEMENT,E=d=tp(d,Math.max(a,b)),P=_.components||1;return p=Math.max(p,b),d+=b*P,{name:_.name,type:_.type,components:P,offset:E}}),size:tp(d,Math.max(p,a)),alignment:a}}function tp(u,a){return Math.ceil(u/a)*a}class Ja extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d){const p=this.length;return this.resize(p+1),this.emplace(p,a,d)}emplace(a,d,p){const _=2*a;return this.int16[_+0]=d,this.int16[_+1]=p,a}}Ja.prototype.bytesPerElement=4,Pt("StructArrayLayout2i4",Ja);class y extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,a,d,p,_)}emplace(a,d,p,_,b){const E=4*a;return this.int16[E+0]=d,this.int16[E+1]=p,this.int16[E+2]=_,this.int16[E+3]=b,a}}y.prototype.bytesPerElement=8,Pt("StructArrayLayout4i8",y);class l extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,p,_,b,E){const P=this.length;return this.resize(P+1),this.emplace(P,a,d,p,_,b,E)}emplace(a,d,p,_,b,E,P){const I=6*a;return this.int16[I+0]=d,this.int16[I+1]=p,this.int16[I+2]=_,this.int16[I+3]=b,this.int16[I+4]=E,this.int16[I+5]=P,a}}l.prototype.bytesPerElement=12,Pt("StructArrayLayout2i4i12",l);class h extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,p,_,b,E){const P=this.length;return this.resize(P+1),this.emplace(P,a,d,p,_,b,E)}emplace(a,d,p,_,b,E,P){const I=4*a,M=8*a;return this.int16[I+0]=d,this.int16[I+1]=p,this.uint8[M+4]=_,this.uint8[M+5]=b,this.uint8[M+6]=E,this.uint8[M+7]=P,a}}h.prototype.bytesPerElement=8,Pt("StructArrayLayout2i4ub8",h);class g extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d){const p=this.length;return this.resize(p+1),this.emplace(p,a,d)}emplace(a,d,p){const _=2*a;return this.float32[_+0]=d,this.float32[_+1]=p,a}}g.prototype.bytesPerElement=8,Pt("StructArrayLayout2f8",g);class v extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d,p,_,b,E,P,I,M,B){const G=this.length;return this.resize(G+1),this.emplace(G,a,d,p,_,b,E,P,I,M,B)}emplace(a,d,p,_,b,E,P,I,M,B,G){const q=10*a;return this.uint16[q+0]=d,this.uint16[q+1]=p,this.uint16[q+2]=_,this.uint16[q+3]=b,this.uint16[q+4]=E,this.uint16[q+5]=P,this.uint16[q+6]=I,this.uint16[q+7]=M,this.uint16[q+8]=B,this.uint16[q+9]=G,a}}v.prototype.bytesPerElement=20,Pt("StructArrayLayout10ui20",v);class w extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d,p,_,b,E,P,I,M,B,G,q){const Y=this.length;return this.resize(Y+1),this.emplace(Y,a,d,p,_,b,E,P,I,M,B,G,q)}emplace(a,d,p,_,b,E,P,I,M,B,G,q,Y){const J=12*a;return this.int16[J+0]=d,this.int16[J+1]=p,this.int16[J+2]=_,this.int16[J+3]=b,this.uint16[J+4]=E,this.uint16[J+5]=P,this.uint16[J+6]=I,this.uint16[J+7]=M,this.int16[J+8]=B,this.int16[J+9]=G,this.int16[J+10]=q,this.int16[J+11]=Y,a}}w.prototype.bytesPerElement=24,Pt("StructArrayLayout4i4ui4i24",w);class A extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,d,p)}emplace(a,d,p,_){const b=3*a;return this.float32[b+0]=d,this.float32[b+1]=p,this.float32[b+2]=_,a}}A.prototype.bytesPerElement=12,Pt("StructArrayLayout3f12",A);class L extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const d=this.length;return this.resize(d+1),this.emplace(d,a)}emplace(a,d){return this.uint32[1*a+0]=d,a}}L.prototype.bytesPerElement=4,Pt("StructArrayLayout1ul4",L);class $ extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d,p,_,b,E,P,I,M){const B=this.length;return this.resize(B+1),this.emplace(B,a,d,p,_,b,E,P,I,M)}emplace(a,d,p,_,b,E,P,I,M,B){const G=10*a,q=5*a;return this.int16[G+0]=d,this.int16[G+1]=p,this.int16[G+2]=_,this.int16[G+3]=b,this.int16[G+4]=E,this.int16[G+5]=P,this.uint32[q+3]=I,this.uint16[G+8]=M,this.uint16[G+9]=B,a}}$.prototype.bytesPerElement=20,Pt("StructArrayLayout6i1ul2ui20",$);class O extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,p,_,b,E){const P=this.length;return this.resize(P+1),this.emplace(P,a,d,p,_,b,E)}emplace(a,d,p,_,b,E,P){const I=6*a;return this.int16[I+0]=d,this.int16[I+1]=p,this.int16[I+2]=_,this.int16[I+3]=b,this.int16[I+4]=E,this.int16[I+5]=P,a}}O.prototype.bytesPerElement=12,Pt("StructArrayLayout2i2i2i12",O);class V extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,p,_,b){const E=this.length;return this.resize(E+1),this.emplace(E,a,d,p,_,b)}emplace(a,d,p,_,b,E){const P=4*a,I=8*a;return this.float32[P+0]=d,this.float32[P+1]=p,this.float32[P+2]=_,this.int16[I+6]=b,this.int16[I+7]=E,a}}V.prototype.bytesPerElement=16,Pt("StructArrayLayout2f1f2i16",V);class W extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,a,d,p,_)}emplace(a,d,p,_,b){const E=12*a,P=3*a;return this.uint8[E+0]=d,this.uint8[E+1]=p,this.float32[P+1]=_,this.float32[P+2]=b,a}}W.prototype.bytesPerElement=12,Pt("StructArrayLayout2ub2f12",W);class X extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,d,p)}emplace(a,d,p,_){const b=3*a;return this.uint16[b+0]=d,this.uint16[b+1]=p,this.uint16[b+2]=_,a}}X.prototype.bytesPerElement=6,Pt("StructArrayLayout3ui6",X);class ae extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d,p,_,b,E,P,I,M,B,G,q,Y,J,fe,de,Ie){const ze=this.length;return this.resize(ze+1),this.emplace(ze,a,d,p,_,b,E,P,I,M,B,G,q,Y,J,fe,de,Ie)}emplace(a,d,p,_,b,E,P,I,M,B,G,q,Y,J,fe,de,Ie,ze){const Se=24*a,De=12*a,Xe=48*a;return this.int16[Se+0]=d,this.int16[Se+1]=p,this.uint16[Se+2]=_,this.uint16[Se+3]=b,this.uint32[De+2]=E,this.uint32[De+3]=P,this.uint32[De+4]=I,this.uint16[Se+10]=M,this.uint16[Se+11]=B,this.uint16[Se+12]=G,this.float32[De+7]=q,this.float32[De+8]=Y,this.uint8[Xe+36]=J,this.uint8[Xe+37]=fe,this.uint8[Xe+38]=de,this.uint32[De+10]=Ie,this.int16[Se+22]=ze,a}}ae.prototype.bytesPerElement=48,Pt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ae);class se extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d,p,_,b,E,P,I,M,B,G,q,Y,J,fe,de,Ie,ze,Se,De,Xe,qe,St,$t,bt,pt,ut,xt){const yt=this.length;return this.resize(yt+1),this.emplace(yt,a,d,p,_,b,E,P,I,M,B,G,q,Y,J,fe,de,Ie,ze,Se,De,Xe,qe,St,$t,bt,pt,ut,xt)}emplace(a,d,p,_,b,E,P,I,M,B,G,q,Y,J,fe,de,Ie,ze,Se,De,Xe,qe,St,$t,bt,pt,ut,xt,yt){const rt=34*a,jt=17*a;return this.int16[rt+0]=d,this.int16[rt+1]=p,this.int16[rt+2]=_,this.int16[rt+3]=b,this.int16[rt+4]=E,this.int16[rt+5]=P,this.int16[rt+6]=I,this.int16[rt+7]=M,this.uint16[rt+8]=B,this.uint16[rt+9]=G,this.uint16[rt+10]=q,this.uint16[rt+11]=Y,this.uint16[rt+12]=J,this.uint16[rt+13]=fe,this.uint16[rt+14]=de,this.uint16[rt+15]=Ie,this.uint16[rt+16]=ze,this.uint16[rt+17]=Se,this.uint16[rt+18]=De,this.uint16[rt+19]=Xe,this.uint16[rt+20]=qe,this.uint16[rt+21]=St,this.uint16[rt+22]=$t,this.uint32[jt+12]=bt,this.float32[jt+13]=pt,this.float32[jt+14]=ut,this.float32[jt+15]=xt,this.float32[jt+16]=yt,a}}se.prototype.bytesPerElement=68,Pt("StructArrayLayout8i15ui1ul4f68",se);class oe extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const d=this.length;return this.resize(d+1),this.emplace(d,a)}emplace(a,d){return this.float32[1*a+0]=d,a}}oe.prototype.bytesPerElement=4,Pt("StructArrayLayout1f4",oe);class _e extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,d,p)}emplace(a,d,p,_){const b=3*a;return this.int16[b+0]=d,this.int16[b+1]=p,this.int16[b+2]=_,a}}_e.prototype.bytesPerElement=6,Pt("StructArrayLayout3i6",_e);class Te extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d,p){const _=this.length;return this.resize(_+1),this.emplace(_,a,d,p)}emplace(a,d,p,_){const b=4*a;return this.uint32[2*a+0]=d,this.uint16[b+2]=p,this.uint16[b+3]=_,a}}Te.prototype.bytesPerElement=8,Pt("StructArrayLayout1ul2ui8",Te);class Le extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d){const p=this.length;return this.resize(p+1),this.emplace(p,a,d)}emplace(a,d,p){const _=2*a;return this.uint16[_+0]=d,this.uint16[_+1]=p,a}}Le.prototype.bytesPerElement=4,Pt("StructArrayLayout2ui4",Le);class ue extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const d=this.length;return this.resize(d+1),this.emplace(d,a)}emplace(a,d){return this.uint16[1*a+0]=d,a}}ue.prototype.bytesPerElement=2,Pt("StructArrayLayout1ui2",ue);class Fe extends kr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d,p,_){const b=this.length;return this.resize(b+1),this.emplace(b,a,d,p,_)}emplace(a,d,p,_,b){const E=4*a;return this.float32[E+0]=d,this.float32[E+1]=p,this.float32[E+2]=_,this.float32[E+3]=b,a}}Fe.prototype.bytesPerElement=16,Pt("StructArrayLayout4f16",Fe);class ke extends Ta{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new mt(this.anchorPointX,this.anchorPointY)}}ke.prototype.size=20;class He extends ${get(a){return new ke(this,a)}}Pt("CollisionBoxArray",He);class We extends Ta{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}We.prototype.size=48;class et extends ae{get(a){return new We(this,a)}}Pt("PlacedSymbolArray",et);class Ge extends Ta{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Ge.prototype.size=68;class wt extends se{get(a){return new Ge(this,a)}}Pt("SymbolInstanceArray",wt);class ft extends oe{getoffsetX(a){return this.float32[1*a+0]}}Pt("GlyphOffsetArray",ft);class Tt extends _e{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}Pt("SymbolLineVertexArray",Tt);class tn extends Ta{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}tn.prototype.size=8;class dn extends Te{get(a){return new tn(this,a)}}Pt("FeatureIndexArray",dn);class Gt extends Ja{}class Un extends Ja{}class Vn extends Ja{}class Cn extends l{}class In extends h{}class Wn extends g{}class hi extends v{}class Io extends w{}class eo extends A{}class Lo extends L{}class Sa extends O{}class Os extends W{}class ns extends X{}class Xo extends Le{}const kd=Xr([{name:"a_pos",components:2,type:"Int16"}],4),{members:si}=kd;class yn{constructor(a=[]){this.segments=a}prepareSegment(a,d,p,_){let b=this.segments[this.segments.length-1];return a>yn.MAX_VERTEX_ARRAY_LENGTH&&ie(`Max vertices per segment is ${yn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!b||b.vertexLength+a>yn.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==_)&&(b={vertexOffset:d.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},_!==void 0&&(b.sortKey=_),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const a of this.segments)for(const d in a.vaos)a.vaos[d].destroy()}static simpleSegment(a,d,p,_){return new yn([{vertexOffset:a,primitiveOffset:d,vertexLength:p,primitiveLength:_,vaos:{},sortKey:0}])}}function Bn(u,a){return 256*(u=T(Math.floor(u),0,255))+T(Math.floor(a),0,255)}yn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Pt("SegmentVector",yn);const fi=Xr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var pi={exports:{}},fr={exports:{}};fr.exports=function(u,a){var d,p,_,b,E,P,I,M;for(p=u.length-(d=3&u.length),_=a,E=3432918353,P=461845907,M=0;M<p;)I=255&u.charCodeAt(M)|(255&u.charCodeAt(++M))<<8|(255&u.charCodeAt(++M))<<16|(255&u.charCodeAt(++M))<<24,++M,_=27492+(65535&(b=5*(65535&(_=(_^=I=(65535&(I=(I=(65535&I)*E+(((I>>>16)*E&65535)<<16)&4294967295)<<15|I>>>17))*P+(((I>>>16)*P&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(I=0,d){case 3:I^=(255&u.charCodeAt(M+2))<<16;case 2:I^=(255&u.charCodeAt(M+1))<<8;case 1:_^=I=(65535&(I=(I=(65535&(I^=255&u.charCodeAt(M)))*E+(((I>>>16)*E&65535)<<16)&4294967295)<<15|I>>>17))*P+(((I>>>16)*P&65535)<<16)&4294967295}return _^=u.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0};var Ds={exports:{}};Ds.exports=function(u,a){for(var d,p=u.length,_=a^p,b=0;p>=4;)d=1540483477*(65535&(d=255&u.charCodeAt(b)|(255&u.charCodeAt(++b))<<8|(255&u.charCodeAt(++b))<<16|(255&u.charCodeAt(++b))<<24))+((1540483477*(d>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),p-=4,++b;switch(p){case 3:_^=(255&u.charCodeAt(b+2))<<16;case 2:_^=(255&u.charCodeAt(b+1))<<8;case 1:_=1540483477*(65535&(_^=255&u.charCodeAt(b)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0};var Qa=fr.exports,np=Ds.exports;pi.exports=Qa,pi.exports.murmur3=Qa,pi.exports.murmur2=np;class tc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,d,p,_){this.ids.push(yy(a)),this.positions.push(d,p,_)}getPositions(a){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const d=yy(a);let p=0,_=this.ids.length-1;for(;p<_;){const E=p+_>>1;this.ids[E]>=d?_=E:p=E+1}const b=[];for(;this.ids[p]===d;)b.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return b}static serialize(a,d){const p=new Float64Array(a.ids),_=new Uint32Array(a.positions);return rp(p,_,0,p.length-1),d&&d.push(p.buffer,_.buffer),{ids:p,positions:_}}static deserialize(a){const d=new tc;return d.ids=a.ids,d.positions=a.positions,d.indexed=!0,d}}function yy(u){const a=+u;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:pi.exports(String(u))}function rp(u,a,d,p){for(;d<p;){const _=u[d+p>>1];let b=d-1,E=p+1;for(;;){do b++;while(u[b]<_);do E--;while(u[E]>_);if(b>=E)break;Aa(u,b,E),Aa(a,3*b,3*E),Aa(a,3*b+1,3*E+1),Aa(a,3*b+2,3*E+2)}E-d<p-E?(rp(u,a,d,E),d=E+1):(rp(u,a,E+1,p),p=E)}}function Aa(u,a,d){const p=u[a];u[a]=u[d],u[d]=p}Pt("FeaturePositionMap",tc);class el{constructor(a,d){this.gl=a.gl,this.location=d}}class tl extends el{constructor(a,d){super(a,d),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class Od extends el{constructor(a,d){super(a,d),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class c$ extends el{constructor(a,d){super(a,d),this.current=te.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}const Pj=new Float32Array(16);function Qb(u){return[Bn(255*u.r,255*u.g),Bn(255*u.b,255*u.a)]}class ip{constructor(a,d,p){this.value=a,this.uniformNames=d.map(_=>`u_${_}`),this.type=p}setUniform(a,d,p){a.set(p.constantOr(this.value))}getBinding(a,d,p){return this.type==="color"?new c$(a,d):new tl(a,d)}}class Dd{constructor(a,d){this.uniformNames=d.map(p=>`u_${p}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=a.tlbr}setUniform(a,d,p,_){const b=_==="u_pattern_to"?this.patternTo:_==="u_pattern_from"?this.patternFrom:_==="u_pixel_ratio_to"?this.pixelRatioTo:_==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&a.set(b)}getBinding(a,d,p){return p.substr(0,9)==="u_pattern"?new Od(a,d):new tl(a,d)}}class nl{constructor(a,d,p,_){this.expression=a,this.type=p,this.maxValue=0,this.paintVertexAttributes=d.map(b=>({name:`a_${b}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(a,d,p,_,b){const E=this.paintVertexArray.length,P=this.expression.evaluate(new hr(0),d,{},_,[],b);this.paintVertexArray.resize(a),this._setPaintValue(E,a,P)}updatePaintArray(a,d,p,_){const b=this.expression.evaluate({zoom:0},p,_);this._setPaintValue(a,d,b)}_setPaintValue(a,d,p){if(this.type==="color"){const _=Qb(p);for(let b=a;b<d;b++)this.paintVertexArray.emplace(b,_[0],_[1])}else{for(let _=a;_<d;_++)this.paintVertexArray.emplace(_,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zo{constructor(a,d,p,_,b,E){this.expression=a,this.uniformNames=d.map(P=>`u_${P}_t`),this.type=p,this.useIntegerZoom=_,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=d.map(P=>({name:`a_${P}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(a,d,p,_,b){const E=this.expression.evaluate(new hr(this.zoom),d,{},_,[],b),P=this.expression.evaluate(new hr(this.zoom+1),d,{},_,[],b),I=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(I,a,E,P)}updatePaintArray(a,d,p,_){const b=this.expression.evaluate({zoom:this.zoom},p,_),E=this.expression.evaluate({zoom:this.zoom+1},p,_);this._setPaintValue(a,d,b,E)}_setPaintValue(a,d,p,_){if(this.type==="color"){const b=Qb(p),E=Qb(_);for(let P=a;P<d;P++)this.paintVertexArray.emplace(P,b[0],b[1],E[0],E[1])}else{for(let b=a;b<d;b++)this.paintVertexArray.emplace(b,p,_);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(_))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,d){const p=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,_=T(this.expression.interpolationFactor(p,this.zoom,this.zoom+1),0,1);a.set(_)}getBinding(a,d,p){return new tl(a,d)}}class nc{constructor(a,d,p,_,b,E){this.expression=a,this.type=d,this.useIntegerZoom=p,this.zoom=_,this.layerId=E,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(a,d,p){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(_,a,d.patterns&&d.patterns[this.layerId],p)}updatePaintArray(a,d,p,_,b){this._setPaintValues(a,d,p.patterns&&p.patterns[this.layerId],b)}_setPaintValues(a,d,p,_){if(!_||!p)return;const{min:b,mid:E,max:P}=p,I=_[b],M=_[E],B=_[P];if(I&&M&&B)for(let G=a;G<d;G++)this.zoomInPaintVertexArray.emplace(G,M.tl[0],M.tl[1],M.br[0],M.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],M.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(G,M.tl[0],M.tl[1],M.br[0],M.br[1],B.tl[0],B.tl[1],B.br[0],B.br[1],M.pixelRatio,B.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,fi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,fi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class u${constructor(a,d,p){this.binders={},this._buffers=[];const _=[];for(const b in a.paint._values){if(!p(b))continue;const E=a.paint.get(b);if(!(E instanceof Po&&or(E.property.specification)))continue;const P=Cj(b,a.type),I=E.value,M=E.property.specification.type,B=E.property.useIntegerZoom,G=E.property.specification["property-type"],q=G==="cross-faded"||G==="cross-faded-data-driven";if(I.kind==="constant")this.binders[b]=q?new Dd(I.value,P):new ip(I.value,P,M),_.push(`/u_${b}`);else if(I.kind==="source"||q){const Y=d$(b,M,"source");this.binders[b]=q?new nc(I,M,B,d,Y,a.id):new nl(I,P,M,Y),_.push(`/a_${b}`)}else{const Y=d$(b,M,"composite");this.binders[b]=new Zo(I,P,M,B,d,Y),_.push(`/z_${b}`)}}this.cacheKey=_.sort().join("")}getMaxValue(a){const d=this.binders[a];return d instanceof nl||d instanceof Zo?d.maxValue:0}populatePaintArrays(a,d,p,_,b){for(const E in this.binders){const P=this.binders[E];(P instanceof nl||P instanceof Zo||P instanceof nc)&&P.populatePaintArray(a,d,p,_,b)}}setConstantPatternPositions(a,d){for(const p in this.binders){const _=this.binders[p];_ instanceof Dd&&_.setConstantPatternPositions(a,d)}}updatePaintArrays(a,d,p,_,b){let E=!1;for(const P in a){const I=d.getPositions(P);for(const M of I){const B=p.feature(M.index);for(const G in this.binders){const q=this.binders[G];if((q instanceof nl||q instanceof Zo||q instanceof nc)&&q.expression.isStateDependent===!0){const Y=_.paint.get(G);q.expression=Y.value,q.updatePaintArray(M.start,M.end,B,a[P],b),E=!0}}}}return E}defines(){const a=[];for(const d in this.binders){const p=this.binders[d];(p instanceof ip||p instanceof Dd)&&a.push(...p.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return a}getBinderAttributes(){const a=[];for(const d in this.binders){const p=this.binders[d];if(p instanceof nl||p instanceof Zo)for(let _=0;_<p.paintVertexAttributes.length;_++)a.push(p.paintVertexAttributes[_].name);else if(p instanceof nc)for(let _=0;_<fi.members.length;_++)a.push(fi.members[_].name)}return a}getBinderUniforms(){const a=[];for(const d in this.binders){const p=this.binders[d];if(p instanceof ip||p instanceof Dd||p instanceof Zo)for(const _ of p.uniformNames)a.push(_)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,d){const p=[];for(const _ in this.binders){const b=this.binders[_];if(b instanceof ip||b instanceof Dd||b instanceof Zo){for(const E of b.uniformNames)if(d[E]){const P=b.getBinding(a,d[E],E);p.push({name:E,property:_,binding:P})}}}return p}setUniforms(a,d,p,_){for(const{name:b,property:E,binding:P}of d)this.binders[E].setUniform(P,_,p.get(E),b)}updatePaintBuffers(a){this._buffers=[];for(const d in this.binders){const p=this.binders[d];if(a&&p instanceof nc){const _=a.fromScale===2?p.zoomInPaintVertexBuffer:p.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(p instanceof nl||p instanceof Zo)&&p.paintVertexBuffer&&this._buffers.push(p.paintVertexBuffer)}}upload(a){for(const d in this.binders){const p=this.binders[d];(p instanceof nl||p instanceof Zo||p instanceof nc)&&p.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const d=this.binders[a];(d instanceof nl||d instanceof Zo||d instanceof nc)&&d.destroy()}}}class yu{constructor(a,d,p=()=>!0){this.programConfigurations={};for(const _ of a)this.programConfigurations[_.id]=new u$(_,d,p);this.needsUpload=!1,this._featureMap=new tc,this._bufferOffset=0}populatePaintArrays(a,d,p,_,b,E){for(const P in this.programConfigurations)this.programConfigurations[P].populatePaintArrays(a,d,_,b,E);d.id!==void 0&&this._featureMap.add(d.id,p,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,d,p,_){for(const b of p)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(a,this._featureMap,d,b,_)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const d in this.programConfigurations)this.programConfigurations[d].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}function Cj(u,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${a}-`,"").replace(/-/g,"_")]}function d$(u,a,d){const p={color:{source:g,composite:Fe},number:{source:oe,composite:g}},_=function(b){return{"line-pattern":{source:hi,composite:hi},"fill-pattern":{source:hi,composite:hi},"fill-extrusion-pattern":{source:hi,composite:hi}}[b]}(u);return _&&_[d]||p[a][d]}Pt("ConstantBinder",ip),Pt("CrossFadedConstantBinder",Dd),Pt("SourceExpressionBinder",nl),Pt("CrossFadedCompositeBinder",nc),Pt("CompositeExpressionBinder",Zo),Pt("ProgramConfiguration",u$,{omit:["_buffers"]}),Pt("ProgramConfigurationSet",yu);var oi=8192;const e1=Math.pow(2,14)-1,h$=-e1-1;function _u(u){const a=oi/u.extent,d=u.loadGeometry();for(let p=0;p<d.length;p++){const _=d[p];for(let b=0;b<_.length;b++){const E=_[b],P=Math.round(E.x*a),I=Math.round(E.y*a);E.x=T(P,h$,e1),E.y=T(I,h$,e1),(P<E.x||P>E.x+1||I<E.y||I>E.y+1)&&ie("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return d}function vu(u,a){return{type:u.type,id:u.id,properties:u.properties,geometry:a?_u(u):[]}}function _y(u,a,d,p,_){u.emplaceBack(2*a+(p+1)/2,2*d+(_+1)/2)}class t1{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(d=>d.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Un,this.indexArray=new ns,this.segments=new yn,this.programConfigurations=new yu(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(a,d,p){const _=this.layers[0],b=[];let E=null,P=!1;_.type==="circle"&&(E=_.layout.get("circle-sort-key"),P=!E.isConstant());for(const{feature:I,id:M,index:B,sourceLayerIndex:G}of a){const q=this.layers[0]._featureFilter.needGeometry,Y=vu(I,q);if(!this.layers[0]._featureFilter.filter(new hr(this.zoom),Y,p))continue;const J=P?E.evaluate(Y,{},p):void 0,fe={id:M,properties:I.properties,type:I.type,sourceLayerIndex:G,index:B,geometry:q?Y.geometry:_u(I),patterns:{},sortKey:J};b.push(fe)}P&&b.sort((I,M)=>I.sortKey-M.sortKey);for(const I of b){const{geometry:M,index:B,sourceLayerIndex:G}=I,q=a[B].feature;this.addFeature(I,M,B,p),d.featureIndex.insert(q,M,B,G,this.index)}}update(a,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,d,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,si),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,d,p,_){for(const b of d)for(const E of b){const P=E.x,I=E.y;if(P<0||P>=oi||I<0||I>=oi)continue;const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),B=M.vertexLength;_y(this.layoutVertexArray,P,I,-1,-1),_y(this.layoutVertexArray,P,I,1,-1),_y(this.layoutVertexArray,P,I,1,1),_y(this.layoutVertexArray,P,I,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+3,B+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,{},_)}}function f$(u,a){for(let d=0;d<u.length;d++)if(Fd(a,u[d]))return!0;for(let d=0;d<a.length;d++)if(Fd(u,a[d]))return!0;return!!n1(u,a)}function Ij(u,a,d){return!!Fd(u,a)||!!r1(a,u,d)}function p$(u,a){if(u.length===1)return g$(a,u[0]);for(let d=0;d<a.length;d++){const p=a[d];for(let _=0;_<p.length;_++)if(Fd(u,p[_]))return!0}for(let d=0;d<u.length;d++)if(g$(a,u[d]))return!0;for(let d=0;d<a.length;d++)if(n1(u,a[d]))return!0;return!1}function Lj(u,a,d){if(u.length>1){if(n1(u,a))return!0;for(let p=0;p<a.length;p++)if(r1(a[p],u,d))return!0}for(let p=0;p<u.length;p++)if(r1(u[p],a,d))return!0;return!1}function n1(u,a){if(u.length===0||a.length===0)return!1;for(let d=0;d<u.length-1;d++){const p=u[d],_=u[d+1];for(let b=0;b<a.length-1;b++)if(Rj(p,_,a[b],a[b+1]))return!0}return!1}function Rj(u,a,d,p){return he(u,d,p)!==he(a,d,p)&&he(u,a,d)!==he(u,a,p)}function r1(u,a,d){const p=d*d;if(a.length===1)return u.distSqr(a[0])<p;for(let _=1;_<a.length;_++)if(m$(u,a[_-1],a[_])<p)return!0;return!1}function m$(u,a,d){const p=a.distSqr(d);if(p===0)return u.distSqr(a);const _=((u.x-a.x)*(d.x-a.x)+(u.y-a.y)*(d.y-a.y))/p;return u.distSqr(_<0?a:_>1?d:d.sub(a)._mult(_)._add(a))}function g$(u,a){let d,p,_,b=!1;for(let E=0;E<u.length;E++){d=u[E];for(let P=0,I=d.length-1;P<d.length;I=P++)p=d[P],_=d[I],p.y>a.y!=_.y>a.y&&a.x<(_.x-p.x)*(a.y-p.y)/(_.y-p.y)+p.x&&(b=!b)}return b}function Fd(u,a){let d=!1;for(let p=0,_=u.length-1;p<u.length;_=p++){const b=u[p],E=u[_];b.y>a.y!=E.y>a.y&&a.x<(E.x-b.x)*(a.y-b.y)/(E.y-b.y)+b.x&&(d=!d)}return d}function $j(u,a,d){const p=d[0],_=d[2];if(u.x<p.x&&a.x<p.x||u.x>_.x&&a.x>_.x||u.y<p.y&&a.y<p.y||u.y>_.y&&a.y>_.y)return!1;const b=he(u,a,d[0]);return b!==he(u,a,d[1])||b!==he(u,a,d[2])||b!==he(u,a,d[3])}function sp(u,a,d){const p=a.paint.get(u).value;return p.kind==="constant"?p.value:d.programConfigurations.get(a.id).getMaxValue(u)}function vy(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function by(u,a,d,p,_){if(!a[0]&&!a[1])return u;const b=mt.convert(a)._mult(_);d==="viewport"&&b._rotate(-p);const E=[];for(let P=0;P<u.length;P++)E.push(u[P].sub(b));return E}Pt("CircleBucket",t1,{omit:["layers"]});const Mj=new Ei({"circle-sort-key":new qt(je.layout_circle["circle-sort-key"])});var kj={paint:new Ei({"circle-radius":new qt(je.paint_circle["circle-radius"]),"circle-color":new qt(je.paint_circle["circle-color"]),"circle-blur":new qt(je.paint_circle["circle-blur"]),"circle-opacity":new qt(je.paint_circle["circle-opacity"]),"circle-translate":new Ft(je.paint_circle["circle-translate"]),"circle-translate-anchor":new Ft(je.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ft(je.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ft(je.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new qt(je.paint_circle["circle-stroke-width"]),"circle-stroke-color":new qt(je.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new qt(je.paint_circle["circle-stroke-opacity"])}),layout:Mj},rs=1e-6,is=typeof Float32Array<"u"?Float32Array:Array;function y$(){var u=new is(9);return is!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function i1(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function _$(u,a,d){var p=a[0],_=a[1],b=a[2],E=a[3],P=a[4],I=a[5],M=a[6],B=a[7],G=a[8],q=a[9],Y=a[10],J=a[11],fe=a[12],de=a[13],Ie=a[14],ze=a[15],Se=d[0],De=d[1],Xe=d[2],qe=d[3];return u[0]=Se*p+De*P+Xe*G+qe*fe,u[1]=Se*_+De*I+Xe*q+qe*de,u[2]=Se*b+De*M+Xe*Y+qe*Ie,u[3]=Se*E+De*B+Xe*J+qe*ze,u[4]=(Se=d[4])*p+(De=d[5])*P+(Xe=d[6])*G+(qe=d[7])*fe,u[5]=Se*_+De*I+Xe*q+qe*de,u[6]=Se*b+De*M+Xe*Y+qe*Ie,u[7]=Se*E+De*B+Xe*J+qe*ze,u[8]=(Se=d[8])*p+(De=d[9])*P+(Xe=d[10])*G+(qe=d[11])*fe,u[9]=Se*_+De*I+Xe*q+qe*de,u[10]=Se*b+De*M+Xe*Y+qe*Ie,u[11]=Se*E+De*B+Xe*J+qe*ze,u[12]=(Se=d[12])*p+(De=d[13])*P+(Xe=d[14])*G+(qe=d[15])*fe,u[13]=Se*_+De*I+Xe*q+qe*de,u[14]=Se*b+De*M+Xe*Y+qe*Ie,u[15]=Se*E+De*B+Xe*J+qe*ze,u}Math.hypot||(Math.hypot=function(){for(var u=0,a=arguments.length;a--;)u+=arguments[a]*arguments[a];return Math.sqrt(u)});var op,Oj=_$;function v$(){var u=new is(3);return is!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function b$(u,a,d){var p=new is(3);return p[0]=u,p[1]=a,p[2]=d,p}function xy(u,a,d){var p=a[0],_=a[1],b=a[2],E=a[3];return u[0]=d[0]*p+d[4]*_+d[8]*b+d[12]*E,u[1]=d[1]*p+d[5]*_+d[9]*b+d[13]*E,u[2]=d[2]*p+d[6]*_+d[10]*b+d[14]*E,u[3]=d[3]*p+d[7]*_+d[11]*b+d[15]*E,u}function x$(){var u=new is(4);return is!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function w$(u,a){const d=xy([],[u.x,u.y,0,1],a);return new mt(d[0]/d[3],d[1]/d[3])}v$(),op=new is(4),is!=Float32Array&&(op[0]=0,op[1]=0,op[2]=0,op[3]=0),v$(),b$(1,0,0),b$(0,1,0),x$(),x$(),y$(),function(){var u;u=new is(2),is!=Float32Array&&(u[0]=0,u[1]=0)}();class E$ extends t1{}Pt("HeatmapBucket",E$,{omit:["layers"]});var Dj={paint:new Ei({"heatmap-radius":new qt(je.paint_heatmap["heatmap-radius"]),"heatmap-weight":new qt(je.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ft(je.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wa(je.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ft(je.paint_heatmap["heatmap-opacity"])})};function s1(u,{width:a,height:d},p,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==a*d*p)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${a*d*p}`)}else _=new Uint8Array(a*d*p);return u.width=a,u.height=d,u.data=_,u}function T$(u,{width:a,height:d},p){if(a===u.width&&d===u.height)return;const _=s1({},{width:a,height:d},p);o1(u,_,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,a),height:Math.min(u.height,d)},p),u.width=a,u.height=d,u.data=_.data}function o1(u,a,d,p,_,b){if(_.width===0||_.height===0)return a;if(_.width>u.width||_.height>u.height||d.x>u.width-_.width||d.y>u.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>a.width||_.height>a.height||p.x>a.width-_.width||p.y>a.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const E=u.data,P=a.data;if(E===P)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<_.height;I++){const M=((d.y+I)*u.width+d.x)*b,B=((p.y+I)*a.width+p.x)*b;for(let G=0;G<_.width*b;G++)P[B+G]=E[M+G]}return a}class ap{constructor(a,d){s1(this,a,1,d)}resize(a){T$(this,a,1)}clone(){return new ap({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,d,p,_,b){o1(a,d,p,_,b,1)}}class to{constructor(a,d){s1(this,a,4,d)}resize(a){T$(this,a,4)}replace(a,d){d?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new to({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,d,p,_,b){o1(a,d,p,_,b,4)}}function S$(u){const a={},d=u.resolution||256,p=u.clips?u.clips.length:1,_=u.image||new to({width:d,height:p});if(Math.log(d)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${d}`);const b=(E,P,I)=>{a[u.evaluationKey]=I;const M=u.expression.evaluate(a);_.data[E+P+0]=Math.floor(255*M.r/M.a),_.data[E+P+1]=Math.floor(255*M.g/M.a),_.data[E+P+2]=Math.floor(255*M.b/M.a),_.data[E+P+3]=Math.floor(255*M.a)};if(u.clips)for(let E=0,P=0;E<p;++E,P+=4*d)for(let I=0,M=0;I<d;I++,M+=4){const B=I/(d-1),{start:G,end:q}=u.clips[E];b(P,M,G*(1-B)+q*B)}else for(let E=0,P=0;E<d;E++,P+=4)b(0,P,E/(d-1));return _}Pt("AlphaImage",ap),Pt("RGBAImage",to);var Fj={paint:new Ei({"hillshade-illumination-direction":new Ft(je.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ft(je.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ft(je.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ft(je.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ft(je.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ft(je.paint_hillshade["hillshade-accent-color"])})};const zj=Xr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Nj}=zj;var wy={exports:{}};function Ey(u,a,d){d=d||2;var p,_,b,E,P,I,M,B=a&&a.length,G=B?a[0]*d:u.length,q=A$(u,0,G,d,!0),Y=[];if(!q||q.next===q.prev)return Y;if(B&&(q=function(fe,de,Ie,ze){var Se,De,Xe,qe=[];for(Se=0,De=de.length;Se<De;Se++)(Xe=A$(fe,de[Se]*ze,Se<De-1?de[Se+1]*ze:fe.length,ze,!1))===Xe.next&&(Xe.steiner=!0),qe.push(Kj(Xe));for(qe.sort(jj),Se=0;Se<qe.length;Se++)Ie=Hj(qe[Se],Ie);return Ie}(u,a,q,d)),u.length>80*d){p=b=u[0],_=E=u[1];for(var J=d;J<G;J+=d)(P=u[J])<p&&(p=P),(I=u[J+1])<_&&(_=I),P>b&&(b=P),I>E&&(E=I);M=(M=Math.max(b-p,E-_))!==0?32767/M:0}return lp(q,Y,d,p,_,M,0),Y}function A$(u,a,d,p,_){var b,E;if(_===c1(u,a,d,p)>0)for(b=a;b<d;b+=p)E=I$(b,u[b],u[b+1],E);else for(b=d-p;b>=a;b-=p)E=I$(b,u[b],u[b+1],E);return E&&Ty(E,E.next)&&(up(E),E=E.next),E}function bu(u,a){if(!u)return u;a||(a=u);var d,p=u;do if(d=!1,p.steiner||!Ty(p,p.next)&&Br(p.prev,p,p.next)!==0)p=p.next;else{if(up(p),(p=a=p.prev)===p.next)break;d=!0}while(d||p!==a);return a}function lp(u,a,d,p,_,b,E){if(u){!E&&b&&function(B,G,q,Y){var J=B;do J.z===0&&(J.z=a1(J.x,J.y,G,q,Y)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==B);J.prevZ.nextZ=null,J.prevZ=null,function(fe){var de,Ie,ze,Se,De,Xe,qe,St,$t=1;do{for(Ie=fe,fe=null,De=null,Xe=0;Ie;){for(Xe++,ze=Ie,qe=0,de=0;de<$t&&(qe++,ze=ze.nextZ);de++);for(St=$t;qe>0||St>0&&ze;)qe!==0&&(St===0||!ze||Ie.z<=ze.z)?(Se=Ie,Ie=Ie.nextZ,qe--):(Se=ze,ze=ze.nextZ,St--),De?De.nextZ=Se:fe=Se,Se.prevZ=De,De=Se;Ie=ze}De.nextZ=null,$t*=2}while(Xe>1)}(J)}(u,p,_,b);for(var P,I,M=u;u.prev!==u.next;)if(P=u.prev,I=u.next,b?Uj(u,p,_,b):Bj(u))a.push(P.i/d|0),a.push(u.i/d|0),a.push(I.i/d|0),up(u),u=I.next,M=I.next;else if((u=I)===M){E?E===1?lp(u=Vj(bu(u),a,d),a,d,p,_,b,2):E===2&&Gj(u,a,d,p,_,b):lp(bu(u),a,d,p,_,b,1);break}}}function Bj(u){var a=u.prev,d=u,p=u.next;if(Br(a,d,p)>=0)return!1;for(var _=a.x,b=d.x,E=p.x,P=a.y,I=d.y,M=p.y,B=_<b?_<E?_:E:b<E?b:E,G=P<I?P<M?P:M:I<M?I:M,q=_>b?_>E?_:E:b>E?b:E,Y=P>I?P>M?P:M:I>M?I:M,J=p.next;J!==a;){if(J.x>=B&&J.x<=q&&J.y>=G&&J.y<=Y&&zd(_,P,b,I,E,M,J.x,J.y)&&Br(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function Uj(u,a,d,p){var _=u.prev,b=u,E=u.next;if(Br(_,b,E)>=0)return!1;for(var P=_.x,I=b.x,M=E.x,B=_.y,G=b.y,q=E.y,Y=P<I?P<M?P:M:I<M?I:M,J=B<G?B<q?B:q:G<q?G:q,fe=P>I?P>M?P:M:I>M?I:M,de=B>G?B>q?B:q:G>q?G:q,Ie=a1(Y,J,a,d,p),ze=a1(fe,de,a,d,p),Se=u.prevZ,De=u.nextZ;Se&&Se.z>=Ie&&De&&De.z<=ze;){if(Se.x>=Y&&Se.x<=fe&&Se.y>=J&&Se.y<=de&&Se!==_&&Se!==E&&zd(P,B,I,G,M,q,Se.x,Se.y)&&Br(Se.prev,Se,Se.next)>=0||(Se=Se.prevZ,De.x>=Y&&De.x<=fe&&De.y>=J&&De.y<=de&&De!==_&&De!==E&&zd(P,B,I,G,M,q,De.x,De.y)&&Br(De.prev,De,De.next)>=0))return!1;De=De.nextZ}for(;Se&&Se.z>=Ie;){if(Se.x>=Y&&Se.x<=fe&&Se.y>=J&&Se.y<=de&&Se!==_&&Se!==E&&zd(P,B,I,G,M,q,Se.x,Se.y)&&Br(Se.prev,Se,Se.next)>=0)return!1;Se=Se.prevZ}for(;De&&De.z<=ze;){if(De.x>=Y&&De.x<=fe&&De.y>=J&&De.y<=de&&De!==_&&De!==E&&zd(P,B,I,G,M,q,De.x,De.y)&&Br(De.prev,De,De.next)>=0)return!1;De=De.nextZ}return!0}function Vj(u,a,d){var p=u;do{var _=p.prev,b=p.next.next;!Ty(_,b)&&P$(_,p,p.next,b)&&cp(_,b)&&cp(b,_)&&(a.push(_.i/d|0),a.push(p.i/d|0),a.push(b.i/d|0),up(p),up(p.next),p=u=b),p=p.next}while(p!==u);return bu(p)}function Gj(u,a,d,p,_,b){var E=u;do{for(var P=E.next.next;P!==E.prev;){if(E.i!==P.i&&qj(E,P)){var I=C$(E,P);return E=bu(E,E.next),I=bu(I,I.next),lp(E,a,d,p,_,b,0),void lp(I,a,d,p,_,b,0)}P=P.next}E=E.next}while(E!==u)}function jj(u,a){return u.x-a.x}function Hj(u,a){var d=function(_,b){var E,P=b,I=_.x,M=_.y,B=-1/0;do{if(M<=P.y&&M>=P.next.y&&P.next.y!==P.y){var G=P.x+(M-P.y)*(P.next.x-P.x)/(P.next.y-P.y);if(G<=I&&G>B&&(B=G,E=P.x<P.next.x?P:P.next,G===I))return E}P=P.next}while(P!==b);if(!E)return null;var q,Y=E,J=E.x,fe=E.y,de=1/0;P=E;do I>=P.x&&P.x>=J&&I!==P.x&&zd(M<fe?I:B,M,J,fe,M<fe?B:I,M,P.x,P.y)&&(q=Math.abs(M-P.y)/(I-P.x),cp(P,_)&&(q<de||q===de&&(P.x>E.x||P.x===E.x&&Wj(E,P)))&&(E=P,de=q)),P=P.next;while(P!==Y);return E}(u,a);if(!d)return a;var p=C$(d,u);return bu(p,p.next),bu(d,d.next)}function Wj(u,a){return Br(u.prev,u,a.prev)<0&&Br(a.next,u,u.next)<0}function a1(u,a,d,p,_){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-d)*_|0)|u<<8))|u<<4))|u<<2))|u<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-p)*_|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function Kj(u){var a=u,d=u;do(a.x<d.x||a.x===d.x&&a.y<d.y)&&(d=a),a=a.next;while(a!==u);return d}function zd(u,a,d,p,_,b,E,P){return(_-E)*(a-P)>=(u-E)*(b-P)&&(u-E)*(p-P)>=(d-E)*(a-P)&&(d-E)*(b-P)>=(_-E)*(p-P)}function qj(u,a){return u.next.i!==a.i&&u.prev.i!==a.i&&!function(d,p){var _=d;do{if(_.i!==d.i&&_.next.i!==d.i&&_.i!==p.i&&_.next.i!==p.i&&P$(_,_.next,d,p))return!0;_=_.next}while(_!==d);return!1}(u,a)&&(cp(u,a)&&cp(a,u)&&function(d,p){var _=d,b=!1,E=(d.x+p.x)/2,P=(d.y+p.y)/2;do _.y>P!=_.next.y>P&&_.next.y!==_.y&&E<(_.next.x-_.x)*(P-_.y)/(_.next.y-_.y)+_.x&&(b=!b),_=_.next;while(_!==d);return b}(u,a)&&(Br(u.prev,u,a.prev)||Br(u,a.prev,a))||Ty(u,a)&&Br(u.prev,u,u.next)>0&&Br(a.prev,a,a.next)>0)}function Br(u,a,d){return(a.y-u.y)*(d.x-a.x)-(a.x-u.x)*(d.y-a.y)}function Ty(u,a){return u.x===a.x&&u.y===a.y}function P$(u,a,d,p){var _=Ay(Br(u,a,d)),b=Ay(Br(u,a,p)),E=Ay(Br(d,p,u)),P=Ay(Br(d,p,a));return _!==b&&E!==P||!(_!==0||!Sy(u,d,a))||!(b!==0||!Sy(u,p,a))||!(E!==0||!Sy(d,u,p))||!(P!==0||!Sy(d,a,p))}function Sy(u,a,d){return a.x<=Math.max(u.x,d.x)&&a.x>=Math.min(u.x,d.x)&&a.y<=Math.max(u.y,d.y)&&a.y>=Math.min(u.y,d.y)}function Ay(u){return u>0?1:u<0?-1:0}function cp(u,a){return Br(u.prev,u,u.next)<0?Br(u,a,u.next)>=0&&Br(u,u.prev,a)>=0:Br(u,a,u.prev)<0||Br(u,u.next,a)<0}function C$(u,a){var d=new l1(u.i,u.x,u.y),p=new l1(a.i,a.x,a.y),_=u.next,b=a.prev;return u.next=a,a.prev=u,d.next=_,_.prev=d,p.next=d,d.prev=p,b.next=p,p.prev=b,p}function I$(u,a,d,p){var _=new l1(u,a,d);return p?(_.next=p.next,_.prev=p,p.next.prev=_,p.next=_):(_.prev=_,_.next=_),_}function up(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function l1(u,a,d){this.i=u,this.x=a,this.y=d,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function c1(u,a,d,p){for(var _=0,b=a,E=d-p;b<d;b+=p)_+=(u[E]-u[b])*(u[b+1]+u[E+1]),E=b;return _}function Xj(u,a,d,p,_){L$(u,a,d||0,p||u.length-1,_||Zj)}function L$(u,a,d,p,_){for(;p>d;){if(p-d>600){var b=p-d+1,E=a-d+1,P=Math.log(b),I=.5*Math.exp(2*P/3),M=.5*Math.sqrt(P*I*(b-I)/b)*(E-b/2<0?-1:1);L$(u,a,Math.max(d,Math.floor(a-E*I/b+M)),Math.min(p,Math.floor(a+(b-E)*I/b+M)),_)}var B=u[a],G=d,q=p;for(dp(u,d,a),_(u[p],B)>0&&dp(u,d,p);G<q;){for(dp(u,G,q),G++,q--;_(u[G],B)<0;)G++;for(;_(u[q],B)>0;)q--}_(u[d],B)===0?dp(u,d,q):dp(u,++q,p),q<=a&&(d=q+1),a<=q&&(p=q-1)}}function dp(u,a,d){var p=u[a];u[a]=u[d],u[d]=p}function Zj(u,a){return u<a?-1:u>a?1:0}function u1(u,a){const d=u.length;if(d<=1)return[u];const p=[];let _,b;for(let E=0;E<d;E++){const P=le(u[E]);P!==0&&(u[E].area=Math.abs(P),b===void 0&&(b=P<0),b===P<0?(_&&p.push(_),_=[u[E]]):_.push(u[E]))}if(_&&p.push(_),a>1)for(let E=0;E<p.length;E++)p[E].length<=a||(Xj(p[E],a,1,p[E].length-1,Yj),p[E]=p[E].slice(0,a));return p}function Yj(u,a){return a.area-u.area}function d1(u,a,d){const p=d.patternDependencies;let _=!1;for(const b of a){const E=b.paint.get(`${u}-pattern`);E.isConstant()||(_=!0);const P=E.constantOr(null);P&&(_=!0,p[P.to]=!0,p[P.from]=!0)}return _}function h1(u,a,d,p,_){const b=_.patternDependencies;for(const E of a){const P=E.paint.get(`${u}-pattern`).value;if(P.kind!=="constant"){let I=P.evaluate({zoom:p-1},d,{},_.availableImages),M=P.evaluate({zoom:p},d,{},_.availableImages),B=P.evaluate({zoom:p+1},d,{},_.availableImages);I=I&&I.name?I.name:I,M=M&&M.name?M.name:M,B=B&&B.name?B.name:B,b[I]=!0,b[M]=!0,b[B]=!0,d.patterns[E.id]={min:I,mid:M,max:B}}}return d}wy.exports=Ey,wy.exports.default=Ey,Ey.deviation=function(u,a,d,p){var _=a&&a.length,b=Math.abs(c1(u,0,_?a[0]*d:u.length,d));if(_)for(var E=0,P=a.length;E<P;E++)b-=Math.abs(c1(u,a[E]*d,E<P-1?a[E+1]*d:u.length,d));var I=0;for(E=0;E<p.length;E+=3){var M=p[E]*d,B=p[E+1]*d,G=p[E+2]*d;I+=Math.abs((u[M]-u[G])*(u[B+1]-u[M+1])-(u[M]-u[B])*(u[G+1]-u[M+1]))}return b===0&&I===0?0:Math.abs((I-b)/b)},Ey.flatten=function(u){for(var a=u[0][0].length,d={vertices:[],holes:[],dimensions:a},p=0,_=0;_<u.length;_++){for(var b=0;b<u[_].length;b++)for(var E=0;E<a;E++)d.vertices.push(u[_][b][E]);_>0&&d.holes.push(p+=u[_-1].length)}return d};class f1{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(d=>d.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Vn,this.indexArray=new ns,this.indexArray2=new Xo,this.programConfigurations=new yu(a.layers,a.zoom),this.segments=new yn,this.segments2=new yn,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(a,d,p){this.hasPattern=d1("fill",this.layers,d);const _=this.layers[0].layout.get("fill-sort-key"),b=!_.isConstant(),E=[];for(const{feature:P,id:I,index:M,sourceLayerIndex:B}of a){const G=this.layers[0]._featureFilter.needGeometry,q=vu(P,G);if(!this.layers[0]._featureFilter.filter(new hr(this.zoom),q,p))continue;const Y=b?_.evaluate(q,{},p,d.availableImages):void 0,J={id:I,properties:P.properties,type:P.type,sourceLayerIndex:B,index:M,geometry:G?q.geometry:_u(P),patterns:{},sortKey:Y};E.push(J)}b&&E.sort((P,I)=>P.sortKey-I.sortKey);for(const P of E){const{geometry:I,index:M,sourceLayerIndex:B}=P;if(this.hasPattern){const G=h1("fill",this.layers,P,this.zoom,d);this.patternFeatures.push(G)}else this.addFeature(P,I,M,p,{});d.featureIndex.insert(a[M].feature,I,M,B,this.index)}}update(a,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,d,this.stateDependentLayers,p)}addFeatures(a,d,p){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,d,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Nj),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,d,p,_,b){for(const E of u1(d,500)){let P=0;for(const Y of E)P+=Y.length;const I=this.segments.prepareSegment(P,this.layoutVertexArray,this.indexArray),M=I.vertexLength,B=[],G=[];for(const Y of E){if(Y.length===0)continue;Y!==E[0]&&G.push(B.length/2);const J=this.segments2.prepareSegment(Y.length,this.layoutVertexArray,this.indexArray2),fe=J.vertexLength;this.layoutVertexArray.emplaceBack(Y[0].x,Y[0].y),this.indexArray2.emplaceBack(fe+Y.length-1,fe),B.push(Y[0].x),B.push(Y[0].y);for(let de=1;de<Y.length;de++)this.layoutVertexArray.emplaceBack(Y[de].x,Y[de].y),this.indexArray2.emplaceBack(fe+de-1,fe+de),B.push(Y[de].x),B.push(Y[de].y);J.vertexLength+=Y.length,J.primitiveLength+=Y.length}const q=wy.exports(B,G);for(let Y=0;Y<q.length;Y+=3)this.indexArray.emplaceBack(M+q[Y],M+q[Y+1],M+q[Y+2]);I.vertexLength+=P,I.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,b,_)}}Pt("FillBucket",f1,{omit:["layers","patternFeatures"]});const Jj=new Ei({"fill-sort-key":new qt(je.layout_fill["fill-sort-key"])});var Qj={paint:new Ei({"fill-antialias":new Ft(je.paint_fill["fill-antialias"]),"fill-opacity":new qt(je.paint_fill["fill-opacity"]),"fill-color":new qt(je.paint_fill["fill-color"]),"fill-outline-color":new qt(je.paint_fill["fill-outline-color"]),"fill-translate":new Ft(je.paint_fill["fill-translate"]),"fill-translate-anchor":new Ft(je.paint_fill["fill-translate-anchor"]),"fill-pattern":new ec(je.paint_fill["fill-pattern"])}),layout:Jj};const eH=Xr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),tH=Xr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:nH}=eH;var rc={},rH=mt,R$=Nd;function Nd(u,a,d,p,_){this.properties={},this.extent=d,this.type=0,this._pbf=u,this._geometry=-1,this._keys=p,this._values=_,u.readFields(iH,this,a)}function iH(u,a,d){u==1?a.id=d.readVarint():u==2?function(p,_){for(var b=p.readVarint()+p.pos;p.pos<b;){var E=_._keys[p.readVarint()],P=_._values[p.readVarint()];_.properties[E]=P}}(d,a):u==3?a.type=d.readVarint():u==4&&(a._geometry=d.pos)}function sH(u){for(var a,d,p=0,_=0,b=u.length,E=b-1;_<b;E=_++)p+=((d=u[E]).x-(a=u[_]).x)*(a.y+d.y);return p}Nd.types=["Unknown","Point","LineString","Polygon"],Nd.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var a,d=u.readVarint()+u.pos,p=1,_=0,b=0,E=0,P=[];u.pos<d;){if(_<=0){var I=u.readVarint();p=7&I,_=I>>3}if(_--,p===1||p===2)b+=u.readSVarint(),E+=u.readSVarint(),p===1&&(a&&P.push(a),a=[]),a.push(new rH(b,E));else{if(p!==7)throw new Error("unknown command "+p);a&&a.push(a[0].clone())}}return a&&P.push(a),P},Nd.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var a=u.readVarint()+u.pos,d=1,p=0,_=0,b=0,E=1/0,P=-1/0,I=1/0,M=-1/0;u.pos<a;){if(p<=0){var B=u.readVarint();d=7&B,p=B>>3}if(p--,d===1||d===2)(_+=u.readSVarint())<E&&(E=_),_>P&&(P=_),(b+=u.readSVarint())<I&&(I=b),b>M&&(M=b);else if(d!==7)throw new Error("unknown command "+d)}return[E,I,P,M]},Nd.prototype.toGeoJSON=function(u,a,d){var p,_,b=this.extent*Math.pow(2,d),E=this.extent*u,P=this.extent*a,I=this.loadGeometry(),M=Nd.types[this.type];function B(Y){for(var J=0;J<Y.length;J++){var fe=Y[J];Y[J]=[360*(fe.x+E)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(fe.y+P)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var G=[];for(p=0;p<I.length;p++)G[p]=I[p][0];B(I=G);break;case 2:for(p=0;p<I.length;p++)B(I[p]);break;case 3:for(I=function(Y){var J=Y.length;if(J<=1)return[Y];for(var fe,de,Ie=[],ze=0;ze<J;ze++){var Se=sH(Y[ze]);Se!==0&&(de===void 0&&(de=Se<0),de===Se<0?(fe&&Ie.push(fe),fe=[Y[ze]]):fe.push(Y[ze]))}return fe&&Ie.push(fe),Ie}(I),p=0;p<I.length;p++)for(_=0;_<I[p].length;_++)B(I[p][_])}I.length===1?I=I[0]:M="Multi"+M;var q={type:"Feature",geometry:{type:M,coordinates:I},properties:this.properties};return"id"in this&&(q.id=this.id),q};var oH=R$,$$=M$;function M$(u,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(aH,this,a),this.length=this._features.length}function aH(u,a,d){u===15?a.version=d.readVarint():u===1?a.name=d.readString():u===5?a.extent=d.readVarint():u===2?a._features.push(d.pos):u===3?a._keys.push(d.readString()):u===4&&a._values.push(function(p){for(var _=null,b=p.readVarint()+p.pos;p.pos<b;){var E=p.readVarint()>>3;_=E===1?p.readString():E===2?p.readFloat():E===3?p.readDouble():E===4?p.readVarint64():E===5?p.readVarint():E===6?p.readSVarint():E===7?p.readBoolean():null}return _}(d))}M$.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var a=this._pbf.readVarint()+this._pbf.pos;return new oH(this._pbf,a,this.extent,this._keys,this._values)};var lH=$$;function cH(u,a,d){if(u===3){var p=new lH(d,d.readVarint()+d.pos);p.length&&(a[p.name]=p)}}rc.VectorTile=function(u,a){this.layers=u.readFields(cH,{},a)},rc.VectorTileFeature=R$,rc.VectorTileLayer=$$;const uH=rc.VectorTileFeature.types,p1=Math.pow(2,13);function hp(u,a,d,p,_,b,E,P){u.emplaceBack(a,d,2*Math.floor(p*p1)+E,_*p1*2,b*p1*2,Math.round(P))}class m1{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(d=>d.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Cn,this.centroidVertexArray=new Gt,this.indexArray=new ns,this.programConfigurations=new yu(a.layers,a.zoom),this.segments=new yn,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(a,d,p){this.features=[],this.hasPattern=d1("fill-extrusion",this.layers,d);for(const{feature:_,id:b,index:E,sourceLayerIndex:P}of a){const I=this.layers[0]._featureFilter.needGeometry,M=vu(_,I);if(!this.layers[0]._featureFilter.filter(new hr(this.zoom),M,p))continue;const B={id:b,sourceLayerIndex:P,index:E,geometry:I?M.geometry:_u(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(h1("fill-extrusion",this.layers,B,this.zoom,d)):this.addFeature(B,B.geometry,E,p,{}),d.featureIndex.insert(_,B.geometry,E,P,this.index,!0)}}addFeatures(a,d,p){for(const _ of this.features){const{geometry:b}=_;this.addFeature(_,b,_.index,d,p)}}update(a,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,d,this.stateDependentLayers,p)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,nH),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,tH.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,d,p,_,b){const E={x:0,y:0,vertexCount:0};for(const P of u1(d,500)){let I=0;for(const J of P)I+=J.length;let M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const J of P){if(J.length===0||hH(J))continue;let fe=0;for(let de=0;de<J.length;de++){const Ie=J[de];if(de>=1){const ze=J[de-1];if(!dH(Ie,ze)){M.vertexLength+4>yn.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Se=Ie.sub(ze)._perp()._unit(),De=ze.dist(Ie);fe+De>32768&&(fe=0),hp(this.layoutVertexArray,Ie.x,Ie.y,Se.x,Se.y,0,0,fe),hp(this.layoutVertexArray,Ie.x,Ie.y,Se.x,Se.y,0,1,fe),E.x+=2*Ie.x,E.y+=2*Ie.y,E.vertexCount+=2,fe+=De,hp(this.layoutVertexArray,ze.x,ze.y,Se.x,Se.y,0,0,fe),hp(this.layoutVertexArray,ze.x,ze.y,Se.x,Se.y,0,1,fe),E.x+=2*ze.x,E.y+=2*ze.y,E.vertexCount+=2;const Xe=M.vertexLength;this.indexArray.emplaceBack(Xe,Xe+2,Xe+1),this.indexArray.emplaceBack(Xe+1,Xe+2,Xe+3),M.vertexLength+=4,M.primitiveLength+=2}}}}if(M.vertexLength+I>yn.MAX_VERTEX_ARRAY_LENGTH&&(M=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),uH[a.type]!=="Polygon")continue;const B=[],G=[],q=M.vertexLength;for(const J of P)if(J.length!==0){J!==P[0]&&G.push(B.length/2);for(let fe=0;fe<J.length;fe++){const de=J[fe];hp(this.layoutVertexArray,de.x,de.y,0,0,1,1,0),E.x+=de.x,E.y+=de.y,E.vertexCount+=1,B.push(de.x),B.push(de.y)}}const Y=wy.exports(B,G);for(let J=0;J<Y.length;J+=3)this.indexArray.emplaceBack(q+Y[J],q+Y[J+2],q+Y[J+1]);M.primitiveLength+=Y.length/3,M.vertexLength+=I}for(let P=0;P<E.vertexCount;P++)this.centroidVertexArray.emplaceBack(Math.floor(E.x/E.vertexCount),Math.floor(E.y/E.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,b,_)}}function dH(u,a){return u.x===a.x&&(u.x<0||u.x>oi)||u.y===a.y&&(u.y<0||u.y>oi)}function hH(u){return u.every(a=>a.x<0)||u.every(a=>a.x>oi)||u.every(a=>a.y<0)||u.every(a=>a.y>oi)}Pt("FillExtrusionBucket",m1,{omit:["layers","features"]});var fH={paint:new Ei({"fill-extrusion-opacity":new Ft(je["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new qt(je["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ft(je["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ft(je["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ec(je["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new qt(je["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new qt(je["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ft(je["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function fp(u,a){return u.x*a.x+u.y*a.y}function k$(u,a){if(u.length===1){let d=0;const p=a[d++];let _;for(;!_||p.equals(_);)if(_=a[d++],!_)return 1/0;for(;d<a.length;d++){const b=a[d],E=u[0],P=_.sub(p),I=b.sub(p),M=E.sub(p),B=fp(P,P),G=fp(P,I),q=fp(I,I),Y=fp(M,P),J=fp(M,I),fe=B*q-G*G,de=(q*Y-G*J)/fe,Ie=(B*J-G*Y)/fe,ze=p.z*(1-de-Ie)+_.z*de+b.z*Ie;if(isFinite(ze))return ze}return 1/0}{let d=1/0;for(const p of a)d=Math.min(d,p.z);return d}}const pH=Xr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:mH}=pH,gH=Xr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:yH}=gH,_H=rc.VectorTileFeature.types,vH=Math.cos(Math.PI/180*37.5),O$=Math.pow(2,14)/.5;class g1{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(d=>d.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(d=>{this.gradients[d.id]={}}),this.layoutVertexArray=new In,this.layoutVertexArray2=new Wn,this.indexArray=new ns,this.programConfigurations=new yu(a.layers,a.zoom),this.segments=new yn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(a,d,p){this.hasPattern=d1("line",this.layers,d);const _=this.layers[0].layout.get("line-sort-key"),b=!_.isConstant(),E=[];for(const{feature:P,id:I,index:M,sourceLayerIndex:B}of a){const G=this.layers[0]._featureFilter.needGeometry,q=vu(P,G);if(!this.layers[0]._featureFilter.filter(new hr(this.zoom),q,p))continue;const Y=b?_.evaluate(q,{},p):void 0,J={id:I,properties:P.properties,type:P.type,sourceLayerIndex:B,index:M,geometry:G?q.geometry:_u(P),patterns:{},sortKey:Y};E.push(J)}b&&E.sort((P,I)=>P.sortKey-I.sortKey);for(const P of E){const{geometry:I,index:M,sourceLayerIndex:B}=P;if(this.hasPattern){const G=h1("line",this.layers,P,this.zoom,d);this.patternFeatures.push(G)}else this.addFeature(P,I,M,p,{});d.featureIndex.insert(a[M].feature,I,M,B,this.index)}}update(a,d,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,d,this.stateDependentLayers,p)}addFeatures(a,d,p){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,d,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,yH)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,mH),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,d,p,_,b){const E=this.layers[0].layout,P=E.get("line-join").evaluate(a,{}),I=E.get("line-cap"),M=E.get("line-miter-limit"),B=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const G of d)this.addLine(G,a,P,I,M,B);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,p,b,_)}addLine(a,d,p,_,b,E){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ie=0;Ie<a.length-1;Ie++)this.totalDistance+=a[Ie].dist(a[Ie+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=_H[d.type]==="Polygon";let I=a.length;for(;I>=2&&a[I-1].equals(a[I-2]);)I--;let M=0;for(;M<I-1&&a[M].equals(a[M+1]);)M++;if(I<(P?3:2))return;p==="bevel"&&(b=1.05);const B=this.overscaling<=16?122880/(512*this.overscaling):0,G=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let q,Y,J,fe,de;this.e1=this.e2=-1,P&&(q=a[I-2],de=a[M].sub(q)._unit()._perp());for(let Ie=M;Ie<I;Ie++){if(J=Ie===I-1?P?a[M+1]:void 0:a[Ie+1],J&&a[Ie].equals(J))continue;de&&(fe=de),q&&(Y=q),q=a[Ie],de=J?J.sub(q)._unit()._perp():fe,fe=fe||de;let ze=fe.add(de);ze.x===0&&ze.y===0||ze._unit();const Se=fe.x*de.x+fe.y*de.y,De=ze.x*de.x+ze.y*de.y,Xe=De!==0?1/De:1/0,qe=2*Math.sqrt(2-2*De),St=De<vH&&Y&&J,$t=fe.x*de.y-fe.y*de.x>0;if(St&&Ie>M){const ut=q.dist(Y);if(ut>2*B){const xt=q.sub(q.sub(Y)._mult(B/ut)._round());this.updateDistance(Y,xt),this.addCurrentVertex(xt,fe,0,0,G),Y=xt}}const bt=Y&&J;let pt=bt?p:P?"butt":_;if(bt&&pt==="round"&&(Xe<E?pt="miter":Xe<=2&&(pt="fakeround")),pt==="miter"&&Xe>b&&(pt="bevel"),pt==="bevel"&&(Xe>2&&(pt="flipbevel"),Xe<b&&(pt="miter")),Y&&this.updateDistance(Y,q),pt==="miter")ze._mult(Xe),this.addCurrentVertex(q,ze,0,0,G);else if(pt==="flipbevel"){if(Xe>100)ze=de.mult(-1);else{const ut=Xe*fe.add(de).mag()/fe.sub(de).mag();ze._perp()._mult(ut*($t?-1:1))}this.addCurrentVertex(q,ze,0,0,G),this.addCurrentVertex(q,ze.mult(-1),0,0,G)}else if(pt==="bevel"||pt==="fakeround"){const ut=-Math.sqrt(Xe*Xe-1),xt=$t?ut:0,yt=$t?0:ut;if(Y&&this.addCurrentVertex(q,fe,xt,yt,G),pt==="fakeround"){const rt=Math.round(180*qe/Math.PI/20);for(let jt=1;jt<rt;jt++){let Nt=jt/rt;if(Nt!==.5){const ar=Nt-.5;Nt+=Nt*ar*(Nt-1)*((1.0904+Se*(Se*(3.55645-1.43519*Se)-3.2452))*ar*ar+(.848013+Se*(.215638*Se-1.06021)))}const hn=de.sub(fe)._mult(Nt)._add(fe)._unit()._mult($t?-1:1);this.addHalfVertex(q,hn.x,hn.y,!1,$t,0,G)}}J&&this.addCurrentVertex(q,de,-xt,-yt,G)}else if(pt==="butt")this.addCurrentVertex(q,ze,0,0,G);else if(pt==="square"){const ut=Y?1:-1;this.addCurrentVertex(q,ze,ut,ut,G)}else pt==="round"&&(Y&&(this.addCurrentVertex(q,fe,0,0,G),this.addCurrentVertex(q,fe,1,1,G,!0)),J&&(this.addCurrentVertex(q,de,-1,-1,G,!0),this.addCurrentVertex(q,de,0,0,G)));if(St&&Ie<I-1){const ut=q.dist(J);if(ut>2*B){const xt=q.add(J.sub(q)._mult(B/ut)._round());this.updateDistance(q,xt),this.addCurrentVertex(xt,de,0,0,G),q=xt}}}}addCurrentVertex(a,d,p,_,b,E=!1){const P=d.y*_-d.x,I=-d.y-d.x*_;this.addHalfVertex(a,d.x+d.y*p,d.y-d.x*p,E,!1,p,b),this.addHalfVertex(a,P,I,E,!0,-_,b),this.distance>O$/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(a,d,p,_,b,E))}addHalfVertex({x:a,y:d},p,_,b,E,P,I){const M=.5*(this.lineClips?this.scaledDistance*(O$-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(b?1:0),(d<<1)+(E?1:0),Math.round(63*p)+128,Math.round(63*_)+128,1+(P===0?0:P<0?-1:1)|(63&M)<<2,M>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const B=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,B),I.primitiveLength++),E?this.e2=B:this.e1=B}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,d){this.distance+=a.dist(d),this.updateScaledDistance()}}Pt("LineBucket",g1,{omit:["layers","patternFeatures"]});const bH=new Ei({"line-cap":new Ft(je.layout_line["line-cap"]),"line-join":new qt(je.layout_line["line-join"]),"line-miter-limit":new Ft(je.layout_line["line-miter-limit"]),"line-round-limit":new Ft(je.layout_line["line-round-limit"]),"line-sort-key":new qt(je.layout_line["line-sort-key"])});var D$={paint:new Ei({"line-opacity":new qt(je.paint_line["line-opacity"]),"line-color":new qt(je.paint_line["line-color"]),"line-translate":new Ft(je.paint_line["line-translate"]),"line-translate-anchor":new Ft(je.paint_line["line-translate-anchor"]),"line-width":new qt(je.paint_line["line-width"]),"line-gap-width":new qt(je.paint_line["line-gap-width"]),"line-offset":new qt(je.paint_line["line-offset"]),"line-blur":new qt(je.paint_line["line-blur"]),"line-dasharray":new ep(je.paint_line["line-dasharray"]),"line-pattern":new ec(je.paint_line["line-pattern"]),"line-gradient":new wa(je.paint_line["line-gradient"])}),layout:bH};const F$=new class extends qt{possiblyEvaluate(u,a){return a=new hr(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(u,a)}evaluate(u,a,d,p){return a=R({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(u,a,d,p)}}(D$.paint.properties["line-width"].specification);function z$(u,a){return a>0?a+2*u:u}F$.useIntegerZoom=!0;const xH=Xr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),wH=Xr([{name:"a_projected_pos",components:3,type:"Float32"}],4);Xr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const EH=Xr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Xr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const N$=Xr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),TH=Xr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function SH(u,a,d){return u.sections.forEach(p=>{p.text=function(_,b,E){const P=b.layout.get("text-transform").evaluate(E,{});return P==="uppercase"?_=_.toLocaleUpperCase():P==="lowercase"&&(_=_.toLocaleLowerCase()),ks.applyArabicShaping&&(_=ks.applyArabicShaping(_)),_}(p.text,a,d)}),u}Xr([{name:"triangle",components:3,type:"Uint16"}]),Xr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Xr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xr([{type:"Float32",name:"offsetX"}]),Xr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const pp={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Ti=24,y1=Zn,B$=function(u,a,d,p,_){var b,E,P=8*_-p-1,I=(1<<P)-1,M=I>>1,B=-7,G=d?_-1:0,q=d?-1:1,Y=u[a+G];for(G+=q,b=Y&(1<<-B)-1,Y>>=-B,B+=P;B>0;b=256*b+u[a+G],G+=q,B-=8);for(E=b&(1<<-B)-1,b>>=-B,B+=p;B>0;E=256*E+u[a+G],G+=q,B-=8);if(b===0)b=1-M;else{if(b===I)return E?NaN:1/0*(Y?-1:1);E+=Math.pow(2,p),b-=M}return(Y?-1:1)*E*Math.pow(2,b-p)},U$=function(u,a,d,p,_,b){var E,P,I,M=8*b-_-1,B=(1<<M)-1,G=B>>1,q=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,Y=p?0:b-1,J=p?1:-1,fe=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(P=isNaN(a)?1:0,E=B):(E=Math.floor(Math.log(a)/Math.LN2),a*(I=Math.pow(2,-E))<1&&(E--,I*=2),(a+=E+G>=1?q/I:q*Math.pow(2,1-G))*I>=2&&(E++,I/=2),E+G>=B?(P=0,E=B):E+G>=1?(P=(a*I-1)*Math.pow(2,_),E+=G):(P=a*Math.pow(2,G-1)*Math.pow(2,_),E=0));_>=8;u[d+Y]=255&P,Y+=J,P/=256,_-=8);for(E=E<<_|P,M+=_;M>0;u[d+Y]=255&E,Y+=J,E/=256,M-=8);u[d+Y-J]|=128*fe};function Zn(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Zn.Varint=0,Zn.Fixed64=1,Zn.Bytes=2,Zn.Fixed32=5;var ic,_1=4294967296,V$=1/_1,G$=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function rl(u){return u.type===Zn.Bytes?u.readVarint()+u.pos:u.pos+1}function Bd(u,a,d){return d?4294967296*a+(u>>>0):4294967296*(a>>>0)+(u>>>0)}function j$(u,a,d){var p=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));d.realloc(p);for(var _=d.pos-1;_>=u;_--)d.buf[_+p]=d.buf[_]}function AH(u,a){for(var d=0;d<u.length;d++)a.writeVarint(u[d])}function PH(u,a){for(var d=0;d<u.length;d++)a.writeSVarint(u[d])}function CH(u,a){for(var d=0;d<u.length;d++)a.writeFloat(u[d])}function IH(u,a){for(var d=0;d<u.length;d++)a.writeDouble(u[d])}function LH(u,a){for(var d=0;d<u.length;d++)a.writeBoolean(u[d])}function RH(u,a){for(var d=0;d<u.length;d++)a.writeFixed32(u[d])}function $H(u,a){for(var d=0;d<u.length;d++)a.writeSFixed32(u[d])}function MH(u,a){for(var d=0;d<u.length;d++)a.writeFixed64(u[d])}function kH(u,a){for(var d=0;d<u.length;d++)a.writeSFixed64(u[d])}function Py(u,a){return(u[a]|u[a+1]<<8|u[a+2]<<16)+16777216*u[a+3]}function Ud(u,a,d){u[d]=a,u[d+1]=a>>>8,u[d+2]=a>>>16,u[d+3]=a>>>24}function H$(u,a){return(u[a]|u[a+1]<<8|u[a+2]<<16)+(u[a+3]<<24)}function OH(u,a,d){u===1&&d.readMessage(DH,a)}function DH(u,a,d){if(u===3){const{id:p,bitmap:_,width:b,height:E,left:P,top:I,advance:M}=d.readMessage(FH,{});a.push({id:p,bitmap:new ap({width:b+6,height:E+6},_),metrics:{width:b,height:E,left:P,top:I,advance:M}})}}function FH(u,a,d){u===1?a.id=d.readVarint():u===2?a.bitmap=d.readBytes():u===3?a.width=d.readVarint():u===4?a.height=d.readVarint():u===5?a.left=d.readSVarint():u===6?a.top=d.readSVarint():u===7&&(a.advance=d.readVarint())}function W$(u){let a=0,d=0;for(const E of u)a+=E.w*E.h,d=Math.max(d,E.w);u.sort((E,P)=>P.h-E.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),d),h:1/0}];let _=0,b=0;for(const E of u)for(let P=p.length-1;P>=0;P--){const I=p[P];if(!(E.w>I.w||E.h>I.h)){if(E.x=I.x,E.y=I.y,b=Math.max(b,E.y+E.h),_=Math.max(_,E.x+E.w),E.w===I.w&&E.h===I.h){const M=p.pop();P<p.length&&(p[P]=M)}else E.h===I.h?(I.x+=E.w,I.w-=E.w):E.w===I.w?(I.y+=E.h,I.h-=E.h):(p.push({x:I.x+E.w,y:I.y,w:I.w-E.w,h:E.h}),I.y+=E.h,I.h-=E.h);break}}return{w:_,h:b,fill:a/(_*b)||0}}Zn.prototype={destroy:function(){this.buf=null},readFields:function(u,a,d){for(d=d||this.length;this.pos<d;){var p=this.readVarint(),_=p>>3,b=this.pos;this.type=7&p,u(_,a,this),this.pos===b&&this.skip(p)}return a},readMessage:function(u,a){return this.readFields(u,a,this.readVarint()+this.pos)},readFixed32:function(){var u=Py(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=H$(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=Py(this.buf,this.pos)+Py(this.buf,this.pos+4)*_1;return this.pos+=8,u},readSFixed64:function(){var u=Py(this.buf,this.pos)+H$(this.buf,this.pos+4)*_1;return this.pos+=8,u},readFloat:function(){var u=B$(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=B$(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var a,d,p=this.buf;return a=127&(d=p[this.pos++]),d<128?a:(a|=(127&(d=p[this.pos++]))<<7,d<128?a:(a|=(127&(d=p[this.pos++]))<<14,d<128?a:(a|=(127&(d=p[this.pos++]))<<21,d<128?a:function(_,b,E){var P,I,M=E.buf;if(P=(112&(I=M[E.pos++]))>>4,I<128||(P|=(127&(I=M[E.pos++]))<<3,I<128)||(P|=(127&(I=M[E.pos++]))<<10,I<128)||(P|=(127&(I=M[E.pos++]))<<17,I<128)||(P|=(127&(I=M[E.pos++]))<<24,I<128)||(P|=(1&(I=M[E.pos++]))<<31,I<128))return Bd(_,P,b);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(d=p[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,a=this.pos;return this.pos=u,u-a>=12&&G$?function(d,p,_){return G$.decode(d.subarray(p,_))}(this.buf,a,u):function(d,p,_){for(var b="",E=p;E<_;){var P,I,M,B=d[E],G=null,q=B>239?4:B>223?3:B>191?2:1;if(E+q>_)break;q===1?B<128&&(G=B):q===2?(192&(P=d[E+1]))==128&&(G=(31&B)<<6|63&P)<=127&&(G=null):q===3?(I=d[E+2],(192&(P=d[E+1]))==128&&(192&I)==128&&((G=(15&B)<<12|(63&P)<<6|63&I)<=2047||G>=55296&&G<=57343)&&(G=null)):q===4&&(I=d[E+2],M=d[E+3],(192&(P=d[E+1]))==128&&(192&I)==128&&(192&M)==128&&((G=(15&B)<<18|(63&P)<<12|(63&I)<<6|63&M)<=65535||G>=1114112)&&(G=null)),G===null?(G=65533,q=1):G>65535&&(G-=65536,b+=String.fromCharCode(G>>>10&1023|55296),G=56320|1023&G),b+=String.fromCharCode(G),E+=q}return b}(this.buf,a,u)},readBytes:function(){var u=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,u);return this.pos=u,a},readPackedVarint:function(u,a){if(this.type!==Zn.Bytes)return u.push(this.readVarint(a));var d=rl(this);for(u=u||[];this.pos<d;)u.push(this.readVarint(a));return u},readPackedSVarint:function(u){if(this.type!==Zn.Bytes)return u.push(this.readSVarint());var a=rl(this);for(u=u||[];this.pos<a;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Zn.Bytes)return u.push(this.readBoolean());var a=rl(this);for(u=u||[];this.pos<a;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Zn.Bytes)return u.push(this.readFloat());var a=rl(this);for(u=u||[];this.pos<a;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Zn.Bytes)return u.push(this.readDouble());var a=rl(this);for(u=u||[];this.pos<a;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Zn.Bytes)return u.push(this.readFixed32());var a=rl(this);for(u=u||[];this.pos<a;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Zn.Bytes)return u.push(this.readSFixed32());var a=rl(this);for(u=u||[];this.pos<a;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Zn.Bytes)return u.push(this.readFixed64());var a=rl(this);for(u=u||[];this.pos<a;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Zn.Bytes)return u.push(this.readSFixed64());var a=rl(this);for(u=u||[];this.pos<a;)u.push(this.readSFixed64());return u},skip:function(u){var a=7&u;if(a===Zn.Varint)for(;this.buf[this.pos++]>127;);else if(a===Zn.Bytes)this.pos=this.readVarint()+this.pos;else if(a===Zn.Fixed32)this.pos+=4;else{if(a!==Zn.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(u,a){this.writeVarint(u<<3|a)},realloc:function(u){for(var a=this.length||16;a<this.pos+u;)a*=2;if(a!==this.length){var d=new Uint8Array(a);d.set(this.buf),this.buf=d,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),Ud(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),Ud(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),Ud(this.buf,-1&u,this.pos),Ud(this.buf,Math.floor(u*V$),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),Ud(this.buf,-1&u,this.pos),Ud(this.buf,Math.floor(u*V$),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(a,d){var p,_;if(a>=0?(p=a%4294967296|0,_=a/4294967296|0):(_=~(-a/4294967296),4294967295^(p=~(-a%4294967296))?p=p+1|0:(p=0,_=_+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");d.realloc(10),function(b,E,P){P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,b>>>=7,P.buf[P.pos++]=127&b|128,P.buf[P.pos]=127&(b>>>=7)}(p,0,d),function(b,E){var P=(7&b)<<4;E.buf[E.pos++]|=P|((b>>>=3)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b|((b>>>=7)?128:0),b&&(E.buf[E.pos++]=127&b)))))}(_,d)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var a=this.pos;this.pos=function(p,_,b){for(var E,P,I=0;I<_.length;I++){if((E=_.charCodeAt(I))>55295&&E<57344){if(!P){E>56319||I+1===_.length?(p[b++]=239,p[b++]=191,p[b++]=189):P=E;continue}if(E<56320){p[b++]=239,p[b++]=191,p[b++]=189,P=E;continue}E=P-55296<<10|E-56320|65536,P=null}else P&&(p[b++]=239,p[b++]=191,p[b++]=189,P=null);E<128?p[b++]=E:(E<2048?p[b++]=E>>6|192:(E<65536?p[b++]=E>>12|224:(p[b++]=E>>18|240,p[b++]=E>>12&63|128),p[b++]=E>>6&63|128),p[b++]=63&E|128)}return b}(this.buf,u,this.pos);var d=this.pos-a;d>=128&&j$(a,d,this),this.pos=a-1,this.writeVarint(d),this.pos+=d},writeFloat:function(u){this.realloc(4),U$(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),U$(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var a=u.length;this.writeVarint(a),this.realloc(a);for(var d=0;d<a;d++)this.buf[this.pos++]=u[d]},writeRawMessage:function(u,a){this.pos++;var d=this.pos;u(a,this);var p=this.pos-d;p>=128&&j$(d,p,this),this.pos=d-1,this.writeVarint(p),this.pos+=p},writeMessage:function(u,a,d){this.writeTag(u,Zn.Bytes),this.writeRawMessage(a,d)},writePackedVarint:function(u,a){a.length&&this.writeMessage(u,AH,a)},writePackedSVarint:function(u,a){a.length&&this.writeMessage(u,PH,a)},writePackedBoolean:function(u,a){a.length&&this.writeMessage(u,LH,a)},writePackedFloat:function(u,a){a.length&&this.writeMessage(u,CH,a)},writePackedDouble:function(u,a){a.length&&this.writeMessage(u,IH,a)},writePackedFixed32:function(u,a){a.length&&this.writeMessage(u,RH,a)},writePackedSFixed32:function(u,a){a.length&&this.writeMessage(u,$H,a)},writePackedFixed64:function(u,a){a.length&&this.writeMessage(u,MH,a)},writePackedSFixed64:function(u,a){a.length&&this.writeMessage(u,kH,a)},writeBytesField:function(u,a){this.writeTag(u,Zn.Bytes),this.writeBytes(a)},writeFixed32Field:function(u,a){this.writeTag(u,Zn.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(u,a){this.writeTag(u,Zn.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(u,a){this.writeTag(u,Zn.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(u,a){this.writeTag(u,Zn.Fixed64),this.writeSFixed64(a)},writeVarintField:function(u,a){this.writeTag(u,Zn.Varint),this.writeVarint(a)},writeSVarintField:function(u,a){this.writeTag(u,Zn.Varint),this.writeSVarint(a)},writeStringField:function(u,a){this.writeTag(u,Zn.Bytes),this.writeString(a)},writeFloatField:function(u,a){this.writeTag(u,Zn.Fixed32),this.writeFloat(a)},writeDoubleField:function(u,a){this.writeTag(u,Zn.Fixed64),this.writeDouble(a)},writeBooleanField:function(u,a){this.writeVarintField(u,!!a)}};class v1{constructor(a,{pixelRatio:d,version:p,stretchX:_,stretchY:b,content:E}){this.paddedRect=a,this.pixelRatio=d,this.stretchX=_,this.stretchY=b,this.content=E,this.version=p}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class K${constructor(a,d){const p={},_={};this.haveRenderCallbacks=[];const b=[];this.addImages(a,p,b),this.addImages(d,_,b);const{w:E,h:P}=W$(b),I=new to({width:E||1,height:P||1});for(const M in a){const B=a[M],G=p[M].paddedRect;to.copy(B.data,I,{x:0,y:0},{x:G.x+1,y:G.y+1},B.data)}for(const M in d){const B=d[M],G=_[M].paddedRect,q=G.x+1,Y=G.y+1,J=B.data.width,fe=B.data.height;to.copy(B.data,I,{x:0,y:0},{x:q,y:Y},B.data),to.copy(B.data,I,{x:0,y:fe-1},{x:q,y:Y-1},{width:J,height:1}),to.copy(B.data,I,{x:0,y:0},{x:q,y:Y+fe},{width:J,height:1}),to.copy(B.data,I,{x:J-1,y:0},{x:q-1,y:Y},{width:1,height:fe}),to.copy(B.data,I,{x:0,y:0},{x:q+J,y:Y},{width:1,height:fe})}this.image=I,this.iconPositions=p,this.patternPositions=_}addImages(a,d,p){for(const _ in a){const b=a[_],E={x:0,y:0,w:b.data.width+2,h:b.data.height+2};p.push(E),d[_]=new v1(E,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(a,d){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in a.updatedImages)this.patchUpdatedImage(this.iconPositions[p],a.getImage(p),d),this.patchUpdatedImage(this.patternPositions[p],a.getImage(p),d)}patchUpdatedImage(a,d,p){if(!a||!d||a.version===d.version)return;a.version=d.version;const[_,b]=a.tl;p.update(d.data,void 0,{x:_,y:b})}}Pt("ImagePosition",v1),Pt("ImageAtlas",K$),o.WritingMode=void 0,(ic=o.WritingMode||(o.WritingMode={}))[ic.none=0]="none",ic[ic.horizontal=1]="horizontal",ic[ic.vertical=2]="vertical",ic[ic.horizontalOnly=3]="horizontalOnly";const Cy=-17;class mp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,d){const p=new mp;return p.scale=a||1,p.fontStack=d,p}static forImage(a){const d=new mp;return d.imageName=a,d}}class Vd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,d){const p=new Vd;for(let _=0;_<a.sections.length;_++){const b=a.sections[_];b.image?p.addImageSection(b):p.addTextSection(b,d)}return p}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(){this.text=function(a){let d="";for(let p=0;p<a.length;p++){const _=a.charCodeAt(p+1)||null,b=a.charCodeAt(p-1)||null;d+=_&&ly(_)&&!pp[a[p+1]]||b&&ly(b)&&!pp[a[p-1]]||!pp[a[p]]?a[p]:pp[a[p]]}return d}(this.text)}trim(){let a=0;for(let p=0;p<this.text.length&&Ly[this.text.charCodeAt(p)];p++)a++;let d=this.text.length;for(let p=this.text.length-1;p>=0&&p>=a&&Ly[this.text.charCodeAt(p)];p--)d--;this.text=this.text.substring(a,d),this.sectionIndex=this.sectionIndex.slice(a,d)}substring(a,d){const p=new Vd;return p.text=this.text.substring(a,d),p.sectionIndex=this.sectionIndex.slice(a,d),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,d)=>Math.max(a,this.sections[d].scale),0)}addTextSection(a,d){this.text+=a.text,this.sections.push(mp.forText(a.scale,a.fontStack||d));const p=this.sections.length-1;for(let _=0;_<a.text.length;++_)this.sectionIndex.push(p)}addImageSection(a){const d=a.image?a.image.name:"";if(d.length===0)return void ie("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(mp.forImage(d)),this.sectionIndex.push(this.sections.length-1)):ie("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Iy(u,a,d,p,_,b,E,P,I,M,B,G,q,Y,J,fe){const de=Vd.fromFeature(u,_);let Ie;G===o.WritingMode.vertical&&de.verticalizePunctuation();const{processBidirectionalText:ze,processStyledBidirectionalText:Se}=ks;if(ze&&de.sections.length===1){Ie=[];const qe=ze(de.toString(),b1(de,M,b,a,p,Y,J));for(const St of qe){const $t=new Vd;$t.text=St,$t.sections=de.sections;for(let bt=0;bt<St.length;bt++)$t.sectionIndex.push(0);Ie.push($t)}}else if(Se){Ie=[];const qe=Se(de.text,de.sectionIndex,b1(de,M,b,a,p,Y,J));for(const St of qe){const $t=new Vd;$t.text=St[0],$t.sectionIndex=St[1],$t.sections=de.sections,Ie.push($t)}}else Ie=function(qe,St){const $t=[],bt=qe.text;let pt=0;for(const ut of St)$t.push(qe.substring(pt,ut)),pt=ut;return pt<bt.length&&$t.push(qe.substring(pt,bt.length)),$t}(de,b1(de,M,b,a,p,Y,J));const De=[],Xe={positionedLines:De,text:de.toString(),top:B[1],bottom:B[1],left:B[0],right:B[0],writingMode:G,iconsInText:!1,verticalizable:!1};return function(qe,St,$t,bt,pt,ut,xt,yt,rt,jt,Nt,hn){let ar=0,pr=Cy,ai=0,ro=0;const Ri=yt==="right"?1:yt==="left"?0:.5;let Zr=0;for(const Yr of pt){Yr.trim();const Mi=Yr.getMaxScale(),Hi=(Mi-1)*Ti,ss={positionedGlyphs:[],lineOffset:0};qe.positionedLines[Zr]=ss;const xs=ss.positionedGlyphs;let ws=0;if(!Yr.length()){pr+=ut,++Zr;continue}for(let gi=0;gi<Yr.length();gi++){const bn=Yr.getSection(gi),Fs=Yr.getSectionIndex(gi),ki=Yr.getCharCode(gi);let Wi=0,Ro=null,Yo=null,Jo=null,sl=Ti;const $o=!(rt===o.WritingMode.horizontal||!Nt&&!qf(ki)||Nt&&(Ly[ki]||(mi=ki,vt.Arabic(mi)||vt["Arabic Supplement"](mi)||vt["Arabic Extended-A"](mi)||vt["Arabic Presentation Forms-A"](mi)||vt["Arabic Presentation Forms-B"](mi))));if(bn.imageName){const io=bt[bn.imageName];if(!io)continue;Jo=bn.imageName,qe.iconsInText=qe.iconsInText||!0,Yo=io.paddedRect;const Es=io.displaySize;bn.scale=bn.scale*Ti/hn,Ro={width:Es[0],height:Es[1],left:1,top:-3,advance:$o?Es[1]:Es[0]},Wi=Hi+(Ti-Es[1]*bn.scale),sl=Ro.advance;const ol=$o?Es[0]*bn.scale-Ti*Mi:Es[1]*bn.scale-Ti*Mi;ol>0&&ol>ws&&(ws=ol)}else{const io=$t[bn.fontStack],Es=io&&io[ki];if(Es&&Es.rect)Yo=Es.rect,Ro=Es.metrics;else{const ol=St[bn.fontStack],_p=ol&&ol[ki];if(!_p)continue;Ro=_p.metrics}Wi=(Mi-bn.scale)*Ti}$o?(qe.verticalizable=!0,xs.push({glyph:ki,imageName:Jo,x:ar,y:pr+Wi,vertical:$o,scale:bn.scale,fontStack:bn.fontStack,sectionIndex:Fs,metrics:Ro,rect:Yo}),ar+=sl*bn.scale+jt):(xs.push({glyph:ki,imageName:Jo,x:ar,y:pr+Wi,vertical:$o,scale:bn.scale,fontStack:bn.fontStack,sectionIndex:Fs,metrics:Ro,rect:Yo}),ar+=Ro.advance*bn.scale+jt)}xs.length!==0&&(ai=Math.max(ar-jt,ai),BH(xs,0,xs.length-1,Ri,ws)),ar=0;const _r=ut*Mi+ws;ss.lineOffset=Math.max(ws,Hi),pr+=_r,ro=Math.max(_r,ro),++Zr}var mi;const $i=pr-Cy,{horizontalAlign:ji,verticalAlign:bs}=x1(xt);(function(Yr,Mi,Hi,ss,xs,ws,_r,gi,bn){const Fs=(Mi-Hi)*xs;let ki=0;ki=ws!==_r?-gi*ss-Cy:(-ss*bn+.5)*_r;for(const Wi of Yr)for(const Ro of Wi.positionedGlyphs)Ro.x+=Fs,Ro.y+=ki})(qe.positionedLines,Ri,ji,bs,ai,ro,ut,$i,pt.length),qe.top+=-bs*$i,qe.bottom=qe.top+$i,qe.left+=-ji*ai,qe.right=qe.left+ai}(Xe,a,d,p,Ie,E,P,I,G,M,q,fe),!function(qe){for(const St of qe)if(St.positionedGlyphs.length!==0)return!1;return!0}(De)&&Xe}const Ly={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},zH={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function q$(u,a,d,p,_,b){if(a.imageName){const E=p[a.imageName];return E?E.displaySize[0]*a.scale*Ti/b+_:0}{const E=d[a.fontStack],P=E&&E[u];return P?P.metrics.advance*a.scale+_:0}}function X$(u,a,d,p){const _=Math.pow(u-a,2);return p?u<a?_/2:2*_:_+Math.abs(d)*d}function NH(u,a,d){let p=0;return u===10&&(p-=1e4),d&&(p+=150),u!==40&&u!==65288||(p+=50),a!==41&&a!==65289||(p+=50),p}function Z$(u,a,d,p,_,b){let E=null,P=X$(a,d,_,b);for(const I of p){const M=X$(a-I.x,d,_,b)+I.badness;M<=P&&(E=I,P=M)}return{index:u,x:a,priorBreak:E,badness:P}}function Y$(u){return u?Y$(u.priorBreak).concat(u.index):[]}function b1(u,a,d,p,_,b,E){if(b!=="point")return[];if(!u)return[];const P=[],I=function(q,Y,J,fe,de,Ie){let ze=0;for(let Se=0;Se<q.length();Se++){const De=q.getSection(Se);ze+=q$(q.getCharCode(Se),De,fe,de,Y,Ie)}return ze/Math.max(1,Math.ceil(ze/J))}(u,a,d,p,_,E),M=u.text.indexOf("​")>=0;let B=0;for(let q=0;q<u.length();q++){const Y=u.getSection(q),J=u.getCharCode(q);if(Ly[J]||(B+=q$(J,Y,p,_,a,E)),q<u.length()-1){const fe=!((G=J)<11904||!(vt["Bopomofo Extended"](G)||vt.Bopomofo(G)||vt["CJK Compatibility Forms"](G)||vt["CJK Compatibility Ideographs"](G)||vt["CJK Compatibility"](G)||vt["CJK Radicals Supplement"](G)||vt["CJK Strokes"](G)||vt["CJK Symbols and Punctuation"](G)||vt["CJK Unified Ideographs Extension A"](G)||vt["CJK Unified Ideographs"](G)||vt["Enclosed CJK Letters and Months"](G)||vt["Halfwidth and Fullwidth Forms"](G)||vt.Hiragana(G)||vt["Ideographic Description Characters"](G)||vt["Kangxi Radicals"](G)||vt["Katakana Phonetic Extensions"](G)||vt.Katakana(G)||vt["Vertical Forms"](G)||vt["Yi Radicals"](G)||vt["Yi Syllables"](G)));(zH[J]||fe||Y.imageName)&&P.push(Z$(q+1,B,I,P,NH(J,u.getCharCode(q+1),fe&&M),!1))}}var G;return Y$(Z$(u.length(),B,I,P,0,!0))}function x1(u){let a=.5,d=.5;switch(u){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":d=1;break;case"top":case"top-right":case"top-left":d=0}return{horizontalAlign:a,verticalAlign:d}}function BH(u,a,d,p,_){if(!p&&!_)return;const b=u[d],E=(u[d].x+b.metrics.advance*b.scale)*p;for(let P=a;P<=d;P++)u[P].x-=E,u[P].y+=_}function UH(u,a,d){const{horizontalAlign:p,verticalAlign:_}=x1(d),b=a[0]-u.displaySize[0]*p,E=a[1]-u.displaySize[1]*_;return{image:u,top:E,bottom:E+u.displaySize[1],left:b,right:b+u.displaySize[0]}}function J$(u,a,d,p,_,b){const E=u.image;let P;if(E.content){const de=E.content,Ie=E.pixelRatio||1;P=[de[0]/Ie,de[1]/Ie,E.displaySize[0]-de[2]/Ie,E.displaySize[1]-de[3]/Ie]}const I=a.left*b,M=a.right*b;let B,G,q,Y;d==="width"||d==="both"?(Y=_[0]+I-p[3],G=_[0]+M+p[1]):(Y=_[0]+(I+M-E.displaySize[0])/2,G=Y+E.displaySize[0]);const J=a.top*b,fe=a.bottom*b;return d==="height"||d==="both"?(B=_[1]+J-p[0],q=_[1]+fe+p[2]):(B=_[1]+(J+fe-E.displaySize[1])/2,q=B+E.displaySize[1]),{image:E,top:B,right:G,bottom:q,left:Y,collisionPadding:P}}const il=128;function Q$(u,a){const{expression:d}=a;if(d.kind==="constant")return{kind:"constant",layoutSize:d.evaluate(new hr(u+1))};if(d.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:_}=d;let b=0;for(;b<p.length&&p[b]<=u;)b++;b=Math.max(0,b-1);let E=b;for(;E<p.length&&p[E]<u+1;)E++;E=Math.min(p.length-1,E);const P=p[b],I=p[E];return d.kind==="composite"?{kind:"composite",minZoom:P,maxZoom:I,interpolationType:_}:{kind:"camera",minZoom:P,maxZoom:I,minSize:d.evaluate(new hr(P)),maxSize:d.evaluate(new hr(I)),interpolationType:_}}}class sc extends mt{constructor(a,d,p,_){super(a,d),this.angle=p,_!==void 0&&(this.segment=_)}clone(){return new sc(this.x,this.y,this.angle,this.segment)}}function eM(u,a,d,p,_){if(a.segment===void 0)return!0;let b=a,E=a.segment+1,P=0;for(;P>-d/2;){if(E--,E<0)return!1;P-=u[E].dist(b),b=u[E]}P+=u[E].dist(u[E+1]),E++;const I=[];let M=0;for(;P<d/2;){const B=u[E],G=u[E+1];if(!G)return!1;let q=u[E-1].angleTo(B)-B.angleTo(G);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:P,angleDelta:q}),M+=q;P-I[0].distance>p;)M-=I.shift().angleDelta;if(M>_)return!1;E++,P+=B.dist(G)}return!0}function tM(u){let a=0;for(let d=0;d<u.length-1;d++)a+=u[d].dist(u[d+1]);return a}function nM(u,a,d){return u?.6*a*d:0}function rM(u,a){return Math.max(u?u.right-u.left:0,a?a.right-a.left:0)}function VH(u,a,d,p,_,b){const E=nM(d,_,b),P=rM(d,p)*b;let I=0;const M=tM(u)/2;for(let B=0;B<u.length-1;B++){const G=u[B],q=u[B+1],Y=G.dist(q);if(I+Y>M){const J=(M-I)/Y,fe=un(G.x,q.x,J),de=un(G.y,q.y,J),Ie=new sc(fe,de,q.angleTo(G),B);return Ie._round(),!E||eM(u,Ie,P,E,a)?Ie:void 0}I+=Y}}function GH(u,a,d,p,_,b,E,P,I){const M=nM(p,b,E),B=rM(p,_),G=B*E,q=u[0].x===0||u[0].x===I||u[0].y===0||u[0].y===I;return a-G<a/4&&(a=G+a/4),iM(u,q?a/2*P%a:(B/2+2*b)*E*P%a,a,M,d,G,q,!1,I)}function iM(u,a,d,p,_,b,E,P,I){const M=b/2,B=tM(u);let G=0,q=a-d,Y=[];for(let J=0;J<u.length-1;J++){const fe=u[J],de=u[J+1],Ie=fe.dist(de),ze=de.angleTo(fe);for(;q+d<G+Ie;){q+=d;const Se=(q-G)/Ie,De=un(fe.x,de.x,Se),Xe=un(fe.y,de.y,Se);if(De>=0&&De<I&&Xe>=0&&Xe<I&&q-M>=0&&q+M<=B){const qe=new sc(De,Xe,ze,J);qe._round(),p&&!eM(u,qe,b,p,_)||Y.push(qe)}}G+=Ie}return P||Y.length||E||(Y=iM(u,G/2,d,p,_,b,E,!0,I)),Y}function sM(u,a,d,p,_){const b=[];for(let E=0;E<u.length;E++){const P=u[E];let I;for(let M=0;M<P.length-1;M++){let B=P[M],G=P[M+1];B.x<a&&G.x<a||(B.x<a?B=new mt(a,B.y+(a-B.x)/(G.x-B.x)*(G.y-B.y))._round():G.x<a&&(G=new mt(a,B.y+(a-B.x)/(G.x-B.x)*(G.y-B.y))._round()),B.y<d&&G.y<d||(B.y<d?B=new mt(B.x+(d-B.y)/(G.y-B.y)*(G.x-B.x),d)._round():G.y<d&&(G=new mt(B.x+(d-B.y)/(G.y-B.y)*(G.x-B.x),d)._round()),B.x>=p&&G.x>=p||(B.x>=p?B=new mt(p,B.y+(p-B.x)/(G.x-B.x)*(G.y-B.y))._round():G.x>=p&&(G=new mt(p,B.y+(p-B.x)/(G.x-B.x)*(G.y-B.y))._round()),B.y>=_&&G.y>=_||(B.y>=_?B=new mt(B.x+(_-B.y)/(G.y-B.y)*(G.x-B.x),_)._round():G.y>=_&&(G=new mt(B.x+(_-B.y)/(G.y-B.y)*(G.x-B.x),_)._round()),I&&B.equals(I[I.length-1])||(I=[B],b.push(I)),I.push(G)))))}}return b}function oM(u,a,d,p){const _=[],b=u.image,E=b.pixelRatio,P=b.paddedRect.w-2,I=b.paddedRect.h-2,M=u.right-u.left,B=u.bottom-u.top,G=b.stretchX||[[0,P]],q=b.stretchY||[[0,I]],Y=(ut,xt)=>ut+xt[1]-xt[0],J=G.reduce(Y,0),fe=q.reduce(Y,0),de=P-J,Ie=I-fe;let ze=0,Se=J,De=0,Xe=fe,qe=0,St=de,$t=0,bt=Ie;if(b.content&&p){const ut=b.content;ze=Ry(G,0,ut[0]),De=Ry(q,0,ut[1]),Se=Ry(G,ut[0],ut[2]),Xe=Ry(q,ut[1],ut[3]),qe=ut[0]-ze,$t=ut[1]-De,St=ut[2]-ut[0]-Se,bt=ut[3]-ut[1]-Xe}const pt=(ut,xt,yt,rt)=>{const jt=$y(ut.stretch-ze,Se,M,u.left),Nt=My(ut.fixed-qe,St,ut.stretch,J),hn=$y(xt.stretch-De,Xe,B,u.top),ar=My(xt.fixed-$t,bt,xt.stretch,fe),pr=$y(yt.stretch-ze,Se,M,u.left),ai=My(yt.fixed-qe,St,yt.stretch,J),ro=$y(rt.stretch-De,Xe,B,u.top),Ri=My(rt.fixed-$t,bt,rt.stretch,fe),Zr=new mt(jt,hn),mi=new mt(pr,hn),$i=new mt(pr,ro),ji=new mt(jt,ro),bs=new mt(Nt/E,ar/E),Yr=new mt(ai/E,Ri/E),Mi=a*Math.PI/180;if(Mi){const xs=Math.sin(Mi),ws=Math.cos(Mi),_r=[ws,-xs,xs,ws];Zr._matMult(_r),mi._matMult(_r),ji._matMult(_r),$i._matMult(_r)}const Hi=ut.stretch+ut.fixed,ss=xt.stretch+xt.fixed;return{tl:Zr,tr:mi,bl:ji,br:$i,tex:{x:b.paddedRect.x+1+Hi,y:b.paddedRect.y+1+ss,w:yt.stretch+yt.fixed-Hi,h:rt.stretch+rt.fixed-ss},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:bs,pixelOffsetBR:Yr,minFontScaleX:St/E/M,minFontScaleY:bt/E/B,isSDF:d}};if(p&&(b.stretchX||b.stretchY)){const ut=aM(G,de,J),xt=aM(q,Ie,fe);for(let yt=0;yt<ut.length-1;yt++){const rt=ut[yt],jt=ut[yt+1];for(let Nt=0;Nt<xt.length-1;Nt++)_.push(pt(rt,xt[Nt],jt,xt[Nt+1]))}}else _.push(pt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:I+1}));return _}function Ry(u,a,d){let p=0;for(const _ of u)p+=Math.max(a,Math.min(d,_[1]))-Math.max(a,Math.min(d,_[0]));return p}function aM(u,a,d){const p=[{fixed:-1,stretch:0}];for(const[_,b]of u){const E=p[p.length-1];p.push({fixed:_-E.stretch,stretch:E.stretch}),p.push({fixed:_-E.stretch,stretch:E.stretch+(b-_)})}return p.push({fixed:a+1,stretch:d}),p}function $y(u,a,d,p){return u/a*d+p}function My(u,a,d,p){return u-a*d/p}Pt("Anchor",sc);class ky{constructor(a,d,p,_,b,E,P,I,M,B){if(this.boxStartIndex=a.length,M){let G=E.top,q=E.bottom;const Y=E.collisionPadding;Y&&(G-=Y[1],q+=Y[3]);let J=q-G;J>0&&(J=Math.max(10,J),this.circleDiameter=J)}else{let G=E.top*P-I[0],q=E.bottom*P+I[2],Y=E.left*P-I[3],J=E.right*P+I[1];const fe=E.collisionPadding;if(fe&&(Y-=fe[0]*P,G-=fe[1]*P,J+=fe[2]*P,q+=fe[3]*P),B){const de=new mt(Y,G),Ie=new mt(J,G),ze=new mt(Y,q),Se=new mt(J,q),De=B*Math.PI/180;de._rotate(De),Ie._rotate(De),ze._rotate(De),Se._rotate(De),Y=Math.min(de.x,Ie.x,ze.x,Se.x),J=Math.max(de.x,Ie.x,ze.x,Se.x),G=Math.min(de.y,Ie.y,ze.y,Se.y),q=Math.max(de.y,Ie.y,ze.y,Se.y)}a.emplaceBack(d.x,d.y,Y,G,J,q,p,_,b)}this.boxEndIndex=a.length}}class jH{constructor(a=[],d=HH){if(this.data=a,this.length=this.data.length,this.compare=d,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const a=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:d,compare:p}=this,_=d[a];for(;a>0;){const b=a-1>>1,E=d[b];if(p(_,E)>=0)break;d[a]=E,a=b}d[a]=_}_down(a){const{data:d,compare:p}=this,_=this.length>>1,b=d[a];for(;a<_;){let E=1+(a<<1),P=d[E];const I=E+1;if(I<this.length&&p(d[I],P)<0&&(E=I,P=d[I]),p(P,b)>=0)break;d[a]=P,a=E}d[a]=b}}function HH(u,a){return u<a?-1:u>a?1:0}function WH(u,a=1,d=!1){let p=1/0,_=1/0,b=-1/0,E=-1/0;const P=u[0];for(let Y=0;Y<P.length;Y++){const J=P[Y];(!Y||J.x<p)&&(p=J.x),(!Y||J.y<_)&&(_=J.y),(!Y||J.x>b)&&(b=J.x),(!Y||J.y>E)&&(E=J.y)}const I=Math.min(b-p,E-_);let M=I/2;const B=new jH([],KH);if(I===0)return new mt(p,_);for(let Y=p;Y<b;Y+=I)for(let J=_;J<E;J+=I)B.push(new Gd(Y+M,J+M,M,u));let G=function(Y){let J=0,fe=0,de=0;const Ie=Y[0];for(let ze=0,Se=Ie.length,De=Se-1;ze<Se;De=ze++){const Xe=Ie[ze],qe=Ie[De],St=Xe.x*qe.y-qe.x*Xe.y;fe+=(Xe.x+qe.x)*St,de+=(Xe.y+qe.y)*St,J+=3*St}return new Gd(fe/J,de/J,0,Y)}(u),q=B.length;for(;B.length;){const Y=B.pop();(Y.d>G.d||!G.d)&&(G=Y,d&&console.log("found best %d after %d probes",Math.round(1e4*Y.d)/1e4,q)),Y.max-G.d<=a||(M=Y.h/2,B.push(new Gd(Y.p.x-M,Y.p.y-M,M,u)),B.push(new Gd(Y.p.x+M,Y.p.y-M,M,u)),B.push(new Gd(Y.p.x-M,Y.p.y+M,M,u)),B.push(new Gd(Y.p.x+M,Y.p.y+M,M,u)),q+=4)}return d&&(console.log(`num probes: ${q}`),console.log(`best distance: ${G.d}`)),G.p}function KH(u,a){return a.max-u.max}function Gd(u,a,d,p){this.p=new mt(u,a),this.h=d,this.d=function(_,b){let E=!1,P=1/0;for(let I=0;I<b.length;I++){const M=b[I];for(let B=0,G=M.length,q=G-1;B<G;q=B++){const Y=M[B],J=M[q];Y.y>_.y!=J.y>_.y&&_.x<(J.x-Y.x)*(_.y-Y.y)/(J.y-Y.y)+Y.x&&(E=!E),P=Math.min(P,m$(_,Y,J))}}return(E?1:-1)*Math.sqrt(P)}(this.p,p),this.max=this.d+this.h*Math.SQRT2}const w1=Number.POSITIVE_INFINITY;function lM(u,a){return a[1]!==w1?function(d,p,_){let b=0,E=0;switch(p=Math.abs(p),_=Math.abs(_),d){case"top-right":case"top-left":case"top":E=_-7;break;case"bottom-right":case"bottom-left":case"bottom":E=7-_}switch(d){case"top-right":case"bottom-right":case"right":b=-p;break;case"top-left":case"bottom-left":case"left":b=p}return[b,E]}(u,a[0],a[1]):function(d,p){let _=0,b=0;p<0&&(p=0);const E=p/Math.sqrt(2);switch(d){case"top-right":case"top-left":b=E-7;break;case"bottom-right":case"bottom-left":b=7-E;break;case"bottom":b=7-p;break;case"top":b=p-7}switch(d){case"top-right":case"bottom-right":_=-E;break;case"top-left":case"bottom-left":_=E;break;case"left":_=p;break;case"right":_=-p}return[_,b]}(u,a[0])}function E1(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function qH(u,a,d,p,_,b,E,P,I,M,B){let G=b.textMaxSize.evaluate(a,{});G===void 0&&(G=E);const q=u.layers[0].layout,Y=q.get("icon-offset").evaluate(a,{},B),J=uM(d.horizontal),fe=E/24,de=u.tilePixelRatio*fe,Ie=u.tilePixelRatio*G/24,ze=u.tilePixelRatio*P,Se=u.tilePixelRatio*q.get("symbol-spacing"),De=q.get("text-padding")*u.tilePixelRatio,Xe=function(rt,jt,Nt,hn=1){const ar=rt.get("icon-padding").evaluate(jt,{},Nt),pr=ar&&ar.values;return[pr[0]*hn,pr[1]*hn,pr[2]*hn,pr[3]*hn]}(q,a,B,u.tilePixelRatio),qe=q.get("text-max-angle")/180*Math.PI,St=q.get("text-rotation-alignment")!=="viewport"&&q.get("symbol-placement")!=="point",$t=q.get("icon-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",bt=q.get("symbol-placement"),pt=Se/2,ut=q.get("icon-text-fit");let xt;p&&ut!=="none"&&(u.allowVerticalPlacement&&d.vertical&&(xt=J$(p,d.vertical,ut,q.get("icon-text-fit-padding"),Y,fe)),J&&(p=J$(p,J,ut,q.get("icon-text-fit-padding"),Y,fe)));const yt=(rt,jt)=>{jt.x<0||jt.x>=oi||jt.y<0||jt.y>=oi||function(Nt,hn,ar,pr,ai,ro,Ri,Zr,mi,$i,ji,bs,Yr,Mi,Hi,ss,xs,ws,_r,gi,bn,Fs,ki,Wi,Ro){const Yo=Nt.addToLineVertexArray(hn,ar);let Jo,sl,$o,io,Es=0,ol=0,_p=0,AM=0,M1=-1,k1=-1;const al={};let PM=pi.exports(""),O1=0,D1=0;if(Zr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[O1,D1]=Zr.layout.get("text-offset").evaluate(bn,{},Wi).map(Ts=>Ts*Ti):(O1=Zr.layout.get("text-radial-offset").evaluate(bn,{},Wi)*Ti,D1=w1),Nt.allowVerticalPlacement&&pr.vertical){const Ts=Zr.layout.get("text-rotate").evaluate(bn,{},Wi)+90;$o=new ky(mi,hn,$i,ji,bs,pr.vertical,Yr,Mi,Hi,Ts),Ri&&(io=new ky(mi,hn,$i,ji,bs,Ri,xs,ws,Hi,Ts))}if(ai){const Ts=Zr.layout.get("icon-rotate").evaluate(bn,{}),Pa=Zr.layout.get("icon-text-fit")!=="none",vp=oM(ai,Ts,ki,Pa),bp=Ri?oM(Ri,Ts,ki,Pa):void 0;sl=new ky(mi,hn,$i,ji,bs,ai,xs,ws,!1,Ts),Es=4*vp.length;const LM=Nt.iconSizeData;let wu=null;LM.kind==="source"?(wu=[il*Zr.layout.get("icon-size").evaluate(bn,{})],wu[0]>oc&&ie(`${Nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):LM.kind==="composite"&&(wu=[il*Fs.compositeIconSizes[0].evaluate(bn,{},Wi),il*Fs.compositeIconSizes[1].evaluate(bn,{},Wi)],(wu[0]>oc||wu[1]>oc)&&ie(`${Nt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Nt.addSymbols(Nt.icon,vp,wu,gi,_r,bn,o.WritingMode.none,hn,Yo.lineStartIndex,Yo.lineLength,-1,Wi),M1=Nt.icon.placedSymbolArray.length-1,bp&&(ol=4*bp.length,Nt.addSymbols(Nt.icon,bp,wu,gi,_r,bn,o.WritingMode.vertical,hn,Yo.lineStartIndex,Yo.lineLength,-1,Wi),k1=Nt.icon.placedSymbolArray.length-1)}const CM=Object.keys(pr.horizontal);for(const Ts of CM){const Pa=pr.horizontal[Ts];if(!Jo){PM=pi.exports(Pa.text);const bp=Zr.layout.get("text-rotate").evaluate(bn,{},Wi);Jo=new ky(mi,hn,$i,ji,bs,Pa,Yr,Mi,Hi,bp)}const vp=Pa.positionedLines.length===1;if(_p+=cM(Nt,hn,Pa,ro,Zr,Hi,bn,ss,Yo,pr.vertical?o.WritingMode.horizontal:o.WritingMode.horizontalOnly,vp?CM:[Ts],al,M1,Fs,Wi),vp)break}pr.vertical&&(AM+=cM(Nt,hn,pr.vertical,ro,Zr,Hi,bn,ss,Yo,o.WritingMode.vertical,["vertical"],al,k1,Fs,Wi));const aW=Jo?Jo.boxStartIndex:Nt.collisionBoxArray.length,lW=Jo?Jo.boxEndIndex:Nt.collisionBoxArray.length,cW=$o?$o.boxStartIndex:Nt.collisionBoxArray.length,uW=$o?$o.boxEndIndex:Nt.collisionBoxArray.length,dW=sl?sl.boxStartIndex:Nt.collisionBoxArray.length,hW=sl?sl.boxEndIndex:Nt.collisionBoxArray.length,fW=io?io.boxStartIndex:Nt.collisionBoxArray.length,pW=io?io.boxEndIndex:Nt.collisionBoxArray.length;let Qo=-1;const Ny=(Ts,Pa)=>Ts&&Ts.circleDiameter?Math.max(Ts.circleDiameter,Pa):Pa;Qo=Ny(Jo,Qo),Qo=Ny($o,Qo),Qo=Ny(sl,Qo),Qo=Ny(io,Qo);const IM=Qo>-1?1:0;IM&&(Qo*=Ro/Ti),Nt.glyphOffsetArray.length>=jd.MAX_GLYPHS&&ie("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),bn.sortKey!==void 0&&Nt.addToSortKeyRanges(Nt.symbolInstances.length,bn.sortKey),Nt.symbolInstances.emplaceBack(hn.x,hn.y,al.right>=0?al.right:-1,al.center>=0?al.center:-1,al.left>=0?al.left:-1,al.vertical||-1,M1,k1,PM,aW,lW,cW,uW,dW,hW,fW,pW,$i,_p,AM,Es,ol,IM,0,Yr,O1,D1,Qo)}(u,jt,rt,d,p,_,xt,u.layers[0],u.collisionBoxArray,a.index,a.sourceLayerIndex,u.index,de,[De,De,De,De],St,I,ze,Xe,$t,Y,a,b,M,B,E)};if(bt==="line")for(const rt of sM(a.geometry,0,0,oi,oi)){const jt=GH(rt,Se,qe,d.vertical||J,p,24,Ie,u.overscaling,oi);for(const Nt of jt){const hn=J;hn&&XH(u,hn.text,pt,Nt)||yt(rt,Nt)}}else if(bt==="line-center"){for(const rt of a.geometry)if(rt.length>1){const jt=VH(rt,qe,d.vertical||J,p,24,Ie);jt&&yt(rt,jt)}}else if(a.type==="Polygon")for(const rt of u1(a.geometry,0)){const jt=WH(rt,16);yt(rt[0],new sc(jt.x,jt.y,0))}else if(a.type==="LineString")for(const rt of a.geometry)yt(rt,new sc(rt[0].x,rt[0].y,0));else if(a.type==="Point")for(const rt of a.geometry)for(const jt of rt)yt([jt],new sc(jt.x,jt.y,0))}const oc=32640;function cM(u,a,d,p,_,b,E,P,I,M,B,G,q,Y,J){const fe=function(ze,Se,De,Xe,qe,St,$t,bt){const pt=Xe.layout.get("text-rotate").evaluate(St,{})*Math.PI/180,ut=[];for(const xt of Se.positionedLines)for(const yt of xt.positionedGlyphs){if(!yt.rect)continue;const rt=yt.rect||{};let jt=4,Nt=!0,hn=1,ar=0;const pr=(qe||bt)&&yt.vertical,ai=yt.metrics.advance*yt.scale/2;if(bt&&Se.verticalizable){const _r=(yt.scale-1)*Ti,gi=(Ti-yt.metrics.width*yt.scale)/2;ar=xt.lineOffset/2-(yt.imageName?-gi:_r)}if(yt.imageName){const _r=$t[yt.imageName];Nt=_r.sdf,hn=_r.pixelRatio,jt=1/hn}const ro=qe?[yt.x+ai,yt.y]:[0,0];let Ri=qe?[0,0]:[yt.x+ai+De[0],yt.y+De[1]-ar],Zr=[0,0];pr&&(Zr=Ri,Ri=[0,0]);const mi=(yt.metrics.left-jt)*yt.scale-ai+Ri[0],$i=(-yt.metrics.top-jt)*yt.scale+Ri[1],ji=mi+rt.w*yt.scale/hn,bs=$i+rt.h*yt.scale/hn,Yr=new mt(mi,$i),Mi=new mt(ji,$i),Hi=new mt(mi,bs),ss=new mt(ji,bs);if(pr){const _r=new mt(-ai,ai-Cy),gi=-Math.PI/2,bn=12-ai,Fs=new mt(22-bn,-(yt.imageName?bn:0)),ki=new mt(...Zr);Yr._rotateAround(gi,_r)._add(Fs)._add(ki),Mi._rotateAround(gi,_r)._add(Fs)._add(ki),Hi._rotateAround(gi,_r)._add(Fs)._add(ki),ss._rotateAround(gi,_r)._add(Fs)._add(ki)}if(pt){const _r=Math.sin(pt),gi=Math.cos(pt),bn=[gi,-_r,_r,gi];Yr._matMult(bn),Mi._matMult(bn),Hi._matMult(bn),ss._matMult(bn)}const xs=new mt(0,0),ws=new mt(0,0);ut.push({tl:Yr,tr:Mi,bl:Hi,br:ss,tex:rt,writingMode:Se.writingMode,glyphOffset:ro,sectionIndex:yt.sectionIndex,isSDF:Nt,pixelOffsetTL:xs,pixelOffsetBR:ws,minFontScaleX:0,minFontScaleY:0})}return ut}(0,d,P,_,b,E,p,u.allowVerticalPlacement),de=u.textSizeData;let Ie=null;de.kind==="source"?(Ie=[il*_.layout.get("text-size").evaluate(E,{})],Ie[0]>oc&&ie(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):de.kind==="composite"&&(Ie=[il*Y.compositeTextSizes[0].evaluate(E,{},J),il*Y.compositeTextSizes[1].evaluate(E,{},J)],(Ie[0]>oc||Ie[1]>oc)&&ie(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),u.addSymbols(u.text,fe,Ie,P,b,E,M,a,I.lineStartIndex,I.lineLength,q,J);for(const ze of B)G[ze]=u.text.placedSymbolArray.length-1;return 4*fe.length}function uM(u){for(const a in u)return u[a];return null}function XH(u,a,d,p){const _=u.compareText;if(a in _){const b=_[a];for(let E=b.length-1;E>=0;E--)if(p.dist(b[E])<d)return!0}else _[a]=[];return _[a].push(p),!1}const ZH=rc.VectorTileFeature.types,YH=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Oy(u,a,d,p,_,b,E,P,I,M,B,G,q){const Y=P?Math.min(oc,Math.round(P[0])):0,J=P?Math.min(oc,Math.round(P[1])):0;u.emplaceBack(a,d,Math.round(32*p),Math.round(32*_),b,E,(Y<<1)+(I?1:0),J,16*M,16*B,256*G,256*q)}function T1(u,a,d){u.emplaceBack(a.x,a.y,d),u.emplaceBack(a.x,a.y,d),u.emplaceBack(a.x,a.y,d),u.emplaceBack(a.x,a.y,d)}function JH(u){for(const a of u.sections)if(uy(a.text))return!0;return!1}class S1{constructor(a){this.layoutVertexArray=new Io,this.indexArray=new ns,this.programConfigurations=a,this.segments=new yn,this.dynamicLayoutVertexArray=new eo,this.opacityVertexArray=new Lo,this.placedSymbolArray=new et}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,d,p,_){this.isEmpty()||(p&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,xH.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,wH.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,YH,!0),this.opacityVertexBuffer.itemSize=1),(p||_)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Pt("SymbolBuffers",S1);class A1{constructor(a,d,p){this.layoutVertexArray=new a,this.layoutAttributes=d,this.indexArray=new p,this.segments=new yn,this.collisionVertexArray=new Os}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,EH.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Pt("CollisionBuffers",A1);class jd{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(E=>E.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=i1([]),this.placementViewportMatrix=i1([]);const d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Q$(this.zoom,d["text-size"]),this.iconSizeData=Q$(this.zoom,d["icon-size"]);const p=this.layers[0].layout,_=p.get("symbol-sort-key"),b=p.get("symbol-z-order");this.canOverlap=C1(p,"text-overlap","text-allow-overlap")!=="never"||C1(p,"icon-overlap","icon-allow-overlap")!=="never"||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,p.get("symbol-placement")==="point"&&(this.writingModes=p.get("text-writing-mode").map(E=>o.WritingMode[E])),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=a.sourceID}createArrays(){this.text=new S1(new yu(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new S1(new yu(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new ft,this.lineVertexArray=new Tt,this.symbolInstances=new wt}calculateGlyphDependencies(a,d,p,_,b){for(let E=0;E<a.length;E++)if(d[a.charCodeAt(E)]=!0,(p||_)&&b){const P=pp[a.charAt(E)];P&&(d[P.charCodeAt(0)]=!0)}}populate(a,d,p){const _=this.layers[0],b=_.layout,E=b.get("text-font"),P=b.get("text-field"),I=b.get("icon-image"),M=(P.value.kind!=="constant"||P.value.value instanceof ye&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),B=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,G=b.get("symbol-sort-key");if(this.features=[],!M&&!B)return;const q=d.iconDependencies,Y=d.glyphDependencies,J=d.availableImages,fe=new hr(this.zoom);for(const{feature:de,id:Ie,index:ze,sourceLayerIndex:Se}of a){const De=_._featureFilter.needGeometry,Xe=vu(de,De);if(!_._featureFilter.filter(fe,Xe,p))continue;let qe,St;if(De||(Xe.geometry=_u(de)),M){const bt=_.getValueAndResolveTokens("text-field",Xe,p,J),pt=ye.factory(bt);JH(pt)&&(this.hasRTLText=!0),(!this.hasRTLText||pu()==="unavailable"||this.hasRTLText&&ks.isParsed())&&(qe=SH(pt,_,Xe))}if(B){const bt=_.getValueAndResolveTokens("icon-image",Xe,p,J);St=bt instanceof xe?bt:xe.fromString(bt)}if(!qe&&!St)continue;const $t=this.sortFeaturesByKey?G.evaluate(Xe,{},p):void 0;if(this.features.push({id:Ie,text:qe,icon:St,index:ze,sourceLayerIndex:Se,geometry:Xe.geometry,properties:de.properties,type:ZH[de.type],sortKey:$t}),St&&(q[St.name]=!0),qe){const bt=E.evaluate(Xe,{},p).join(","),pt=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(o.WritingMode.vertical)>=0;for(const ut of qe.sections)if(ut.image)q[ut.image.name]=!0;else{const xt=$d(qe.toString()),yt=ut.fontStack||bt,rt=Y[yt]=Y[yt]||{};this.calculateGlyphDependencies(ut.text,rt,pt,this.allowVerticalPlacement,xt)}}}b.get("symbol-placement")==="line"&&(this.features=function(de){const Ie={},ze={},Se=[];let De=0;function Xe(bt){Se.push(de[bt]),De++}function qe(bt,pt,ut){const xt=ze[bt];return delete ze[bt],ze[pt]=xt,Se[xt].geometry[0].pop(),Se[xt].geometry[0]=Se[xt].geometry[0].concat(ut[0]),xt}function St(bt,pt,ut){const xt=Ie[pt];return delete Ie[pt],Ie[bt]=xt,Se[xt].geometry[0].shift(),Se[xt].geometry[0]=ut[0].concat(Se[xt].geometry[0]),xt}function $t(bt,pt,ut){const xt=ut?pt[0][pt[0].length-1]:pt[0][0];return`${bt}:${xt.x}:${xt.y}`}for(let bt=0;bt<de.length;bt++){const pt=de[bt],ut=pt.geometry,xt=pt.text?pt.text.toString():null;if(!xt){Xe(bt);continue}const yt=$t(xt,ut),rt=$t(xt,ut,!0);if(yt in ze&&rt in Ie&&ze[yt]!==Ie[rt]){const jt=St(yt,rt,ut),Nt=qe(yt,rt,Se[jt].geometry);delete Ie[yt],delete ze[rt],ze[$t(xt,Se[Nt].geometry,!0)]=Nt,Se[jt].geometry=null}else yt in ze?qe(yt,rt,ut):rt in Ie?St(yt,rt,ut):(Xe(bt),Ie[yt]=De-1,ze[rt]=De-1)}return Se.filter(bt=>bt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((de,Ie)=>de.sortKey-Ie.sortKey)}update(a,d,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,d,this.layers,p),this.icon.programConfigurations.updatePaintArrays(a,d,this.layers,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,d){const p=this.lineVertexArray.length;if(a.segment!==void 0){let _=a.dist(d[a.segment+1]),b=a.dist(d[a.segment]);const E={};for(let P=a.segment+1;P<d.length;P++)E[P]={x:d[P].x,y:d[P].y,tileUnitDistanceFromAnchor:_},P<d.length-1&&(_+=d[P+1].dist(d[P]));for(let P=a.segment||0;P>=0;P--)E[P]={x:d[P].x,y:d[P].y,tileUnitDistanceFromAnchor:b},P>0&&(b+=d[P-1].dist(d[P]));for(let P=0;P<d.length;P++){const I=E[P];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(a,d,p,_,b,E,P,I,M,B,G,q){const Y=a.indexArray,J=a.layoutVertexArray,fe=a.segments.prepareSegment(4*d.length,J,Y,this.canOverlap?E.sortKey:void 0),de=this.glyphOffsetArray.length,Ie=fe.vertexLength,ze=this.allowVerticalPlacement&&P===o.WritingMode.vertical?Math.PI/2:0,Se=E.text&&E.text.sections;for(let De=0;De<d.length;De++){const{tl:Xe,tr:qe,bl:St,br:$t,tex:bt,pixelOffsetTL:pt,pixelOffsetBR:ut,minFontScaleX:xt,minFontScaleY:yt,glyphOffset:rt,isSDF:jt,sectionIndex:Nt}=d[De],hn=fe.vertexLength,ar=rt[1];Oy(J,I.x,I.y,Xe.x,ar+Xe.y,bt.x,bt.y,p,jt,pt.x,pt.y,xt,yt),Oy(J,I.x,I.y,qe.x,ar+qe.y,bt.x+bt.w,bt.y,p,jt,ut.x,pt.y,xt,yt),Oy(J,I.x,I.y,St.x,ar+St.y,bt.x,bt.y+bt.h,p,jt,pt.x,ut.y,xt,yt),Oy(J,I.x,I.y,$t.x,ar+$t.y,bt.x+bt.w,bt.y+bt.h,p,jt,ut.x,ut.y,xt,yt),T1(a.dynamicLayoutVertexArray,I,ze),Y.emplaceBack(hn,hn+1,hn+2),Y.emplaceBack(hn+1,hn+2,hn+3),fe.vertexLength+=4,fe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(rt[0]),De!==d.length-1&&Nt===d[De+1].sectionIndex||a.programConfigurations.populatePaintArrays(J.length,E,E.index,{},q,Se&&Se[Nt])}a.placedSymbolArray.emplaceBack(I.x,I.y,de,this.glyphOffsetArray.length-de,Ie,M,B,I.segment,p?p[0]:0,p?p[1]:0,_[0],_[1],P,0,!1,0,G)}_addCollisionDebugVertex(a,d,p,_,b,E){return d.emplaceBack(0,0),a.emplaceBack(p.x,p.y,_,b,Math.round(E.x),Math.round(E.y))}addCollisionDebugVertices(a,d,p,_,b,E,P){const I=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),M=I.vertexLength,B=b.layoutVertexArray,G=b.collisionVertexArray,q=P.anchorX,Y=P.anchorY;this._addCollisionDebugVertex(B,G,E,q,Y,new mt(a,d)),this._addCollisionDebugVertex(B,G,E,q,Y,new mt(p,d)),this._addCollisionDebugVertex(B,G,E,q,Y,new mt(p,_)),this._addCollisionDebugVertex(B,G,E,q,Y,new mt(a,_)),I.vertexLength+=4;const J=b.indexArray;J.emplaceBack(M,M+1),J.emplaceBack(M+1,M+2),J.emplaceBack(M+2,M+3),J.emplaceBack(M+3,M),I.primitiveLength+=4}addDebugCollisionBoxes(a,d,p,_){for(let b=a;b<d;b++){const E=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(E.x1,E.y1,E.x2,E.y2,_?this.textCollisionBox:this.iconCollisionBox,E.anchorPoint,p)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new A1(Sa,N$.members,Xo),this.iconCollisionBox=new A1(Sa,N$.members,Xo);for(let a=0;a<this.symbolInstances.length;a++){const d=this.symbolInstances.get(a);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}}_deserializeCollisionBoxesForSymbol(a,d,p,_,b,E,P,I,M){const B={};for(let G=d;G<p;G++){const q=a.get(G);B.textBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},B.textFeatureIndex=q.featureIndex;break}for(let G=_;G<b;G++){const q=a.get(G);B.verticalTextBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},B.verticalTextFeatureIndex=q.featureIndex;break}for(let G=E;G<P;G++){const q=a.get(G);B.iconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},B.iconFeatureIndex=q.featureIndex;break}for(let G=I;G<M;G++){const q=a.get(G);B.verticalIconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},B.verticalIconFeatureIndex=q.featureIndex;break}return B}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let d=0;d<this.symbolInstances.length;d++){const p=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,d){const p=a.placedSymbolArray.get(d),_=p.vertexStartIndex+4*p.numGlyphs;for(let b=p.vertexStartIndex;b<_;b+=4)a.indexArray.emplaceBack(b,b+1,b+2),a.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const d=Math.sin(a),p=Math.cos(a),_=[],b=[],E=[];for(let P=0;P<this.symbolInstances.length;++P){E.push(P);const I=this.symbolInstances.get(P);_.push(0|Math.round(d*I.anchorX+p*I.anchorY)),b.push(I.featureIndex)}return E.sort((P,I)=>_[P]-_[I]||b[I]-b[P]),E}addToSortKeyRanges(a,d){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===d?p.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const d of this.symbolInstanceIndexes){const p=this.symbolInstances.get(d);this.featureSortOrder.push(p.featureIndex),[p.rightJustifiedTextSymbolIndex,p.centerJustifiedTextSymbolIndex,p.leftJustifiedTextSymbolIndex].forEach((_,b,E)=>{_>=0&&E.indexOf(_)===b&&this.addIndicesForPlacedSymbol(this.text,_)}),p.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,p.verticalPlacedTextSymbolIndex),p.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.placedIconSymbolIndex),p.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,p.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Pt("SymbolBucket",jd,{omit:["layers","collisionBoxArray","features","compareText"]}),jd.MAX_GLYPHS=65535,jd.addDynamicAttributes=T1;const QH=new Ei({"symbol-placement":new Ft(je.layout_symbol["symbol-placement"]),"symbol-spacing":new Ft(je.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ft(je.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new qt(je.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ft(je.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ft(je.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ft(je.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ft(je.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ft(je.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ft(je.layout_symbol["icon-rotation-alignment"]),"icon-size":new qt(je.layout_symbol["icon-size"]),"icon-text-fit":new Ft(je.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ft(je.layout_symbol["icon-text-fit-padding"]),"icon-image":new qt(je.layout_symbol["icon-image"]),"icon-rotate":new qt(je.layout_symbol["icon-rotate"]),"icon-padding":new qt(je.layout_symbol["icon-padding"]),"icon-keep-upright":new Ft(je.layout_symbol["icon-keep-upright"]),"icon-offset":new qt(je.layout_symbol["icon-offset"]),"icon-anchor":new qt(je.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ft(je.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ft(je.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ft(je.layout_symbol["text-rotation-alignment"]),"text-field":new qt(je.layout_symbol["text-field"]),"text-font":new qt(je.layout_symbol["text-font"]),"text-size":new qt(je.layout_symbol["text-size"]),"text-max-width":new qt(je.layout_symbol["text-max-width"]),"text-line-height":new Ft(je.layout_symbol["text-line-height"]),"text-letter-spacing":new qt(je.layout_symbol["text-letter-spacing"]),"text-justify":new qt(je.layout_symbol["text-justify"]),"text-radial-offset":new qt(je.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ft(je.layout_symbol["text-variable-anchor"]),"text-anchor":new qt(je.layout_symbol["text-anchor"]),"text-max-angle":new Ft(je.layout_symbol["text-max-angle"]),"text-writing-mode":new Ft(je.layout_symbol["text-writing-mode"]),"text-rotate":new qt(je.layout_symbol["text-rotate"]),"text-padding":new Ft(je.layout_symbol["text-padding"]),"text-keep-upright":new Ft(je.layout_symbol["text-keep-upright"]),"text-transform":new qt(je.layout_symbol["text-transform"]),"text-offset":new qt(je.layout_symbol["text-offset"]),"text-allow-overlap":new Ft(je.layout_symbol["text-allow-overlap"]),"text-overlap":new Ft(je.layout_symbol["text-overlap"]),"text-ignore-placement":new Ft(je.layout_symbol["text-ignore-placement"]),"text-optional":new Ft(je.layout_symbol["text-optional"])});var P1={paint:new Ei({"icon-opacity":new qt(je.paint_symbol["icon-opacity"]),"icon-color":new qt(je.paint_symbol["icon-color"]),"icon-halo-color":new qt(je.paint_symbol["icon-halo-color"]),"icon-halo-width":new qt(je.paint_symbol["icon-halo-width"]),"icon-halo-blur":new qt(je.paint_symbol["icon-halo-blur"]),"icon-translate":new Ft(je.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ft(je.paint_symbol["icon-translate-anchor"]),"text-opacity":new qt(je.paint_symbol["text-opacity"]),"text-color":new qt(je.paint_symbol["text-color"],{runtimeType:gt,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new qt(je.paint_symbol["text-halo-color"]),"text-halo-width":new qt(je.paint_symbol["text-halo-width"]),"text-halo-blur":new qt(je.paint_symbol["text-halo-blur"]),"text-translate":new Ft(je.paint_symbol["text-translate"]),"text-translate-anchor":new Ft(je.paint_symbol["text-translate-anchor"])}),layout:QH};class dM{constructor(a){if(a.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=a.property.overrides?a.property.overrides.runtimeType:Ae,this.defaultValue=a}evaluate(a){if(a.formattedSection){const d=this.defaultValue.property.overrides;if(d&&d.hasOverride(a.formattedSection))return d.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Pt("FormatSectionOverride",dM,{omit:["defaultValue"]});class Dy extends Co{constructor(a){super(a,P1)}recalculate(a,d){if(super.recalculate(a,d),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const p=this.layout.get("text-writing-mode");if(p){const _=[];for(const b of p)_.indexOf(b)<0&&_.push(b);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(a,d,p,_){const b=this.layout.get(a).evaluate(d,{},p,_),E=this._unevaluatedLayout._values[a];return E.isDataDriven()||tu(E.value)||!b?b:function(P,I){return I.replace(/{([^{}]+)}/g,(M,B)=>B in P?String(P[B]):"")}(d.properties,b)}createBucket(a){return new jd(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const a of P1.paint.overridableProperties){if(!Dy.hasPaintOverride(this.layout,a))continue;const d=this.paint.get(a),p=new dM(d),_=new Ad(p,d.property.specification);let b=null;b=d.value.kind==="constant"||d.value.kind==="source"?new ru("source",_):new Vf("composite",_,d.value.zoomStops),this.paint._values[a]=new Po(d.property,b,d.parameters)}}_handleOverridablePaintPropertyUpdate(a,d,p){return!(!this.layout||d.isDataDriven()||p.isDataDriven())&&Dy.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,d){const p=a.get("text-field"),_=P1.paint.properties[d];let b=!1;const E=P=>{for(const I of P)if(_.overrides&&_.overrides.hasOverride(I))return void(b=!0)};if(p.value.kind==="constant"&&p.value.value instanceof ye)E(p.value.value.sections);else if(p.value.kind==="source"){const P=M=>{b||(M instanceof Rt&&Ue(M.value)===Wt?E(M.value.sections):M instanceof Td?E(M.sections):M.eachChild(P))},I=p.value;I._styleExpression&&P(I._styleExpression.expression)}return b}}function C1(u,a,d){let p="never";const _=u.get(a);return _?p=_:u.get(d)&&(p="always"),p}var eW={paint:new Ei({"background-color":new Ft(je.paint_background["background-color"]),"background-pattern":new ep(je.paint_background["background-pattern"]),"background-opacity":new Ft(je.paint_background["background-opacity"])})},tW={paint:new Ei({"raster-opacity":new Ft(je.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ft(je.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ft(je.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ft(je.paint_raster["raster-brightness-max"]),"raster-saturation":new Ft(je.paint_raster["raster-saturation"]),"raster-contrast":new Ft(je.paint_raster["raster-contrast"]),"raster-resampling":new Ft(je.paint_raster["raster-resampling"]),"raster-fade-duration":new Ft(je.paint_raster["raster-fade-duration"])})};class nW extends Co{constructor(a){super(a,{}),this.onAdd=d=>{this.implementation.onAdd&&this.implementation.onAdd(d,d.painter.context.gl)},this.onRemove=d=>{this.implementation.onRemove&&this.implementation.onRemove(d,d.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const rW={circle:class extends Co{constructor(u){super(u,kj)}createBucket(u){return new t1(u)}queryRadius(u){const a=u;return sp("circle-radius",this,a)+sp("circle-stroke-width",this,a)+vy(this.paint.get("circle-translate"))}queryIntersectsFeature(u,a,d,p,_,b,E,P){const I=by(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,E),M=this.paint.get("circle-radius").evaluate(a,d)+this.paint.get("circle-stroke-width").evaluate(a,d),B=this.paint.get("circle-pitch-alignment")==="map",G=B?I:function(Y,J){return Y.map(fe=>w$(fe,J))}(I,P),q=B?M*E:M;for(const Y of p)for(const J of Y){const fe=B?J:w$(J,P);let de=q;const Ie=xy([],[J.x,J.y,0,1],P);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?de*=Ie[3]/b.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(de*=b.cameraToCenterDistance/Ie[3]),Ij(G,fe,de))return!0}return!1}},heatmap:class extends Co{constructor(u){super(u,Dj),this._updateColorRamp()}createBucket(u){return new E$(u)}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=S$({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Co{constructor(u){super(u,Fj)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Co{constructor(u){super(u,Qj)}recalculate(u,a){super.recalculate(u,a);const d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new f1(u)}queryRadius(){return vy(this.paint.get("fill-translate"))}queryIntersectsFeature(u,a,d,p,_,b,E){return p$(by(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,E),p)}isTileClipped(){return!0}},"fill-extrusion":class extends Co{constructor(u){super(u,fH)}createBucket(u){return new m1(u)}queryRadius(){return vy(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(u,a,d,p,_,b,E,P){const I=by(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,E),M=this.paint.get("fill-extrusion-height").evaluate(a,d),B=this.paint.get("fill-extrusion-base").evaluate(a,d),G=function(Y,J,fe,de){const Ie=[];for(const ze of Y){const Se=[ze.x,ze.y,0,1];xy(Se,Se,J),Ie.push(new mt(Se[0]/Se[3],Se[1]/Se[3]))}return Ie}(I,P),q=function(Y,J,fe,de){const Ie=[],ze=[],Se=de[8]*J,De=de[9]*J,Xe=de[10]*J,qe=de[11]*J,St=de[8]*fe,$t=de[9]*fe,bt=de[10]*fe,pt=de[11]*fe;for(const ut of Y){const xt=[],yt=[];for(const rt of ut){const jt=rt.x,Nt=rt.y,hn=de[0]*jt+de[4]*Nt+de[12],ar=de[1]*jt+de[5]*Nt+de[13],pr=de[2]*jt+de[6]*Nt+de[14],ai=de[3]*jt+de[7]*Nt+de[15],ro=pr+Xe,Ri=ai+qe,Zr=hn+St,mi=ar+$t,$i=pr+bt,ji=ai+pt,bs=new mt((hn+Se)/Ri,(ar+De)/Ri);bs.z=ro/Ri,xt.push(bs);const Yr=new mt(Zr/ji,mi/ji);Yr.z=$i/ji,yt.push(Yr)}Ie.push(xt),ze.push(yt)}return[Ie,ze]}(p,B,M,P);return function(Y,J,fe){let de=1/0;p$(fe,J)&&(de=k$(fe,J[0]));for(let Ie=0;Ie<J.length;Ie++){const ze=J[Ie],Se=Y[Ie];for(let De=0;De<ze.length-1;De++){const Xe=ze[De],qe=[Xe,ze[De+1],Se[De+1],Se[De],Xe];f$(fe,qe)&&(de=Math.min(de,k$(fe,qe)))}}return de!==1/0&&de}(q[0],q[1],G)}},line:class extends Co{constructor(u){super(u,D$),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(u){u==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof yr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(u,a){super.recalculate(u,a),this.paint._values["line-floorwidth"]=F$.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new g1(u)}queryRadius(u){const a=u,d=z$(sp("line-width",this,a),sp("line-gap-width",this,a)),p=sp("line-offset",this,a);return d/2+Math.abs(p)+vy(this.paint.get("line-translate"))}queryIntersectsFeature(u,a,d,p,_,b,E){const P=by(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,E),I=E/2*z$(this.paint.get("line-width").evaluate(a,d),this.paint.get("line-gap-width").evaluate(a,d)),M=this.paint.get("line-offset").evaluate(a,d);return M&&(p=function(B,G){const q=[];for(let Y=0;Y<B.length;Y++){const J=B[Y],fe=[];for(let de=0;de<J.length;de++){const Ie=J[de-1],ze=J[de],Se=J[de+1],De=de===0?new mt(0,0):ze.sub(Ie)._unit()._perp(),Xe=de===J.length-1?new mt(0,0):Se.sub(ze)._unit()._perp(),qe=De._add(Xe)._unit(),St=qe.x*Xe.x+qe.y*Xe.y;St!==0&&qe._mult(1/St),fe.push(qe._mult(G)._add(ze))}q.push(fe)}return q}(p,M*E)),function(B,G,q){for(let Y=0;Y<G.length;Y++){const J=G[Y];if(B.length>=3){for(let fe=0;fe<J.length;fe++)if(Fd(B,J[fe]))return!0}if(Lj(B,J,q))return!0}return!1}(P,p,I)}isTileClipped(){return!0}},symbol:Dy,background:class extends Co{constructor(u){super(u,eW)}},raster:class extends Co{constructor(u){super(u,tW)}}};class iW{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const hM=63710088e-1;class Or{constructor(a,d){if(isNaN(a)||isNaN(d))throw new Error(`Invalid LngLat object: (${a}, ${d})`);if(this.lng=+a,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Or(C(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const d=Math.PI/180,p=this.lat*d,_=a.lat*d,b=Math.sin(p)*Math.sin(_)+Math.cos(p)*Math.cos(_)*Math.cos((a.lng-this.lng)*d);return hM*Math.acos(Math.min(b,1))}toBounds(a=0){const d=360*a/40075017,p=d/Math.cos(Math.PI/180*this.lat);return new xu(new Or(this.lng-p,this.lat-d),new Or(this.lng+p,this.lat+d))}static convert(a){if(a instanceof Or)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new Or(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new Or(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class xu{constructor(a,d){a&&(d?this.setSouthWest(a).setNorthEast(d):a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof Or?new Or(a.lng,a.lat):Or.convert(a),this}setSouthWest(a){return this._sw=a instanceof Or?new Or(a.lng,a.lat):Or.convert(a),this}extend(a){const d=this._sw,p=this._ne;let _,b;if(a instanceof Or)_=a,b=a;else{if(!(a instanceof xu))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(xu.convert(a)):this.extend(Or.convert(a)):this;if(_=a._sw,b=a._ne,!_||!b)return this}return d||p?(d.lng=Math.min(_.lng,d.lng),d.lat=Math.min(_.lat,d.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new Or(_.lng,_.lat),this._ne=new Or(b.lng,b.lat)),this}getCenter(){return new Or((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Or(this.getWest(),this.getNorth())}getSouthEast(){return new Or(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:d,lat:p}=Or.convert(a);let _=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&_}static convert(a){return a instanceof xu?a:a&&new xu(a)}}const fM=2*Math.PI*hM;function pM(u){return fM*Math.cos(u*Math.PI/180)}function mM(u){return(180+u)/360}function gM(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function yM(u,a){return u/pM(a)}function I1(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class Fy{constructor(a,d,p=0){this.x=+a,this.y=+d,this.z=+p}static fromLngLat(a,d=0){const p=Or.convert(a);return new Fy(mM(p.lng),gM(p.lat),yM(d,p.lat))}toLngLat(){return new Or(360*this.x-180,I1(this.y))}toAltitude(){return this.z*pM(I1(this.y))}meterInMercatorCoordinateUnits(){return 1/fM*(a=I1(this.y),1/Math.cos(a*Math.PI/180));var a}}function _M(u,a,d){var p=2*Math.PI*6378137/256/Math.pow(2,d);return[u*p-2*Math.PI*6378137/2,a*p-2*Math.PI*6378137/2]}class L1{constructor(a,d,p){if(a<0||a>25||p<0||p>=Math.pow(2,a)||d<0||d>=Math.pow(2,a))throw new Error(`x=${d}, y=${p}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=d,this.y=p,this.key=gp(0,a,a,d,p)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,d,p){const _=(E=this.y,P=this.z,I=_M(256*(b=this.x),256*(E=Math.pow(2,P)-E-1),P),M=_M(256*(b+1),256*(E+1),P),I[0]+","+I[1]+","+M[0]+","+M[1]);var b,E,P,I,M;const B=function(G,q,Y){let J,fe="";for(let de=G;de>0;de--)J=1<<de-1,fe+=(q&J?1:0)+(Y&J?2:0);return fe}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(p==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,d>1?"@2x":"").replace(/{quadkey}/g,B).replace(/{bbox-epsg-3857}/g,_)}isChildOf(a){const d=this.z-a.z;return d>0&&a.x===this.x>>d&&a.y===this.y>>d}getTilePoint(a){const d=Math.pow(2,this.z);return new mt((a.x*d-this.x)*oi,(a.y*d-this.y)*oi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class vM{constructor(a,d){this.wrap=a,this.canonical=d,this.key=gp(a,d.z,d.z,d.x,d.y)}}class no{constructor(a,d,p,_,b){if(a<p)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${p}`);this.overscaledZ=a,this.wrap=d,this.canonical=new L1(p,+_,+b),this.key=gp(d,a,p,_,b)}clone(){return new no(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-a;return a>this.canonical.z?new no(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new no(a,this.wrap,a,this.canonical.x>>d,this.canonical.y>>d)}calculateScaledKey(a,d){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const p=this.canonical.z-a;return a>this.canonical.z?gp(this.wrap*+d,a,this.canonical.z,this.canonical.x,this.canonical.y):gp(this.wrap*+d,a,a,this.canonical.x>>p,this.canonical.y>>p)}isChildOf(a){if(a.wrap!==this.wrap)return!1;const d=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>d&&a.canonical.y===this.canonical.y>>d}children(a){if(this.overscaledZ>=a)return[new no(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const d=this.canonical.z+1,p=2*this.canonical.x,_=2*this.canonical.y;return[new no(d,this.wrap,d,p,_),new no(d,this.wrap,d,p+1,_),new no(d,this.wrap,d,p,_+1),new no(d,this.wrap,d,p+1,_+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new no(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new no(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new vM(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new Fy(a.x-this.wrap,a.y))}}function gp(u,a,d,p,_){(u*=2)<0&&(u=-1*u-1);const b=1<<d;return(b*b*u+b*_+p).toString(36)+d.toString(36)+a.toString(36)}Pt("CanonicalTileID",L1),Pt("OverscaledTileID",no,{omit:["posMatrix"]});class bM{constructor(a,d,p){if(this.uid=a,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(p&&p!=="mapbox"&&p!=="terrarium")return void ie(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=d.height;const _=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=p||"mapbox";for(let b=0;b<_;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(_,b)]=this.data[this._idx(_-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,_)]=this.data[this._idx(b,_-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(_,-1)]=this.data[this._idx(_-1,0)],this.data[this._idx(-1,_)]=this.data[this._idx(0,_-1)],this.data[this._idx(_,_)]=this.data[this._idx(_-1,_-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let b=0;b<_;b++)for(let E=0;E<_;E++){const P=this.get(b,E);P>this.max&&(this.max=P),P<this.min&&(this.min=P)}}get(a,d){const p=new Uint8Array(this.data.buffer),_=4*this._idx(a,d);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(p[_],p[_+1],p[_+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(a,d){if(a<-1||a>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(a+1)}_unpackMapbox(a,d,p){return(256*a*256+256*d+p)/10-1e4}_unpackTerrarium(a,d,p){return 256*a+d+p/256-32768}getPixels(){return new to({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,d,p){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let _=d*this.dim,b=d*this.dim+this.dim,E=p*this.dim,P=p*this.dim+this.dim;switch(d){case-1:_=b-1;break;case 1:b=_+1}switch(p){case-1:E=P-1;break;case 1:P=E+1}const I=-d*this.dim,M=-p*this.dim;for(let B=E;B<P;B++)for(let G=_;G<b;G++)this.data[this._idx(G,B)]=a.data[this._idx(G+I,B+M)]}}Pt("DEMData",bM);class xM{constructor(a){this._stringToNumber={},this._numberToString=[];for(let d=0;d<a.length;d++){const p=a[d];this._stringToNumber[p]=d,this._numberToString[d]=p}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class wM{constructor(a,d,p,_,b){this.type="Feature",this._vectorTileFeature=a,a._z=d,a._x=p,a._y=_,this.properties=a.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={geometry:this.geometry};for(const d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(a[d]=this[d]);return a}}class EM{constructor(a,d){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new fu(oi,16,0),this.grid3D=new fu(oi,16,0),this.featureIndexArray=new dn,this.promoteId=d}insert(a,d,p,_,b,E){const P=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,_,b);const I=E?this.grid3D:this.grid;for(let M=0;M<d.length;M++){const B=d[M],G=[1/0,1/0,-1/0,-1/0];for(let q=0;q<B.length;q++){const Y=B[q];G[0]=Math.min(G[0],Y.x),G[1]=Math.min(G[1],Y.y),G[2]=Math.max(G[2],Y.x),G[3]=Math.max(G[3],Y.y)}G[0]<oi&&G[1]<oi&&G[2]>=0&&G[3]>=0&&I.insert(P,G[0],G[1],G[2],G[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new rc.VectorTile(new y1(this.rawTileData)).layers,this.sourceLayerCoder=new xM(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,d,p,_){this.loadVTLayers();const b=a.params||{},E=oi/a.tileSize/a.scale,P=Id(b.filter),I=a.queryGeometry,M=a.queryPadding*E,B=SM(I),G=this.grid.query(B.minX-M,B.minY-M,B.maxX+M,B.maxY+M),q=SM(a.cameraQueryGeometry),Y=this.grid3D.query(q.minX-M,q.minY-M,q.maxX+M,q.maxY+M,(de,Ie,ze,Se)=>function(De,Xe,qe,St,$t){for(const pt of De)if(Xe<=pt.x&&qe<=pt.y&&St>=pt.x&&$t>=pt.y)return!0;const bt=[new mt(Xe,qe),new mt(Xe,$t),new mt(St,$t),new mt(St,qe)];if(De.length>2){for(const pt of bt)if(Fd(De,pt))return!0}for(let pt=0;pt<De.length-1;pt++)if($j(De[pt],De[pt+1],bt))return!0;return!1}(a.cameraQueryGeometry,de-M,Ie-M,ze+M,Se+M));for(const de of Y)G.push(de);G.sort(sW);const J={};let fe;for(let de=0;de<G.length;de++){const Ie=G[de];if(Ie===fe)continue;fe=Ie;const ze=this.featureIndexArray.get(Ie);let Se=null;this.loadMatchingFeature(J,ze.bucketIndex,ze.sourceLayerIndex,ze.featureIndex,P,b.layers,b.availableImages,d,p,_,(De,Xe,qe)=>(Se||(Se=_u(De)),Xe.queryIntersectsFeature(I,De,qe,Se,this.z,a.transform,E,a.pixelPosMatrix)))}return J}loadMatchingFeature(a,d,p,_,b,E,P,I,M,B,G){const q=this.bucketLayerIDs[d];if(E&&!function(de,Ie){for(let ze=0;ze<de.length;ze++)if(Ie.indexOf(de[ze])>=0)return!0;return!1}(E,q))return;const Y=this.sourceLayerCoder.decode(p),J=this.vtLayers[Y].feature(_);if(b.needGeometry){const de=vu(J,!0);if(!b.filter(new hr(this.tileID.overscaledZ),de,this.tileID.canonical))return}else if(!b.filter(new hr(this.tileID.overscaledZ),J))return;const fe=this.getId(J,Y);for(let de=0;de<q.length;de++){const Ie=q[de];if(E&&E.indexOf(Ie)<0)continue;const ze=I[Ie];if(!ze)continue;let Se={};fe&&B&&(Se=B.getState(ze.sourceLayer||"_geojsonTileLayer",fe));const De=R({},M[Ie]);De.paint=TM(De.paint,ze.paint,J,Se,P),De.layout=TM(De.layout,ze.layout,J,Se,P);const Xe=!G||G(J,ze,Se);if(!Xe)continue;const qe=new wM(J,this.z,this.x,this.y,fe);qe.layer=De;let St=a[Ie];St===void 0&&(St=a[Ie]=[]),St.push({featureIndex:_,feature:qe,intersectionZ:Xe})}}lookupSymbolFeatures(a,d,p,_,b,E,P,I){const M={};this.loadVTLayers();const B=Id(b);for(const G of a)this.loadMatchingFeature(M,p,_,G,B,E,P,I,d);return M}hasLayer(a){for(const d of this.bucketLayerIDs)for(const p of d)if(a===p)return!0;return!1}getId(a,d){let p=a.id;return this.promoteId&&(p=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]],typeof p=="boolean"&&(p=Number(p))),p}}function TM(u,a,d,p,_){return F(u,(b,E)=>{const P=a instanceof gu?a.get(E):null;return P&&P.evaluate?P.evaluate(d,p,_):P})}function SM(u){let a=1/0,d=1/0,p=-1/0,_=-1/0;for(const b of u)a=Math.min(a,b.x),d=Math.min(d,b.y),p=Math.max(p,b.x),_=Math.max(_,b.y);return{minX:a,minY:d,maxX:p,maxY:_}}function sW(u,a){return a-u}var R1;Pt("FeatureIndex",EM,{omit:["rawTileData","sourceLayerCoder"]}),o.PerformanceMarkers=void 0,(R1=o.PerformanceMarkers||(o.PerformanceMarkers={})).create="create",R1.load="load",R1.fullLoad="fullLoad";let zy=null,yp=[];const $1=1e3/30,oW={mark(u){performance.mark(u)},frame(u){const a=u;zy!=null&&yp.push(a-zy),zy=a},clearMetrics(){zy=null,yp=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const u in o.PerformanceMarkers)performance.clearMarks(o.PerformanceMarkers[u])},getPerformanceMetrics(){performance.measure("loadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.load),performance.measure("fullLoadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.fullLoad);const u=performance.getEntriesByName("loadTime")[0].duration,a=performance.getEntriesByName("fullLoadTime")[0].duration,d=yp.length,p=1/(yp.reduce((b,E)=>b+E,0)/d/1e3),_=yp.filter(b=>b>$1).reduce((b,E)=>b+(E-$1)/$1,0);return{loadTime:u,fullLoadTime:a,fps:p,percentDroppedFrames:_/(d+_)*100}}};o.AJAXError=Dt,o.ARRAY_TYPE=is,o.Actor=class{constructor(u,a,d){this.target=u,this.parent=a,this.mapId=d,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},H(["receive","process"],this),this.invoker=new iW(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ve()?u:window}send(u,a,d,p,_=!1){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);d&&(this.callbacks[b]=d);const E=we(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:u,hasCallback:!!d,targetMapId:p,mustQueue:_,sourceMapId:this.mapId,data:Ya(a,E)},E),{cancel:()=>{d&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(u){const a=u.data,d=a.id;if(d&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){delete this.tasks[d];const p=this.cancelCallbacks[d];delete this.cancelCallbacks[d],p&&p()}else ve()||a.mustQueue?(this.tasks[d]=a,this.taskQueue.push(d),this.invoker.trigger()):this.processTask(d,a)}process(){if(!this.taskQueue.length)return;const u=this.taskQueue.shift(),a=this.tasks[u];delete this.tasks[u],this.taskQueue.length&&this.invoker.trigger(),a&&this.processTask(u,a)}processTask(u,a){if(a.type==="<response>"){const d=this.callbacks[u];delete this.callbacks[u],d&&(a.error?d(ba(a.error)):d(null,ba(a.data)))}else{let d=!1;const p=we(this.globalScope)?void 0:[],_=a.hasCallback?(P,I)=>{d=!0,delete this.cancelCallbacks[u],this.target.postMessage({id:u,type:"<response>",sourceMapId:this.mapId,error:P?Ya(P):null,data:Ya(I,p)},p)}:P=>{d=!0};let b=null;const E=ba(a.data);if(this.parent[a.type])b=this.parent[a.type](a.sourceMapId,E,_);else if(this.parent.getWorkerSource){const P=a.type.split(".");b=this.parent.getWorkerSource(a.sourceMapId,P[0],E.source)[P[1]](E,_)}else _(new Error(`Could not find function ${a.type}`));!d&&b&&b.cancel&&(this.cancelCallbacks[u]=b.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.AlphaImage=ap,o.CanonicalTileID=L1,o.CollisionBoxArray=He,o.CollisionCircleLayoutArray=class extends V{},o.Color=te,o.DEMData=bM,o.DataConstantProperty=Ft,o.DictionaryCoder=xM,o.EXTENT=oi,o.ErrorEvent=So,o.EvaluationParameters=hr,o.Event=Vi,o.Evented=Qi,o.FeatureIndex=EM,o.FillBucket=f1,o.FillExtrusionBucket=m1,o.GeoJSONFeature=wM,o.ImageAtlas=K$,o.ImagePosition=v1,o.LineBucket=g1,o.LineStripIndexArray=class extends ue{},o.LngLat=Or,o.LngLatBounds=xu,o.MercatorCoordinate=Fy,o.ONE_EM=Ti,o.OverscaledTileID=no,o.PerformanceUtils=oW,o.PosArray=Gt,o.Properties=Ei,o.QuadTriangleArray=class extends X{},o.RGBAImage=to,o.RasterBoundsArray=class extends y{},o.RequestPerformance=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},o.ResourceType=Et,o.SegmentVector=yn,o.SymbolBucket=jd,o.Transitionable=fy,o.TriangleIndexArray=ns,o.Uniform1f=tl,o.Uniform1i=class extends el{constructor(u,a){super(u,a),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},o.Uniform2f=class extends el{constructor(u,a){super(u,a),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},o.Uniform3f=class extends el{constructor(u,a){super(u,a),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},o.Uniform4f=Od,o.UniformColor=c$,o.UniformMatrix4f=class extends el{constructor(u,a){super(u,a),this.current=Pj}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let a=1;a<16;a++)if(u[a]!==this.current[a]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},o.UnwrappedTileID=vM,o.ValidationError=dt,o.ZoomHistory=Wf,o.add=function(u,a,d){return u[0]=a[0]+d[0],u[1]=a[1]+d[1],u[2]=a[2]+d[2],u},o.addDynamicAttributes=T1,o.asyncAll=function(u,a,d){if(!u.length)return d(null,[]);let p=u.length;const _=new Array(u.length);let b=null;u.forEach((E,P)=>{a(E,(I,M)=>{I&&(b=I),_[P]=M,--p==0&&d(b,_)})})},o.bezier=x,o.bindAll=H,o.cacheEntryPossiblyAdded=function(u){Ot++,Ot>Ke&&(u.getActor().send("enforceCacheSizeLimit",Pe),Ot=0)},o.clamp=T,o.clearTileCache=function(u){const a=caches.delete(It);u&&a.catch(u).then(()=>u())},o.clipLine=sM,o.clone=function(u){var a=new is(16);return a[0]=u[0],a[1]=u[1],a[2]=u[2],a[3]=u[3],a[4]=u[4],a[5]=u[5],a[6]=u[6],a[7]=u[7],a[8]=u[8],a[9]=u[9],a[10]=u[10],a[11]=u[11],a[12]=u[12],a[13]=u[13],a[14]=u[14],a[15]=u[15],a},o.clone$1=N,o.clone$2=function(u){var a=new is(3);return a[0]=u[0],a[1]=u[1],a[2]=u[2],a},o.collisionCircleLayout=TH,o.config=ot,o.copy=function(u,a){return u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[4]=a[4],u[5]=a[5],u[6]=a[6],u[7]=a[7],u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},o.create=function(){var u=new is(16);return is!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},o.create$1=y$,o.createExpression=nu,o.createFilter=Id,o.createLayout=Xr,o.createStyleLayer=function(u){return u.type==="custom"?new nW(u):new rW[u.type](u)},o.cross=function(u,a,d){var p=a[0],_=a[1],b=a[2],E=d[0],P=d[1],I=d[2];return u[0]=_*I-b*P,u[1]=b*E-p*I,u[2]=p*P-_*E,u},o.dot=function(u,a){return u[0]*a[0]+u[1]*a[1]+u[2]*a[2]},o.dot$1=function(u,a){return u[0]*a[0]+u[1]*a[1]+u[2]*a[2]+u[3]*a[3]},o.ease=S,o.emitValidationErrors=Rd,o.enforceCacheSizeLimit=function(u){Je(),at&&at.then(a=>{a.keys().then(d=>{for(let p=0;p<d.length-u;p++)a.delete(d[p])})})},o.equals=function(u,a){var d=u[0],p=u[1],_=u[2],b=u[3],E=u[4],P=u[5],I=u[6],M=u[7],B=u[8],G=u[9],q=u[10],Y=u[11],J=u[12],fe=u[13],de=u[14],Ie=u[15],ze=a[0],Se=a[1],De=a[2],Xe=a[3],qe=a[4],St=a[5],$t=a[6],bt=a[7],pt=a[8],ut=a[9],xt=a[10],yt=a[11],rt=a[12],jt=a[13],Nt=a[14],hn=a[15];return Math.abs(d-ze)<=rs*Math.max(1,Math.abs(d),Math.abs(ze))&&Math.abs(p-Se)<=rs*Math.max(1,Math.abs(p),Math.abs(Se))&&Math.abs(_-De)<=rs*Math.max(1,Math.abs(_),Math.abs(De))&&Math.abs(b-Xe)<=rs*Math.max(1,Math.abs(b),Math.abs(Xe))&&Math.abs(E-qe)<=rs*Math.max(1,Math.abs(E),Math.abs(qe))&&Math.abs(P-St)<=rs*Math.max(1,Math.abs(P),Math.abs(St))&&Math.abs(I-$t)<=rs*Math.max(1,Math.abs(I),Math.abs($t))&&Math.abs(M-bt)<=rs*Math.max(1,Math.abs(M),Math.abs(bt))&&Math.abs(B-pt)<=rs*Math.max(1,Math.abs(B),Math.abs(pt))&&Math.abs(G-ut)<=rs*Math.max(1,Math.abs(G),Math.abs(ut))&&Math.abs(q-xt)<=rs*Math.max(1,Math.abs(q),Math.abs(xt))&&Math.abs(Y-yt)<=rs*Math.max(1,Math.abs(Y),Math.abs(yt))&&Math.abs(J-rt)<=rs*Math.max(1,Math.abs(J),Math.abs(rt))&&Math.abs(fe-jt)<=rs*Math.max(1,Math.abs(fe),Math.abs(jt))&&Math.abs(de-Nt)<=rs*Math.max(1,Math.abs(de),Math.abs(Nt))&&Math.abs(Ie-hn)<=rs*Math.max(1,Math.abs(Ie),Math.abs(hn))},o.evaluateSizeForFeature=function(u,{uSize:a,uSizeT:d},{lowerSize:p,upperSize:_}){return u.kind==="source"?p/il:u.kind==="composite"?un(p/il,_/il,d):a},o.evaluateSizeForZoom=function(u,a){let d=0,p=0;if(u.kind==="constant")p=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:_,minZoom:b,maxZoom:E}=u,P=_?T(ys.interpolationFactor(_,a,b,E),0,1):0;u.kind==="camera"?p=un(u.minSize,u.maxSize,P):d=P}return{uSizeT:d,uSize:p}},o.evaluateVariableOffset=lM,o.evented=Qf,o.exported=Jt,o.exported$1=ht,o.extend=R,o.filterObject=k,o.fromRotation=function(u,a){var d=Math.sin(a),p=Math.cos(a);return u[0]=p,u[1]=d,u[2]=0,u[3]=-d,u[4]=p,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},o.fromScaling=function(u,a){return u[0]=a[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=a[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=a[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},o.getAnchorAlignment=x1,o.getAnchorJustification=E1,o.getArrayBuffer=Qn,o.getImage=ms,o.getJSON=function(u,a){return Hn(R(u,{type:"json"}),a)},o.getOverlapMode=C1,o.getRTLTextPluginStatus=pu,o.getReferrer=mn,o.getVideo=function(u,a){const d=window.document.createElement("video");d.muted=!0,d.onloadstart=function(){a(null,d)};for(let p=0;p<u.length;p++){const _=window.document.createElement("source");Zs(u[p])||(d.crossOrigin="Anonymous"),_.src=u[p],d.appendChild(_)}return{cancel:()=>{}}},o.identity=i1,o.invert=function(u,a){var d=a[0],p=a[1],_=a[2],b=a[3],E=a[4],P=a[5],I=a[6],M=a[7],B=a[8],G=a[9],q=a[10],Y=a[11],J=a[12],fe=a[13],de=a[14],Ie=a[15],ze=d*P-p*E,Se=d*I-_*E,De=d*M-b*E,Xe=p*I-_*P,qe=p*M-b*P,St=_*M-b*I,$t=B*fe-G*J,bt=B*de-q*J,pt=B*Ie-Y*J,ut=G*de-q*fe,xt=G*Ie-Y*fe,yt=q*Ie-Y*de,rt=ze*yt-Se*xt+De*ut+Xe*pt-qe*bt+St*$t;return rt?(u[0]=(P*yt-I*xt+M*ut)*(rt=1/rt),u[1]=(_*xt-p*yt-b*ut)*rt,u[2]=(fe*St-de*qe+Ie*Xe)*rt,u[3]=(q*qe-G*St-Y*Xe)*rt,u[4]=(I*pt-E*yt-M*bt)*rt,u[5]=(d*yt-_*pt+b*bt)*rt,u[6]=(de*De-J*St-Ie*Se)*rt,u[7]=(B*St-q*De+Y*Se)*rt,u[8]=(E*xt-P*pt+M*$t)*rt,u[9]=(p*pt-d*xt-b*$t)*rt,u[10]=(J*qe-fe*De+Ie*ze)*rt,u[11]=(G*De-B*qe-Y*ze)*rt,u[12]=(P*bt-E*ut-I*$t)*rt,u[13]=(d*ut-p*bt+_*$t)*rt,u[14]=(fe*Se-J*Xe-de*ze)*rt,u[15]=(B*Xe-G*Se+q*ze)*rt,u):null},o.isImageBitmap=Be,o.isSafari=we,o.isWorker=ve,o.keysDifference=function(u,a){const d=[];for(const p in u)p in a||d.push(p);return d},o.lazyLoadRTLTextPlugin=function(){ks.isLoading()||ks.isLoaded()||pu()!=="deferred"||hy()},o.makeRequest=Hn,o.mapObject=F,o.mercatorXfromLng=mM,o.mercatorYfromLat=gM,o.mercatorZfromAltitude=yM,o.mul=Oj,o.mul$1=function(u,a,d){return u[0]=a[0]*d[0],u[1]=a[1]*d[1],u[2]=a[2]*d[2],u[3]=a[3]*d[3],u},o.multiply=_$,o.nextPowerOfTwo=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},o.normalize=function(u,a){var d=a[0],p=a[1],_=a[2],b=d*d+p*p+_*_;return b>0&&(b=1/Math.sqrt(b)),u[0]=a[0]*b,u[1]=a[1]*b,u[2]=a[2]*b,u},o.number=un,o.ortho=function(u,a,d,p,_,b,E){var P=1/(a-d),I=1/(p-_),M=1/(b-E);return u[0]=-2*P,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*I,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*M,u[11]=0,u[12]=(a+d)*P,u[13]=(_+p)*I,u[14]=(E+b)*M,u[15]=1,u},o.parseCacheControl=Oe,o.parseGlyphPbf=function(u){return new y1(u).readFields(OH,[])},o.pbf=y1,o.performSymbolLayout=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=oi/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const a=u.bucket.layers[0].layout,d=u.bucket.layers[0]._unevaluatedLayout._values,p={layoutIconSize:d["icon-size"].possiblyEvaluate(new hr(u.bucket.zoom+1),u.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new hr(u.bucket.zoom+1),u.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new hr(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:M}=u.bucket.textSizeData;p.compositeTextSizes=[d["text-size"].possiblyEvaluate(new hr(I),u.canonical),d["text-size"].possiblyEvaluate(new hr(M),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:M}=u.bucket.iconSizeData;p.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new hr(I),u.canonical),d["icon-size"].possiblyEvaluate(new hr(M),u.canonical)]}const _=a.get("text-line-height")*Ti,b=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",E=a.get("text-keep-upright"),P=a.get("text-size");for(const I of u.bucket.features){const M=a.get("text-font").evaluate(I,{},u.canonical).join(","),B=P.evaluate(I,{},u.canonical),G=p.layoutTextSize.evaluate(I,{},u.canonical),q=p.layoutIconSize.evaluate(I,{},u.canonical),Y={horizontal:{},vertical:void 0},J=I.text;let fe,de=[0,0];if(J){const Se=J.toString(),De=a.get("text-letter-spacing").evaluate(I,{},u.canonical)*Ti,Xe=Zb(Se)?De:0,qe=a.get("text-anchor").evaluate(I,{},u.canonical),St=a.get("text-variable-anchor");if(!St){const xt=a.get("text-radial-offset").evaluate(I,{},u.canonical);de=xt?lM(qe,[xt*Ti,w1]):a.get("text-offset").evaluate(I,{},u.canonical).map(yt=>yt*Ti)}let $t=b?"center":a.get("text-justify").evaluate(I,{},u.canonical);const bt=a.get("symbol-placement"),pt=bt==="point"?a.get("text-max-width").evaluate(I,{},u.canonical)*Ti:0,ut=()=>{u.bucket.allowVerticalPlacement&&$d(Se)&&(Y.vertical=Iy(J,u.glyphMap,u.glyphPositions,u.imagePositions,M,pt,_,qe,"left",Xe,de,o.WritingMode.vertical,!0,bt,G,B))};if(!b&&St){const xt=$t==="auto"?St.map(rt=>E1(rt)):[$t];let yt=!1;for(let rt=0;rt<xt.length;rt++){const jt=xt[rt];if(!Y.horizontal[jt])if(yt)Y.horizontal[jt]=Y.horizontal[0];else{const Nt=Iy(J,u.glyphMap,u.glyphPositions,u.imagePositions,M,pt,_,"center",jt,Xe,de,o.WritingMode.horizontal,!1,bt,G,B);Nt&&(Y.horizontal[jt]=Nt,yt=Nt.positionedLines.length===1)}}ut()}else{$t==="auto"&&($t=E1(qe));const xt=Iy(J,u.glyphMap,u.glyphPositions,u.imagePositions,M,pt,_,qe,$t,Xe,de,o.WritingMode.horizontal,!1,bt,G,B);xt&&(Y.horizontal[$t]=xt),ut(),$d(Se)&&b&&E&&(Y.vertical=Iy(J,u.glyphMap,u.glyphPositions,u.imagePositions,M,pt,_,qe,$t,Xe,de,o.WritingMode.vertical,!1,bt,G,B))}}let Ie=!1;if(I.icon&&I.icon.name){const Se=u.imageMap[I.icon.name];Se&&(fe=UH(u.imagePositions[I.icon.name],a.get("icon-offset").evaluate(I,{},u.canonical),a.get("icon-anchor").evaluate(I,{},u.canonical)),Ie=!!Se.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=Ie:u.bucket.sdfIcons!==Ie&&ie("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Se.pixelRatio!==u.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const ze=uM(Y.horizontal)||Y.vertical;u.bucket.iconsInText=!!ze&&ze.iconsInText,(ze||fe)&&qH(u.bucket,I,Y,fe,u.imageMap,p,G,q,de,Ie,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},o.perspective=function(u,a,d,p,_){var b,E=1/Math.tan(a/2);return u[0]=E/d,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=E,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,_!=null&&_!==1/0?(u[10]=(_+p)*(b=1/(p-_)),u[14]=2*_*p*b):(u[10]=-1,u[14]=-2*p),u},o.pick=function(u,a){const d={};for(let p=0;p<a.length;p++){const _=a[p];_ in u&&(d[_]=u[_])}return d},o.plugin=ks,o.pointGeometry=mt,o.polygonIntersectsPolygon=f$,o.potpack=W$,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=Pt,o.registerForPluginStateChange=function(u){return u({pluginStatus:ts,pluginURL:xa}),Qf.on("pluginStateChange",u),u},o.renderColorRamp=S$,o.rotateX=function(u,a,d){var p=Math.sin(d),_=Math.cos(d),b=a[4],E=a[5],P=a[6],I=a[7],M=a[8],B=a[9],G=a[10],q=a[11];return a!==u&&(u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[4]=b*_+M*p,u[5]=E*_+B*p,u[6]=P*_+G*p,u[7]=I*_+q*p,u[8]=M*_-b*p,u[9]=B*_-E*p,u[10]=G*_-P*p,u[11]=q*_-I*p,u},o.rotateZ=function(u,a,d){var p=Math.sin(d),_=Math.cos(d),b=a[0],E=a[1],P=a[2],I=a[3],M=a[4],B=a[5],G=a[6],q=a[7];return a!==u&&(u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[0]=b*_+M*p,u[1]=E*_+B*p,u[2]=P*_+G*p,u[3]=I*_+q*p,u[4]=M*_-b*p,u[5]=B*_-E*p,u[6]=G*_-P*p,u[7]=q*_-I*p,u},o.scale=function(u,a,d){var p=d[0],_=d[1],b=d[2];return u[0]=a[0]*p,u[1]=a[1]*p,u[2]=a[2]*p,u[3]=a[3]*p,u[4]=a[4]*_,u[5]=a[5]*_,u[6]=a[6]*_,u[7]=a[7]*_,u[8]=a[8]*b,u[9]=a[9]*b,u[10]=a[10]*b,u[11]=a[11]*b,u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},o.scale$1=function(u,a,d){return u[0]=a[0]*d,u[1]=a[1]*d,u[2]=a[2]*d,u},o.setCacheLimits=function(u,a){Pe=u,Ke=a},o.setRTLTextPlugin=function(u,a,d=!1){if(ts===Xf||ts===Zf||ts===Yf)throw new Error("setRTLTextPlugin cannot be called multiple times.");xa=Jt.resolveURL(u),ts=Xf,Jf=a,Ql(),d||hy()},o.spec=je,o.sphericalToCartesian=function([u,a,d]){return a+=90,a*=Math.PI/180,d*=Math.PI/180,{x:u*Math.cos(a)*Math.sin(d),y:u*Math.sin(a)*Math.sin(d),z:u*Math.cos(d)}},o.sqrLen=function(u){var a=u[0],d=u[1];return a*a+d*d},o.sub=function(u,a,d){return u[0]=a[0]-d[0],u[1]=a[1]-d[1],u[2]=a[2]-d[2],u},o.toEvaluationFeature=vu,o.transformMat3=function(u,a,d){var p=a[0],_=a[1],b=a[2];return u[0]=p*d[0]+_*d[3]+b*d[6],u[1]=p*d[1]+_*d[4]+b*d[7],u[2]=p*d[2]+_*d[5]+b*d[8],u},o.transformMat4=xy,o.transformMat4$1=function(u,a,d){var p=a[0],_=a[1];return u[0]=d[0]*p+d[4]*_+d[12],u[1]=d[1]*p+d[5]*_+d[13],u},o.translate=function(u,a,d){var p,_,b,E,P,I,M,B,G,q,Y,J,fe=d[0],de=d[1],Ie=d[2];return a===u?(u[12]=a[0]*fe+a[4]*de+a[8]*Ie+a[12],u[13]=a[1]*fe+a[5]*de+a[9]*Ie+a[13],u[14]=a[2]*fe+a[6]*de+a[10]*Ie+a[14],u[15]=a[3]*fe+a[7]*de+a[11]*Ie+a[15]):(_=a[1],b=a[2],E=a[3],P=a[4],I=a[5],M=a[6],B=a[7],G=a[8],q=a[9],Y=a[10],J=a[11],u[0]=p=a[0],u[1]=_,u[2]=b,u[3]=E,u[4]=P,u[5]=I,u[6]=M,u[7]=B,u[8]=G,u[9]=q,u[10]=Y,u[11]=J,u[12]=p*fe+P*de+G*Ie+a[12],u[13]=_*fe+I*de+q*Ie+a[13],u[14]=b*fe+M*de+Y*Ie+a[14],u[15]=E*fe+B*de+J*Ie+a[15]),u},o.triggerPluginCompletionEvent=dy,o.unicodeBlockLookup=vt,o.uniqueId=function(){return D++},o.validateCustomStyleLayer=function(u){const a=[],d=u.id;return d===void 0&&a.push({message:`layers.${d}: missing required property "id"`}),u.render===void 0&&a.push({message:`layers.${d}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&a.push({message:`layers.${d}: property "renderingMode" must be either "2d" or "3d"`}),a},o.validateLight=Hf,o.validateStyle=hu,o.vectorTile=rc,o.warnOnce=ie,o.wrap=C}),s(["./shared"],function(o){function f(re){const z=typeof re;if(z==="number"||z==="boolean"||z==="string"||re==null)return JSON.stringify(re);if(Array.isArray(re)){let te="[";for(const me of re)te+=`${f(me)},`;return`${te}]`}const j=Object.keys(re).sort();let Q="{";for(let te=0;te<j.length;te++)Q+=`${JSON.stringify(j[te])}:${f(re[j[te]])},`;return`${Q}}`}function m(re){let z="";for(const j of o.refProperties)z+=`/${f(re[j])}`;return z}class x{constructor(z){this.keyCache={},z&&this.replace(z)}replace(z){this._layerConfigs={},this._layers={},this.update(z,[])}update(z,j){for(const te of z){this._layerConfigs[te.id]=te;const me=this._layers[te.id]=o.createStyleLayer(te);me._featureFilter=o.createFilter(me.filter),this.keyCache[te.id]&&delete this.keyCache[te.id]}for(const te of j)delete this.keyCache[te],delete this._layerConfigs[te],delete this._layers[te];this.familiesBySource={};const Q=function(te,me){const be={};for(let pe=0;pe<te.length;pe++){const xe=me&&me[te[pe].id]||m(te[pe]);me&&(me[te[pe].id]=xe);let Ve=be[xe];Ve||(Ve=be[xe]=[]),Ve.push(te[pe])}const ye=[];for(const pe in be)ye.push(be[pe]);return ye}(Object.values(this._layerConfigs),this.keyCache);for(const te of Q){const me=te.map(Qe=>this._layers[Qe.id]),be=me[0];if(be.visibility==="none")continue;const ye=be.source||"";let pe=this.familiesBySource[ye];pe||(pe=this.familiesBySource[ye]={});const xe=be.sourceLayer||"_geojsonTileLayer";let Ve=pe[xe];Ve||(Ve=pe[xe]=[]),Ve.push(me)}}}class S{constructor(z){const j={},Q=[];for(const ye in z){const pe=z[ye],xe=j[ye]={};for(const Ve in pe){const Qe=pe[+Ve];if(!Qe||Qe.bitmap.width===0||Qe.bitmap.height===0)continue;const Ue={x:0,y:0,w:Qe.bitmap.width+2,h:Qe.bitmap.height+2};Q.push(Ue),xe[Ve]={rect:Ue,metrics:Qe.metrics}}}const{w:te,h:me}=o.potpack(Q),be=new o.AlphaImage({width:te||1,height:me||1});for(const ye in z){const pe=z[ye];for(const xe in pe){const Ve=pe[+xe];if(!Ve||Ve.bitmap.width===0||Ve.bitmap.height===0)continue;const Qe=j[ye][xe].rect;o.AlphaImage.copy(Ve.bitmap,be,{x:0,y:0},{x:Qe.x+1,y:Qe.y+1},Ve.bitmap)}}this.image=be,this.positions=j}}o.register("GlyphAtlas",S);class T{constructor(z){this.tileID=new o.OverscaledTileID(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.uid=z.uid,this.zoom=z.zoom,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.returnDependencies=!!z.returnDependencies,this.promoteId=z.promoteId}parse(z,j,Q,te,me){this.status="parsing",this.data=z,this.collisionBoxArray=new o.CollisionBoxArray;const be=new o.DictionaryCoder(Object.keys(z.layers).sort()),ye=new o.FeatureIndex(this.tileID,this.promoteId);ye.bucketLayerIDs=[];const pe={},xe={featureIndex:ye,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Q},Ve=j.familiesBySource[this.source];for(const Kt in Ve){const Qt=z.layers[Kt];if(!Qt)continue;Qt.version===1&&o.warnOnce(`Vector tile source "${this.source}" layer "${Kt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const fn=be.encode(Kt),vn=[];for(let er=0;er<Qt.length;er++){const tr=Qt.feature(er),ii=ye.getId(tr,Kt);vn.push({feature:tr,id:ii,index:er,sourceLayerIndex:fn})}for(const er of Ve[Kt]){const tr=er[0];tr.source!==this.source&&o.warnOnce(`layer.source = ${tr.source} does not equal this.source = ${this.source}`),tr.minzoom&&this.zoom<Math.floor(tr.minzoom)||tr.maxzoom&&this.zoom>=tr.maxzoom||tr.visibility!=="none"&&(C(er,this.zoom,Q),(pe[tr.id]=tr.createBucket({index:ye.bucketLayerIDs.length,layers:er,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:fn,sourceID:this.source})).populate(vn,xe,this.tileID.canonical),ye.bucketLayerIDs.push(er.map(ii=>ii.id)))}}let Qe,Ue,At,Rt;const _t=o.mapObject(xe.glyphDependencies,Kt=>Object.keys(Kt).map(Number));Object.keys(_t).length?te.send("getGlyphs",{uid:this.uid,stacks:_t},(Kt,Qt)=>{Qe||(Qe=Kt,Ue=Qt,cn.call(this))}):Ue={};const Vt=Object.keys(xe.iconDependencies);Vt.length?te.send("getImages",{icons:Vt,source:this.source,tileID:this.tileID,type:"icons"},(Kt,Qt)=>{Qe||(Qe=Kt,At=Qt,cn.call(this))}):At={};const zt=Object.keys(xe.patternDependencies);function cn(){if(Qe)return me(Qe);if(Ue&&At&&Rt){const Kt=new S(Ue),Qt=new o.ImageAtlas(At,Rt);for(const fn in pe){const vn=pe[fn];vn instanceof o.SymbolBucket?(C(vn.layers,this.zoom,Q),o.performSymbolLayout({bucket:vn,glyphMap:Ue,glyphPositions:Kt.positions,imageMap:At,imagePositions:Qt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):vn.hasPattern&&(vn instanceof o.LineBucket||vn instanceof o.FillBucket||vn instanceof o.FillExtrusionBucket)&&(C(vn.layers,this.zoom,Q),vn.addFeatures(xe,this.tileID.canonical,Qt.patternPositions))}this.status="done",me(null,{buckets:Object.values(pe).filter(fn=>!fn.isEmpty()),featureIndex:ye,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Kt.image,imageAtlas:Qt,glyphMap:this.returnDependencies?Ue:null,iconMap:this.returnDependencies?At:null,glyphPositions:this.returnDependencies?Kt.positions:null})}}zt.length?te.send("getImages",{icons:zt,source:this.source,tileID:this.tileID,type:"patterns"},(Kt,Qt)=>{Qe||(Qe=Kt,Rt=Qt,cn.call(this))}):Rt={},cn.call(this)}}function C(re,z,j){const Q=new o.EvaluationParameters(z);for(const te of re)te.recalculate(Q,j)}function R(re,z){const j=o.getArrayBuffer(re.request,(Q,te,me,be)=>{Q?z(Q):te&&z(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(te)),rawData:te,cacheControl:me,expires:be})});return()=>{j.cancel(),z()}}class D{constructor(z,j,Q,te){this.actor=z,this.layerIndex=j,this.availableImages=Q,this.loadVectorData=te||R,this.loading={},this.loaded={}}loadTile(z,j){const Q=z.uid;this.loading||(this.loading={});const te=!!(z&&z.request&&z.request.collectResourceTiming)&&new o.RequestPerformance(z.request),me=this.loading[Q]=new T(z);me.abort=this.loadVectorData(z,(be,ye)=>{if(delete this.loading[Q],be||!ye)return me.status="done",this.loaded[Q]=me,j(be);const pe=ye.rawData,xe={};ye.expires&&(xe.expires=ye.expires),ye.cacheControl&&(xe.cacheControl=ye.cacheControl);const Ve={};if(te){const Qe=te.finish();Qe&&(Ve.resourceTiming=JSON.parse(JSON.stringify(Qe)))}me.vectorTile=ye.vectorTile,me.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,(Qe,Ue)=>{if(Qe||!Ue)return j(Qe);j(null,o.extend({rawTileData:pe.slice(0)},Ue,xe,Ve))}),this.loaded=this.loaded||{},this.loaded[Q]=me})}reloadTile(z,j){const Q=this.loaded,te=z.uid,me=this;if(Q&&Q[te]){const be=Q[te];be.showCollisionBoxes=z.showCollisionBoxes;const ye=(pe,xe)=>{const Ve=be.reloadCallback;Ve&&(delete be.reloadCallback,be.parse(be.vectorTile,me.layerIndex,this.availableImages,me.actor,Ve)),j(pe,xe)};be.status==="parsing"?be.reloadCallback=ye:be.status==="done"&&(be.vectorTile?be.parse(be.vectorTile,this.layerIndex,this.availableImages,this.actor,ye):ye())}}abortTile(z,j){const Q=this.loading,te=z.uid;Q&&Q[te]&&Q[te].abort&&(Q[te].abort(),delete Q[te]),j()}removeTile(z,j){const Q=this.loaded,te=z.uid;Q&&Q[te]&&delete Q[te],j()}}class H{constructor(){this.loaded={}}loadTile(z,j){const{uid:Q,encoding:te,rawImageData:me}=z,be=o.isImageBitmap(me)?this.getImageData(me):me,ye=new o.DEMData(Q,be,te);this.loaded=this.loaded||{},this.loaded[Q]=ye,j(null,ye)}getImageData(z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(z.width,z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=z.width,this.offscreenCanvas.height=z.height,this.offscreenCanvasContext.drawImage(z,0,0,z.width,z.height);const j=this.offscreenCanvasContext.getImageData(-1,-1,z.width+2,z.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:j.width,height:j.height},j.data)}removeTile(z){const j=this.loaded,Q=z.uid;j&&j[Q]&&delete j[Q]}}var F=function re(z,j){var Q,te=z&&z.type;if(te==="FeatureCollection")for(Q=0;Q<z.features.length;Q++)re(z.features[Q],j);else if(te==="GeometryCollection")for(Q=0;Q<z.geometries.length;Q++)re(z.geometries[Q],j);else if(te==="Feature")re(z.geometry,j);else if(te==="Polygon")k(z.coordinates,j);else if(te==="MultiPolygon")for(Q=0;Q<z.coordinates.length;Q++)k(z.coordinates[Q],j);return z};function k(re,z){if(re.length!==0){N(re[0],z);for(var j=1;j<re.length;j++)N(re[j],!z)}}function N(re,z){for(var j=0,Q=0,te=0,me=re.length,be=me-1;te<me;be=te++){var ye=(re[te][0]-re[be][0])*(re[be][1]+re[te][1]),pe=j+ye;Q+=Math.abs(j)>=Math.abs(ye)?j-pe+ye:ye-pe+j,j=pe}j+Q>=0!=!!z&&re.reverse()}const U=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ie{constructor(z){this._feature=z,this.extent=o.EXTENT,this.type=z.type,this.properties=z.tags,"id"in z&&!isNaN(z.id)&&(this.id=parseInt(z.id,10))}loadGeometry(){if(this._feature.type===1){const z=[];for(const j of this._feature.geometry)z.push([new o.pointGeometry(j[0],j[1])]);return z}{const z=[];for(const j of this._feature.geometry){const Q=[];for(const te of j)Q.push(new o.pointGeometry(te[0],te[1]));z.push(Q)}return z}}toGeoJSON(z,j,Q){return U.call(this,z,j,Q)}}class he{constructor(z){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=z.length,this._features=z}feature(z){return new ie(this._features[z])}}var le={exports:{}},ve=o.pointGeometry,Oe=o.vectorTile.VectorTileFeature,Re=Ee;function Ee(re,z){this.options=z||{},this.features=re,this.length=re.length}function $e(re,z){this.id=typeof re.id=="number"?re.id:void 0,this.type=re.type,this.rawGeometry=re.type===1?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=z||4096}Ee.prototype.feature=function(re){return new $e(this.features[re],this.options.extent)},$e.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var z=0;z<re.length;z++){for(var j=re[z],Q=[],te=0;te<j.length;te++)Q.push(new ve(j[te][0],j[te][1]));this.geometry.push(Q)}return this.geometry},$e.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,z=1/0,j=-1/0,Q=1/0,te=-1/0,me=0;me<re.length;me++)for(var be=re[me],ye=0;ye<be.length;ye++){var pe=be[ye];z=Math.min(z,pe.x),j=Math.max(j,pe.x),Q=Math.min(Q,pe.y),te=Math.max(te,pe.y)}return[z,Q,j,te]},$e.prototype.toGeoJSON=Oe.prototype.toGeoJSON;var we=o.pbf,Be=Re;function Jt(re){var z=new we;return function(j,Q){for(var te in j.layers)Q.writeMessage(3,mt,j.layers[te])}(re,z),z.finish()}function mt(re,z){var j;z.writeVarintField(15,re.version||1),z.writeStringField(1,re.name||""),z.writeVarintField(5,re.extent||4096);var Q={keys:[],values:[],keycache:{},valuecache:{}};for(j=0;j<re.length;j++)Q.feature=re.feature(j),z.writeMessage(2,an,Q);var te=Q.keys;for(j=0;j<te.length;j++)z.writeStringField(3,te[j]);var me=Q.values;for(j=0;j<me.length;j++)z.writeMessage(4,Pe,me[j])}function an(re,z){var j=re.feature;j.id!==void 0&&z.writeVarintField(1,j.id),z.writeMessage(2,ot,re),z.writeVarintField(3,j.type),z.writeMessage(4,kt,j)}function ot(re,z){var j=re.feature,Q=re.keys,te=re.values,me=re.keycache,be=re.valuecache;for(var ye in j.properties){var pe=j.properties[ye],xe=me[ye];if(pe!==null){xe===void 0&&(Q.push(ye),me[ye]=xe=Q.length-1),z.writeVarint(xe);var Ve=typeof pe;Ve!=="string"&&Ve!=="boolean"&&Ve!=="number"&&(pe=JSON.stringify(pe));var Qe=Ve+":"+pe,Ue=be[Qe];Ue===void 0&&(te.push(pe),be[Qe]=Ue=te.length-1),z.writeVarint(Ue)}}}function It(re,z){return(z<<3)+(7&re)}function at(re){return re<<1^re>>31}function kt(re,z){for(var j=re.loadGeometry(),Q=re.type,te=0,me=0,be=j.length,ye=0;ye<be;ye++){var pe=j[ye],xe=1;Q===1&&(xe=pe.length),z.writeVarint(It(1,xe));for(var Ve=Q===3?pe.length-1:pe.length,Qe=0;Qe<Ve;Qe++){Qe===1&&Q!==1&&z.writeVarint(It(2,Ve-1));var Ue=pe[Qe].x-te,At=pe[Qe].y-me;z.writeVarint(at(Ue)),z.writeVarint(at(At)),te+=Ue,me+=At}Q===3&&z.writeVarint(It(7,1))}}function Pe(re,z){var j=typeof re;j==="string"?z.writeStringField(1,re):j==="boolean"?z.writeBooleanField(7,re):j==="number"&&(re%1!=0?z.writeDoubleField(3,re):re<0?z.writeSVarintField(6,re):z.writeVarintField(5,re))}function Ke(re,z,j,Q,te,me){if(te-Q<=j)return;const be=Q+te>>1;Je(re,z,be,Q,te,me%2),Ke(re,z,j,Q,be-1,me+1),Ke(re,z,j,be+1,te,me+1)}function Je(re,z,j,Q,te,me){for(;te>Q;){if(te-Q>600){const xe=te-Q+1,Ve=j-Q+1,Qe=Math.log(xe),Ue=.5*Math.exp(2*Qe/3),At=.5*Math.sqrt(Qe*Ue*(xe-Ue)/xe)*(Ve-xe/2<0?-1:1);Je(re,z,j,Math.max(Q,Math.floor(j-Ve*Ue/xe+At)),Math.min(te,Math.floor(j+(xe-Ve)*Ue/xe+At)),me)}const be=z[2*j+me];let ye=Q,pe=te;for(Ot(re,z,Q,j),z[2*te+me]>be&&Ot(re,z,Q,te);ye<pe;){for(Ot(re,z,ye,pe),ye++,pe--;z[2*ye+me]<be;)ye++;for(;z[2*pe+me]>be;)pe--}z[2*Q+me]===be?Ot(re,z,Q,pe):(pe++,Ot(re,z,pe,te)),pe<=j&&(Q=pe+1),j<=pe&&(te=pe-1)}}function Ot(re,z,j,Q){ht(re,j,Q),ht(z,2*j,2*Q),ht(z,2*j+1,2*Q+1)}function ht(re,z,j){const Q=re[z];re[z]=re[j],re[j]=Q}function Ct(re,z,j,Q){const te=re-j,me=z-Q;return te*te+me*me}le.exports=Jt,le.exports.fromVectorTileJs=Jt,le.exports.fromGeojsonVt=function(re,z){z=z||{};var j={};for(var Q in re)j[Q]=new Be(re[Q].features,z),j[Q].name=Q,j[Q].version=z.version,j[Q].extent=z.extent;return Jt({layers:j})},le.exports.GeoJSONWrapper=Be;const Zt=re=>re[0],lt=re=>re[1];class en{constructor(z,j=Zt,Q=lt,te=64,me=Float64Array){this.nodeSize=te,this.points=z;const be=z.length<65536?Uint16Array:Uint32Array,ye=this.ids=new be(z.length),pe=this.coords=new me(2*z.length);for(let xe=0;xe<z.length;xe++)ye[xe]=xe,pe[2*xe]=j(z[xe]),pe[2*xe+1]=Q(z[xe]);Ke(ye,pe,te,0,ye.length-1,0)}range(z,j,Q,te){return function(me,be,ye,pe,xe,Ve,Qe){const Ue=[0,me.length-1,0],At=[];let Rt,_t;for(;Ue.length;){const Vt=Ue.pop(),zt=Ue.pop(),cn=Ue.pop();if(zt-cn<=Qe){for(let fn=cn;fn<=zt;fn++)Rt=be[2*fn],_t=be[2*fn+1],Rt>=ye&&Rt<=xe&&_t>=pe&&_t<=Ve&&At.push(me[fn]);continue}const Kt=Math.floor((cn+zt)/2);Rt=be[2*Kt],_t=be[2*Kt+1],Rt>=ye&&Rt<=xe&&_t>=pe&&_t<=Ve&&At.push(me[Kt]);const Qt=(Vt+1)%2;(Vt===0?ye<=Rt:pe<=_t)&&(Ue.push(cn),Ue.push(Kt-1),Ue.push(Qt)),(Vt===0?xe>=Rt:Ve>=_t)&&(Ue.push(Kt+1),Ue.push(zt),Ue.push(Qt))}return At}(this.ids,this.coords,z,j,Q,te,this.nodeSize)}within(z,j,Q){return function(te,me,be,ye,pe,xe){const Ve=[0,te.length-1,0],Qe=[],Ue=pe*pe;for(;Ve.length;){const At=Ve.pop(),Rt=Ve.pop(),_t=Ve.pop();if(Rt-_t<=xe){for(let Qt=_t;Qt<=Rt;Qt++)Ct(me[2*Qt],me[2*Qt+1],be,ye)<=Ue&&Qe.push(te[Qt]);continue}const Vt=Math.floor((_t+Rt)/2),zt=me[2*Vt],cn=me[2*Vt+1];Ct(zt,cn,be,ye)<=Ue&&Qe.push(te[Vt]);const Kt=(At+1)%2;(At===0?be-pe<=zt:ye-pe<=cn)&&(Ve.push(_t),Ve.push(Vt-1),Ve.push(Kt)),(At===0?be+pe>=zt:ye+pe>=cn)&&(Ve.push(Vt+1),Ve.push(Rt),Ve.push(Kt))}return Qe}(this.ids,this.coords,z,j,Q,this.nodeSize)}}const Nn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:re=>re},Et=Math.fround||(Dt=new Float32Array(1),re=>(Dt[0]=+re,Dt[0]));var Dt;class mn{constructor(z){this.options=ms(Object.create(Nn),z),this.trees=new Array(this.options.maxZoom+1)}load(z){const{log:j,minZoom:Q,maxZoom:te,nodeSize:me}=this.options;j&&console.time("total time");const be=`prepare ${z.length} points`;j&&console.time(be),this.points=z;let ye=[];for(let pe=0;pe<z.length;pe++)z[pe].geometry&&ye.push(Hn(z[pe],pe));this.trees[te+1]=new en(ye,Ho,Ui,me,Float32Array),j&&console.timeEnd(be);for(let pe=te;pe>=Q;pe--){const xe=+Date.now();ye=this._cluster(ye,pe),this.trees[pe]=new en(ye,Ho,Ui,me,Float32Array),j&&console.log("z%d: %d clusters in %dms",pe,ye.length,+Date.now()-xe)}return j&&console.timeEnd("total time"),this}getClusters(z,j){let Q=((z[0]+180)%360+360)%360-180;const te=Math.max(-90,Math.min(90,z[1]));let me=z[2]===180?180:((z[2]+180)%360+360)%360-180;const be=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)Q=-180,me=180;else if(Q>me){const Ve=this.getClusters([Q,te,180,be],j),Qe=this.getClusters([-180,te,me,be],j);return Ve.concat(Qe)}const ye=this.trees[this._limitZoom(j)],pe=ye.range(gn(Q),ni(be),gn(me),ni(te)),xe=[];for(const Ve of pe){const Qe=ye.points[Ve];xe.push(Qe.numPoints?Qn(Qe):this.points[Qe.index])}return xe}getChildren(z){const j=this._getOriginId(z),Q=this._getOriginZoom(z),te="No cluster with the specified id.",me=this.trees[Q];if(!me)throw new Error(te);const be=me.points[j];if(!be)throw new Error(te);const ye=this.options.radius/(this.options.extent*Math.pow(2,Q-1)),pe=me.within(be.x,be.y,ye),xe=[];for(const Ve of pe){const Qe=me.points[Ve];Qe.parentId===z&&xe.push(Qe.numPoints?Qn(Qe):this.points[Qe.index])}if(xe.length===0)throw new Error(te);return xe}getLeaves(z,j,Q){const te=[];return this._appendLeaves(te,z,j=j||10,Q=Q||0,0),te}getTile(z,j,Q){const te=this.trees[this._limitZoom(z)],me=Math.pow(2,z),{extent:be,radius:ye}=this.options,pe=ye/be,xe=(Q-pe)/me,Ve=(Q+1+pe)/me,Qe={features:[]};return this._addTileFeatures(te.range((j-pe)/me,xe,(j+1+pe)/me,Ve),te.points,j,Q,me,Qe),j===0&&this._addTileFeatures(te.range(1-pe/me,xe,1,Ve),te.points,me,Q,me,Qe),j===me-1&&this._addTileFeatures(te.range(0,xe,pe/me,Ve),te.points,-1,Q,me,Qe),Qe.features.length?Qe:null}getClusterExpansionZoom(z){let j=this._getOriginZoom(z)-1;for(;j<=this.options.maxZoom;){const Q=this.getChildren(z);if(j++,Q.length!==1)break;z=Q[0].properties.cluster_id}return j}_appendLeaves(z,j,Q,te,me){const be=this.getChildren(j);for(const ye of be){const pe=ye.properties;if(pe&&pe.cluster?me+pe.point_count<=te?me+=pe.point_count:me=this._appendLeaves(z,pe.cluster_id,Q,te,me):me<te?me++:z.push(ye),z.length===Q)break}return me}_addTileFeatures(z,j,Q,te,me,be){for(const ye of z){const pe=j[ye],xe=pe.numPoints;let Ve,Qe,Ue;if(xe)Ve=Zs(pe),Qe=pe.x,Ue=pe.y;else{const _t=this.points[pe.index];Ve=_t.properties,Qe=gn(_t.geometry.coordinates[0]),Ue=ni(_t.geometry.coordinates[1])}const At={type:1,geometry:[[Math.round(this.options.extent*(Qe*me-Q)),Math.round(this.options.extent*(Ue*me-te))]],tags:Ve};let Rt;xe?Rt=pe.id:this.options.generateId?Rt=pe.index:this.points[pe.index].id&&(Rt=this.points[pe.index].id),Rt!==void 0&&(At.id=Rt),be.features.push(At)}}_limitZoom(z){return Math.max(this.options.minZoom,Math.min(Math.floor(+z),this.options.maxZoom+1))}_cluster(z,j){const Q=[],{radius:te,extent:me,reduce:be,minPoints:ye}=this.options,pe=te/(me*Math.pow(2,j));for(let xe=0;xe<z.length;xe++){const Ve=z[xe];if(Ve.zoom<=j)continue;Ve.zoom=j;const Qe=this.trees[j+1],Ue=Qe.within(Ve.x,Ve.y,pe),At=Ve.numPoints||1;let Rt=At;for(const _t of Ue){const Vt=Qe.points[_t];Vt.zoom>j&&(Rt+=Vt.numPoints||1)}if(Rt>At&&Rt>=ye){let _t=Ve.x*At,Vt=Ve.y*At,zt=be&&At>1?this._map(Ve,!0):null;const cn=(xe<<5)+(j+1)+this.points.length;for(const Kt of Ue){const Qt=Qe.points[Kt];if(Qt.zoom<=j)continue;Qt.zoom=j;const fn=Qt.numPoints||1;_t+=Qt.x*fn,Vt+=Qt.y*fn,Qt.parentId=cn,be&&(zt||(zt=this._map(Ve,!0)),be(zt,this._map(Qt)))}Ve.parentId=cn,Q.push(Mr(_t/Rt,Vt/Rt,cn,Rt,zt))}else if(Q.push(Ve),Rt>1)for(const _t of Ue){const Vt=Qe.points[_t];Vt.zoom<=j||(Vt.zoom=j,Q.push(Vt))}}return Q}_getOriginId(z){return z-this.points.length>>5}_getOriginZoom(z){return(z-this.points.length)%32}_map(z,j){if(z.numPoints)return j?ms({},z.properties):z.properties;const Q=this.points[z.index].properties,te=this.options.map(Q);return j&&te===Q?ms({},te):te}}function Mr(re,z,j,Q,te){return{x:Et(re),y:Et(z),zoom:1/0,id:j,parentId:-1,numPoints:Q,properties:te}}function Hn(re,z){const[j,Q]=re.geometry.coordinates;return{x:Et(gn(j)),y:Et(ni(Q)),zoom:1/0,index:z,parentId:-1}}function Qn(re){return{type:"Feature",id:re.id,properties:Zs(re),geometry:{type:"Point",coordinates:[(z=re.x,360*(z-.5)),gr(re.y)]}};var z}function Zs(re){const z=re.numPoints,j=z>=1e4?`${Math.round(z/1e3)}k`:z>=1e3?Math.round(z/100)/10+"k":z;return ms(ms({},re.properties),{cluster:!0,cluster_id:re.id,point_count:z,point_count_abbreviated:j})}function gn(re){return re/360+.5}function ni(re){const z=Math.sin(re*Math.PI/180),j=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return j<0?0:j>1?1:j}function gr(re){const z=(180-360*re)*Math.PI/180;return 360*Math.atan(Math.exp(z))/Math.PI-90}function ms(re,z){for(const j in z)re[j]=z[j];return re}function Ho(re){return re.x}function Ui(re){return re.y}function Vi(re,z,j,Q){for(var te,me=Q,be=j-z>>1,ye=j-z,pe=re[z],xe=re[z+1],Ve=re[j],Qe=re[j+1],Ue=z+3;Ue<j;Ue+=3){var At=So(re[Ue],re[Ue+1],pe,xe,Ve,Qe);if(At>me)te=Ue,me=At;else if(At===me){var Rt=Math.abs(Ue-be);Rt<ye&&(te=Ue,ye=Rt)}}me>Q&&(te-z>3&&Vi(re,z,te,Q),re[te+2]=me,j-te>3&&Vi(re,te,j,Q))}function So(re,z,j,Q,te,me){var be=te-j,ye=me-Q;if(be!==0||ye!==0){var pe=((re-j)*be+(z-Q)*ye)/(be*be+ye*ye);pe>1?(j=te,Q=me):pe>0&&(j+=be*pe,Q+=ye*pe)}return(be=re-j)*be+(ye=z-Q)*ye}function Qi(re,z,j,Q){var te={id:re===void 0?null:re,type:z,geometry:j,tags:Q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(me){var be=me.geometry,ye=me.type;if(ye==="Point"||ye==="MultiPoint"||ye==="LineString")je(me,be);else if(ye==="Polygon"||ye==="MultiLineString")for(var pe=0;pe<be.length;pe++)je(me,be[pe]);else if(ye==="MultiPolygon")for(pe=0;pe<be.length;pe++)for(var xe=0;xe<be[pe].length;xe++)je(me,be[pe][xe])}(te),te}function je(re,z){for(var j=0;j<z.length;j+=3)re.minX=Math.min(re.minX,z[j]),re.minY=Math.min(re.minY,z[j+1]),re.maxX=Math.max(re.maxX,z[j]),re.maxY=Math.max(re.maxY,z[j+1])}function dt(re,z,j,Q){if(z.geometry){var te=z.geometry.coordinates,me=z.geometry.type,be=Math.pow(j.tolerance/((1<<j.maxZoom)*j.extent),2),ye=[],pe=z.id;if(j.promoteId?pe=z.properties[j.promoteId]:j.generateId&&(pe=Q||0),me==="Point")Ms(te,ye);else if(me==="MultiPoint")for(var xe=0;xe<te.length;xe++)Ms(te[xe],ye);else if(me==="LineString")di(te,ye,be,!1);else if(me==="MultiLineString"){if(j.lineMetrics){for(xe=0;xe<te.length;xe++)di(te[xe],ye=[],be,!1),re.push(Qi(pe,"LineString",ye,z.properties));return}ln(te,ye,be,!1)}else if(me==="Polygon")ln(te,ye,be,!0);else{if(me!=="MultiPolygon"){if(me==="GeometryCollection"){for(xe=0;xe<z.geometry.geometries.length;xe++)dt(re,{id:pe,geometry:z.geometry.geometries[xe],properties:z.properties},j,Q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(xe=0;xe<te.length;xe++){var Ve=[];ln(te[xe],Ve,be,!0),ye.push(Ve)}}re.push(Qi(pe,me,ye,z.properties))}}function Ms(re,z){z.push(Li(re[0])),z.push(bi(re[1])),z.push(0)}function di(re,z,j,Q){for(var te,me,be=0,ye=0;ye<re.length;ye++){var pe=Li(re[ye][0]),xe=bi(re[ye][1]);z.push(pe),z.push(xe),z.push(0),ye>0&&(be+=Q?(te*xe-pe*me)/2:Math.sqrt(Math.pow(pe-te,2)+Math.pow(xe-me,2))),te=pe,me=xe}var Ve=z.length-3;z[2]=1,Vi(z,0,Ve,j),z[Ve+2]=1,z.size=Math.abs(be),z.start=0,z.end=z.size}function ln(re,z,j,Q){for(var te=0;te<re.length;te++){var me=[];di(re[te],me,j,Q),z.push(me)}}function Li(re){return re/360+.5}function bi(re){var z=Math.sin(re*Math.PI/180),j=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return j<0?0:j>1?1:j}function Me(re,z,j,Q,te,me,be,ye){if(Q/=z,me>=(j/=z)&&be<Q)return re;if(be<j||me>=Q)return null;for(var pe=[],xe=0;xe<re.length;xe++){var Ve=re[xe],Qe=Ve.geometry,Ue=Ve.type,At=te===0?Ve.minX:Ve.minY,Rt=te===0?Ve.maxX:Ve.maxY;if(At>=j&&Rt<Q)pe.push(Ve);else if(!(Rt<j||At>=Q)){var _t=[];if(Ue==="Point"||Ue==="MultiPoint")Ae(Qe,_t,j,Q,te);else if(Ue==="LineString")Ce(Qe,_t,j,Q,te,!1,ye.lineMetrics);else if(Ue==="MultiLineString")Ze(Qe,_t,j,Q,te,!1);else if(Ue==="Polygon")Ze(Qe,_t,j,Q,te,!0);else if(Ue==="MultiPolygon")for(var Vt=0;Vt<Qe.length;Vt++){var zt=[];Ze(Qe[Vt],zt,j,Q,te,!0),zt.length&&_t.push(zt)}if(_t.length){if(ye.lineMetrics&&Ue==="LineString"){for(Vt=0;Vt<_t.length;Vt++)pe.push(Qi(Ve.id,Ue,_t[Vt],Ve.tags));continue}Ue!=="LineString"&&Ue!=="MultiLineString"||(_t.length===1?(Ue="LineString",_t=_t[0]):Ue="MultiLineString"),Ue!=="Point"&&Ue!=="MultiPoint"||(Ue=_t.length===3?"Point":"MultiPoint"),pe.push(Qi(Ve.id,Ue,_t,Ve.tags))}}}return pe.length?pe:null}function Ae(re,z,j,Q,te){for(var me=0;me<re.length;me+=3){var be=re[me+te];be>=j&&be<=Q&&(z.push(re[me]),z.push(re[me+1]),z.push(re[me+2]))}}function Ce(re,z,j,Q,te,me,be){for(var ye,pe,xe=Ye(re),Ve=te===0?Ht:it,Qe=re.start,Ue=0;Ue<re.length-3;Ue+=3){var At=re[Ue],Rt=re[Ue+1],_t=re[Ue+2],Vt=re[Ue+3],zt=re[Ue+4],cn=te===0?At:Rt,Kt=te===0?Vt:zt,Qt=!1;be&&(ye=Math.sqrt(Math.pow(At-Vt,2)+Math.pow(Rt-zt,2))),cn<j?Kt>j&&(pe=Ve(xe,At,Rt,Vt,zt,j),be&&(xe.start=Qe+ye*pe)):cn>Q?Kt<Q&&(pe=Ve(xe,At,Rt,Vt,zt,Q),be&&(xe.start=Qe+ye*pe)):gt(xe,At,Rt,_t),Kt<j&&cn>=j&&(pe=Ve(xe,At,Rt,Vt,zt,j),Qt=!0),Kt>Q&&cn<=Q&&(pe=Ve(xe,At,Rt,Vt,zt,Q),Qt=!0),!me&&Qt&&(be&&(xe.end=Qe+ye*pe),z.push(xe),xe=Ye(re)),be&&(Qe+=ye)}var fn=re.length-3;At=re[fn],Rt=re[fn+1],_t=re[fn+2],(cn=te===0?At:Rt)>=j&&cn<=Q&&gt(xe,At,Rt,_t),fn=xe.length-3,me&&fn>=3&&(xe[fn]!==xe[0]||xe[fn+1]!==xe[1])&&gt(xe,xe[0],xe[1],xe[2]),xe.length&&z.push(xe)}function Ye(re){var z=[];return z.size=re.size,z.start=re.start,z.end=re.end,z}function Ze(re,z,j,Q,te,me){for(var be=0;be<re.length;be++)Ce(re[be],z,j,Q,te,me,!1)}function gt(re,z,j,Q){re.push(z),re.push(j),re.push(Q)}function Ht(re,z,j,Q,te,me){var be=(me-z)/(Q-z);return re.push(me),re.push(j+(te-j)*be),re.push(1),be}function it(re,z,j,Q,te,me){var be=(me-j)/(te-j);return re.push(z+(Q-z)*be),re.push(me),re.push(1),be}function Ut(re,z){for(var j=[],Q=0;Q<re.length;Q++){var te,me=re[Q],be=me.type;if(be==="Point"||be==="MultiPoint"||be==="LineString")te=Wt(me.geometry,z);else if(be==="MultiLineString"||be==="Polygon"){te=[];for(var ye=0;ye<me.geometry.length;ye++)te.push(Wt(me.geometry[ye],z))}else if(be==="MultiPolygon")for(te=[],ye=0;ye<me.geometry.length;ye++){for(var pe=[],xe=0;xe<me.geometry[ye].length;xe++)pe.push(Wt(me.geometry[ye][xe],z));te.push(pe)}j.push(Qi(me.id,be,te,me.tags))}return j}function Wt(re,z){var j=[];j.size=re.size,re.start!==void 0&&(j.start=re.start,j.end=re.end);for(var Q=0;Q<re.length;Q+=3)j.push(re[Q]+z,re[Q+1],re[Q+2]);return j}function Dn(re,z){if(re.transformed)return re;var j,Q,te,me=1<<re.z,be=re.x,ye=re.y;for(j=0;j<re.features.length;j++){var pe=re.features[j],xe=pe.geometry,Ve=pe.type;if(pe.geometry=[],Ve===1)for(Q=0;Q<xe.length;Q+=2)pe.geometry.push(An(xe[Q],xe[Q+1],z,me,be,ye));else for(Q=0;Q<xe.length;Q++){var Qe=[];for(te=0;te<xe[Q].length;te+=2)Qe.push(An(xe[Q][te],xe[Q][te+1],z,me,be,ye));pe.geometry.push(Qe)}}return re.transformed=!0,re}function An(re,z,j,Q,te,me){return[Math.round(j*(re*Q-te)),Math.round(j*(z*Q-me))]}function Pn(re,z,j,Q,te){for(var me=z===te.maxZoom?0:te.tolerance/((1<<z)*te.extent),be={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:j,y:Q,z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ye=0;ye<re.length;ye++){be.numFeatures++,on(be,re[ye],me,te);var pe=re[ye].minX,xe=re[ye].minY,Ve=re[ye].maxX,Qe=re[ye].maxY;pe<be.minX&&(be.minX=pe),xe<be.minY&&(be.minY=xe),Ve>be.maxX&&(be.maxX=Ve),Qe>be.maxY&&(be.maxY=Qe)}return be}function on(re,z,j,Q){var te=z.geometry,me=z.type,be=[];if(me==="Point"||me==="MultiPoint")for(var ye=0;ye<te.length;ye+=3)be.push(te[ye]),be.push(te[ye+1]),re.numPoints++,re.numSimplified++;else if(me==="LineString")qr(be,te,re,j,!1,!1);else if(me==="MultiLineString"||me==="Polygon")for(ye=0;ye<te.length;ye++)qr(be,te[ye],re,j,me==="Polygon",ye===0);else if(me==="MultiPolygon")for(var pe=0;pe<te.length;pe++){var xe=te[pe];for(ye=0;ye<xe.length;ye++)qr(be,xe[ye],re,j,!0,ye===0)}if(be.length){var Ve=z.tags||null;if(me==="LineString"&&Q.lineMetrics){for(var Qe in Ve={},z.tags)Ve[Qe]=z.tags[Qe];Ve.mapbox_clip_start=te.start/te.size,Ve.mapbox_clip_end=te.end/te.size}var Ue={geometry:be,type:me==="Polygon"||me==="MultiPolygon"?3:me==="LineString"||me==="MultiLineString"?2:1,tags:Ve};z.id!==null&&(Ue.id=z.id),re.features.push(Ue)}}function qr(re,z,j,Q,te,me){var be=Q*Q;if(Q>0&&z.size<(te?be:Q))j.numPoints+=z.length/3;else{for(var ye=[],pe=0;pe<z.length;pe+=3)(Q===0||z[pe+2]>be)&&(j.numSimplified++,ye.push(z[pe]),ye.push(z[pe+1])),j.numPoints++;te&&function(xe,Ve){for(var Qe=0,Ue=0,At=xe.length,Rt=At-2;Ue<At;Rt=Ue,Ue+=2)Qe+=(xe[Ue]-xe[Rt])*(xe[Ue+1]+xe[Rt+1]);if(Qe>0===Ve)for(Ue=0,At=xe.length;Ue<At/2;Ue+=2){var _t=xe[Ue],Vt=xe[Ue+1];xe[Ue]=xe[At-2-Ue],xe[Ue+1]=xe[At-1-Ue],xe[At-2-Ue]=_t,xe[At-1-Ue]=Vt}}(ye,me),re.push(ye)}}function ri(re,z){var j=(z=this.options=function(te,me){for(var be in me)te[be]=me[be];return te}(Object.create(this.options),z)).debug;if(j&&console.time("preprocess data"),z.maxZoom<0||z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(z.promoteId&&z.generateId)throw new Error("promoteId and generateId cannot be used together.");var Q=function(te,me){var be=[];if(te.type==="FeatureCollection")for(var ye=0;ye<te.features.length;ye++)dt(be,te.features[ye],me,ye);else dt(be,te.type==="Feature"?te:{geometry:te},me);return be}(re,z);this.tiles={},this.tileCoords=[],j&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",z.indexMaxZoom,z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Q=function(te,me){var be=me.buffer/me.extent,ye=te,pe=Me(te,1,-1-be,be,0,-1,2,me),xe=Me(te,1,1-be,2+be,0,-1,2,me);return(pe||xe)&&(ye=Me(te,1,-be,1+be,0,-1,2,me)||[],pe&&(ye=Ut(pe,1).concat(ye)),xe&&(ye=ye.concat(Ut(xe,-1)))),ye}(Q,z),Q.length&&this.splitTile(Q,0,0,0),j&&(Q.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function xi(re,z,j){return 32*((1<<re)*j+z)+re}function Gi(re,z){const j=re.tileID.canonical;if(!this._geoJSONIndex)return z(null,null);const Q=this._geoJSONIndex.getTile(j.z,j.x,j.y);if(!Q)return z(null,null);const te=new he(Q.features);let me=le.exports(te);me.byteOffset===0&&me.byteLength===me.buffer.byteLength||(me=new Uint8Array(me)),z(null,{vectorTile:te,rawData:me.buffer})}ri.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ri.prototype.splitTile=function(re,z,j,Q,te,me,be){for(var ye=[re,z,j,Q],pe=this.options,xe=pe.debug;ye.length;){Q=ye.pop(),j=ye.pop(),z=ye.pop(),re=ye.pop();var Ve=1<<z,Qe=xi(z,j,Q),Ue=this.tiles[Qe];if(!Ue&&(xe>1&&console.time("creation"),Ue=this.tiles[Qe]=Pn(re,z,j,Q,pe),this.tileCoords.push({z,x:j,y:Q}),xe)){xe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",z,j,Q,Ue.numFeatures,Ue.numPoints,Ue.numSimplified),console.timeEnd("creation"));var At="z"+z;this.stats[At]=(this.stats[At]||0)+1,this.total++}if(Ue.source=re,te){if(z===pe.maxZoom||z===te)continue;var Rt=1<<te-z;if(j!==Math.floor(me/Rt)||Q!==Math.floor(be/Rt))continue}else if(z===pe.indexMaxZoom||Ue.numPoints<=pe.indexMaxPoints)continue;if(Ue.source=null,re.length!==0){xe>1&&console.time("clipping");var _t,Vt,zt,cn,Kt,Qt,fn=.5*pe.buffer/pe.extent,vn=.5-fn,er=.5+fn,tr=1+fn;_t=Vt=zt=cn=null,Kt=Me(re,Ve,j-fn,j+er,0,Ue.minX,Ue.maxX,pe),Qt=Me(re,Ve,j+vn,j+tr,0,Ue.minX,Ue.maxX,pe),re=null,Kt&&(_t=Me(Kt,Ve,Q-fn,Q+er,1,Ue.minY,Ue.maxY,pe),Vt=Me(Kt,Ve,Q+vn,Q+tr,1,Ue.minY,Ue.maxY,pe),Kt=null),Qt&&(zt=Me(Qt,Ve,Q-fn,Q+er,1,Ue.minY,Ue.maxY,pe),cn=Me(Qt,Ve,Q+vn,Q+tr,1,Ue.minY,Ue.maxY,pe),Qt=null),xe>1&&console.timeEnd("clipping"),ye.push(_t||[],z+1,2*j,2*Q),ye.push(Vt||[],z+1,2*j,2*Q+1),ye.push(zt||[],z+1,2*j+1,2*Q),ye.push(cn||[],z+1,2*j+1,2*Q+1)}}},ri.prototype.getTile=function(re,z,j){var Q=this.options,te=Q.extent,me=Q.debug;if(re<0||re>24)return null;var be=1<<re,ye=xi(re,z=(z%be+be)%be,j);if(this.tiles[ye])return Dn(this.tiles[ye],te);me>1&&console.log("drilling down to z%d-%d-%d",re,z,j);for(var pe,xe=re,Ve=z,Qe=j;!pe&&xe>0;)xe--,Ve=Math.floor(Ve/2),Qe=Math.floor(Qe/2),pe=this.tiles[xi(xe,Ve,Qe)];return pe&&pe.source?(me>1&&console.log("found parent tile z%d-%d-%d",xe,Ve,Qe),me>1&&console.time("drilling down"),this.splitTile(pe.source,xe,Ve,Qe,re,z,j),me>1&&console.timeEnd("drilling down"),this.tiles[ye]?Dn(this.tiles[ye],te):null):null};class es extends D{constructor(z,j,Q,te){super(z,j,Q,Gi),te&&(this.loadGeoJSON=te)}loadData(z,j){var Q;(Q=this._pendingRequest)===null||Q===void 0||Q.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const te=!!(z&&z.request&&z.request.collectResourceTiming)&&new o.RequestPerformance(z.request);this._pendingCallback=j,this._pendingRequest=this.loadGeoJSON(z,(me,be)=>{if(delete this._pendingCallback,delete this._pendingRequest,me||!be)return j(me);if(typeof be!="object")return j(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`));{F(be,!0);try{if(z.filter){const pe=o.createExpression(z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(pe.result==="error")throw new Error(pe.value.map(Ve=>`${Ve.key}: ${Ve.message}`).join(", "));be={type:"FeatureCollection",features:be.features.filter(Ve=>pe.value.evaluate({zoom:0},Ve))}}this._geoJSONIndex=z.cluster?new mn(function({superclusterOptions:pe,clusterProperties:xe}){if(!xe||!pe)return pe;const Ve={},Qe={},Ue={accumulated:null,zoom:0},At={properties:null},Rt=Object.keys(xe);for(const _t of Rt){const[Vt,zt]=xe[_t],cn=o.createExpression(zt),Kt=o.createExpression(typeof Vt=="string"?[Vt,["accumulated"],["get",_t]]:Vt);Ve[_t]=cn.value,Qe[_t]=Kt.value}return pe.map=_t=>{At.properties=_t;const Vt={};for(const zt of Rt)Vt[zt]=Ve[zt].evaluate(Ue,At);return Vt},pe.reduce=(_t,Vt)=>{At.properties=Vt;for(const zt of Rt)Ue.accumulated=_t[zt],_t[zt]=Qe[zt].evaluate(Ue,At)},pe}(z)).load(be.features):function(pe,xe){return new ri(pe,xe)}(be,z.geojsonVtOptions)}catch(pe){return j(pe)}this.loaded={};const ye={};if(te){const pe=te.finish();pe&&(ye.resourceTiming={},ye.resourceTiming[z.source]=JSON.parse(JSON.stringify(pe)))}j(null,ye)}})}reloadTile(z,j){const Q=this.loaded;return Q&&Q[z.uid]?super.reloadTile(z,j):this.loadTile(z,j)}loadGeoJSON(z,j){if(z.request)return o.getJSON(z.request,j);if(typeof z.data=="string")try{j(null,JSON.parse(z.data))}catch{j(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`))}else j(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(z,j){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),j()}getClusterExpansionZoom(z,j){try{j(null,this._geoJSONIndex.getClusterExpansionZoom(z.clusterId))}catch(Q){j(Q)}}getClusterChildren(z,j){try{j(null,this._geoJSONIndex.getChildren(z.clusterId))}catch(Q){j(Q)}}getClusterLeaves(z,j){try{j(null,this._geoJSONIndex.getLeaves(z.clusterId,z.limit,z.offset))}catch(Q){j(Q)}}}class Ao{constructor(z){this.self=z,this.actor=new o.Actor(z,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:D,geojson:es},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(j,Q)=>{if(this.workerSourceTypes[j])throw new Error(`Worker source with name "${j}" already registered.`);this.workerSourceTypes[j]=Q},this.self.registerRTLTextPlugin=j=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=j.applyArabicShaping,o.plugin.processBidirectionalText=j.processBidirectionalText,o.plugin.processStyledBidirectionalText=j.processStyledBidirectionalText}}setReferrer(z,j){this.referrer=j}setImages(z,j,Q){this.availableImages[z]=j;for(const te in this.workerSources[z]){const me=this.workerSources[z][te];for(const be in me)me[be].availableImages=j}Q()}setLayers(z,j,Q){this.getLayerIndex(z).replace(j),Q()}updateLayers(z,j,Q){this.getLayerIndex(z).update(j.layers,j.removedIds),Q()}loadTile(z,j,Q){this.getWorkerSource(z,j.type,j.source).loadTile(j,Q)}loadDEMTile(z,j,Q){this.getDEMWorkerSource(z,j.source).loadTile(j,Q)}reloadTile(z,j,Q){this.getWorkerSource(z,j.type,j.source).reloadTile(j,Q)}abortTile(z,j,Q){this.getWorkerSource(z,j.type,j.source).abortTile(j,Q)}removeTile(z,j,Q){this.getWorkerSource(z,j.type,j.source).removeTile(j,Q)}removeDEMTile(z,j){this.getDEMWorkerSource(z,j.source).removeTile(j)}removeSource(z,j,Q){if(!this.workerSources[z]||!this.workerSources[z][j.type]||!this.workerSources[z][j.type][j.source])return;const te=this.workerSources[z][j.type][j.source];delete this.workerSources[z][j.type][j.source],te.removeSource!==void 0?te.removeSource(j,Q):Q()}loadWorkerSource(z,j,Q){try{this.self.importScripts(j.url),Q()}catch(te){Q(te.toString())}}syncRTLPluginState(z,j,Q){try{o.plugin.setState(j);const te=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&te!=null){this.self.importScripts(te);const me=o.plugin.isParsed();Q(me?void 0:new Error(`RTL Text Plugin failed to import scripts from ${te}`),me)}}catch(te){Q(te.toString())}}getAvailableImages(z){let j=this.availableImages[z];return j||(j=[]),j}getLayerIndex(z){let j=this.layerIndexes[z];return j||(j=this.layerIndexes[z]=new x),j}getWorkerSource(z,j,Q){if(this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][j]||(this.workerSources[z][j]={}),!this.workerSources[z][j][Q]){const te={send:(me,be,ye)=>{this.actor.send(me,be,ye,z)}};this.workerSources[z][j][Q]=new this.workerSourceTypes[j](te,this.getLayerIndex(z),this.getAvailableImages(z))}return this.workerSources[z][j][Q]}getDEMWorkerSource(z,j){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][j]||(this.demWorkerSources[z][j]=new H),this.demWorkerSources[z][j]}enforceCacheSizeLimit(z,j){o.enforceCacheSizeLimit(j)}}return o.isWorker()&&(self.worker=new Ao(self)),Ao}),s(["./shared"],function(o){var f=m;function m(y){return!function(l){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,v,w=new Blob([""],{type:"text/javascript"}),A=URL.createObjectURL(w);try{v=new Worker(A),g=!0}catch{g=!1}return v&&v.terminate(),URL.revokeObjectURL(A),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var v=g.getContext("2d");if(!v)return!1;var w=v.getImageData(0,0,1,1);return w&&w.width===g.width}()?(x[h=l&&l.failIfMajorPerformanceCaveat]===void 0&&(x[h]=function(g){var v,w=function(A){var L=document.createElement("canvas"),$=Object.create(m.webGLContextAttributes);return $.failIfMajorPerformanceCaveat=A,L.getContext("webgl",$)||L.getContext("experimental-webgl",$)}(g);if(!w)return!1;try{v=w.createShader(w.VERTEX_SHADER)}catch{return!1}return!(!v||w.isContextLost())&&(w.shaderSource(v,"void main() {}"),w.compileShader(v),w.getShaderParameter(v,w.COMPILE_STATUS)===!0)}(h)),x[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var h}(y)}var x={};function S(y,l){if(Array.isArray(y)){if(!Array.isArray(l)||y.length!==l.length)return!1;for(let h=0;h<y.length;h++)if(!S(y[h],l[h]))return!1;return!0}if(typeof y=="object"&&y!==null&&l!==null){if(typeof l!="object"||Object.keys(y).length!==Object.keys(l).length)return!1;for(const h in y)if(!S(y[h],l[h]))return!1;return!0}return y===l}m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class T{static testProp(l){if(!T.docStyle)return l[0];for(let h=0;h<l.length;h++)if(l[h]in T.docStyle)return l[h];return l[0]}static create(l,h,g){const v=window.document.createElement(l);return h!==void 0&&(v.className=h),g&&g.appendChild(v),v}static createNS(l,h){return window.document.createElementNS(l,h)}static disableDrag(){T.docStyle&&T.selectProp&&(T.userSelect=T.docStyle[T.selectProp],T.docStyle[T.selectProp]="none")}static enableDrag(){T.docStyle&&T.selectProp&&(T.docStyle[T.selectProp]=T.userSelect)}static setTransform(l,h){l.style[T.transformProp]=h}static addEventListener(l,h,g,v={}){l.addEventListener(h,g,"passive"in v?v:v.capture)}static removeEventListener(l,h,g,v={}){l.removeEventListener(h,g,"passive"in v?v:v.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",T.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",T.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",T.suppressClickInternal,!0)},0)}static mousePos(l,h){const g=l.getBoundingClientRect();return new o.pointGeometry(h.clientX-g.left-l.clientLeft,h.clientY-g.top-l.clientTop)}static touchPos(l,h){const g=l.getBoundingClientRect(),v=[];for(let w=0;w<h.length;w++)v.push(new o.pointGeometry(h[w].clientX-g.left-l.clientLeft,h[w].clientY-g.top-l.clientTop));return v}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}}T.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,T.selectProp=T.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),T.transformProp=T.testProp(["transform","WebkitTransform"]);class C{constructor(l){this._transformRequestFn=l}transformRequest(l,h){return this._transformRequestFn&&this._transformRequestFn(l,h)||{url:l}}normalizeSpriteURL(l,h,g){const v=function(w){const A=w.match(R);if(!A)throw new Error(`Unable to parse URL "${w}"`);return{protocol:A[1],authority:A[2],path:A[3]||"/",params:A[4]?A[4].split("&"):[]}}(l);return v.path+=`${h}${g}`,function(w){const A=w.params.length?`?${w.params.join("&")}`:"";return`${w.protocol}://${w.authority}${w.path}${A}`}(v)}setTransformRequest(l){this._transformRequestFn=l}}const R=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class D{constructor(l,h,g,v){this.context=l,this.format=g,this.texture=l.gl.createTexture(),this.update(h,v)}update(l,h,g){const{width:v,height:w}=l,A=!(this.size&&this.size[0]===v&&this.size[1]===w||g),{context:L}=this,{gl:$}=L;if(this.useMipmap=!!(h&&h.useMipmap),$.bindTexture($.TEXTURE_2D,this.texture),L.pixelStoreUnpackFlipY.set(!1),L.pixelStoreUnpack.set(1),L.pixelStoreUnpackPremultiplyAlpha.set(this.format===$.RGBA&&(!h||h.premultiply!==!1)),A)this.size=[v,w],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.isImageBitmap(l)?$.texImage2D($.TEXTURE_2D,0,this.format,this.format,$.UNSIGNED_BYTE,l):$.texImage2D($.TEXTURE_2D,0,this.format,v,w,0,this.format,$.UNSIGNED_BYTE,l.data);else{const{x:O,y:V}=g||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||o.isImageBitmap(l)?$.texSubImage2D($.TEXTURE_2D,0,O,V,$.RGBA,$.UNSIGNED_BYTE,l):$.texSubImage2D($.TEXTURE_2D,0,O,V,v,w,$.RGBA,$.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&$.generateMipmap($.TEXTURE_2D)}bind(l,h,g){const{context:v}=this,{gl:w}=v;w.bindTexture(w.TEXTURE_2D,this.texture),g!==w.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=w.LINEAR),l!==this.filter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,l),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,g||l),this.filter=l),h!==this.wrap&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,h),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,h),this.wrap=h)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}function H(y){const{userImage:l}=y;return!!(l&&l.render&&l.render())&&(y.data.replace(new Uint8Array(l.data.buffer)),!0)}class F extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:h,callback:g}of this.requestors)this._notify(h,g);this.requestors=[]}}getImage(l){return this.images[l]}addImage(l,h){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,h)&&(this.images[l]=h)}_validate(l,h){let g=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),g=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),g=!1),this._validateContent(h.content,h)||(this.fire(new o.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),g=!1),g}_validateStretch(l,h){if(!l)return!0;let g=0;for(const v of l){if(v[0]<g||v[1]<v[0]||h<v[1])return!1;g=v[1]}return!0}_validateContent(l,h){return!(l&&(l.length!==4||l[0]<0||h.data.width<l[0]||l[1]<0||h.data.height<l[1]||l[2]<0||h.data.width<l[2]||l[3]<0||h.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,h){const g=this.images[l];if(g.data.width!==h.data.width||g.data.height!==h.data.height)throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${h.data.width}x${h.data.height}).`);h.version=g.version+1,this.images[l]=h,this.updatedImages[l]=!0}removeImage(l){const h=this.images[l];delete this.images[l],delete this.patterns[l],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,h){let g=!0;if(!this.isLoaded())for(const v of l)this.images[v]||(g=!1);this.isLoaded()||g?this._notify(l,h):this.requestors.push({ids:l,callback:h})}_notify(l,h){const g={};for(const v of l){this.images[v]||this.fire(new o.Event("styleimagemissing",{id:v}));const w=this.images[v];w?g[v]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:!!(w.userImage&&w.userImage.render)}:o.warnOnce(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,g)}getPixelSize(){const{width:l,height:h}=this.atlasImage;return{width:l,height:h}}getPattern(l){const h=this.patterns[l],g=this.getImage(l);if(!g)return null;if(h&&h.position.version===g.version)return h.position;if(h)h.position.version=g.version;else{const v={w:g.data.width+2,h:g.data.height+2,x:0,y:0},w=new o.ImagePosition(v,g);this.patterns[l]={bin:v,position:w}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const h=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new D(l,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const w in this.patterns)l.push(this.patterns[w].bin);const{w:h,h:g}=o.potpack(l),v=this.atlasImage;v.resize({width:h||1,height:g||1});for(const w in this.patterns){const{bin:A}=this.patterns[w],L=A.x+1,$=A.y+1,O=this.images[w].data,V=O.width,W=O.height;o.RGBAImage.copy(O,v,{x:0,y:0},{x:L,y:$},{width:V,height:W}),o.RGBAImage.copy(O,v,{x:0,y:W-1},{x:L,y:$-1},{width:V,height:1}),o.RGBAImage.copy(O,v,{x:0,y:0},{x:L,y:$+W},{width:V,height:1}),o.RGBAImage.copy(O,v,{x:V-1,y:0},{x:L-1,y:$},{width:1,height:W}),o.RGBAImage.copy(O,v,{x:0,y:0},{x:L+V,y:$},{width:1,height:W})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const h of l){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const g=this.images[h];g||o.warnOnce(`Image with ID: "${h}" was not found`),H(g)&&this.updateImage(h,g)}}}const k=1e20;function N(y,l,h,g,v,w,A,L,$){for(let O=l;O<l+g;O++)U(y,h*w+O,w,v,A,L,$);for(let O=h;O<h+v;O++)U(y,O*w+l,1,g,A,L,$)}function U(y,l,h,g,v,w,A){w[0]=0,A[0]=-k,A[1]=k,v[0]=y[l];for(let L=1,$=0,O=0;L<g;L++){v[L]=y[l+L*h];const V=L*L;do{const W=w[$];O=(v[L]-v[W]+V-W*W)/(L-W)/2}while(O<=A[$]&&--$>-1);$++,w[$]=L,A[$]=O,A[$+1]=k}for(let L=0,$=0;L<g;L++){for(;A[$+1]<L;)$++;const O=w[$],V=L-O;y[l+L*h]=v[O]+V*V}}class ie{constructor(l,h){this.requestManager=l,this.localIdeographFontFamily=h,this.entries={}}setURL(l){this.url=l}getGlyphs(l,h){const g=[];for(const v in l)for(const w of l[v])g.push({stack:v,id:w});o.asyncAll(g,({stack:v,id:w},A)=>{let L=this.entries[v];L||(L=this.entries[v]={glyphs:{},requests:{},ranges:{}});let $=L.glyphs[w];if($!==void 0)return void A(null,{stack:v,id:w,glyph:$});if($=this._tinySDF(L,v,w),$)return L.glyphs[w]=$,void A(null,{stack:v,id:w,glyph:$});const O=Math.floor(w/256);if(256*O>65535)return void A(new Error("glyphs > 65535 not supported"));if(L.ranges[O])return void A(null,{stack:v,id:w,glyph:$});let V=L.requests[O];V||(V=L.requests[O]=[],ie.loadGlyphRange(v,O,this.url,this.requestManager,(W,X)=>{if(X){for(const ae in X)this._doesCharSupportLocalGlyph(+ae)||(L.glyphs[+ae]=X[+ae]);L.ranges[O]=!0}for(const ae of V)ae(W,X);delete L.requests[O]})),V.push((W,X)=>{W?A(W):X&&A(null,{stack:v,id:w,glyph:X[w]||null})})},(v,w)=>{if(v)h(v);else if(w){const A={};for(const{stack:L,id:$,glyph:O}of w)(A[L]||(A[L]={}))[$]=O&&{id:O.id,bitmap:O.bitmap.clone(),metrics:O.metrics};h(null,A)}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(o.unicodeBlockLookup["CJK Unified Ideographs"](l)||o.unicodeBlockLookup["Hangul Syllables"](l)||o.unicodeBlockLookup.Hiragana(l)||o.unicodeBlockLookup.Katakana(l))}_tinySDF(l,h,g){const v=this.localIdeographFontFamily;if(!v||!this._doesCharSupportLocalGlyph(g))return;let w=l.tinySDF;if(!w){let L="400";/bold/i.test(h)?L="900":/medium/i.test(h)?L="500":/light/i.test(h)&&(L="200"),w=l.tinySDF=new ie.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:v,fontWeight:L})}const A=w.draw(String.fromCharCode(g));return{id:g,bitmap:new o.AlphaImage({width:A.width||30,height:A.height||30},A.data),metrics:{width:A.glyphWidth||24,height:A.glyphHeight||24,left:A.glyphLeft||0,top:A.glyphTop-27||-8,advance:A.glyphAdvance||24}}}}ie.loadGlyphRange=function(y,l,h,g,v){const w=256*l,A=w+255,L=g.transformRequest(h.replace("{fontstack}",y).replace("{range}",`${w}-${A}`),o.ResourceType.Glyphs);o.getArrayBuffer(L,($,O)=>{if($)v($);else if(O){const V={};for(const W of o.parseGlyphPbf(O))V[W.id]=W;v(null,V)}})},ie.TinySDF=class{constructor({fontSize:y=24,buffer:l=3,radius:h=8,cutoff:g=.25,fontFamily:v="sans-serif",fontWeight:w="normal",fontStyle:A="normal"}={}){this.buffer=l,this.cutoff=g,this.radius=h;const L=this.size=y+4*l,$=this._createCanvas(L),O=this.ctx=$.getContext("2d",{willReadFrequently:!0});O.font=`${A} ${w} ${y}px ${v}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(L*L),this.gridInner=new Float64Array(L*L),this.f=new Float64Array(L),this.z=new Float64Array(L+1),this.v=new Uint16Array(L)}_createCanvas(y){const l=document.createElement("canvas");return l.width=l.height=y,l}draw(y){const{width:l,actualBoundingBoxAscent:h,actualBoundingBoxDescent:g,actualBoundingBoxLeft:v,actualBoundingBoxRight:w}=this.ctx.measureText(y),A=Math.ceil(h),L=Math.min(this.size-this.buffer,Math.ceil(w-v)),$=Math.min(this.size-this.buffer,A+Math.ceil(g)),O=L+2*this.buffer,V=$+2*this.buffer,W=Math.max(O*V,0),X=new Uint8ClampedArray(W),ae={data:X,width:O,height:V,glyphWidth:L,glyphHeight:$,glyphTop:A,glyphLeft:0,glyphAdvance:l};if(L===0||$===0)return ae;const{ctx:se,buffer:oe,gridInner:_e,gridOuter:Te}=this;se.clearRect(oe,oe,L,$),se.fillText(y,oe,oe+A);const Le=se.getImageData(oe,oe,L,$);Te.fill(k,0,W),_e.fill(0,0,W);for(let ue=0;ue<$;ue++)for(let Fe=0;Fe<L;Fe++){const ke=Le.data[4*(ue*L+Fe)+3]/255;if(ke===0)continue;const He=(ue+oe)*O+Fe+oe;if(ke===1)Te[He]=0,_e[He]=k;else{const We=.5-ke;Te[He]=We>0?We*We:0,_e[He]=We<0?We*We:0}}N(Te,0,0,O,V,O,this.f,this.v,this.z),N(_e,oe,oe,L,$,O,this.f,this.v,this.z);for(let ue=0;ue<W;ue++){const Fe=Math.sqrt(Te[ue])-Math.sqrt(_e[ue]);X[ue]=Math.round(255-255*(Fe/this.radius+this.cutoff))}return ae}};const he=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(y,l){return o.sphericalToCartesian(y.expression.evaluate(l))}interpolate(y,l,h){return{x:o.number(y.x,l.x,h),y:o.number(y.y,l.y,h),z:o.number(y.z,l.z,h)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),le="-transition";class ve extends o.Evented{constructor(l){super(),this._transitionable=new o.Transitionable(he),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,h={}){if(!this._validate(o.validateLight,l,h))for(const g in l){const v=l[g];g.endsWith(le)?this._transitionable.setTransition(g.slice(0,-le.length),v):this._transitionable.setValue(g,v)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,h,g){return(!g||g.validate!==!1)&&o.emitValidationErrors(this,l.call(o.validateStyle,o.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Oe{constructor(l,h){this.width=l,this.height=h,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,h){const g=l.join(",")+String(h);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(l,h)),this.dashEntry[g]}getDashRanges(l,h,g){const v=[];let w=l.length%2==1?-l[l.length-1]*g:0,A=l[0]*g,L=!0;v.push({left:w,right:A,isDash:L,zeroLength:l[0]===0});let $=l[0];for(let O=1;O<l.length;O++){L=!L;const V=l[O];w=$*g,$+=V,A=$*g,v.push({left:w,right:A,isDash:L,zeroLength:V===0})}return v}addRoundDash(l,h,g){const v=h/2;for(let w=-g;w<=g;w++){const A=this.width*(this.nextRow+g+w);let L=0,$=l[L];for(let O=0;O<this.width;O++){O/$.right>1&&($=l[++L]);const V=Math.abs(O-$.left),W=Math.abs(O-$.right),X=Math.min(V,W);let ae;const se=w/g*(v+1);if($.isDash){const oe=v-Math.abs(se);ae=Math.sqrt(X*X+oe*oe)}else ae=v-Math.sqrt(X*X+se*se);this.data[A+O]=Math.max(0,Math.min(255,ae+128))}}}addRegularDash(l){for(let L=l.length-1;L>=0;--L){const $=l[L],O=l[L+1];$.zeroLength?l.splice(L,1):O&&O.isDash===$.isDash&&(O.left=$.left,l.splice(L,1))}const h=l[0],g=l[l.length-1];h.isDash===g.isDash&&(h.left=g.left-this.width,g.right=h.right+this.width);const v=this.width*this.nextRow;let w=0,A=l[w];for(let L=0;L<this.width;L++){L/A.right>1&&(A=l[++w]);const $=Math.abs(L-A.left),O=Math.abs(L-A.right),V=Math.min($,O);this.data[v+L]=Math.max(0,Math.min(255,(A.isDash?V:-V)+128))}}addDash(l,h){const g=h?7:0,v=2*g+1;if(this.nextRow+v>this.height)return o.warnOnce("LineAtlas out of space"),null;let w=0;for(let L=0;L<l.length;L++)w+=l[L];if(w!==0){const L=this.width/w,$=this.getDashRanges(l,this.width,L);h?this.addRoundDash($,L,g):this.addRegularDash($)}const A={y:(this.nextRow+g+.5)/this.height,height:2*g/this.height,width:w};return this.nextRow+=v,this.dirty=!0,A}bind(l){const h=l.gl;this.texture?(h.bindTexture(h.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,h.texSubImage2D(h.TEXTURE_2D,0,0,0,this.width,this.height,h.ALPHA,h.UNSIGNED_BYTE,this.data))):(this.texture=h.createTexture(),h.bindTexture(h.TEXTURE_2D,this.texture),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texImage2D(h.TEXTURE_2D,0,h.ALPHA,this.width,this.height,0,h.ALPHA,h.UNSIGNED_BYTE,this.data))}}class Re{constructor(l,h){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const g=this.workerPool.acquire(this.id);for(let v=0;v<g.length;v++){const w=new Re.Actor(g[v],h,this.id);w.name=`Worker ${v}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,h,g){o.asyncAll(this.actors,(v,w)=>{v.send(l,h,w)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(l=>{l.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Ee(y,l,h){const g=function(v,w){if(v)return h(v);if(w){const A=o.pick(o.extend(w,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(A.vectorLayers=w.vector_layers,A.vectorLayerIds=A.vectorLayers.map(L=>L.id)),h(null,A)}};return y.url?o.getJSON(l.transformRequest(y.url,o.ResourceType.Source),g):o.exported.frame(()=>g(null,y))}Re.Actor=o.Actor;class $e{constructor(l,h,g){this.bounds=o.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=h||0,this.maxzoom=g||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const h=Math.pow(2,l.z),g=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*h),v=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*h),w=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*h),A=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*h);return l.x>=g&&l.x<w&&l.y>=v&&l.y<A}}class we extends o.Evented{constructor(l,h,g,v){if(super(),this.id=l,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(h,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v)}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ee(this._options,this.map._requestManager,(l,h)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),l?this.fire(new o.ErrorEvent(l)):h&&(o.extend(this,h),h.bounds&&(this.tileBounds=new $e(h.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(l,h){const g=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),v={request:this.map._requestManager.transformRequest(g,o.ResourceType.Tile),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function w(A,L){return delete l.request,l.aborted?h(null):A&&A.status!==404?h(A):(L&&L.resourceTiming&&(l.resourceTiming=L.resourceTiming),this.map._refreshExpiredTiles&&L&&l.setExpiryData(L),l.loadVectorData(L,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}v.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired"?l.state==="loading"?l.reloadCallback=h:l.request=l.actor.send("reloadTile",v,w.bind(this)):(l.actor=this.dispatcher.getActor(),l.request=l.actor.send("loadTile",v,w.bind(this)))}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id},void 0)}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class Be extends o.Evented{constructor(l,h,g,v){super(),this.id=l,this.dispatcher=g,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},h),o.extend(this,o.pick(h,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ee(this._options,this.map._requestManager,(l,h)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new o.ErrorEvent(l)):h&&(o.extend(this,h),h.bounds&&(this.tileBounds=new $e(h.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,h){const g=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.request=o.getImage(this.map._requestManager.transformRequest(g,o.ResourceType.Tile),(v,w,A)=>{if(delete l.request,l.aborted)l.state="unloaded",h(null);else if(v)l.state="errored",h(v);else if(w){this.map._refreshExpiredTiles&&l.setExpiryData(A);const L=this.map.painter.context,$=L.gl;l.texture=this.map.painter.getTileTexture(w.width),l.texture?l.texture.update(w,{useMipmap:!0}):(l.texture=new D(L,w,$.RGBA,{useMipmap:!0}),l.texture.bind($.LINEAR,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST),L.extTextureFilterAnisotropic&&$.texParameterf($.TEXTURE_2D,L.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,L.extTextureFilterAnisotropicMax)),l.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),h(null)}})}abortTile(l,h){l.request&&(l.request.cancel(),delete l.request),h()}unloadTile(l,h){l.texture&&this.map.painter.saveTileTexture(l.texture),h()}hasTransition(){return!1}}let Jt;class mt extends Be{constructor(l,h,g,v){super(l,h,g,v),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(l,h){const g=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function v(w,A){w&&(l.state="errored",h(w)),A&&(l.dem=A,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded",h(null))}l.request=o.getImage(this.map._requestManager.transformRequest(g,o.ResourceType.Tile),function(w,A){if(delete l.request,l.aborted)l.state="unloaded",h(null);else if(w)l.state="errored",h(w);else if(A){this.map._refreshExpiredTiles&&l.setExpiryData(A),delete A.cacheControl,delete A.expires;const L=o.isImageBitmap(A)&&(Jt==null&&(Jt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Jt)?A:o.exported.getImageData(A,1),$={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:L,encoding:this.encoding};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",$,v.bind(this)))}}.bind(this)),l.neighboringTiles=this._getNeighboringTiles(l.tileID)}_getNeighboringTiles(l){const h=l.canonical,g=Math.pow(2,h.z),v=(h.x-1+g)%g,w=h.x===0?l.wrap-1:l.wrap,A=(h.x+1+g)%g,L=h.x+1===g?l.wrap+1:l.wrap,$={};return $[new o.OverscaledTileID(l.overscaledZ,w,h.z,v,h.y).key]={backfilled:!1},$[new o.OverscaledTileID(l.overscaledZ,L,h.z,A,h.y).key]={backfilled:!1},h.y>0&&($[new o.OverscaledTileID(l.overscaledZ,w,h.z,v,h.y-1).key]={backfilled:!1},$[new o.OverscaledTileID(l.overscaledZ,l.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},$[new o.OverscaledTileID(l.overscaledZ,L,h.z,A,h.y-1).key]={backfilled:!1}),h.y+1<g&&($[new o.OverscaledTileID(l.overscaledZ,w,h.z,v,h.y+1).key]={backfilled:!1},$[new o.OverscaledTileID(l.overscaledZ,l.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},$[new o.OverscaledTileID(l.overscaledZ,L,h.z,A,h.y+1).key]={backfilled:!1}),$}unloadTile(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&l.actor.send("removeDEMTile",{uid:l.uid,source:this.id})}}class an extends o.Evented{constructor(l,h,g,v){super(),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=g.getActor(),this.setEventedParent(v),this._data=h.data,this._options=o.extend({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const w=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*w,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*w,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:o.EXTENT,radius:(h.clusterRadius||50)*w,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData("content"),this}getClusterExpansionZoom(l,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},h),this}getClusterChildren(l,h){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},h),this}getClusterLeaves(l,h,g,v){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:h,offset:g},v),this}_updateWorkerData(l){const h=o.extend({},this.workerOptions),g=this._data;typeof g=="string"?(h.request=this.map._requestManager.transformRequest(o.exported.resolveURL(g),o.ResourceType.Source),h.request.collectResourceTiming=this._collectResourceTiming):h.data=JSON.stringify(g),this._pendingLoads++,this.fire(new o.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,h,(v,w)=>{if(this._pendingLoads--,this._removed||w&&w.abandoned)return void this.fire(new o.Event("dataabort",{dataType:"source",sourceDataType:l}));let A=null;if(w&&w.resourceTiming&&w.resourceTiming[this.id]&&(A=w.resourceTiming[this.id].slice(0)),v)return void this.fire(new o.ErrorEvent(v));const L={dataType:"source",sourceDataType:l};this._collectResourceTiming&&A&&A.length>0&&o.extend(L,{resourceTiming:A}),this.fire(new o.Event("data",L))})}loaded(){return this._pendingLoads===0}loadTile(l,h){const g=l.actor?"reloadTile":"loadTile";l.actor=this.actor;const v={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.request=this.actor.send(g,v,(w,A)=>(delete l.request,l.unloadVectorData(),l.aborted?h(null):w?h(w):(l.loadVectorData(A,this.map.painter,g==="reloadTile"),h(null))))}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0}unloadTile(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var ot=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class It extends o.Evented{constructor(l,h,g,v){super(),this.id=l,this.dispatcher=g,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=h}load(l,h){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(g,v)=>{this._loaded=!0,g?this.fire(new o.ErrorEvent(g)):v&&(this.image=v,l&&(this.coordinates=l),h&&h(),this._finishLoading())})}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this.options.url=l.url,this.load(l.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}setCoordinates(l){this.coordinates=l;const h=l.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(v){let w=1/0,A=1/0,L=-1/0,$=-1/0;for(const X of v)w=Math.min(w,X.x),A=Math.min(A,X.y),L=Math.max(L,X.x),$=Math.max($,X.y);const O=Math.max(L-w,$-A),V=Math.max(0,Math.floor(-Math.log(O)/Math.LN2)),W=Math.pow(2,V);return new o.CanonicalTileID(V,Math.floor((w+L)/2*W),Math.floor((A+$)/2*W))}(h),this.minzoom=this.maxzoom=this.tileID.z;const g=h.map(v=>this.tileID.getTilePoint(v)._round());return this._boundsArray=new o.RasterBoundsArray,this._boundsArray.emplaceBack(g[0].x,g[0].y,0,0),this._boundsArray.emplaceBack(g[1].x,g[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(g[3].x,g[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(g[2].x,g[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const l=this.map.painter.context,h=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,ot.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new D(l,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));for(const g in this.tiles){const v=this.tiles[g];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture)}}loadTile(l,h){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},h(null)):(l.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class at extends It{constructor(l,h,g,v){super(l,h,g,v),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const l=this.options;this.urls=[];for(const h of l.urls)this.urls.push(this.map._requestManager.transformRequest(h,o.ResourceType.Source).url);o.getVideo(this.urls,(h,g)=>{this._loaded=!0,h?this.fire(new o.ErrorEvent(h)):g&&(this.video=g,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){const h=this.video.seekable;l<h.start(0)||l>h.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const l=this.map.painter.context,h=l.gl;this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,ot.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new D(l,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE));for(const g in this.tiles){const v=this.tiles[g];v.state!=="loaded"&&(v.state="loaded",v.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class kt extends It{constructor(l,h,g,v){super(l,h,g,v),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(A=>typeof A!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${l}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let l=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,l=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,l=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context,g=h.gl;this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,ot.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(l||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new D(h,this.canvas,g.RGBA,{premultiply:!0});for(const v in this.tiles){const w=this.tiles[v];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}const Pe={vector:we,raster:Be,"raster-dem":mt,geojson:an,video:at,image:It,canvas:kt};function Ke(y,l){const h=o.create();return o.translate(h,h,[1,1,0]),o.scale(h,h,[.5*y.width,.5*y.height,1]),o.multiply(h,h,y.calculatePosMatrix(l.toUnwrapped()))}function Je(y,l,h,g,v,w){const A=function(W,X,ae){if(W)for(const se of W){const oe=X[se];if(oe&&oe.source===ae&&oe.type==="fill-extrusion")return!0}else for(const se in X){const oe=X[se];if(oe.source===ae&&oe.type==="fill-extrusion")return!0}return!1}(v&&v.layers,l,y.id),L=w.maxPitchScaleFactor(),$=y.tilesIn(g,L,A);$.sort(Ot);const O=[];for(const W of $)O.push({wrappedTileID:W.tileID.wrapped().key,queryResults:W.tile.queryRenderedFeatures(l,h,y._state,W.queryGeometry,W.cameraQueryGeometry,W.scale,v,w,L,Ke(y.transform,W.tileID))});const V=function(W){const X={},ae={};for(const se of W){const oe=se.queryResults,_e=se.wrappedTileID,Te=ae[_e]=ae[_e]||{};for(const Le in oe){const ue=oe[Le],Fe=Te[Le]=Te[Le]||{},ke=X[Le]=X[Le]||[];for(const He of ue)Fe[He.featureIndex]||(Fe[He.featureIndex]=!0,ke.push(He))}}return X}(O);for(const W in V)V[W].forEach(X=>{const ae=X.feature,se=y.getFeatureState(ae.layer["source-layer"],ae.id);ae.source=ae.layer.source,ae.layer["source-layer"]&&(ae.sourceLayer=ae.layer["source-layer"]),ae.state=se});return V}function Ot(y,l){const h=y.tileID,g=l.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}class ht{constructor(l,h){this.tileID=l,this.uid=o.uniqueId(),this.uses=0,this.tileSize=h,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){const h=l+this.timeAdded;h<o.exported.now()||this.fadeEndTime&&h<this.fadeEndTime||(this.fadeEndTime=h)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.textures.forEach(h=>l.saveTileTexture(h)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(l,h,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(v,w){const A={};if(!w)return A;for(const L of v){const $=L.layerIds.map(O=>w.getLayer(O)).filter(Boolean);if($.length!==0){L.layers=$,L.stateDependentLayerIds&&(L.stateDependentLayers=L.stateDependentLayerIds.map(O=>$.filter(V=>V.id===O)[0]));for(const O of $)A[O.id]=L}}return A}(l.buckets,h.style),this.hasSymbolBuckets=!1;for(const v in this.buckets){const w=this.buckets[v];if(w instanceof o.SymbolBucket){if(this.hasSymbolBuckets=!0,!g)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const v in this.buckets){const w=this.buckets[v];if(w instanceof o.SymbolBucket&&w.hasRTLText){this.hasRTLText=!0,o.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const v in this.buckets){const w=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,h.style.getLayer(v).queryRadius(w))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new o.CollisionBoxArray}unloadVectorData(){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(const g in this.buckets){const v=this.buckets[g];v.uploadPending()&&v.upload(l)}const h=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new D(l,this.imageAtlas.image,h.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new D(l,this.glyphAtlasImage,h.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,h,g,v,w,A,L,$,O,V){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:v,cameraQueryGeometry:w,scale:A,tileSize:this.tileSize,pixelPosMatrix:V,transform:$,params:L,queryPadding:this.queryPadding*O},l,h,g):{}}querySourceFeatures(l,h){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const v=g.loadVTLayers(),w=h?h.sourceLayer:"",A=v._geojsonTileLayer||v[w];if(!A)return;const L=o.createFilter(h&&h.filter),{z:$,x:O,y:V}=this.tileID.canonical,W={z:$,x:O,y:V};for(let X=0;X<A.length;X++){const ae=A.feature(X);if(L.needGeometry){const _e=o.toEvaluationFeature(ae,!0);if(!L.filter(new o.EvaluationParameters(this.tileID.overscaledZ),_e,this.tileID.canonical))continue}else if(!L.filter(new o.EvaluationParameters(this.tileID.overscaledZ),ae))continue;const se=g.getId(ae,w),oe=new o.GeoJSONFeature(ae,$,O,V,se);oe.tile=W,l.push(oe)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const h=this.expirationTime;if(l.cacheControl){const g=o.parseCacheControl(l.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const g=Date.now();let v=!1;if(this.expirationTime>g)v=!1;else if(h)if(this.expirationTime<h)v=!0;else{const w=this.expirationTime-h;w?this.expirationTime=g+Math.max(w,3e4):v=!0}else v=!0;v?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,h){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const v in this.buckets){if(!h.style.hasLayer(v))continue;const w=this.buckets[v],A=w.layers[0].sourceLayer||"_geojsonTileLayer",L=g[A],$=l[A];if(!L||!$||Object.keys($).length===0)continue;w.update($,L,this.imageAtlas&&this.imageAtlas.patternPositions||{});const O=h&&h.style&&h.style.getLayer(v);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=o.exported.now()+l}setDependencies(l,h){const g={};for(const v of h)g[v]=!0;this.dependencies[l]=g}hasDependency(l,h){for(const g of l){const v=this.dependencies[g];if(v){for(const w of h)if(v[w])return!0}}return!1}}class Ct{constructor(l,h){this.max=l,this.onRemove=h,this.reset()}reset(){for(const l in this.data)for(const h of this.data[l])h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value);return this.data={},this.order=[],this}add(l,h,g){const v=l.wrapped().key;this.data[v]===void 0&&(this.data[v]=[]);const w={value:h,timeout:void 0};if(g!==void 0&&(w.timeout=setTimeout(()=>{this.remove(l,w)},g)),this.data[v].push(w),this.order.push(v),this.order.length>this.max){const A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const h=this.data[l].shift();return h.timeout&&clearTimeout(h.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),h.value}getByKey(l){const h=this.data[l];return h?h[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,h){if(!this.has(l))return this;const g=l.wrapped().key,v=h===void 0?0:this.data[g].indexOf(h),w=this.data[g][v];return this.data[g].splice(v,1),w.timeout&&clearTimeout(w.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(w.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const h=this._getAndRemoveByKey(this.order[0]);h&&this.onRemove(h)}return this}filter(l){const h=[];for(const g in this.data)for(const v of this.data[g])l(v.value)||h.push(v);for(const g of h)this.remove(g.value.tileID,g)}}class Zt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,h,g){const v=String(h);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][v]=this.stateChanges[l][v]||{},o.extend(this.stateChanges[l][v],g),this.deletedStates[l]===null){this.deletedStates[l]={};for(const w in this.state[l])w!==v&&(this.deletedStates[l][w]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][v]===null){this.deletedStates[l][v]={};for(const w in this.state[l][v])g[w]||(this.deletedStates[l][v][w]=null)}else for(const w in g)this.deletedStates[l]&&this.deletedStates[l][v]&&this.deletedStates[l][v][w]===null&&delete this.deletedStates[l][v][w]}removeFeatureState(l,h,g){if(this.deletedStates[l]===null)return;const v=String(h);if(this.deletedStates[l]=this.deletedStates[l]||{},g&&h!==void 0)this.deletedStates[l][v]!==null&&(this.deletedStates[l][v]=this.deletedStates[l][v]||{},this.deletedStates[l][v][g]=null);else if(h!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][v])for(g in this.deletedStates[l][v]={},this.stateChanges[l][v])this.deletedStates[l][v][g]=null;else this.deletedStates[l][v]=null;else this.deletedStates[l]=null}getState(l,h){const g=String(h),v=o.extend({},(this.state[l]||{})[g],(this.stateChanges[l]||{})[g]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const w=this.deletedStates[l][h];if(w===null)return{};for(const A in w)delete v[A]}return v}initializeTileState(l,h){l.setFeatureState(this.state,h)}coalesceChanges(l,h){const g={};for(const v in this.stateChanges){this.state[v]=this.state[v]||{};const w={};for(const A in this.stateChanges[v])this.state[v][A]||(this.state[v][A]={}),o.extend(this.state[v][A],this.stateChanges[v][A]),w[A]=this.state[v][A];g[v]=w}for(const v in this.deletedStates){this.state[v]=this.state[v]||{};const w={};if(this.deletedStates[v]===null)for(const A in this.state[v])w[A]={},this.state[v][A]={};else for(const A in this.deletedStates[v]){if(this.deletedStates[v][A]===null)this.state[v][A]={};else for(const L of Object.keys(this.deletedStates[v][A]))delete this.state[v][A][L];w[A]=this.state[v][A]}g[v]=g[v]||{},o.extend(g[v],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const v in l)l[v].setFeatureState(g,h)}}class lt extends o.Evented{constructor(l,h,g){super(),this.id=l,this.dispatcher=g,this.on("data",v=>{v.dataType==="source"&&v.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&v.dataType==="source"&&v.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(v,w,A,L){const $=new Pe[w.type](v,w,A,L);if($.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${$.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],$),$}(l,h,g,this),this._tiles={},this._cache=new Ct(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Zt}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const l in this._tiles){const h=this._tiles[l];if(h.state!=="loaded"&&h.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,h){return this._source.loadTile(l,h)}_unloadTile(l){if(this._source.unloadTile)return this._source.unloadTile(l,()=>{})}_abortTile(l){this._source.abortTile&&this._source.abortTile(l,()=>{}),this._source.fire(new o.Event("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const h in this._tiles){const g=this._tiles[h];g.upload(l),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(en).map(l=>l.key)}getRenderableIds(l){const h=[];for(const g in this._tiles)this._isIdRenderable(g,l)&&h.push(this._tiles[g]);return l?h.sort((g,v)=>{const w=g.tileID,A=v.tileID,L=new o.pointGeometry(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),$=new o.pointGeometry(A.canonical.x,A.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-A.overscaledZ||$.y-L.y||$.x-L.x}).map(g=>g.tileID.key):h.map(g=>g.tileID).sort(en).map(g=>g.key)}hasRenderableParent(l){const h=this.findLoadedParent(l,0);return!!h&&this._isIdRenderable(h.tileID.key)}_isIdRenderable(l,h){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(h||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(l,h){const g=this._tiles[l];g&&(g.state!=="loading"&&(g.state=h),this._loadTile(g,this._tileLoaded.bind(this,g,l,h)))}_tileLoaded(l,h,g,v){if(v)return l.state="errored",void(v.status!==404?this._source.fire(new o.ErrorEvent(v,{tile:l})):this.update(this.transform,this.terrain));l.timeAdded=o.exported.now(),g==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(h,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new o.Event("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){const h=this.getRenderableIds();for(let v=0;v<h.length;v++){const w=h[v];if(l.neighboringTiles&&l.neighboringTiles[w]){const A=this.getTileByID(w);g(l,A),g(A,l)}}function g(v,w){v.needsHillshadePrepare=!0,v.needsTerrainPrepare=!0;let A=w.tileID.canonical.x-v.tileID.canonical.x;const L=w.tileID.canonical.y-v.tileID.canonical.y,$=Math.pow(2,v.tileID.canonical.z),O=w.tileID.key;A===0&&L===0||Math.abs(L)>1||(Math.abs(A)>1&&(Math.abs(A+$)===1?A+=$:Math.abs(A-$)===1&&(A-=$)),w.dem&&v.dem&&(v.dem.backfillBorder(w.dem,A,L),v.neighboringTiles&&v.neighboringTiles[O]&&(v.neighboringTiles[O].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,h,g,v){for(const w in this._tiles){let A=this._tiles[w];if(v[w]||!A.hasData()||A.tileID.overscaledZ<=h||A.tileID.overscaledZ>g)continue;let L=A.tileID;for(;A&&A.tileID.overscaledZ>h+1;){const O=A.tileID.scaledTo(A.tileID.overscaledZ-1);A=this._tiles[O.key],A&&A.hasData()&&(L=O)}let $=L;for(;$.overscaledZ>h;)if($=$.scaledTo($.overscaledZ-1),l[$.key]){v[L.key]=L;break}}}findLoadedParent(l,h){if(l.key in this._loadedParentTiles){const g=this._loadedParentTiles[l.key];return g&&g.tileID.overscaledZ>=h?g:null}for(let g=l.overscaledZ-1;g>=h;g--){const v=l.scaledTo(g),w=this._getLoadedTile(v);if(w)return w}}_getLoadedTile(l){const h=this._tiles[l.key];return h&&h.hasData()?h:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){const h=Math.ceil(l.width/this._source.tileSize)+1,g=Math.ceil(l.height/this._source.tileSize)+1,v=Math.floor(h*g*5),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(w)}handleWrapJump(l){const h=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,h){const g={};for(const v in this._tiles){const w=this._tiles[v];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+h),g[w.tileID.key]=w}this._tiles=g;for(const v in this._timers)clearTimeout(this._timers[v]),delete this._timers[v];for(const v in this._tiles)this._setTileReloadTimer(v,this._tiles[v])}}update(l,h){if(this.transform=l,this.terrain=h,!this._sourceLoaded||this._paused)return;let g;this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(O=>new o.OverscaledTileID(O.canonical.z,O.wrap,O.canonical.z,O.canonical.x,O.canonical.y)):(g=l.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:h}),this._source.hasTile&&(g=g.filter(O=>this._source.hasTile(O)))):g=[];const v=l.coveringZoomLevel(this._source),w=Math.max(v-lt.maxOverzooming,this._source.minzoom),A=Math.max(v+lt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const O={};for(const V of g)if(V.canonical.z>this._source.minzoom){const W=V.scaledTo(V.canonical.z-1);O[W.key]=W;const X=V.scaledTo(Math.max(this._source.minzoom,Math.min(V.canonical.z,5)));O[X.key]=X}g=g.concat(Object.values(O))}const L=this._updateRetainedTiles(g,v);if(Nn(this._source.type)){const O={},V={},W=Object.keys(L);for(const X of W){const ae=L[X],se=this._tiles[X];if(!se||se.fadeEndTime&&se.fadeEndTime<=o.exported.now())continue;const oe=this.findLoadedParent(ae,w);oe&&(this._addTile(oe.tileID),O[oe.tileID.key]=oe.tileID),V[X]=ae}this._retainLoadedChildren(V,v,A,L);for(const X in O)L[X]||(this._coveredTiles[X]=!0,L[X]=O[X]);if(h){const X={},ae={};for(const se of g)this._tiles[se.key].hasData()?X[se.key]=se:ae[se.key]=se;for(const se in ae){const oe=ae[se].children(this._source.maxzoom);this._tiles[oe[0].key]&&this._tiles[oe[1].key]&&this._tiles[oe[2].key]&&this._tiles[oe[3].key]&&(X[oe[0].key]=L[oe[0].key]=oe[0],X[oe[1].key]=L[oe[1].key]=oe[1],X[oe[2].key]=L[oe[2].key]=oe[2],X[oe[3].key]=L[oe[3].key]=oe[3],delete ae[se])}for(const se in ae){const oe=this.findLoadedParent(ae[se],this._source.minzoom);if(oe){X[oe.tileID.key]=L[oe.tileID.key]=oe.tileID;for(const _e in X)X[_e].isChildOf(oe.tileID)&&delete X[_e]}}for(const se in this._tiles)X[se]||(this._coveredTiles[se]=!0)}}for(const O in L)this._tiles[O].clearFadeHold();const $=o.keysDifference(this._tiles,L);for(const O of $){const V=this._tiles[O];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(O)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,h){const g={},v={},w=Math.max(h-lt.maxOverzooming,this._source.minzoom),A=Math.max(h+lt.maxUnderzooming,this._source.minzoom),L={};for(const $ of l){const O=this._addTile($);g[$.key]=$,O.hasData()||h<this._source.maxzoom&&(L[$.key]=$)}this._retainLoadedChildren(L,h,A,g);for(const $ of l){let O=this._tiles[$.key];if(O.hasData())continue;if(h+1>this._source.maxzoom){const W=$.children(this._source.maxzoom)[0],X=this.getTile(W);if(X&&X.hasData()){g[W.key]=W;continue}}else{const W=$.children(this._source.maxzoom);if(g[W[0].key]&&g[W[1].key]&&g[W[2].key]&&g[W[3].key])continue}let V=O.wasRequested();for(let W=$.overscaledZ-1;W>=w;--W){const X=$.scaledTo(W);if(v[X.key]||(v[X.key]=!0,O=this.getTile(X),!O&&V&&(O=this._addTile(X)),O&&(g[X.key]=X,V=O.wasRequested(),O.hasData())))break}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const h=[];let g,v=this._tiles[l].tileID;for(;v.overscaledZ>0;){if(v.key in this._loadedParentTiles){g=this._loadedParentTiles[v.key];break}h.push(v.key);const w=v.scaledTo(v.overscaledZ-1);if(g=this._getLoadedTile(w),g)break;v=w}for(const w of h)this._loadedParentTiles[w]=g}}_addTile(l){let h=this._tiles[l.key];if(h)return h;h=this._cache.getAndRemove(l),h&&(this._setTileReloadTimer(l.key,h),h.tileID=l,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,h)));const g=h;return h||(h=new ht(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(h,this._tileLoaded.bind(this,h,l.key,h.state))),h.uses++,this._tiles[l.key]=h,g||this._source.fire(new o.Event("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h}_setTileReloadTimer(l,h){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const g=h.getExpiryTimeout();g&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},g))}_removeTile(l){const h=this._tiles[l];h&&(h.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),h.uses>0||(h.hasData()&&h.state!=="reloading"?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,h,g){const v=[],w=this.transform;if(!w)return v;const A=g?w.getCameraQueryGeometry(l):l,L=l.map(se=>w.pointCoordinate(se,this.terrain)),$=A.map(se=>w.pointCoordinate(se,this.terrain)),O=this.getIds();let V=1/0,W=1/0,X=-1/0,ae=-1/0;for(const se of $)V=Math.min(V,se.x),W=Math.min(W,se.y),X=Math.max(X,se.x),ae=Math.max(ae,se.y);for(let se=0;se<O.length;se++){const oe=this._tiles[O[se]];if(oe.holdingForFade())continue;const _e=oe.tileID,Te=Math.pow(2,w.zoom-oe.tileID.overscaledZ),Le=h*oe.queryPadding*o.EXTENT/oe.tileSize/Te,ue=[_e.getTilePoint(new o.MercatorCoordinate(V,W)),_e.getTilePoint(new o.MercatorCoordinate(X,ae))];if(ue[0].x-Le<o.EXTENT&&ue[0].y-Le<o.EXTENT&&ue[1].x+Le>=0&&ue[1].y+Le>=0){const Fe=L.map(He=>_e.getTilePoint(He)),ke=$.map(He=>_e.getTilePoint(He));v.push({tile:oe,tileID:_e,queryGeometry:Fe,cameraQueryGeometry:ke,scale:Te})}}return v}getVisibleCoordinates(l){const h=this.getRenderableIds(l).map(g=>this._tiles[g].tileID);for(const g of h)g.posMatrix=this.transform.calculatePosMatrix(g.toUnwrapped());return h}hasTransition(){if(this._source.hasTransition())return!0;if(Nn(this._source.type))for(const l in this._tiles){const h=this._tiles[l];if(h.fadeEndTime!==void 0&&h.fadeEndTime>=o.exported.now())return!0}return!1}setFeatureState(l,h,g){this._state.updateState(l=l||"_geojsonTileLayer",h,g)}removeFeatureState(l,h,g){this._state.removeFeatureState(l=l||"_geojsonTileLayer",h,g)}getFeatureState(l,h){return this._state.getState(l=l||"_geojsonTileLayer",h)}setDependencies(l,h,g){const v=this._tiles[l];v&&v.setDependencies(h,g)}reloadTilesForDependencies(l,h){for(const g in this._tiles)this._tiles[g].hasDependency(l,h)&&this._reloadTile(g,"reloading");this._cache.filter(g=>!g.hasDependency(l,h))}}function en(y,l){const h=Math.abs(2*y.wrap)-+(y.wrap<0),g=Math.abs(2*l.wrap)-+(l.wrap<0);return y.overscaledZ-l.overscaledZ||g-h||l.canonical.y-y.canonical.y||l.canonical.x-y.canonical.x}function Nn(y){return y==="raster"||y==="image"||y==="video"}lt.maxOverzooming=10,lt.maxUnderzooming=3;const Et="mapboxgl_preloaded_worker_pool";class Dt{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<Dt.workerCount;)this.workers.push(new Worker(Ja.workerUrl));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Et]}numActive(){return Object.keys(this.active).length}}const mn=Math.floor(o.exported.hardwareConcurrency/2);let Mr;function Hn(){return Mr||(Mr=new Dt),Mr}function Qn(y,l){const h={};for(const g in y)g!=="ref"&&(h[g]=y[g]);return o.refProperties.forEach(g=>{g in l&&(h[g]=l[g])}),h}function Zs(y){y=y.slice();const l=Object.create(null);for(let h=0;h<y.length;h++)l[y[h].id]=y[h];for(let h=0;h<y.length;h++)"ref"in y[h]&&(y[h]=Qn(y[h],l[y[h].ref]));return y}Dt.workerCount=Math.max(Math.min(mn,6),1);const gn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ni(y,l,h){h.push({command:gn.addSource,args:[y,l[y]]})}function gr(y,l,h){l.push({command:gn.removeSource,args:[y]}),h[y]=!0}function ms(y,l,h,g){gr(y,h,g),ni(y,l,h)}function Ho(y,l,h){let g;for(g in y[h])if(Object.prototype.hasOwnProperty.call(y[h],g)&&g!=="data"&&!S(y[h][g],l[h][g]))return!1;for(g in l[h])if(Object.prototype.hasOwnProperty.call(l[h],g)&&g!=="data"&&!S(y[h][g],l[h][g]))return!1;return!0}function Ui(y,l,h,g,v,w){let A;for(A in l=l||{},y=y||{})Object.prototype.hasOwnProperty.call(y,A)&&(S(y[A],l[A])||h.push({command:w,args:[g,A,l[A],v]}));for(A in l)Object.prototype.hasOwnProperty.call(l,A)&&!Object.prototype.hasOwnProperty.call(y,A)&&(S(y[A],l[A])||h.push({command:w,args:[g,A,l[A],v]}))}function Vi(y){return y.id}function So(y,l){return y[l.id]=l,y}class Qi{constructor(l,h){this.reset(l,h)}reset(l,h){this.points=l||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=o.clamp(l,0,1);let h=1,g=this._distances[h];const v=l*this.paddedLength+this.padding;for(;g<v&&h<this._distances.length;)g=this._distances[++h];const w=h-1,A=this._distances[w],L=g-A,$=L>0?(v-A)/L:0;return this.points[w].mult(1-$).add(this.points[h].mult($))}}function je(y,l){let h=!0;return y==="always"||y!=="never"&&l!=="never"||(h=!1),h}class dt{constructor(l,h,g){const v=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(l/g),this.yCellCount=Math.ceil(h/g);for(let A=0;A<this.xCellCount*this.yCellCount;A++)v.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=h,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,h,g,v,w){this._forEachCell(h,g,v,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(v),this.bboxes.push(w)}insertCircle(l,h,g,v){this._forEachCell(h-v,g-v,h+v,g+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(h),this.circles.push(g),this.circles.push(v)}_insertBoxCell(l,h,g,v,w,A){this.boxCells[w].push(A)}_insertCircleCell(l,h,g,v,w,A){this.circleCells[w].push(A)}_query(l,h,g,v,w,A,L){if(g<0||l>this.width||v<0||h>this.height)return[];const $=[];if(l<=0&&h<=0&&this.width<=g&&this.height<=v){if(w)return[{key:null,x1:l,y1:h,x2:g,y2:v}];for(let O=0;O<this.boxKeys.length;O++)$.push({key:this.boxKeys[O],x1:this.bboxes[4*O],y1:this.bboxes[4*O+1],x2:this.bboxes[4*O+2],y2:this.bboxes[4*O+3]});for(let O=0;O<this.circleKeys.length;O++){const V=this.circles[3*O],W=this.circles[3*O+1],X=this.circles[3*O+2];$.push({key:this.circleKeys[O],x1:V-X,y1:W-X,x2:V+X,y2:W+X})}}else this._forEachCell(l,h,g,v,this._queryCell,$,{hitTest:w,overlapMode:A,seenUids:{box:{},circle:{}}},L);return $}query(l,h,g,v){return this._query(l,h,g,v,!1,null)}hitTest(l,h,g,v,w,A){return this._query(l,h,g,v,!0,w,A).length>0}hitTestCircle(l,h,g,v,w){const A=l-g,L=l+g,$=h-g,O=h+g;if(L<0||A>this.width||O<0||$>this.height)return!1;const V=[];return this._forEachCell(A,$,L,O,this._queryCellCircle,V,{hitTest:!0,overlapMode:v,circle:{x:l,y:h,radius:g},seenUids:{box:{},circle:{}}},w),V.length>0}_queryCell(l,h,g,v,w,A,L,$){const{seenUids:O,hitTest:V,overlapMode:W}=L,X=this.boxCells[w];if(X!==null){const se=this.bboxes;for(const oe of X)if(!O.box[oe]){O.box[oe]=!0;const _e=4*oe,Te=this.boxKeys[oe];if(l<=se[_e+2]&&h<=se[_e+3]&&g>=se[_e+0]&&v>=se[_e+1]&&(!$||$(Te))&&(!V||!je(W,Te.overlapMode))&&(A.push({key:Te,x1:se[_e],y1:se[_e+1],x2:se[_e+2],y2:se[_e+3]}),V))return!0}}const ae=this.circleCells[w];if(ae!==null){const se=this.circles;for(const oe of ae)if(!O.circle[oe]){O.circle[oe]=!0;const _e=3*oe,Te=this.circleKeys[oe];if(this._circleAndRectCollide(se[_e],se[_e+1],se[_e+2],l,h,g,v)&&(!$||$(Te))&&(!V||!je(W,Te.overlapMode))){const Le=se[_e],ue=se[_e+1],Fe=se[_e+2];if(A.push({key:Te,x1:Le-Fe,y1:ue-Fe,x2:Le+Fe,y2:ue+Fe}),V)return!0}}}return!1}_queryCellCircle(l,h,g,v,w,A,L,$){const{circle:O,seenUids:V,overlapMode:W}=L,X=this.boxCells[w];if(X!==null){const se=this.bboxes;for(const oe of X)if(!V.box[oe]){V.box[oe]=!0;const _e=4*oe,Te=this.boxKeys[oe];if(this._circleAndRectCollide(O.x,O.y,O.radius,se[_e+0],se[_e+1],se[_e+2],se[_e+3])&&(!$||$(Te))&&!je(W,Te.overlapMode))return A.push(!0),!0}}const ae=this.circleCells[w];if(ae!==null){const se=this.circles;for(const oe of ae)if(!V.circle[oe]){V.circle[oe]=!0;const _e=3*oe,Te=this.circleKeys[oe];if(this._circlesCollide(se[_e],se[_e+1],se[_e+2],O.x,O.y,O.radius)&&(!$||$(Te))&&!je(W,Te.overlapMode))return A.push(!0),!0}}}_forEachCell(l,h,g,v,w,A,L,$){const O=this._convertToXCellCoord(l),V=this._convertToYCellCoord(h),W=this._convertToXCellCoord(g),X=this._convertToYCellCoord(v);for(let ae=O;ae<=W;ae++)for(let se=V;se<=X;se++)if(w.call(this,l,h,g,v,this.xCellCount*se+ae,A,L,$))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,h,g,v,w,A){const L=v-l,$=w-h,O=g+A;return O*O>L*L+$*$}_circleAndRectCollide(l,h,g,v,w,A,L){const $=(A-v)/2,O=Math.abs(l-(v+$));if(O>$+g)return!1;const V=(L-w)/2,W=Math.abs(h-(w+V));if(W>V+g)return!1;if(O<=$||W<=V)return!0;const X=O-$,ae=W-V;return X*X+ae*ae<=g*g}}function Ms(y,l,h,g,v){const w=o.create();return l?(o.scale(w,w,[1/v,1/v,1]),h||o.rotateZ(w,w,g.angle)):o.multiply(w,g.labelPlaneMatrix,y),w}function di(y,l,h,g,v){if(l){const w=o.clone(y);return o.scale(w,w,[v,v,1]),h||o.rotateZ(w,w,-g.angle),w}return g.glCoordMatrix}function ln(y,l,h){let g;h?(g=[y.x,y.y,h(y.x,y.y),1],o.transformMat4(g,g,l)):(g=[y.x,y.y,0,1],Ut(g,g,l));const v=g[3];return{point:new o.pointGeometry(g[0]/v,g[1]/v),signedDistanceFromCamera:v}}function Li(y,l){return .5+y/l*.5}function bi(y,l){const h=y[0]/y[3],g=y[1]/y[3];return h>=-l[0]&&h<=l[0]&&g>=-l[1]&&g<=l[1]}function Me(y,l,h,g,v,w,A,L,$,O){const V=g?y.textSizeData:y.iconSizeData,W=o.evaluateSizeForZoom(V,h.transform.zoom),X=[256/h.width*2+1,256/h.height*2+1],ae=g?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;ae.clear();const se=y.lineVertexArray,oe=g?y.text.placedSymbolArray:y.icon.placedSymbolArray,_e=h.transform.width/h.transform.height;let Te=!1;for(let Le=0;Le<oe.length;Le++){const ue=oe.get(Le);if(ue.hidden||ue.writingMode===o.WritingMode.vertical&&!Te){it(ue.numGlyphs,ae);continue}let Fe;if(Te=!1,O?(Fe=[ue.anchorX,ue.anchorY,O(ue.anchorX,ue.anchorY),1],o.transformMat4(Fe,Fe,l)):(Fe=[ue.anchorX,ue.anchorY,0,1],Ut(Fe,Fe,l)),!bi(Fe,X)){it(ue.numGlyphs,ae);continue}const ke=Li(h.transform.cameraToCenterDistance,Fe[3]),He=o.evaluateSizeForFeature(V,W,ue),We=A?He/ke:He*ke,et=new o.pointGeometry(ue.anchorX,ue.anchorY),Ge=ln(et,v,O).point,wt={},ft=Ye(ue,We,!1,L,l,v,w,y.glyphOffsetArray,se,ae,Ge,et,wt,_e,$,O);Te=ft.useVertical,(ft.notEnoughRoom||Te||ft.needsFlipping&&Ye(ue,We,!0,L,l,v,w,y.glyphOffsetArray,se,ae,Ge,et,wt,_e,$,O).notEnoughRoom)&&it(ue.numGlyphs,ae)}g?y.text.dynamicLayoutVertexBuffer.updateData(ae):y.icon.dynamicLayoutVertexBuffer.updateData(ae)}function Ae(y,l,h,g,v,w,A,L,$,O,V,W,X){const ae=L.glyphStartIndex+L.numGlyphs,se=L.lineStartIndex,oe=L.lineStartIndex+L.lineLength,_e=l.getoffsetX(L.glyphStartIndex),Te=l.getoffsetX(ae-1),Le=gt(y*_e,h,g,v,w,A,L.segment,se,oe,$,O,V,W,X);if(!Le)return null;const ue=gt(y*Te,h,g,v,w,A,L.segment,se,oe,$,O,V,W,X);return ue?{first:Le,last:ue}:null}function Ce(y,l,h,g){return y===o.WritingMode.horizontal&&Math.abs(h.y-l.y)>Math.abs(h.x-l.x)*g?{useVertical:!0}:(y===o.WritingMode.vertical?l.y<h.y:l.x>h.x)?{needsFlipping:!0}:null}function Ye(y,l,h,g,v,w,A,L,$,O,V,W,X,ae,se,oe){const _e=l/24,Te=y.lineOffsetX*_e,Le=y.lineOffsetY*_e;let ue;if(y.numGlyphs>1){const Fe=y.glyphStartIndex+y.numGlyphs,ke=y.lineStartIndex,He=y.lineStartIndex+y.lineLength,We=Ae(_e,L,Te,Le,h,V,W,y,$,w,X,se,oe);if(!We)return{notEnoughRoom:!0};const et=ln(We.first.point,A,oe).point,Ge=ln(We.last.point,A,oe).point;if(g&&!h){const wt=Ce(y.writingMode,et,Ge,ae);if(wt)return wt}ue=[We.first];for(let wt=y.glyphStartIndex+1;wt<Fe-1;wt++)ue.push(gt(_e*L.getoffsetX(wt),Te,Le,h,V,W,y.segment,ke,He,$,w,X,se,oe));ue.push(We.last)}else{if(g&&!h){const ke=ln(W,v,oe).point,He=y.lineStartIndex+y.segment+1,We=new o.pointGeometry($.getx(He),$.gety(He)),et=ln(We,v,oe),Ge=et.signedDistanceFromCamera>0?et.point:Ze(W,We,ke,1,v,oe),wt=Ce(y.writingMode,ke,Ge,ae);if(wt)return wt}const Fe=gt(_e*L.getoffsetX(y.glyphStartIndex),Te,Le,h,V,W,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,$,w,X,se,oe);if(!Fe)return{notEnoughRoom:!0};ue=[Fe]}for(const Fe of ue)o.addDynamicAttributes(O,Fe.point,Fe.angle);return{}}function Ze(y,l,h,g,v,w){const A=ln(y.add(y.sub(l)._unit()),v,w).point,L=h.sub(A);return h.add(L._mult(g/L.mag()))}function gt(y,l,h,g,v,w,A,L,$,O,V,W,X,ae){const se=g?y-l:y+l;let oe=se>0?1:-1,_e=0;g&&(oe*=-1,_e=Math.PI),oe<0&&(_e+=Math.PI);let Te=oe>0?L+A:L+A+1,Le=v,ue=v,Fe=0,ke=0;const He=Math.abs(se),We=[];for(;Fe+ke<=He;){if(Te+=oe,Te<L||Te>=$)return null;if(ue=Le,We.push(Le),Le=W[Te],Le===void 0){const Tt=new o.pointGeometry(O.getx(Te),O.gety(Te)),tn=ln(Tt,V,ae);if(tn.signedDistanceFromCamera>0)Le=W[Te]=tn.point;else{const dn=Te-oe;Le=Ze(Fe===0?w:new o.pointGeometry(O.getx(dn),O.gety(dn)),Tt,ue,He-Fe+1,V,ae)}}Fe+=ke,ke=ue.dist(Le)}const et=(He-Fe)/ke,Ge=Le.sub(ue),wt=Ge.mult(et)._add(ue);wt._add(Ge._unit()._perp()._mult(h*oe));const ft=_e+Math.atan2(Le.y-ue.y,Le.x-ue.x);return We.push(wt),{point:wt,angle:X?ft:0,path:We}}const Ht=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function it(y,l){for(let h=0;h<y;h++){const g=l.length;l.resize(g+4),l.float32.set(Ht,3*g)}}function Ut(y,l,h){const g=l[0],v=l[1];return y[0]=h[0]*g+h[4]*v+h[12],y[1]=h[1]*g+h[5]*v+h[13],y[3]=h[3]*g+h[7]*v+h[15],y}const Wt=100;class Dn{constructor(l,h=new dt(l.width+200,l.height+200,25),g=new dt(l.width+200,l.height+200,25)){this.transform=l,this.grid=h,this.ignoredGrid=g,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Wt,this.screenBottomBoundary=l.height+Wt,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,h,g,v,w,A){const L=this.projectAndGetPerspectiveRatio(v,l.anchorPointX,l.anchorPointY,A),$=g*L.perspectiveRatio,O=l.x1*$+L.point.x,V=l.y1*$+L.point.y,W=l.x2*$+L.point.x,X=l.y2*$+L.point.y;return!this.isInsideGrid(O,V,W,X)||h!=="always"&&this.grid.hitTest(O,V,W,X,h,w)||L.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[O,V,W,X],offscreen:this.isOffscreen(O,V,W,X)}}placeCollisionCircles(l,h,g,v,w,A,L,$,O,V,W,X,ae,se){const oe=[],_e=new o.pointGeometry(h.anchorX,h.anchorY),Te=ln(_e,A,se),Le=Li(this.transform.cameraToCenterDistance,Te.signedDistanceFromCamera),ue=(V?w/Le:w*Le)/o.ONE_EM,Fe=ln(_e,L,se).point,ke=Ae(ue,v,h.lineOffsetX*ue,h.lineOffsetY*ue,!1,Fe,_e,h,g,L,{},!1,se);let He=!1,We=!1,et=!0;if(ke){const Ge=.5*X*Le+ae,wt=new o.pointGeometry(-100,-100),ft=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Tt=new Qi,tn=ke.first,dn=ke.last;let Gt=[];for(let Cn=tn.path.length-1;Cn>=1;Cn--)Gt.push(tn.path[Cn]);for(let Cn=1;Cn<dn.path.length;Cn++)Gt.push(dn.path[Cn]);const Un=2.5*Ge;if($){const Cn=Gt.map(In=>ln(In,$,se));Gt=Cn.some(In=>In.signedDistanceFromCamera<=0)?[]:Cn.map(In=>In.point)}let Vn=[];if(Gt.length>0){const Cn=Gt[0].clone(),In=Gt[0].clone();for(let Wn=1;Wn<Gt.length;Wn++)Cn.x=Math.min(Cn.x,Gt[Wn].x),Cn.y=Math.min(Cn.y,Gt[Wn].y),In.x=Math.max(In.x,Gt[Wn].x),In.y=Math.max(In.y,Gt[Wn].y);Vn=Cn.x>=wt.x&&In.x<=ft.x&&Cn.y>=wt.y&&In.y<=ft.y?[Gt]:In.x<wt.x||Cn.x>ft.x||In.y<wt.y||Cn.y>ft.y?[]:o.clipLine([Gt],wt.x,wt.y,ft.x,ft.y)}for(const Cn of Vn){Tt.reset(Cn,.25*Ge);let In=0;In=Tt.length<=.5*Ge?1:Math.ceil(Tt.paddedLength/Un)+1;for(let Wn=0;Wn<In;Wn++){const hi=Wn/Math.max(In-1,1),Io=Tt.lerp(hi),eo=Io.x+Wt,Lo=Io.y+Wt;oe.push(eo,Lo,Ge,0);const Sa=eo-Ge,Os=Lo-Ge,ns=eo+Ge,Xo=Lo+Ge;if(et=et&&this.isOffscreen(Sa,Os,ns,Xo),We=We||this.isInsideGrid(Sa,Os,ns,Xo),l!=="always"&&this.grid.hitTestCircle(eo,Lo,Ge,l,W)&&(He=!0,!O))return{circles:[],offscreen:!1,collisionDetected:He}}}}return{circles:!O&&He||!We||Le<this.perspectiveRatioCutoff?[]:oe,offscreen:et,collisionDetected:He}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let g=1/0,v=1/0,w=-1/0,A=-1/0;for(const V of l){const W=new o.pointGeometry(V.x+Wt,V.y+Wt);g=Math.min(g,W.x),v=Math.min(v,W.y),w=Math.max(w,W.x),A=Math.max(A,W.y),h.push(W)}const L=this.grid.query(g,v,w,A).concat(this.ignoredGrid.query(g,v,w,A)),$={},O={};for(const V of L){const W=V.key;if($[W.bucketInstanceId]===void 0&&($[W.bucketInstanceId]={}),$[W.bucketInstanceId][W.featureIndex])continue;const X=[new o.pointGeometry(V.x1,V.y1),new o.pointGeometry(V.x2,V.y1),new o.pointGeometry(V.x2,V.y2),new o.pointGeometry(V.x1,V.y2)];o.polygonIntersectsPolygon(h,X)&&($[W.bucketInstanceId][W.featureIndex]=!0,O[W.bucketInstanceId]===void 0&&(O[W.bucketInstanceId]=[]),O[W.bucketInstanceId].push(W.featureIndex))}return O}insertCollisionBox(l,h,g,v,w,A){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:v,featureIndex:w,collisionGroupID:A,overlapMode:h},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,h,g,v,w,A){const L=g?this.ignoredGrid:this.grid,$={bucketInstanceId:v,featureIndex:w,collisionGroupID:A,overlapMode:h};for(let O=0;O<l.length;O+=4)L.insertCircle($,l[O],l[O+1],l[O+2])}projectAndGetPerspectiveRatio(l,h,g,v){let w;return v?(w=[h,g,v(h,g),1],o.transformMat4(w,w,l)):(w=[h,g,0,1],Ut(w,w,l)),{point:new o.pointGeometry((w[0]/w[3]+1)/2*this.transform.width+Wt,(-w[1]/w[3]+1)/2*this.transform.height+Wt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/w[3]*.5}}isOffscreen(l,h,g,v){return g<Wt||l>=this.screenRightBoundary||v<Wt||h>this.screenBottomBoundary}isInsideGrid(l,h,g,v){return g>=0&&l<this.gridRightBoundary&&v>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const l=o.identity([]);return o.translate(l,l,[-100,-100,0]),l}}function An(y,l,h){return l*(o.EXTENT/(y.tileSize*Math.pow(2,h-y.tileID.overscaledZ)))}class Pn{constructor(l,h,g,v){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?h:-h))):v&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class on{constructor(l,h,g,v,w){this.text=new Pn(l?l.text:null,h,g,w),this.icon=new Pn(l?l.icon:null,h,v,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class qr{constructor(l,h,g){this.text=l,this.icon=h,this.skipFade=g}}class ri{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class xi{constructor(l,h,g,v,w){this.bucketInstanceId=l,this.featureIndex=h,this.sourceLayerIndex=g,this.bucketIndex=v,this.tileID=w}}class Gi{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const h=++this.maxGroupID;this.collisionGroups[l]={ID:h,predicate:g=>g.collisionGroupID===h}}return this.collisionGroups[l]}}function es(y,l,h,g,v){const{horizontalAlign:w,verticalAlign:A}=o.getAnchorAlignment(y),L=-(w-.5)*l,$=-(A-.5)*h,O=o.evaluateVariableOffset(y,g);return new o.pointGeometry(L+O[0]*v,$+O[1]*v)}function Ao(y,l,h,g,v,w){const{x1:A,x2:L,y1:$,y2:O,anchorPointX:V,anchorPointY:W}=y,X=new o.pointGeometry(l,h);return g&&X._rotate(v?w:-w),{x1:A+X.x,y1:$+X.y,x2:L+X.x,y2:O+X.y,anchorPointX:V,anchorPointY:W}}class re{constructor(l,h,g,v,w){this.transform=l.clone(),this.terrain=h,this.collisionIndex=new Dn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Gi(v),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,h,g,v){const w=g.getBucket(h),A=g.latestFeatureIndex;if(!w||!A||h.id!==w.layerIds[0])return;const L=g.collisionBoxArray,$=w.layers[0].layout,O=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),V=g.tileSize/o.EXTENT,W=this.transform.calculatePosMatrix(g.tileID.toUnwrapped()),X=$.get("text-pitch-alignment")==="map",ae=$.get("text-rotation-alignment")==="map",se=An(g,1,this.transform.zoom),oe=Ms(W,X,ae,this.transform,se);let _e=null;if(X){const Le=di(W,X,ae,this.transform,se);_e=o.multiply([],this.transform.labelPlaneMatrix,Le)}this.retainedQueryData[w.bucketInstanceId]=new xi(w.bucketInstanceId,A,w.sourceLayerIndex,w.index,g.tileID);const Te={bucket:w,layout:$,posMatrix:W,textLabelPlaneMatrix:oe,labelToScreenMatrix:_e,scale:O,textPixelRatio:V,holdingForFade:g.holdingForFade(),collisionBoxArray:L,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(v)for(const Le of w.sortKeyRanges){const{sortKey:ue,symbolInstanceStart:Fe,symbolInstanceEnd:ke}=Le;l.push({sortKey:ue,symbolInstanceStart:Fe,symbolInstanceEnd:ke,parameters:Te})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Te})}attemptAnchorPlacement(l,h,g,v,w,A,L,$,O,V,W,X,ae,se,oe,_e){const Te=[X.textOffset0,X.textOffset1],Le=es(l,g,v,Te,w),ue=this.collisionIndex.placeCollisionBox(Ao(h,Le.x,Le.y,A,L,this.transform.angle),W,$,O,V.predicate,_e);if((!oe||this.collisionIndex.placeCollisionBox(Ao(oe,Le.x,Le.y,A,L,this.transform.angle),W,$,O,V.predicate,_e).box.length!==0)&&ue.box.length>0){let Fe;if(this.prevPlacement&&this.prevPlacement.variableOffsets[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID]&&this.prevPlacement.placements[X.crossTileID].text&&(Fe=this.prevPlacement.variableOffsets[X.crossTileID].anchor),X.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[X.crossTileID]={textOffset:Te,width:g,height:v,anchor:l,textBoxScale:w,prevAnchor:Fe},this.markUsedJustification(ae,l,X,se),ae.allowVerticalPlacement&&(this.markUsedOrientation(ae,se,X),this.placedOrientations[X.crossTileID]=se),{shift:Le,placedGlyphBoxes:ue}}}placeLayerBucketPart(l,h,g){const{bucket:v,layout:w,posMatrix:A,textLabelPlaneMatrix:L,labelToScreenMatrix:$,textPixelRatio:O,holdingForFade:V,collisionBoxArray:W,partiallyEvaluatedTextSize:X,collisionGroup:ae}=l.parameters,se=w.get("text-optional"),oe=w.get("icon-optional"),_e=o.getOverlapMode(w,"text-overlap","text-allow-overlap"),Te=_e==="always",Le=o.getOverlapMode(w,"icon-overlap","icon-allow-overlap"),ue=Le==="always",Fe=w.get("text-rotation-alignment")==="map",ke=w.get("text-pitch-alignment")==="map",He=w.get("icon-text-fit")!=="none",We=w.get("symbol-z-order")==="viewport-y",et=Te&&(ue||!v.hasIconData()||oe),Ge=ue&&(Te||!v.hasTextData()||se);!v.collisionArrays&&W&&v.deserializeCollisionBoxes(W);const wt=(ft,Tt)=>{if(h[ft.crossTileID])return;if(V)return void(this.placements[ft.crossTileID]=new qr(!1,!1,!1));let tn=!1,dn=!1,Gt=!0,Un=null,Vn={box:null,offscreen:null},Cn={box:null,offscreen:null},In=null,Wn=null,hi=null,Io=0,eo=0,Lo=0;Tt.textFeatureIndex?Io=Tt.textFeatureIndex:ft.useRuntimeCollisionCircles&&(Io=ft.featureIndex),Tt.verticalTextFeatureIndex&&(eo=Tt.verticalTextFeatureIndex);const Sa=this.retainedQueryData[v.bucketInstanceId].tileID,Os=this.terrain?(si,yn)=>this.terrain.getElevation(Sa,si,yn):null;for(const si of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const yn=Tt[si];yn&&(yn.elevation=Os?Os(yn.anchorPointX,yn.anchorPointY):0)}const ns=Tt.textBox;if(ns){const si=Bn=>{let fi=o.WritingMode.horizontal;if(v.allowVerticalPlacement&&!Bn&&this.prevPlacement){const pi=this.prevPlacement.placedOrientations[ft.crossTileID];pi&&(this.placedOrientations[ft.crossTileID]=pi,fi=pi,this.markUsedOrientation(v,fi,ft))}return fi},yn=(Bn,fi)=>{if(v.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&Tt.verticalTextBox){for(const pi of v.writingModes)if(pi===o.WritingMode.vertical?(Vn=fi(),Cn=Vn):Vn=Bn(),Vn&&Vn.box&&Vn.box.length)break}else Vn=Bn()};if(w.get("text-variable-anchor")){let Bn=w.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ft.crossTileID]){const fr=this.prevPlacement.variableOffsets[ft.crossTileID];Bn.indexOf(fr.anchor)>0&&(Bn=Bn.filter(Ds=>Ds!==fr.anchor),Bn.unshift(fr.anchor))}const fi=(fr,Ds,Qa)=>{const np=fr.x2-fr.x1,tc=fr.y2-fr.y1,yy=ft.textBoxScale,rp=He&&Le==="never"?Ds:null;let Aa={box:[],offscreen:!1};const el=_e!=="never"?2*Bn.length:Bn.length;for(let tl=0;tl<el;++tl){const Od=this.attemptAnchorPlacement(Bn[tl%Bn.length],fr,np,tc,yy,Fe,ke,O,A,ae,tl>=Bn.length?_e:"never",ft,v,Qa,rp,Os);if(Od&&(Aa=Od.placedGlyphBoxes,Aa&&Aa.box&&Aa.box.length)){tn=!0,Un=Od.shift;break}}return Aa};yn(()=>fi(ns,Tt.iconBox,o.WritingMode.horizontal),()=>{const fr=Tt.verticalTextBox;return v.allowVerticalPlacement&&!(Vn&&Vn.box&&Vn.box.length)&&ft.numVerticalGlyphVertices>0&&fr?fi(fr,Tt.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),Vn&&(tn=Vn.box,Gt=Vn.offscreen);const pi=si(Vn&&Vn.box);if(!tn&&this.prevPlacement){const fr=this.prevPlacement.variableOffsets[ft.crossTileID];fr&&(this.variableOffsets[ft.crossTileID]=fr,this.markUsedJustification(v,fr.anchor,ft,pi))}}else{const Bn=(fi,pi)=>{const fr=this.collisionIndex.placeCollisionBox(fi,_e,O,A,ae.predicate,Os);return fr&&fr.box&&fr.box.length&&(this.markUsedOrientation(v,pi,ft),this.placedOrientations[ft.crossTileID]=pi),fr};yn(()=>Bn(ns,o.WritingMode.horizontal),()=>{const fi=Tt.verticalTextBox;return v.allowVerticalPlacement&&ft.numVerticalGlyphVertices>0&&fi?Bn(fi,o.WritingMode.vertical):{box:null,offscreen:null}}),si(Vn&&Vn.box&&Vn.box.length)}}if(In=Vn,tn=In&&In.box&&In.box.length>0,Gt=In&&In.offscreen,ft.useRuntimeCollisionCircles){const si=v.text.placedSymbolArray.get(ft.centerJustifiedTextSymbolIndex),yn=o.evaluateSizeForFeature(v.textSizeData,X,si),Bn=w.get("text-padding");Wn=this.collisionIndex.placeCollisionCircles(_e,si,v.lineVertexArray,v.glyphOffsetArray,yn,A,L,$,g,ke,ae.predicate,ft.collisionCircleDiameter,Bn,Os),Wn.circles.length&&Wn.collisionDetected&&!g&&o.warnOnce("Collisions detected, but collision boxes are not shown"),tn=Te||Wn.circles.length>0&&!Wn.collisionDetected,Gt=Gt&&Wn.offscreen}if(Tt.iconFeatureIndex&&(Lo=Tt.iconFeatureIndex),Tt.iconBox){const si=yn=>{const Bn=He&&Un?Ao(yn,Un.x,Un.y,Fe,ke,this.transform.angle):yn;return this.collisionIndex.placeCollisionBox(Bn,Le,O,A,ae.predicate,Os)};Cn&&Cn.box&&Cn.box.length&&Tt.verticalIconBox?(hi=si(Tt.verticalIconBox),dn=hi.box.length>0):(hi=si(Tt.iconBox),dn=hi.box.length>0),Gt=Gt&&hi.offscreen}const Xo=se||ft.numHorizontalGlyphVertices===0&&ft.numVerticalGlyphVertices===0,kd=oe||ft.numIconVertices===0;if(Xo||kd?kd?Xo||(dn=dn&&tn):tn=dn&&tn:dn=tn=dn&&tn,tn&&In&&In.box&&this.collisionIndex.insertCollisionBox(In.box,_e,w.get("text-ignore-placement"),v.bucketInstanceId,Cn&&Cn.box&&eo?eo:Io,ae.ID),dn&&hi&&this.collisionIndex.insertCollisionBox(hi.box,Le,w.get("icon-ignore-placement"),v.bucketInstanceId,Lo,ae.ID),Wn&&(tn&&this.collisionIndex.insertCollisionCircles(Wn.circles,_e,w.get("text-ignore-placement"),v.bucketInstanceId,Io,ae.ID),g)){const si=v.bucketInstanceId;let yn=this.collisionCircleArrays[si];yn===void 0&&(yn=this.collisionCircleArrays[si]=new ri);for(let Bn=0;Bn<Wn.circles.length;Bn+=4)yn.circles.push(Wn.circles[Bn+0]),yn.circles.push(Wn.circles[Bn+1]),yn.circles.push(Wn.circles[Bn+2]),yn.circles.push(Wn.collisionDetected?1:0)}if(ft.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(v.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ft.crossTileID]=new qr(tn||et,dn||Ge,Gt||v.justReloaded),h[ft.crossTileID]=!0};if(We){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ft=v.getSortedSymbolIndexes(this.transform.angle);for(let Tt=ft.length-1;Tt>=0;--Tt){const tn=ft[Tt];wt(v.symbolInstances.get(tn),v.collisionArrays[tn])}}else for(let ft=l.symbolInstanceStart;ft<l.symbolInstanceEnd;ft++)wt(v.symbolInstances.get(ft),v.collisionArrays[ft]);if(g&&v.bucketInstanceId in this.collisionCircleArrays){const ft=this.collisionCircleArrays[v.bucketInstanceId];o.invert(ft.invProjMatrix,A),ft.viewportMatrix=this.collisionIndex.getViewportMatrix()}v.justReloaded=!1}markUsedJustification(l,h,g,v){let w;w=v===o.WritingMode.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(h)];const A=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const L of A)L>=0&&(l.text.placedSymbolArray.get(L).crossTileID=w>=0&&L!==w?0:g.crossTileID)}markUsedOrientation(l,h,g){const v=h===o.WritingMode.horizontal||h===o.WritingMode.horizontalOnly?h:0,w=h===o.WritingMode.vertical?h:0,A=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const L of A)l.text.placedSymbolArray.get(L).placedOrientation=v;g.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let g=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const v=h?h.symbolFadeChange(l):1,w=h?h.opacities:{},A=h?h.variableOffsets:{},L=h?h.placedOrientations:{};for(const $ in this.placements){const O=this.placements[$],V=w[$];V?(this.opacities[$]=new on(V,v,O.text,O.icon),g=g||O.text!==V.text.placed||O.icon!==V.icon.placed):(this.opacities[$]=new on(null,v,O.text,O.icon,O.skipFade),g=g||O.text||O.icon)}for(const $ in w){const O=w[$];if(!this.opacities[$]){const V=new on(O,v,!1,!1);V.isHidden()||(this.opacities[$]=V,g=g||O.text.placed||O.icon.placed)}}for(const $ in A)this.variableOffsets[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.variableOffsets[$]=A[$]);for(const $ in L)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=L[$]);if(h&&h.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:l)}updateLayerOpacities(l,h){const g={};for(const v of h){const w=v.getBucket(l);w&&v.latestFeatureIndex&&l.id===w.layerIds[0]&&this.updateBucketOpacities(w,g,v.collisionBoxArray)}}updateBucketOpacities(l,h,g){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const v=l.layers[0].layout,w=new on(null,0,!1,!1,!0),A=v.get("text-allow-overlap"),L=v.get("icon-allow-overlap"),$=v.get("text-variable-anchor"),O=v.get("text-rotation-alignment")==="map",V=v.get("text-pitch-alignment")==="map",W=v.get("icon-text-fit")!=="none",X=new on(null,0,A&&(L||!l.hasIconData()||v.get("icon-optional")),L&&(A||!l.hasTextData()||v.get("text-optional")),!0);!l.collisionArrays&&g&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(g);const ae=(se,oe,_e)=>{for(let Te=0;Te<oe/4;Te++)se.opacityVertexArray.emplaceBack(_e)};for(let se=0;se<l.symbolInstances.length;se++){const oe=l.symbolInstances.get(se),{numHorizontalGlyphVertices:_e,numVerticalGlyphVertices:Te,crossTileID:Le}=oe;let ue=this.opacities[Le];h[Le]?ue=w:ue||(ue=X,this.opacities[Le]=ue),h[Le]=!0;const Fe=oe.numIconVertices>0,ke=this.placedOrientations[oe.crossTileID],He=ke===o.WritingMode.vertical,We=ke===o.WritingMode.horizontal||ke===o.WritingMode.horizontalOnly;if(_e>0||Te>0){const et=xe(ue.text);ae(l.text,_e,He?Ve:et),ae(l.text,Te,We?Ve:et);const Ge=ue.text.isHidden();[oe.rightJustifiedTextSymbolIndex,oe.centerJustifiedTextSymbolIndex,oe.leftJustifiedTextSymbolIndex].forEach(Tt=>{Tt>=0&&(l.text.placedSymbolArray.get(Tt).hidden=Ge||He?1:0)}),oe.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(oe.verticalPlacedTextSymbolIndex).hidden=Ge||We?1:0);const wt=this.variableOffsets[oe.crossTileID];wt&&this.markUsedJustification(l,wt.anchor,oe,ke);const ft=this.placedOrientations[oe.crossTileID];ft&&(this.markUsedJustification(l,"left",oe,ft),this.markUsedOrientation(l,ft,oe))}if(Fe){const et=xe(ue.icon),Ge=!(W&&oe.verticalPlacedIconSymbolIndex&&He);oe.placedIconSymbolIndex>=0&&(ae(l.icon,oe.numIconVertices,Ge?et:Ve),l.icon.placedSymbolArray.get(oe.placedIconSymbolIndex).hidden=ue.icon.isHidden()),oe.verticalPlacedIconSymbolIndex>=0&&(ae(l.icon,oe.numVerticalIconVertices,Ge?Ve:et),l.icon.placedSymbolArray.get(oe.verticalPlacedIconSymbolIndex).hidden=ue.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const et=l.collisionArrays[se];if(et){let Ge=new o.pointGeometry(0,0);if(et.textBox||et.verticalTextBox){let ft=!0;if($){const Tt=this.variableOffsets[Le];Tt?(Ge=es(Tt.anchor,Tt.width,Tt.height,Tt.textOffset,Tt.textBoxScale),O&&Ge._rotate(V?this.transform.angle:-this.transform.angle)):ft=!1}et.textBox&&z(l.textCollisionBox.collisionVertexArray,ue.text.placed,!ft||He,Ge.x,Ge.y),et.verticalTextBox&&z(l.textCollisionBox.collisionVertexArray,ue.text.placed,!ft||We,Ge.x,Ge.y)}const wt=!!(!We&&et.verticalIconBox);et.iconBox&&z(l.iconCollisionBox.collisionVertexArray,ue.icon.placed,wt,W?Ge.x:0,W?Ge.y:0),et.verticalIconBox&&z(l.iconCollisionBox.collisionVertexArray,ue.icon.placed,!wt,W?Ge.x:0,W?Ge.y:0)}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);if(l.bucketInstanceId in this.collisionCircleArrays){const se=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=se.invProjMatrix,l.placementViewportMatrix=se.viewportMatrix,l.collisionCircleArray=se.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,h){const g=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*g>l}setStale(){this.stale=!0}}function z(y,l,h,g,v){y.emplaceBack(l?1:0,h?1:0,g||0,v||0),y.emplaceBack(l?1:0,h?1:0,g||0,v||0),y.emplaceBack(l?1:0,h?1:0,g||0,v||0),y.emplaceBack(l?1:0,h?1:0,g||0,v||0)}const j=Math.pow(2,25),Q=Math.pow(2,24),te=Math.pow(2,17),me=Math.pow(2,16),be=Math.pow(2,9),ye=Math.pow(2,8),pe=Math.pow(2,1);function xe(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const l=y.placed?1:0,h=Math.floor(127*y.opacity);return h*j+l*Q+h*te+l*me+h*be+l*ye+h*pe+l}const Ve=0;class Qe{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,h,g,v,w){const A=this._bucketParts;for(;this._currentTileIndex<l.length;)if(h.getBucketParts(A,v,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort((L,$)=>L.sortKey-$.sortKey));this._currentPartIndex<A.length;)if(h.placeLayerBucketPart(A[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,w())return!0;return!1}}class Ue{constructor(l,h,g,v,w,A,L,$){this.placement=new re(l,h,A,L,$),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=v,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(l,h,g){const v=o.exported.now(),w=()=>{const A=o.exported.now()-v;return!this._forceFullPlacement&&A>2};for(;this._currentPlacementIndex>=0;){const A=h[l[this._currentPlacementIndex]],L=this.placement.collisionIndex.transform.zoom;if(A.type==="symbol"&&(!A.minzoom||A.minzoom<=L)&&(!A.maxzoom||A.maxzoom>L)){if(this._inProgressLayer||(this._inProgressLayer=new Qe(A)),this._inProgressLayer.continuePlacement(g[A.source],this.placement,this._showCollisionBoxes,A,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const At=512/o.EXTENT/2;class Rt{constructor(l,h,g){this.tileID=l,this.indexedSymbolInstances={},this.bucketInstanceId=g;for(let v=0;v<h.length;v++){const w=h.get(v),A=w.key;this.indexedSymbolInstances[A]||(this.indexedSymbolInstances[A]=[]),this.indexedSymbolInstances[A].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,l)})}}getScaledCoordinates(l,h){const g=At/Math.pow(2,h.canonical.z-this.tileID.canonical.z);return{x:Math.floor((h.canonical.x*o.EXTENT+l.anchorX)*g),y:Math.floor((h.canonical.y*o.EXTENT+l.anchorY)*g)}}findMatches(l,h,g){const v=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let w=0;w<l.length;w++){const A=l.get(w);if(A.crossTileID)continue;const L=this.indexedSymbolInstances[A.key];if(!L)continue;const $=this.getScaledCoordinates(A,h);for(const O of L)if(Math.abs(O.coord.x-$.x)<=v&&Math.abs(O.coord.y-$.y)<=v&&!g[O.crossTileID]){g[O.crossTileID]=!0,A.crossTileID=O.crossTileID;break}}}}class _t{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Vt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const h=Math.round((l-this.lng)/360);if(h!==0)for(const g in this.indexes){const v=this.indexes[g],w={};for(const A in v){const L=v[A];L.tileID=L.tileID.unwrapTo(L.tileID.wrap+h),w[L.tileID.key]=L}this.indexes[g]=w}this.lng=l}addBucket(l,h,g){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let w=0;w<h.symbolInstances.length;w++)h.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});const v=this.usedCrossTileIDs[l.overscaledZ];for(const w in this.indexes){const A=this.indexes[w];if(Number(w)>l.overscaledZ)for(const L in A){const $=A[L];$.tileID.isChildOf(l)&&$.findMatches(h.symbolInstances,l,v)}else{const L=A[l.scaledTo(Number(w)).key];L&&L.findMatches(h.symbolInstances,l,v)}}for(let w=0;w<h.symbolInstances.length;w++){const A=h.symbolInstances.get(w);A.crossTileID||(A.crossTileID=g.generate(),v[A.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Rt(l,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(l,h){for(const g in h.indexedSymbolInstances)for(const v of h.indexedSymbolInstances[g])delete this.usedCrossTileIDs[l][v.crossTileID]}removeStaleBuckets(l){let h=!1;for(const g in this.indexes){const v=this.indexes[g];for(const w in v)l[v[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,v[w]),delete v[w],h=!0)}return h}}class zt{constructor(){this.layerIndexes={},this.crossTileIDs=new _t,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,h,g){let v=this.layerIndexes[l.id];v===void 0&&(v=this.layerIndexes[l.id]=new Vt);let w=!1;const A={};v.handleWrapJump(g);for(const L of h){const $=L.getBucket(l);$&&l.id===$.layerIds[0]&&($.bucketInstanceId||($.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(L.tileID,$,this.crossTileIDs)&&(w=!0),A[$.bucketInstanceId]=!0)}return v.removeStaleBuckets(A)&&(w=!0),w}pruneUnusedLayers(l){const h={};l.forEach(g=>{h[g]=!0});for(const g in this.layerIndexes)h[g]||delete this.layerIndexes[g]}}var cn=o.createLayout([{name:"a_pos",type:"Int16",components:2}]);class Kt extends o.Evented{constructor(l){super(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=l._cache.max,l.usedForTerrain=!0,l.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const l in this._tiles){const h=this._tiles[l];h.textures.forEach(g=>g.destroy()),h.textures=[]}}update(l,h){this.sourceCache.update(l,h),this._renderableTilesKeys=[];for(const g of l.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:h}))this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.posMatrix=new Float64Array(16),o.ortho(g.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),this._tiles[g.key]=new ht(g,this.tileSize))}removeOutdated(l){const h={};this.renderHistory=this.renderHistory.filter((g,v)=>this.renderHistory.indexOf(g)===v).slice(0,this.renderHistorySize);for(const g of this._renderableTilesKeys)h[g]=!0;for(const g of this.renderHistory)h[g]=!0;for(const g in this._tiles)h[g]||(this._tiles[g].clearTextures(l),delete this._tiles[g])}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l){const h={};for(const g of this._renderableTilesKeys){const v=this._tiles[g].tileID;if(v.canonical.equals(l.canonical)){const w=l.clone();w.posMatrix=new Float64Array(16),o.ortho(w.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),h[g]=w}else if(v.canonical.isChildOf(l.canonical)){const w=l.clone();w.posMatrix=new Float64Array(16);const A=v.canonical.z-l.canonical.z,L=v.canonical.x-(v.canonical.x>>A<<A),$=v.canonical.y-(v.canonical.y>>A<<A),O=o.EXTENT>>A;o.ortho(w.posMatrix,0,O,0,O,0,1),o.translate(w.posMatrix,w.posMatrix,[-L*O,-$*O,0]),h[g]=w}else if(l.canonical.isChildOf(v.canonical)){const w=l.clone();w.posMatrix=new Float64Array(16);const A=l.canonical.z-v.canonical.z,L=l.canonical.x-(l.canonical.x>>A<<A),$=l.canonical.y-(l.canonical.y>>A<<A),O=o.EXTENT>>A;o.ortho(w.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),o.translate(w.posMatrix,w.posMatrix,[L*O,$*O,0]),o.scale(w.posMatrix,w.posMatrix,[1/2**A,1/2**A,0]),h[g]=w}}return h}getSourceTile(l,h){const g=this.sourceCache._source;let v=l.overscaledZ-this.deltaZoom;if(v>g.maxzoom&&(v=g.maxzoom),v<g.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(v).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!w||!w.dem)&&h)for(;v>=g.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(l.scaledTo(v--).key);return w}tilesAfterTime(l=Date.now()){return Object.values(this._tiles).filter(h=>h.timeLoaded>=l)}}class Qt{constructor(l,h,g){this.style=l,this.sourceCache=new Kt(h),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.elevationOffset=typeof g.elevationOffset=="number"?g.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(l,h,g,v=o.EXTENT){if(!(h>=0&&h<v&&g>=0&&g<v))return this.elevationOffset;let w=0;const A=this.getTerrainData(l);if(A.tile&&A.tile.dem){const L=o.transformMat4$1([],[h/v*o.EXTENT,g/v*o.EXTENT],A.u_terrain_matrix),$=[L[0]*A.tile.dem.dim,L[1]*A.tile.dem.dim],O=[Math.floor($[0]),Math.floor($[1])],V=A.tile.dem.get(O[0],O[1]),W=A.tile.dem.get(O[0],O[1]+1),X=A.tile.dem.get(O[0]+1,O[1]),ae=A.tile.dem.get(O[0]+1,O[1]+1);w=o.number(o.number(V,W,$[0]-O[0]),o.number(X,ae,$[0]-O[0]),$[1]-O[1])}return w}rememberForRerender(l,h){for(const g in this.sourceCache._tiles){const v=this.sourceCache._tiles[g];(v.tileID.equals(h)||v.tileID.isChildOf(h))&&(l===this.sourceCache.sourceCache.id&&(v.timeLoaded=Date.now()),this._rerender[l]=this._rerender[l]||{},this._rerender[l][v.tileID.key]=!0)}}needsRerender(l,h){return this._rerender[l]&&this._rerender[l][h.key]}clearRerenderCache(){this._rerender={}}getElevation(l,h,g,v=o.EXTENT){return(this.getDEMElevation(l,h,g,v)+this.elevationOffset)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){const v=this.style.map.painter.context,w=new o.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new D(v,w,v.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new D(v,new o.RGBAImage({width:1,height:1}),v.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.identity([])}const h=this.sourceCache.getSourceTile(l,!0);if(h&&h.dem&&(!h.demTexture||h.needsTerrainPrepare)){const v=this.style.map.painter.context;h.demTexture=this.style.map.painter.getTileTexture(h.dem.stride),h.demTexture?h.demTexture.update(h.dem.getPixels(),{premultiply:!1}):h.demTexture=new D(v,h.dem.getPixels(),v.gl.RGBA,{premultiply:!1}),h.demTexture.bind(v.gl.NEAREST,v.gl.CLAMP_TO_EDGE),h.needsTerrainPrepare=!1}const g=h&&h+h.tileID.key+l.key;if(g&&!this._demMatrixCache[g]){const v=this.sourceCache.sourceCache._source.maxzoom;let w=l.canonical.z-h.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=v?w=l.canonical.z-v:o.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const A=l.canonical.x-(l.canonical.x>>w<<w),L=l.canonical.y-(l.canonical.y>>w<<w),$=o.fromScaling(new Float64Array(16),[1/(o.EXTENT<<w),1/(o.EXTENT<<w),0]);o.translate($,$,[A*o.EXTENT,L*o.EXTENT,0]),this._demMatrixCache[l.key]={matrix:$,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:h&&h.dem&&h.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:h&&h.dem&&h.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(h&&h.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:h}}getRTTFramebuffer(){const l=this.style.map.painter;if(!this._rttFramebuffer){const h=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=l.context.createFramebuffer(h,h,!0),this._rttFramebuffer.depthAttachment.set(l.context.createRenderbuffer(l.context.gl.DEPTH_COMPONENT16,h,h))}return this._rttFramebuffer}getFramebuffer(l){const h=this.style.map.painter,g=h.width/devicePixelRatio,v=h.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===v||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new D(h.context,{width:g,height:v,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new D(h.context,{width:g,height:v,data:null},h.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(h.context.gl.NEAREST,h.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=h.context.createFramebuffer(g,v,!0),this._fbo.depthAttachment.set(h.context.createRenderbuffer(h.context.gl.DEPTH_COMPONENT16,g,v))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const l=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const h=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,A=0;w<this._coordsTextureSize;w++)for(let L=0;L<this._coordsTextureSize;L++,A+=4)h[A+0]=255&L,h[A+1]=255&w,h[A+2]=L>>8<<4|w>>8,h[A+3]=0;const g=new o.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(h.buffer)),v=new D(l,g,l.gl.RGBA,{premultiply:!1});return v.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=v,v}pointCoordinate(l){const h=new Uint8Array(4),g=this.style.map.painter,v=g.context,w=v.gl;v.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),w.readPixels(l.x,g.height/devicePixelRatio-l.y-1,1,1,w.RGBA,w.UNSIGNED_BYTE,h),v.bindFramebuffer.set(null);const A=h[0]+(h[2]>>4<<8),L=h[1]+((15&h[2])<<8),$=this.coordsIndex[255-h[3]],O=$&&this.sourceCache.getTileByID($);if(!O)return null;const V=this._coordsTextureSize,W=(1<<O.tileID.canonical.z)*V;return new o.MercatorCoordinate((O.tileID.canonical.x*V+A)/W,(O.tileID.canonical.y*V+L)/W,this.getElevation(O.tileID,A,L,V))}getTerrainMesh(){if(this._mesh)return this._mesh;const l=this.style.map.painter.context,h=new o.PosArray,g=new o.TriangleIndexArray,v=this.meshSize,w=o.EXTENT/v,A=v*v;for(let L=0;L<=v;L++)for(let $=0;$<=v;$++)h.emplaceBack($*w,L*w);for(let L=0;L<A;L+=v+1)for(let $=0;$<v;$++)g.emplaceBack($+L,v+$+L+1,v+$+L+2),g.emplaceBack($+L,v+$+L+2,$+L+1);return this._mesh={indexBuffer:l.createIndexBuffer(g),vertexBuffer:l.createVertexBuffer(h,cn.members),segments:o.SegmentVector.simpleSegment(0,0,h.length,g.length)},this._mesh}getMinMaxElevation(l){const h=this.getTerrainData(l).tile,g={minElevation:null,maxElevation:null};return h&&h.dem&&(g.minElevation=(h.dem.min+this.elevationOffset)*this.exaggeration,g.maxElevation=(h.dem.max+this.elevationOffset)*this.exaggeration),g}}const fn=(y,l)=>o.emitValidationErrors(y,l&&l.filter(h=>h.identifier!=="source.canvas")),vn=o.pick(gn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),er=o.pick(gn,["setCenter","setZoom","setBearing","setPitch"]),tr=function(){const y={},l=o.spec.$version;for(const h in o.spec.$root){const g=o.spec.$root[h];if(g.required){let v=null;v=h==="version"?l:g.type==="array"?[]:{},v!=null&&(y[h]=v)}}return y}();class ii extends o.Evented{constructor(l,h={}){super(),this.map=l,this.dispatcher=new Re(Hn(),this),this.imageManager=new F,this.imageManager.setEventedParent(this),this.glyphManager=new ie(l._requestManager,h.localIdeographFontFamily),this.lineAtlas=new Oe(256,512),this.crossTileSymbolIndex=new zt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const g=this;this._rtlTextPluginCallback=ii.registerForPluginStateChange(v=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(w,A)=>{if(o.triggerPluginCompletionEvent(w),A&&A.every(L=>L))for(const L in g.sourceCaches)g.sourceCaches[L].reload()})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const w=this.sourceCaches[v.sourceId];if(!w)return;const A=w.getSource();if(A&&A.vectorLayerIds)for(const L in this._layers){const $=this._layers[L];$.source===A.id&&this._validateLayer($)}})}loadURL(l,h={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const g=typeof h.validate!="boolean"||h.validate,v=this.map._requestManager.transformRequest(l,o.ResourceType.Style);this._request=o.getJSON(v,(w,A)=>{this._request=null,w?this.fire(new o.ErrorEvent(w)):A&&this._load(A,g)})}loadJSON(l,h={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(l,h.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(tr,!1)}_load(l,h){if(h&&fn(this,o.validateStyle(l)))return;this._loaded=!0,this.stylesheet=l;for(const v in l.sources)this.addSource(v,l.sources[v],{validate:!1});l.sprite?this._loadSprite(l.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(l.glyphs);const g=Zs(this.stylesheet.layers);this._order=g.map(v=>v.id),this._layers={},this._serializedLayers={};for(let v of g)v=o.createStyleLayer(v),v.setEventedParent(this,{layer:{id:v.id}}),this._layers[v.id]=v,this._serializedLayers[v.id]=v.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ve(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}_loadSprite(l){this._spriteRequest=function(h,g,v,w){let A,L,$;const O=v>1?"@2x":"";let V=o.getJSON(g.transformRequest(g.normalizeSpriteURL(h,O,".json"),o.ResourceType.SpriteJSON),(ae,se)=>{V=null,$||($=ae,A=se,X())}),W=o.getImage(g.transformRequest(g.normalizeSpriteURL(h,O,".png"),o.ResourceType.SpriteImage),(ae,se)=>{W=null,$||($=ae,L=se,X())});function X(){if($)w($);else if(A&&L){const ae=o.exported.getImageData(L),se={};for(const oe in A){const{width:_e,height:Te,x:Le,y:ue,sdf:Fe,pixelRatio:ke,stretchX:He,stretchY:We,content:et}=A[oe],Ge=new o.RGBAImage({width:_e,height:Te});o.RGBAImage.copy(ae,Ge,{x:Le,y:ue},{x:0,y:0},{width:_e,height:Te}),se[oe]={data:Ge,pixelRatio:ke,sdf:Fe,stretchX:He,stretchY:We,content:et}}w(null,se)}}return{cancel(){V&&(V.cancel(),V=null),W&&(W.cancel(),W=null)}}}(l,this.map._requestManager,this.map.getPixelRatio(),(h,g)=>{if(this._spriteRequest=null,h)this.fire(new o.ErrorEvent(h));else if(g)for(const v in g)this.imageManager.addImage(v,g[v]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(l){const h=this.sourceCaches[l.source];if(!h)return;const g=l.sourceLayer;if(!g)return;const v=h.getSource();(v.type==="geojson"||v.vectorLayerIds&&v.vectorLayerIds.indexOf(g)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${v.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){const h=[];for(const g of l){const v=this._layers[g];v.type!=="custom"&&h.push(v.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;const h=this._changed;if(this._changed){const v=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(v.length||w.length)&&this._updateWorkerLayers(v,w);for(const A in this._updatedSources){const L=this._updatedSources[A];if(L==="reload")this._reloadSource(A);else{if(L!=="clear")throw new Error(`Invalid action ${L}`);this._clearSource(A)}}this._updateTilesForChangedImages();for(const A in this._updatedPaintProps)this._layers[A].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}const g={};for(const v in this.sourceCaches){const w=this.sourceCaches[v];g[v]=w.used,w.used=!1}for(const v of this._order){const w=this._layers[v];w.recalculate(l,this._availableImages),!w.isHidden(l.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const v in g){const w=this.sourceCaches[v];g[v]!==w.used&&w.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:v}))}this.light.recalculate(l),this.z=l.zoom,h&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(l){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),l){const h=this.sourceCaches[l.source];if(!h)throw new Error(`cannot load terrain, because there exists no source with ID: ${l.source}`);this.terrain=new Qt(this,h,l),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=g=>{g.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=g=>{g.tile&&(g.sourceId===l.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(g.sourceId,g.tile.tileID)):g.source.type==="geojson"&&this.terrain.rememberForRerender(g.sourceId,g.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new o.Event("terrain",{terrain:l}))}setState(l){if(this._checkLoaded(),fn(this,o.validateStyle(l)))return!1;(l=o.clone$1(l)).layers=Zs(l.layers);const h=function(v,w){if(!v)return[{command:gn.setStyle,args:[w]}];let A=[];try{if(!S(v.version,w.version))return[{command:gn.setStyle,args:[w]}];S(v.center,w.center)||A.push({command:gn.setCenter,args:[w.center]}),S(v.zoom,w.zoom)||A.push({command:gn.setZoom,args:[w.zoom]}),S(v.bearing,w.bearing)||A.push({command:gn.setBearing,args:[w.bearing]}),S(v.pitch,w.pitch)||A.push({command:gn.setPitch,args:[w.pitch]}),S(v.sprite,w.sprite)||A.push({command:gn.setSprite,args:[w.sprite]}),S(v.glyphs,w.glyphs)||A.push({command:gn.setGlyphs,args:[w.glyphs]}),S(v.transition,w.transition)||A.push({command:gn.setTransition,args:[w.transition]}),S(v.light,w.light)||A.push({command:gn.setLight,args:[w.light]});const L={},$=[];(function(V,W,X,ae){let se;for(se in W=W||{},V=V||{})Object.prototype.hasOwnProperty.call(V,se)&&(Object.prototype.hasOwnProperty.call(W,se)||gr(se,X,ae));for(se in W)Object.prototype.hasOwnProperty.call(W,se)&&(Object.prototype.hasOwnProperty.call(V,se)?S(V[se],W[se])||(V[se].type==="geojson"&&W[se].type==="geojson"&&Ho(V,W,se)?X.push({command:gn.setGeoJSONSourceData,args:[se,W[se].data]}):ms(se,W,X,ae)):ni(se,W,X))})(v.sources,w.sources,$,L);const O=[];v.layers&&v.layers.forEach(V=>{L[V.source]?A.push({command:gn.removeLayer,args:[V.id]}):O.push(V)}),A=A.concat($),function(V,W,X){W=W||[];const ae=(V=V||[]).map(Vi),se=W.map(Vi),oe=V.reduce(So,{}),_e=W.reduce(So,{}),Te=ae.slice(),Le=Object.create(null);let ue,Fe,ke,He,We,et,Ge;for(ue=0,Fe=0;ue<ae.length;ue++)ke=ae[ue],Object.prototype.hasOwnProperty.call(_e,ke)?Fe++:(X.push({command:gn.removeLayer,args:[ke]}),Te.splice(Te.indexOf(ke,Fe),1));for(ue=0,Fe=0;ue<se.length;ue++)ke=se[se.length-1-ue],Te[Te.length-1-ue]!==ke&&(Object.prototype.hasOwnProperty.call(oe,ke)?(X.push({command:gn.removeLayer,args:[ke]}),Te.splice(Te.lastIndexOf(ke,Te.length-Fe),1)):Fe++,et=Te[Te.length-ue],X.push({command:gn.addLayer,args:[_e[ke],et]}),Te.splice(Te.length-ue,0,ke),Le[ke]=!0);for(ue=0;ue<se.length;ue++)if(ke=se[ue],He=oe[ke],We=_e[ke],!Le[ke]&&!S(He,We))if(S(He.source,We.source)&&S(He["source-layer"],We["source-layer"])&&S(He.type,We.type)){for(Ge in Ui(He.layout,We.layout,X,ke,null,gn.setLayoutProperty),Ui(He.paint,We.paint,X,ke,null,gn.setPaintProperty),S(He.filter,We.filter)||X.push({command:gn.setFilter,args:[ke,We.filter]}),S(He.minzoom,We.minzoom)&&S(He.maxzoom,We.maxzoom)||X.push({command:gn.setLayerZoomRange,args:[ke,We.minzoom,We.maxzoom]}),He)Object.prototype.hasOwnProperty.call(He,Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?Ui(He[Ge],We[Ge],X,ke,Ge.slice(6),gn.setPaintProperty):S(He[Ge],We[Ge])||X.push({command:gn.setLayerProperty,args:[ke,Ge,We[Ge]]}));for(Ge in We)Object.prototype.hasOwnProperty.call(We,Ge)&&!Object.prototype.hasOwnProperty.call(He,Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?Ui(He[Ge],We[Ge],X,ke,Ge.slice(6),gn.setPaintProperty):S(He[Ge],We[Ge])||X.push({command:gn.setLayerProperty,args:[ke,Ge,We[Ge]]}))}else X.push({command:gn.removeLayer,args:[ke]}),et=Te[Te.lastIndexOf(ke)+1],X.push({command:gn.addLayer,args:[We,et]})}(O,w.layers,A)}catch(L){console.warn("Unable to compute style diff:",L),A=[{command:gn.setStyle,args:[w]}]}return A}(this.serialize(),l).filter(v=>!(v.command in er));if(h.length===0)return!1;const g=h.filter(v=>!(v.command in vn));if(g.length>0)throw new Error(`Unimplemented: ${g.map(v=>v.command).join(", ")}.`);return h.forEach(v=>{v.command!=="setTransition"&&this[v.command].apply(this,v.args)}),this.stylesheet=l,!0}addImage(l,h){if(this.getImage(l))return this.fire(new o.ErrorEvent(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,h),this._afterImageUpdated(l)}updateImage(l,h){this.imageManager.updateImage(l,h)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new o.ErrorEvent(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,h,g={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(o.validateStyle.source,`sources.${l}`,h,null,g))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const v=this.sourceCaches[l]=new lt(l,h,this.dispatcher);v.style=this,v.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:v.serialize(),sourceId:l})),v.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===l)return this.fire(new o.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${g}" is using it.`)));const h=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],h.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),h.setEventedParent(null),h.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,h){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);const g=this.sourceCaches[l].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(h),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,h,g={}){this._checkLoaded();const v=l.id;if(this.getLayer(v))return void this.fire(new o.ErrorEvent(new Error(`Layer "${v}" already exists on this map.`)));let w;if(l.type==="custom"){if(fn(this,o.validateCustomStyleLayer(l)))return;w=o.createStyleLayer(l)}else{if(typeof l.source=="object"&&(this.addSource(v,l.source),l=o.clone$1(l),l=o.extend(l,{source:v})),this._validate(o.validateStyle.layer,`layers.${v}`,l,{arrayIndex:-1},g))return;w=o.createStyleLayer(l),this._validateLayer(w),w.setEventedParent(this,{layer:{id:v}}),this._serializedLayers[w.id]=w.serialize()}const A=h?this._order.indexOf(h):this._order.length;if(h&&A===-1)this.fire(new o.ErrorEvent(new Error(`Cannot add layer "${v}" before non-existing layer "${h}".`)));else{if(this._order.splice(A,0,v),this._layerOrderChanged=!0,this._layers[v]=w,this._removedLayers[v]&&w.source&&w.type!=="custom"){const L=this._removedLayers[v];delete this._removedLayers[v],L.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(l,h){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new o.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===h)return;const g=this._order.indexOf(l);this._order.splice(g,1);const v=h?this._order.indexOf(h):this._order.length;h&&v===-1?this.fire(new o.ErrorEvent(new Error(`Cannot move layer "${l}" before non-existing layer "${h}".`))):(this._order.splice(v,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();const h=this._layers[l];if(!h)return void this.fire(new o.ErrorEvent(new Error(`Cannot remove non-existing layer "${l}".`)));h.setEventedParent(null);const g=this._order.indexOf(l);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=h,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],h.onRemove&&h.onRemove(this.map)}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,h,g){this._checkLoaded();const v=this.getLayer(l);v?v.minzoom===h&&v.maxzoom===g||(h!=null&&(v.minzoom=h),g!=null&&(v.maxzoom=g),this._updateLayer(v)):this.fire(new o.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,h,g={}){this._checkLoaded();const v=this.getLayer(l);if(v){if(!S(v.filter,h))return h==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(o.validateStyle.filter,`layers.${v.id}.filter`,h,null,g)||(v.filter=o.clone$1(h),this._updateLayer(v)))}else this.fire(new o.ErrorEvent(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return o.clone$1(this.getLayer(l).filter)}setLayoutProperty(l,h,g,v={}){this._checkLoaded();const w=this.getLayer(l);w?S(w.getLayoutProperty(h),g)||(w.setLayoutProperty(h,g,v),this._updateLayer(w)):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,h){const g=this.getLayer(l);if(g)return g.getLayoutProperty(h);this.fire(new o.ErrorEvent(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,h,g,v={}){this._checkLoaded();const w=this.getLayer(l);w?S(w.getPaintProperty(h),g)||(w.setPaintProperty(h,g,v)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,h){return this.getLayer(l).getPaintProperty(h)}setFeatureState(l,h){this._checkLoaded();const g=l.source,v=l.sourceLayer,w=this.sourceCaches[g];if(w===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const A=w.getSource().type;A==="geojson"&&v?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):A!=="vector"||v?(l.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),w.setFeatureState(v,l.id,h)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,h){this._checkLoaded();const g=l.source,v=this.sourceCaches[g];if(v===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const w=v.getSource().type,A=w==="vector"?l.sourceLayer:void 0;w!=="vector"||A?h&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):v.removeFeatureState(A,l.id,h):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();const h=l.source,g=l.sourceLayer,v=this.sourceCaches[h];if(v!==void 0)return v.getSource().type!=="vector"||g?(l.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),v.getFeatureState(g,l.id)):void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,l=>l.serialize()),layers:this._serializeLayers(this._order)},l=>l!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(l){const h=A=>this._layers[A].type==="fill-extrusion",g={},v=[];for(let A=this._order.length-1;A>=0;A--){const L=this._order[A];if(h(L)){g[L]=A;for(const $ of l){const O=$[L];if(O)for(const V of O)v.push(V)}}}v.sort((A,L)=>L.intersectionZ-A.intersectionZ);const w=[];for(let A=this._order.length-1;A>=0;A--){const L=this._order[A];if(h(L))for(let $=v.length-1;$>=0;$--){const O=v[$].feature;if(g[O.layer.id]<A)break;w.push(O),v.pop()}else for(const $ of l){const O=$[L];if(O)for(const V of O)w.push(V.feature)}}return w}queryRenderedFeatures(l,h,g){h&&h.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",h.filter,null,h);const v={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const A of h.layers){const L=this._layers[A];if(!L)return this.fire(new o.ErrorEvent(new Error(`The layer '${A}' does not exist in the map's style and cannot be queried for features.`))),[];v[L.source]=!0}}const w=[];h.availableImages=this._availableImages;for(const A in this.sourceCaches)h.layers&&!v[A]||w.push(Je(this.sourceCaches[A],this._layers,this._serializedLayers,l,h,g));return this.placement&&w.push(function(A,L,$,O,V,W,X){const ae={},se=W.queryRenderedSymbols(O),oe=[];for(const _e of Object.keys(se).map(Number))oe.push(X[_e]);oe.sort(Ot);for(const _e of oe){const Te=_e.featureIndex.lookupSymbolFeatures(se[_e.bucketInstanceId],L,_e.bucketIndex,_e.sourceLayerIndex,V.filter,V.layers,V.availableImages,A);for(const Le in Te){const ue=ae[Le]=ae[Le]||[],Fe=Te[Le];Fe.sort((ke,He)=>{const We=_e.featureSortOrder;if(We){const et=We.indexOf(ke.featureIndex);return We.indexOf(He.featureIndex)-et}return He.featureIndex-ke.featureIndex});for(const ke of Fe)ue.push(ke)}}for(const _e in ae)ae[_e].forEach(Te=>{const Le=Te.feature,ue=$[A[_e].source].getFeatureState(Le.layer["source-layer"],Le.id);Le.source=Le.layer.source,Le.layer["source-layer"]&&(Le.sourceLayer=Le.layer["source-layer"]),Le.state=ue});return ae}(this._layers,this._serializedLayers,this.sourceCaches,l,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(l,h){h&&h.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",h.filter,null,h);const g=this.sourceCaches[l];return g?function(v,w){const A=v.getRenderableIds().map(O=>v.getTileByID(O)),L=[],$={};for(let O=0;O<A.length;O++){const V=A[O],W=V.tileID.canonical.key;$[W]||($[W]=!0,V.querySourceFeatures(L,w))}return L}(g,h):[]}addSourceType(l,h,g){return ii.getSourceType(l)?g(new Error(`A source type called "${l}" already exists.`)):(ii.setSourceType(l,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:h.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(l,h={}){this._checkLoaded();const g=this.light.getLight();let v=!1;for(const A in l)if(!S(l[A],g[A])){v=!0;break}if(!v)return;const w={now:o.exported.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,h),this.light.updateTransitions(w)}_validate(l,h,g,v,w={}){return(!w||w.validate!==!1)&&fn(this,l.call(o.validateStyle,o.extend({key:h,style:this.serialize(),value:g,styleSpec:o.spec},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this.sourceCaches){const h=this.sourceCaches[l];h.setEventedParent(null),h.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(const h in this.sourceCaches)this.sourceCaches[h].update(l,this.terrain)}_generateCollisionBoxes(){for(const l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,h,g,v,w=!1){let A=!1,L=!1;const $={};for(const O of this._order){const V=this._layers[O];if(V.type!=="symbol")continue;if(!$[V.source]){const X=this.sourceCaches[V.source];$[V.source]=X.getRenderableIds(!0).map(ae=>X.getTileByID(ae)).sort((ae,se)=>se.tileID.overscaledZ-ae.tileID.overscaledZ||(ae.tileID.isLessThan(se.tileID)?-1:1))}const W=this.crossTileSymbolIndex.addLayer(V,$[V.source],l.center.lng);A=A||W}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),l.zoom))&&(this.pauseablePlacement=new Ue(l,this.terrain,this._order,w,h,g,v,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,$),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),L=!0),A&&this.pauseablePlacement.placement.setStale()),L||A)for(const O of this._order){const V=this._layers[O];V.type==="symbol"&&this.placement.updateLayerOpacities(V,$[V.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,h,g){this.imageManager.getImages(h.icons,g),this._updateTilesForChangedImages();const v=this.sourceCaches[h.source];v&&v.setDependencies(h.tileID.key,h.type,h.icons)}getGlyphs(l,h,g){this.glyphManager.getGlyphs(h.stacks,g)}getResource(l,h,g){return o.makeRequest(h,g)}}ii.getSourceType=function(y){return Pe[y]},ii.setSourceType=function(y,l){Pe[y]=l},ii.registerForPluginStateChange=o.registerForPluginStateChange;var Ys="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const wi={prelude:Rn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Rn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Rn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Rn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Rn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Rn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Rn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Rn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Rn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Rn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Rn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Rn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Rn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Rn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Rn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Rn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Rn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Rn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Rn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Rn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Rn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Rn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Rn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Rn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Rn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Rn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Rn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Ys),terrainDepth:Rn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Ys),terrainCoords:Rn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Ys)};function Rn(y,l){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=l.match(/attribute ([\w]+) ([\w]+)/g),v=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=w?w.concat(v):v,L={};return{fragmentSource:y=y.replace(h,($,O,V,W,X)=>(L[X]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
varying ${V} ${W} ${X};
#else
uniform ${V} ${W} u_${X};
#endif
`:`
#ifdef HAS_UNIFORM_u_${X}
    ${V} ${W} ${X} = u_${X};
#endif
`)),vertexSource:l=l.replace(h,($,O,V,W,X)=>{const ae=W==="float"?"vec2":"vec4",se=X.match(/color/)?"color":ae;return L[X]?O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${V} ${ae} a_${X};
varying ${V} ${W} ${X};
#else
uniform ${V} ${W} u_${X};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = a_${X};
#else
    ${V} ${W} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${X} = unpack_mix_${se}(a_${X}, u_${X}_t);
#else
    ${V} ${W} ${X} = u_${X};
#endif
`:O==="define"?`
#ifndef HAS_UNIFORM_u_${X}
uniform lowp float u_${X}_t;
attribute ${V} ${ae} a_${X};
#else
uniform ${V} ${W} u_${X};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${X}
    ${V} ${W} ${X} = a_${X};
#else
    ${V} ${W} ${X} = u_${X};
#endif
`:`
#ifndef HAS_UNIFORM_u_${X}
    ${V} ${W} ${X} = unpack_mix_${se}(a_${X}, u_${X}_t);
#else
    ${V} ${W} ${X} = u_${X};
#endif
`}),staticAttributes:g,staticUniforms:A}}class Ka{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,h,g,v,w,A,L,$,O){this.context=l;let V=this.boundPaintVertexBuffers.length!==v.length;for(let W=0;!V&&W<v.length;W++)this.boundPaintVertexBuffers[W]!==v[W]&&(V=!0);l.extVertexArrayObject&&this.vao&&this.boundProgram===h&&this.boundLayoutVertexBuffer===g&&!V&&this.boundIndexBuffer===w&&this.boundVertexOffset===A&&this.boundDynamicVertexBuffer===L&&this.boundDynamicVertexBuffer2===$&&this.boundDynamicVertexBuffer3===O?(l.bindVertexArrayOES.set(this.vao),L&&L.bind(),w&&w.dynamicDraw&&w.bind(),$&&$.bind(),O&&O.bind()):this.freshBind(h,g,v,w,A,L,$,O)}freshBind(l,h,g,v,w,A,L,$){let O;const V=l.numAttributes,W=this.context,X=W.gl;if(W.extVertexArrayObject)this.vao&&this.destroy(),this.vao=W.extVertexArrayObject.createVertexArrayOES(),W.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=l,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=v,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=A,this.boundDynamicVertexBuffer2=L,this.boundDynamicVertexBuffer3=$;else{O=W.currentNumAttributes||0;for(let ae=V;ae<O;ae++)X.disableVertexAttribArray(ae)}h.enableAttributes(X,l);for(const ae of g)ae.enableAttributes(X,l);A&&A.enableAttributes(X,l),L&&L.enableAttributes(X,l),$&&$.enableAttributes(X,l),h.bind(),h.setVertexAttribPointers(X,l,w);for(const ae of g)ae.bind(),ae.setVertexAttribPointers(X,l,w);A&&(A.bind(),A.setVertexAttribPointers(X,l,w)),v&&v.bind(),L&&(L.bind(),L.setVertexAttribPointers(X,l,w)),$&&($.bind(),$.setVertexAttribPointers(X,l,w)),W.currentNumAttributes=V}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function qa(y){const l=[];for(let h=0;h<y.length;h++){if(y[h]===null)continue;const g=y[h].split(" ");l.push(g.pop())}return l}class Ul{constructor(l,h,g,v,w,A,L){const $=l.gl;this.program=$.createProgram();const O=qa(g.staticAttributes),V=v?v.getBinderAttributes():[],W=O.concat(V),X=wi.prelude.staticUniforms?qa(wi.prelude.staticUniforms):[],ae=g.staticUniforms?qa(g.staticUniforms):[],se=v?v.getBinderUniforms():[],oe=X.concat(ae).concat(se),_e=[];for(const We of oe)_e.indexOf(We)<0&&_e.push(We);const Te=v?v.defines():[];A&&Te.push("#define OVERDRAW_INSPECTOR;"),L&&Te.push("#define TERRAIN3D;");const Le=Te.concat(wi.prelude.fragmentSource,g.fragmentSource).join(`
`),ue=Te.concat(wi.prelude.vertexSource,g.vertexSource).join(`
`),Fe=$.createShader($.FRAGMENT_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);$.shaderSource(Fe,Le),$.compileShader(Fe),$.attachShader(this.program,Fe);const ke=$.createShader($.VERTEX_SHADER);if($.isContextLost())return void(this.failedToCreate=!0);$.shaderSource(ke,ue),$.compileShader(ke),$.attachShader(this.program,ke),this.attributes={};const He={};this.numAttributes=W.length;for(let We=0;We<this.numAttributes;We++)W[We]&&($.bindAttribLocation(this.program,We,W[We]),this.attributes[W[We]]=We);$.linkProgram(this.program),$.deleteShader(ke),$.deleteShader(Fe);for(let We=0;We<_e.length;We++){const et=_e[We];if(et&&!He[et]){const Ge=$.getUniformLocation(this.program,et);Ge&&(He[et]=Ge)}}this.fixedUniforms=w(l,He),this.terrainUniforms=((We,et)=>({u_depth:new o.Uniform1i(We,et.u_depth),u_terrain:new o.Uniform1i(We,et.u_terrain),u_terrain_dim:new o.Uniform1f(We,et.u_terrain_dim),u_terrain_matrix:new o.UniformMatrix4f(We,et.u_terrain_matrix),u_terrain_unpack:new o.Uniform4f(We,et.u_terrain_unpack),u_terrain_offset:new o.Uniform1f(We,et.u_terrain_offset),u_terrain_exaggeration:new o.Uniform1f(We,et.u_terrain_exaggeration)}))(l,He),this.binderUniforms=v?v.getUniforms(l,He):[]}draw(l,h,g,v,w,A,L,$,O,V,W,X,ae,se,oe,_e,Te,Le){const ue=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(g),l.setStencilMode(v),l.setColorMode(w),l.setCullFace(A),$){l.activeTexture.set(ue.TEXTURE2),ue.bindTexture(ue.TEXTURE_2D,$.depthTexture),l.activeTexture.set(ue.TEXTURE3),ue.bindTexture(ue.TEXTURE_2D,$.texture);for(const ke in this.terrainUniforms)this.terrainUniforms[ke].set($[ke])}for(const ke in this.fixedUniforms)this.fixedUniforms[ke].set(L[ke]);oe&&oe.setUniforms(l,this.binderUniforms,ae,{zoom:se});let Fe=0;switch(h){case ue.LINES:Fe=2;break;case ue.TRIANGLES:Fe=3;break;case ue.LINE_STRIP:Fe=1}for(const ke of X.get()){const He=ke.vaos||(ke.vaos={});(He[O]||(He[O]=new Ka)).bind(l,this,V,oe?oe.getPaintVertexBuffers():[],W,ke.vertexOffset,_e,Te,Le),ue.drawElements(h,ke.primitiveLength*Fe,ue.UNSIGNED_SHORT,ke.primitiveOffset*Fe*2)}}}function Vl(y,l,h){const g=1/An(h,1,l.transform.tileZoom),v=Math.pow(2,h.tileID.overscaledZ),w=h.tileSize*Math.pow(2,l.transform.tileZoom)/v,A=w*(h.tileID.canonical.x+h.tileID.wrap*v),L=w*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[g,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[A>>16,L>>16],u_pixel_coord_lower:[65535&A,65535&L]}}const _a=(y,l,h,g)=>{const v=l.style.light,w=v.properties.get("position"),A=[w.x,w.y,w.z],L=o.create$1();v.properties.get("anchor")==="viewport"&&o.fromRotation(L,-l.transform.angle),o.transformMat3(A,A,L);const $=v.properties.get("color");return{u_matrix:y,u_lightpos:A,u_lightintensity:v.properties.get("intensity"),u_lightcolor:[$.r,$.g,$.b],u_vertical_gradient:+h,u_opacity:g}},Js=(y,l,h,g,v,w,A)=>o.extend(_a(y,l,h,g),Vl(w,l,A),{u_height_factor:-Math.pow(2,v.overscaledZ)/A.tileSize/8}),Gl=y=>({u_matrix:y}),jl=(y,l,h,g)=>o.extend(Gl(y),Vl(h,l,g)),Hl=(y,l)=>({u_matrix:y,u_world:l}),Yc=(y,l,h,g,v)=>o.extend(jl(y,l,h,g),{u_world:v}),_d=(y,l,h,g)=>{const v=y.transform;let w,A;if(g.paint.get("circle-pitch-alignment")==="map"){const L=An(h,1,v.zoom);w=!0,A=[L,L]}else w=!1,A=v.pixelsToGLUnits;return{u_camera_to_center_distance:v.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(l.posMatrix,h,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+w,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:A}},Wo=(y,l,h)=>{const g=An(h,1,l.zoom),v=Math.pow(2,l.zoom-h.tileID.overscaledZ),w=h.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:l.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[l.pixelsToGLUnits[0]/(g*v),l.pixelsToGLUnits[1]/(g*v)],u_overscale_factor:w}},Z=(y,l,h=1)=>({u_matrix:y,u_color:l,u_overlay:0,u_overlay_scale:h}),ne=y=>({u_matrix:y}),ge=(y,l,h,g)=>({u_matrix:y,u_extrude_scale:An(l,1,h),u_intensity:g});function Ne(y,l){const h=Math.pow(2,l.canonical.z),g=l.canonical.y;return[new o.MercatorCoordinate(0,g/h).toLngLat().lat,new o.MercatorCoordinate(0,(g+1)/h).toLngLat().lat]}const nt=(y,l,h,g)=>{const v=y.transform;return{u_matrix:Nr(y,l,h,g),u_ratio:1/An(l,1,v.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/v.pixelsToGLUnits[0],1/v.pixelsToGLUnits[1]]}},Lt=(y,l,h,g,v)=>o.extend(nt(y,l,h,v),{u_image:0,u_image_height:g}),pn=(y,l,h,g,v)=>{const w=y.transform,A=un(l,w);return{u_matrix:Nr(y,l,h,v),u_texsize:l.imageAtlasTexture.size,u_ratio:1/An(l,1,w.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[A,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},yr=(y,l,h,g,v,w)=>{const A=y.lineAtlas,L=un(l,y.transform),$=h.layout.get("line-cap")==="round",O=A.getDash(g.from,$),V=A.getDash(g.to,$),W=O.width*v.fromScale,X=V.width*v.toScale;return o.extend(nt(y,l,h,w),{u_patternscale_a:[L/W,-O.height/2],u_patternscale_b:[L/X,-V.height/2],u_sdfgamma:A.width/(256*Math.min(W,X)*y.pixelRatio)/2,u_image:0,u_tex_y_a:O.y,u_tex_y_b:V.y,u_mix:v.t})};function un(y,l){return 1/An(y,1,l.tileZoom)}function Nr(y,l,h,g){return y.translatePosMatrix(g?g.posMatrix:l.tileID.posMatrix,l,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}const gs=(y,l,h,g,v)=>{return{u_matrix:y,u_tl_parent:l,u_scale_parent:h,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(A=v.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(w=v.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Ng(v.paint.get("raster-hue-rotate"))};var w,A};function Ng(y){y*=Math.PI/180;const l=Math.sin(y),h=Math.cos(y);return[(2*h+1)/3,(-Math.sqrt(3)*l-h+1)/3,(Math.sqrt(3)*l-h+1)/3]}const If=(y,l,h,g,v,w,A,L,$,O)=>{const V=v.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:V.cameraToCenterDistance,u_pitch:V.pitch/360*2*Math.PI,u_rotate_symbol:+h,u_aspect_ratio:V.width/V.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:A,u_coord_matrix:L,u_is_text:+$,u_pitch_with_map:+g,u_texsize:O,u_texture:0}},vd=(y,l,h,g,v,w,A,L,$,O,V)=>{const W=v.transform;return o.extend(If(y,l,h,g,v,w,A,L,$,O),{u_gamma_scale:g?Math.cos(W._pitch)*W.cameraToCenterDistance:1,u_device_pixel_ratio:v.pixelRatio,u_is_halo:+V})},Bg=(y,l,h,g,v,w,A,L,$,O)=>o.extend(vd(y,l,h,g,v,w,A,L,!0,$,!0),{u_texsize_icon:O,u_texture_icon:1}),kb=(y,l,h)=>({u_matrix:y,u_opacity:l,u_color:h}),Ob=(y,l,h,g,v,w)=>o.extend(function(A,L,$,O){const V=$.imageManager.getPattern(A.from.toString()),W=$.imageManager.getPattern(A.to.toString()),{width:X,height:ae}=$.imageManager.getPixelSize(),se=Math.pow(2,O.tileID.overscaledZ),oe=O.tileSize*Math.pow(2,$.transform.tileZoom)/se,_e=oe*(O.tileID.canonical.x+O.tileID.wrap*se),Te=oe*O.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:V.tl,u_pattern_br_a:V.br,u_pattern_tl_b:W.tl,u_pattern_br_b:W.br,u_texsize:[X,ae],u_mix:L.t,u_pattern_size_a:V.displaySize,u_pattern_size_b:W.displaySize,u_scale_a:L.fromScale,u_scale_b:L.toScale,u_tile_units_to_pixels:1/An(O,1,$.transform.tileZoom),u_pixel_coord_upper:[_e>>16,Te>>16],u_pixel_coord_lower:[65535&_e,65535&Te]}}(g,w,h,v),{u_matrix:y,u_opacity:l}),Lf={fillExtrusion:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_lightpos:new o.Uniform3f(y,l.u_lightpos),u_lightintensity:new o.Uniform1f(y,l.u_lightintensity),u_lightcolor:new o.Uniform3f(y,l.u_lightcolor),u_vertical_gradient:new o.Uniform1f(y,l.u_vertical_gradient),u_opacity:new o.Uniform1f(y,l.u_opacity)}),fillExtrusionPattern:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_lightpos:new o.Uniform3f(y,l.u_lightpos),u_lightintensity:new o.Uniform1f(y,l.u_lightintensity),u_lightcolor:new o.Uniform3f(y,l.u_lightcolor),u_vertical_gradient:new o.Uniform1f(y,l.u_vertical_gradient),u_height_factor:new o.Uniform1f(y,l.u_height_factor),u_image:new o.Uniform1i(y,l.u_image),u_texsize:new o.Uniform2f(y,l.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,l.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,l.u_scale),u_fade:new o.Uniform1f(y,l.u_fade),u_opacity:new o.Uniform1f(y,l.u_opacity)}),fill:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix)}),fillPattern:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_image:new o.Uniform1i(y,l.u_image),u_texsize:new o.Uniform2f(y,l.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,l.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,l.u_scale),u_fade:new o.Uniform1f(y,l.u_fade)}),fillOutline:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_world:new o.Uniform2f(y,l.u_world)}),fillOutlinePattern:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_world:new o.Uniform2f(y,l.u_world),u_image:new o.Uniform1i(y,l.u_image),u_texsize:new o.Uniform2f(y,l.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,l.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,l.u_scale),u_fade:new o.Uniform1f(y,l.u_fade)}),circle:(y,l)=>({u_camera_to_center_distance:new o.Uniform1f(y,l.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(y,l.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(y,l.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(y,l.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(y,l.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(y,l.u_matrix)}),collisionBox:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_camera_to_center_distance:new o.Uniform1f(y,l.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(y,l.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(y,l.u_extrude_scale),u_overscale_factor:new o.Uniform1f(y,l.u_overscale_factor)}),collisionCircle:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_inv_matrix:new o.UniformMatrix4f(y,l.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(y,l.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(y,l.u_viewport_size)}),debug:(y,l)=>({u_color:new o.UniformColor(y,l.u_color),u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_overlay:new o.Uniform1i(y,l.u_overlay),u_overlay_scale:new o.Uniform1f(y,l.u_overlay_scale)}),clippingMask:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix)}),heatmap:(y,l)=>({u_extrude_scale:new o.Uniform1f(y,l.u_extrude_scale),u_intensity:new o.Uniform1f(y,l.u_intensity),u_matrix:new o.UniformMatrix4f(y,l.u_matrix)}),heatmapTexture:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_world:new o.Uniform2f(y,l.u_world),u_image:new o.Uniform1i(y,l.u_image),u_color_ramp:new o.Uniform1i(y,l.u_color_ramp),u_opacity:new o.Uniform1f(y,l.u_opacity)}),hillshade:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_image:new o.Uniform1i(y,l.u_image),u_latrange:new o.Uniform2f(y,l.u_latrange),u_light:new o.Uniform2f(y,l.u_light),u_shadow:new o.UniformColor(y,l.u_shadow),u_highlight:new o.UniformColor(y,l.u_highlight),u_accent:new o.UniformColor(y,l.u_accent)}),hillshadePrepare:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_image:new o.Uniform1i(y,l.u_image),u_dimension:new o.Uniform2f(y,l.u_dimension),u_zoom:new o.Uniform1f(y,l.u_zoom),u_unpack:new o.Uniform4f(y,l.u_unpack)}),line:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_ratio:new o.Uniform1f(y,l.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,l.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,l.u_units_to_pixels)}),lineGradient:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_ratio:new o.Uniform1f(y,l.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,l.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,l.u_units_to_pixels),u_image:new o.Uniform1i(y,l.u_image),u_image_height:new o.Uniform1f(y,l.u_image_height)}),linePattern:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_texsize:new o.Uniform2f(y,l.u_texsize),u_ratio:new o.Uniform1f(y,l.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,l.u_device_pixel_ratio),u_image:new o.Uniform1i(y,l.u_image),u_units_to_pixels:new o.Uniform2f(y,l.u_units_to_pixels),u_scale:new o.Uniform3f(y,l.u_scale),u_fade:new o.Uniform1f(y,l.u_fade)}),lineSDF:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_ratio:new o.Uniform1f(y,l.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,l.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,l.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(y,l.u_patternscale_a),u_patternscale_b:new o.Uniform2f(y,l.u_patternscale_b),u_sdfgamma:new o.Uniform1f(y,l.u_sdfgamma),u_image:new o.Uniform1i(y,l.u_image),u_tex_y_a:new o.Uniform1f(y,l.u_tex_y_a),u_tex_y_b:new o.Uniform1f(y,l.u_tex_y_b),u_mix:new o.Uniform1f(y,l.u_mix)}),raster:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_tl_parent:new o.Uniform2f(y,l.u_tl_parent),u_scale_parent:new o.Uniform1f(y,l.u_scale_parent),u_buffer_scale:new o.Uniform1f(y,l.u_buffer_scale),u_fade_t:new o.Uniform1f(y,l.u_fade_t),u_opacity:new o.Uniform1f(y,l.u_opacity),u_image0:new o.Uniform1i(y,l.u_image0),u_image1:new o.Uniform1i(y,l.u_image1),u_brightness_low:new o.Uniform1f(y,l.u_brightness_low),u_brightness_high:new o.Uniform1f(y,l.u_brightness_high),u_saturation_factor:new o.Uniform1f(y,l.u_saturation_factor),u_contrast_factor:new o.Uniform1f(y,l.u_contrast_factor),u_spin_weights:new o.Uniform3f(y,l.u_spin_weights)}),symbolIcon:(y,l)=>({u_is_size_zoom_constant:new o.Uniform1i(y,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,l.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,l.u_size_t),u_size:new o.Uniform1f(y,l.u_size),u_camera_to_center_distance:new o.Uniform1f(y,l.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,l.u_pitch),u_rotate_symbol:new o.Uniform1i(y,l.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,l.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,l.u_fade_change),u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,l.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,l.u_coord_matrix),u_is_text:new o.Uniform1i(y,l.u_is_text),u_pitch_with_map:new o.Uniform1i(y,l.u_pitch_with_map),u_texsize:new o.Uniform2f(y,l.u_texsize),u_texture:new o.Uniform1i(y,l.u_texture)}),symbolSDF:(y,l)=>({u_is_size_zoom_constant:new o.Uniform1i(y,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,l.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,l.u_size_t),u_size:new o.Uniform1f(y,l.u_size),u_camera_to_center_distance:new o.Uniform1f(y,l.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,l.u_pitch),u_rotate_symbol:new o.Uniform1i(y,l.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,l.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,l.u_fade_change),u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,l.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,l.u_coord_matrix),u_is_text:new o.Uniform1i(y,l.u_is_text),u_pitch_with_map:new o.Uniform1i(y,l.u_pitch_with_map),u_texsize:new o.Uniform2f(y,l.u_texsize),u_texture:new o.Uniform1i(y,l.u_texture),u_gamma_scale:new o.Uniform1f(y,l.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(y,l.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(y,l.u_is_halo)}),symbolTextAndIcon:(y,l)=>({u_is_size_zoom_constant:new o.Uniform1i(y,l.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,l.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,l.u_size_t),u_size:new o.Uniform1f(y,l.u_size),u_camera_to_center_distance:new o.Uniform1f(y,l.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,l.u_pitch),u_rotate_symbol:new o.Uniform1i(y,l.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,l.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,l.u_fade_change),u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,l.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,l.u_coord_matrix),u_is_text:new o.Uniform1i(y,l.u_is_text),u_pitch_with_map:new o.Uniform1i(y,l.u_pitch_with_map),u_texsize:new o.Uniform2f(y,l.u_texsize),u_texsize_icon:new o.Uniform2f(y,l.u_texsize_icon),u_texture:new o.Uniform1i(y,l.u_texture),u_texture_icon:new o.Uniform1i(y,l.u_texture_icon),u_gamma_scale:new o.Uniform1f(y,l.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(y,l.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(y,l.u_is_halo)}),background:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_opacity:new o.Uniform1f(y,l.u_opacity),u_color:new o.UniformColor(y,l.u_color)}),backgroundPattern:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_opacity:new o.Uniform1f(y,l.u_opacity),u_image:new o.Uniform1i(y,l.u_image),u_pattern_tl_a:new o.Uniform2f(y,l.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(y,l.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(y,l.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(y,l.u_pattern_br_b),u_texsize:new o.Uniform2f(y,l.u_texsize),u_mix:new o.Uniform1f(y,l.u_mix),u_pattern_size_a:new o.Uniform2f(y,l.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(y,l.u_pattern_size_b),u_scale_a:new o.Uniform1f(y,l.u_scale_a),u_scale_b:new o.Uniform1f(y,l.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(y,l.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,l.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(y,l.u_tile_units_to_pixels)}),terrain:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_texture:new o.Uniform1i(y,l.u_texture)}),terrainDepth:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix)}),terrainCoords:(y,l)=>({u_matrix:new o.UniformMatrix4f(y,l.u_matrix),u_texture:new o.Uniform1i(y,l.u_texture),u_terrain_coords_id:new o.Uniform1f(y,l.u_terrain_coords_id)})};class Rf{constructor(l,h,g){this.context=l;const v=l.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const h=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const $f={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Mf{constructor(l,h,g,v){this.length=h.length,this.attributes=g,this.itemSize=h.bytesPerElement,this.dynamicDraw=v,this.context=l;const w=l.gl;this.buffer=w.createBuffer(),l.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete h.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,h){for(let g=0;g<this.attributes.length;g++){const v=h.attributes[this.attributes[g].name];v!==void 0&&l.enableVertexAttribArray(v)}}setVertexAttribPointers(l,h,g){for(let v=0;v<this.attributes.length;v++){const w=this.attributes[v],A=h.attributes[w.name];A!==void 0&&l.vertexAttribPointer(A,w.components,l[$f[w.type]],!1,this.itemSize,w.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Fn{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ug extends Fn{getDefault(){return o.Color.transparent}set(l){const h=this.current;(l.r!==h.r||l.g!==h.g||l.b!==h.b||l.a!==h.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Db extends Fn{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class Jc extends Fn{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Qc extends Fn{getDefault(){return[!0,!0,!0,!0]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||l[3]!==h[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Vg extends Fn{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class ys extends Fn{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class kf extends Fn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const h=this.current;(l.func!==h.func||l.ref!==h.ref||l.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class bd extends Fn{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class xd extends Fn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=l,this.dirty=!1}}class Of extends Fn{getDefault(){return[0,1]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class Df extends Fn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=l,this.dirty=!1}}class wd extends Fn{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Ff extends Fn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.BLEND):h.disable(h.BLEND),this.current=l,this.dirty=!1}}class zf extends Fn{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class Ed extends Fn{getDefault(){return o.Color.transparent}set(l){const h=this.current;(l.r!==h.r||l.g!==h.g||l.b!==h.b||l.a!==h.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Gg extends Fn{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class jg extends Fn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=l,this.dirty=!1}}class Wl extends Fn{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class Fb extends Fn{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class zb extends Fn{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class Nb extends Fn{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class Bb extends Fn{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||l[3]!==h[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Ub extends Fn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class Vb extends Fn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class Nf extends Fn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Td extends Fn{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Bf extends Fn{getDefault(){return null}set(l){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class Uf extends Fn{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class Kl extends Fn{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class Hg extends Fn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class Wg extends Fn{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class Sd extends Fn{constructor(l,h){super(l),this.context=l,this.parent=h}getDefault(){return null}}class Xa extends Sd{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Kg extends Sd{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class ql{constructor(l,h,g,v){this.context=l,this.width=h,this.height=g;const w=l.gl,A=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new Xa(l,A),v&&(this.depthAttachment=new Kg(l,A)),w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const l=this.context.gl,h=this.colorAttachment.get();if(h&&l.deleteTexture(h),this.depthAttachment){const g=this.depthAttachment.get();g&&l.deleteRenderbuffer(g)}l.deleteFramebuffer(this.framebuffer)}}class or{constructor(l,h,g){this.blendFunction=l,this.blendColor=h,this.mask=g}}or.Replace=[1,0],or.disabled=new or(or.Replace,o.Color.transparent,[!1,!1,!1,!1]),or.unblended=new or(or.Replace,o.Color.transparent,[!0,!0,!0,!0]),or.alphaBlended=new or([1,771],o.Color.transparent,[!0,!0,!0,!0]);class qg{constructor(l){this.gl=l,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Ug(this),this.clearDepth=new Db(this),this.clearStencil=new Jc(this),this.colorMask=new Qc(this),this.depthMask=new Vg(this),this.stencilMask=new ys(this),this.stencilFunc=new kf(this),this.stencilOp=new bd(this),this.stencilTest=new xd(this),this.depthRange=new Of(this),this.depthTest=new Df(this),this.depthFunc=new wd(this),this.blend=new Ff(this),this.blendFunc=new zf(this),this.blendColor=new Ed(this),this.blendEquation=new Gg(this),this.cullFace=new jg(this),this.cullFaceSide=new Wl(this),this.frontFace=new Fb(this),this.program=new zb(this),this.activeTexture=new Nb(this),this.viewport=new Bb(this),this.bindFramebuffer=new Ub(this),this.bindRenderbuffer=new Vb(this),this.bindTexture=new Nf(this),this.bindVertexBuffer=new Td(this),this.bindElementBuffer=new Bf(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Uf(this),this.pixelStoreUnpack=new Kl(this),this.pixelStoreUnpackPremultiplyAlpha=new Hg(this),this.pixelStoreUnpackFlipY=new Wg(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=l.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(l.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,h){return new Rf(this,l,h)}createVertexBuffer(l,h,g){return new Mf(this,l,h,g)}createRenderbuffer(l,h,g){const v=this.gl,w=v.createRenderbuffer();return this.bindRenderbuffer.set(w),v.renderbufferStorage(v.RENDERBUFFER,l,h,g),this.bindRenderbuffer.set(null),w}createFramebuffer(l,h,g){return new ql(this,l,h,g)}clear({color:l,depth:h}){const g=this.gl;let v=0;l&&(v|=g.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(v|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g.clear(v)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){S(l.blendFunction,or.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class wn{constructor(l,h,g){this.func=l,this.mask=h,this.range=g}}wn.ReadOnly=!1,wn.ReadWrite=!0,wn.disabled=new wn(519,wn.ReadOnly,[0,1]);const zn=7680;class ir{constructor(l,h,g,v,w,A){this.test=l,this.ref=h,this.mask=g,this.fail=v,this.depthFail=w,this.pass=A}}ir.disabled=new ir({func:519,mask:0},0,0,zn,zn,zn);class dr{constructor(l,h,g){this.enable=l,this.mode=h,this.frontFace=g}}let eu;function Xl(y,l,h,g,v,w,A){const L=y.context,$=L.gl,O=y.useProgram("collisionBox"),V=[];let W=0,X=0;for(let ue=0;ue<g.length;ue++){const Fe=g[ue],ke=l.getTile(Fe),He=ke.getBucket(h);if(!He)continue;let We=Fe.posMatrix;v[0]===0&&v[1]===0||(We=y.translatePosMatrix(Fe.posMatrix,ke,v,w));const et=A?He.textCollisionBox:He.iconCollisionBox,Ge=He.collisionCircleArray;if(Ge.length>0){const wt=o.create(),ft=We;o.mul(wt,He.placementInvProjMatrix,y.transform.glCoordMatrix),o.mul(wt,wt,He.placementViewportMatrix),V.push({circleArray:Ge,circleOffset:X,transform:ft,invTransform:wt,coord:Fe}),W+=Ge.length/4,X=W}et&&O.draw(L,$.LINES,wn.disabled,ir.disabled,y.colorModeForRenderPass(),dr.disabled,Wo(We,y.transform,ke),y.style.terrain&&y.style.terrain.getTerrainData(Fe),h.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,null,y.transform.zoom,null,null,et.collisionVertexBuffer)}if(!A||!V.length)return;const ae=y.useProgram("collisionCircle"),se=new o.CollisionCircleLayoutArray;se.resize(4*W),se._trim();let oe=0;for(const ue of V)for(let Fe=0;Fe<ue.circleArray.length/4;Fe++){const ke=4*Fe,He=ue.circleArray[ke+0],We=ue.circleArray[ke+1],et=ue.circleArray[ke+2],Ge=ue.circleArray[ke+3];se.emplace(oe++,He,We,et,Ge,0),se.emplace(oe++,He,We,et,Ge,1),se.emplace(oe++,He,We,et,Ge,2),se.emplace(oe++,He,We,et,Ge,3)}(!eu||eu.length<2*W)&&(eu=function(ue){const Fe=2*ue,ke=new o.QuadTriangleArray;ke.resize(Fe),ke._trim();for(let He=0;He<Fe;He++){const We=6*He;ke.uint16[We+0]=4*He+0,ke.uint16[We+1]=4*He+1,ke.uint16[We+2]=4*He+2,ke.uint16[We+3]=4*He+2,ke.uint16[We+4]=4*He+3,ke.uint16[We+5]=4*He+0}return ke}(W));const _e=L.createIndexBuffer(eu,!0),Te=L.createVertexBuffer(se,o.collisionCircleLayout.members,!0);for(const ue of V){const Fe={u_matrix:ue.transform,u_inv_matrix:ue.invTransform,u_camera_to_center_distance:(Le=y.transform).cameraToCenterDistance,u_viewport_size:[Le.width,Le.height]};ae.draw(L,$.TRIANGLES,wn.disabled,ir.disabled,y.colorModeForRenderPass(),dr.disabled,Fe,y.style.terrain&&y.style.terrain.getTerrainData(ue.coord),h.id,Te,_e,o.SegmentVector.simpleSegment(0,2*ue.circleOffset,ue.circleArray.length,ue.circleArray.length/2),null,y.transform.zoom,null,null,null)}var Le;Te.destroy(),_e.destroy()}dr.disabled=new dr(!1,1029,2305),dr.backCCW=new dr(!0,1029,2305);const Gb=o.identity(new Float32Array(16));function jb(y,l,h,g,v,w){const{horizontalAlign:A,verticalAlign:L}=o.getAnchorAlignment(y),$=-(A-.5)*l,O=-(L-.5)*h,V=o.evaluateVariableOffset(y,g);return new o.pointGeometry(($/v+V[0])*w,(O/v+V[1])*w)}function Xg(y,l,h,g,v,w,A,L,$,O,V){const W=y.text.placedSymbolArray,X=y.text.dynamicLayoutVertexArray,ae=y.icon.dynamicLayoutVertexArray,se={};X.clear();for(let oe=0;oe<W.length;oe++){const _e=W.get(oe),Te=y.allowVerticalPlacement&&!_e.placedOrientation,Le=_e.hidden||!_e.crossTileID||Te?null:g[_e.crossTileID];if(Le){const ue=new o.pointGeometry(_e.anchorX,_e.anchorY),Fe=ln(ue,h?A:w,V),ke=Li(v.cameraToCenterDistance,Fe.signedDistanceFromCamera);let He=o.evaluateSizeForFeature(y.textSizeData,$,_e)*ke/o.ONE_EM;h&&(He*=y.tilePixelRatio/L);const{width:We,height:et,anchor:Ge,textOffset:wt,textBoxScale:ft}=Le,Tt=jb(Ge,We,et,wt,ft,He),tn=h?ln(ue.add(Tt),w,V).point:Fe.point.add(l?Tt.rotate(-v.angle):Tt),dn=y.allowVerticalPlacement&&_e.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let Gt=0;Gt<_e.numGlyphs;Gt++)o.addDynamicAttributes(X,tn,dn);O&&_e.associatedIconIndex>=0&&(se[_e.associatedIconIndex]={shiftedAnchor:tn,angle:dn})}else it(_e.numGlyphs,X)}if(O){ae.clear();const oe=y.icon.placedSymbolArray;for(let _e=0;_e<oe.length;_e++){const Te=oe.get(_e);if(Te.hidden)it(Te.numGlyphs,ae);else{const Le=se[_e];if(Le)for(let ue=0;ue<Te.numGlyphs;ue++)o.addDynamicAttributes(ae,Le.shiftedAnchor,Le.angle);else it(Te.numGlyphs,ae)}}y.icon.dynamicLayoutVertexBuffer.updateData(ae)}y.text.dynamicLayoutVertexBuffer.updateData(X)}function Hb(y,l,h){return h.iconsInText&&l?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function Ad(y,l,h,g,v,w,A,L,$,O,V,W){const X=y.context,ae=X.gl,se=y.transform,oe=L==="map",_e=$==="map",Te=L!=="viewport"&&h.layout.get("symbol-placement")!=="point",Le=oe&&!_e&&!Te,ue=!h.layout.get("symbol-sort-key").isConstant();let Fe=!1;const ke=y.depthModeForSublayer(0,wn.ReadOnly),He=h.layout.get("text-variable-anchor"),We=[];for(const et of g){const Ge=l.getTile(et),wt=Ge.getBucket(h);if(!wt)continue;const ft=v?wt.text:wt.icon;if(!ft||!ft.segments.get().length)continue;const Tt=ft.programConfigurations.get(h.id),tn=v||wt.sdfIcons,dn=v?wt.textSizeData:wt.iconSizeData,Gt=_e||se.pitch!==0,Un=y.useProgram(Hb(tn,v,wt),Tt),Vn=o.evaluateSizeForZoom(dn,se.zoom),Cn=y.style.terrain&&y.style.terrain.getTerrainData(et);let In,Wn,hi,Io,eo=[0,0],Lo=null;if(v){if(Wn=Ge.glyphAtlasTexture,hi=ae.LINEAR,In=Ge.glyphAtlasTexture.size,wt.iconsInText){eo=Ge.imageAtlasTexture.size,Lo=Ge.imageAtlasTexture;const Ds=dn.kind==="composite"||dn.kind==="camera";Io=Gt||y.options.rotating||y.options.zooming||Ds?ae.LINEAR:ae.NEAREST}}else{const Ds=h.layout.get("icon-size").constantOr(0)!==1||wt.iconsNeedLinear;Wn=Ge.imageAtlasTexture,hi=tn||y.options.rotating||y.options.zooming||Ds||Gt?ae.LINEAR:ae.NEAREST,In=Ge.imageAtlasTexture.size}const Sa=An(Ge,1,y.transform.zoom),Os=Ms(et.posMatrix,_e,oe,y.transform,Sa),ns=di(et.posMatrix,_e,oe,y.transform,Sa),Xo=He&&wt.hasTextData(),kd=h.layout.get("icon-text-fit")!=="none"&&Xo&&wt.hasIconData();if(Te){const Ds=y.style.terrain?(np,tc)=>y.style.terrain.getElevation(et,np,tc):null,Qa=h.layout.get("text-rotation-alignment")==="map";Me(wt,et.posMatrix,y,v,Os,ns,_e,O,Qa,Ds)}const si=y.translatePosMatrix(et.posMatrix,Ge,w,A),yn=Te||v&&He||kd?Gb:Os,Bn=y.translatePosMatrix(ns,Ge,w,A,!0),fi=tn&&h.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let pi;pi=tn?wt.iconsInText?Bg(dn.kind,Vn,Le,_e,y,si,yn,Bn,In,eo):vd(dn.kind,Vn,Le,_e,y,si,yn,Bn,v,In,!0):If(dn.kind,Vn,Le,_e,y,si,yn,Bn,v,In);const fr={program:Un,buffers:ft,uniformValues:pi,atlasTexture:Wn,atlasTextureIcon:Lo,atlasInterpolation:hi,atlasInterpolationIcon:Io,isSDF:tn,hasHalo:fi};if(ue&&wt.canOverlap){Fe=!0;const Ds=ft.segments.get();for(const Qa of Ds)We.push({segments:new o.SegmentVector([Qa]),sortKey:Qa.sortKey,state:fr,terrainData:Cn})}else We.push({segments:ft.segments,sortKey:0,state:fr,terrainData:Cn})}Fe&&We.sort((et,Ge)=>et.sortKey-Ge.sortKey);for(const et of We){const Ge=et.state;if(X.activeTexture.set(ae.TEXTURE0),Ge.atlasTexture.bind(Ge.atlasInterpolation,ae.CLAMP_TO_EDGE),Ge.atlasTextureIcon&&(X.activeTexture.set(ae.TEXTURE1),Ge.atlasTextureIcon&&Ge.atlasTextureIcon.bind(Ge.atlasInterpolationIcon,ae.CLAMP_TO_EDGE)),Ge.isSDF){const wt=Ge.uniformValues;Ge.hasHalo&&(wt.u_is_halo=1,tu(Ge.buffers,et.segments,h,y,Ge.program,ke,V,W,wt,et.terrainData)),wt.u_is_halo=0}tu(Ge.buffers,et.segments,h,y,Ge.program,ke,V,W,Ge.uniformValues,et.terrainData)}}function tu(y,l,h,g,v,w,A,L,$,O){const V=g.context;v.draw(V,V.gl.TRIANGLES,w,A,L,dr.disabled,$,O,h.id,y.layoutVertexBuffer,y.indexBuffer,l,h.paint,g.transform.zoom,y.programConfigurations.get(h.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function nu(y,l,h,g,v,w,A){const L=y.context.gl,$=h.paint.get("fill-pattern"),O=$&&$.constantOr(1),V=h.getCrossfadeParameters();let W,X,ae,se,oe;A?(X=O&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=L.LINES):(X=O?"fillPattern":"fill",W=L.TRIANGLES);for(const _e of g){const Te=l.getTile(_e);if(O&&!Te.patternsLoaded())continue;const Le=Te.getBucket(h);if(!Le)continue;const ue=Le.programConfigurations.get(h.id),Fe=y.useProgram(X,ue),ke=y.style.terrain&&y.style.terrain.getTerrainData(_e);O&&(y.context.activeTexture.set(L.TEXTURE0),Te.imageAtlasTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),ue.updatePaintBuffers(V));const He=$.constantOr(null);if(He&&Te.imageAtlas){const Ge=Te.imageAtlas,wt=Ge.patternPositions[He.to.toString()],ft=Ge.patternPositions[He.from.toString()];wt&&ft&&ue.setConstantPatternPositions(wt,ft)}const We=ke?_e:null,et=y.translatePosMatrix(We?We.posMatrix:_e.posMatrix,Te,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(A){se=Le.indexBuffer2,oe=Le.segments2;const Ge=[L.drawingBufferWidth,L.drawingBufferHeight];ae=X==="fillOutlinePattern"&&O?Yc(et,y,V,Te,Ge):Hl(et,Ge)}else se=Le.indexBuffer,oe=Le.segments,ae=O?jl(et,y,V,Te):Gl(et);Fe.draw(y.context,W,v,y.stencilModeForClipping(_e),w,dr.disabled,ae,ke,h.id,Le.layoutVertexBuffer,se,oe,h.paint,y.transform.zoom,ue)}}function ru(y,l,h,g,v,w,A){const L=y.context,$=L.gl,O=h.paint.get("fill-extrusion-pattern"),V=O.constantOr(1),W=h.getCrossfadeParameters(),X=h.paint.get("fill-extrusion-opacity");for(const ae of g){const se=l.getTile(ae),oe=se.getBucket(h);if(!oe)continue;const _e=y.style.terrain&&y.style.terrain.getTerrainData(ae),Te=oe.programConfigurations.get(h.id),Le=y.useProgram(V?"fillExtrusionPattern":"fillExtrusion",Te);V&&(y.context.activeTexture.set($.TEXTURE0),se.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Te.updatePaintBuffers(W));const ue=O.constantOr(null);if(ue&&se.imageAtlas){const We=se.imageAtlas,et=We.patternPositions[ue.to.toString()],Ge=We.patternPositions[ue.from.toString()];et&&Ge&&Te.setConstantPatternPositions(et,Ge)}const Fe=y.translatePosMatrix(ae.posMatrix,se,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),ke=h.paint.get("fill-extrusion-vertical-gradient"),He=V?Js(Fe,y,ke,X,ae,W,se):_a(Fe,y,ke,X);Le.draw(L,L.gl.TRIANGLES,v,w,A,dr.backCCW,He,_e,h.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,h.paint,y.transform.zoom,Te,y.style.terrain&&oe.centroidVertexBuffer)}}function Vf(y,l,h,g,v,w,A){const L=y.context,$=L.gl,O=h.fbo;if(!O)return;const V=y.useProgram("hillshade"),W=y.style.terrain&&y.style.terrain.getTerrainData(l);L.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,O.colorAttachment.get()),V.draw(L,$.TRIANGLES,v,w,A,dr.disabled,((X,ae,se,oe)=>{const _e=se.paint.get("hillshade-shadow-color"),Te=se.paint.get("hillshade-highlight-color"),Le=se.paint.get("hillshade-accent-color");let ue=se.paint.get("hillshade-illumination-direction")*(Math.PI/180);se.paint.get("hillshade-illumination-anchor")==="viewport"&&(ue-=X.transform.angle);const Fe=!X.options.moving;return{u_matrix:oe?oe.posMatrix:X.transform.calculatePosMatrix(ae.tileID.toUnwrapped(),Fe),u_image:0,u_latrange:Ne(0,ae.tileID),u_light:[se.paint.get("hillshade-exaggeration"),ue],u_shadow:_e,u_highlight:Te,u_accent:Le}})(y,h,g,W?l:null),W,g.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function Zg(y,l,h,g,v,w){const A=y.context,L=A.gl,$=l.dem;if($&&$.data){const O=$.dim,V=$.stride,W=$.getPixels();if(A.activeTexture.set(L.TEXTURE1),A.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||y.getTileTexture(V),l.demTexture){const ae=l.demTexture;ae.update(W,{premultiply:!1}),ae.bind(L.NEAREST,L.CLAMP_TO_EDGE)}else l.demTexture=new D(A,W,L.RGBA,{premultiply:!1}),l.demTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE);A.activeTexture.set(L.TEXTURE0);let X=l.fbo;if(!X){const ae=new D(A,{width:O,height:O,data:null},L.RGBA);ae.bind(L.LINEAR,L.CLAMP_TO_EDGE),X=l.fbo=A.createFramebuffer(O,O,!0),X.colorAttachment.set(ae.texture)}A.bindFramebuffer.set(X.framebuffer),A.viewport.set([0,0,O,O]),y.useProgram("hillshadePrepare").draw(A,L.TRIANGLES,g,v,w,dr.disabled,((ae,se)=>{const oe=se.stride,_e=o.create();return o.ortho(_e,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(_e,_e,[0,-o.EXTENT,0]),{u_matrix:_e,u_image:1,u_dimension:[oe,oe],u_zoom:ae.overscaledZ,u_unpack:se.getUnpackVector()}})(l.tileID,$),null,h.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),l.needsHillshadePrepare=!1}}function Pd(y,l,h,g,v,w){const A=g.paint.get("raster-fade-duration");if(!w&&A>0){const L=o.exported.now(),$=(L-y.timeAdded)/A,O=l?(L-l.timeAdded)/A:-1,V=h.getSource(),W=v.coveringZoomLevel({tileSize:V.tileSize,roundZoom:V.roundZoom}),X=!l||Math.abs(l.tileID.overscaledZ-W)>Math.abs(y.tileID.overscaledZ-W),ae=X&&y.refreshedUponExpiration?1:o.clamp(X?$:1-O,0,1);return y.refreshedUponExpiration&&$>=1&&(y.refreshedUponExpiration=!1),l?{opacity:1,mix:1-ae}:{opacity:ae,mix:0}}return{opacity:1,mix:0}}const Cd=new o.Color(1,0,0,1),Qs=new o.Color(0,1,0,1),Yg=new o.Color(0,0,1,1),Gf=new o.Color(1,0,1,1),Jg=new o.Color(0,1,1,1);function Za(y,l,h,g){Zl(y,0,l+h/2,y.transform.width,h,g)}function iu(y,l,h,g){Zl(y,l-h/2,0,h,y.transform.height,g)}function Zl(y,l,h,g,v,w){const A=y.context,L=A.gl;L.enable(L.SCISSOR_TEST),L.scissor(l*y.pixelRatio,h*y.pixelRatio,g*y.pixelRatio,v*y.pixelRatio),A.clear({color:w}),L.disable(L.SCISSOR_TEST)}function Wb(y,l,h){const g=y.context,v=g.gl,w=h.posMatrix,A=y.useProgram("debug"),L=wn.disabled,$=ir.disabled,O=y.colorModeForRenderPass(),V="$debug",W=y.style.terrain&&y.style.terrain.getTerrainData(h);g.activeTexture.set(v.TEXTURE0),y.emptyTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE);const X=l.getTileByID(h.key).latestRawTileData,ae=Math.floor((X&&X.byteLength||0)/1024),se=l.getTile(h).tileSize,oe=512/Math.min(se,512)*(h.overscaledZ/y.transform.zoom)*.5;let _e=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(_e+=` => ${h.overscaledZ}`),function(Te,Le){Te.initDebugOverlayCanvas();const ue=Te.debugOverlayCanvas,Fe=Te.context.gl,ke=Te.debugOverlayCanvas.getContext("2d");ke.clearRect(0,0,ue.width,ue.height),ke.shadowColor="white",ke.shadowBlur=2,ke.lineWidth=1.5,ke.strokeStyle="white",ke.textBaseline="top",ke.font="bold 36px Open Sans, sans-serif",ke.fillText(Le,5,5),ke.strokeText(Le,5,5),Te.debugOverlayTexture.update(ue),Te.debugOverlayTexture.bind(Fe.LINEAR,Fe.CLAMP_TO_EDGE)}(y,`${_e} ${ae}kB`),A.draw(g,v.TRIANGLES,L,$,or.alphaBlended,dr.disabled,Z(w,o.Color.transparent,oe),null,V,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),A.draw(g,v.LINE_STRIP,L,$,O,dr.disabled,Z(w,o.Color.red),W,V,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function Id(y,l,h){const g=y.context,v=g.gl,w=y.colorModeForRenderPass(),A=new wn(v.LEQUAL,wn.ReadWrite,y.depthRangeFor3D),L=y.useProgram("terrain"),$=l.getTerrainMesh(),O=l.getTerrainData(h.tileID);g.bindFramebuffer.set(null),g.viewport.set([0,0,y.width,y.height]),g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,l.getRTTFramebuffer().colorAttachment.get());const V=y.transform.calculatePosMatrix(h.tileID.toUnwrapped());L.draw(g,v.TRIANGLES,A,ir.disabled,w,dr.backCCW,{u_matrix:V,u_texture:0},O,"terrain",$.vertexBuffer,$.indexBuffer,$.segments)}function Qg(y,l,h,g){const v=y.context,w=h.tileSize*l.qualityFactor;h.textures[g]||(h.textures[g]=y.getTileTexture(w)||new D(v,{width:w,height:w,data:null},v.gl.RGBA),h.textures[g].bind(v.gl.LINEAR,v.gl.CLAMP_TO_EDGE),g===0&&l.sourceCache.renderHistory.unshift(h.tileID.key));const A=l.getRTTFramebuffer();A.colorAttachment.set(h.textures[g].texture),v.bindFramebuffer.set(A.framebuffer),v.viewport.set([0,0,w,w])}class ey{constructor(l){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=l,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=l.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const l=this.painter.style,h=l.terrain;for(const g in l.sourceCaches){this._coordsDescendingInv[g]={};const v=l.sourceCaches[g].getVisibleCoordinates();for(const w of v){const A=h.sourceCache.getTerrainCoords(w);for(const L in A)this._coordsDescendingInv[g][L]||(this._coordsDescendingInv[g][L]=[]),this._coordsDescendingInv[g][L].push(A[L])}}for(const g of l._order){const v=l._layers[g],w=v.source;if(this._renderToTexture[v.type]&&!this._coordsDescendingInvStr[w]){this._coordsDescendingInvStr[w]={};for(const A in this._coordsDescendingInv[w])this._coordsDescendingInvStr[w][A]=this._coordsDescendingInv[w][A].map(L=>L.key).sort().join()}}return this._renderableTiles.forEach(g=>{for(const v in this._coordsDescendingInvStr){const w=this._coordsDescendingInvStr[v][g.tileID.key];w&&w!==g.textureCoords[v]&&g.clearTextures(this.painter),h.needsRerender(v,g.tileID)&&g.clearTextures(this.painter)}this._rerender[g.tileID.key]=!g.textures.length}),h.clearRerenderCache(),h.sourceCache.removeOutdated(this.painter),this}renderLayer(l){const h=l.type,g=this.painter,v=g.style._order,w=g.currentLayer,A=w+1===v.length;if(this._renderToTexture[h]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=h,this._stacks[this._stacks.length-1].push(v[w]),!A))return!0;if(this._renderToTexture[this._prevType]||h==="hillshade"||this._renderToTexture[h]&&A){this._prevType=h;const L=this._stacks.length-1,$=this._stacks[L]||[];for(const O of this._renderableTiles){if(Qg(g,g.style.terrain,O,L),this._rerender[O.tileID.key]){g.context.clear({color:o.Color.transparent});for(let V=0;V<$.length;V++){const W=g.style._layers[$[V]],X=W.source?this._coordsDescendingInv[W.source][O.tileID.key]:[O.tileID];g._renderTileClippingMasks(W,X),g.renderLayer(g,g.style.sourceCaches[W.source],W,X),W.source&&(O.textureCoords[W.source]=this._coordsDescendingInvStr[W.source][O.tileID.key])}}Id(g,g.style.terrain,O)}if(h==="hillshade"){this._stacks.push([v[w]]);for(const O of this._renderableTiles){const V=this._coordsDescendingInv[l.source][O.tileID.key];Qg(g,g.style.terrain,O,this._stacks.length-1),g.context.clear({color:o.Color.transparent}),g._renderTileClippingMasks(l,V),g.renderLayer(g,g.style.sourceCaches[l.source],l,V),Id(g,g.style.terrain,O)}return!0}return this._renderToTexture[h]}return!1}}const su={symbol:function(y,l,h,g,v){if(y.renderPass!=="translucent")return;const w=ir.disabled,A=y.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(L,$,O,V,W,X,ae){const se=$.transform,oe=W==="map",_e=X==="map";for(const Te of L){const Le=V.getTile(Te),ue=Le.getBucket(O);if(!ue||!ue.text||!ue.text.segments.get().length)continue;const Fe=o.evaluateSizeForZoom(ue.textSizeData,se.zoom),ke=An(Le,1,$.transform.zoom),He=Ms(Te.posMatrix,_e,oe,$.transform,ke),We=O.layout.get("icon-text-fit")!=="none"&&ue.hasIconData();if(Fe){const et=Math.pow(2,se.zoom-Le.tileID.overscaledZ);Xg(ue,oe,_e,ae,se,He,Te.posMatrix,et,Fe,We,$.style.terrain?(Ge,wt)=>$.style.terrain.getElevation(Te,Ge,wt):null)}}}(g,y,h,l,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),v),h.paint.get("icon-opacity").constantOr(1)!==0&&Ad(y,l,h,g,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),w,A),h.paint.get("text-opacity").constantOr(1)!==0&&Ad(y,l,h,g,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),w,A),l.map.showCollisionBoxes&&(Xl(y,l,h,g,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Xl(y,l,h,g,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(y,l,h,g){if(y.renderPass!=="translucent")return;const v=h.paint.get("circle-opacity"),w=h.paint.get("circle-stroke-width"),A=h.paint.get("circle-stroke-opacity"),L=!h.layout.get("circle-sort-key").isConstant();if(v.constantOr(1)===0&&(w.constantOr(1)===0||A.constantOr(1)===0))return;const $=y.context,O=$.gl,V=y.depthModeForSublayer(0,wn.ReadOnly),W=ir.disabled,X=y.colorModeForRenderPass(),ae=[];for(let se=0;se<g.length;se++){const oe=g[se],_e=l.getTile(oe),Te=_e.getBucket(h);if(!Te)continue;const Le=Te.programConfigurations.get(h.id),ue=y.useProgram("circle",Le),Fe=Te.layoutVertexBuffer,ke=Te.indexBuffer,He=y.style.terrain&&y.style.terrain.getTerrainData(oe),We={programConfiguration:Le,program:ue,layoutVertexBuffer:Fe,indexBuffer:ke,uniformValues:_d(y,oe,_e,h),terrainData:He};if(L){const et=Te.segments.get();for(const Ge of et)ae.push({segments:new o.SegmentVector([Ge]),sortKey:Ge.sortKey,state:We})}else ae.push({segments:Te.segments,sortKey:0,state:We})}L&&ae.sort((se,oe)=>se.sortKey-oe.sortKey);for(const se of ae){const{programConfiguration:oe,program:_e,layoutVertexBuffer:Te,indexBuffer:Le,uniformValues:ue,terrainData:Fe}=se.state;_e.draw($,O.TRIANGLES,V,W,X,dr.disabled,ue,Fe,h.id,Te,Le,se.segments,h.paint,y.transform.zoom,oe)}},heatmap:function(y,l,h,g){if(h.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const v=y.context,w=v.gl,A=ir.disabled,L=new or([w.ONE,w.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function($,O,V){const W=$.gl;$.activeTexture.set(W.TEXTURE1),$.viewport.set([0,0,O.width/4,O.height/4]);let X=V.heatmapFbo;if(X)W.bindTexture(W.TEXTURE_2D,X.colorAttachment.get()),$.bindFramebuffer.set(X.framebuffer);else{const ae=W.createTexture();W.bindTexture(W.TEXTURE_2D,ae),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.LINEAR),X=V.heatmapFbo=$.createFramebuffer(O.width/4,O.height/4,!1),function(se,oe,_e,Te){const Le=se.gl;Le.texImage2D(Le.TEXTURE_2D,0,Le.RGBA,oe.width/4,oe.height/4,0,Le.RGBA,se.extRenderToTextureHalfFloat?se.extTextureHalfFloat.HALF_FLOAT_OES:Le.UNSIGNED_BYTE,null),Te.colorAttachment.set(_e)}($,O,ae,X)}})(v,y,h),v.clear({color:o.Color.transparent});for(let $=0;$<g.length;$++){const O=g[$];if(l.hasRenderableParent(O))continue;const V=l.getTile(O),W=V.getBucket(h);if(!W)continue;const X=W.programConfigurations.get(h.id),ae=y.useProgram("heatmap",X),{zoom:se}=y.transform;ae.draw(v,w.TRIANGLES,wn.disabled,A,L,dr.disabled,ge(O.posMatrix,V,se,h.paint.get("heatmap-intensity")),null,h.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,h.paint,y.transform.zoom,X)}v.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(v,w){const A=v.context,L=A.gl,$=w.heatmapFbo;if(!$)return;A.activeTexture.set(L.TEXTURE0),L.bindTexture(L.TEXTURE_2D,$.colorAttachment.get()),A.activeTexture.set(L.TEXTURE1);let O=w.colorRampTexture;O||(O=w.colorRampTexture=new D(A,w.colorRamp,L.RGBA)),O.bind(L.LINEAR,L.CLAMP_TO_EDGE),v.useProgram("heatmapTexture").draw(A,L.TRIANGLES,wn.disabled,ir.disabled,v.colorModeForRenderPass(),dr.disabled,((V,W,X,ae)=>{const se=o.create();o.ortho(se,0,V.width,V.height,0,0,1);const oe=V.context.gl;return{u_matrix:se,u_world:[oe.drawingBufferWidth,oe.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:W.paint.get("heatmap-opacity")}})(v,w),null,w.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,w.paint,v.transform.zoom)}(y,h))},line:function(y,l,h,g){if(y.renderPass!=="translucent")return;const v=h.paint.get("line-opacity"),w=h.paint.get("line-width");if(v.constantOr(1)===0||w.constantOr(1)===0)return;const A=y.depthModeForSublayer(0,wn.ReadOnly),L=y.colorModeForRenderPass(),$=h.paint.get("line-dasharray"),O=h.paint.get("line-pattern"),V=O.constantOr(1),W=h.paint.get("line-gradient"),X=h.getCrossfadeParameters(),ae=V?"linePattern":$?"lineSDF":W?"lineGradient":"line",se=y.context,oe=se.gl;let _e=!0;for(const Te of g){const Le=l.getTile(Te);if(V&&!Le.patternsLoaded())continue;const ue=Le.getBucket(h);if(!ue)continue;const Fe=ue.programConfigurations.get(h.id),ke=y.context.program.get(),He=y.useProgram(ae,Fe),We=_e||He.program!==ke,et=y.style.terrain&&y.style.terrain.getTerrainData(Te),Ge=O.constantOr(null);if(Ge&&Le.imageAtlas){const Tt=Le.imageAtlas,tn=Tt.patternPositions[Ge.to.toString()],dn=Tt.patternPositions[Ge.from.toString()];tn&&dn&&Fe.setConstantPatternPositions(tn,dn)}const wt=et?Te:null,ft=V?pn(y,Le,h,X,wt):$?yr(y,Le,h,$,X,wt):W?Lt(y,Le,h,ue.lineClipsArray.length,wt):nt(y,Le,h,wt);if(V)se.activeTexture.set(oe.TEXTURE0),Le.imageAtlasTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),Fe.updatePaintBuffers(X);else if($&&(We||y.lineAtlas.dirty))se.activeTexture.set(oe.TEXTURE0),y.lineAtlas.bind(se);else if(W){const Tt=ue.gradients[h.id];let tn=Tt.texture;if(h.gradientVersion!==Tt.version){let dn=256;if(h.stepInterpolant){const Gt=l.getSource().maxzoom,Un=Te.canonical.z===Gt?Math.ceil(1<<y.transform.maxZoom-Te.canonical.z):1;dn=o.clamp(o.nextPowerOfTwo(ue.maxLineLength/o.EXTENT*1024*Un),256,se.maxTextureSize)}Tt.gradient=o.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:dn,image:Tt.gradient||void 0,clips:ue.lineClipsArray}),Tt.texture?Tt.texture.update(Tt.gradient):Tt.texture=new D(se,Tt.gradient,oe.RGBA),Tt.version=h.gradientVersion,tn=Tt.texture}se.activeTexture.set(oe.TEXTURE0),tn.bind(h.stepInterpolant?oe.NEAREST:oe.LINEAR,oe.CLAMP_TO_EDGE)}He.draw(se,oe.TRIANGLES,A,y.stencilModeForClipping(Te),L,dr.disabled,ft,et,h.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,h.paint,y.transform.zoom,Fe,ue.layoutVertexBuffer2),_e=!1}},fill:function(y,l,h,g){const v=h.paint.get("fill-color"),w=h.paint.get("fill-opacity");if(w.constantOr(1)===0)return;const A=y.colorModeForRenderPass(),L=h.paint.get("fill-pattern"),$=y.opaquePassEnabledForLayer()&&!L.constantOr(1)&&v.constantOr(o.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===$){const O=y.depthModeForSublayer(1,y.renderPass==="opaque"?wn.ReadWrite:wn.ReadOnly);nu(y,l,h,g,O,A,!1)}if(y.renderPass==="translucent"&&h.paint.get("fill-antialias")){const O=y.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,wn.ReadOnly);nu(y,l,h,g,O,A,!0)}},"fill-extrusion":function(y,l,h,g){const v=h.paint.get("fill-extrusion-opacity");if(v!==0&&y.renderPass==="translucent"){const w=new wn(y.context.gl.LEQUAL,wn.ReadWrite,y.depthRangeFor3D);if(v!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))ru(y,l,h,g,w,ir.disabled,or.disabled),ru(y,l,h,g,w,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const A=y.colorModeForRenderPass();ru(y,l,h,g,w,ir.disabled,A)}}},hillshade:function(y,l,h,g){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const v=y.context,w=y.depthModeForSublayer(0,wn.ReadOnly),A=y.colorModeForRenderPass(),[L,$]=y.renderPass==="translucent"?y.stencilConfigForOverlap(g):[{},g];for(const O of $){const V=l.getTile(O);V.needsHillshadePrepare!==void 0&&V.needsHillshadePrepare&&y.renderPass==="offscreen"?Zg(y,V,h,w,ir.disabled,A):y.renderPass==="translucent"&&Vf(y,O,V,h,w,L[O.overscaledZ],A)}v.viewport.set([0,0,y.width,y.height])},raster:function(y,l,h,g){if(y.renderPass!=="translucent"||h.paint.get("raster-opacity")===0||!g.length)return;const v=y.context,w=v.gl,A=l.getSource(),L=y.useProgram("raster"),$=y.colorModeForRenderPass(),[O,V]=A instanceof It?[{},g]:y.stencilConfigForOverlap(g),W=V[V.length-1].overscaledZ,X=!y.options.moving;for(const ae of V){const se=y.depthModeForSublayer(ae.overscaledZ-W,h.paint.get("raster-opacity")===1?wn.ReadWrite:wn.ReadOnly,w.LESS),oe=l.getTile(ae);oe.registerFadeDuration(h.paint.get("raster-fade-duration"));const _e=l.findLoadedParent(ae,0),Te=Pd(oe,_e,l,h,y.transform,y.style.terrain);let Le,ue;const Fe=h.paint.get("raster-resampling")==="nearest"?w.NEAREST:w.LINEAR;v.activeTexture.set(w.TEXTURE0),oe.texture.bind(Fe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),v.activeTexture.set(w.TEXTURE1),_e?(_e.texture.bind(Fe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST),Le=Math.pow(2,_e.tileID.overscaledZ-oe.tileID.overscaledZ),ue=[oe.tileID.canonical.x*Le%1,oe.tileID.canonical.y*Le%1]):oe.texture.bind(Fe,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);const ke=y.style.terrain&&y.style.terrain.getTerrainData(ae),He=ke?ae:null,We=He?He.posMatrix:y.transform.calculatePosMatrix(ae.toUnwrapped(),X),et=gs(We,ue||[0,0],Le||1,Te,h);A instanceof It?L.draw(v,w.TRIANGLES,se,ir.disabled,$,dr.disabled,et,ke,h.id,A.boundsBuffer,y.quadTriangleIndexBuffer,A.boundsSegments):L.draw(v,w.TRIANGLES,se,O[ae.overscaledZ],$,dr.disabled,et,ke,h.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}},background:function(y,l,h,g){const v=h.paint.get("background-color"),w=h.paint.get("background-opacity");if(w===0)return;const A=y.context,L=A.gl,$=y.transform,O=$.tileSize,V=h.paint.get("background-pattern");if(y.isPatternMissing(V))return;const W=!V&&v.a===1&&w===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==W)return;const X=ir.disabled,ae=y.depthModeForSublayer(0,W==="opaque"?wn.ReadWrite:wn.ReadOnly),se=y.colorModeForRenderPass(),oe=y.useProgram(V?"backgroundPattern":"background"),_e=g||$.coveringTiles({tileSize:O,terrain:y.style.terrain});V&&(A.activeTexture.set(L.TEXTURE0),y.imageManager.bind(y.context));const Te=h.getCrossfadeParameters();for(const Le of _e){const ue=g?Le.posMatrix:y.transform.calculatePosMatrix(Le.toUnwrapped()),Fe=V?Ob(ue,w,y,V,{tileID:Le,tileSize:O},Te):kb(ue,w,v),ke=y.style.terrain&&y.style.terrain.getTerrainData(Le);oe.draw(A,L.TRIANGLES,ae,X,se,dr.disabled,Fe,ke,h.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}},debug:function(y,l,h){for(let g=0;g<h.length;g++)Wb(y,l,h[g])},custom:function(y,l,h){const g=y.context,v=h.implementation;if(y.renderPass==="offscreen"){const w=v.prerender;w&&(y.setCustomLayerDefaults(),g.setColorMode(y.colorModeForRenderPass()),w.call(v,g.gl,y.transform.customLayerMatrix()),g.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),g.setColorMode(y.colorModeForRenderPass()),g.setStencilMode(ir.disabled);const w=v.renderingMode==="3d"?new wn(y.context.gl.LEQUAL,wn.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,wn.ReadOnly);g.setDepthMode(w),v.render(g.gl,y.transform.customLayerMatrix()),g.setDirty(),y.setBaseState(),g.bindFramebuffer.set(null)}}};class jf{constructor(l,h){this.context=new qg(l),this.transform=h,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.create(),renderTime:0},this.setup(),this.numSublayers=lt.maxUnderzooming+lt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new zt,this.gpuTimers={}}resize(l,h,g){if(this.width=l*g,this.height=h*g,this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const v of this.style._order)this.style._layers[v].resize()}setup(){const l=this.context,h=new o.PosArray;h.emplaceBack(0,0),h.emplaceBack(o.EXTENT,0),h.emplaceBack(0,o.EXTENT),h.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(h,cn.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const g=new o.PosArray;g.emplaceBack(0,0),g.emplaceBack(o.EXTENT,0),g.emplaceBack(0,o.EXTENT),g.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=l.createVertexBuffer(g,cn.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const v=new o.RasterBoundsArray;v.emplaceBack(0,0,0,0),v.emplaceBack(o.EXTENT,0,o.EXTENT,0),v.emplaceBack(0,o.EXTENT,0,o.EXTENT),v.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=l.createVertexBuffer(v,ot.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const w=new o.PosArray;w.emplaceBack(0,0),w.emplaceBack(1,0),w.emplaceBack(0,1),w.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(w,cn.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const A=new o.LineStripIndexArray;A.emplaceBack(0),A.emplaceBack(1),A.emplaceBack(3),A.emplaceBack(2),A.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(A);const L=new o.TriangleIndexArray;L.emplaceBack(0,1,2),L.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(L),this.emptyTexture=new D(l,{width:1,height:1,data:new Uint8Array([0,0,0,0])},l.gl.RGBA);const $=this.context.gl;this.stencilClearMode=new ir({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO)}clearStencil(){const l=this.context,h=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=o.create();o.ortho(g,0,this.width,this.height,0,0,1),o.scale(g,g,[h.drawingBufferWidth,h.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,h.TRIANGLES,wn.disabled,this.stencilClearMode,or.disabled,dr.disabled,ne(g),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,h){if(this.currentStencilSource===l.source||!l.isTileClipped()||!h||!h.length)return;this.currentStencilSource=l.source;const g=this.context,v=g.gl;this.nextStencilID+h.length>256&&this.clearStencil(),g.setColorMode(or.disabled),g.setDepthMode(wn.disabled);const w=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const A of h){const L=this._tileClippingMaskIDs[A.key]=this.nextStencilID++,$=this.style.terrain&&this.style.terrain.getTerrainData(A);w.draw(g,v.TRIANGLES,wn.disabled,new ir({func:v.ALWAYS,mask:0},L,255,v.KEEP,v.KEEP,v.REPLACE),or.disabled,dr.disabled,ne(A.posMatrix),$,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,h=this.context.gl;return new ir({func:h.NOTEQUAL,mask:255},l,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(l){const h=this.context.gl;return new ir({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(l){const h=this.context.gl,g=l.sort((A,L)=>L.overscaledZ-A.overscaledZ),v=g[g.length-1].overscaledZ,w=g[0].overscaledZ-v+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const A={};for(let L=0;L<w;L++)A[L+v]=new ir({func:h.GEQUAL,mask:255},L+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=w,[A,g]}return[{[v]:ir.disabled},g]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new or([l.CONSTANT_COLOR,l.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?or.unblended:or.alphaBlended}depthModeForSublayer(l,h,g){if(!this.opaquePassEnabledForLayer())return wn.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new wn(g||this.context.gl.LEQUAL,h,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,h){this.style=l,this.options=h,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const g=this.style._order,v=this.style.sourceCaches,w=this.style.terrain&&new ey(this);for(const O in v){const V=v[O];V.used&&V.prepare(this.context)}const A={},L={},$={};for(const O in v){const V=v[O];A[O]=V.getVisibleCoordinates(),L[O]=A[O].slice().reverse(),$[O]=V.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let O=0;O<g.length;O++)if(this.style._layers[g[O]].is3D()){this.opaquePassCutoff=O;break}if(w){this.opaquePassCutoff=0;const O=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!o.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||O.length)&&(o.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(V,W){const X=V.context,ae=X.gl,se=or.unblended,oe=new wn(ae.LEQUAL,wn.ReadWrite,[0,1]),_e=W.getTerrainMesh(),Te=W.sourceCache.getRenderableTiles(),Le=V.useProgram("terrainDepth");X.bindFramebuffer.set(W.getFramebuffer("depth").framebuffer),X.viewport.set([0,0,V.width/devicePixelRatio,V.height/devicePixelRatio]),X.clear({color:o.Color.transparent,depth:1});for(const ue of Te){const Fe=W.getTerrainData(ue.tileID),ke=V.transform.calculatePosMatrix(ue.tileID.toUnwrapped());Le.draw(X,ae.TRIANGLES,oe,ir.disabled,se,dr.backCCW,{u_matrix:ke},Fe,"terrain",_e.vertexBuffer,_e.indexBuffer,_e.segments)}X.bindFramebuffer.set(null),X.viewport.set([0,0,V.width,V.height])}(this,this.style.terrain),function(V,W){const X=V.context,ae=X.gl,se=or.unblended,oe=new wn(ae.LEQUAL,wn.ReadWrite,[0,1]),_e=W.getTerrainMesh(),Te=W.getCoordsTexture(),Le=W.sourceCache.getRenderableTiles(),ue=V.useProgram("terrainCoords");X.bindFramebuffer.set(W.getFramebuffer("coords").framebuffer),X.viewport.set([0,0,V.width/devicePixelRatio,V.height/devicePixelRatio]),X.clear({color:o.Color.transparent,depth:1}),W.coordsIndex=[];for(const Fe of Le){const ke=W.getTerrainData(Fe.tileID);X.activeTexture.set(ae.TEXTURE0),ae.bindTexture(ae.TEXTURE_2D,Te.texture);const He=V.transform.calculatePosMatrix(Fe.tileID.toUnwrapped());ue.draw(X,ae.TRIANGLES,oe,ir.disabled,se,dr.backCCW,{u_matrix:He,u_terrain_coords_id:(255-W.coordsIndex.length)/255,u_texture:0},ke,"terrain",_e.vertexBuffer,_e.indexBuffer,_e.segments),W.coordsIndex.push(Fe.tileID.key)}X.bindFramebuffer.set(null),X.viewport.set([0,0,V.width,V.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const O of g){const V=this.style._layers[O];if(!V.hasOffscreenPass()||V.isHidden(this.transform.zoom))continue;const W=L[V.source];(V.type==="custom"||W.length)&&this.renderLayer(this,v[V.source],V,W)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:h.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!w)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const O=this.style._layers[g[this.currentLayer]],V=v[O.source],W=A[O.source];this._renderTileClippingMasks(O,W),this.renderLayer(this,V,O,W)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const O=this.style._layers[g[this.currentLayer]],V=v[O.source];if(w&&w.renderLayer(O))continue;const W=(O.type==="symbol"?$:L)[O.source];this._renderTileClippingMasks(O,A[O.source]),this.renderLayer(this,V,O,W)}if(this.options.showTileBoundaries){let O,V;Object.values(this.style._layers).forEach(W=>{W.source&&!W.isHidden(this.transform.zoom)&&(W.source!==(V&&V.id)&&(V=this.style.sourceCaches[W.source]),(!O||O.getSource().maxzoom<V.getSource().maxzoom)&&(O=V))}),O&&su.debug(this,O,O.getVisibleCoordinates())}this.options.showPadding&&function(O){const V=O.transform.padding;Za(O,O.transform.height-(V.top||0),3,Cd),Za(O,V.bottom||0,3,Qs),iu(O,V.left||0,3,Yg),iu(O,O.transform.width-(V.right||0),3,Gf);const W=O.transform.centerPoint;(function(X,ae,se,oe){Zl(X,ae-1,se-10,2,20,oe),Zl(X,ae-10,se-1,20,2,oe)})(O,W.x,O.transform.height-W.y,Jg)}(this),this.context.setDefault()}renderLayer(l,h,g,v){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="custom"||(v||[]).length)&&(this.id=g.id,this.gpuTimingStart(g),su[g.type](l,h,g,v,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let g=this.gpuTimers[l.id];g||(g=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),g.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,g.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}queryGpuTimers(l){const h={};for(const g in l){const v=l[g],w=this.context.extTimerQuery,A=w.getQueryObjectEXT(v.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(v.query),h[g]=A}return h}translatePosMatrix(l,h,g,v,w){if(!g[0]&&!g[1])return l;const A=w?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(A){const O=Math.sin(A),V=Math.cos(A);g=[g[0]*V-g[1]*O,g[0]*O+g[1]*V]}const L=[w?g[0]:An(h,g[0],this.transform.zoom),w?g[1]:An(h,g[1],this.transform.zoom),0],$=new Float32Array(16);return o.translate($,l,L),$}saveTileTexture(l){const h=this._tileTextures[l.size[0]];h?h.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const h=this._tileTextures[l];return h&&h.length>0?h.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;const h=this.imageManager.getPattern(l.from.toString()),g=this.imageManager.getPattern(l.to.toString());return!h||!g}useProgram(l,h){this.cache=this.cache||{};const g=l+(h?h.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[g]||(this.cache[g]=new Ul(this.context,l,wi[l],h,Lf[l],this._showOverdrawInspector,this.style.terrain)),this.cache[g]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new D(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Ld{constructor(l,h){this.points=l,this.planes=h}static fromInvProjectionMatrix(l,h,g){const v=Math.pow(2,g),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(L=>{const $=1/(L=o.transformMat4([],L,l))[3]/h*v;return o.mul$1(L,L,[$,$,1/L[3],$])}),A=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(L=>{const $=o.sub([],w[L[0]],w[L[1]]),O=o.sub([],w[L[2]],w[L[1]]),V=o.normalize([],o.cross([],$,O)),W=-o.dot(V,w[L[1]]);return V.concat(W)});return new Ld(w,A)}}class ou{constructor(l,h){this.min=l,this.max=h,this.center=o.scale$1([],o.add([],this.min,this.max),.5)}quadrant(l){const h=[l%2==0,l<2],g=o.clone$2(this.min),v=o.clone$2(this.max);for(let w=0;w<h.length;w++)g[w]=h[w]?this.min[w]:this.center[w],v[w]=h[w]?this.center[w]:this.max[w];return v[2]=this.max[2],new ou(g,v)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersects(l){const h=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let g=!0;for(let v=0;v<l.planes.length;v++){const w=l.planes[v];let A=0;for(let L=0;L<h.length;L++)o.dot$1(w,h[L])>=0&&A++;if(A===0)return 0;A!==h.length&&(g=!1)}if(g)return 2;for(let v=0;v<3;v++){let w=Number.MAX_VALUE,A=-Number.MAX_VALUE;for(let L=0;L<l.points.length;L++){const $=l.points[L][v]-this.min[v];w=Math.min(w,$),A=Math.max(A,$)}if(A<0||w>this.max[v]-this.min[v])return 0}return 1}}class Yl{constructor(l=0,h=0,g=0,v=0){if(isNaN(l)||l<0||isNaN(h)||h<0||isNaN(g)||g<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=h,this.left=g,this.right=v}interpolate(l,h,g){return h.top!=null&&l.top!=null&&(this.top=o.number(l.top,h.top,g)),h.bottom!=null&&l.bottom!=null&&(this.bottom=o.number(l.bottom,h.bottom,g)),h.left!=null&&l.left!=null&&(this.left=o.number(l.left,h.left,g)),h.right!=null&&l.right!=null&&(this.right=o.number(l.right,h.right,g)),this}getCenter(l,h){const g=o.clamp((this.left+l-this.right)/2,0,l),v=o.clamp((this.top+h-this.bottom)/2,0,h);return new o.pointGeometry(g,v)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new Yl(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class au{constructor(l,h,g,v,w){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=w===void 0||!!w,this._minZoom=l||0,this._maxZoom=h||22,this._minPitch=g??0,this._maxPitch=v??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Yl,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const l=new au(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.tileSize=this.tileSize,l.latRange=this.latRange,l.width=this.width,l.height=this.height,l._center=this._center,l._elevation=this._elevation,l.zoom=this.zoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._calcMatrices(),l}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(l){const h=-o.wrap(l,-180,180)*Math.PI/180;var g;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(g=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),function(v,w,A){var L=w[0],$=w[1],O=w[2],V=w[3],W=Math.sin(A),X=Math.cos(A);v[0]=L*X+O*W,v[1]=$*X+V*W,v[2]=L*-W+O*X,v[3]=$*-W+V*X}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const h=o.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(l){const h=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,h,g){this._unmodified=!1,this._edgeInsets.interpolate(l,h,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const h=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(l){const h=[new o.UnwrappedTileID(0,l)];if(this._renderWorldCopies){const g=this.pointCoordinate(new o.pointGeometry(0,0)),v=this.pointCoordinate(new o.pointGeometry(this.width,0)),w=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),A=this.pointCoordinate(new o.pointGeometry(0,this.height)),L=Math.floor(Math.min(g.x,v.x,w.x,A.x)),$=Math.floor(Math.max(g.x,v.x,w.x,A.x)),O=1;for(let V=L-O;V<=$+O;V++)V!==0&&h.push(new o.UnwrappedTileID(V,l))}return h}coveringTiles(l){var h,g;let v=this.coveringZoomLevel(l);const w=v;if(l.minzoom!==void 0&&v<l.minzoom)return[];l.maxzoom!==void 0&&v>l.maxzoom&&(v=l.maxzoom);const A=this.pointCoordinate(this.getCameraPoint()),L=o.MercatorCoordinate.fromLngLat(this.center),$=Math.pow(2,v),O=[$*A.x,$*A.y,0],V=[$*L.x,$*L.y,0],W=Ld.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,v);let X=l.minzoom||0;!l.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(X=v);const ae=l.terrain?2/Math.min(this.tileSize,l.tileSize)*this.tileSize:3,se=ue=>({aabb:new ou([ue*$,0,0],[(ue+1)*$,$,0]),zoom:0,x:0,y:0,wrap:ue,fullyVisible:!1}),oe=[],_e=[],Te=v,Le=l.reparseOverscaled?w:v;if(this._renderWorldCopies)for(let ue=1;ue<=3;ue++)oe.push(se(-ue)),oe.push(se(ue));for(oe.push(se(0));oe.length>0;){const ue=oe.pop(),Fe=ue.x,ke=ue.y;let He=ue.fullyVisible;if(!He){const Tt=ue.aabb.intersects(W);if(Tt===0)continue;He=Tt===2}const We=l.terrain?O:V,et=ue.aabb.distanceX(We),Ge=ue.aabb.distanceY(We),wt=Math.max(Math.abs(et),Math.abs(Ge)),ft=ae+(1<<Te-ue.zoom)-2;if(ue.zoom===Te||wt>ft&&ue.zoom>=X){const Tt=Te-ue.zoom,tn=O[0]-.5-(Fe<<Tt),dn=O[1]-.5-(ke<<Tt);_e.push({tileID:new o.OverscaledTileID(ue.zoom===Te?Le:ue.zoom,ue.wrap,ue.zoom,Fe,ke),distanceSq:o.sqrLen([V[0]-.5-Fe,V[1]-.5-ke]),tileDistanceToCamera:Math.sqrt(tn*tn+dn*dn)})}else for(let Tt=0;Tt<4;Tt++){const tn=(Fe<<1)+Tt%2,dn=(ke<<1)+(Tt>>1),Gt=ue.zoom+1;let Un=ue.aabb.quadrant(Tt);if(l.terrain){const Vn=new o.OverscaledTileID(Gt,ue.wrap,Gt,tn,dn),Cn=l.terrain.getMinMaxElevation(Vn),In=(h=Cn.minElevation)!==null&&h!==void 0?h:this.elevation,Wn=(g=Cn.maxElevation)!==null&&g!==void 0?g:this.elevation;Un=new ou([Un.min[0],Un.min[1],In],[Un.max[0],Un.max[1],Wn])}oe.push({aabb:Un,zoom:Gt,x:tn,y:dn,wrap:ue.wrap,fullyVisible:He})}}return _e.sort((ue,Fe)=>ue.distanceSq-Fe.distanceSq).map(ue=>ue.tileID)}resize(l,h){this.width=l,this.height=h,this.pixelsToGLUnits=[2/l,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const h=o.clamp(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.pointGeometry(o.mercatorXfromLng(l.lng)*this.worldSize,o.mercatorYfromLat(h)*this.worldSize)}unproject(l){return new o.MercatorCoordinate(l.x/this.worldSize,l.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(l){this.freezeElevation||(this.elevation=l?this.getElevation(this._center,l):0)}getElevation(l,h){const g=o.MercatorCoordinate.fromLngLat(l),v=(1<<this.tileZoom)*o.EXTENT,w=g.x*v,A=g.y*v,L=Math.floor(w/o.EXTENT),$=Math.floor(A/o.EXTENT),O=new o.OverscaledTileID(this.tileZoom,0,this.tileZoom,L,$);return h.getElevation(O,w%o.EXTENT,A%o.EXTENT,o.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(l){const h=this.pointLocation(this.centerPoint,l),g=this.getElevation(h,l);if(!(this.elevation-g))return;const v=this.getCameraPosition(),w=o.MercatorCoordinate.fromLngLat(v.lngLat,v.altitude),A=o.MercatorCoordinate.fromLngLat(h,g),L=w.x-A.x,$=w.y-A.y,O=w.z-A.z,V=Math.sqrt(L*L+$*$+O*O),W=this.scaleZoom(this.cameraToCenterDistance/V/this.tileSize);this._elevation=g,this._center=h,this.zoom=W}setLocationAtPoint(l,h){const g=this.pointCoordinate(h),v=this.pointCoordinate(this.centerPoint),w=this.locationCoordinate(l),A=new o.MercatorCoordinate(w.x-(g.x-v.x),w.y-(g.y-v.y));this.center=this.coordinateLocation(A),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l,h){return h?this.coordinatePoint(this.locationCoordinate(l),this.getElevation(l,h),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(l))}pointLocation(l,h){return this.coordinateLocation(this.pointCoordinate(l,h))}locationCoordinate(l){return o.MercatorCoordinate.fromLngLat(l)}coordinateLocation(l){return l&&l.toLngLat()}pointCoordinate(l,h){if(h){const X=h.pointCoordinate(l);if(X!=null)return X}const g=[l.x,l.y,0,1],v=[l.x,l.y,1,1];o.transformMat4(g,g,this.pixelMatrixInverse),o.transformMat4(v,v,this.pixelMatrixInverse);const w=g[3],A=v[3],L=g[1]/w,$=v[1]/A,O=g[2]/w,V=v[2]/A,W=O===V?0:(0-O)/(V-O);return new o.MercatorCoordinate(o.number(g[0]/w,v[0]/A,W)/this.worldSize,o.number(L,$,W)/this.worldSize)}coordinatePoint(l,h=0,g=this.pixelMatrix){const v=[l.x*this.worldSize,l.y*this.worldSize,h,1];return o.transformMat4(v,v,g),new o.pointGeometry(v[0]/v[3],v[1]/v[3])}getBounds(){const l=Math.max(0,this.height/2-this.getHorizon());return new o.LngLatBounds().extend(this.pointLocation(new o.pointGeometry(0,l))).extend(this.pointLocation(new o.pointGeometry(this.width,l))).extend(this.pointLocation(new o.pointGeometry(this.width,this.height))).extend(this.pointLocation(new o.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(l,h=!1){const g=l.key,v=h?this._alignedPosMatrixCache:this._posMatrixCache;if(v[g])return v[g];const w=l.canonical,A=this.worldSize/this.zoomScale(w.z),L=w.x+Math.pow(2,w.z)*l.wrap,$=o.identity(new Float64Array(16));return o.translate($,$,[L*A,w.y*A,0]),o.scale($,$,[A/o.EXTENT,A/o.EXTENT,1]),o.multiply($,h?this.alignedProjMatrix:this.projMatrix,$),v[g]=new Float32Array($),v[g]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let l,h,g,v,w=-90,A=90,L=-180,$=180;const O=this.size,V=this._unmodified;if(this.latRange){const ae=this.latRange;w=o.mercatorYfromLat(ae[1])*this.worldSize,A=o.mercatorYfromLat(ae[0])*this.worldSize,l=A-w<O.y?O.y/(A-w):0}if(this.lngRange){const ae=this.lngRange;L=o.wrap(o.mercatorXfromLng(ae[0])*this.worldSize,0,this.worldSize),$=o.wrap(o.mercatorXfromLng(ae[1])*this.worldSize,0,this.worldSize),$<L&&($+=this.worldSize),h=$-L<O.x?O.x/($-L):0}const W=this.point,X=Math.max(h||0,l||0);if(X)return this.center=this.unproject(new o.pointGeometry(h?($+L)/2:W.x,l?(A+w)/2:W.y)),this.zoom+=this.scaleZoom(X),this._unmodified=V,void(this._constraining=!1);if(this.latRange){const ae=W.y,se=O.y/2;ae-se<w&&(v=w+se),ae+se>A&&(v=A-se)}if(this.lngRange){const ae=(L+$)/2,se=o.wrap(W.x,ae-this.worldSize/2,ae+this.worldSize/2),oe=O.x/2;se-oe<L&&(g=L+oe),se+oe>$&&(g=$-oe)}g===void 0&&v===void 0||(this.center=this.unproject(new o.pointGeometry(g!==void 0?g:W.x,v!==void 0?v:W.y)).wrap()),this._unmodified=V,this._constraining=!1}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,h=this.point.x,g=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let v=o.identity(new Float64Array(16));o.scale(v,v,[this.width/2,-this.height/2,1]),o.translate(v,v,[1,-1,0]),this.labelPlaneMatrix=v,v=o.identity(new Float64Array(16)),o.scale(v,v,[1,-1,1]),o.translate(v,v,[-1,-1,0]),o.scale(v,v,[2/this.width,2/this.height,1]),this.glCoordMatrix=v,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const w=Math.PI/2+this._pitch,A=this._fov*(.5+l.y/this.height),L=Math.sin(A)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-w-A,.01,Math.PI-.01)),$=this.getHorizon(),O=2*Math.atan($/this.cameraToCenterDistance)*(.5+l.y/(2*$)),V=Math.sin(O)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-w-O,.01,Math.PI-.01)),W=Math.cos(Math.PI/2-this._pitch)*L+this.cameraToSeaLevelDistance,X=Math.cos(Math.PI/2-this._pitch)*V+this.cameraToSeaLevelDistance,ae=1.01*Math.min(W,X),se=this.height/50;v=new Float64Array(16),o.perspective(v,this._fov,this.width/this.height,se,ae),v[8]=2*-l.x/this.width,v[9]=2*l.y/this.height,o.scale(v,v,[1,-1,1]),o.translate(v,v,[0,0,-this.cameraToCenterDistance]),o.rotateX(v,v,this._pitch),o.rotateZ(v,v,this.angle),o.translate(v,v,[-h,-g,0]),this.mercatorMatrix=o.scale([],v,[this.worldSize,this.worldSize,this.worldSize]),o.scale(v,v,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,v),o.translate(v,v,[0,0,-this.elevation]),this.projMatrix=v,this.invProjMatrix=o.invert([],v),this.pixelMatrix3D=o.multiply(new Float64Array(16),this.labelPlaneMatrix,v);const oe=this.width%2/2,_e=this.height%2/2,Te=Math.cos(this.angle),Le=Math.sin(this.angle),ue=h-Math.round(h)+Te*oe+Le*_e,Fe=g-Math.round(g)+Te*_e+Le*oe,ke=new Float64Array(v);if(o.translate(ke,ke,[ue>.5?ue-1:ue,Fe>.5?Fe-1:Fe,0]),this.alignedProjMatrix=ke,v=o.invert(new Float64Array(16),this.pixelMatrix),!v)throw new Error("failed to invert matrix");this.pixelMatrixInverse=v,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const l=this.pointCoordinate(new o.pointGeometry(0,0)),h=[l.x*this.worldSize,l.y*this.worldSize,0,1];return o.transformMat4(h,h,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,l))}getCameraQueryGeometry(l){const h=this.getCameraPoint();if(l.length===1)return[l[0],h];{let g=h.x,v=h.y,w=h.x,A=h.y;for(const L of l)g=Math.min(g,L.x),v=Math.min(v,L.y),w=Math.max(w,L.x),A=Math.max(A,L.y);return[new o.pointGeometry(g,v),new o.pointGeometry(w,v),new o.pointGeometry(w,A),new o.pointGeometry(g,A),new o.pointGeometry(g,v)]}}}class ty{constructor(l){this._hashName=l&&encodeURIComponent(l),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(h,g){let v=!1,w=null;const A=()=>{w=null,v&&(h(),w=setTimeout(A,300),v=!1)};return()=>(v=!0,w||A(),w)}(this._updateHashUnthrottled.bind(this))}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(l){const h=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,v=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,v),A=Math.round(h.lng*w)/w,L=Math.round(h.lat*w)/w,$=this._map.getBearing(),O=this._map.getPitch();let V="";if(V+=l?`/${A}/${L}/${g}`:`${g}/${L}/${A}`,($||O)&&(V+="/"+Math.round(10*$)/10),O&&(V+=`/${Math.round(O)}`),this._hashName){const W=this._hashName;let X=!1;const ae=window.location.hash.slice(1).split("&").map(se=>{const oe=se.split("=")[0];return oe===W?(X=!0,`${oe}=${V}`):se}).filter(se=>se);return X||ae.push(`${W}=${V}`),`#${ae.join("&")}`}return`#${V}`}_getCurrentHash(){const l=window.location.hash.replace("#","");if(this._hashName){let h;return l.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(h=g)}),(h&&h[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._getCurrentHash();if(l.length>=3&&!l.some(h=>isNaN(h))){const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(l[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+l[2],+l[1]],zoom:+l[0],bearing:h,pitch:+(l[4]||0)}),!0}return!1}_updateHashUnthrottled(){const l=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,l)}catch{}}}const lu={linearity:.3,easing:o.bezier(0,0,.3,1)},ny=o.extend({deceleration:2500,maxSpeed:1400},lu),ry=o.extend({deceleration:20,maxSpeed:1400},lu),iy=o.extend({deceleration:1e3,maxSpeed:360},lu),Jl=o.extend({deceleration:1e3,maxSpeed:90},lu);class sy{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,h=o.exported.now();for(;l.length>0&&h-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)h.zoom+=w.zoomDelta||0,h.bearing+=w.bearingDelta||0,h.pitch+=w.pitchDelta||0,w.panDelta&&h.pan._add(w.panDelta),w.around&&(h.around=w.around),w.pinchAround&&(h.pinchAround=w.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(h.pan.mag()){const w=uu(h.pan.mag(),g,o.extend({},ny,l||{}));v.offset=h.pan.mult(w.amount/h.pan.mag()),v.center=this._map.transform.center,cu(v,w)}if(h.zoom){const w=uu(h.zoom,g,ry);v.zoom=this._map.transform.zoom+w.amount,cu(v,w)}if(h.bearing){const w=uu(h.bearing,g,iy);v.bearing=this._map.transform.bearing+o.clamp(w.amount,-179,179),cu(v,w)}if(h.pitch){const w=uu(h.pitch,g,Jl);v.pitch=this._map.transform.pitch+w.amount,cu(v,w)}if(v.zoom||v.bearing){const w=h.pinchAround===void 0?h.around:h.pinchAround;v.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),o.extend(v,{noMoveStart:!0})}}function cu(y,l){(!y.duration||y.duration<l.duration)&&(y.duration=l.duration,y.easing=l.easing)}function uu(y,l,h){const{maxSpeed:g,linearity:v,deceleration:w}=h,A=o.clamp(y*v/(l/1e3),-g,g),L=Math.abs(A)/(w*v);return{easing:h.easing,duration:1e3*L,amount:A*(L/2)}}class _s extends o.Event{constructor(l,h,g,v={}){const w=T.mousePos(h.getCanvasContainer(),g),A=h.unproject(w);super(l,o.extend({point:w,lngLat:A,originalEvent:g},v)),this._defaultPrevented=!1,this.target=h}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class du extends o.Event{constructor(l,h,g){const v=l==="touchend"?g.changedTouches:g.touches,w=T.touchPos(h.getCanvasContainer(),v),A=w.map($=>h.unproject($)),L=w.reduce(($,O,V,W)=>$.add(O.div(W.length)),new o.pointGeometry(0,0));super(l,{points:w,point:L,lngLats:A,lngLat:h.unproject(L),originalEvent:g}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class vs extends o.Event{constructor(l,h,g){super(l,{originalEvent:g}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Kb{constructor(l,h){this._map=l,this._clickTolerance=h.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new vs(l.type,this._map,l))}mousedown(l,h){return this._mousedownPos=h,this._firePreventable(new _s(l.type,this._map,l))}mouseup(l){this._map.fire(new _s(l.type,this._map,l))}click(l,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||this._map.fire(new _s(l.type,this._map,l))}dblclick(l){return this._firePreventable(new _s(l.type,this._map,l))}mouseover(l){this._map.fire(new _s(l.type,this._map,l))}mouseout(l){this._map.fire(new _s(l.type,this._map,l))}touchstart(l){return this._firePreventable(new du(l.type,this._map,l))}touchmove(l){this._map.fire(new du(l.type,this._map,l))}touchend(l){this._map.fire(new du(l.type,this._map,l))}touchcancel(l){this._map.fire(new du(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class va{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new _s(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _s("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new _s(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class oy{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,h){this.isEnabled()&&l.shiftKey&&l.button===0&&(T.disableDrag(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(l,h){if(!this._active)return;const g=h;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=g,this._box||(this._box=T.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const w=Math.min(v.x,g.x),A=Math.max(v.x,g.x),L=Math.min(v.y,g.y),$=Math.max(v.y,g.y);T.setTransform(this._box,`translate(${w}px,${L}px)`),this._box.style.width=A-w+"px",this._box.style.height=$-L+"px"}mouseupWindow(l,h){if(!this._active||l.button!==0)return;const g=this._startPos,v=h;if(this.reset(),T.suppressClick(),g.x!==v.x||g.y!==v.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:w=>w.fitScreenCoordinates(g,v,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(T.remove(this._box),this._box=null),T.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,h){return this._map.fire(new o.Event(l,{originalEvent:h}))}}function Ko(y,l){if(y.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${l.length}`);const h={};for(let g=0;g<y.length;g++)h[y[g].identifier]=l[g];return h}class hu{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,h,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),g.length===this.numTouches&&(this.centroid=function(v){const w=new o.pointGeometry(0,0);for(const A of v)w._add(A);return w.div(v.length)}(h),this.touches=Ko(g,h)))}touchmove(l,h,g){if(this.aborted||!this.centroid)return;const v=Ko(g,h);for(const w in this.touches){const A=this.touches[w],L=v[w];(!L||L.dist(A)>30)&&(this.aborted=!0)}}touchend(l,h,g){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Hf{constructor(l){this.singleTap=new hu(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,h,g){this.singleTap.touchstart(l,h,g)}touchmove(l,h,g){this.singleTap.touchmove(l,h,g)}touchend(l,h,g){const v=this.singleTap.touchend(l,h,g);if(v){const w=l.timeStamp-this.lastTime<500,A=!this.lastTap||this.lastTap.dist(v)<30;if(w&&A||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class qb{constructor(){this._zoomIn=new Hf({numTouches:1,numTaps:2}),this._zoomOut=new Hf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,h,g){this._zoomIn.touchstart(l,h,g),this._zoomOut.touchstart(l,h,g)}touchmove(l,h,g){this._zoomIn.touchmove(l,h,g),this._zoomOut.touchmove(l,h,g)}touchend(l,h,g){const v=this._zoomIn.touchend(l,h,g),w=this._zoomOut.touchend(l,h,g);return v?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(v)},{originalEvent:l})}):w?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(w)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Xb={0:1,2:2};class Rd{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(l,h){return!1}_move(l,h){return{}}mousedown(l,h){if(this._lastPoint)return;const g=T.mouseButton(l);this._correctButton(l,g)&&(this._lastPoint=h,this._eventButton=g)}mousemoveWindow(l,h){const g=this._lastPoint;if(g){if(l.preventDefault(),function(v,w){const A=Xb[w];return v.buttons===void 0||(v.buttons&A)!==A}(l,this._eventButton))this.reset();else if(this._moved||!(h.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(g,h)}}mouseupWindow(l){this._lastPoint&&T.mouseButton(l)===this._eventButton&&(this._moved&&T.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fu extends Rd{mousedown(l,h){super.mousedown(l,h),this._lastPoint&&(this._active=!0)}_correctButton(l,h){return h===0&&!l.ctrlKey}_move(l,h){return{around:h,panDelta:h.sub(l)}}}class qo extends Rd{_correctButton(l,h){return h===0&&l.ctrlKey||h===2}_move(l,h){const g=.8*(h.x-l.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(l){l.preventDefault()}}class Pt extends Rd{_correctButton(l,h){return h===0&&l.ctrlKey||h===2}_move(l,h){const g=-.5*(h.y-l.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(l){l.preventDefault()}}class ay{constructor(l,h){this._minTouches=l.cooperativeGestures?2:1,this._clickTolerance=l.clickTolerance||1,this._map=h,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(l,h,g){return this._calculateTransform(l,h,g)}touchmove(l,h,g){if(this._map._cooperativeGestures&&(this._minTouches===2&&g.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(l,!1,g.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(g.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,h,g)}touchend(l,h,g){this._calculateTransform(l,h,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,h,g){g.length>0&&(this._active=!0);const v=Ko(g,h),w=new o.pointGeometry(0,0),A=new o.pointGeometry(0,0);let L=0;for(const O in v){const V=v[O],W=this._touches[O];W&&(w._add(V),A._add(V.sub(W)),L++,v[O]=V)}if(this._touches=v,L<this._minTouches||!A.mag())return;const $=A.div(L);return this._sum._add($),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(L),panDelta:$}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ya{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(l){}_move(l,h,g){return{}}touchstart(l,h,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([h[0],h[1]]))}touchmove(l,h,g){if(!this._firstTwoTouches)return;l.preventDefault();const[v,w]=this._firstTwoTouches,A=ba(g,h,v),L=ba(g,h,w);if(!A||!L)return;const $=this._aroundCenter?null:A.add(L).div(2);return this._move([A,L],$,l)}touchend(l,h,g){if(!this._firstTwoTouches)return;const[v,w]=this._firstTwoTouches,A=ba(g,h,v),L=ba(g,h,w);A&&L||(this._active&&T.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ba(y,l,h){for(let g=0;g<y.length;g++)if(y[g].identifier===h)return l[g]}function Wf(y,l){return Math.log(y/l)/Math.LN2}class vt extends Ya{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,h){const g=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Wf(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Wf(this._distance,g),pinchAround:h}}}function $d(y,l){return 180*y.angleWith(l)/Math.PI}class Zb extends Ya{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,h){const g=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:$d(this._vector,g),pinchAround:h}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const h=25/(Math.PI*this._minDiameter)*360,g=$d(l,this._startVector);return Math.abs(g)<h}}function Kf(y){return Math.abs(y.y)>Math.abs(y.x)}class qf extends Ya{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,h,g){super.touchstart(l,h,g),this._currentTouchCount=g.length}_start(l){this._lastPoints=l,Kf(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,h,g){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const v=l[0].sub(this._lastPoints[0]),w=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(v,w,g.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(v.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(l,h,g){if(this._valid!==void 0)return this._valid;const v=l.mag()>=2,w=h.mag()>=2;if(!v&&!w)return;if(!v||!w)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const A=l.y>0==h.y>0;return Kf(l)&&Kf(h)&&A}}const ly={panStep:100,bearingStep:15,pitchStep:10};class cy{constructor(){const l=ly;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let h=0,g=0,v=0,w=0,A=0;switch(l.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:l.shiftKey?g=-1:(l.preventDefault(),w=-1);break;case 39:l.shiftKey?g=1:(l.preventDefault(),w=1);break;case 38:l.shiftKey?v=1:(l.preventDefault(),A=-1);break;case 40:l.shiftKey?v=-1:(l.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(g=0,v=0),{cameraAnimation:L=>{const $=L.getZoom();L.easeTo({duration:300,easeId:"keyboardHandler",easing:Yb,zoom:h?Math.round($)+h*(l.shiftKey?2:1):$,bearing:L.getBearing()+g*this._bearingStep,pitch:L.getPitch()+v*this._pitchStep,offset:[-w*this._panStep,-A*this._panStep],center:L.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Yb(y){return y*(2-y)}const uy=4.000244140625;class Xf{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;l.preventDefault()}let h=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const g=o.exported.now(),v=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,h!==0&&h%uy==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(v*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),l.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=l,this._delta-=h,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=T.mousePos(this._el,l);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(h)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;if(this._delta!==0){const L=this._type==="wheel"&&Math.abs(this._delta)>uy?this._wheelZoomRate:this._defaultZoomRate;let $=2/(1+Math.exp(-Math.abs(this._delta*L)));this._delta<0&&$!==0&&($=1/$);const O=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):l.scale;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(O*$))),this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const h=typeof this._targetZoom=="number"?this._targetZoom:l.zoom,g=this._startZoom,v=this._easing;let w,A=!1;if(this._type==="wheel"&&g&&v){const L=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),$=v(L);w=o.number(g,h,$),L<1?this._frameId||(this._frameId=!0):A=!0}else w=h,A=!0;return this._active=!0,A&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!A,zoomDelta:w-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let h=o.ease;if(this._prevEase){const g=this._prevEase,v=(o.exported.now()-g.start)/g.duration,w=g.easing(v+.01)-g.easing(v),A=.27/Math.sqrt(w*w+1e-4)*.01,L=Math.sqrt(.0729-A*A);h=o.bezier(A,L,.25,1)}return this._prevEase={start:o.exported.now(),duration:l,easing:h},h}reset(){this._active=!1}}class Zf{constructor(l,h){this._clickZoom=l,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Yf{constructor(){this.reset()}reset(){this._active=!1}dblclick(l,h){return l.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(l.shiftKey?-1:1),around:g.unproject(h)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jf{constructor(){this._tap=new Hf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(l,h,g){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=h[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(l,h,g))}touchmove(l,h,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const v=h[0],w=v.y-this._swipePoint.y;return this._swipePoint=v,l.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(l,h,g)}touchend(l,h,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(l,h,g)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ts{constructor(l,h,g){this._el=l,this._mousePan=h,this._touchPan=g}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xa{constructor(l,h,g){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=h,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class dy{constructor(l,h,g,v){this._el=l,this._touchZoom=h,this._touchRotate=g,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ql=y=>y.zoom||y.drag||y.pitch||y.rotate;class Qf extends o.Event{}function pu(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class hy{constructor(l,h){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new sy(l),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(h),o.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[v,w,A]of this._listeners)T.addEventListener(v,w,v===document?this.handleWindowEvent:this.handleEvent,A)}destroy(){for(const[l,h,g]of this._listeners)T.removeEventListener(l,h,l===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(l){const h=this._map,g=h.getCanvasContainer();this._add("mapEvent",new Kb(h,l));const v=h.boxZoom=new oy(h,l);this._add("boxZoom",v);const w=new qb,A=new Yf;h.doubleClickZoom=new Zf(A,w),this._add("tapZoom",w),this._add("clickZoom",A);const L=new Jf;this._add("tapDragZoom",L);const $=h.touchPitch=new qf(h);this._add("touchPitch",$);const O=new qo(l),V=new Pt(l);h.dragRotate=new xa(l,O,V),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",V,["mouseRotate"]);const W=new fu(l),X=new ay(l,h);h.dragPan=new ts(g,W,X),this._add("mousePan",W),this._add("touchPan",X,["touchZoom","touchRotate"]);const ae=new Zb,se=new vt;h.touchZoomRotate=new dy(g,se,ae,L),this._add("touchRotate",ae,["touchPan","touchZoom"]),this._add("touchZoom",se,["touchPan","touchRotate"]);const oe=h.scrollZoom=new Xf(h,this);this._add("scrollZoom",oe,["mousePan"]);const _e=h.keyboard=new cy;this._add("keyboard",_e),this._add("blockableMapEvent",new va(h));for(const Te of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[Te]&&h[Te].enable(l[Te])}_add(l,h,g){this._handlers.push({handlerName:l,handler:h,allowed:g}),this._handlersById[l]=h}stop(l){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ql(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,h,g){for(const v in l)if(v!==g&&(!h||h.indexOf(v)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const h=[];for(const g of l)this._el.contains(g.target)&&h.push(g);return h}handleEvent(l,h){if(l.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const g=l.type==="renderFrame"?void 0:l,v={needsRenderFrame:!1},w={},A={},L=l.touches,$=L?this._getMapTouches(L):void 0,O=$?T.touchPos(this._el,$):T.mousePos(this._el,l);for(const{handlerName:X,handler:ae,allowed:se}of this._handlers){if(!ae.isEnabled())continue;let oe;this._blockedByActive(A,se,X)?ae.reset():ae[h||l.type]&&(oe=ae[h||l.type](l,O,$),this.mergeHandlerResult(v,w,oe,X,g),oe&&oe.needsRenderFrame&&this._triggerRenderFrame()),(oe||ae.isActive())&&(A[X]=ae)}const V={};for(const X in this._previousActiveHandlers)A[X]||(V[X]=g);this._previousActiveHandlers=A,(Object.keys(V).length||pu(v))&&(this._changes.push([v,w,V]),this._triggerRenderFrame()),(Object.keys(A).length||pu(v))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:W}=v;W&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],W(this._map))}mergeHandlerResult(l,h,g,v,w){if(!g)return;o.extend(l,g);const A={handlerName:v,originalEvent:g.originalEvent||w};g.zoomDelta!==void 0&&(h.zoom=A),g.panDelta!==void 0&&(h.drag=A),g.pitchDelta!==void 0&&(h.pitch=A),g.bearingDelta!==void 0&&(h.rotate=A)}_applyChanges(){const l={},h={},g={};for(const[v,w,A]of this._changes)v.panDelta&&(l.panDelta=(l.panDelta||new o.pointGeometry(0,0))._add(v.panDelta)),v.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(l.around=v.around),v.pinchAround!==void 0&&(l.pinchAround=v.pinchAround),v.noInertia&&(l.noInertia=v.noInertia),o.extend(h,w),o.extend(g,A);this._updateMapTransform(l,h,g),this._changes=[]}_updateMapTransform(l,h,g){const v=this._map,w=v.transform,A=v.style&&v.style.terrain;if(!(pu(l)||A&&this._drag))return this._fireEvents(h,g,!0);let{panDelta:L,zoomDelta:$,bearingDelta:O,pitchDelta:V,around:W,pinchAround:X}=l;X!==void 0&&(W=X),v._stop(!0),W=W||v.transform.centerPoint;const ae=w.pointLocation(L?W.sub(L):W);O&&(w.bearing+=O),V&&(w.pitch+=V),$&&(w.zoom+=$),A?h.drag&&!this._drag?(this._drag={center:w.centerPoint,lngLat:w.pointLocation(W),point:W,handlerName:h.drag.handlerName},v.fire(new o.Event("freezeElevation",{freeze:!0}))):this._drag&&g[this._drag.handlerName]?(v.fire(new o.Event("freezeElevation",{freeze:!1})),this._drag=null):h.drag&&this._drag&&(w.center=w.pointLocation(w.centerPoint.sub(L))):w.setLocationAtPoint(ae,W),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(h,g,!0)}_fireEvents(l,h,g){const v=Ql(this._eventsInProgress),w=Ql(l),A={};for(const V in l){const{originalEvent:W}=l[V];this._eventsInProgress[V]||(A[`${V}start`]=W),this._eventsInProgress[V]=l[V]}!v&&w&&this._fireEvent("movestart",w.originalEvent);for(const V in A)this._fireEvent(V,A[V]);w&&this._fireEvent("move",w.originalEvent);for(const V in l){const{originalEvent:W}=l[V];this._fireEvent(V,W)}const L={};let $;for(const V in this._eventsInProgress){const{handlerName:W,originalEvent:X}=this._eventsInProgress[V];this._handlersById[W].isActive()||(delete this._eventsInProgress[V],$=h[W]||X,L[`${V}end`]=$)}for(const V in L)this._fireEvent(V,L[V]);const O=Ql(this._eventsInProgress);if(g&&(v||w)&&!O){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),W=X=>X!==0&&-this._bearingSnap<X&&X<this._bearingSnap;V?(W(V.bearing||this._map.getBearing())&&(V.bearing=0),this._map.easeTo(V,{originalEvent:$})):(this._map.fire(new o.Event("moveend",{originalEvent:$})),W(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,h){this._map.fire(new o.Event(l,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new Qf("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ks={extend:(y,...l)=>o.extend(y,...l),run(y){y()},logToElement(y,l=!1,h="log"){const g=window.document.getElementById(h);g&&(l&&(g.innerHTML=""),g.innerHTML+=`<br>${y}`)}};class hr extends o.Evented{constructor(l,h){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=h.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,h){return this.jumpTo({center:l},h)}panBy(l,h,g){return l=o.pointGeometry.convert(l).mult(-1),this.panTo(this.transform.center,o.extend({offset:l},h),g)}panTo(l,h,g){return this.easeTo(o.extend({center:l},h),g)}getZoom(){return this.transform.zoom}setZoom(l,h){return this.jumpTo({zoom:l},h),this}zoomTo(l,h,g){return this.easeTo(o.extend({zoom:l},h),g)}zoomIn(l,h){return this.zoomTo(this.getZoom()+1,l,h),this}zoomOut(l,h){return this.zoomTo(this.getZoom()-1,l,h),this}getBearing(){return this.transform.bearing}setBearing(l,h){return this.jumpTo({bearing:l},h),this}getPadding(){return this.transform.padding}setPadding(l,h){return this.jumpTo({padding:l},h),this}rotateTo(l,h,g){return this.easeTo(o.extend({bearing:l},h),g)}resetNorth(l,h){return this.rotateTo(0,o.extend({duration:1e3},l),h),this}resetNorthPitch(l,h){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},l),h),this}snapToNorth(l,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,h):this}getPitch(){return this.transform.pitch}setPitch(l,h){return this.jumpTo({pitch:l},h),this}cameraForBounds(l,h){l=o.LngLatBounds.convert(l);const g=h&&h.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),g,h)}_cameraForBoxAndBearing(l,h,g,v){const w={top:0,bottom:0,right:0,left:0};if(typeof(v=o.extend({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},v)).padding=="number"){const ke=v.padding;v.padding={top:ke,bottom:ke,right:ke,left:ke}}v.padding=o.extend(w,v.padding);const A=this.transform,L=A.padding,$=A.project(o.LngLat.convert(l)),O=A.project(o.LngLat.convert(h)),V=$.rotate(-g*Math.PI/180),W=O.rotate(-g*Math.PI/180),X=new o.pointGeometry(Math.max(V.x,W.x),Math.max(V.y,W.y)),ae=new o.pointGeometry(Math.min(V.x,W.x),Math.min(V.y,W.y)),se=X.sub(ae),oe=(A.width-(L.left+L.right+v.padding.left+v.padding.right))/se.x,_e=(A.height-(L.top+L.bottom+v.padding.top+v.padding.bottom))/se.y;if(_e<0||oe<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Te=Math.min(A.scaleZoom(A.scale*Math.min(oe,_e)),v.maxZoom),Le=o.pointGeometry.convert(v.offset),ue=new o.pointGeometry((v.padding.left-v.padding.right)/2,(v.padding.top-v.padding.bottom)/2).rotate(g*Math.PI/180),Fe=Le.add(ue).mult(A.scale/A.zoomScale(Te));return{center:A.unproject($.add(O).div(2).sub(Fe)),zoom:Te,bearing:g}}fitBounds(l,h,g){return this._fitInternal(this.cameraForBounds(l,h),h,g)}fitScreenCoordinates(l,h,g,v,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(l)),this.transform.pointLocation(o.pointGeometry.convert(h)),g,v),v,w)}_fitInternal(l,h,g){return l?(delete(h=o.extend(l,h)).padding,h.linear?this.easeTo(h,g):this.flyTo(h,g)):this}jumpTo(l,h){this.stop();const g=this.transform;let v=!1,w=!1,A=!1;return"zoom"in l&&g.zoom!==+l.zoom&&(v=!0,g.zoom=+l.zoom),l.center!==void 0&&(g.center=o.LngLat.convert(l.center)),"bearing"in l&&g.bearing!==+l.bearing&&(w=!0,g.bearing=+l.bearing),"pitch"in l&&g.pitch!==+l.pitch&&(A=!0,g.pitch=+l.pitch),l.padding==null||g.isPaddingEqual(l.padding)||(g.padding=l.padding),this.fire(new o.Event("movestart",h)).fire(new o.Event("move",h)),v&&this.fire(new o.Event("zoomstart",h)).fire(new o.Event("zoom",h)).fire(new o.Event("zoomend",h)),w&&this.fire(new o.Event("rotatestart",h)).fire(new o.Event("rotate",h)).fire(new o.Event("rotateend",h)),A&&this.fire(new o.Event("pitchstart",h)).fire(new o.Event("pitch",h)).fire(new o.Event("pitchend",h)),this.fire(new o.Event("moveend",h))}calculateCameraOptionsFromTo(l,h,g,v=0){const w=o.MercatorCoordinate.fromLngLat(l,h),A=o.MercatorCoordinate.fromLngLat(g,v),L=A.x-w.x,$=A.y-w.y,O=A.z-w.z,V=Math.hypot(L,$,O);if(V===0)throw new Error("Can't calculate camera options with same From and To");const W=Math.hypot(L,$),X=this.transform.scaleZoom(this.transform.cameraToCenterDistance/V/this.transform.tileSize),ae=180*Math.atan2(L,-$)/Math.PI;let se=180*Math.acos(W/V)/Math.PI;return se=O<0?90-se:90+se,{center:A.toLngLat(),zoom:X,pitch:se,bearing:ae}}easeTo(l,h){this._stop(!1,l.easeId),((l=o.extend({offset:[0,0],duration:500,easing:o.ease},l)).animate===!1||!l.essential&&o.exported.prefersReducedMotion)&&(l.duration=0);const g=this.transform,v=this.getZoom(),w=this.getBearing(),A=this.getPitch(),L=this.getPadding(),$="zoom"in l?+l.zoom:v,O="bearing"in l?this._normalizeBearing(l.bearing,w):w,V="pitch"in l?+l.pitch:A,W="padding"in l?l.padding:g.padding,X=o.pointGeometry.convert(l.offset);let ae=g.centerPoint.add(X);const se=g.pointLocation(ae),oe=o.LngLat.convert(l.center||se);this._normalizeCenter(oe);const _e=g.project(se),Te=g.project(oe).sub(_e),Le=g.zoomScale($-v);let ue,Fe;l.around&&(ue=o.LngLat.convert(l.around),Fe=g.locationPoint(ue));const ke={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||$!==v,this._rotating=this._rotating||w!==O,this._pitching=this._pitching||V!==A,this._padding=!g.isPaddingEqual(W),this._easeId=l.easeId,this._prepareEase(h,l.noMoveStart,ke),this._ease(He=>{if(this._zooming&&(g.zoom=o.number(v,$,He)),this._rotating&&(g.bearing=o.number(w,O,He)),this._pitching&&(g.pitch=o.number(A,V,He)),this._padding&&(g.interpolatePadding(L,W,He),ae=g.centerPoint.add(X)),ue)g.setLocationAtPoint(ue,Fe);else{const We=g.zoomScale(g.zoom-v),et=$>v?Math.min(2,Le):Math.max(.5,Le),Ge=Math.pow(et,1-He),wt=g.unproject(_e.add(Te.mult(He*Ge)).mult(We));g.setLocationAtPoint(g.renderWorldCopies?wt.wrap():wt,ae)}this._fireMoveEvents(h)},He=>{this._afterEase(h,He)},l),this}_prepareEase(l,h,g={}){this._moving=!0,this.fire(new o.Event("freezeElevation",{freeze:!0})),h||g.moving||this.fire(new o.Event("movestart",l)),this._zooming&&!g.zooming&&this.fire(new o.Event("zoomstart",l)),this._rotating&&!g.rotating&&this.fire(new o.Event("rotatestart",l)),this._pitching&&!g.pitching&&this.fire(new o.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new o.Event("move",l)),this._zooming&&this.fire(new o.Event("zoom",l)),this._rotating&&this.fire(new o.Event("rotate",l)),this._pitching&&this.fire(new o.Event("pitch",l))}_afterEase(l,h){if(this._easeId&&h&&this._easeId===h)return;delete this._easeId,this.fire(new o.Event("freezeElevation",{freeze:!1}));const g=this._zooming,v=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new o.Event("zoomend",l)),v&&this.fire(new o.Event("rotateend",l)),w&&this.fire(new o.Event("pitchend",l)),this.fire(new o.Event("moveend",l))}flyTo(l,h){if(!l.essential&&o.exported.prefersReducedMotion){const Gt=o.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Gt,h)}this.stop(),l=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},l);const g=this.transform,v=this.getZoom(),w=this.getBearing(),A=this.getPitch(),L=this.getPadding(),$="zoom"in l?o.clamp(+l.zoom,g.minZoom,g.maxZoom):v,O="bearing"in l?this._normalizeBearing(l.bearing,w):w,V="pitch"in l?+l.pitch:A,W="padding"in l?l.padding:g.padding,X=g.zoomScale($-v),ae=o.pointGeometry.convert(l.offset);let se=g.centerPoint.add(ae);const oe=g.pointLocation(se),_e=o.LngLat.convert(l.center||oe);this._normalizeCenter(_e);const Te=g.project(oe),Le=g.project(_e).sub(Te);let ue=l.curve;const Fe=Math.max(g.width,g.height),ke=Fe/X,He=Le.mag();if("minZoom"in l){const Gt=o.clamp(Math.min(l.minZoom,v,$),g.minZoom,g.maxZoom),Un=Fe/g.zoomScale(Gt-v);ue=Math.sqrt(Un/He*2)}const We=ue*ue;function et(Gt){const Un=(ke*ke-Fe*Fe+(Gt?-1:1)*We*We*He*He)/(2*(Gt?ke:Fe)*We*He);return Math.log(Math.sqrt(Un*Un+1)-Un)}function Ge(Gt){return(Math.exp(Gt)-Math.exp(-Gt))/2}function wt(Gt){return(Math.exp(Gt)+Math.exp(-Gt))/2}const ft=et(0);let Tt=function(Gt){return wt(ft)/wt(ft+ue*Gt)},tn=function(Gt){return Fe*((wt(ft)*(Ge(Un=ft+ue*Gt)/wt(Un))-Ge(ft))/We)/He;var Un},dn=(et(1)-ft)/ue;if(Math.abs(He)<1e-6||!isFinite(dn)){if(Math.abs(Fe-ke)<1e-6)return this.easeTo(l,h);const Gt=ke<Fe?-1:1;dn=Math.abs(Math.log(ke/Fe))/ue,tn=function(){return 0},Tt=function(Un){return Math.exp(Gt*ue*Un)}}return l.duration="duration"in l?+l.duration:1e3*dn/("screenSpeed"in l?+l.screenSpeed/ue:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=w!==O,this._pitching=V!==A,this._padding=!g.isPaddingEqual(W),this._prepareEase(h,!1),this._ease(Gt=>{const Un=Gt*dn,Vn=1/Tt(Un);g.zoom=Gt===1?$:v+g.scaleZoom(Vn),this._rotating&&(g.bearing=o.number(w,O,Gt)),this._pitching&&(g.pitch=o.number(A,V,Gt)),this._padding&&(g.interpolatePadding(L,W,Gt),se=g.centerPoint.add(ae));const Cn=Gt===1?_e:g.unproject(Te.add(Le.mult(tn(Un))).mult(Vn));g.setLocationAtPoint(g.renderWorldCopies?Cn.wrap():Cn,se),this._fireMoveEvents(h)},()=>this._afterEase(h),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,h)}if(!l){const g=this.handlers;g&&g.stop(!1)}return this}_ease(l,h,g){g.animate===!1||g.duration===0?(l(1),h()):(this._easeStart=o.exported.now(),this._easeOptions=g,this._onEaseFrame=l,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,h){l=o.wrap(l,-180,180);const g=Math.abs(l-h);return Math.abs(l-360-h)<g&&(l-=360),Math.abs(l+360-h)<g&&(l+=360),l}_normalizeCenter(l){const h=this.transform;if(!h.renderWorldCopies||h.lngRange)return;const g=l.lng-h.center.lng;l.lng+=g>180?-360:g<-180?360:0}}class mu{constructor(l={}){this.options=l,o.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options&&this.options.compact,this._container=T.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=T.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=T.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){T.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,h){const g=this._map._getUIString(`AttributionControl.${h}`);l.title=g,l.setAttribute("aria-label",g)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(l){!l||l.sourceDataType!=="metadata"&&l.sourceDataType!=="visibility"&&l.dataType!=="style"&&l.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(v=>typeof v!="string"?"":v)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const h=this._map.style.sourceCaches;for(const v in h){const w=h[v];if(w.used||w.usedForTerrain){const A=w.getSource();A.attribution&&l.indexOf(A.attribution)<0&&l.push(A.attribution)}}l=l.filter(v=>String(v).trim()),l.sort((v,w)=>v.length-w.length),l=l.filter((v,w)=>{for(let A=w+1;A<l.length;A++)if(l[A].indexOf(v)>=0)return!1;return!0});const g=l.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,l.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class Md{constructor(l={}){this.options=l,o.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=T.create("div","maplibregl-ctrl mapboxgl-ctrl");const h=T.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://maplibre.org/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){T.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const l=this._container.children;if(l.length){const h=l[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&h.classList.add("maplibregl-compact","mapboxgl-compact"):h.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class fy{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const h=++this._id;return this._queue.push({callback:l,id:h,cancelled:!1}),h}remove(l){const h=this._currentlyRunning,g=h?this._queue.concat(h):this._queue;for(const v of g)if(v.id===l)return void(v.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const h=this._currentlyRunning=this._queue;this._queue=[];for(const g of h)if(!g.cancelled&&(g.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const py={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},my={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},Jb={showCompass:!0,showZoom:!0,visualizePitch:!1};class Po{constructor(l,h,g=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new qo({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,g&&(this.mousePitch=new Pt({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),T.addEventListener(h,"mousedown",this.mousedown),T.addEventListener(h,"touchstart",this.touchstart,{passive:!1}),T.addEventListener(h,"touchmove",this.touchmove),T.addEventListener(h,"touchend",this.touchend),T.addEventListener(h,"touchcancel",this.reset)}down(l,h){this.mouseRotate.mousedown(l,h),this.mousePitch&&this.mousePitch.mousedown(l,h),T.disableDrag()}move(l,h){const g=this.map,v=this.mouseRotate.mousemoveWindow(l,h);if(v&&v.bearingDelta&&g.setBearing(g.getBearing()+v.bearingDelta),this.mousePitch){const w=this.mousePitch.mousemoveWindow(l,h);w&&w.pitchDelta&&g.setPitch(g.getPitch()+w.pitchDelta)}}off(){const l=this.element;T.removeEventListener(l,"mousedown",this.mousedown),T.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),T.removeEventListener(l,"touchmove",this.touchmove),T.removeEventListener(l,"touchend",this.touchend),T.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){T.enableDrag(),T.removeEventListener(window,"mousemove",this.mousemove),T.removeEventListener(window,"mouseup",this.mouseup)}mousedown(l){this.down(o.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),T.mousePos(this.element,l)),T.addEventListener(window,"mousemove",this.mousemove),T.addEventListener(window,"mouseup",this.mouseup)}mousemove(l){this.move(l,T.mousePos(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){l.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=T.touchPos(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){l.targetTouches.length!==1?this.reset():(this._lastPos=T.touchPos(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){l.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function gu(y,l,h){if(y=new o.LngLat(y.lng,y.lat),l){const g=new o.LngLat(y.lng-360,y.lat),v=new o.LngLat(y.lng+360,y.lat),w=h.locationPoint(y).distSqr(l);h.locationPoint(g).distSqr(l)<w?y=g:h.locationPoint(v).distSqr(l)<w&&(y=v)}for(;Math.abs(y.lng-h.center.lng)>180;){const g=h.locationPoint(y);if(g.x>=0&&g.y>=0&&g.x<=h.width&&g.y<=h.height)break;y.lng>h.center.lng?y.lng-=360:y.lng+=360}return y}const Ft={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function qt(y,l,h){const g=y.classList;for(const v in Ft)g.remove(`maplibregl-${h}-anchor-${v}`,`mapboxgl-${h}-anchor-${v}`);g.add(`maplibregl-${h}-anchor-${l}`,`mapboxgl-${h}-anchor-${l}`)}class ec extends o.Evented{constructor(l,h){if(super(),(l instanceof HTMLElement||h)&&(l=o.extend({element:l},h)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,l&&l.element)this._element=l.element,this._offset=o.pointGeometry.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=T.create("div"),this._element.setAttribute("aria-label","Map marker");const g=T.createNS("http://www.w3.org/2000/svg","svg"),v=41,w=27;g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height",`${v}px`),g.setAttributeNS(null,"width",`${w}px`),g.setAttributeNS(null,"viewBox",`0 0 ${w} ${v}`);const A=T.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"stroke","none"),A.setAttributeNS(null,"stroke-width","1"),A.setAttributeNS(null,"fill","none"),A.setAttributeNS(null,"fill-rule","evenodd");const L=T.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");const $=T.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(3.0, 29.0)"),$.setAttributeNS(null,"fill","#000000");const O=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Le of O){const ue=T.createNS("http://www.w3.org/2000/svg","ellipse");ue.setAttributeNS(null,"opacity","0.04"),ue.setAttributeNS(null,"cx","10.5"),ue.setAttributeNS(null,"cy","5.80029008"),ue.setAttributeNS(null,"rx",Le.rx),ue.setAttributeNS(null,"ry",Le.ry),$.appendChild(ue)}const V=T.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"fill",this._color);const W=T.createNS("http://www.w3.org/2000/svg","path");W.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),V.appendChild(W);const X=T.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"opacity","0.25"),X.setAttributeNS(null,"fill","#000000");const ae=T.createNS("http://www.w3.org/2000/svg","path");ae.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),X.appendChild(ae);const se=T.createNS("http://www.w3.org/2000/svg","g");se.setAttributeNS(null,"transform","translate(6.0, 7.0)"),se.setAttributeNS(null,"fill","#FFFFFF");const oe=T.createNS("http://www.w3.org/2000/svg","g");oe.setAttributeNS(null,"transform","translate(8.0, 8.0)");const _e=T.createNS("http://www.w3.org/2000/svg","circle");_e.setAttributeNS(null,"fill","#000000"),_e.setAttributeNS(null,"opacity","0.25"),_e.setAttributeNS(null,"cx","5.5"),_e.setAttributeNS(null,"cy","5.5"),_e.setAttributeNS(null,"r","5.4999962");const Te=T.createNS("http://www.w3.org/2000/svg","circle");Te.setAttributeNS(null,"fill","#FFFFFF"),Te.setAttributeNS(null,"cx","5.5"),Te.setAttributeNS(null,"cy","5.5"),Te.setAttributeNS(null,"r","5.4999962"),oe.appendChild(_e),oe.appendChild(Te),L.appendChild($),L.appendChild(V),L.appendChild(X),L.appendChild(se),L.appendChild(oe),g.appendChild(L),g.setAttributeNS(null,"height",v*this._scale+"px"),g.setAttributeNS(null,"width",w*this._scale+"px"),this._element.appendChild(g),this._offset=o.pointGeometry.convert(l&&l.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",g=>{g.preventDefault()}),this._element.addEventListener("mousedown",g=>{g.preventDefault()}),qt(this._element,this._anchor,"marker"),this._popup=null}addTo(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),T.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=o.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(l){const h=l.code,g=l.charCode||l.keyCode;h!=="Space"&&h!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(l){const h=l.originalEvent.target,g=this._element;this._popup&&(h===g||g.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?l.remove():l.addTo(this._map),this):this}_update(l){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=gu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let h="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?h=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(h=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g=`rotateX(${this._map.getPitch()}deg)`),l&&l.type!=="moveend"||(this._pos=this._pos.round()),T.setTransform(this._element,`${Ft[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${g} ${h}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const v=this._map.unproject(this._pos),w=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=v.distanceTo(this._lngLat)>20*w?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(l){return this._offset=o.pointGeometry.convert(l),this._update(),this}_onMove(l){if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=l.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=l.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(l){this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(this._pos).add(this._offset),this._pointerdownPos=l.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const ep={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let wa,Ei=0,Ea=!1;const Co={maxWidth:100,unit:"metric"};function gy(y,l,h){const g=h&&h.maxWidth||100,v=y._container.clientHeight/2,w=y.unproject([0,v]),A=y.unproject([g,v]),L=w.distanceTo(A);if(h&&h.unit==="imperial"){const $=3.2808*L;$>5280?Ta(l,g,$/5280,y._getUIString("ScaleControl.Miles")):Ta(l,g,$,y._getUIString("ScaleControl.Feet"))}else h&&h.unit==="nautical"?Ta(l,g,L/1852,y._getUIString("ScaleControl.NauticalMiles")):L>=1e3?Ta(l,g,L/1e3,y._getUIString("ScaleControl.Kilometers")):Ta(l,g,L,y._getUIString("ScaleControl.Meters"))}function Ta(y,l,h,g){const v=function(w){const A=Math.pow(10,`${Math.floor(w)}`.length-1);let L=w/A;return L=L>=10?10:L>=5?5:L>=3?3:L>=2?2:L>=1?1:function($){const O=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10));return Math.round($*O)/O}(L),A*L}(h);y.style.width=l*(v/h)+"px",y.innerHTML=`${v}&nbsp;${g}`}const kr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Xr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function tp(y){if(y){if(typeof y=="number"){const l=Math.round(Math.sqrt(.5*Math.pow(y,2)));return{center:new o.pointGeometry(0,0),top:new o.pointGeometry(0,y),"top-left":new o.pointGeometry(l,l),"top-right":new o.pointGeometry(-l,l),bottom:new o.pointGeometry(0,-y),"bottom-left":new o.pointGeometry(l,-l),"bottom-right":new o.pointGeometry(-l,-l),left:new o.pointGeometry(y,0),right:new o.pointGeometry(-y,0)}}if(y instanceof o.pointGeometry||Array.isArray(y)){const l=o.pointGeometry.convert(y);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:o.pointGeometry.convert(y.center||[0,0]),top:o.pointGeometry.convert(y.top||[0,0]),"top-left":o.pointGeometry.convert(y["top-left"]||[0,0]),"top-right":o.pointGeometry.convert(y["top-right"]||[0,0]),bottom:o.pointGeometry.convert(y.bottom||[0,0]),"bottom-left":o.pointGeometry.convert(y["bottom-left"]||[0,0]),"bottom-right":o.pointGeometry.convert(y["bottom-right"]||[0,0]),left:o.pointGeometry.convert(y.left||[0,0]),right:o.pointGeometry.convert(y.right||[0,0])}}return tp(new o.pointGeometry(0,0))}const Ja={supported:f,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends hr{constructor(y){var l;if(o.PerformanceUtils.mark(o.PerformanceMarkers.create),(y=o.extend({},my,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new au(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._interactive=y.interactive,this._cooperativeGestures=y.cooperativeGestures,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new fy,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},py,y.locale),this._clickTolerance=y.clickTolerance,this._pixelRatio=(l=y.pixelRatio)!==null&&l!==void 0?l:devicePixelRatio,this._requestManager=new C(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new hy(this,y),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=y.hash&&new ty(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,o.extend({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new mu({customAttribution:y.customAttribution})),y.maplibreLogo&&this.addControl(new Md,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new o.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new o.Event(`${h.dataType}dataloading`,h))}),this.on("dataabort",h=>{this.fire(new o.Event("sourcedataabort",h))})}_getMapId(){return this._mapId}addControl(y,l){if(l===void 0&&(l=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=y.onAdd(this);this._controls.push(y);const g=this._controlPositions[l];return l.indexOf("bottom")!==-1?g.insertBefore(h,g.firstChild):g.appendChild(h),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(y);return l>-1&&this._controls.splice(l,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,l,h,g){return g==null&&this.style.terrain&&(g=this.transform.getElevation(h,this.style.terrain)),super.calculateCameraOptionsFromTo(y,l,h,g)}resize(y){const l=this._containerDimensions(),h=l[0],g=l[1];this._resizeCanvas(h,g,this.getPixelRatio()),this.transform.resize(h,g),this.painter.resize(h,g,this.getPixelRatio());const v=!this._moving;return v&&(this.stop(),this.fire(new o.Event("movestart",y)).fire(new o.Event("move",y))),this.fire(new o.Event("resize",y)),v&&this.fire(new o.Event("moveend",y)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(y){const[l,h]=this._containerDimensions();this._pixelRatio=y,this._resizeCanvas(l,h,y),this.painter.resize(l,h,y)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(o.LngLatBounds.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(o.LngLat.convert(y),this.style&&this.style.terrain)}unproject(y){return this.transform.pointLocation(o.pointGeometry.convert(y),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(y,l,h){if(y==="mouseenter"||y==="mouseover"){let g=!1;return{layer:l,listener:h,delegates:{mousemove:w=>{const A=this.getLayer(l)?this.queryRenderedFeatures(w.point,{layers:[l]}):[];A.length?g||(g=!0,h.call(this,new _s(y,this,w.originalEvent,{features:A}))):g=!1},mouseout:()=>{g=!1}}}}if(y==="mouseleave"||y==="mouseout"){let g=!1;return{layer:l,listener:h,delegates:{mousemove:A=>{(this.getLayer(l)?this.queryRenderedFeatures(A.point,{layers:[l]}):[]).length?g=!0:g&&(g=!1,h.call(this,new _s(y,this,A.originalEvent)))},mouseout:A=>{g&&(g=!1,h.call(this,new _s(y,this,A.originalEvent)))}}}}{const g=v=>{const w=this.getLayer(l)?this.queryRenderedFeatures(v.point,{layers:[l]}):[];w.length&&(v.features=w,h.call(this,v),delete v.features)};return{layer:l,listener:h,delegates:{[y]:g}}}}on(y,l,h){if(h===void 0)return super.on(y,l);const g=this._createDelegatedListener(y,l,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(g);for(const v in g.delegates)this.on(v,g.delegates[v]);return this}once(y,l,h){if(h===void 0)return super.once(y,l);const g=this._createDelegatedListener(y,l,h);for(const v in g.delegates)this.once(v,g.delegates[v]);return this}off(y,l,h){return h===void 0?super.off(y,l):(this._delegatedListeners&&this._delegatedListeners[y]&&(g=>{const v=this._delegatedListeners[y];for(let w=0;w<v.length;w++){const A=v[w];if(A.layer===l&&A.listener===h){for(const L in A.delegates)this.off(L,A.delegates[L]);return v.splice(w,1),this}}})(),this)}queryRenderedFeatures(y,l){if(!this.style)return[];let h;if(l!==void 0||y===void 0||y instanceof o.pointGeometry||Array.isArray(y)||(l=y,y=void 0),l=l||{},(y=y||[[0,0],[this.transform.width,this.transform.height]])instanceof o.pointGeometry||typeof y[0]=="number")h=[o.pointGeometry.convert(y)];else{const g=o.pointGeometry.convert(y[0]),v=o.pointGeometry.convert(y[1]);h=[g,new o.pointGeometry(v.x,g.y),v,new o.pointGeometry(g.x,v.y),g]}return this.style.queryRenderedFeatures(h,l,this.transform)}querySourceFeatures(y,l){return this.style.querySourceFeatures(y,l)}setStyle(y,l){return(l=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(y,l))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const l=this._locale[y];if(l==null)throw new Error(`Missing UI string '${y}'`);return l}_updateStyle(y,l){return this.style&&(this.style.setEventedParent(null),this.style._remove()),y?(this.style=new ii(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y):this.style.loadJSON(y),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ii(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,l){if(typeof y=="string"){const h=this._requestManager.transformRequest(y,o.ResourceType.Style);o.getJSON(h,(g,v)=>{g?this.fire(new o.ErrorEvent(g)):v&&this._updateDiff(v,l)})}else typeof y=="object"&&this._updateDiff(y,l)}_updateDiff(y,l){try{this.style.setState(y)&&this._update(!0)}catch(h){o.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(y,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")}addSource(y,l){return this._lazyInitEmptyStyle(),this.style.addSource(y,l),this._update(!0)}isSourceLoaded(y){const l=this.style&&this.style.sourceCaches[y];if(l!==void 0)return l.loaded();this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){return this.style.setTerrain(y),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const l in y){const h=y[l]._tiles;for(const g in h){const v=h[g];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}addSourceType(y,l,h){return this._lazyInitEmptyStyle(),this.style.addSourceType(y,l,h)}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,l,{pixelRatio:h=1,sdf:g=!1,stretchX:v,stretchY:w,content:A}={}){if(this._lazyInitEmptyStyle(),l instanceof HTMLImageElement||o.isImageBitmap(l)){const{width:L,height:$,data:O}=o.exported.getImageData(l);this.style.addImage(y,{data:new o.RGBAImage({width:L,height:$},O),pixelRatio:h,stretchX:v,stretchY:w,content:A,sdf:g,version:0})}else{if(l.width===void 0||l.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:L,height:$,data:O}=l,V=l;this.style.addImage(y,{data:new o.RGBAImage({width:L,height:$},new Uint8Array(O)),pixelRatio:h,stretchX:v,stretchY:w,content:A,sdf:g,version:0,userImage:V}),V.onAdd&&V.onAdd(this,y)}}}updateImage(y,l){const h=this.style.getImage(y);if(!h)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=l instanceof HTMLImageElement||o.isImageBitmap(l)?o.exported.getImageData(l):l,{width:v,height:w,data:A}=g;if(v===void 0||w===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==h.data.width||w!==h.data.height)return this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const L=!(l instanceof HTMLImageElement||o.isImageBitmap(l));h.data.replace(A,L),this.style.updateImage(y,h)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,l){o.getImage(this._requestManager.transformRequest(y,o.ResourceType.Image),l)}listImages(){return this.style.listImages()}addLayer(y,l){return this._lazyInitEmptyStyle(),this.style.addLayer(y,l),this._update(!0)}moveLayer(y,l){return this.style.moveLayer(y,l),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}setLayerZoomRange(y,l,h){return this.style.setLayerZoomRange(y,l,h),this._update(!0)}setFilter(y,l,h={}){return this.style.setFilter(y,l,h),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,l,h,g={}){return this.style.setPaintProperty(y,l,h,g),this._update(!0)}getPaintProperty(y,l){return this.style.getPaintProperty(y,l)}setLayoutProperty(y,l,h,g={}){return this.style.setLayoutProperty(y,l,h,g),this._update(!0)}getLayoutProperty(y,l){return this.style.getLayoutProperty(y,l)}setLight(y,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,l),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,l){return this.style.setFeatureState(y,l),this._update()}removeFeatureState(y,l){return this.style.removeFeatureState(y,l),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,l=0;return this._container&&(y=this._container.clientWidth||400,l=this._container.clientHeight||300),[y,l]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map","mapboxgl-map");const l=this._canvasContainer=T.create("div","maplibregl-canvas-container mapboxgl-canvas-container",y);this._interactive&&l.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=T.create("canvas","maplibregl-canvas mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const h=this._containerDimensions();this._resizeCanvas(h[0],h[1],this.getPixelRatio());const g=this._controlContainer=T.create("div","maplibregl-control-container mapboxgl-control-container",y),v=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{v[w]=T.create("div",`maplibregl-ctrl-${w} mapboxgl-ctrl-${w}`,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const y=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=T.create("div","maplibregl-cooperative-gesture-screen",y);let l="Control",h=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(h=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map",l="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${h}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",g=>{g.key===l&&(this._metaPress=!0)}),document.addEventListener("keyup",g=>{g.key===l&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",g=>{this._onCooperativeGesture(g,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(y,l,h){this._canvas.width=h*y,this._canvas.height=h*l,this._canvas.style.width=`${y}px`,this._canvas.style.height=`${l}px`}_setupPainter(){const y=o.extend({},f.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._canvas.getContext("webgl",y)||this._canvas.getContext("experimental-webgl",y);l?(this.painter=new jf(l,this.transform),o.exported$1.testSupport(l)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(y,l,h){return!l&&h<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){let l,h=0;const g=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(l=g.createQueryEXT(),g.beginQueryEXT(g.TIME_ELAPSED_EXT,l),h=o.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let v=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const A=this.transform.zoom,L=o.exported.now();this.style.zoomHistory.update(A,L);const $=new o.EvaluationParameters(A,{now:L,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),O=$.crossFadingFactor();O===1&&O===this._crossFadingFactor||(v=!0,this._crossFadingFactor=O),this.style.update($)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.load),this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||v)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const A=o.exported.now()-h;g.endQueryEXT(g.TIME_ELAPSED_EXT,l),setTimeout(()=>{const L=g.getQueryObjectEXT(l,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(l),this.fire(new o.Event("gpu-timing-frame",{cpuTime:A,gpuTime:L}))},50)}if(this.listens("gpu-timing-layer")){const A=this.painter.collectGpuTimers();setTimeout(()=>{const L=this.painter.queryGpuTimers(A);this.fire(new o.Event("gpu-timing-layer",{layerTimes:L}))},50)}const w=this._sourcesDirty||this._styleDirty||this._placementDirty;return w||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||w||(this._fullyLoaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),T.remove(this._canvasContainer),T.remove(this._controlContainer),this._cooperativeGestures&&T.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),o.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=o.exported.frame(y=>{o.PerformanceUtils.frame(y),this._frame=null,this._render(y)}))}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}_setCacheLimits(y,l){o.setCacheLimits(y,l)}get version(){return"2.4.0"}},NavigationControl:class{constructor(y){this.options=o.extend({},Jb,y),this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),T.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),T.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=T.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map.getZoom(),l=y===this._map.getMaxZoom(),h=y===this._map.getMinZoom();this._zoomInButton.disabled=l,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",l.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())}_rotateCompassArrow(){const y=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=y}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Po(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){T.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,l){const h=T.create("button",y,this._container);return h.type="button",h.addEventListener("click",l),h}_setButtonTitle(y,l){const h=this._map._getUIString(`NavigationControl.${l}`);y.title=h,y.setAttribute("aria-label",h)}},GeolocateControl:class extends o.Evented{constructor(y){super(),this.options=o.extend({},ep,y),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(y){var l;return this._map=y,this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,wa!==void 0?l(wa):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(h=>{wa=h.state!=="denied",l(wa)}):(wa=!!window.navigator.geolocation,l(wa)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),T.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ei=0,Ea=!1}_isOutOfMapMaxBounds(y){const l=this._map.getMaxBounds(),h=y.coords;return l&&(h.longitude<l.getWest()||h.longitude>l.getEast()||h.latitude<l.getSouth()||h.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",y)),this._finish()}}_updateCamera(y){const l=new o.LngLat(y.coords.longitude,y.coords.latitude),h=y.coords.accuracy,g=this._map.getBearing(),v=o.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(h),v,{geolocateSource:!0})}_updateMarker(y){if(y){const l=new o.LngLat(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map._container.clientHeight/2,l=this._map.unproject([0,y]),h=this._map.unproject([1,y]),g=l.distanceTo(h),v=Math.ceil(2*this._accuracy/g);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&Ea)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=T.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),T.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=T.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new ec(this._dotElement),this._circleElement=T.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ec({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l.originalEvent&&l.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ei--,Ea=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ei++,Ei>1?(y={maximumAge:6e5,timeout:0},Ea=!0):(y=this.options.positionOptions,Ea=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:mu,LogoControl:Md,ScaleControl:class{constructor(y){this.options=o.extend({},Co,y),o.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){gy(this._map,this._container,this.options)}onAdd(y){return this._map=y,this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){T.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(y){this.options.unit=y,gy(this._map,this._container,this.options)}},FullscreenControl:class{constructor(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=T.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){T.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=T.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);T.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(y){this.options=y,o.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(y){return this._map=y,this._container=T.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=T.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),T.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){T.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends o.Evented{constructor(y){super(),this.options=o.extend(Object.create(kr),y),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&T.remove(this._content),this._container&&(T.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=o.LngLat.convert(y),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const l=document.createDocumentFragment(),h=document.createElement("body");let g;for(h.innerHTML=y;g=h.firstChild,g;)l.appendChild(g);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=T.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){this._container&&this._container.classList.add(y)}removeClassName(y){this._container&&this._container.classList.remove(y)}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}_createCloseButton(){this.options.closeButton&&(this._closeButton=T.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(y){this._update(y.point)}_onMouseMove(y){this._update(y.point)}_onDrag(y){this._update(y.point)}_update(y){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=T.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=T.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(w=>this._container.classList.add(w)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=gu(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!y))return;const l=this._pos=this._trackPointer&&y?y:this._map.project(this._lngLat);let h=this.options.anchor;const g=tp(this.options.offset);if(!h){const w=this._container.offsetWidth,A=this._container.offsetHeight;let L;L=l.y+g.bottom.y<A?["top"]:l.y>this._map.transform.height-A?["bottom"]:[],l.x<w/2?L.push("left"):l.x>this._map.transform.width-w/2&&L.push("right"),h=L.length===0?"bottom":L.join("-")}const v=l.add(g[h]).round();T.setTransform(this._container,`${Ft[h]} translate(${v.x}px,${v.y}px)`),qt(this._container,h,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(Xr);y&&y.focus()}_onClose(){this.remove()}},Marker:ec,Style:ii,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,AJAXError:o.AJAXError,config:o.config,CanvasSource:kt,GeoJSONSource:an,ImageSource:It,RasterDEMTileSource:mt,RasterTileSource:Be,VectorTileSource:we,VideoSource:at,prewarm:function(){Hn().acquire(Et)},clearPrewarmedResources:function(){const y=Mr;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(Et),Mr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return Dt.workerCount},set workerCount(y){Dt.workerCount=y},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){o.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){o.clearTileCache(y)},workerUrl:"",addProtocol(y,l){o.config.REGISTERED_PROTOCOLS[y]=l},removeProtocol(y){delete o.config.REGISTERED_PROTOCOLS[y]}};return ks.extend(Ja,{isSafari:o.isSafari,getPerformanceMetrics:o.PerformanceUtils.getPerformanceMetrics}),Ja});var c=i;return c})})(c0e);const u0e=IE,d0e=Lz({key:"mapview",default:{latitude:0,longitude:0,zoom:0},dangerouslyAllowMutability:!0}),DR=Lz({key:"selectedGroup",default:null});function d9(t,e,n){if(t!==null)for(var r,i,s,c,o,f,m,x=0,S=0,T,C=t.type,R=C==="FeatureCollection",D=C==="Feature",H=R?t.features.length:1,F=0;F<H;F++){m=R?t.features[F].geometry:D?t.geometry:t,T=m?m.type==="GeometryCollection":!1,o=T?m.geometries.length:1;for(var k=0;k<o;k++){var N=0,U=0;if(c=T?m.geometries[k]:m,c!==null){f=c.coordinates;var ie=c.type;switch(x=n&&(ie==="Polygon"||ie==="MultiPolygon")?1:0,ie){case null:break;case"Point":if(e(f,S,F,N,U)===!1)return!1;S++,N++;break;case"LineString":case"MultiPoint":for(r=0;r<f.length;r++){if(e(f[r],S,F,N,U)===!1)return!1;S++,ie==="MultiPoint"&&N++}ie==="LineString"&&N++;break;case"Polygon":case"MultiLineString":for(r=0;r<f.length;r++){for(i=0;i<f[r].length-x;i++){if(e(f[r][i],S,F,N,U)===!1)return!1;S++}ie==="MultiLineString"&&N++,ie==="Polygon"&&U++}ie==="Polygon"&&N++;break;case"MultiPolygon":for(r=0;r<f.length;r++){for(U=0,i=0;i<f[r].length;i++){for(s=0;s<f[r][i].length-x;s++){if(e(f[r][i][s],S,F,N,U)===!1)return!1;S++}U++}N++}break;case"GeometryCollection":for(r=0;r<c.geometries.length;r++)if(d9(c.geometries[r],e,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function fv(t){var e=[1/0,1/0,-1/0,-1/0];return d9(t,function(n){e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),e[2]<n[0]&&(e[2]=n[0]),e[3]<n[1]&&(e[3]=n[1])}),e}fv.default=fv;const h9=hd({key:"convexHulls",get:async()=>await fetch("/data/groupRegions.geojson").then(t=>t.json())}),FR=hd({key:"users",get:async()=>await fetch("/data/usersAssignments.geojson").then(t=>t.json())}),zR=hd({key:"meetinPoints",get:async()=>await fetch("/data/groupMeetingPoints.geojson").then(t=>t.json())}),h0e=hd({key:"bounds",get:async({get:t})=>{let e=t(FR);return fv(e)}}),f9=hd({key:"groupIds",get:({get:t})=>t(zR).features.map(n=>n.properties.label)}),f0e=hd({key:"maxMinLabels",get:({get:t})=>{const e=t(f9);return[Math.min(...e),Math.max(...e)]}}),p9=hd({key:"selectedGroupDetails",get:({get:t})=>{const e=t(DR),n=t(h9),r=t(FR),i=t(zR);if(e===null)return null;const s=n.features.find(f=>f.properties.label===e),c=r.features.filter(f=>f.properties.label===e),o=i.features.find(f=>f.properties.label===e);return{users:c.map(f=>f.properties),selectedGroup:s.properties,selectedMeetingPoint:o.properties,bounds:fv(s)}}}),p0e=()=>{const t=_c(h9),e=_c(FR),n=_c(zR),[r,i]=B2(DR),s=_c(p9),c=_c(h0e),[o,f]=B2(d0e),m=_c(f0e),x=new Tm({id:"hulls",data:t,getFillColor:[0,0,0,0],getLineColor:C=>[255,0,0],getLineWidth:4,lineWidthUnits:"pixels",getFilterValue:C=>C.properties.label,filterRange:r?[r-.1,r+.1]:m,extensions:[new Am({filterSize:1})],pickable:!0,onClick:C=>{console.log("Click info is",C),i(C.object.properties.label)}}),S=new Tm({id:"users",data:e,getRadius:2,getColor:[100,100,100],pointRadiusUnits:"pixels",getFilterValue:C=>C.properties.label,filterRange:r?[r-.1,r+.1]:m,extensions:[new Am({filterSize:1})]}),T=new Tm({id:"users",data:n,getRadius:5,getFillColor:[0,255,0],pointRadiusUnits:"pixels",getFilterValue:C=>C.properties.label,filterRange:r?[r-.1,r+.1]:m,extensions:[new Am({filterSize:1})]});return ee.useEffect(()=>{let C=s!==null?s.bounds:c;if(s!==null){let D=new ed(o).fitBounds(C);f(D)}},[s,c]),lr.jsx(gme,{layers:[x,S,T],initialViewState:o,onViewStateChange:({viewState:C})=>{f(C)},style:{width:"100%",height:"100%"},controller:!0,children:lr.jsx(jL,{mapLib:u0e,mapStyle:"https://api.maptiler.com/maps/topo-v2/style.json?key=32rtUQVfWVrA5316PfSR",children:lr.jsx(ine,{position:"top-left"})})})};function Cr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m9(t){return null}m9.getCollectionNode=function*(e,n){let{childItems:r,title:i,children:s}=e,c=e.title||e.children,o=e.textValue||(typeof c=="string"?c:"")||e["aria-label"]||"";!o&&!(n!=null&&n.suppressTextValueWarning)&&console.warn("<Item> with non-plain text contents is unsupported by type to select for accessibility. Please add a `textValue` prop."),yield{type:"item",props:e,rendered:c,textValue:o,"aria-label":e["aria-label"],hasChildNodes:m0e(e),*childNodes(){if(r)for(let f of r)yield{type:"item",value:f};else if(i){let f=[];ce.Children.forEach(s,m=>{f.push({type:"item",element:m})}),yield*f}}}};function m0e(t){return t.hasChildItems!=null?t.hasChildItems:!!(t.childItems||t.title&&ce.Children.count(t.children)>0)}let g9=m9;class g0e{build(e,n){return this.context=n,yO(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:n,items:r}=e;if(typeof n=="function"){if(!r)throw new Error("props.children was a function but props.items is missing");for(let i of e.items)yield*this.getFullNode({value:i},{renderer:n})}else{let i=[];ce.Children.forEach(n,c=>{i.push(c)});let s=0;for(let c of i){let o=this.getFullNode({element:c,index:s},{});for(let f of o)s++,yield f}}}getKey(e,n,r,i){if(e.key!=null)return e.key;if(n.type==="cell"&&n.key!=null)return`${i}${n.key}`;let s=n.value;if(s!=null){var c;let o=(c=s.key)!==null&&c!==void 0?c:s.id;if(o==null)throw new Error("No key found for item");return o}return i?`${i}.${n.index}`:`$.${n.index}`}getChildState(e,n){return{renderer:n.renderer||e.renderer}}*getFullNode(e,n,r,i){let s=e.element;if(!s&&e.value&&n&&n.renderer){let f=this.cache.get(e.value);if(f&&(!f.shouldInvalidate||!f.shouldInvalidate(this.context))){f.index=e.index,f.parentKey=i?i.key:null,yield f;return}s=n.renderer(e.value)}if(ce.isValidElement(s)){let f=s.type;if(typeof f!="function"&&typeof f.getCollectionNode!="function"){let T=typeof s.type=="function"?s.type.name:s.type;throw new Error(`Unknown element <${T}> in collection.`)}let m=f.getCollectionNode(s.props,this.context),x=e.index,S=m.next();for(;!S.done&&S.value;){let T=S.value;e.index=x;let C=T.key;C||(C=T.element?null:this.getKey(s,e,n,r));let D=[...this.getFullNode({...T,key:C,index:x,wrapper:y0e(e.wrapper,T.wrapper)},this.getChildState(n,T),r?`${r}${s.key}`:s.key,i)];for(let H of D){if(H.value=T.value||e.value,H.value&&this.cache.set(H.value,H),e.type&&H.type!==e.type)throw new Error(`Unsupported type <${hw(H.type)}> in <${hw(i.type)}>. Only <${hw(e.type)}> is supported.`);x++,yield H}S=m.next(D)}return}if(e.key==null)return;let c=this,o={type:e.type,props:e.props,key:e.key,parentKey:i?i.key:null,value:e.value,level:i?i.level+1:0,index:e.index,rendered:e.rendered,textValue:e.textValue,"aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes,childNodes:yO(function*(){if(!e.hasChildNodes)return;let f=0;for(let m of e.childNodes()){m.key!=null&&(m.key=`${o.key}${m.key}`),m.index=f;let x=c.getFullNode(m,c.getChildState(n,m),o.key,o);for(let S of x)f++,yield S}})};yield o}constructor(){Cr(this,"cache",new WeakMap)}}function yO(t){let e=[],n=null;return{*[Symbol.iterator](){for(let r of e)yield r;n||(n=t());for(let r of n)e.push(r),yield r}}}function y0e(t,e){if(t&&e)return n=>t(e(n));if(t)return t;if(e)return e}function hw(t){return t[0].toUpperCase()+t.slice(1)}function _0e(t,e,n,r=[]){let i=ee.useMemo(()=>new g0e,[]),s=ee.useRef(null);return ee.useMemo(()=>{if(t.collection)return t.collection;let c=i.build(t,n);return s.current=e(c,s.current),s.current},[i,t.children,t.items,t.collection,n,...r])}function pf(t,e){return typeof e.getChildren=="function"?e.getChildren(t.key):t.childNodes}function v0e(t){return b0e(t,0)}function b0e(t,e){if(e<0)return;let n=0;for(let r of t){if(n===e)return r;n++}}function fw(t,e,n){if(e.parentKey===n.parentKey)return e.index-n.index;let r=_O(t,e),i=_O(t,n),s=r.slice(0,i.length).findIndex((c,o)=>c!==i[o]);return s!==-1?(e=r[s],n=i[s],e.index-n.index):-1}function _O(t,e){let n=[];for(;(e==null?void 0:e.parentKey)!=null;)e=t.getItem(e.parentKey),n.unshift(e);return n}const vO=new WeakMap;function y9(t){let e=vO.get(t);if(e!=null)return e;e=0;let n=r=>{for(let i of r)i.type==="section"?n(pf(i,t)):e++};return n(t),vO.set(t,e),e}function xb(t,e,n){let[r,i]=ee.useState(t||e),s=ee.useRef(t!==void 0),c=s.current,o=t!==void 0,f=ee.useRef(r);c!==o&&console.warn(`WARN: A component changed from ${c?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}.`),s.current=o;let m=ee.useCallback((x,...S)=>{let T=(C,...R)=>{n&&(Object.is(f.current,C)||n(C,...R)),o||(f.current=C)};typeof x=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),i((R,...D)=>{let H=x(o?f.current:R,...D);return T(H,...S),o?R:H})):(o||i(x),T(x,...S))},[o,n]);return o?f.current=t:t=r,[t,m]}function ig(t,e=-1/0,n=1/0){return Math.min(Math.max(t,e),n)}const _9={prefix:String(Math.round(Math.random()*1e10)),current:0,isSSR:!1},NR=ce.createContext(_9);let x0e=!!(typeof window<"u"&&window.document&&window.document.createElement),pw=new WeakMap;function w0e(t=!1){let e=ee.useContext(NR),n=ee.useRef(null);if(n.current===null&&!t){var r,i;let s=(r=ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||r===void 0||(i=r.ReactCurrentOwner)===null||i===void 0?void 0:i.current;if(s){let c=pw.get(s);c==null?pw.set(s,{id:e.current,state:s.memoizedState}):s.memoizedState!==c.state&&(e.current=c.id,pw.delete(s))}n.current=++e.current}return n.current}function E0e(t){let e=ee.useContext(NR);e===_9&&!x0e&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");let n=w0e(!!t);return t||`react-aria${e.prefix}-${n}`}function Sf(){return ee.useContext(NR).isSSR}function v9(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=v9(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function wb(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=v9(t))&&(r&&(r+=" "),r+=e);return r}const wr=typeof window<"u"?ce.useLayoutEffect:()=>{};function T0e(t){let[e,n]=ee.useState(t),r=ee.useRef(e),i=ee.useRef(null);r.current=e;let s=ee.useRef(null);s.current=()=>{let o=i.current.next();if(o.done){i.current=null;return}e===o.value?s.current():n(o.value)},wr(()=>{i.current&&s.current()});let c=ee.useCallback(o=>{i.current=o(r.current),s.current()},[i,s]);return[e,c]}let pv=new Map;function jo(t){let[e,n]=ee.useState(t),r=ee.useRef(null),i=E0e(e),s=ee.useCallback(c=>{r.current=c},[]);return pv.set(i,s),wr(()=>{let c=i;return()=>{pv.delete(c)}},[i]),ee.useEffect(()=>{let c=r.current;c&&(r.current=null,n(c))}),i}function S0e(t,e){if(t===e)return t;let n=pv.get(t);if(n)return n(e),e;let r=pv.get(e);return r?(r(t),t):e}function sg(t=[]){let e=jo(),[n,r]=T0e(e),i=ee.useCallback(()=>{r(function*(){yield e,yield document.getElementById(e)?e:void 0})},[e,r]);return wr(i,[e,i,...t]),n}function og(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}function kn(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let r=t[n];for(let i in r){let s=e[i],c=r[i];typeof s=="function"&&typeof c=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=og(s,c):(i==="className"||i==="UNSAFE_className")&&typeof s=="string"&&typeof c=="string"?e[i]=wb(s,c):i==="id"&&s&&c?e.id=S0e(s,c):e[i]=c!==void 0?c:s}}return e}const A0e=new Set(["id"]),P0e=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),C0e=/^(data-.*)$/;function ps(t,e={}){let{labelable:n,propNames:r}=e,i={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(A0e.has(s)||n&&P0e.has(s)||r!=null&&r.has(s)||C0e.test(s))&&(i[s]=t[s]);return i}function wl(t){if(I0e())t.focus({preventScroll:!0});else{let e=L0e(t);t.focus(),R0e(e)}}let R_=null;function I0e(){if(R_==null){R_=!1;try{var t=document.createElement("div");t.focus({get preventScroll(){return R_=!0,!0}})}catch{}}return R_}function L0e(t){for(var e=t.parentNode,n=[],r=document.scrollingElement||document.documentElement;e instanceof HTMLElement&&e!==r;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&n.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return r instanceof HTMLElement&&n.push({element:r,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}),n}function R0e(t){for(let{element:e,scrollTop:n,scrollLeft:r}of t)e.scrollTop=n,e.scrollLeft=r}let uh=new Map,LE=new Set;function bO(){if(typeof window>"u")return;let t=n=>{let r=uh.get(n.target);r||(r=new Set,uh.set(n.target,r),n.target.addEventListener("transitioncancel",e)),r.add(n.propertyName)},e=n=>{let r=uh.get(n.target);if(r&&(r.delete(n.propertyName),r.size===0&&(n.target.removeEventListener("transitioncancel",e),uh.delete(n.target)),uh.size===0)){for(let i of LE)i();LE.clear()}};document.body.addEventListener("transitionrun",t),document.body.addEventListener("transitionend",e)}typeof document<"u"&&(document.readyState!=="loading"?bO():document.addEventListener("DOMContentLoaded",bO));function b9(t){requestAnimationFrame(()=>{uh.size===0?t():LE.add(t)})}function x9(){let t=ee.useRef(new Map),e=ee.useCallback((i,s,c,o)=>{let f=o!=null&&o.once?(...m)=>{t.current.delete(c),c(...m)}:c;t.current.set(c,{type:s,eventTarget:i,fn:f,options:o}),i.addEventListener(s,c,o)},[]),n=ee.useCallback((i,s,c,o)=>{var f;let m=((f=t.current.get(c))===null||f===void 0?void 0:f.fn)||c;i.removeEventListener(s,m,o),t.current.delete(c)},[]),r=ee.useCallback(()=>{t.current.forEach((i,s)=>{n(i.eventTarget,i.type,s,i.options)})},[n]);return ee.useEffect(()=>r,[r]),{addGlobalListener:e,removeGlobalListener:n,removeAllGlobalListeners:r}}function mv(t,e){let{id:n,"aria-label":r,"aria-labelledby":i}=t;return n=jo(n),i&&r?i=[...new Set([...i.trim().split(/\s+/),n])].join(" "):i&&(i=i.trim().split(/\s+/).join(" ")),!r&&!i&&e&&(r=e),{id:n,"aria-label":r,"aria-labelledby":i}}function $0e(){return typeof window.ResizeObserver<"u"}function BR(t){const{ref:e,onResize:n}=t;ee.useEffect(()=>{let r=e==null?void 0:e.current;if(r)if($0e()){const i=new window.ResizeObserver(s=>{s.length&&n()});return i.observe(r),()=>{r&&i.unobserve(r)}}else return window.addEventListener("resize",n,!1),()=>{window.removeEventListener("resize",n,!1)}},[n,e])}function UR(t,e){wr(()=>{if(t&&t.ref&&e)return t.ref.current=e.current,()=>{t.ref.current=null}},[t,e])}function gv(t){for(xO(t)&&(t=t.parentElement);t&&!xO(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}function xO(t){let e=window.getComputedStyle(t);return/(auto|scroll)/.test(e.overflow+e.overflowX+e.overflowY)}let Oa=typeof window<"u"&&window.visualViewport;function M0e(){let[t,e]=ee.useState(()=>wO());return ee.useEffect(()=>{let n=()=>{e(r=>{let i=wO();return i.width===r.width&&i.height===r.height?r:i})};return Oa?Oa.addEventListener("resize",n):window.addEventListener("resize",n),()=>{Oa?Oa.removeEventListener("resize",n):window.removeEventListener("resize",n)}},[]),t}function wO(){return{width:(Oa==null?void 0:Oa.width)||window.innerWidth,height:(Oa==null?void 0:Oa.height)||window.innerHeight}}let k0e=0;const mw=new Map;function O0e(t){let[e,n]=ee.useState(void 0);return wr(()=>{if(!t)return;let r=mw.get(t);if(r)n(r.element.id);else{let i=`react-aria-description-${k0e++}`;n(i);let s=document.createElement("div");s.id=i,s.style.display="none",s.textContent=t,document.body.appendChild(s),r={refCount:0,element:s},mw.set(t,r)}return r.refCount++,()=>{--r.refCount===0&&(r.element.remove(),mw.delete(t))}},[t]),{"aria-describedby":t?e:void 0}}function VR(t){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(n=>t.test(n.brand)))||t.test(window.navigator.userAgent)}function GR(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function Og(){return GR(/^Mac/i)}function D0e(){return GR(/^iPhone/i)}function F0e(){return GR(/^iPad/i)||Og()&&navigator.maxTouchPoints>1}function Eb(){return D0e()||F0e()}function p0(){return Og()||Eb()}function z0e(){return VR(/AppleWebKit/i)&&!N0e()}function N0e(){return VR(/Chrome/i)}function B0e(){return VR(/Android/i)}function U0e(t,e,n,r){let i=ee.useRef(n);i.current=n;let s=n==null;ee.useEffect(()=>{if(s)return;let c=t.current,o=f=>i.current.call(this,f);return c.addEventListener(e,o,r),()=>{c.removeEventListener(e,o,r)}},[t,e,r,s])}function RE(t,e){let n=EO(t,e,"left"),r=EO(t,e,"top"),i=e.offsetWidth,s=e.offsetHeight,c=t.scrollLeft,o=t.scrollTop,{borderTopWidth:f,borderLeftWidth:m}=getComputedStyle(t),x=t.scrollLeft+parseInt(m,10),S=t.scrollTop+parseInt(f,10),T=x+t.clientWidth,C=S+t.clientHeight;n<=c?c=n-parseInt(m,10):n+i>T&&(c+=n+i-T),r<=S?o=r-parseInt(f,10):r+s>C&&(o+=r+s-C),t.scrollLeft=c,t.scrollTop=o}function EO(t,e,n){const r=n==="left"?"offsetLeft":"offsetTop";let i=0;for(;e.offsetParent&&(i+=e[r],e.offsetParent!==t);){if(e.offsetParent.contains(t)){i-=t[r];break}e=e.offsetParent}return i}function w9(t,e){if(document.contains(t)){let c=document.scrollingElement||document.documentElement;if(window.getComputedStyle(c).overflow==="hidden"){let f=gv(t);for(;t&&f&&t!==c&&f!==c;)RE(f,t),t=f,f=gv(t)}else{var n;let{left:f,top:m}=t.getBoundingClientRect();t==null||(n=t.scrollIntoView)===null||n===void 0||n.call(t,{block:"nearest"});let{left:x,top:S}=t.getBoundingClientRect();if(Math.abs(f-x)>1||Math.abs(m-S)>1){var r,i,s;e==null||(r=e.containingElement)===null||r===void 0||(i=r.scrollIntoView)===null||i===void 0||i.call(r,{block:"center",inline:"center"}),(s=t.scrollIntoView)===null||s===void 0||s.call(t,{block:"nearest"})}}}}function $E(t){return t.mozInputSource===0&&t.isTrusted?!0:B0e()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function V0e(t){return t.width===0&&t.height===0||t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType==="mouse"}class G0e{getStringForLocale(e,n){let r=this.strings[n];r||(r=j0e(n,this.strings,this.defaultLocale),this.strings[n]=r);let i=r[e];if(!i)throw new Error(`Could not find intl message ${e} in ${n} locale`);return i}constructor(e,n="en-US"){this.strings={...e},this.defaultLocale=n}}function j0e(t,e,n="en-US"){if(e[t])return e[t];let r=H0e(t);if(e[r])return e[r];for(let i in e)if(i.startsWith(r+"-"))return e[i];return e[n]}function H0e(t){return Intl.Locale?new Intl.Locale(t).language:t.split("-")[0]}const TO=new Map,SO=new Map;class W0e{format(e,n){let r=this.strings.getStringForLocale(e,this.locale);return typeof r=="function"?r(n,this):r}plural(e,n,r="cardinal"){let i=n["="+e];if(i)return typeof i=="function"?i():i;let s=this.locale+":"+r,c=TO.get(s);c||(c=new Intl.PluralRules(this.locale,{type:r}),TO.set(s,c));let o=c.select(e);return i=n[o]||n.other,typeof i=="function"?i():i}number(e){let n=SO.get(this.locale);return n||(n=new Intl.NumberFormat(this.locale),SO.set(this.locale,n)),n.format(e)}select(e,n){let r=e[n]||e.other;return typeof r=="function"?r():r}constructor(e,n){this.locale=e,this.strings=n}}let gw=new Map,ME=!1;try{ME=new Intl.NumberFormat("de-DE",{signDisplay:"exceptZero"}).resolvedOptions().signDisplay==="exceptZero"}catch{}let yv=!1;try{yv=new Intl.NumberFormat("de-DE",{style:"unit",unit:"degree"}).resolvedOptions().style==="unit"}catch{}const E9={degree:{narrow:{default:"°","ja-JP":" 度","zh-TW":"度","sl-SI":" °"}}};class K0e{format(e){let n="";if(!ME&&this.options.signDisplay!=null?n=X0e(this.numberFormatter,this.options.signDisplay,e):n=this.numberFormatter.format(e),this.options.style==="unit"&&!yv){var r;let{unit:i,unitDisplay:s="short",locale:c}=this.resolvedOptions(),o=(r=E9[i])===null||r===void 0?void 0:r[s];n+=o[c]||o.default}return n}formatToParts(e){return this.numberFormatter.formatToParts(e)}formatRange(e,n){if(typeof this.numberFormatter.formatRange=="function")return this.numberFormatter.formatRange(e,n);if(n<e)throw new RangeError("End date must be >= start date");return`${this.format(e)} – ${this.format(n)}`}formatRangeToParts(e,n){if(typeof this.numberFormatter.formatRangeToParts=="function")return this.numberFormatter.formatRangeToParts(e,n);if(n<e)throw new RangeError("End date must be >= start date");let r=this.numberFormatter.formatToParts(e),i=this.numberFormatter.formatToParts(n);return[...r.map(s=>({...s,source:"startRange"})),{type:"literal",value:" – ",source:"shared"},...i.map(s=>({...s,source:"endRange"}))]}resolvedOptions(){let e=this.numberFormatter.resolvedOptions();return!ME&&this.options.signDisplay!=null&&(e={...e,signDisplay:this.options.signDisplay}),!yv&&this.options.style==="unit"&&(e={...e,style:"unit",unit:this.options.unit,unitDisplay:this.options.unitDisplay}),e}constructor(e,n={}){this.numberFormatter=q0e(e,n),this.options=n}}function q0e(t,e={}){let{numberingSystem:n}=e;if(n&&t.indexOf("-u-nu-")===-1&&(t=`${t}-u-nu-${n}`),e.style==="unit"&&!yv){var r;let{unit:c,unitDisplay:o="short"}=e;if(!c)throw new Error('unit option must be provided with style: "unit"');if(!(!((r=E9[c])===null||r===void 0)&&r[o]))throw new Error(`Unsupported unit ${c} with unitDisplay = ${o}`);e={...e,style:"decimal"}}let i=t+(e?Object.entries(e).sort((c,o)=>c[0]<o[0]?-1:1).join():"");if(gw.has(i))return gw.get(i);let s=new Intl.NumberFormat(t,e);return gw.set(i,s),s}function X0e(t,e,n){if(e==="auto")return t.format(n);if(e==="never")return t.format(Math.abs(n));{let r=!1;if(e==="always"?r=n>0||Object.is(n,0):e==="exceptZero"&&(Object.is(n,-0)||Object.is(n,0)?n=Math.abs(n):r=n>0),r){let i=t.format(-n),s=t.format(n),c=i.replace(s,"").replace(/\u200e|\u061C/,"");return[...c].length!==1&&console.warn("@react-aria/i18n polyfill for NumberFormat signDisplay: Unsupported case"),i.replace(s,"!!!").replace(c,"+").replace("!!!",s)}else return t.format(n)}}const Z0e=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),Y0e=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function T9(t){if(Intl.Locale){let n=new Intl.Locale(t).maximize().script;return Z0e.has(n)}let e=t.split("-")[0];return Y0e.has(e)}function S9(){let t=typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([t])}catch{t="en-US"}return{locale:t,direction:T9(t)?"rtl":"ltr"}}let kE=S9(),om=new Set;function AO(){kE=S9();for(let t of om)t(kE)}function A9(){let t=Sf(),[e,n]=ee.useState(kE);return ee.useEffect(()=>(om.size===0&&window.addEventListener("languagechange",AO),om.add(n),()=>{om.delete(n),om.size===0&&window.removeEventListener("languagechange",AO)}),[]),t?{locale:"en-US",direction:"ltr"}:e}const P9=ce.createContext(null);function J0e(t){let{locale:e,children:n}=t,r=A9(),i=e?{locale:e,direction:T9(e)?"rtl":"ltr"}:r;return ce.createElement(P9.Provider,{value:i},n)}function pa(){let t=A9();return ee.useContext(P9)||t}const PO=new WeakMap;function Q0e(t){let e=PO.get(t);return e||(e=new G0e(t),PO.set(t,e)),e}function Nl(t){let{locale:e}=pa(),n=ee.useMemo(()=>Q0e(t),[t]);return ee.useMemo(()=>new W0e(e,n),[e,n])}function eve(t={}){let{locale:e}=pa();return ee.useMemo(()=>new K0e(e,t),[e,t])}let yw=new Map;function jR(t){let{locale:e}=pa(),n=e+(t?Object.entries(t).sort((i,s)=>i[0]<s[0]?-1:1).join():"");if(yw.has(n))return yw.get(n);let r=new Intl.Collator(e,t);return yw.set(n,r),r}function C9(t){let e=jR({usage:"search",...t}),n=ee.useCallback((s,c)=>c.length===0?!0:(s=s.normalize("NFC"),c=c.normalize("NFC"),e.compare(s.slice(0,c.length),c)===0),[e]),r=ee.useCallback((s,c)=>c.length===0?!0:(s=s.normalize("NFC"),c=c.normalize("NFC"),e.compare(s.slice(-c.length),c)===0),[e]),i=ee.useCallback((s,c)=>{if(c.length===0)return!0;s=s.normalize("NFC"),c=c.normalize("NFC");let o=0,f=c.length;for(;o+f<=s.length;o++){let m=s.slice(o,o+f);if(e.compare(c,m)===0)return!0}return!1},[e]);return ee.useMemo(()=>({startsWith:n,endsWith:r,contains:i}),[n,r,i])}let $_=!1;function st(t,...e){let n=[];for(let r of e)if(typeof r=="object"&&r){let i={};for(let s in r)t[s]&&(i[t[s]]=r[s]),t[s]||(i[s]=r[s]);n.push(i)}else typeof r=="string"?(t[r]&&n.push(t[r]),t[r]||n.push(r)):n.push(r);return wb(...n)}function OE(t){let e=typeof window<"u"&&typeof window.matchMedia=="function",[n,r]=ee.useState(()=>e?window.matchMedia(t).matches:!1);return ee.useEffect(()=>{if(!e)return;let s=window.matchMedia(t),c=o=>{r(o.matches)};return s.addListener(c),()=>{s.removeListener(c)}},[e,t]),Sf()?!1:n}function I9(t){return{UNSAFE_getDOMNode(){return t.current}}}function L9(t,e=t){return{...I9(t),focus(){e.current&&e.current.focus()}}}function ma(t){let e=ee.useRef(null);return ee.useImperativeHandle(t,()=>I9(e)),e}function Dg(t,e){let n=ee.useRef(null);return ee.useImperativeHandle(t,()=>L9(n,e)),n}function R9(t){return{get current(){return t.current&&t.current.UNSAFE_getDOMNode()}}}function CO(t){return ee.useMemo(()=>R9(t),[t])}const HR=ce.createContext(null);HR.displayName="BreakpointContext";function tve(t){let{children:e,matchedBreakpoints:n}=t;return ce.createElement(HR.Provider,{value:{matchedBreakpoints:n}},e)}function nve(t){let e=Object.entries(t).sort(([,f],[,m])=>m-f),n=e.map(([,f])=>`(min-width: ${f}px)`),r=typeof window<"u"&&typeof window.matchMedia=="function",i=()=>{let f=[];for(let m in n){let x=n[m];window.matchMedia(x).matches&&f.push(e[m][0])}return f.push("base"),f},[s,c]=ee.useState(()=>r?i():["base"]);return ee.useEffect(()=>{if(!r)return;let f=()=>{const m=i();c(x=>x.length!==m.length||x.some((S,T)=>S!==m[T])?[...m]:x)};return window.addEventListener("resize",f),()=>{window.removeEventListener("resize",f)}},[r]),Sf()?["base"]:s}function $9(){return ee.useContext(HR)}const Tb={margin:["margin",Gn],marginStart:[zs("marginLeft","marginRight"),Gn],marginEnd:[zs("marginRight","marginLeft"),Gn],marginTop:["marginTop",Gn],marginBottom:["marginBottom",Gn],marginX:[["marginLeft","marginRight"],Gn],marginY:[["marginTop","marginBottom"],Gn],width:["width",Gn],height:["height",Gn],minWidth:["minWidth",Gn],minHeight:["minHeight",Gn],maxWidth:["maxWidth",Gn],maxHeight:["maxHeight",Gn],isHidden:["display",ave],alignSelf:["alignSelf",Pi],justifySelf:["justifySelf",Pi],position:["position",_w],zIndex:["zIndex",_w],top:["top",Gn],bottom:["bottom",Gn],start:[zs("left","right"),Gn],end:[zs("right","left"),Gn],left:["left",Gn],right:["right",Gn],order:["order",_w],flex:["flex",lve],flexGrow:["flexGrow",Pi],flexShrink:["flexShrink",Pi],flexBasis:["flexBasis",Pi],gridArea:["gridArea",Pi],gridColumn:["gridColumn",Pi],gridColumnEnd:["gridColumnEnd",Pi],gridColumnStart:["gridColumnStart",Pi],gridRow:["gridRow",Pi],gridRowEnd:["gridRowEnd",Pi],gridRowStart:["gridRowStart",Pi]};({...Tb,borderStartWidth:zs("borderLeftWidth","borderRightWidth"),borderEndWidth:zs("borderRightWidth","borderLeftWidth"),borderStartColor:zs("borderLeftColor","borderRightColor"),borderEndColor:zs("borderRightColor","borderLeftColor"),borderTopStartRadius:zs("borderTopLeftRadius","borderTopRightRadius"),borderTopEndRadius:zs("borderTopRightRadius","borderTopLeftRadius"),borderBottomStartRadius:zs("borderBottomLeftRadius","borderBottomRightRadius"),borderBottomEndRadius:zs("borderBottomRightRadius","borderBottomLeftRadius"),paddingStart:zs("paddingLeft","paddingRight"),paddingEnd:zs("paddingRight","paddingLeft")});const IO={borderWidth:"borderStyle",borderLeftWidth:"borderLeftStyle",borderRightWidth:"borderRightStyle",borderTopWidth:"borderTopStyle",borderBottomWidth:"borderBottomStyle"};function zs(t,e){return n=>n==="rtl"?e:t}const rve=/(%|px|em|rem|vw|vh|auto|cm|mm|in|pt|pc|ex|ch|rem|vmin|vmax|fr)$/,ive=/^\s*\w+\(/,sve=/(static-)?size-\d+|single-line-(height|width)/g;function Gn(t){return typeof t=="number"?t+"px":rve.test(t)?t:ive.test(t)?t.replace(sve,"var(--spectrum-global-dimension-$&, var(--spectrum-alias-$&))"):`var(--spectrum-global-dimension-${t}, var(--spectrum-alias-${t}))`}function rh(t,e){return t=WR(t,e),Gn(t)}function M9(t,e="default",n=5){return n>5?`var(--spectrum-${t}, var(--spectrum-semantic-${t}-color-${e}))`:`var(--spectrum-legacy-color-${t}, var(--spectrum-global-color-${t}, var(--spectrum-semantic-${t}-color-${e})))`}function ove(t,e=5){return`var(--spectrum-alias-background-color-${t}, ${M9(t,"background",e)})`}function ul(t,e=5){return t==="default"?"var(--spectrum-alias-border-color)":`var(--spectrum-alias-border-color-${t}, ${M9(t,"border",e)})`}function dl(t){return`var(--spectrum-alias-border-size-${t})`}function hl(t){return`var(--spectrum-alias-border-radius-${t})`}function ave(t){return t?"none":void 0}function _w(t){return t}function lve(t){return typeof t=="boolean"?t?"1":void 0:""+t}function cve(t,e,n,r){let i={};for(let s in t){let c=e[s];if(!c||t[s]==null)continue;let[o,f]=c;typeof o=="function"&&(o=o(n));let m=WR(t[s],r),x=f(m,t.colorVersion);if(Array.isArray(o))for(let S of o)i[S]=x;else i[o]=x}for(let s in IO)i[s]&&(i[IO[s]]="solid",i.boxSizing="border-box");return i}function Ni(t,e=Tb,n={}){let{UNSAFE_className:r,UNSAFE_style:i,...s}=t,c=$9(),{direction:o}=pa(),{matchedBreakpoints:f=(c==null?void 0:c.matchedBreakpoints)||["base"]}=n,m=cve(t,e,o,f),x={...i,...m};s.className&&console.warn("The className prop is unsafe and is unsupported in React Spectrum v3. Please use style props with Spectrum variables, or UNSAFE_className if you absolutely must do something custom. Note that this may break in future versions due to DOM structure changes."),s.style&&console.warn("The style prop is unsafe and is unsupported in React Spectrum v3. Please use style props with Spectrum variables, or UNSAFE_style if you absolutely must do something custom. Note that this may break in future versions due to DOM structure changes.");let S={style:x,className:r};return WR(t.isHidden,f)&&(S.hidden=!0),{styleProps:S}}function Pi(t){return t}function WR(t,e){if(t&&typeof t=="object"&&!Array.isArray(t)){for(let n=0;n<e.length;n++){let r=e[n];if(t[r]!=null)return t[r]}return t.base}return t}let _v=ce.createContext(null);function Fg(t,e){let n=t.slot||e,{[n]:r={}}=ee.useContext(_v)||{};return kn(t,kn(r,{id:t.id}))}function Sb(t){let e=ee.useContext(_v)||{},{slots:n={},children:r}=t,i=ee.useMemo(()=>Object.keys(e).concat(Object.keys(n)).reduce((s,c)=>({...s,[c]:kn(e[c]||{},n[c]||{})}),{}),[e,n]);return ce.createElement(_v.Provider,{value:i},r)}function k9(t){let{children:e,...n}=t,r=e;return ce.Children.toArray(e).length<=1&&typeof e=="function"&&(r=ce.cloneElement(ce.Children.only(e),n)),ce.createElement(_v.Provider,{value:{}},r)}const uve=700;function dve(){return Sf()||typeof window>"u"?!1:window.screen.width<=uve}let Lh="default",DE="",m0=new WeakMap;function LO(t){Eb()?(Lh==="default"&&(DE=document.documentElement.style.webkitUserSelect,document.documentElement.style.webkitUserSelect="none"),Lh="disabled"):(t instanceof HTMLElement||t instanceof SVGElement)&&(m0.set(t,t.style.userSelect),t.style.userSelect="none")}function M_(t){if(Eb()){if(Lh!=="disabled")return;Lh="restoring",setTimeout(()=>{b9(()=>{Lh==="restoring"&&(document.documentElement.style.webkitUserSelect==="none"&&(document.documentElement.style.webkitUserSelect=DE||""),DE="",Lh="default")})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&m0.has(t)){let e=m0.get(t);t.style.userSelect==="none"&&(t.style.userSelect=e),t.getAttribute("style")===""&&t.removeAttribute("style"),m0.delete(t)}}const vv=ce.createContext(null);vv.displayName="PressResponderContext";function hve(t){let e=ee.useContext(vv);if(e){let{register:n,...r}=e;t=kn(r,t),n()}return UR(e,t.ref),t}function KR(t){let{onPress:e,onPressChange:n,onPressStart:r,onPressEnd:i,onPressUp:s,isDisabled:c,isPressed:o,preventFocusOnPress:f,shouldCancelOnPointerExit:m,allowTextSelectionOnPress:x,ref:S,...T}=hve(t),C=ee.useRef(null);C.current={onPress:e,onPressChange:n,onPressStart:r,onPressEnd:i,onPressUp:s,isDisabled:c,shouldCancelOnPointerExit:m};let[R,D]=ee.useState(!1),H=ee.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:F,removeAllGlobalListeners:k}=x9(),N=ee.useMemo(()=>{let U=H.current,ie=(Ee,$e)=>{let{onPressStart:we,onPressChange:Be,isDisabled:Jt}=C.current;Jt||U.didFirePressStart||(we&&we({type:"pressstart",pointerType:$e,target:Ee.currentTarget,shiftKey:Ee.shiftKey,metaKey:Ee.metaKey,ctrlKey:Ee.ctrlKey,altKey:Ee.altKey}),Be&&Be(!0),U.didFirePressStart=!0,D(!0))},he=(Ee,$e,we=!0)=>{let{onPressEnd:Be,onPressChange:Jt,onPress:mt,isDisabled:an}=C.current;U.didFirePressStart&&(U.ignoreClickAfterPress=!0,U.didFirePressStart=!1,Be&&Be({type:"pressend",pointerType:$e,target:Ee.currentTarget,shiftKey:Ee.shiftKey,metaKey:Ee.metaKey,ctrlKey:Ee.ctrlKey,altKey:Ee.altKey}),Jt&&Jt(!1),D(!1),mt&&we&&!an&&mt({type:"press",pointerType:$e,target:Ee.currentTarget,shiftKey:Ee.shiftKey,metaKey:Ee.metaKey,ctrlKey:Ee.ctrlKey,altKey:Ee.altKey}))},le=(Ee,$e)=>{let{onPressUp:we,isDisabled:Be}=C.current;Be||we&&we({type:"pressup",pointerType:$e,target:Ee.currentTarget,shiftKey:Ee.shiftKey,metaKey:Ee.metaKey,ctrlKey:Ee.ctrlKey,altKey:Ee.altKey})},ve=Ee=>{U.isPressed&&(U.isOverTarget&&he(fl(U.target,Ee),U.pointerType,!1),U.isPressed=!1,U.isOverTarget=!1,U.activePointerId=null,U.pointerType=null,k(),x||M_(U.target))},Oe={onKeyDown(Ee){vw(Ee.nativeEvent,Ee.currentTarget)&&Ee.currentTarget.contains(Ee.target)?($O(Ee.target,Ee.key)&&Ee.preventDefault(),Ee.stopPropagation(),!U.isPressed&&!Ee.repeat&&(U.target=Ee.currentTarget,U.isPressed=!0,ie(Ee,"keyboard"),F(document,"keyup",Re,!1))):Ee.key==="Enter"&&FE(Ee.currentTarget)&&Ee.stopPropagation()},onKeyUp(Ee){vw(Ee.nativeEvent,Ee.currentTarget)&&!Ee.repeat&&Ee.currentTarget.contains(Ee.target)&&le(fl(U.target,Ee),"keyboard")},onClick(Ee){Ee&&!Ee.currentTarget.contains(Ee.target)||Ee&&Ee.button===0&&(Ee.stopPropagation(),c&&Ee.preventDefault(),!U.ignoreClickAfterPress&&!U.ignoreEmulatedMouseEvents&&(U.pointerType==="virtual"||$E(Ee.nativeEvent))&&(!c&&!f&&wl(Ee.currentTarget),ie(Ee,"virtual"),le(Ee,"virtual"),he(Ee,"virtual")),U.ignoreEmulatedMouseEvents=!1,U.ignoreClickAfterPress=!1)}},Re=Ee=>{if(U.isPressed&&vw(Ee,U.target)){$O(Ee.target,Ee.key)&&Ee.preventDefault(),Ee.stopPropagation(),U.isPressed=!1;let $e=Ee.target;he(fl(U.target,Ee),"keyboard",U.target.contains($e)),k(),U.target instanceof HTMLElement&&U.target.contains($e)&&(FE(U.target)||U.target.getAttribute("role")==="link")&&U.target.click()}};if(typeof PointerEvent<"u"){Oe.onPointerDown=Be=>{if(!(Be.button!==0||!Be.currentTarget.contains(Be.target))){if(V0e(Be.nativeEvent)){U.pointerType="virtual";return}bw(Be.currentTarget)&&Be.preventDefault(),U.pointerType=Be.pointerType,Be.stopPropagation(),U.isPressed||(U.isPressed=!0,U.isOverTarget=!0,U.activePointerId=Be.pointerId,U.target=Be.currentTarget,!c&&!f&&wl(Be.currentTarget),x||LO(U.target),ie(Be,U.pointerType),F(document,"pointermove",Ee,!1),F(document,"pointerup",$e,!1),F(document,"pointercancel",we,!1))}},Oe.onMouseDown=Be=>{Be.currentTarget.contains(Be.target)&&Be.button===0&&(bw(Be.currentTarget)&&Be.preventDefault(),Be.stopPropagation())},Oe.onPointerUp=Be=>{!Be.currentTarget.contains(Be.target)||U.pointerType==="virtual"||Be.button===0&&ih(Be,Be.currentTarget)&&le(Be,U.pointerType||Be.pointerType)};let Ee=Be=>{Be.pointerId===U.activePointerId&&(ih(Be,U.target)?U.isOverTarget||(U.isOverTarget=!0,ie(fl(U.target,Be),U.pointerType)):U.isOverTarget&&(U.isOverTarget=!1,he(fl(U.target,Be),U.pointerType,!1),C.current.shouldCancelOnPointerExit&&ve(Be)))},$e=Be=>{Be.pointerId===U.activePointerId&&U.isPressed&&Be.button===0&&(ih(Be,U.target)?he(fl(U.target,Be),U.pointerType):U.isOverTarget&&he(fl(U.target,Be),U.pointerType,!1),U.isPressed=!1,U.isOverTarget=!1,U.activePointerId=null,U.pointerType=null,k(),x||M_(U.target))},we=Be=>{ve(Be)};Oe.onDragStart=Be=>{Be.currentTarget.contains(Be.target)&&ve(Be)}}else{Oe.onMouseDown=we=>{we.button!==0||!we.currentTarget.contains(we.target)||(bw(we.currentTarget)&&we.preventDefault(),we.stopPropagation(),!U.ignoreEmulatedMouseEvents&&(U.isPressed=!0,U.isOverTarget=!0,U.target=we.currentTarget,U.pointerType=$E(we.nativeEvent)?"virtual":"mouse",!c&&!f&&wl(we.currentTarget),ie(we,U.pointerType),F(document,"mouseup",Ee,!1)))},Oe.onMouseEnter=we=>{we.currentTarget.contains(we.target)&&(we.stopPropagation(),U.isPressed&&!U.ignoreEmulatedMouseEvents&&(U.isOverTarget=!0,ie(we,U.pointerType)))},Oe.onMouseLeave=we=>{we.currentTarget.contains(we.target)&&(we.stopPropagation(),U.isPressed&&!U.ignoreEmulatedMouseEvents&&(U.isOverTarget=!1,he(we,U.pointerType,!1),C.current.shouldCancelOnPointerExit&&ve(we)))},Oe.onMouseUp=we=>{we.currentTarget.contains(we.target)&&!U.ignoreEmulatedMouseEvents&&we.button===0&&le(we,U.pointerType)};let Ee=we=>{if(we.button===0){if(U.isPressed=!1,k(),U.ignoreEmulatedMouseEvents){U.ignoreEmulatedMouseEvents=!1;return}ih(we,U.target)?he(fl(U.target,we),U.pointerType):U.isOverTarget&&he(fl(U.target,we),U.pointerType,!1),U.isOverTarget=!1}};Oe.onTouchStart=we=>{if(!we.currentTarget.contains(we.target))return;we.stopPropagation();let Be=fve(we.nativeEvent);Be&&(U.activePointerId=Be.identifier,U.ignoreEmulatedMouseEvents=!0,U.isOverTarget=!0,U.isPressed=!0,U.target=we.currentTarget,U.pointerType="touch",!c&&!f&&wl(we.currentTarget),x||LO(U.target),ie(we,U.pointerType),F(window,"scroll",$e,!0))},Oe.onTouchMove=we=>{if(!we.currentTarget.contains(we.target)||(we.stopPropagation(),!U.isPressed))return;let Be=RO(we.nativeEvent,U.activePointerId);Be&&ih(Be,we.currentTarget)?U.isOverTarget||(U.isOverTarget=!0,ie(we,U.pointerType)):U.isOverTarget&&(U.isOverTarget=!1,he(we,U.pointerType,!1),C.current.shouldCancelOnPointerExit&&ve(we))},Oe.onTouchEnd=we=>{if(!we.currentTarget.contains(we.target)||(we.stopPropagation(),!U.isPressed))return;let Be=RO(we.nativeEvent,U.activePointerId);Be&&ih(Be,we.currentTarget)?(le(we,U.pointerType),he(we,U.pointerType)):U.isOverTarget&&he(we,U.pointerType,!1),U.isPressed=!1,U.activePointerId=null,U.isOverTarget=!1,U.ignoreEmulatedMouseEvents=!0,x||M_(U.target),k()},Oe.onTouchCancel=we=>{we.currentTarget.contains(we.target)&&(we.stopPropagation(),U.isPressed&&ve(we))};let $e=we=>{U.isPressed&&we.target.contains(U.target)&&ve({currentTarget:U.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};Oe.onDragStart=we=>{we.currentTarget.contains(we.target)&&ve(we)}}return Oe},[F,c,f,k,x]);return ee.useEffect(()=>()=>{x||M_(H.current.target)},[x]),{isPressed:o||R,pressProps:kn(T,N)}}function FE(t){return t.tagName==="A"&&t.hasAttribute("href")}function vw(t,e){const{key:n,code:r}=t,i=e,s=i.getAttribute("role");return(n==="Enter"||n===" "||n==="Spacebar"||r==="Space")&&!(i instanceof HTMLInputElement&&!O9(i,n)||i instanceof HTMLTextAreaElement||i.isContentEditable)&&(!FE(i)||s==="button"&&n!=="Enter")&&!(s==="link"&&n!=="Enter")}function fve(t){const{targetTouches:e}=t;return e.length>0?e[0]:null}function RO(t,e){const n=t.changedTouches;for(let r=0;r<n.length;r++){const i=n[r];if(i.identifier===e)return i}return null}function fl(t,e){return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey}}function pve(t){let e=t.width/2||t.radiusX||0,n=t.height/2||t.radiusY||0;return{top:t.clientY-n,right:t.clientX+e,bottom:t.clientY+n,left:t.clientX-e}}function mve(t,e){return!(t.left>e.right||e.left>t.right||t.top>e.bottom||e.top>t.bottom)}function ih(t,e){let n=e.getBoundingClientRect(),r=pve(t);return mve(n,r)}function bw(t){return!(t instanceof HTMLElement)||!t.draggable}function $O(t,e){return t instanceof HTMLInputElement?!O9(t,e):t instanceof HTMLButtonElement?t.type!=="submit":!0}const gve=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function O9(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":gve.has(t.type)}const yve=ce.forwardRef(({children:t,...e},n)=>{let r=ee.useRef(!1),i=ee.useContext(vv),s=kn(i||{},{...e,ref:n||(i==null?void 0:i.ref),register(){r.current=!0,i&&i.register()}});return UR(i,n),ee.useEffect(()=>{r.current||console.warn("A PressResponder was rendered without a pressable child. Either call the usePress hook, or wrap your DOM node with <Pressable> component.")},[]),ce.createElement(vv.Provider,{value:s},t)});class _ve{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}}function D9(t){let e=ee.useRef({isFocused:!1,onBlur:t,observer:null});return e.current.onBlur=t,wr(()=>{const n=e.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]),ee.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){e.current.isFocused=!0;let r=n.target,i=s=>{var c,o;e.current.isFocused=!1,r.disabled&&((o=(c=e.current).onBlur)===null||o===void 0||o.call(c,new _ve("blur",s))),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};r.addEventListener("focusout",i,{once:!0}),e.current.observer=new MutationObserver(()=>{e.current.isFocused&&r.disabled&&(e.current.observer.disconnect(),r.dispatchEvent(new FocusEvent("blur")),r.dispatchEvent(new FocusEvent("focusout",{bubbles:!0})))}),e.current.observer.observe(r,{attributes:!0,attributeFilter:["disabled"]})}},[])}function F9(t){let{isDisabled:e,onFocus:n,onBlur:r,onFocusChange:i}=t;const s=ee.useCallback(f=>{if(f.target===f.currentTarget)return r&&r(f),i&&i(!1),!0},[r,i]),c=D9(s),o=ee.useCallback(f=>{f.target===f.currentTarget&&document.activeElement===f.target&&(n&&n(f),i&&i(!0),c(f))},[i,n,c]);return{focusProps:{onFocus:!e&&(n||i||r)?o:void 0,onBlur:!e&&(r||i)?s:void 0}}}let gd=null,zE=new Set,MO=!1,sd=!1,NE=!1;const vve={Tab:!0,Escape:!0};function Ab(t,e){for(let n of zE)n(t,e)}function bve(t){return!(t.metaKey||!Og()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function kO(t){sd=!0,bve(t)&&(gd="keyboard",Ab("keyboard",t))}function sh(t){gd="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(sd=!0,Ab("pointer",t))}function xve(t){$E(t)&&(sd=!0,gd="virtual")}function wve(t){t.target===window||t.target===document||(!sd&&!NE&&(gd="virtual",Ab("virtual",t)),sd=!1,NE=!1)}function Eve(){sd=!1,NE=!0}function BE(){if(typeof window>"u"||MO)return;let t=HTMLElement.prototype.focus;HTMLElement.prototype.focus=function(){sd=!0,t.apply(this,arguments)},document.addEventListener("keydown",kO,!0),document.addEventListener("keyup",kO,!0),document.addEventListener("click",xve,!0),window.addEventListener("focus",wve,!0),window.addEventListener("blur",Eve,!1),typeof PointerEvent<"u"?(document.addEventListener("pointerdown",sh,!0),document.addEventListener("pointermove",sh,!0),document.addEventListener("pointerup",sh,!0)):(document.addEventListener("mousedown",sh,!0),document.addEventListener("mousemove",sh,!0),document.addEventListener("mouseup",sh,!0)),MO=!0}typeof document<"u"&&(document.readyState!=="loading"?BE():document.addEventListener("DOMContentLoaded",BE));function ag(){return gd!=="pointer"}function bv(){return gd}function Tve(t){gd=t,Ab(t,null)}function Sve(t,e,n){return!(t&&e==="keyboard"&&n instanceof KeyboardEvent&&!vve[n.key])}function Ave(t,e,n){BE(),ee.useEffect(()=>{let r=(i,s)=>{Sve(n==null?void 0:n.isTextInput,i,s)&&t(ag())};return zE.add(r),()=>{zE.delete(r)}},e)}function Pb(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:i}=t,s=ee.useRef({isFocusWithin:!1}),c=ee.useCallback(m=>{s.current.isFocusWithin&&!m.currentTarget.contains(m.relatedTarget)&&(s.current.isFocusWithin=!1,n&&n(m),i&&i(!1))},[n,i,s]),o=D9(c),f=ee.useCallback(m=>{!s.current.isFocusWithin&&document.activeElement===m.target&&(r&&r(m),i&&i(!0),s.current.isFocusWithin=!0,o(m))},[r,i,o]);return e?{focusWithinProps:{onFocus:null,onBlur:null}}:{focusWithinProps:{onFocus:f,onBlur:c}}}let xv=!1,xw=0;function UE(){xv=!0,setTimeout(()=>{xv=!1},50)}function OO(t){t.pointerType==="touch"&&UE()}function Pve(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",OO):document.addEventListener("touchend",UE),xw++,()=>{xw--,!(xw>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",OO):document.removeEventListener("touchend",UE))}}function Xc(t){let{onHoverStart:e,onHoverChange:n,onHoverEnd:r,isDisabled:i}=t,[s,c]=ee.useState(!1),o=ee.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;ee.useEffect(Pve,[]);let{hoverProps:f,triggerHoverEnd:m}=ee.useMemo(()=>{let x=(C,R)=>{if(o.pointerType=R,i||R==="touch"||o.isHovered||!C.currentTarget.contains(C.target))return;o.isHovered=!0;let D=C.currentTarget;o.target=D,e&&e({type:"hoverstart",target:D,pointerType:R}),n&&n(!0),c(!0)},S=(C,R)=>{if(o.pointerType="",o.target=null,R==="touch"||!o.isHovered)return;o.isHovered=!1;let D=C.currentTarget;r&&r({type:"hoverend",target:D,pointerType:R}),n&&n(!1),c(!1)},T={};return typeof PointerEvent<"u"?(T.onPointerEnter=C=>{xv&&C.pointerType==="mouse"||x(C,C.pointerType)},T.onPointerLeave=C=>{!i&&C.currentTarget.contains(C.target)&&S(C,C.pointerType)}):(T.onTouchStart=()=>{o.ignoreEmulatedMouseEvents=!0},T.onMouseEnter=C=>{!o.ignoreEmulatedMouseEvents&&!xv&&x(C,"mouse"),o.ignoreEmulatedMouseEvents=!1},T.onMouseLeave=C=>{!i&&C.currentTarget.contains(C.target)&&S(C,"mouse")}),{hoverProps:T,triggerHoverEnd:S}},[e,n,r,i,o]);return ee.useEffect(()=>{i&&m({currentTarget:o.target},o.pointerType)},[i]),{hoverProps:f,isHovered:s}}function Cve(t){let{ref:e,onInteractOutside:n,isDisabled:r,onInteractOutsideStart:i}=t,c=ee.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1,onInteractOutside:n,onInteractOutsideStart:i}).current;c.onInteractOutside=n,c.onInteractOutsideStart=i,ee.useEffect(()=>{if(r)return;let o=f=>{k_(f,e)&&c.onInteractOutside&&(c.onInteractOutsideStart&&c.onInteractOutsideStart(f),c.isPointerDown=!0)};if(typeof PointerEvent<"u"){let f=m=>{c.isPointerDown&&c.onInteractOutside&&k_(m,e)&&c.onInteractOutside(m),c.isPointerDown=!1};return document.addEventListener("pointerdown",o,!0),document.addEventListener("pointerup",f,!0),()=>{document.removeEventListener("pointerdown",o,!0),document.removeEventListener("pointerup",f,!0)}}else{let f=x=>{c.ignoreEmulatedMouseEvents?c.ignoreEmulatedMouseEvents=!1:c.isPointerDown&&c.onInteractOutside&&k_(x,e)&&c.onInteractOutside(x),c.isPointerDown=!1},m=x=>{c.ignoreEmulatedMouseEvents=!0,c.onInteractOutside&&c.isPointerDown&&k_(x,e)&&c.onInteractOutside(x),c.isPointerDown=!1};return document.addEventListener("mousedown",o,!0),document.addEventListener("mouseup",f,!0),document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",m,!0),()=>{document.removeEventListener("mousedown",o,!0),document.removeEventListener("mouseup",f,!0),document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",m,!0)}}},[e,c,r])}function k_(t,e){if(t.button>0)return!1;if(t.target){const n=t.target.ownerDocument;if(!n||!n.documentElement.contains(t.target)||t.target.closest("[data-react-aria-top-layer]"))return!1}return e.current&&!e.current.contains(t.target)}function DO(t){if(!t)return;let e=!0;return n=>{let r={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){e=!1}};t(r),e&&n.stopPropagation()}}function Ive(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:DO(t.onKeyDown),onKeyUp:DO(t.onKeyUp)}}}const Lve=500;function z9(t){let{isDisabled:e,onLongPressStart:n,onLongPressEnd:r,onLongPress:i,threshold:s=Lve,accessibilityDescription:c}=t;const o=ee.useRef(null);let{addGlobalListener:f,removeGlobalListener:m}=x9(),{pressProps:x}=KR({isDisabled:e,onPressStart(T){if((T.pointerType==="mouse"||T.pointerType==="touch")&&(n&&n({...T,type:"longpressstart"}),o.current=setTimeout(()=>{T.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),i&&i({...T,type:"longpress"}),o.current=null},s),T.pointerType==="touch")){let C=R=>{R.preventDefault()};f(T.target,"contextmenu",C,{once:!0}),f(window,"pointerup",()=>{setTimeout(()=>{m(T.target,"contextmenu",C)},30)},{once:!0})}},onPressEnd(T){o.current&&clearTimeout(o.current),r&&(T.pointerType==="mouse"||T.pointerType==="touch")&&r({...T,type:"longpressend"})}}),S=O0e(i&&!e?c:null);return{longPressProps:kn(x,S)}}function od(t){if(bv()==="virtual"){let e=document.activeElement;b9(()=>{document.activeElement===e&&document.contains(t)&&wl(t)})}else wl(t)}function Rve(t){if(!(t instanceof HTMLElement)&&!(t instanceof SVGElement))return!1;let{display:e,visibility:n}=t.style,r=e!=="none"&&n!=="hidden"&&n!=="collapse";if(r){const{getComputedStyle:i}=t.ownerDocument.defaultView;let{display:s,visibility:c}=i(t);r=s!=="none"&&c!=="hidden"&&c!=="collapse"}return r}function $ve(t,e){return!t.hasAttribute("hidden")&&(t.nodeName==="DETAILS"&&e&&e.nodeName!=="SUMMARY"?t.hasAttribute("open"):!0)}function N9(t,e){return t.nodeName!=="#comment"&&Rve(t)&&$ve(t,e)&&(!t.parentElement||N9(t.parentElement,t))}const FO=ce.createContext(null);let Lr=null;function qR(t){let{children:e,contain:n,restoreFocus:r,autoFocus:i}=t,s=ee.useRef(),c=ee.useRef(),o=ee.useRef([]),{parentNode:f}=ee.useContext(FO)||{},m=ee.useMemo(()=>new VE({scopeRef:o}),[o]);wr(()=>{let T=f||li.root;if(li.getTreeNode(T.scopeRef)&&Lr&&!Ev(Lr,T.scopeRef)){let C=li.getTreeNode(Lr);C&&(T=C)}T.addChild(m),li.addNode(m)},[m,f]),wr(()=>{let T=li.getTreeNode(o);T.contain=n},[n]),wr(()=>{let T=s.current.nextSibling,C=[];for(;T&&T!==c.current;)C.push(T),T=T.nextSibling;o.current=C},[e]),Nve(o,r,n),Dve(o,n),Uve(o,r,n),zve(o,i),ee.useEffect(()=>{if(o){let T=document.activeElement,C=null;if(Is(T,o.current)){for(let R of li.traverse())Is(T,R.scopeRef.current)&&(C=R);C===li.getTreeNode(o)&&(Lr=C.scopeRef)}return()=>{let R=li.getTreeNode(o).parent.scopeRef;(o===Lr||Ev(o,Lr))&&(!R||li.getTreeNode(R))&&(Lr=R),li.removeTreeNode(o)}}},[o]);let x=ee.useMemo(()=>Mve(o),[]),S=ee.useMemo(()=>({focusManager:x,parentNode:m}),[m,x]);return ce.createElement(FO.Provider,{value:S},ce.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:s}),e,ce.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:c}))}function Mve(t){return{focusNext(e={}){let n=t.current,{from:r,tabbable:i,wrap:s,accept:c}=e,o=r||document.activeElement,f=n[0].previousElementSibling,m=Tl(Nu(n),{tabbable:i,accept:c},n);m.currentNode=Is(o,n)?o:f;let x=m.nextNode();return!x&&s&&(m.currentNode=f,x=m.nextNode()),x&&El(x,!0),x},focusPrevious(e={}){let n=t.current,{from:r,tabbable:i,wrap:s,accept:c}=e,o=r||document.activeElement,f=n[n.length-1].nextElementSibling,m=Tl(Nu(n),{tabbable:i,accept:c},n);m.currentNode=Is(o,n)?o:f;let x=m.previousNode();return!x&&s&&(m.currentNode=f,x=m.previousNode()),x&&El(x,!0),x},focusFirst(e={}){let n=t.current,{tabbable:r,accept:i}=e,s=Tl(Nu(n),{tabbable:r,accept:i},n);s.currentNode=n[0].previousElementSibling;let c=s.nextNode();return c&&El(c,!0),c},focusLast(e={}){let n=t.current,{tabbable:r,accept:i}=e,s=Tl(Nu(n),{tabbable:r,accept:i},n);s.currentNode=n[n.length-1].nextElementSibling;let c=s.previousNode();return c&&El(c,!0),c}}}const XR=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]"],kve=XR.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";XR.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const Ove=XR.join(':not([hidden]):not([tabindex="-1"]),');function Nu(t){return t[0].parentElement}function O_(t){let e=li.getTreeNode(Lr);for(;e&&e.scopeRef!==t;){if(e.contain)return!1;e=e.parent}return!0}function Dve(t,e){let n=ee.useRef(),r=ee.useRef(null);wr(()=>{let i=t.current;if(!e){r.current&&(cancelAnimationFrame(r.current),r.current=null);return}let s=f=>{if(f.key!=="Tab"||f.altKey||f.ctrlKey||f.metaKey||!O_(t))return;let m=document.activeElement,x=t.current;if(!Is(m,x))return;let S=Tl(Nu(x),{tabbable:!0},x);S.currentNode=m;let T=f.shiftKey?S.previousNode():S.nextNode();T||(S.currentNode=f.shiftKey?x[x.length-1].nextElementSibling:x[0].previousElementSibling,T=f.shiftKey?S.previousNode():S.nextNode()),f.preventDefault(),T&&El(T,!0)},c=f=>{(!Lr||Ev(Lr,t))&&Is(f.target,t.current)?(Lr=t,n.current=f.target):O_(t)&&!wv(f.target,t)?n.current?n.current.focus():Lr&&Tv(Lr.current):O_(t)&&(n.current=f.target)},o=f=>{r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(()=>{O_(t)&&!wv(document.activeElement,t)&&(Lr=t,document.body.contains(f.target)?(n.current=f.target,n.current.focus()):Lr&&Tv(Lr.current))})};return document.addEventListener("keydown",s,!1),document.addEventListener("focusin",c,!1),i.forEach(f=>f.addEventListener("focusin",c,!1)),i.forEach(f=>f.addEventListener("focusout",o,!1)),()=>{document.removeEventListener("keydown",s,!1),document.removeEventListener("focusin",c,!1),i.forEach(f=>f.removeEventListener("focusin",c,!1)),i.forEach(f=>f.removeEventListener("focusout",o,!1))}},[t,e]),ee.useEffect(()=>()=>{r.current&&cancelAnimationFrame(r.current)},[r])}function B9(t){return wv(t)}function Is(t,e){return e.some(n=>n.contains(t))}function wv(t,e=null){if(t instanceof Element&&t.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:n}of li.traverse(li.getTreeNode(e)))if(Is(t,n.current))return!0;return!1}function Fve(t){return wv(t,Lr)}function Ev(t,e){var n;let r=(n=li.getTreeNode(e))===null||n===void 0?void 0:n.parent;for(;r;){if(r.scopeRef===t)return!0;r=r.parent}return!1}function El(t,e=!1){if(t!=null&&!e)try{od(t)}catch{}else if(t!=null)try{t.focus()}catch{}}function Tv(t,e=!0){let n=t[0].previousElementSibling,r=Tl(Nu(t),{tabbable:e},t);r.currentNode=n;let i=r.nextNode();e&&!i&&(r=Tl(Nu(t),{tabbable:!1},t),r.currentNode=n,i=r.nextNode()),El(i)}function zve(t,e){const n=ce.useRef(e);ee.useEffect(()=>{n.current&&(Lr=t,Is(document.activeElement,Lr.current)||Tv(t.current)),n.current=!1},[t])}function Nve(t,e,n){wr(()=>{if(e||n)return;let r=t.current,i=s=>{let c=s.target;Is(c,t.current)?Lr=t:B9(c)||(Lr=null)};return document.addEventListener("focusin",i,!1),r.forEach(s=>s.addEventListener("focusin",i,!1)),()=>{document.removeEventListener("focusin",i,!1),r.forEach(s=>s.removeEventListener("focusin",i,!1))}},[t,e,n])}function Bve(t){let e=li.getTreeNode(Lr);for(;e&&e.scopeRef!==t;){if(e.nodeToRestore)return!1;e=e.parent}return(e==null?void 0:e.scopeRef)===t}function Uve(t,e,n){const r=ee.useRef(typeof document<"u"?document.activeElement:null);wr(()=>{let i=t.current;if(!e||n)return;let s=()=>{(!Lr||Ev(Lr,t))&&(Lr=t)};return document.addEventListener("focusin",s,!1),i.forEach(c=>c.addEventListener("focusin",s,!1)),()=>{document.removeEventListener("focusin",s,!1),i.forEach(c=>c.removeEventListener("focusin",s,!1))}},[t,n]),wr(()=>{if(!e)return;li.getTreeNode(t).nodeToRestore=r.current;let i=s=>{if(s.key!=="Tab"||s.altKey||s.ctrlKey||s.metaKey)return;let c=document.activeElement;if(!Is(c,t.current))return;let o=li.getTreeNode(t).nodeToRestore,f=Tl(document.body,{tabbable:!0});f.currentNode=c;let m=s.shiftKey?f.previousNode():f.nextNode();if((!document.body.contains(o)||o===document.body)&&(o=null,li.getTreeNode(t).nodeToRestore=null),(!m||!Is(m,t.current))&&o){f.currentNode=o;do m=s.shiftKey?f.previousNode():f.nextNode();while(Is(m,t.current));s.preventDefault(),s.stopPropagation(),m?El(m,!0):B9(o)?El(o,!0):c.blur()}};return n||document.addEventListener("keydown",i,!0),()=>{n||document.removeEventListener("keydown",i,!0);let s=li.getTreeNode(t).nodeToRestore;if(e&&s&&(Is(document.activeElement,t.current)||document.activeElement===document.body&&Bve(t))){let c=li.clone();requestAnimationFrame(()=>{if(document.activeElement===document.body){let o=c.getTreeNode(t);for(;o;){if(o.nodeToRestore&&document.body.contains(o.nodeToRestore)){El(o.nodeToRestore);return}o=o.parent}for(o=c.getTreeNode(t);o;){if(o.scopeRef&&li.getTreeNode(o.scopeRef)){Tv(o.scopeRef.current,!0);return}o=o.parent}}})}}},[t,e,n])}function Tl(t,e,n){let r=e!=null&&e.tabbable?Ove:kve,i=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode(s){var c;return!(e==null||(c=e.from)===null||c===void 0)&&c.contains(s)?NodeFilter.FILTER_REJECT:s.matches(r)&&N9(s)&&(!n||Is(s,n))&&(!(e!=null&&e.accept)||e.accept(s))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e!=null&&e.from&&(i.currentNode=e.from),i}class ZR{get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,n,r){let i=this.fastMap.get(n??null),s=new VE({scopeRef:e});i.addChild(s),s.parent=i,this.fastMap.set(e,s),r&&(s.nodeToRestore=r)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let n=this.fastMap.get(e),r=n.parent;for(let s of this.traverse())s!==n&&n.nodeToRestore&&s.nodeToRestore&&n.scopeRef.current&&Is(s.nodeToRestore,n.scopeRef.current)&&(s.nodeToRestore=n.nodeToRestore);let i=n.children;r.removeChild(n),i.size>0&&i.forEach(s=>r.addChild(s)),this.fastMap.delete(n.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let n of e.children)yield*this.traverse(n)}clone(){let e=new ZR;for(let n of this.traverse())e.addTreeNode(n.scopeRef,n.parent.scopeRef,n.nodeToRestore);return e}constructor(){Cr(this,"fastMap",new Map),this.root=new VE({scopeRef:null}),this.fastMap.set(null,this.root)}}class VE{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){Cr(this,"children",new Set),Cr(this,"contain",!1),this.scopeRef=e.scopeRef}}let li=new ZR;function U9(t={}){let{autoFocus:e=!1,isTextInput:n,within:r}=t,i=ee.useRef({isFocused:!1,isFocusVisible:e||ag()}),[s,c]=ee.useState(!1),[o,f]=ee.useState(()=>i.current.isFocused&&i.current.isFocusVisible),m=ee.useCallback(()=>f(i.current.isFocused&&i.current.isFocusVisible),[]),x=ee.useCallback(C=>{i.current.isFocused=C,c(C),m()},[m]);Ave(C=>{i.current.isFocusVisible=C,m()},[],{isTextInput:n});let{focusProps:S}=F9({isDisabled:r,onFocusChange:x}),{focusWithinProps:T}=Pb({isDisabled:!r,onFocusWithinChange:x});return{isFocused:s,isFocusVisible:i.current.isFocused&&o,focusProps:r?T:S}}function Af(t){let{children:e,focusClass:n,focusRingClass:r}=t,{isFocused:i,isFocusVisible:s,focusProps:c}=U9(t),o=ce.Children.only(e);return ce.cloneElement(o,kn(o.props,{...c,className:wb({[n||""]:i,[r||""]:s})}))}let Vve=ce.createContext(null);function Gve(t){let e=ee.useContext(Vve)||{};UR(e,t);let{ref:n,...r}=e;return r}function V9(t,e){let{focusProps:n}=F9(t),{keyboardProps:r}=Ive(t),i=kn(n,r),s=Gve(e),c=t.isDisabled?{}:s,o=ee.useRef(t.autoFocus);return ee.useEffect(()=>{o.current&&e.current&&od(e.current),o.current=!1},[e]),{focusableProps:kn({...i,tabIndex:t.excludeFromTabOrder&&!t.isDisabled?-1:void 0},c)}}function jve(t,e){t=Fg(t,"text");let{children:n,...r}=t,{styleProps:i}=Ni(r),s=ma(e);return ce.createElement("span",{...ps(r),...i,ref:s},n)}const YR=ee.forwardRef(jve);function Cb(t,e){let{elementType:n="button",isDisabled:r,onPress:i,onPressStart:s,onPressEnd:c,onPressChange:o,preventFocusOnPress:f,allowFocusWhenDisabled:m,onClick:x,href:S,target:T,rel:C,type:R="button"}=t,D;n==="button"?D={type:R,disabled:r}:D={role:"button",tabIndex:r?void 0:0,href:n==="a"&&r?void 0:S,target:n==="a"?T:void 0,type:n==="input"?R:void 0,disabled:n==="input"?r:void 0,"aria-disabled":!r||n==="input"?void 0:r,rel:n==="a"?C:void 0};let{pressProps:H,isPressed:F}=KR({onPressStart:s,onPressEnd:c,onPressChange:o,onPress:i,isDisabled:r,preventFocusOnPress:f,ref:e}),{focusableProps:k}=V9(t,e);m&&(k.tabIndex=r?-1:k.tabIndex);let N=kn(k,H,ps(t,{labelable:!0}));return{isPressed:F,buttonProps:kn(D,N,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],onClick:U=>{x&&(x(U),console.warn("onClick is deprecated, please use onPress"))}})}}const zO={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function Hve(t={}){let{style:e,isFocusable:n}=t,[r,i]=ee.useState(!1),{focusWithinProps:s}=Pb({isDisabled:!n,onFocusWithinChange:o=>i(o)}),c=ee.useMemo(()=>r?e:e?{...zO,...e}:zO,[r]);return{visuallyHiddenProps:{...s,style:c}}}function Wve(t){let{children:e,elementType:n="div",isFocusable:r,style:i,...s}=t,{visuallyHiddenProps:c}=Hve(t);return ce.createElement(n,kn(s,c),e)}function Kve(t){return t&&t.__esModule?t.default:t}const NO={top:"top",bottom:"top",left:"left",right:"left"},Sv={top:"bottom",bottom:"top",left:"right",right:"left"},qve={top:"left",left:"top"},GE={top:"height",left:"width"},Xve={width:"totalWidth",height:"totalHeight"},D_={};let oh=typeof window<"u"&&window.visualViewport;function Zve(t){let e=0,n=0,r=0,i=0,s=0,c=0,o={};if(t.tagName==="BODY"){let x=document.documentElement;r=x.clientWidth,i=x.clientHeight;var f;e=(f=oh==null?void 0:oh.width)!==null&&f!==void 0?f:r;var m;n=(m=oh==null?void 0:oh.height)!==null&&m!==void 0?m:i,o.top=x.scrollTop||t.scrollTop,o.left=x.scrollLeft||t.scrollLeft}else({width:e,height:n,top:s,left:c}=Vh(t)),o.top=t.scrollTop,o.left=t.scrollLeft,r=e,i=n;return{width:e,height:n,totalWidth:r,totalHeight:i,scroll:o,top:s,left:c}}function Yve(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function BO(t,e,n,r,i){let s=r.scroll[t],c=r[GE[t]],o=e-i-s,f=e+i-s+n;return o<0?-o:f>c?Math.max(c-f,-o):0}function Jve(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function UO(t){if(D_[t])return D_[t];let[e,n]=t.split(" "),r=NO[e]||"right",i=qve[r];NO[n]||(n="center");let s=GE[r],c=GE[i];return D_[t]={placement:e,crossPlacement:n,axis:r,crossAxis:i,size:s,crossSize:c},D_[t]}function ww(t,e,n,r,i,s,c,o,f,m){let{placement:x,crossPlacement:S,axis:T,crossAxis:C,size:R,crossSize:D}=r,H={};H[C]=t[C],S==="center"?H[C]+=(t[D]-n[D])/2:S!==C&&(H[C]+=t[D]-n[D]),H[C]+=s;const F=t[C]-n[D]+f+m,k=t[C]+t[D]-f-m;if(H[C]=ig(H[C],F,k),x===T){const N=o?c[R]:e[Xve[R]];H[Sv[T]]=Math.floor(N-t[T]+i)}else H[T]=Math.floor(t[T]+t[R]+i);return H}function Qve(t,e,n,r,i,s){return t.top!=null?Math.max(0,e.height+e.top+e.scroll.top-(n.top+t.top)-(i.top+i.bottom+s)):Math.max(0,r.top+n.top-(e.top+e.scroll.top)-(i.top+i.bottom+s))}function VO(t,e,n,r,i,s){let{placement:c,axis:o,size:f}=s;return c===o?Math.max(0,n[o]-t[o]-t.scroll[o]+e[o]-r[o]-r[Sv[o]]-i):Math.max(0,t[f]+t[o]+t.scroll[o]-e[o]-n[o]-n[f]-r[o]-r[Sv[o]]-i)}function ebe(t,e,n,r,i,s,c,o,f,m,x,S,T,C,R){let D=UO(t),{size:H,crossAxis:F,crossSize:k,placement:N,crossPlacement:U}=D,ie=ww(e,o,n,D,m,x,f,S,C,R),he=m,le=VO(o,f,e,i,s+m,D);if(c&&r[H]>le){let an=UO(`${Sv[N]} ${U}`),ot=ww(e,o,n,an,m,x,f,S,C,R);VO(o,f,e,i,s+m,an)>le&&(D=an,ie=ot,he=m)}let ve=BO(F,ie[F],n[k],o,s);ie[F]+=ve;let Oe=Qve(ie,o,f,e,i,s);T&&T<Oe&&(Oe=T),n.height=Math.min(n.height,Oe),ie=ww(e,o,n,D,he,x,f,S,C,R),ve=BO(F,ie[F],n[k],o,s),ie[F]+=ve;let Re={},Ee=e[F]+.5*e[k]-n[F];const $e=C/2+R,we=n[k]-C/2-R,Be=e[F]-n[F]+C/2,Jt=e[F]+e[k]-n[F]-C/2,mt=ig(Ee,Be,Jt);return Re[F]=ig(mt,$e,we),{position:ie,maxHeight:Oe,arrowOffsetLeft:Re.left,arrowOffsetTop:Re.top,placement:D.placement}}function tbe(t){let{placement:e,targetNode:n,overlayNode:r,scrollNode:i,padding:s,shouldFlip:c,boundaryElement:o,offset:f,crossOffset:m,maxHeight:x,arrowSize:S,arrowBoundaryOffset:T=0}=t,C=r instanceof HTMLElement?nbe(r):document.documentElement,R=C===document.documentElement;const D=window.getComputedStyle(C).position;let H=!!D&&D!=="static",F=R?Vh(n):GO(n,C);if(!R){let{marginTop:le,marginLeft:ve}=window.getComputedStyle(n);F.top+=parseInt(le,10)||0,F.left+=parseInt(ve,10)||0}let k=Vh(r),N=Jve(r);k.width+=N.left+N.right,k.height+=N.top+N.bottom;let U=Yve(i),ie=Zve(o),he=o.tagName==="BODY"?Vh(C):GO(C,o);return ebe(e,F,k,U,N,s,c,ie,he,f,m,H,x,S,T)}function Vh(t){let{top:e,left:n,width:r,height:i}=t.getBoundingClientRect(),{scrollTop:s,scrollLeft:c,clientTop:o,clientLeft:f}=document.documentElement;return{top:e+s-o,left:n+c-f,width:r,height:i}}function GO(t,e){let n=window.getComputedStyle(t),r;if(n.position==="fixed"){let{top:i,left:s,width:c,height:o}=t.getBoundingClientRect();r={top:i,left:s,width:c,height:o}}else{r=Vh(t);let i=Vh(e),s=window.getComputedStyle(e);i.top+=(parseInt(s.borderTopWidth,10)||0)-e.scrollTop,i.left+=(parseInt(s.borderLeftWidth,10)||0)-e.scrollLeft,r.top-=i.top,r.left-=i.left}return r.top-=parseInt(n.marginTop,10)||0,r.left-=parseInt(n.marginLeft,10)||0,r}function nbe(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!jO(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!jO(e);)e=e.parentElement;return e||document.documentElement}function jO(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const G9=new WeakMap;function rbe(t){let{triggerRef:e,isOpen:n,onClose:r}=t;ee.useEffect(()=>{if(!n||r===null)return;let i=s=>{let c=s.target;if(!e.current||c instanceof Node&&!c.contains(e.current))return;let o=r||G9.get(e.current);o&&o()};return window.addEventListener("scroll",i,!0),()=>{window.removeEventListener("scroll",i,!0)}},[n,r,e])}let Mo=typeof window<"u"&&window.visualViewport;function ibe(t){let{direction:e}=pa(),{arrowSize:n=0,targetRef:r,overlayRef:i,scrollRef:s=i,placement:c="bottom",containerPadding:o=12,shouldFlip:f=!0,boundaryElement:m=typeof document<"u"?document.body:null,offset:x=0,crossOffset:S=0,shouldUpdatePosition:T=!0,isOpen:C=!0,onClose:R,maxHeight:D,arrowBoundaryOffset:H=0}=t,[F,k]=ee.useState({position:{},arrowOffsetLeft:void 0,arrowOffsetTop:void 0,maxHeight:void 0,placement:void 0}),N=[T,c,i.current,r.current,s.current,o,f,m,x,S,C,e,D,H,n],U=ee.useCallback(()=>{if(T===!1||!C||!i.current||!r.current||!s.current||!m)return;let le=tbe({placement:obe(c,e),overlayNode:i.current,targetNode:r.current,scrollNode:s.current,padding:o,shouldFlip:f,boundaryElement:m,offset:x,crossOffset:S,maxHeight:D,arrowSize:n,arrowBoundaryOffset:H});Object.keys(le.position).forEach(ve=>i.current.style[ve]=le.position[ve]+"px"),i.current.style.maxHeight=le.maxHeight!=null?le.maxHeight+"px":void 0,k(le)},N);wr(U,N),sbe(U),BR({ref:i,onResize:U});let ie=ee.useRef(!1);wr(()=>{let le,ve=()=>{ie.current=!0,clearTimeout(le),le=setTimeout(()=>{ie.current=!1},500),U()};return Mo==null||Mo.addEventListener("resize",ve),Mo==null||Mo.addEventListener("scroll",ve),()=>{Mo==null||Mo.removeEventListener("resize",ve),Mo==null||Mo.removeEventListener("scroll",ve)}},[U]);let he=ee.useCallback(()=>{ie.current||R()},[R,ie]);return rbe({triggerRef:r,isOpen:C,onClose:R&&he}),{overlayProps:{style:{position:"absolute",zIndex:1e5,...F.position,maxHeight:F.maxHeight}},placement:F.placement,arrowProps:{style:{left:F.arrowOffsetLeft,top:F.arrowOffsetTop}},updatePosition:U}}function sbe(t){wr(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function obe(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}const pl=[];function j9(t,e){let{onClose:n,shouldCloseOnBlur:r,isOpen:i,isDismissable:s=!1,isKeyboardDismissDisabled:c=!1,shouldCloseOnInteractOutside:o}=t;ee.useEffect(()=>(i&&pl.push(e),()=>{let R=pl.indexOf(e);R>=0&&pl.splice(R,1)}),[i,e]);let f=()=>{pl[pl.length-1]===e&&n&&n()},m=R=>{(!o||o(R.target))&&pl[pl.length-1]===e&&(R.stopPropagation(),R.preventDefault())},x=R=>{(!o||o(R.target))&&(pl[pl.length-1]===e&&(R.stopPropagation(),R.preventDefault()),f())},S=R=>{R.key==="Escape"&&!c&&(R.stopPropagation(),R.preventDefault(),f())};Cve({ref:e,onInteractOutside:s?x:null,onInteractOutsideStart:m});let{focusWithinProps:T}=Pb({isDisabled:!r,onBlurWithin:R=>{R.relatedTarget&&Fve(R.relatedTarget)||(!o||o(R.relatedTarget))&&n()}}),C=R=>{R.target===R.currentTarget&&R.preventDefault()};return{overlayProps:{onKeyDown:S,...T},underlayProps:{onPointerDown:C}}}function H9(t,e,n){let{type:r}=t,{isOpen:i}=e;ee.useEffect(()=>{n&&n.current&&G9.set(n.current,e.close)});let s;r==="menu"?s=!0:r==="listbox"&&(s="listbox");let c=jo();return{triggerProps:{"aria-haspopup":s,"aria-expanded":i,"aria-controls":i?c:null,onPress:e.toggle},overlayProps:{id:c}}}const Ew=typeof window<"u"&&window.visualViewport,abe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let F_=0,Tw;function W9(t={}){let{isDisabled:e}=t;wr(()=>{if(!e)return F_++,F_===1&&(Eb()?Tw=cbe():Tw=lbe()),()=>{F_--,F_===0&&Tw()}},[e])}function lbe(){return og(Pm(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),Pm(document.documentElement,"overflow","hidden"))}function cbe(){let t,e=0,n=S=>{t=gv(S.target),!(t===document.documentElement&&t===document.body)&&(e=S.changedTouches[0].pageY)},r=S=>{if(t===document.documentElement||t===document.body){S.preventDefault();return}let T=S.changedTouches[0].pageY,C=t.scrollTop,R=t.scrollHeight-t.clientHeight;(C<=0&&T>e||C>=R&&T<e)&&S.preventDefault(),e=T},i=S=>{let T=S.target;WO(T)&&T!==document.activeElement&&(S.preventDefault(),T.style.transform="translateY(-2000px)",T.focus(),requestAnimationFrame(()=>{T.style.transform=""}))},s=S=>{let T=S.target;WO(T)&&(T.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{T.style.transform="",Ew&&(Ew.height<window.innerHeight?requestAnimationFrame(()=>{HO(T)}):Ew.addEventListener("resize",()=>HO(T),{once:!0}))}))},c=()=>{window.scrollTo(0,0)},o=window.pageXOffset,f=window.pageYOffset,m=og(Pm(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),Pm(document.documentElement,"overflow","hidden"),Pm(document.body,"marginTop",`-${f}px`));window.scrollTo(0,0);let x=og(Hp(document,"touchstart",n,{passive:!1,capture:!0}),Hp(document,"touchmove",r,{passive:!1,capture:!0}),Hp(document,"touchend",i,{passive:!1,capture:!0}),Hp(document,"focus",s,!0),Hp(window,"scroll",c));return()=>{m(),x(),window.scrollTo(o,f)}}function Pm(t,e,n){let r=t.style[e];return t.style[e]=n,()=>{t.style[e]=r}}function Hp(t,e,n,r){return t.addEventListener(e,n,r),()=>{t.removeEventListener(e,n,r)}}function HO(t){let e=document.scrollingElement||document.documentElement;for(;t&&t!==e;){let n=gv(t);if(n!==document.documentElement&&n!==document.body&&n!==t){let r=n.getBoundingClientRect().top,i=t.getBoundingClientRect().top;i>r+t.clientHeight&&(n.scrollTop+=i-r)}t=n.parentElement}}function WO(t){return t instanceof HTMLInputElement&&!abe.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}const jE=ce.createContext(null);function ube(t){let{children:e}=t,n=ee.useContext(jE),[r,i]=ee.useState(0),s=ee.useMemo(()=>({parent:n,modalCount:r,addModal(){i(c=>c+1),n&&n.addModal()},removeModal(){i(c=>c-1),n&&n.removeModal()}}),[n,r]);return ce.createElement(jE.Provider,{value:s},e)}function dbe(){let t=ee.useContext(jE);return{modalProviderProps:{"aria-hidden":t&&t.modalCount>0?!0:null}}}var K9={},q9={};q9={dismiss:"تجاهل"};var X9={};X9={dismiss:"Отхвърляне"};var Z9={};Z9={dismiss:"Odstranit"};var Y9={};Y9={dismiss:"Luk"};var J9={};J9={dismiss:"Schließen"};var Q9={};Q9={dismiss:"Απόρριψη"};var e7={};e7={dismiss:"Dismiss"};var t7={};t7={dismiss:"Descartar"};var n7={};n7={dismiss:"Lõpeta"};var r7={};r7={dismiss:"Hylkää"};var i7={};i7={dismiss:"Rejeter"};var s7={};s7={dismiss:"התעלם"};var o7={};o7={dismiss:"Odbaci"};var a7={};a7={dismiss:"Elutasítás"};var l7={};l7={dismiss:"Ignora"};var c7={};c7={dismiss:"閉じる"};var u7={};u7={dismiss:"무시"};var d7={};d7={dismiss:"Atmesti"};var h7={};h7={dismiss:"Nerādīt"};var f7={};f7={dismiss:"Lukk"};var p7={};p7={dismiss:"Negeren"};var m7={};m7={dismiss:"Zignoruj"};var g7={};g7={dismiss:"Descartar"};var y7={};y7={dismiss:"Dispensar"};var _7={};_7={dismiss:"Revocare"};var v7={};v7={dismiss:"Пропустить"};var b7={};b7={dismiss:"Zrušiť"};var x7={};x7={dismiss:"Opusti"};var w7={};w7={dismiss:"Odbaci"};var E7={};E7={dismiss:"Avvisa"};var T7={};T7={dismiss:"Kapat"};var S7={};S7={dismiss:"Скасувати"};var A7={};A7={dismiss:"取消"};var P7={};P7={dismiss:"關閉"};K9={"ar-AE":q9,"bg-BG":X9,"cs-CZ":Z9,"da-DK":Y9,"de-DE":J9,"el-GR":Q9,"en-US":e7,"es-ES":t7,"et-EE":n7,"fi-FI":r7,"fr-FR":i7,"he-IL":s7,"hr-HR":o7,"hu-HU":a7,"it-IT":l7,"ja-JP":c7,"ko-KR":u7,"lt-LT":d7,"lv-LV":h7,"nb-NO":f7,"nl-NL":p7,"pl-PL":m7,"pt-BR":g7,"pt-PT":y7,"ro-RO":_7,"ru-RU":v7,"sk-SK":b7,"sl-SI":x7,"sr-SP":w7,"sv-SE":E7,"tr-TR":T7,"uk-UA":S7,"zh-CN":A7,"zh-TW":P7};function mf(t){let{onDismiss:e,...n}=t,r=Nl(Kve(K9)),i=mv(n,r.format("dismiss")),s=()=>{e&&e()};return ce.createElement(Wve,null,ce.createElement("button",{...i,tabIndex:-1,onClick:s}))}let Wp=new WeakMap,ko=[];function JR(t,e=document.body){let n=new Set(t),r=new Set,i=f=>{for(let T of f.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))n.add(T);let m=T=>{if(n.has(T)||r.has(T.parentElement)&&T.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let C of n)if(T.contains(C))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},x=document.createTreeWalker(f,NodeFilter.SHOW_ELEMENT,{acceptNode:m}),S=m(f);if(S===NodeFilter.FILTER_ACCEPT&&s(f),S!==NodeFilter.FILTER_REJECT){let T=x.nextNode();for(;T!=null;)s(T),T=x.nextNode()}},s=f=>{var m;let x=(m=Wp.get(f))!==null&&m!==void 0?m:0;f.getAttribute("aria-hidden")==="true"&&x===0||(x===0&&f.setAttribute("aria-hidden","true"),r.add(f),Wp.set(f,x+1))};ko.length&&ko[ko.length-1].disconnect(),i(e);let c=new MutationObserver(f=>{for(let m of f)if(!(m.type!=="childList"||m.addedNodes.length===0)&&![...n,...r].some(x=>x.contains(m.target))){for(let x of m.removedNodes)x instanceof Element&&(n.delete(x),r.delete(x));for(let x of m.addedNodes)(x instanceof HTMLElement||x instanceof SVGElement)&&(x.dataset.liveAnnouncer==="true"||x.dataset.reactAriaTopLayer==="true")?n.add(x):x instanceof Element&&i(x)}});c.observe(e,{childList:!0,subtree:!0});let o={observe(){c.observe(e,{childList:!0,subtree:!0})},disconnect(){c.disconnect()}};return ko.push(o),()=>{c.disconnect();for(let f of r){let m=Wp.get(f);m===1?(f.removeAttribute("aria-hidden"),Wp.delete(f)):Wp.set(f,m-1)}o===ko[ko.length-1]?(ko.pop(),ko.length&&ko[ko.length-1].observe()):ko.splice(ko.indexOf(o),1)}}function hbe(t,e){let{triggerRef:n,popoverRef:r,isNonModal:i,isKeyboardDismissDisabled:s,...c}=t,{overlayProps:o,underlayProps:f}=j9({isOpen:e.isOpen,onClose:e.close,shouldCloseOnBlur:!0,isDismissable:!i,isKeyboardDismissDisabled:s},r),{overlayProps:m,arrowProps:x,placement:S}=ibe({...c,targetRef:n,overlayRef:r,isOpen:e.isOpen,onClose:null});return W9({isDisabled:i}),wr(()=>{if(e.isOpen&&!i&&r.current)return JR([r.current])},[i,e.isOpen,r]),{popoverProps:kn(o,m),arrowProps:x,underlayProps:f,placement:S}}const C7=ce.createContext(null);function fbe(t){let e=Sf(),{portalContainer:n=e?null:document.body}=t,[r,i]=ee.useState(!1),s=ee.useMemo(()=>({contain:r,setContain:i}),[r,i]);if(!n)return null;let c=ce.createElement(C7.Provider,{value:s},ce.createElement(qR,{restoreFocus:!0,contain:r},t.children));return Ah.createPortal(c,n)}function I7(){let t=ee.useContext(C7),e=t==null?void 0:t.setContain;wr(()=>{e==null||e(!0)},[e])}function pbe(t,e,n){let{overlayProps:r,underlayProps:i}=j9({...t,isOpen:e.isOpen,onClose:e.close},n);return W9({isDisabled:!e.isOpen}),I7(),ee.useEffect(()=>{if(e.isOpen)return JR([n.current])},[e.isOpen,n]),{modalProps:kn(r),underlayProps:i}}function KO(t){return t&&t.__esModule?t.default:t}function Ib(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}const QR=ce.createContext(null);QR.displayName="ProviderContext";var L7={};Ib(L7,"spectrum",()=>HE,t=>HE=t);var HE;HE="spectrum_b37d53";var Lb={};Ib(Lb,"spectrum",()=>WE,t=>WE=t);Ib(Lb,"spectrum-Body",()=>KE,t=>KE=t);Ib(Lb,"spectrum-Body--italic",()=>qE,t=>qE=t);var WE,KE,qE;WE="spectrum_2a241c";KE="spectrum-Body_2a241c";qE="spectrum-Body--italic_2a241c";function mbe(t,e){let n=OE("(prefers-color-scheme: dark)"),r=OE("(prefers-color-scheme: light)");return t.dark&&n?"dark":t.light&&r?"light":t.dark&&e==="dark"?"dark":t.light&&e==="light"||!t.dark||t.light?"light":"dark"}function gbe(t){return OE("(any-pointer: fine)")&&t.medium?"medium":t.large?"large":"medium"}var R7={};R7=JSON.parse('{"name":"@react-spectrum/provider","version":"3.7.1","description":"Spectrum UI components in React","license":"Apache-2.0","main":"dist/main.js","module":"dist/module.js","exports":{"types":"./dist/types.d.ts","import":"./dist/import.mjs","require":"./dist/main.js"},"types":"dist/types.d.ts","source":"src/index.ts","files":["dist","src"],"sideEffects":["*.css"],"targets":{"main":{"includeNodeModules":["@adobe/spectrum-css-temp"]},"module":{"includeNodeModules":["@adobe/spectrum-css-temp"]}},"repository":{"type":"git","url":"https://github.com/adobe/react-spectrum"},"dependencies":{"@react-aria/i18n":"^3.7.1","@react-aria/overlays":"^3.14.0","@react-aria/utils":"^3.16.0","@react-spectrum/utils":"^3.9.1","@react-types/provider":"^3.6.1","@react-types/shared":"^3.18.0","@swc/helpers":"^0.4.14","clsx":"^1.1.1"},"devDependencies":{"@adobe/spectrum-css-temp":"3.0.0-alpha.1"},"peerDependencies":{"react":"^16.8.0 || ^17.0.0-rc.1 || ^18.0.0","react-dom":"^16.8.0 || ^17.0.0-rc.1 || ^18.0.0"},"publishConfig":{"access":"public"}}');const ybe={S:640,M:768,L:1024,XL:1280,XXL:1536};function _be(t,e){let n=yd(),r=n&&n.colorScheme,i=n&&n.breakpoints,{theme:s=n&&n.theme,defaultColorScheme:c}=t;if(!s)throw new Error("theme not found, the parent provider must have a theme provided");let o=mbe(s,c),f=gbe(s),{locale:m}=pa(),x=!!s[r],{colorScheme:S=x?r:o,scale:T=n?n.scale:f,locale:C=n?m:null,breakpoints:R=n?i:ybe,children:D,isQuiet:H,isEmphasized:F,isDisabled:k,isRequired:N,isReadOnly:U,validationState:ie,...he}=t,le={version:R7.version,theme:s,breakpoints:R,colorScheme:S,scale:T,isQuiet:H,isEmphasized:F,isDisabled:k,isRequired:N,isReadOnly:U,validationState:ie},ve=nve(R),Oe={};Object.entries(le).forEach(([Be,Jt])=>Jt!==void 0&&(Oe[Be]=Jt));let Re=Object.assign({},n,Oe),Ee=D,$e=ps(he),{styleProps:we}=Ni(he,void 0,{matchedBreakpoints:ve});return(!n||t.locale||s!==n.theme||S!==n.colorScheme||T!==n.scale||Object.keys($e).length>0||he.UNSAFE_className||Object.keys(we.style).length>0)&&(Ee=ce.createElement(vbe,{...t,UNSAFE_style:{isolation:n?void 0:"isolate",...we.style},ref:e},Ee)),ce.createElement(QR.Provider,{value:Re},ce.createElement(J0e,{locale:C},ce.createElement(tve,{matchedBreakpoints:ve},ce.createElement(ube,null,Ee))))}let $7=ce.forwardRef(_be);const vbe=ce.forwardRef(function(e,n){let{children:r,...i}=e,{locale:s,direction:c}=pa(),{theme:o,colorScheme:f,scale:m}=yd(),{modalProviderProps:x}=dbe(),{styleProps:S}=Ni(i),T=ma(n),C=Object.keys(o[f])[0],R=Object.keys(o[m])[0],D=wb(S.className,KO(L7).spectrum,KO(Lb).spectrum,Object.values(o[f]),Object.values(o[m]),o.global?Object.values(o.global):null,{"react-spectrum-provider":$_,spectrum:$_,[C]:$_,[R]:$_});var H,F;let k={...S.style,colorScheme:(F=(H=e.colorScheme)!==null&&H!==void 0?H:f)!==null&&F!==void 0?F:Object.keys(o).filter(U=>U==="light"||U==="dark").join(" ")},N=ee.useRef(!1);return ee.useEffect(()=>{if(c&&T.current){let U=T.current.parentElement.closest("[dir]"),ie=U&&U.getAttribute("dir");ie&&ie!==c&&!N.current&&(console.warn(`Language directions cannot be nested. ${c} inside ${ie}.`),N.current=!0)}},[c,T,N]),ce.createElement("div",{...ps(i),...S,...x,className:D,style:k,lang:s,dir:c,ref:T},r)});function yd(){return ee.useContext(QR)}function Rb(t){let e=yd();return e?Object.assign({},{isQuiet:e.isQuiet,isEmphasized:e.isEmphasized,isDisabled:e.isDisabled,isRequired:e.isRequired,isReadOnly:e.isReadOnly,validationState:e.validationState},t):t}var M7={};Object.defineProperty(M7,"__esModule",{value:!0});var bbe=M7.CornerTriangle=k7,Sw=xbe(ee);function xbe(t){return t&&t.__esModule?t:{default:t}}function XE(){return XE=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},XE.apply(this,arguments)}function wbe(t,e){if(t==null)return{};var n=Ebe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Ebe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function k7(t){var e=t.scale,n=e===void 0?"M":e,r=wbe(t,["scale"]);return Sw.default.createElement("svg",XE({},r,r),n==="L"&&Sw.default.createElement("path",{d:"M5.74.01a.25.25 0 0 0-.177.073l-5.48 5.48a.25.25 0 0 0 .177.427h5.48a.25.25 0 0 0 .25-.25V.26a.25.25 0 0 0-.25-.25z"}),n==="M"&&Sw.default.createElement("path",{d:"M4.74.01a.25.25 0 0 0-.177.073l-4.48 4.48a.25.25 0 0 0 .177.427h4.48a.25.25 0 0 0 .25-.25V.26a.25.25 0 0 0-.25-.25z"}))}k7.displayName="CornerTriangle";function Tbe(t){return t&&t.__esModule?t.default:t}function sn(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var nn={};sn(nn,"spectrum-Icon",()=>ZE,t=>ZE=t);sn(nn,"spectrum-UIIcon",()=>YE,t=>YE=t);sn(nn,"spectrum-Icon--sizeXXS",()=>JE,t=>JE=t);sn(nn,"spectrum-Icon--sizeXS",()=>QE,t=>QE=t);sn(nn,"spectrum-Icon--sizeS",()=>eT,t=>eT=t);sn(nn,"spectrum-Icon--sizeM",()=>tT,t=>tT=t);sn(nn,"spectrum-Icon--sizeL",()=>nT,t=>nT=t);sn(nn,"spectrum-Icon--sizeXL",()=>rT,t=>rT=t);sn(nn,"spectrum-Icon--sizeXXL",()=>iT,t=>iT=t);sn(nn,"spectrum--medium",()=>sT,t=>sT=t);sn(nn,"spectrum-UIIcon--large",()=>oT,t=>oT=t);sn(nn,"spectrum-UIIcon--medium",()=>aT,t=>aT=t);sn(nn,"spectrum--large",()=>lT,t=>lT=t);sn(nn,"spectrum-UIIcon-AlertMedium",()=>cT,t=>cT=t);sn(nn,"spectrum-UIIcon-AlertSmall",()=>uT,t=>uT=t);sn(nn,"spectrum-UIIcon-ArrowDownSmall",()=>dT,t=>dT=t);sn(nn,"spectrum-UIIcon-ArrowLeftMedium",()=>hT,t=>hT=t);sn(nn,"spectrum-UIIcon-Asterisk",()=>fT,t=>fT=t);sn(nn,"spectrum-UIIcon-CheckmarkMedium",()=>pT,t=>pT=t);sn(nn,"spectrum-UIIcon-CheckmarkSmall",()=>mT,t=>mT=t);sn(nn,"spectrum-UIIcon-ChevronDownMedium",()=>gT,t=>gT=t);sn(nn,"spectrum-UIIcon-ChevronDownSmall",()=>yT,t=>yT=t);sn(nn,"spectrum-UIIcon-ChevronLeftLarge",()=>_T,t=>_T=t);sn(nn,"spectrum-UIIcon-ChevronLeftMedium",()=>vT,t=>vT=t);sn(nn,"spectrum-UIIcon-ChevronRightLarge",()=>bT,t=>bT=t);sn(nn,"spectrum-UIIcon-ChevronRightMedium",()=>xT,t=>xT=t);sn(nn,"spectrum-UIIcon-ChevronRightSmall",()=>wT,t=>wT=t);sn(nn,"spectrum-UIIcon-ChevronUpSmall",()=>ET,t=>ET=t);sn(nn,"spectrum-UIIcon-CornerTriangle",()=>TT,t=>TT=t);sn(nn,"spectrum-UIIcon-CrossLarge",()=>ST,t=>ST=t);sn(nn,"spectrum-UIIcon-CrossMedium",()=>AT,t=>AT=t);sn(nn,"spectrum-UIIcon-CrossSmall",()=>PT,t=>PT=t);sn(nn,"spectrum-UIIcon-DashSmall",()=>CT,t=>CT=t);sn(nn,"spectrum-UIIcon-DoubleGripper",()=>IT,t=>IT=t);sn(nn,"spectrum-UIIcon-FolderBreadcrumb",()=>LT,t=>LT=t);sn(nn,"spectrum-UIIcon-HelpMedium",()=>RT,t=>RT=t);sn(nn,"spectrum-UIIcon-HelpSmall",()=>$T,t=>$T=t);sn(nn,"spectrum-UIIcon-InfoMedium",()=>MT,t=>MT=t);sn(nn,"spectrum-UIIcon-InfoSmall",()=>kT,t=>kT=t);sn(nn,"spectrum-UIIcon-ListGripper",()=>OT,t=>OT=t);sn(nn,"spectrum-UIIcon-Magnifier",()=>DT,t=>DT=t);sn(nn,"spectrum-UIIcon-SkipLeft",()=>FT,t=>FT=t);sn(nn,"spectrum-UIIcon-SkipRight",()=>zT,t=>zT=t);sn(nn,"spectrum-UIIcon-Star",()=>NT,t=>NT=t);sn(nn,"spectrum-UIIcon-StarOutline",()=>BT,t=>BT=t);sn(nn,"spectrum-UIIcon-SuccessMedium",()=>UT,t=>UT=t);sn(nn,"spectrum-UIIcon-SuccessSmall",()=>VT,t=>VT=t);sn(nn,"spectrum-UIIcon-TripleGripper",()=>GT,t=>GT=t);var ZE,YE,JE,QE,eT,tT,nT,rT,iT,sT,oT,aT,lT,cT,uT,dT,hT,fT,pT,mT,gT,yT,_T,vT,bT,xT,wT,ET,TT,ST,AT,PT,CT,IT,LT,RT,$T,MT,kT,OT,DT,FT,zT,NT,BT,UT,VT,GT;ZE="spectrum-Icon_368b34";YE="spectrum-UIIcon_368b34";JE="spectrum-Icon--sizeXXS_368b34";QE="spectrum-Icon--sizeXS_368b34";eT="spectrum-Icon--sizeS_368b34";tT="spectrum-Icon--sizeM_368b34";nT="spectrum-Icon--sizeL_368b34";rT="spectrum-Icon--sizeXL_368b34";iT="spectrum-Icon--sizeXXL_368b34";sT="spectrum--medium_368b34";oT="spectrum-UIIcon--large_368b34";aT="spectrum-UIIcon--medium_368b34";lT="spectrum--large_368b34";cT="spectrum-UIIcon-AlertMedium_368b34";uT="spectrum-UIIcon-AlertSmall_368b34";dT="spectrum-UIIcon-ArrowDownSmall_368b34";hT="spectrum-UIIcon-ArrowLeftMedium_368b34";fT="spectrum-UIIcon-Asterisk_368b34";pT="spectrum-UIIcon-CheckmarkMedium_368b34";mT="spectrum-UIIcon-CheckmarkSmall_368b34";gT="spectrum-UIIcon-ChevronDownMedium_368b34";yT="spectrum-UIIcon-ChevronDownSmall_368b34";_T="spectrum-UIIcon-ChevronLeftLarge_368b34";vT="spectrum-UIIcon-ChevronLeftMedium_368b34";bT="spectrum-UIIcon-ChevronRightLarge_368b34";xT="spectrum-UIIcon-ChevronRightMedium_368b34";wT="spectrum-UIIcon-ChevronRightSmall_368b34";ET="spectrum-UIIcon-ChevronUpSmall_368b34";TT="spectrum-UIIcon-CornerTriangle_368b34";ST="spectrum-UIIcon-CrossLarge_368b34";AT="spectrum-UIIcon-CrossMedium_368b34";PT="spectrum-UIIcon-CrossSmall_368b34";CT="spectrum-UIIcon-DashSmall_368b34";IT="spectrum-UIIcon-DoubleGripper_368b34";LT="spectrum-UIIcon-FolderBreadcrumb_368b34";RT="spectrum-UIIcon-HelpMedium_368b34";$T="spectrum-UIIcon-HelpSmall_368b34";MT="spectrum-UIIcon-InfoMedium_368b34";kT="spectrum-UIIcon-InfoSmall_368b34";OT="spectrum-UIIcon-ListGripper_368b34";DT="spectrum-UIIcon-Magnifier_368b34";FT="spectrum-UIIcon-SkipLeft_368b34";zT="spectrum-UIIcon-SkipRight_368b34";NT="spectrum-UIIcon-Star_368b34";BT="spectrum-UIIcon-StarOutline_368b34";UT="spectrum-UIIcon-SuccessMedium_368b34";VT="spectrum-UIIcon-SuccessSmall_368b34";GT="spectrum-UIIcon-TripleGripper_368b34";function Sbe(t){return`var(--spectrum-semantic-${t}-color-icon)`}({...Tb});function Pf(t){t=Fg(t,"icon");let{children:e,"aria-label":n,"aria-hidden":r,...i}=t,{styleProps:s}=Ni(i),c=yd(),o="M";return c!==null&&(o=c.scale==="large"?"L":"M"),r||(r=void 0),ce.cloneElement(e,{...ps(i),...s,scale:o,focusable:"false","aria-label":n,"aria-hidden":n?r||void 0:!0,role:"img",className:st(Tbe(nn),e.props.className,"spectrum-Icon",{[`spectrum-UIIcon-${e.type.displayName}`]:e.type.displayName},s.className)})}function Abe(t){return ce.createElement(Pf,t,ce.createElement(bbe,null))}var O7={};Object.defineProperty(O7,"__esModule",{value:!0});var Pbe=O7.CrossSmall=D7,Aw=Cbe(ee);function Cbe(t){return t&&t.__esModule?t:{default:t}}function jT(){return jT=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jT.apply(this,arguments)}function Ibe(t,e){if(t==null)return{};var n=Lbe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Lbe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function D7(t){var e=t.scale,n=e===void 0?"M":e,r=Ibe(t,["scale"]);return Aw.default.createElement("svg",jT({},r,r),n==="L"&&Aw.default.createElement("path",{d:"M9.317 8.433L5.884 5l3.433-3.433a.625.625 0 1 0-.884-.884L5 4.116 1.567.683a.625.625 0 1 0-.884.884C.83 1.713 2.77 3.657 4.116 5L.683 8.433a.625.625 0 1 0 .884.884L5 5.884l3.433 3.433a.625.625 0 0 0 .884-.884z"}),n==="M"&&Aw.default.createElement("path",{d:"M7.317 6.433L4.884 4l2.433-2.433a.625.625 0 1 0-.884-.884L4 3.116 1.567.683a.625.625 0 1 0-.884.884L3.116 4 .683 6.433a.625.625 0 1 0 .884.884L4 4.884l2.433 2.433a.625.625 0 0 0 .884-.884z"}))}D7.displayName="CrossSmall";function Rbe(t){return ce.createElement(Pf,t,ce.createElement(Pbe,null))}function oa(t){return t&&t.__esModule?t.default:t}function nr(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var En={};nr(En,"spectrum-Button",()=>HT,t=>HT=t);nr(En,"spectrum-ActionButton",()=>WT,t=>WT=t);nr(En,"spectrum-LogicButton",()=>KT,t=>KT=t);nr(En,"spectrum-FieldButton",()=>qT,t=>qT=t);nr(En,"spectrum-ClearButton",()=>XT,t=>XT=t);nr(En,"focus-ring",()=>ZT,t=>ZT=t);nr(En,"spectrum-FieldButton--quiet",()=>YT,t=>YT=t);nr(En,"spectrum-Icon",()=>JT,t=>JT=t);nr(En,"is-hovered",()=>QT,t=>QT=t);nr(En,"spectrum-Button-label",()=>eS,t=>eS=t);nr(En,"spectrum-Button--iconOnly",()=>tS,t=>tS=t);nr(En,"spectrum-ActionButton-label",()=>nS,t=>nS=t);nr(En,"spectrum-ActionButton-hold",()=>rS,t=>rS=t);nr(En,"spectrum-ActionButton--quiet",()=>iS,t=>iS=t);nr(En,"is-disabled",()=>sS,t=>sS=t);nr(En,"is-open",()=>oS,t=>oS=t);nr(En,"spectrum-ClearButton--small",()=>aS,t=>aS=t);nr(En,"is-active",()=>lS,t=>lS=t);nr(En,"spectrum-ClearButton--overBackground",()=>cS,t=>cS=t);nr(En,"is-selected",()=>uS,t=>uS=t);nr(En,"spectrum-ActionButton--emphasized",()=>dS,t=>dS=t);nr(En,"spectrum-ActionButton--staticWhite",()=>hS,t=>hS=t);nr(En,"spectrum-ActionButton--staticBlack",()=>fS,t=>fS=t);nr(En,"spectrum-ActionButton--staticColor",()=>pS,t=>pS=t);nr(En,"spectrum-LogicButton--and",()=>mS,t=>mS=t);nr(En,"spectrum-LogicButton--or",()=>gS,t=>gS=t);nr(En,"is-focused",()=>yS,t=>yS=t);nr(En,"is-placeholder",()=>_S,t=>_S=t);nr(En,"spectrum-FieldButton--invalid",()=>vS,t=>vS=t);nr(En,"spectrum-Button--overBackground",()=>bS,t=>bS=t);var HT,WT,KT,qT,XT,ZT,YT,JT,QT,eS,tS,nS,rS,iS,sS,oS,aS,lS,cS,uS,dS,hS,fS,pS,mS,gS,yS,_S,vS,bS;HT="spectrum-Button_e2d99e";WT="spectrum-ActionButton_e2d99e";KT="spectrum-LogicButton_e2d99e";qT="spectrum-FieldButton_e2d99e";XT="spectrum-ClearButton_e2d99e";ZT="focus-ring_e2d99e";YT="spectrum-FieldButton--quiet_e2d99e";JT="spectrum-Icon_e2d99e";QT="is-hovered_e2d99e";eS="spectrum-Button-label_e2d99e";tS="spectrum-Button--iconOnly_e2d99e";nS="spectrum-ActionButton-label_e2d99e";rS="spectrum-ActionButton-hold_e2d99e";iS="spectrum-ActionButton--quiet_e2d99e";sS="is-disabled_e2d99e";oS="is-open_e2d99e";aS="spectrum-ClearButton--small_e2d99e";lS="is-active_e2d99e";cS="spectrum-ClearButton--overBackground_e2d99e";uS="is-selected_e2d99e";dS="spectrum-ActionButton--emphasized_e2d99e";hS="spectrum-ActionButton--staticWhite_e2d99e";fS="spectrum-ActionButton--staticBlack_e2d99e";pS="spectrum-ActionButton--staticColor_e2d99e";mS="spectrum-LogicButton--and_e2d99e";gS="spectrum-LogicButton--or_e2d99e";yS="is-focused_e2d99e";_S="is-placeholder_e2d99e";vS="spectrum-FieldButton--invalid_e2d99e";bS="spectrum-Button--overBackground_e2d99e";function $be(t,e){t=Rb(t),t=Fg(t,"actionButton");let{isQuiet:n,isDisabled:r,staticColor:i,children:s,autoFocus:c,holdAffordance:o,...f}=t,m=Dg(e),{buttonProps:x,isPressed:S}=Cb(t,m),{hoverProps:T,isHovered:C}=Xc({isDisabled:r}),{styleProps:R}=Ni(f),D=ce.Children.toArray(t.children).every(H=>!ce.isValidElement(H));return ce.createElement(Af,{focusRingClass:st(oa(En),"focus-ring"),autoFocus:c},ce.createElement("button",{...R,...kn(x,T),ref:m,className:st(oa(En),"spectrum-ActionButton",{"spectrum-ActionButton--quiet":n,"spectrum-ActionButton--staticColor":!!i,"spectrum-ActionButton--staticWhite":i==="white","spectrum-ActionButton--staticBlack":i==="black","is-active":S,"is-disabled":r,"is-hovered":C},R.className)},o&&ce.createElement(Abe,{UNSAFE_className:st(oa(En),"spectrum-ActionButton-hold")}),ce.createElement(Sb,{slots:{icon:{size:"S",UNSAFE_className:st(oa(En),"spectrum-Icon")},text:{UNSAFE_className:st(oa(En),"spectrum-ActionButton-label")}}},typeof s=="string"||D?ce.createElement(YR,null,s):s)))}let Mbe=ce.forwardRef($be);function kbe(t,e){t=Fg(t,"button");let{isQuiet:n,isDisabled:r,validationState:i,children:s,autoFocus:c,isActive:o,focusRingClass:f,...m}=t,x=Dg(e),{buttonProps:S,isPressed:T}=Cb(t,x),{hoverProps:C,isHovered:R}=Xc({isDisabled:r}),{styleProps:D}=Ni(m);return ce.createElement(Af,{focusRingClass:st(oa(En),"focus-ring",f),autoFocus:c},ce.createElement("button",{...kn(S,C),ref:x,className:st(oa(En),"spectrum-FieldButton",{"spectrum-FieldButton--quiet":n,"is-active":o||T,"is-disabled":r,"spectrum-FieldButton--invalid":i==="invalid","is-hovered":R},D.className)},ce.createElement(Sb,{slots:{icon:{size:"S",UNSAFE_className:st(oa(En),"spectrum-Icon")}}},s)))}let Obe=ce.forwardRef(kbe);function Dbe(t,e){let{children:n=ce.createElement(Rbe,{UNSAFE_className:oa(En)["spectrum-Icon"]}),focusClassName:r,variant:i,autoFocus:s,isDisabled:c,preventFocus:o,elementType:f=o?"div":"button",...m}=t,x=Dg(e),{buttonProps:S,isPressed:T}=Cb({...t,elementType:f},x),{hoverProps:C,isHovered:R}=Xc({isDisabled:c}),{styleProps:D}=Ni(m);o&&delete S.tabIndex;let H=f;return ce.createElement(Af,{focusRingClass:st(oa(En),"focus-ring",r),autoFocus:s},ce.createElement(H,{...D,...kn(S,C),ref:x,className:st(oa(En),"spectrum-ClearButton",{[`spectrum-ClearButton--${i}`]:i,"is-disabled":c,"is-active":T,"is-hovered":R},D.className)},n))}let Fbe=ce.forwardRef(Dbe);var F7={};Object.defineProperty(F7,"__esModule",{value:!0});var zbe=F7.ChevronDownMedium=z7,Pw=Nbe(ee);function Nbe(t){return t&&t.__esModule?t:{default:t}}function xS(){return xS=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xS.apply(this,arguments)}function Bbe(t,e){if(t==null)return{};var n=Ube(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Ube(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function z7(t){var e=t.scale,n=e===void 0?"M":e,r=Bbe(t,["scale"]);return Pw.default.createElement("svg",xS({},r,r),n==="L"&&Pw.default.createElement("path",{d:"M11.99 1.51a1 1 0 0 0-1.707-.707L6 5.086 1.717.803A1 1 0 1 0 .303 2.217l4.99 4.99a1 1 0 0 0 1.414 0l4.99-4.99a.997.997 0 0 0 .293-.707z"}),n==="M"&&Pw.default.createElement("path",{d:"M9.99 1.01A1 1 0 0 0 8.283.303L5 3.586 1.717.303A1 1 0 1 0 .303 1.717l3.99 3.98a1 1 0 0 0 1.414 0l3.99-3.98a.997.997 0 0 0 .293-.707z"}))}z7.displayName="ChevronDownMedium";function N7(t){return ce.createElement(Pf,t,ce.createElement(zbe,null))}function wS(){return wS=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wS.apply(this,arguments)}function Vbe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function ES(t,e){return ES=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},ES(t,e)}function Gbe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,ES(t,e)}const qO={disabled:!1},B7=ce.createContext(null);var jbe=function(e){return e.scrollTop},am="unmounted",Ru="exited",$u="entering",dh="entered",TS="exiting",Bl=function(t){Gbe(e,t);function e(r,i){var s;s=t.call(this,r,i)||this;var c=i,o=c&&!c.isMounting?r.enter:r.appear,f;return s.appearStatus=null,r.in?o?(f=Ru,s.appearStatus=$u):f=dh:r.unmountOnExit||r.mountOnEnter?f=am:f=Ru,s.state={status:f},s.nextCallback=null,s}e.getDerivedStateFromProps=function(i,s){var c=i.in;return c&&s.status===am?{status:Ru}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(i){var s=null;if(i!==this.props){var c=this.state.status;this.props.in?c!==$u&&c!==dh&&(s=$u):(c===$u||c===dh)&&(s=TS)}this.updateStatus(!1,s)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var i=this.props.timeout,s,c,o;return s=c=o=i,i!=null&&typeof i!="number"&&(s=i.exit,c=i.enter,o=i.appear!==void 0?i.appear:c),{exit:s,enter:c,appear:o}},n.updateStatus=function(i,s){if(i===void 0&&(i=!1),s!==null)if(this.cancelNextCallback(),s===$u){if(this.props.unmountOnExit||this.props.mountOnEnter){var c=this.props.nodeRef?this.props.nodeRef.current:Ah.findDOMNode(this);c&&jbe(c)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ru&&this.setState({status:am})},n.performEnter=function(i){var s=this,c=this.props.enter,o=this.context?this.context.isMounting:i,f=this.props.nodeRef?[o]:[Ah.findDOMNode(this),o],m=f[0],x=f[1],S=this.getTimeouts(),T=o?S.appear:S.enter;if(!i&&!c||qO.disabled){this.safeSetState({status:dh},function(){s.props.onEntered(m)});return}this.props.onEnter(m,x),this.safeSetState({status:$u},function(){s.props.onEntering(m,x),s.onTransitionEnd(T,function(){s.safeSetState({status:dh},function(){s.props.onEntered(m,x)})})})},n.performExit=function(){var i=this,s=this.props.exit,c=this.getTimeouts(),o=this.props.nodeRef?void 0:Ah.findDOMNode(this);if(!s||qO.disabled){this.safeSetState({status:Ru},function(){i.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:TS},function(){i.props.onExiting(o),i.onTransitionEnd(c.exit,function(){i.safeSetState({status:Ru},function(){i.props.onExited(o)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(i,s){s=this.setNextCallback(s),this.setState(i,s)},n.setNextCallback=function(i){var s=this,c=!0;return this.nextCallback=function(o){c&&(c=!1,s.nextCallback=null,i(o))},this.nextCallback.cancel=function(){c=!1},this.nextCallback},n.onTransitionEnd=function(i,s){this.setNextCallback(s);var c=this.props.nodeRef?this.props.nodeRef.current:Ah.findDOMNode(this),o=i==null&&!this.props.addEndListener;if(!c||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var f=this.props.nodeRef?[this.nextCallback]:[c,this.nextCallback],m=f[0],x=f[1];this.props.addEndListener(m,x)}i!=null&&setTimeout(this.nextCallback,i)},n.render=function(){var i=this.state.status;if(i===am)return null;var s=this.props,c=s.children;s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef;var o=Vbe(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return ce.createElement(B7.Provider,{value:null},typeof c=="function"?c(i,o):ce.cloneElement(ce.Children.only(c),o))},e}(ce.Component);Bl.contextType=B7;Bl.propTypes={};function ah(){}Bl.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ah,onEntering:ah,onEntered:ah,onExit:ah,onExiting:ah,onExited:ah};Bl.UNMOUNTED=am;Bl.EXITED=Ru;Bl.ENTERING=$u;Bl.ENTERED=dh;Bl.EXITING=TS;const Hbe=Bl;function zc(t){return t&&t.__esModule?t.default:t}function Xn(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}const Wbe={entering:!1,entered:!0};function Kbe(t){return ce.createElement(Hbe,{timeout:{enter:0,exit:350},...t},e=>ce.Children.map(t.children,n=>n&&ce.cloneElement(n,{isOpen:!!Wbe[e]})))}function qbe(t,e){let{children:n,isOpen:r,container:i,onEnter:s,onEntering:c,onEntered:o,onExit:f,onExiting:m,onExited:x,nodeRef:S}=t,[T,C]=ee.useState(!r),R=ee.useCallback(()=>{C(!1),o&&o()},[o]),D=ee.useCallback(()=>{C(!0),x&&x()},[x]);return r||!T?ce.createElement(fbe,{portalContainer:i},ce.createElement($7,{ref:e,UNSAFE_style:{background:"transparent",isolation:"isolate"},isDisabled:!1},ce.createElement(Kbe,{in:r,appear:!0,onExit:f,onExiting:m,onExited:D,onEnter:s,onEntering:c,onEntered:R,nodeRef:S},n))):null}let U7=ce.forwardRef(qbe);var ga={};Xn(ga,"spectrum-Popover",()=>SS,t=>SS=t);Xn(ga,"react-spectrum-Popover",()=>AS,t=>AS=t);Xn(ga,"spectrum-Dialog-content",()=>PS,t=>PS=t);Xn(ga,"spectrum-Modal-wrapper",()=>CS,t=>CS=t);Xn(ga,"react-spectrum-Modal-wrapper",()=>IS,t=>IS=t);Xn(ga,"spectrum-Modal",()=>LS,t=>LS=t);Xn(ga,"react-spectrum-Modal",()=>RS,t=>RS=t);Xn(ga,"spectrum-Tray",()=>$S,t=>$S=t);Xn(ga,"react-spectrum-Tray",()=>MS,t=>MS=t);var SS,AS,PS,CS,IS,LS,RS,$S,MS;SS="spectrum-Popover_38efea";AS="react-spectrum-Popover_38efea";PS="spectrum-Dialog-content_38efea";CS="spectrum-Modal-wrapper_38efea";IS="react-spectrum-Modal-wrapper_38efea";LS="spectrum-Modal_38efea";RS="react-spectrum-Modal_38efea";$S="spectrum-Tray_38efea";MS="react-spectrum-Tray_38efea";var wo={};Xn(wo,"spectrum-Popover",()=>kS,t=>kS=t);Xn(wo,"is-open",()=>OS,t=>OS=t);Xn(wo,"spectrum-Popover--bottom",()=>DS,t=>DS=t);Xn(wo,"spectrum-Popover--top",()=>FS,t=>FS=t);Xn(wo,"spectrum-Popover--right",()=>zS,t=>zS=t);Xn(wo,"spectrum-Popover--left",()=>NS,t=>NS=t);Xn(wo,"spectrum-Popover-tip",()=>BS,t=>BS=t);Xn(wo,"spectrum-Popover-tip-triangle",()=>US,t=>US=t);Xn(wo,"spectrum-Popover--dialog",()=>VS,t=>VS=t);Xn(wo,"spectrum-Popover--withTip",()=>GS,t=>GS=t);var kS,OS,DS,FS,zS,NS,BS,US,VS,GS;kS="spectrum-Popover_6115b8";OS="is-open_6115b8";DS="spectrum-Popover--bottom_6115b8";FS="spectrum-Popover--top_6115b8";zS="spectrum-Popover--right_6115b8";NS="spectrum-Popover--left_6115b8";BS="spectrum-Popover-tip_6115b8";US="spectrum-Popover-tip-triangle_6115b8";VS="spectrum-Popover--dialog_6115b8";GS="spectrum-Popover--withTip_6115b8";var $b={};Xn($b,"spectrum-Underlay",()=>jS,t=>jS=t);Xn($b,"is-open",()=>HS,t=>HS=t);Xn($b,"spectrum-Underlay--transparent",()=>WS,t=>WS=t);var jS,HS,WS;jS="spectrum-Underlay_eb7615";HS="is-open_eb7615";WS="spectrum-Underlay--transparent_eb7615";function V7({isOpen:t,isTransparent:e}){return ce.createElement("div",{className:st(zc($b),"spectrum-Underlay",{"is-open":t,"spectrum-Underlay--transparent":e})})}let Xbe={left:"right",right:"right",top:"bottom",bottom:"bottom"};function Zbe(t,e){let{children:n,state:r,...i}=t,s=ma(e),c=ee.useRef(null);return ce.createElement(U7,{...i,isOpen:r.isOpen,nodeRef:c},ce.createElement(Ybe,{ref:s,...t,wrapperRef:c},n))}const Ybe=ee.forwardRef((t,e)=>{let{children:n,isOpen:r,hideArrow:i,isNonModal:s,state:c,wrapperRef:o}=t,{styleProps:f}=Ni(t),{size:m,borderWidth:x,arrowRef:S}=Qbe();const T=Jbe(e);let C=x*Math.SQRT2,R=m+C,D=R*2,{popoverProps:H,arrowProps:F,underlayProps:k,placement:N}=hbe({...t,popoverRef:e,maxHeight:null,arrowSize:i?0:D,arrowBoundaryOffset:T},c);return ce.createElement("div",{ref:o},!s&&ce.createElement(V7,{isTransparent:!0,...k,isOpen:r}),ce.createElement("div",{...f,...H,style:{...f.style,...H.style},ref:e,className:st(zc(wo),"spectrum-Popover",`spectrum-Popover--${N}`,{"spectrum-Popover--withTip":!i,"is-open":r},st(zc(ga),"spectrum-Popover","react-spectrum-Popover"),f.className),role:"presentation","data-testid":"popover"},!s&&ce.createElement(mf,{onDismiss:c.close}),n,i?null:ce.createElement(e1e,{arrowProps:F,isLandscape:Xbe[N]==="bottom",arrowRef:S,primary:R,secondary:D,borderDiagonal:C}),ce.createElement(mf,{onDismiss:c.close})))});function Jbe(t){let[e,n]=ee.useState(0);return wr(()=>{if(t.current){let r=window.getComputedStyle(t.current).borderRadius;r!==""&&n(parseInt(r,10))}},[t]),e}function Qbe(){let[t,e]=ee.useState(20),[n,r]=ee.useState(1),i=ee.useRef(null);return wr(()=>{if(i.current){let s=window.getComputedStyle(i.current).getPropertyValue("--spectrum-popover-tip-size");s!==""&&e(parseInt(s,10)/2);let c=window.getComputedStyle(i.current).getPropertyValue("--spectrum-popover-tip-borderWidth");c!==""&&r(parseInt(c,10))}},[]),{size:t,borderWidth:n,arrowRef:i}}function e1e(t){let{primary:e,secondary:n,isLandscape:r,arrowProps:i,borderDiagonal:s,arrowRef:c}=t,o=s/2,f=0,m=e-o,x=o,S=n/2,T=n-o,C=r?["M",x,f,"L",S,m,"L",T,f]:["M",f,x,"L",m,S,"L",f,T];return ce.createElement("svg",{xmlns:"http://www.w3.org/svg/2000",width:Math.ceil(r?n:e),height:Math.ceil(r?e:n),className:st(zc(wo),"spectrum-Popover-tip"),ref:c,...i},ce.createElement("path",{className:st(zc(wo),"spectrum-Popover-tip-triangle"),d:C.join(" ")}))}let t1e=ee.forwardRef(Zbe);var Cf={};Xn(Cf,"spectrum-Modal",()=>KS,t=>KS=t);Xn(Cf,"is-open",()=>qS,t=>qS=t);Xn(Cf,"spectrum-Modal-wrapper",()=>XS,t=>XS=t);Xn(Cf,"spectrum-Modal--responsive",()=>ZS,t=>ZS=t);Xn(Cf,"spectrum-Modal--fullscreen",()=>YS,t=>YS=t);Xn(Cf,"spectrum-Modal--fullscreenTakeover",()=>JS,t=>JS=t);var KS,qS,XS,ZS,YS,JS;KS="spectrum-Modal_f81956";qS="is-open_f81956";XS="spectrum-Modal-wrapper_f81956";ZS="spectrum-Modal--responsive_f81956";YS="spectrum-Modal--fullscreen_f81956";JS="spectrum-Modal--fullscreenTakeover_f81956";var gf={};Xn(gf,"spectrum-Tray",()=>QS,t=>QS=t);Xn(gf,"is-open",()=>eA,t=>eA=t);Xn(gf,"spectrum-Tray-wrapper",()=>tA,t=>tA=t);Xn(gf,"spectrum-Tray--fixedHeight",()=>nA,t=>nA=t);var QS,eA,tA,nA;QS="spectrum-Tray_23bf66";eA="is-open_23bf66";tA="spectrum-Tray-wrapper_23bf66";nA="spectrum-Tray--fixedHeight_23bf66";function n1e(t,e){let{children:n,state:r,...i}=t,s=ma(e),c=ee.useRef(null);return ce.createElement(U7,{...i,isOpen:r.isOpen,nodeRef:c},ce.createElement(r1e,{...t,wrapperRef:c,ref:s},n))}let r1e=ee.forwardRef(function(t,e){let{children:n,isOpen:r,isFixedHeight:i,state:s,wrapperRef:c}=t,{styleProps:o}=Ni(t),{modalProps:f,underlayProps:m}=pbe({...t,isDismissable:!0},s,e),S={"--spectrum-visual-viewport-height":M0e().height+"px"},T=st(zc(gf),"spectrum-Tray-wrapper"),C=st(zc(gf),"spectrum-Tray",{"is-open":r,"spectrum-Tray--fixedHeight":i},st(zc(ga),"spectrum-Tray","react-spectrum-Tray"),o.className);return ce.createElement("div",{ref:c},ce.createElement(V7,{...m,isOpen:r}),ce.createElement("div",{className:T,style:S},ce.createElement("div",{...o,...f,className:C,ref:e,"data-testid":"tray"},ce.createElement(mf,{onDismiss:s.close}),n,ce.createElement(mf,{onDismiss:s.close}))))}),i1e=ee.forwardRef(n1e);function G7(t){return p0()?t.altKey:t.ctrlKey}function hh(t){return Og()?t.metaKey:t.ctrlKey}const s1e=1e3;function o1e(t){let{keyboardDelegate:e,selectionManager:n,onTypeSelect:r}=t,i=ee.useRef({search:"",timeout:null}).current,s=c=>{let o=a1e(c.key);if(!o||c.ctrlKey||c.metaKey)return;o===" "&&i.search.trim().length>0&&(c.preventDefault(),"continuePropagation"in c||c.stopPropagation()),i.search+=o;let f=e.getKeyForSearch(i.search,n.focusedKey);f==null&&(f=e.getKeyForSearch(i.search)),f!=null&&(n.setFocusedKey(f),r&&r(f)),clearTimeout(i.timeout),i.timeout=setTimeout(()=>{i.search=""},s1e)};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?s:null}}}function a1e(t){return t.length===1||!/^[A-Z]/i.test(t)?t:""}function j7(t){let{selectionManager:e,keyboardDelegate:n,ref:r,autoFocus:i=!1,shouldFocusWrap:s=!1,disallowEmptySelection:c=!1,disallowSelectAll:o=!1,selectOnFocus:f=e.selectionBehavior==="replace",disallowTypeAhead:m=!1,shouldUseVirtualFocus:x,allowsTabNavigation:S=!1,isVirtualized:T,scrollRef:C=r}=t,{direction:R}=pa(),D=le=>{if(le.altKey&&le.key==="Tab"&&le.preventDefault(),!r.current.contains(le.target))return;const ve=(we,Be)=>{we!=null&&(e.setFocusedKey(we,Be),le.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(we):f&&!G7(le)&&e.replaceSelection(we))};switch(le.key){case"ArrowDown":if(n.getKeyBelow){var Oe,Re;le.preventDefault();let we=e.focusedKey!=null?n.getKeyBelow(e.focusedKey):(Oe=n.getFirstKey)===null||Oe===void 0?void 0:Oe.call(n);we==null&&s&&(we=(Re=n.getFirstKey)===null||Re===void 0?void 0:Re.call(n,e.focusedKey)),ve(we)}break;case"ArrowUp":if(n.getKeyAbove){var Ee,$e;le.preventDefault();let we=e.focusedKey!=null?n.getKeyAbove(e.focusedKey):(Ee=n.getLastKey)===null||Ee===void 0?void 0:Ee.call(n);we==null&&s&&(we=($e=n.getLastKey)===null||$e===void 0?void 0:$e.call(n,e.focusedKey)),ve(we)}break;case"ArrowLeft":if(n.getKeyLeftOf){le.preventDefault();let we=n.getKeyLeftOf(e.focusedKey);ve(we,R==="rtl"?"first":"last")}break;case"ArrowRight":if(n.getKeyRightOf){le.preventDefault();let we=n.getKeyRightOf(e.focusedKey);ve(we,R==="rtl"?"last":"first")}break;case"Home":if(n.getFirstKey){le.preventDefault();let we=n.getFirstKey(e.focusedKey,hh(le));e.setFocusedKey(we),hh(le)&&le.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(we):f&&e.replaceSelection(we)}break;case"End":if(n.getLastKey){le.preventDefault();let we=n.getLastKey(e.focusedKey,hh(le));e.setFocusedKey(we),hh(le)&&le.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(we):f&&e.replaceSelection(we)}break;case"PageDown":if(n.getKeyPageBelow){le.preventDefault();let we=n.getKeyPageBelow(e.focusedKey);ve(we)}break;case"PageUp":if(n.getKeyPageAbove){le.preventDefault();let we=n.getKeyPageAbove(e.focusedKey);ve(we)}break;case"a":hh(le)&&e.selectionMode==="multiple"&&o!==!0&&(le.preventDefault(),e.selectAll());break;case"Escape":le.preventDefault(),c||e.clearSelection();break;case"Tab":if(!S){if(le.shiftKey)r.current.focus();else{let we=Tl(r.current,{tabbable:!0}),Be,Jt;do Jt=we.lastChild(),Jt&&(Be=Jt);while(Jt);Be&&!Be.contains(document.activeElement)&&wl(Be)}break}}},H=ee.useRef({top:0,left:0});U0e(C,"scroll",T?null:()=>{H.current={top:C.current.scrollTop,left:C.current.scrollLeft}});let F=le=>{if(e.isFocused){le.currentTarget.contains(le.target)||e.setFocused(!1);return}if(le.currentTarget.contains(le.target)){if(e.setFocused(!0),e.focusedKey==null){let Re=$e=>{$e!=null&&(e.setFocusedKey($e),f&&e.replaceSelection($e))},Ee=le.relatedTarget;var ve,Oe;Ee&&le.currentTarget.compareDocumentPosition(Ee)&Node.DOCUMENT_POSITION_FOLLOWING?Re((ve=e.lastSelectedKey)!==null&&ve!==void 0?ve:n.getLastKey()):Re((Oe=e.firstSelectedKey)!==null&&Oe!==void 0?Oe:n.getFirstKey())}else T||(C.current.scrollTop=H.current.top,C.current.scrollLeft=H.current.left);if(!T&&e.focusedKey!=null){let Re=C.current.querySelector(`[data-key="${e.focusedKey}"]`);Re&&(wl(Re),RE(C.current,Re))}}},k=le=>{le.currentTarget.contains(le.relatedTarget)||e.setFocused(!1)};const N=ee.useRef(i);ee.useEffect(()=>{if(N.current){let le=null;i==="first"&&(le=n.getFirstKey()),i==="last"&&(le=n.getLastKey());let ve=e.selectedKeys;ve.size&&(le=ve.values().next().value),e.setFocused(!0),e.setFocusedKey(le),le==null&&!x&&od(r.current)}N.current=!1},[]),ee.useEffect(()=>{let le=bv();if(!T&&e.isFocused&&e.focusedKey!=null&&(C!=null&&C.current)){let ve=C.current.querySelector(`[data-key="${e.focusedKey}"]`);ve&&(RE(C.current,ve),le==="keyboard"&&w9(ve,{containingElement:r.current}))}},[T,C,e.focusedKey,e.isFocused,r]);let U={onKeyDown:D,onFocus:F,onBlur:k,onMouseDown(le){C.current===le.target&&le.preventDefault()}},{typeSelectProps:ie}=o1e({keyboardDelegate:n,selectionManager:e});m||(U=kn(ie,U));let he;return x||(he=e.focusedKey==null?0:-1),{collectionProps:{...U,tabIndex:he}}}function l1e(t){let{selectionManager:e,key:n,ref:r,shouldSelectOnPressUp:i,isVirtualized:s,shouldUseVirtualFocus:c,focus:o,isDisabled:f,onAction:m,allowsDifferentPressOrigin:x}=t,S=$e=>{if($e.pointerType==="keyboard"&&G7($e))e.toggleSelection(n);else{if(e.selectionMode==="none")return;e.selectionMode==="single"?e.isSelected(n)&&!e.disallowEmptySelection?e.toggleSelection(n):e.replaceSelection(n):$e&&$e.shiftKey?e.extendSelection(n):e.selectionBehavior==="toggle"||$e&&(hh($e)||$e.pointerType==="touch"||$e.pointerType==="virtual")?e.toggleSelection(n):e.replaceSelection(n)}};ee.useEffect(()=>{n===e.focusedKey&&e.isFocused&&!c&&(o?o():document.activeElement!==r.current&&od(r.current))},[r,n,e.focusedKey,e.childFocusStrategy,e.isFocused,c]),f=f||e.isDisabled(n);let T={};!c&&!f?T={tabIndex:n===e.focusedKey?0:-1,onFocus($e){$e.target===r.current&&e.setFocusedKey(n)}}:f&&(T.onMouseDown=$e=>{$e.preventDefault()});let C=!f&&e.canSelectItem(n),R=m&&!f,D=R&&(e.selectionBehavior==="replace"?!C:e.isEmpty),H=R&&C&&e.selectionBehavior==="replace",F=D||H,k=ee.useRef(null),N=F&&C,U=ee.useRef(!1),ie=ee.useRef(!1),he={};i?(he.onPressStart=$e=>{k.current=$e.pointerType,U.current=N,$e.pointerType==="keyboard"&&(!F||ZO())&&S($e)},x?(he.onPressUp=$e=>{$e.pointerType!=="keyboard"&&S($e)},he.onPress=D?()=>m():null):he.onPress=$e=>{if(D||H&&$e.pointerType!=="mouse"){if($e.pointerType==="keyboard"&&!XO())return;m()}else $e.pointerType!=="keyboard"&&S($e)}):(he.onPressStart=$e=>{k.current=$e.pointerType,U.current=N,ie.current=D,($e.pointerType==="mouse"&&!D||$e.pointerType==="keyboard"&&(!m||ZO()))&&S($e)},he.onPress=$e=>{($e.pointerType==="touch"||$e.pointerType==="pen"||$e.pointerType==="virtual"||$e.pointerType==="keyboard"&&F&&XO()||$e.pointerType==="mouse"&&ie.current)&&(F?m():S($e))}),s||(T["data-key"]=n),he.preventFocusOnPress=c;let{pressProps:le,isPressed:ve}=KR(he),Oe=H?$e=>{k.current==="mouse"&&($e.stopPropagation(),$e.preventDefault(),m())}:void 0,{longPressProps:Re}=z9({isDisabled:!N,onLongPress($e){$e.pointerType==="touch"&&(S($e),e.setSelectionBehavior("toggle"))}});return{itemProps:kn(T,C||D?le:{},N?Re:{},{onDoubleClick:Oe,onDragStartCapture:$e=>{k.current==="touch"&&U.current&&$e.preventDefault()}}),isPressed:ve,isSelected:e.isSelected(n),isFocused:e.isFocused&&e.focusedKey===n,isDisabled:f,allowsSelection:C,hasAction:F}}function XO(){let t=window.event;return(t==null?void 0:t.key)==="Enter"}function ZO(){let t=window.event;return(t==null?void 0:t.key)===" "||(t==null?void 0:t.code)==="Space"}class H7{getKeyBelow(e){for(e=this.collection.getKeyAfter(e);e!=null;){if(this.collection.getItem(e).type==="item"&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyAfter(e)}return null}getKeyAbove(e){for(e=this.collection.getKeyBefore(e);e!=null;){if(this.collection.getItem(e).type==="item"&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyBefore(e)}return null}getFirstKey(){let e=this.collection.getFirstKey();for(;e!=null;){if(this.collection.getItem(e).type==="item"&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyAfter(e)}return null}getLastKey(){let e=this.collection.getLastKey();for(;e!=null;){if(this.collection.getItem(e).type==="item"&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyBefore(e)}return null}getItem(e){return this.ref.current.querySelector(`[data-key="${e}"]`)}getKeyPageAbove(e){let n=this.ref.current,r=this.getItem(e);if(!r)return null;let i=Math.max(0,r.offsetTop+r.offsetHeight-n.offsetHeight);for(;r&&r.offsetTop>i;)e=this.getKeyAbove(e),r=e==null?null:this.getItem(e);return e}getKeyPageBelow(e){let n=this.ref.current,r=this.getItem(e);if(!r)return null;let i=Math.min(n.scrollHeight,r.offsetTop-r.offsetHeight+n.offsetHeight);for(;r&&r.offsetTop<i;)e=this.getKeyBelow(e),r=e==null?null:this.getItem(e);return e}getKeyForSearch(e,n){if(!this.collator)return null;let r=this.collection,i=n||this.getFirstKey();for(;i!=null;){let s=r.getItem(i),c=s.textValue.slice(0,e.length);if(s.textValue&&this.collator.compare(c,e)===0)return i;i=this.getKeyBelow(i)}return null}constructor(e,n,r,i){this.collection=e,this.disabledKeys=n,this.ref=r,this.collator=i}}function c1e(t){let{selectionManager:e,collection:n,disabledKeys:r,ref:i,keyboardDelegate:s,autoFocus:c,shouldFocusWrap:o,isVirtualized:f,disallowEmptySelection:m,selectOnFocus:x=e.selectionBehavior==="replace",disallowTypeAhead:S,shouldUseVirtualFocus:T,allowsTabNavigation:C}=t,R=jR({usage:"search",sensitivity:"base"}),D=e.disabledBehavior,H=ee.useMemo(()=>s||new H7(n,D==="selection"?new Set:r,i,R),[s,n,r,i,R,D]),{collectionProps:F}=j7({ref:i,selectionManager:e,keyboardDelegate:H,autoFocus:c,shouldFocusWrap:o,disallowEmptySelection:m,selectOnFocus:x,disallowTypeAhead:S,shouldUseVirtualFocus:T,allowsTabNavigation:C,isVirtualized:f,scrollRef:i});return{listProps:F}}function u1e(t){return t&&t.__esModule?t.default:t}var W7={},K7={};K7={longPressMessage:"اضغط مطولاً أو اضغط على Alt + السهم لأسفل لفتح القائمة"};var q7={};q7={longPressMessage:"Натиснете продължително или натиснете Alt+ стрелка надолу, за да отворите менюто"};var X7={};X7={longPressMessage:"Dlouhým stiskem nebo stisknutím kláves Alt + šipka dolů otevřete nabídku"};var Z7={};Z7={longPressMessage:"Langt tryk eller tryk på Alt + pil ned for at åbne menuen"};var Y7={};Y7={longPressMessage:"Drücken Sie lange oder drücken Sie Alt + Nach-unten, um das Menü zu öffnen"};var J7={};J7={longPressMessage:"Πιέστε παρατεταμένα ή πατήστε Alt + κάτω βέλος για να ανοίξετε το μενού"};var Q7={};Q7={longPressMessage:"Long press or press Alt + ArrowDown to open menu"};var eU={};eU={longPressMessage:"Mantenga pulsado o pulse Alt + flecha abajo para abrir el menú"};var tU={};tU={longPressMessage:"Menüü avamiseks vajutage pikalt või vajutage klahve Alt + allanool"};var nU={};nU={longPressMessage:"Avaa valikko painamalla pohjassa tai näppäinyhdistelmällä Alt + Alanuoli"};var rU={};rU={longPressMessage:"Appuyez de manière prolongée ou appuyez sur Alt + Flèche vers le bas pour ouvrir le menu."};var iU={};iU={longPressMessage:"לחץ לחיצה ארוכה או הקש Alt + ArrowDown כדי לפתוח את התפריט"};var sU={};sU={longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dolje za otvaranje izbornika"};var oU={};oU={longPressMessage:"Nyomja meg hosszan, vagy nyomja meg az Alt + lefele nyíl gombot a menü megnyitásához"};var aU={};aU={longPressMessage:"Premere a lungo o premere Alt + Freccia giù per aprire il menu"};var lU={};lU={longPressMessage:"長押しまたは Alt+下矢印キーでメニューを開く"};var cU={};cU={longPressMessage:"길게 누르거나 Alt + 아래쪽 화살표를 눌러 메뉴 열기"};var uU={};uU={longPressMessage:"Norėdami atidaryti meniu, nuspaudę palaikykite arba paspauskite „Alt + ArrowDown“."};var dU={};dU={longPressMessage:"Lai atvērtu izvēlni, turiet nospiestu vai nospiediet taustiņu kombināciju Alt + lejupvērstā bultiņa"};var hU={};hU={longPressMessage:"Langt trykk eller trykk Alt + PilNed for å åpne menyen"};var fU={};fU={longPressMessage:"Druk lang op Alt + pijl-omlaag of druk op Alt om het menu te openen"};var pU={};pU={longPressMessage:"Naciśnij i przytrzymaj lub naciśnij klawisze Alt + Strzałka w dół, aby otworzyć menu"};var mU={};mU={longPressMessage:"Pressione e segure ou pressione Alt + Seta para baixo para abrir o menu"};var gU={};gU={longPressMessage:"Prima continuamente ou prima Alt + Seta Para Baixo para abrir o menu"};var yU={};yU={longPressMessage:"Apăsați lung sau apăsați pe Alt + săgeată în jos pentru a deschide meniul"};var _U={};_U={longPressMessage:"Нажмите и удерживайте или нажмите Alt + Стрелка вниз, чтобы открыть меню"};var vU={};vU={longPressMessage:"Ponuku otvoríte dlhým stlačením alebo stlačením klávesu Alt + klávesu so šípkou nadol"};var bU={};bU={longPressMessage:"Za odprtje menija pritisnite in držite gumb ali pritisnite Alt+puščica navzdol"};var xU={};xU={longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dole da otvorite meni"};var wU={};wU={longPressMessage:"Håll nedtryckt eller tryck på Alt + pil nedåt för att öppna menyn"};var EU={};EU={longPressMessage:"Menüyü açmak için uzun basın veya Alt + Aşağı Ok tuşuna basın"};var TU={};TU={longPressMessage:"Довго або звичайно натисніть комбінацію клавіш Alt і стрілка вниз, щоб відкрити меню"};var SU={};SU={longPressMessage:"长按或按 Alt + 向下方向键以打开菜单"};var AU={};AU={longPressMessage:"長按或按 Alt+向下鍵以開啟功能表"};W7={"ar-AE":K7,"bg-BG":q7,"cs-CZ":X7,"da-DK":Z7,"de-DE":Y7,"el-GR":J7,"en-US":Q7,"es-ES":eU,"et-EE":tU,"fi-FI":nU,"fr-FR":rU,"he-IL":iU,"hr-HR":sU,"hu-HU":oU,"it-IT":aU,"ja-JP":lU,"ko-KR":cU,"lt-LT":uU,"lv-LV":dU,"nb-NO":hU,"nl-NL":fU,"pl-PL":pU,"pt-BR":mU,"pt-PT":gU,"ro-RO":yU,"ru-RU":_U,"sk-SK":vU,"sl-SI":bU,"sr-SP":xU,"sv-SE":wU,"tr-TR":EU,"uk-UA":TU,"zh-CN":SU,"zh-TW":AU};function d1e(t,e,n){let{type:r="menu",isDisabled:i,trigger:s="press"}=t,c=jo(),{triggerProps:o,overlayProps:f}=H9({type:r},e,n),m=C=>{if(!i&&!(s==="longPress"&&!C.altKey)&&n&&n.current)switch(C.key){case"Enter":case" ":if(s==="longPress")return;case"ArrowDown":"continuePropagation"in C||C.stopPropagation(),C.preventDefault(),e.toggle("first");break;case"ArrowUp":"continuePropagation"in C||C.stopPropagation(),C.preventDefault(),e.toggle("last");break}},x=Nl(u1e(W7)),{longPressProps:S}=z9({isDisabled:i||s!=="longPress",accessibilityDescription:x.format("longPressMessage"),onLongPressStart(){e.close()},onLongPress(){e.open("first")}}),T={onPressStart(C){C.pointerType!=="touch"&&C.pointerType!=="keyboard"&&!i&&e.toggle(C.pointerType==="virtual"?"first":null)},onPress(C){C.pointerType==="touch"&&!i&&e.toggle()}};return delete o.onPress,{menuTriggerProps:{...o,...s==="press"?T:S,id:c,onKeyDown:m},menuProps:{...f,"aria-labelledby":c,autoFocus:e.focusStrategy||!0,onClose:e.close}}}function h1e(t){let[e,n]=xb(t.isOpen,t.defaultOpen||!1,t.onOpenChange);return{isOpen:e,setOpen:n,open(){n(!0)},close(){n(!1)},toggle(){n(!e)}}}function f1e(t){let e=h1e(t),[n,r]=ee.useState(null);return{focusStrategy:n,...e,open(i=null){r(i),e.open()},toggle(i=null){r(i),e.toggle()}}}class ia extends Set{constructor(e,n,r){super(e),e instanceof ia?(this.anchorKey=n||e.anchorKey,this.currentKey=r||e.currentKey):(this.anchorKey=n,this.currentKey=r)}}function p1e(t,e){if(t.size!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0}function m1e(t){let{selectionMode:e="none",disallowEmptySelection:n,allowDuplicateSelectionEvents:r,selectionBehavior:i="toggle",disabledBehavior:s="all"}=t,c=ee.useRef(!1),[,o]=ee.useState(!1),f=ee.useRef(null),m=ee.useRef(null),[,x]=ee.useState(null),S=ee.useMemo(()=>YO(t.selectedKeys),[t.selectedKeys]),T=ee.useMemo(()=>YO(t.defaultSelectedKeys,new ia),[t.defaultSelectedKeys]),[C,R]=xb(S,T,t.onSelectionChange),D=ee.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),[H,F]=ee.useState(i);i==="replace"&&H==="toggle"&&typeof C=="object"&&C.size===0&&F("replace");let k=ee.useRef(i);return ee.useEffect(()=>{i!==k.current&&(F(i),k.current=i)},[i]),{selectionMode:e,disallowEmptySelection:n,selectionBehavior:H,setSelectionBehavior:F,get isFocused(){return c.current},setFocused(N){c.current=N,o(N)},get focusedKey(){return f.current},get childFocusStrategy(){return m.current},setFocusedKey(N,U="first"){f.current=N,m.current=U,x(N)},selectedKeys:C,setSelectedKeys(N){(r||!p1e(N,C))&&R(N)},disabledKeys:D,disabledBehavior:s}}function YO(t,e){return t?t==="all"?"all":new ia(t):e}class g1e{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,n){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,n)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){return this.state.selectionMode==="none"?!1:(e=this.getKey(e),this.state.selectedKeys==="all"?this.canSelectItem(e):this.state.selectedKeys.has(e))}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),n=this.state.selectedKeys;return this._isSelectAll=e.every(r=>n.has(r)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let n of this.state.selectedKeys){let r=this.collection.getItem(n);(!e||r&&fw(this.collection,r,e)<0)&&(e=r)}return e==null?void 0:e.key}get lastSelectedKey(){let e=null;for(let n of this.state.selectedKeys){let r=this.collection.getItem(n);(!e||r&&fw(this.collection,r,e)>0)&&(e=r)}return e==null?void 0:e.key}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(e);return}e=this.getKey(e);let n;if(this.state.selectedKeys==="all")n=new ia([e],e,e);else{let r=this.state.selectedKeys,i=r.anchorKey||e;n=new ia(r,i,e);for(let s of this.getKeyRange(i,r.currentKey||e))n.delete(s);for(let s of this.getKeyRange(e,i))this.canSelectItem(s)&&n.add(s)}this.state.setSelectedKeys(n)}getKeyRange(e,n){let r=this.collection.getItem(e),i=this.collection.getItem(n);return r&&i?fw(this.collection,r,i)<=0?this.getKeyRangeInternal(e,n):this.getKeyRangeInternal(n,e):[]}getKeyRangeInternal(e,n){let r=[],i=e;for(;i;){let s=this.collection.getItem(i);if((s&&s.type==="item"||s.type==="cell"&&this.allowsCellSelection)&&r.push(i),i===n)return r;i=this.collection.getKeyAfter(i)}return[]}getKey(e){let n=this.collection.getItem(e);if(!n||n.type==="cell"&&this.allowsCellSelection)return e;for(;n.type!=="item"&&n.parentKey!=null;)n=this.collection.getItem(n.parentKey);return!n||n.type!=="item"?null:n.key}toggleSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}if(e=this.getKey(e),e==null)return;let n=new ia(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);n.has(e)?n.delete(e):this.canSelectItem(e)&&(n.add(e),n.anchorKey=e,n.currentKey=e),!(this.disallowEmptySelection&&n.size===0)&&this.state.setSelectedKeys(n)}replaceSelection(e){if(this.selectionMode==="none"||(e=this.getKey(e),e==null))return;let n=this.canSelectItem(e)?new ia([e],e,e):new ia;this.state.setSelectedKeys(n)}setSelectedKeys(e){if(this.selectionMode==="none")return;let n=new ia;for(let r of e)if(r=this.getKey(r),r!=null&&(n.add(r),this.selectionMode==="single"))break;this.state.setSelectedKeys(n)}getSelectAllKeys(){let e=[],n=r=>{for(;r;){if(this.canSelectItem(r)){let i=this.collection.getItem(r);i.type==="item"&&e.push(r),i.hasChildNodes&&(this.allowsCellSelection||i.type!=="item")&&n(v0e(pf(i,this.collection)).key)}r=this.collection.getKeyAfter(r)}};return n(this.collection.getFirstKey()),e}selectAll(){this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new ia)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,n){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior==="toggle"||n&&(n.pointerType==="touch"||n.pointerType==="virtual")?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let n=this.selectedKeys;if(e.size!==n.size)return!1;for(let r of e)if(!n.has(r))return!1;for(let r of n)if(!e.has(r))return!1;return!0}canSelectItem(e){if(this.state.selectionMode==="none"||this.state.disabledKeys.has(e))return!1;let n=this.collection.getItem(e);return!(!n||n.type==="cell"&&!this.allowsCellSelection)}isDisabled(e){return this.state.disabledKeys.has(e)&&this.state.disabledBehavior==="all"}constructor(e,n,r){this.collection=e,this.state=n;var i;this.allowsCellSelection=(i=r==null?void 0:r.allowsCellSelection)!==null&&i!==void 0?i:!1,this._isSelectAll=null}}var PU={};Object.defineProperty(PU,"__esModule",{value:!0});var y1e=PU.CheckmarkMedium=CU,Cw=_1e(ee);function _1e(t){return t&&t.__esModule?t:{default:t}}function rA(){return rA=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rA.apply(this,arguments)}function v1e(t,e){if(t==null)return{};var n=b1e(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function b1e(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function CU(t){var e=t.scale,n=e===void 0?"M":e,r=v1e(t,["scale"]);return Cw.default.createElement("svg",rA({},r,r),n==="L"&&Cw.default.createElement("path",{d:"M6 14a1 1 0 0 1-.789-.385l-4-5a1 1 0 1 1 1.577-1.23L6 11.376l7.213-8.99a1 1 0 1 1 1.576 1.23l-8 10a1 1 0 0 1-.789.384z"}),n==="M"&&Cw.default.createElement("path",{d:"M4.5 10a1.022 1.022 0 0 1-.799-.384l-2.488-3a1 1 0 0 1 1.576-1.233L4.5 7.376l4.712-5.991a1 1 0 1 1 1.576 1.23l-5.51 7A.978.978 0 0 1 4.5 10z"}))}CU.displayName="CheckmarkMedium";function e$(t){return ce.createElement(Pf,t,ce.createElement(y1e,null))}function Iw(t){return t&&t.__esModule?t.default:t}function t$(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}const x1e={...Tb,autoFlow:["gridAutoFlow",Pi],autoColumns:["gridAutoColumns",Av],autoRows:["gridAutoRows",Av],areas:["gridTemplateAreas",E1e],columns:["gridTemplateColumns",JO],rows:["gridTemplateRows",JO],gap:["gap",Gn],rowGap:["rowGap",Gn],columnGap:["columnGap",Gn],justifyItems:["justifyItems",Pi],justifyContent:["justifyContent",Pi],alignItems:["alignItems",Pi],alignContent:["alignContent",Pi]};function w1e(t,e){let{children:n,...r}=t,{styleProps:i}=Ni(r,x1e);i.style.display="grid";let s=ma(e);return ce.createElement("div",{...ps(r),...i,ref:s},n)}function E1e(t){return t.map(e=>`"${e}"`).join(`
`)}function Av(t){return/^max-content|min-content|minmax|auto|fit-content|repeat|subgrid/.test(t)?t:Gn(t)}function JO(t){return Array.isArray(t)?t.map(Av).join(" "):Av(t)}const T1e=ee.forwardRef(w1e);var Gh={};t$(Gh,"flex-container",()=>iA,t=>iA=t);t$(Gh,"flex",()=>sA,t=>sA=t);t$(Gh,"flex-gap",()=>oA,t=>oA=t);var iA,sA,oA;iA="flex-container_e15493";sA="flex_e15493";oA="flex-gap_e15493";const S1e={direction:["flexDirection",Pi],wrap:["flexWrap",P1e],justifyContent:["justifyContent",Lw],alignItems:["alignItems",Lw],alignContent:["alignContent",Lw]};function A1e(t,e){let{children:n,...r}=t,i=$9(),s=(i==null?void 0:i.matchedBreakpoints)||["base"],{styleProps:c}=Ni(r),{styleProps:o}=Ni(r,S1e),f=ma(e),m=Sf();if((t.gap||t.rowGap||t.columnGap)&&(m||!C1e())){let S={...o.style,"--column-gap":t.columnGap!=null?rh(t.columnGap,s):void 0,"--row-gap":t.rowGap!=null?rh(t.rowGap,s):void 0,"--gap":t.gap!=null?rh(t.gap,s):void 0};return ce.createElement("div",{...ps(r),...c,className:st(Iw(Gh),"flex-container",c.className),ref:f},ce.createElement("div",{className:st(Iw(Gh),"flex","flex-gap"),style:S},n))}let x={...c.style,...o.style};return t.gap!=null&&(x.gap=rh(t.gap,s)),t.columnGap!=null&&(x.columnGap=rh(t.columnGap,s)),t.rowGap!=null&&(x.rowGap=rh(t.rowGap,s)),ce.createElement("div",{...ps(r),className:st(Iw(Gh),"flex",c.className),style:x,ref:f},n)}function Lw(t){return t==="start"?"flex-start":t==="end"?"flex-end":t}function P1e(t){return typeof t=="boolean"?t?"wrap":"nowrap":t}let z_=null;function C1e(){if(z_!=null)return z_;if(typeof document>"u")return!1;var t=document.createElement("div");return t.style.display="flex",t.style.flexDirection="column",t.style.rowGap="1px",t.appendChild(document.createElement("div")),t.appendChild(document.createElement("div")),document.body.appendChild(t),z_=t.scrollHeight===1,t.parentNode.removeChild(t),z_}const aA=ee.forwardRef(A1e);function I1e(t){let e=ps(t,{labelable:!0}),n;return t.orientation==="vertical"&&(n="vertical"),t.elementType!=="hr"?{separatorProps:{...e,role:"separator","aria-orientation":n}}:{separatorProps:e}}let L1e=Symbol.iterator;class lA{*[L1e](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let n=this.keyMap.get(e);return n?n.prevKey:null}getKeyAfter(e){let n=this.keyMap.get(e);return n?n.nextKey:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){return this.keyMap.get(e)}at(e){const n=[...this.getKeys()];return this.getItem(n[e])}getChildren(e){let n=this.keyMap.get(e);return(n==null?void 0:n.childNodes)||[]}constructor(e){Cr(this,"keyMap",new Map),this.iterable=e;let n=s=>{if(this.keyMap.set(s.key,s),s.childNodes&&s.type==="section")for(let c of s.childNodes)n(c)};for(let s of e)n(s);let r,i=0;for(let[s,c]of this.keyMap)r?(r.nextKey=s,c.prevKey=r.key):(this.firstKey=s,c.prevKey=void 0),c.type==="item"&&(c.index=i++),r=c,r.nextKey=void 0;this.lastKey=r==null?void 0:r.key}}function IU(t){let{filter:e}=t,n=m1e(t),r=ee.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),i=m=>e?new lA(e(m)):new lA(m),s=ee.useMemo(()=>({suppressTextValueWarning:t.suppressTextValueWarning}),[t.suppressTextValueWarning]),c=_0e(t,i,s,[e]),o=ee.useMemo(()=>new g1e(c,n),[c,n]);const f=ee.useRef(null);return ee.useEffect(()=>{if(n.focusedKey!=null&&!c.getItem(n.focusedKey)){const m=f.current.getItem(n.focusedKey),x=[...f.current.getKeys()].map(D=>{const H=f.current.getItem(D);return H.type==="item"?H:null}).filter(D=>D!==null),S=[...c.getKeys()].map(D=>{const H=c.getItem(D);return H.type==="item"?H:null}).filter(D=>D!==null),T=x.length-S.length;let C=Math.min(T>1?Math.max(m.index-T+1,0):m.index,S.length-1),R;for(;C>=0;){if(!o.isDisabled(S[C].key)){R=S[C];break}C<S.length-1?C++:(C>m.index&&(C=m.index),C--)}n.setFocusedKey(R?R.key:null)}f.current=c},[c,o,n,n.focusedKey]),{collection:c,disabledKeys:r,selectionManager:o}}function R1e(t){var e;let[n,r]=xb(t.selectedKey,(e=t.defaultSelectedKey)!==null&&e!==void 0?e:null,t.onSelectionChange),i=ee.useMemo(()=>n!=null?[n]:[],[n]),{collection:s,disabledKeys:c,selectionManager:o}=IU({...t,selectionMode:"single",disallowEmptySelection:!0,allowDuplicateSelectionEvents:!0,selectedKeys:i,onSelectionChange:m=>{let x=m.values().next().value;x===n&&t.onSelectionChange&&t.onSelectionChange(x),r(x)}}),f=n!=null?s.getItem(n):null;return{collection:s,disabledKeys:c,selectionManager:o,selectedKey:n,setSelectedKey:r,selectedItem:f}}const LU=7e3;let Rw=null;function $w(t,e="assertive",n=LU){Rw||(Rw=new $1e),Rw.announce(t,e,n)}class $1e{createLog(e){let n=document.createElement("div");return n.setAttribute("role","log"),n.setAttribute("aria-live",e),n.setAttribute("aria-relevant","additions"),n}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,n="assertive",r=LU){if(!this.node)return;let i=document.createElement("div");i.textContent=e,n==="assertive"?this.assertiveLog.appendChild(i):this.politeLog.appendChild(i),e!==""&&setTimeout(()=>{i.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&(this.politeLog.innerHTML=""))}constructor(){this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node)}}function _i(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var vi={};_i(vi,"spectrum-FieldLabel",()=>cA,t=>cA=t);_i(vi,"spectrum-FieldLabel--positionSide",()=>uA,t=>uA=t);_i(vi,"spectrum-FieldLabel-requiredIcon",()=>dA,t=>dA=t);_i(vi,"spectrum-FieldLabel--alignEnd",()=>hA,t=>hA=t);_i(vi,"spectrum-Field",()=>fA,t=>fA=t);_i(vi,"spectrum-Field-contextualHelp",()=>pA,t=>pA=t);_i(vi,"spectrum-Field--positionTop",()=>mA,t=>mA=t);_i(vi,"spectrum-Field-field",()=>gA,t=>gA=t);_i(vi,"spectrum-Field--alignEnd",()=>yA,t=>yA=t);_i(vi,"spectrum-Field--positionSide",()=>_A,t=>_A=t);_i(vi,"spectrum-Field-wrapper",()=>vA,t=>vA=t);_i(vi,"spectrum-Field--hasContextualHelp",()=>bA,t=>bA=t);_i(vi,"spectrum-Form",()=>xA,t=>xA=t);_i(vi,"spectrum-Form--positionSide",()=>wA,t=>wA=t);_i(vi,"spectrum-Field-labelCell",()=>EA,t=>EA=t);_i(vi,"spectrum-Field-labelWrapper",()=>TA,t=>TA=t);_i(vi,"spectrum-Form--positionTop",()=>SA,t=>SA=t);_i(vi,"spectrum-LabeledValue",()=>AA,t=>AA=t);_i(vi,"spectrum-Form-itemLabel",()=>PA,t=>PA=t);_i(vi,"is-disabled",()=>CA,t=>CA=t);var cA,uA,dA,hA,fA,pA,mA,gA,yA,_A,vA,bA,xA,wA,EA,TA,SA,AA,PA,CA;cA="spectrum-FieldLabel_d2db1f";uA="spectrum-FieldLabel--positionSide_d2db1f";dA="spectrum-FieldLabel-requiredIcon_d2db1f";hA="spectrum-FieldLabel--alignEnd_d2db1f";fA="spectrum-Field_d2db1f";pA="spectrum-Field-contextualHelp_d2db1f";mA="spectrum-Field--positionTop_d2db1f";gA="spectrum-Field-field_d2db1f";yA="spectrum-Field--alignEnd_d2db1f";_A="spectrum-Field--positionSide_d2db1f";vA="spectrum-Field-wrapper_d2db1f";bA="spectrum-Field--hasContextualHelp_d2db1f";xA="spectrum-Form_d2db1f";wA="spectrum-Form--positionSide_d2db1f";EA="spectrum-Field-labelCell_d2db1f";TA="spectrum-Field-labelWrapper_d2db1f";SA="spectrum-Form--positionTop_d2db1f";AA="spectrum-LabeledValue_d2db1f";PA="spectrum-Form-itemLabel_d2db1f";CA="is-disabled_d2db1f";let M1e=ce.createContext(null);function k1e(t){let e=ee.useContext(M1e);return e?{...e,...t}:t}var RU={};Object.defineProperty(RU,"__esModule",{value:!0});var $U=RU.AlertMedium=MU,Mw=O1e(ee);function O1e(t){return t&&t.__esModule?t:{default:t}}function IA(){return IA=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},IA.apply(this,arguments)}function D1e(t,e){if(t==null)return{};var n=F1e(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function F1e(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function MU(t){var e=t.scale,n=e===void 0?"M":e,r=D1e(t,["scale"]);return Mw.default.createElement("svg",IA({},r,r),n==="L"&&Mw.default.createElement("path",{d:"M10.563 2.206l-9.249 16.55a.5.5 0 0 0 .436.744h18.5a.5.5 0 0 0 .436-.744l-9.251-16.55a.5.5 0 0 0-.872 0zm1.436 15.044a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-1.5a.25.25 0 0 1 .25-.25h1.5a.25.25 0 0 1 .25.25zm0-3.5a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-6a.25.25 0 0 1 .25-.25h1.5a.25.25 0 0 1 .25.25z"}),n==="M"&&Mw.default.createElement("path",{d:"M8.564 1.289L.2 16.256A.5.5 0 0 0 .636 17h16.728a.5.5 0 0 0 .436-.744L9.436 1.289a.5.5 0 0 0-.872 0zM10 14.75a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-1.5a.25.25 0 0 1 .25-.25h1.5a.25.25 0 0 1 .25.25zm0-3a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-6a.25.25 0 0 1 .25-.25h1.5a.25.25 0 0 1 .25.25z"}))}MU.displayName="AlertMedium";const kU=t=>ce.createElement("svg",wS({viewBox:"0 0 18 18"},t),ce.createElement("path",{d:"M9 10.5a1 1 0 0 1-1-1V5a1 1 0 1 1 2 0v4.5a1 1 0 0 1-1 1Zm0 1.25A1.25 1.25 0 1 0 10.25 13 1.25 1.25 0 0 0 9 11.75Zm8.497 3.589a3.49 3.49 0 0 0 .079-3.474L12 1.815a3.385 3.385 0 0 0-5.994-.007L.416 11.88a3.485 3.485 0 0 0 .089 3.459A3.375 3.375 0 0 0 3.416 17h11.169a3.375 3.375 0 0 0 2.912-1.661ZM10.244 2.77l5.575 10.05a1.497 1.497 0 0 1-.037 1.489 1.374 1.374 0 0 1-1.197.69H3.416a1.374 1.374 0 0 1-1.197-.69 1.493 1.493 0 0 1-.046-1.474l5.593-10.08a1.386 1.386 0 0 1 2.478.015Z"}));kU.displayName=$U.displayName;function n$(t){var e,n;let r=yd();return ce.createElement(Pf,t,r!=null&&(e=r.theme)!=null&&(n=e.global)!=null&&n.express?ce.createElement(kU,null):ce.createElement($U,null))}var OU={};Object.defineProperty(OU,"__esModule",{value:!0});var z1e=OU.Asterisk=DU,kw=N1e(ee);function N1e(t){return t&&t.__esModule?t:{default:t}}function LA(){return LA=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},LA.apply(this,arguments)}function B1e(t,e){if(t==null)return{};var n=U1e(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function U1e(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function DU(t){var e=t.scale,n=e===void 0?"M":e,r=B1e(t,["scale"]);return kw.default.createElement("svg",LA({},r,r),n==="L"&&kw.default.createElement("path",{d:"M7.867 7.872c.061.062.103.145 0 .228l-1.283.827c-.104.061-.145.02-.186-.083L4.804 6.07l-2.09 2.297c-.021.042-.083.083-.145 0l-.994-1.035c-.103-.062-.082-.124 0-.186l2.36-1.966-2.691-1.014c-.042 0-.104-.083-.062-.186l.703-1.41a.11.11 0 0 1 .187-.04L4.43 4.06l.145-3.02A.109.109 0 0 1 4.7.917l1.718.227c.104 0 .124.042.104.145l-.808 2.96 2.734-.828c.061-.042.124-.042.165.082l.27 1.532c.02.103 0 .145-.084.145l-2.856.227z"}),n==="M"&&kw.default.createElement("path",{d:"M6.573 6.558c.056.055.092.13 0 .204l-1.148.74c-.093.056-.13.02-.167-.073L3.832 4.947l-1.87 2.055c-.02.037-.075.074-.13 0l-.889-.926c-.092-.055-.074-.111 0-.167l2.111-1.76-2.408-.906c-.037 0-.092-.074-.055-.167l.63-1.259a.097.097 0 0 1 .166-.036l2.111 1.37.13-2.704a.097.097 0 0 1 .111-.11L5.277.54c.092 0 .11.037.092.13l-.722 2.647 2.444-.74c.056-.038.111-.038.148.073l.241 1.37c.019.093 0 .13-.074.13l-2.556.204z"}))}DU.displayName="Asterisk";function V1e(t){return ce.createElement(Pf,t,ce.createElement(z1e,null))}function mo(t){return t&&t.__esModule?t.default:t}function Er(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var Ba={};Er(Ba,"spectrum-HelpText",()=>RA,t=>RA=t);Er(Ba,"spectrum-HelpText-validationIcon",()=>$A,t=>$A=t);Er(Ba,"spectrum-HelpText-text",()=>MA,t=>MA=t);Er(Ba,"spectrum-HelpText--neutral",()=>kA,t=>kA=t);Er(Ba,"is-disabled",()=>OA,t=>OA=t);Er(Ba,"spectrum-HelpText--negative",()=>DA,t=>DA=t);var RA,$A,MA,kA,OA,DA;RA="spectrum-HelpText_f395de";$A="spectrum-HelpText-validationIcon_f395de";MA="spectrum-HelpText-text_f395de";kA="spectrum-HelpText--neutral_f395de";OA="is-disabled_f395de";DA="spectrum-HelpText--negative_f395de";function G1e(t,e){let{description:n,errorMessage:r,validationState:i,isDisabled:s,showErrorIcon:c,descriptionProps:o,errorMessageProps:f}=t,m=ma(e),x=r&&i==="invalid",{styleProps:S}=Ni(t);return ce.createElement("div",{...S,className:st(mo(Ba),"spectrum-HelpText",`spectrum-HelpText--${x?"negative":"neutral"}`,{"is-disabled":s},S.className),ref:m},x?ce.createElement(ce.Fragment,null,c&&ce.createElement(n$,{UNSAFE_className:st(mo(Ba),"spectrum-HelpText-validationIcon")}),ce.createElement("div",{...f,className:st(mo(Ba),"spectrum-HelpText-text")},r)):ce.createElement("div",{...o,className:st(mo(Ba),"spectrum-HelpText-text")},n))}const j1e=ce.forwardRef(G1e);var FU={},zU={};zU={"(optional)":"(اختياري)","(required)":"(مطلوب)"};var NU={};NU={"(optional)":"(незадължително)","(required)":"(задължително)"};var BU={};BU={"(optional)":"(volitelně)","(required)":"(požadováno)"};var UU={};UU={"(optional)":"(valgfrit)","(required)":"(obligatorisk)"};var VU={};VU={"(optional)":"(optional)","(required)":"(erforderlich)"};var GU={};GU={"(optional)":"(προαιρετικό)","(required)":"(απαιτείται)"};var jU={};jU={"(required)":"(required)","(optional)":"(optional)"};var HU={};HU={"(optional)":"(opcional)","(required)":"(obligatorio)"};var WU={};WU={"(optional)":"(valikuline)","(required)":"(nõutav)"};var KU={};KU={"(optional)":"(valinnainen)","(required)":"(pakollinen)"};var qU={};qU={"(optional)":"(facultatif)","(required)":"(requis)"};var XU={};XU={"(optional)":"(אופציונלי)","(required)":"(נדרש)"};var ZU={};ZU={"(optional)":"(opcionalno)","(required)":"(obvezno)"};var YU={};YU={"(optional)":"(opcionális)","(required)":"(kötelező)"};var JU={};JU={"(optional)":"(facoltativo)","(required)":"(obbligatorio)"};var QU={};QU={"(optional)":"（オプション）","(required)":"（必須）"};var eV={};eV={"(optional)":"(선택 사항)","(required)":"(필수 사항)"};var tV={};tV={"(optional)":"(pasirenkama)","(required)":"(privaloma)"};var nV={};nV={"(optional)":"(neobligāti)","(required)":"(obligāti)"};var rV={};rV={"(optional)":"(valgfritt)","(required)":"(obligatorisk)"};var iV={};iV={"(optional)":"(optioneel)","(required)":"(vereist)"};var sV={};sV={"(optional)":"(opcjonalne)","(required)":"(wymagane)"};var oV={};oV={"(optional)":"(opcional)","(required)":"(obrigatório)"};var aV={};aV={"(optional)":"(opcional)","(required)":"(obrigatório)"};var lV={};lV={"(optional)":"(opţional)","(required)":"(obligatoriu)"};var cV={};cV={"(optional)":"(дополнительно)","(required)":"(обязательно)"};var uV={};uV={"(optional)":"(nepovinné)","(required)":"(povinné)"};var dV={};dV={"(optional)":"(opcijsko)","(required)":"(obvezno)"};var hV={};hV={"(optional)":"(opciono)","(required)":"(obavezno)"};var fV={};fV={"(optional)":"(valfritt)","(required)":"(krävs)"};var pV={};pV={"(optional)":"(isteğe bağlı)","(required)":"(gerekli)"};var mV={};mV={"(optional)":"(необов’язково)","(required)":"(обов’язково)"};var gV={};gV={"(optional)":"（可选）","(required)":"（必填）"};var yV={};yV={"(optional)":"(選填)","(required)":"(必填)"};FU={"ar-AE":zU,"bg-BG":NU,"cs-CZ":BU,"da-DK":UU,"de-DE":VU,"el-GR":GU,"en-US":jU,"es-ES":HU,"et-EE":WU,"fi-FI":KU,"fr-FR":qU,"he-IL":XU,"hr-HR":ZU,"hu-HU":YU,"it-IT":JU,"ja-JP":QU,"ko-KR":eV,"lt-LT":tV,"lv-LV":nV,"nb-NO":rV,"nl-NL":iV,"pl-PL":sV,"pt-BR":oV,"pt-PT":aV,"ro-RO":lV,"ru-RU":cV,"sk-SK":uV,"sl-SI":dV,"sr-SP":hV,"sv-SE":fV,"tr-TR":pV,"uk-UA":mV,"zh-CN":gV,"zh-TW":yV};var ur={};Er(ur,"spectrum-FieldLabel",()=>FA,t=>FA=t);Er(ur,"spectrum-FieldLabel--positionSide",()=>zA,t=>zA=t);Er(ur,"spectrum-FieldLabel-requiredIcon",()=>NA,t=>NA=t);Er(ur,"spectrum-FieldLabel--alignEnd",()=>BA,t=>BA=t);Er(ur,"spectrum-Field",()=>UA,t=>UA=t);Er(ur,"spectrum-Field-contextualHelp",()=>VA,t=>VA=t);Er(ur,"spectrum-Field--positionTop",()=>GA,t=>GA=t);Er(ur,"spectrum-Field-field",()=>jA,t=>jA=t);Er(ur,"spectrum-Field--alignEnd",()=>HA,t=>HA=t);Er(ur,"spectrum-Field--positionSide",()=>WA,t=>WA=t);Er(ur,"spectrum-Field-wrapper",()=>KA,t=>KA=t);Er(ur,"spectrum-Field--hasContextualHelp",()=>qA,t=>qA=t);Er(ur,"spectrum-Form",()=>XA,t=>XA=t);Er(ur,"spectrum-Form--positionSide",()=>ZA,t=>ZA=t);Er(ur,"spectrum-Field-labelCell",()=>YA,t=>YA=t);Er(ur,"spectrum-Field-labelWrapper",()=>JA,t=>JA=t);Er(ur,"spectrum-Form--positionTop",()=>QA,t=>QA=t);Er(ur,"spectrum-LabeledValue",()=>e3,t=>e3=t);Er(ur,"spectrum-Form-itemLabel",()=>t3,t=>t3=t);Er(ur,"is-disabled",()=>n3,t=>n3=t);var FA,zA,NA,BA,UA,VA,GA,jA,HA,WA,KA,qA,XA,ZA,YA,JA,QA,e3,t3,n3;FA="spectrum-FieldLabel_d2db1f";zA="spectrum-FieldLabel--positionSide_d2db1f";NA="spectrum-FieldLabel-requiredIcon_d2db1f";BA="spectrum-FieldLabel--alignEnd_d2db1f";UA="spectrum-Field_d2db1f";VA="spectrum-Field-contextualHelp_d2db1f";GA="spectrum-Field--positionTop_d2db1f";jA="spectrum-Field-field_d2db1f";HA="spectrum-Field--alignEnd_d2db1f";WA="spectrum-Field--positionSide_d2db1f";KA="spectrum-Field-wrapper_d2db1f";qA="spectrum-Field--hasContextualHelp_d2db1f";XA="spectrum-Form_d2db1f";ZA="spectrum-Form--positionSide_d2db1f";YA="spectrum-Field-labelCell_d2db1f";JA="spectrum-Field-labelWrapper_d2db1f";QA="spectrum-Form--positionTop_d2db1f";e3="spectrum-LabeledValue_d2db1f";t3="spectrum-Form-itemLabel_d2db1f";n3="is-disabled_d2db1f";function H1e(t,e){t=Rb(t);let{children:n,labelPosition:r="top",labelAlign:i=r==="side"?"start":null,isRequired:s,necessityIndicator:c=s!=null?"icon":null,includeNecessityIndicatorInAccessibilityName:o=!1,htmlFor:f,for:m,elementType:x="label",onClick:S,...T}=t,C=ma(e),{styleProps:R}=Ni(T),D=Nl(mo(FU)),H=s?D.format("(required)"):D.format("(optional)"),F=ce.createElement(V1e,{UNSAFE_className:st(mo(ur),"spectrum-FieldLabel-requiredIcon"),"aria-label":o?D.format("(required)"):void 0}),k=st(mo(ur),"spectrum-FieldLabel",{"spectrum-FieldLabel--positionSide":r==="side","spectrum-FieldLabel--alignEnd":i==="end"},R.className);return ce.createElement(x,{...ps(T),...R,onClick:S,ref:C,className:k,htmlFor:x==="label"?m||f:void 0},n,(c==="label"||c==="icon"&&s)&&" ​",c==="label"&&ce.createElement("span",{"aria-hidden":o?void 0:s},H),c==="icon"&&s&&F)}let W1e=ce.forwardRef(H1e);function K1e(t,e){let n=k1e(t),r=n!==t;t=n;let{label:i,labelPosition:s="top",labelAlign:c,isRequired:o,necessityIndicator:f,includeNecessityIndicatorInAccessibilityName:m,validationState:x,description:S,errorMessage:T,isDisabled:C,showErrorIcon:R,contextualHelp:D,children:H,labelProps:F,descriptionProps:k={},errorMessageProps:N={},elementType:U,wrapperClassName:ie,wrapperProps:he={},...le}=t,{styleProps:ve}=Ni(le),Oe=!!S||T&&x==="invalid",Re=jo(),Ee=st(mo(ur),"spectrum-Field",{"spectrum-Field--positionTop":s==="top","spectrum-Field--positionSide":s==="side","spectrum-Field--alignEnd":c==="end","spectrum-Field--hasContextualHelp":!!t.contextualHelp},ve.className,ie);H=ce.cloneElement(H,kn(H.props,{className:st(mo(ur),"spectrum-Field-field")}));let $e=()=>ce.createElement(j1e,{descriptionProps:k,errorMessageProps:N,description:S,errorMessage:T,validationState:x,isDisabled:C,showErrorIcon:R,gridArea:"helpText"}),we=()=>s==="side"?ce.createElement(aA,{direction:"column",UNSAFE_className:st(mo(ur),"spectrum-Field-wrapper")},H,Oe&&$e()):ce.createElement(ce.Fragment,null,H,Oe&&$e()),Be=ce.createElement(ce.Fragment,null,i&&ce.createElement(W1e,{...F,labelPosition:s,labelAlign:c,isRequired:o,necessityIndicator:f,includeNecessityIndicatorInAccessibilityName:m,elementType:U},i),i&&D&&ce.createElement(Sb,{slots:{actionButton:{UNSAFE_className:st(mo(ur),"spectrum-Field-contextualHelp"),id:Re,"aria-labelledby":F!=null&&F.id?`${F.id} ${Re}`:void 0}}},D));return r&&s==="side"&&i&&D&&(Be=ce.createElement("div",{className:st(mo(ur),"spectrum-Field-labelCell")},ce.createElement("div",{className:st(mo(ur),"spectrum-Field-labelWrapper")},Be))),ce.createElement("div",{...ve,...he,ref:e,className:Ee},Be,we())}let r$=ce.forwardRef(K1e);function i$(t){let{id:e,label:n,"aria-labelledby":r,"aria-label":i,labelElementType:s="label"}=t;e=jo(e);let c=jo(),o={};n?(r=r?`${r} ${c}`:c,o={id:c,htmlFor:s==="label"?e:void 0}):!r&&!i&&console.warn("If you do not provide a visible label, you must specify an aria-label or aria-labelledby attribute for accessibility");let f=mv({id:e,"aria-label":i,"aria-labelledby":r});return{labelProps:o,fieldProps:f}}function _V(t){let{description:e,errorMessage:n,validationState:r}=t,{labelProps:i,fieldProps:s}=i$(t),c=sg([!!e,!!n,r]),o=sg([!!e,!!n,r]);return s=kn(s,{"aria-describedby":[c,o,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:i,fieldProps:s,descriptionProps:{id:c},errorMessageProps:{id:o}}}const Mb=new WeakMap;function q1e(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function vV(t,e){let n=Mb.get(t);if(!n)throw new Error("Unknown list");return`${n.id}-option-${q1e(e)}`}function X1e(t,e,n){let r=ps(t,{labelable:!0}),{listProps:i}=c1e({...t,ref:n,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys}),{focusWithinProps:s}=Pb({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),c=jo(t.id);Mb.set(e,{id:c,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction});let{labelProps:o,fieldProps:f}=i$({...t,id:c,labelElementType:"span"});return{labelProps:o,listBoxProps:kn(r,s,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...kn(f,i)})}}function Z1e(t,e,n){let{key:r}=t,i=Mb.get(e);var s;let c=(s=t.isDisabled)!==null&&s!==void 0?s:e.disabledKeys.has(r);var o;let f=(o=t.isSelected)!==null&&o!==void 0?o:e.selectionManager.isSelected(r);var m;let x=(m=t.shouldSelectOnPressUp)!==null&&m!==void 0?m:i==null?void 0:i.shouldSelectOnPressUp;var S;let T=(S=t.shouldFocusOnHover)!==null&&S!==void 0?S:i==null?void 0:i.shouldFocusOnHover;var C;let R=(C=t.shouldUseVirtualFocus)!==null&&C!==void 0?C:i==null?void 0:i.shouldUseVirtualFocus;var D;let H=(D=t.isVirtualized)!==null&&D!==void 0?D:i==null?void 0:i.isVirtualized,F=sg(),k=sg(),N={role:"option","aria-disabled":c||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?f:void 0};if(Og()&&z0e()||(N["aria-label"]=t["aria-label"],N["aria-labelledby"]=F,N["aria-describedby"]=k),H){var U;let Ee=Number((U=e.collection.getItem(r))===null||U===void 0?void 0:U.index);N["aria-posinset"]=Number.isNaN(Ee)?void 0:Ee+1,N["aria-setsize"]=y9(e.collection)}let{itemProps:ie,isPressed:he,isFocused:le,hasAction:ve,allowsSelection:Oe}=l1e({selectionManager:e.selectionManager,key:r,ref:n,shouldSelectOnPressUp:x,allowsDifferentPressOrigin:x&&T,isVirtualized:H,shouldUseVirtualFocus:R,isDisabled:c,onAction:i!=null&&i.onAction?()=>{var Ee;return i==null||(Ee=i.onAction)===null||Ee===void 0?void 0:Ee.call(i,r)}:void 0}),{hoverProps:Re}=Xc({isDisabled:c||!T,onHoverStart(){ag()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(r))}});return{optionProps:{...N,...kn(ie,Re),id:vV(e,r)},labelProps:{id:F},descriptionProps:{id:k},isFocused:le,isFocusVisible:le&&ag(),isSelected:f,isDisabled:c,isPressed:he,allowsSelection:Oe,hasAction:ve}}function Y1e(t){let{heading:e,"aria-label":n}=t,r=jo();return{itemProps:{role:"presentation"},headingProps:e?{id:r,"aria-hidden":!0}:{},groupProps:{role:"group","aria-label":n,"aria-labelledby":e?r:void 0}}}class J1e{shouldInvalidate(e,n){return e.width!==n.width||e.height!==n.height}validate(e){}getInitialLayoutInfo(e){return e}getFinalLayoutInfo(e){return e}}class ku{copy(){let e=new ku(this.type,this.key,this.rect.copy());return e.estimatedSize=this.estimatedSize,e.opacity=this.opacity,e.transform=this.transform,e.parentKey=this.parentKey,e.isSticky=this.isSticky,e.zIndex=this.zIndex,e.allowOverflow=this.allowOverflow,e}constructor(e,n,r){this.type=e,this.key=n,this.parentKey=null,this.rect=r,this.estimatedSize=!1,this.isSticky=!1,this.opacity=1,this.transform=null,this.zIndex=0,this.allowOverflow=!1}}class Vs{copy(){return new Vs(this.x,this.y)}equals(e){return this.x===e.x&&this.y===e.y}isOrigin(){return this.x===0&&this.y===0}constructor(e=0,n=0){this.x=e,this.y=n}}class Ur{get maxX(){return this.x+this.width}get maxY(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new Vs(this.x,this.y)}get topRight(){return new Vs(this.maxX,this.y)}get bottomLeft(){return new Vs(this.x,this.maxY)}get bottomRight(){return new Vs(this.maxX,this.maxY)}intersects(e){return this.x<=e.x+e.width&&e.x<=this.x+this.width&&this.y<=e.y+e.height&&e.y<=this.y+this.height}containsRect(e){return this.x<=e.x&&this.y<=e.y&&this.maxX>=e.maxX&&this.maxY>=e.maxY}containsPoint(e){return this.x<=e.x&&this.y<=e.y&&this.maxX>=e.x&&this.maxY>=e.y}getCornerInRect(e){for(let n of["topLeft","topRight","bottomLeft","bottomRight"])if(e.containsPoint(this[n]))return n;return null}equals(e){return e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height}pointEquals(e){return this.x===e.x&&this.y===e.y}sizeEquals(e){return this.width===e.width&&this.height===e.height}union(e){let n=Math.min(this.x,e.x),r=Math.min(this.y,e.y),i=Math.max(this.maxX,e.maxX)-n,s=Math.max(this.maxY,e.maxY)-r;return new Ur(n,r,i,s)}intersection(e){if(!this.intersects(e))return new Ur(0,0,0,0);let n=Math.max(this.x,e.x),r=Math.max(this.y,e.y);return new Ur(n,r,Math.min(this.maxX,e.maxX)-n,Math.min(this.maxY,e.maxY)-r)}copy(){return new Ur(this.x,this.y,this.width,this.height)}constructor(e=0,n=0,r=0,i=0){this.x=e,this.y=n,this.width=r,this.height=i}}class ad{copy(){return new ad(this.width,this.height)}equals(e){return this.width===e.width&&this.height===e.height}get area(){return this.width*this.height}constructor(e=0,n=0){this.width=e,this.height=n}}let Q1e=0;class exe{prepareForReuse(){this.content=null,this.rendered=null,this.layoutInfo=null}constructor(e){this.virtualizer=e,this.key=++Q1e}}let fh=typeof window<"u"?window.performance:null,QO=fh&&(fh.now||fh.webkitNow||fh.msNow||fh.mozNow),Ow=QO?QO.bind(fh):function(){return Date.now?Date.now():new Date().getTime()},Dw;function txe(t,e,n,r,i){let s=!1,c,o=new Promise(f=>{let m=Ow(),x=e.x-t.x,S=e.y-t.y;c=requestAnimationFrame(function T(C){Dw==null&&(Dw=C>1e12!=Ow()>1e12),Dw&&(C=Ow());let R=C-m;R>n?(i(e),f()):i(new Vs(t.x+x*r(R/n),t.y+S*r(R/n)))!==!1&&!s&&(c=requestAnimationFrame(T))})});return o.cancel=function(){s=!0,cancelAnimationFrame(c)},o}function nxe(t){return Math.sin(t*Math.PI/2)}function eD(t,e){let n=new Set;for(let r of t.keys())e.has(r)||n.add(r);return n}function rxe(t,e){let n=eD(t,e),r=eD(e,t),i=new Set;for(let s of t.keys())e.has(s)&&i.add(s);return{toRemove:n,toAdd:r,toUpdate:i}}function*ixe(...t){for(let e of t)yield*e}function sxe(t,e){if(t===e)return!0;if(t.size!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0}class N_{addSample(e){this.count++,this.value+=(e-this.value)/this.count}constructor(){Cr(this,"count",0),Cr(this,"value",0)}}class oxe{setVisibleRect(e){let n=performance.now()-this.startTime;n<500&&(this.averageTime.addSample(n),e.x!==this.visibleRect.x&&n>0&&(this.velocity.x=(e.x-this.visibleRect.x)/n),e.y!==this.visibleRect.y&&n>0&&(this.velocity.y=(e.y-this.visibleRect.y)/n)),this.startTime=performance.now(),this.visibleRect=e}collectMetrics(){let e=performance.now()-this.startTime;if(e<500&&this.averagePerf.addSample(e),this.visibleRect.height>0){let n=Math.abs(this.velocity.y*(this.averageTime.value+this.averagePerf.value));this.overscanY.addSample(n)}if(this.visibleRect.width>0){let n=Math.abs(this.velocity.x*(this.averageTime.value+this.averagePerf.value));this.overscanX.addSample(n)}}getOverscannedRect(){let e=this.visibleRect.copy(),n=Math.round(Math.min(this.visibleRect.height*2,this.overscanY.value)/100)*100;this.velocity.y>0?(e.y-=n*.2,e.height+=n+n*.2):(e.y-=n,e.height+=n+n*.2);let r=Math.round(Math.min(this.visibleRect.width*2,this.overscanX.value)/100)*100;return this.velocity.x>0?(e.x-=r*.2,e.width+=r+r*.2):(e.x-=r,e.width+=r+r*.2),e}constructor(){Cr(this,"startTime",0),Cr(this,"averagePerf",new N_),Cr(this,"averageTime",new N_),Cr(this,"velocity",new Vs(5,5)),Cr(this,"overscanX",new N_),Cr(this,"overscanY",new N_),Cr(this,"visibleRect",new Ur)}}class axe{constructor(){Cr(this,"level",0),Cr(this,"actions",[]),Cr(this,"animated",!0),Cr(this,"initialMap",new Map),Cr(this,"finalMap",new Map),Cr(this,"initialLayoutInfo",new Map),Cr(this,"finalLayoutInfo",new Map),Cr(this,"removed",new Map),Cr(this,"toRemove",new Map)}}class lxe{_setContentSize(e){this._contentSize=e,this.delegate.setContentSize(e)}_setContentOffset(e){let n=new Ur(e.x,e.y,this._visibleRect.width,this._visibleRect.height);this.delegate.setVisibleRect(n)}get contentSize(){return this._contentSize}get visibleRect(){return this._visibleRect}set visibleRect(e){this._setVisibleRect(e)}_setVisibleRect(e,n=!1){let r=this._visibleRect;if(e.equals(r))return;this.shouldOverscan&&this._overscanManager.setVisibleRect(e);let i=this.layout&&this.layout.shouldInvalidate(e,this._visibleRect);this._resetAnimatedContentOffset(),this._visibleRect=e,i?this.relayout({offsetChanged:!e.pointEquals(r),sizeChanged:!e.sizeEquals(r)}):this.updateSubviews(n)}get collection(){return this._collection}set collection(e){this._setData(e)}_setData(e){e!==this._collection&&(this._collection?this._runTransaction(()=>{this._collection=e},this.transitionDuration>0):(this._collection=e,this.reloadData()))}reloadData(){this.relayout({contentChanged:!0})}getItem(e){return this._collection?this._collection.getItem(e):null}get persistedKeys(){return this._persistedKeys}set persistedKeys(e){sxe(e,this._persistedKeys)||(this._persistedKeys=e,this.updateSubviews())}isPersistedKey(e){if(this._persistedKeys.has(e))return!0;for(let n of this._persistedKeys)for(;n!=null;){let r=this.layout.getLayoutInfo(n);if(!r)break;if(n=r.parentKey,n===e)return!0}return!1}get layout(){return this._layout}set layout(e){this.setLayout(e)}setLayout(e,n=!1){if(e===this._layout)return;let r=()=>{this._layout&&(this._layout.virtualizer=null),e.virtualizer=this,this._layout=e};n?this._runTransaction(r):(r(),this.relayout())}_getReuseType(e,n){if(e.type==="item"&&n){let r=this.delegate.getType?this.delegate.getType(n):"item",i=r==="item"?"item":e.type+"_"+r;return{type:r,reuseType:i}}return{type:e.type,reuseType:e.type}}getReusableView(e){let n=this.getItem(e.key),{reuseType:r}=this._getReuseType(e,n);this._reusableViews[r]||(this._reusableViews[r]=[]);let i=this._reusableViews[r],s=i.length>0?i.pop():new exe(this);return s.viewType=r,this._animatedContentOffset.isOrigin()||(e=e.copy(),e.rect.x+=this._animatedContentOffset.x,e.rect.y+=this._animatedContentOffset.y),s.layoutInfo=e,this._renderView(s),s}_renderView(e){let{type:n,key:r}=e.layoutInfo;e.content=this.getItem(r),e.rendered=this._renderContent(n,e.content)}_renderContent(e,n){let r=this._renderedContent.get(n);if(r!=null)return r;let i=this.delegate.renderView(e,n);return n&&this._renderedContent.set(n,i),i}get visibleViews(){return Array.from(this._visibleViews.values())}getView(e){return this._visibleViews.get(e)||null}getViewsOfType(e){return this.visibleViews.filter(n=>n.layoutInfo&&n.layoutInfo.type===e)}keyForView(e){return e&&e.layoutInfo?e.layoutInfo.key:null}keyAtPoint(e){let n=new Ur(e.x,e.y,1,1),r=this.layout.getVisibleLayoutInfos(n);for(let i of r)if(i.rect.intersects(n))return i.key;return null}willUnmount(){cancelAnimationFrame(this._relayoutRaf)}relayout(e={}){if(!(this._scrollAnimation||typeof requestAnimationFrame>"u")){if(this._invalidationContext){Object.assign(this._invalidationContext,e);return}this._invalidationContext=e,this._relayoutRaf=requestAnimationFrame(()=>{this._relayoutRaf=null,this.relayoutNow()})}}relayoutNow(e=this._invalidationContext||{}){if(this._relayoutRaf&&(cancelAnimationFrame(this._relayoutRaf),this._relayoutRaf=null,e={...this._invalidationContext,...e}),this._invalidationContext=null,!this.layout||!this._collection||this._scrollAnimation)return;let n=this._getScrollAnchor();typeof e.beforeLayout=="function"&&e.beforeLayout(),this.layout.validate(e),this._setContentSize(this.layout.getContentSize()),typeof e.afterLayout=="function"&&e.afterLayout();let r=this.getVisibleRect(),i=this._restoreScrollAnchor(n,e),s=e.contentChanged?0:i.x,c=e.contentChanged?0:i.y;s=Math.max(0,Math.min(this.contentSize.width-r.width,s)),c=Math.max(0,Math.min(this.contentSize.height-r.height,c));let o=!1;if(s!==r.x||c!==r.y?e.animated||!this._animatedContentOffset.isOrigin()?(this._animatedContentOffset.x+=r.x-s,this._animatedContentOffset.y+=r.y-c,o=this.updateSubviews(e.contentChanged)):this._setContentOffset(new Vs(s,c)):o=this.updateSubviews(e.contentChanged),e.transaction&&e.animated||this._applyLayoutInfos(),e.animated&&o){this._enableTransitions(),setTimeout(()=>{if(this._disableTransitions(),!this._animatedContentOffset.isOrigin()){let{x:m,y:x}=this.getVisibleRect();this._resetAnimatedContentOffset(),this._setContentOffset(new Vs(m,x))}typeof e.afterAnimation=="function"&&e.afterAnimation()},this.transitionDuration+100);return}else typeof e.afterAnimation=="function"&&e.afterAnimation()}_correctItemOrder(){if(!(this._isScrolling||this._transaction))for(let e of this._visibleLayoutInfos.keys()){let n=this._visibleViews.get(e);this._children.delete(n),this._children.add(n)}}_enableTransitions(){this.delegate.beginAnimations()}_disableTransitions(){this.delegate.endAnimations()}_getScrollAnchor(){if(!this.anchorScrollPosition)return null;let e=this.getVisibleRect();if(this.delegate.getScrollAnchor){let r=this.delegate.getScrollAnchor(e);if(r!=null){let i=this.layout.getLayoutInfo(r),s=i.rect.getCornerInRect(e);if(s){let c=i.key,o=i.rect[s].y-e.y;return{key:c,layoutInfo:i,corner:s,offset:o}}}}if(e.y===0&&!this.anchorScrollPositionAtTop)return null;let n=null;for(let[r,i]of this._visibleViews){let s=i.layoutInfo;if(s&&s.rect.area>0){let c=s.rect.getCornerInRect(e);if(c){let o=s.rect[c].y-e.y;(!n||o<n.offset)&&(n={key:r,layoutInfo:s,corner:c,offset:o})}}}return n}_restoreScrollAnchor(e,n){let r=this.getVisibleRect();if(e){var i;let s=!((i=n.transaction)===null||i===void 0)&&i.animated?n.transaction.finalMap.get(e.key):this.layout.getLayoutInfo(e.layoutInfo.key);if(s){let c=s.rect[e.corner].y-r.y-e.offset;r.y+=c}}return r}getVisibleRect(){let e=this.visibleRect,n=e.x-this._animatedContentOffset.x,r=e.y-this._animatedContentOffset.y;return new Ur(n,r,e.width,e.height)}getVisibleLayoutInfos(){let e=this.shouldOverscan?this._overscanManager.getOverscannedRect():this.getVisibleRect();return this._visibleLayoutInfos=this._getLayoutInfoMap(e),this._visibleLayoutInfos}_getLayoutInfoMap(e,n=!1){let r=this.layout.getVisibleLayoutInfos(e),i=new Map;for(let s of r)n&&(s=s.copy()),i.set(s.key,s);return i}updateSubviews(e=!1){if(!this._collection)return;let n=this.getVisibleLayoutInfos(),r=this._visibleViews,i,s,c;if(e)i=n,s=r,c=new Set;else{({toAdd:i,toRemove:s,toUpdate:c}=rxe(r,n));for(let m of c){let x=r.get(m);if(!x||!x.layoutInfo)continue;let S=this.getItem(n.get(m).key);if(x.content===S)c.delete(m);else{let{reuseType:T}=this._getReuseType(x.layoutInfo,S);x.viewType!==T&&(c.delete(m),i.add(m),s.add(m))}}if(i.size===0&&s.size===0&&c.size===0){this._transaction&&this._applyLayoutInfos();return}}let o=new Set;for(let m of s.keys()){let x=this._visibleViews.get(m);x&&(o.add(x),this._visibleViews.delete(m),this._transaction?this._transaction.toRemove.set(m,x):this.reuseView(x))}for(let m of i.keys()){let x=n.get(m),S;this._transaction&&(this._transaction.initialLayoutInfo.has(m)&&(x=this._transaction.initialLayoutInfo.get(m)),S=this._transaction.toRemove.get(m),S&&(this._transaction.toRemove.delete(m),this._applyLayoutInfo(S,x))),S||(S=this.getReusableView(x),o.has(S)||this._children.add(S)),this._visibleViews.set(m,S),o.delete(S)}for(let m of c){let x=r.get(m);this._renderedContent.delete(m),this._renderView(x)}this._transaction||this.removeViews(o),this._correctItemOrder(),this._flushVisibleViews();let f=this._transaction&&(i.size>0||s.size>0||this._hasLayoutUpdates());return f&&requestAnimationFrame(()=>{this._transaction&&requestAnimationFrame(()=>this._applyLayoutInfos())}),f}afterRender(){this.shouldOverscan&&this._overscanManager.collectMetrics()}_flushVisibleViews(){let e=new Map([[null,[]]]);for(let m of this._children){var n,r,i,s,c;((n=m.layoutInfo)===null||n===void 0?void 0:n.parentKey)!=null&&!e.has(m.layoutInfo.parentKey)&&e.set(m.layoutInfo.parentKey,[]),(r=e.get((i=m.layoutInfo)===null||i===void 0?void 0:i.parentKey))===null||r===void 0||r.push(m),e.has((s=m.layoutInfo)===null||s===void 0?void 0:s.key)||e.set((c=m.layoutInfo)===null||c===void 0?void 0:c.key,[])}let o=(m,x)=>x.map(S=>{let T=e.get(S.layoutInfo.key);return this.delegate.renderWrapper(m,S,T,C=>o(S,C))}),f=o(null,e.get(null));this.delegate.setVisibleViews(f)}_applyLayoutInfo(e,n){return e.layoutInfo===n?!1:(e.layoutInfo=n,!0)}_applyLayoutInfos(){let e=!1;for(let n of this._visibleViews.values()){let r=n.layoutInfo;if((r==null?void 0:r.key)!=null){let i=this.layout.getLayoutInfo(r.key);this._applyLayoutInfo(n,i)&&(e=!0)}}if(this._transaction){for(let n of this._transaction.toRemove.values()){let r=n.layoutInfo;if((r==null?void 0:r.key)!=null){let i=this.layout.getLayoutInfo(r.key);this._applyLayoutInfo(n,i)&&(e=!0)}}for(let n of this._transaction.removed.values()){let r=n.layoutInfo,i=this._transaction.finalLayoutInfo.get(r.key)||r;i=this.layout.getFinalLayoutInfo(i.copy()),this._applyLayoutInfo(n,i)&&(e=!0)}}e&&this._flushVisibleViews()}_hasLayoutUpdates(){if(!this._transaction)return!1;for(let e of this._visibleViews.values()){let n=e.layoutInfo;if(!n)return!0;let r=this.layout.getLayoutInfo(n.key);if(!n.rect.equals(r.rect)||n.opacity!==r.opacity||n.transform!==r.transform)return!0}return!1}reuseView(e){e.prepareForReuse(),this._reusableViews[e.viewType].push(e)}removeViews(e){for(let n of e)this._children.delete(n)}updateItemSize(e,n){if(!this.layout.updateItemSize)return;if(this._scrollAnimation){this._sizeUpdateQueue.set(e,n);return}this.layout.updateItemSize(e,n)&&this.relayout()}startScrolling(){this._isScrolling=!0}endScrolling(){this._isScrolling=!1,this._correctItemOrder(),this._flushVisibleViews()}_resetAnimatedContentOffset(){this._animatedContentOffset.isOrigin()||(this._animatedContentOffset=new Vs(0,0),this._applyLayoutInfos())}scrollToItem(e,n){if(e==null)return;let r=this.layout.getLayoutInfo(e);if(!r)return;let{duration:i=300,shouldScrollX:s=!0,shouldScrollY:c=!0,offsetX:o=0,offsetY:f=0}=n,m=this.visibleRect.x,x=this.visibleRect.y,S=r.rect.x-o,T=r.rect.y-f,C=m+this.visibleRect.width,R=x+this.visibleRect.height;return s&&(S<=m||C===0?m=S:r.rect.maxX>C&&(m+=r.rect.maxX-C)),c&&(T<=x||R===0?x=T:r.rect.maxY>R&&(x+=r.rect.maxY-R)),this.scrollTo(new Vs(m,x),i)}scrollTo(e,n=300){return this._scrollAnimation&&(this._scrollAnimation.cancel(),this._scrollAnimation=null),n<=0||this.visibleRect.pointEquals(e)?(this._setContentOffset(e),Promise.resolve()):(this.startScrolling(),this._scrollAnimation=txe(this.visibleRect,e,n,nxe,r=>{this._setContentOffset(r)}),this._scrollAnimation.then(()=>{this._scrollAnimation=null;for(let[r,i]of this._sizeUpdateQueue)this.updateItemSize(r,i);this._sizeUpdateQueue.clear(),this.relayout(),this._processTransactionQueue(),this.endScrolling()}),this._scrollAnimation)}_runTransaction(e,n){this._startTransaction(),this._nextTransaction&&this._nextTransaction.actions.push(e),this._endTransaction(n)}_startTransaction(){this._nextTransaction||(this._nextTransaction=new axe),this._nextTransaction.level++}_endTransaction(e){return!this._nextTransaction||(e!=null&&(this._nextTransaction.animated=e),--this._nextTransaction.level>0)?!1:this._nextTransaction.actions.length===0?(this._nextTransaction=null,!1):(this._nextTransaction.animated==null&&(this._nextTransaction.animated=!0),this._transactionQueue.push(this._nextTransaction),this._nextTransaction=null,this._processTransactionQueue(),!0)}_processTransactionQueue(){if(this._transaction||this._scrollAnimation)return;let e=this._transactionQueue.shift();e&&this._performTransaction(e)}_getContentRect(){return new Ur(0,0,this.contentSize.width,this.contentSize.height)}_performTransaction(e){this._transaction=e,this.relayoutNow({transaction:e,animated:e.animated,beforeLayout:()=>{e.animated&&(e.initialMap=this._getLayoutInfoMap(this._getContentRect(),!0));for(let n of e.actions)n()},afterLayout:()=>{e.animated?(e.finalMap=this._getLayoutInfoMap(this._getContentRect()),this._setupTransactionAnimations(e)):this._transaction=null},afterAnimation:()=>{if(e.toRemove.size>0||e.removed.size>0)for(let n of ixe(e.toRemove.values(),e.removed.values()))this._children.delete(n),this.reuseView(n);this._transaction=null,this._correctItemOrder(),this._flushVisibleViews(),this._processTransactionQueue()}})}_setupTransactionAnimations(e){let{initialMap:n,finalMap:r}=e;for(let[i,s]of n)r.has(i)?e.initialLayoutInfo.set(i,s):e.finalLayoutInfo.set(s.key,s);for(let[i,s]of r)if(!n.has(i)){let c=this.layout.getInitialLayoutInfo(s.copy());e.initialLayoutInfo.set(i,c)}for(let[i,s]of this._visibleViews)!r.has(i)&&s.layoutInfo.rect.width>0&&(e.removed.set(i,s),this._visibleViews.delete(i),s.layoutInfo&&(e.finalLayoutInfo.has(s.layoutInfo.key)||e.finalLayoutInfo.set(s.layoutInfo.key,s.layoutInfo)))}constructor(e={}){this._contentSize=new ad,this._visibleRect=new Ur,this._reusableViews={},this._visibleLayoutInfos=new Map,this._visibleViews=new Map,this._renderedContent=new WeakMap,this._children=new Set,this._invalidationContext=null,this._overscanManager=new oxe,this._persistedKeys=new Set,this._scrollAnimation=null,this._isScrolling=!1,this._sizeUpdateQueue=new Map,this._animatedContentOffset=new Vs(0,0),this._transaction=null,this._nextTransaction=null,this._transactionQueue=[];var n;this.transitionDuration=(n=e.transitionDuration)!==null&&n!==void 0?n:500,this.anchorScrollPosition=e.anchorScrollPosition||!1,this.anchorScrollPositionAtTop=e.anchorScrollPositionAtTop||!1,this.shouldOverscan=e.shouldOverscan!==!1;for(let r of["delegate","size","layout","collection"])e[r]&&(this[r]=e[r])}}function cxe(t){let[e,n]=ee.useState([]),[r,i]=ee.useState(new ad),[s,c]=ee.useState(!1),[o,f]=ee.useState(!1),m=ee.useMemo(()=>new lxe,[]);m.delegate={setVisibleViews:n,setVisibleRect(R){m.visibleRect=R,t.onVisibleRectChange(R)},setContentSize:i,renderView:t.renderView,renderWrapper:t.renderWrapper,beginAnimations:()=>c(!0),endAnimations:()=>c(!1),getScrollAnchor:t.getScrollAnchor},m.layout=t.layout,m.collection=t.collection,m.transitionDuration=t.transitionDuration,wr(()=>{m.afterRender()}),ee.useEffect(()=>()=>m.willUnmount(),[]);let x=ee.useCallback(R=>{m.visibleRect=R},[m]),S=ee.useCallback(()=>{m.startScrolling(),f(!0)},[m]),T=ee.useCallback(()=>{m.endScrolling(),f(!1)},[m]);return ee.useMemo(()=>({virtualizer:m,visibleViews:e,setVisibleRect:x,contentSize:r,isAnimating:s,isScrolling:o,startScrolling:S,endScrolling:T}),[m,e,x,r,s,o,S,T])}const tD=48;class uxe extends J1e{getLayoutInfo(e){let n=this.layoutInfos.get(e);return!n&&this.validRect.area<this.contentSize.area&&this.lastCollection&&(this.lastValidRect=this.validRect,this.validRect=new Ur(0,0,1/0,1/0),this.rootNodes=this.buildCollection(),this.validRect=new Ur(0,0,this.contentSize.width,this.contentSize.height),n=this.layoutInfos.get(e)),n}getVisibleLayoutInfos(e){!this.validRect.containsRect(e)&&this.lastCollection&&(this.lastValidRect=this.validRect,this.validRect=this.validRect.union(e),this.rootNodes=this.buildCollection());let n=[],r=i=>{for(let s of i)this.isVisible(s,e)&&(n.push(s.layoutInfo),s.header&&n.push(s.header),s.children&&r(s.children))};return r(this.rootNodes),n}isVisible(e,n){return e.layoutInfo.rect.intersects(n)||e.layoutInfo.isSticky||this.virtualizer.isPersistedKey(e.layoutInfo.key)}shouldInvalidateEverything(e){return e.sizeChanged}validate(e){if(this.collection=this.virtualizer.collection,this.invalidateEverything=this.shouldInvalidateEverything(e),this.invalidateEverything&&(this.lastValidRect=this.validRect,this.validRect=this.virtualizer.getVisibleRect()),this.rootNodes=this.buildCollection(),this.lastCollection&&this.collection!==this.lastCollection){for(let r of this.lastCollection.getKeys())if(!this.collection.getItem(r)){let i=this.layoutNodes.get(r);if(i){var n;this.layoutInfos.delete(i.layoutInfo.key),this.layoutInfos.delete((n=i.header)===null||n===void 0?void 0:n.key),this.layoutNodes.delete(r)}}}this.lastWidth=this.virtualizer.visibleRect.width,this.lastCollection=this.collection,this.invalidateEverything=!1}buildCollection(){let e=this.padding,n=0,r=[];for(let o of this.collection){var i;let f=(i=this.rowHeight)!==null&&i!==void 0?i:this.estimatedRowHeight;if(o.type==="item"&&e+f<this.validRect.y&&!this.isValid(o,e)){e+=f,n++;continue}let m=this.buildChild(o,0,e);if(e=m.layoutInfo.rect.maxY,r.push(m),o.type==="item"&&e>this.validRect.maxY){e+=(this.collection.size-(r.length+n))*f;break}}if(this.isLoading){var s;let o=new Ur(0,e,this.virtualizer.visibleRect.width,(s=this.loaderHeight)!==null&&s!==void 0?s:this.virtualizer.visibleRect.height),f=new ku("loader","loader",o);this.layoutInfos.set("loader",f),r.push({layoutInfo:f}),e=f.rect.maxY}if(r.length===0){var c;let o=new Ur(0,e,this.virtualizer.visibleRect.width,(c=this.placeholderHeight)!==null&&c!==void 0?c:this.virtualizer.visibleRect.height),f=new ku("placeholder","placeholder",o);this.layoutInfos.set("placeholder",f),r.push({layoutInfo:f}),e=f.rect.maxY}return this.contentSize=new ad(this.virtualizer.visibleRect.width,e+this.padding),r}isValid(e,n){let r=this.layoutNodes.get(e.key);return!this.invalidateEverything&&r&&r.node===e&&n===(r.header||r.layoutInfo).rect.y&&r.layoutInfo.rect.intersects(this.lastValidRect)&&r.validRect.containsRect(r.layoutInfo.rect.intersection(this.validRect))}buildChild(e,n,r){if(this.isValid(e,r))return this.layoutNodes.get(e.key);let i=this.buildNode(e,n,r);i.node=e;var s;return i.layoutInfo.parentKey=(s=e.parentKey)!==null&&s!==void 0?s:null,this.layoutInfos.set(i.layoutInfo.key,i.layoutInfo),i.header&&this.layoutInfos.set(i.header.key,i.header),this.layoutNodes.set(e.key,i),i}buildNode(e,n,r){switch(e.type){case"section":return this.buildSection(e,n,r);case"item":return this.buildItem(e,n,r)}}buildSection(e,n,r){let i=this.virtualizer.visibleRect.width,s=this.headingHeight,c=!1;if(s==null){let D=this.layoutNodes.get(e.key);if(D&&D.header){let H=this.collection.getItem(e.key),F=this.lastCollection?this.lastCollection.getItem(e.key):null;s=D.header.rect.height,c=i!==this.lastWidth||H!==F||D.header.estimatedSize}else s=e.rendered?this.estimatedHeadingHeight:0,c=!0}s==null&&(s=tD);let o=new Ur(0,r,i,s),f=new ku("header",e.key+":header",o);f.estimatedSize=c,f.parentKey=e.key,r+=f.rect.height;let m=new Ur(0,r,i,0),x=new ku(e.type,e.key,m),S=r,T=0,C=[];for(let D of pf(e,this.collection)){var R;let H=(R=this.rowHeight)!==null&&R!==void 0?R:this.estimatedRowHeight;if(r+H<this.validRect.y&&!this.isValid(e,r)){r+=H,T++;continue}let F=this.buildChild(D,n,r);if(r=F.layoutInfo.rect.maxY,C.push(F),r>this.validRect.maxY){r+=([...pf(e,this.collection)].length-(C.length+T))*H;break}}return m.height=r-S,{header:f,layoutInfo:x,children:C,validRect:x.rect.intersection(this.validRect)}}buildItem(e,n,r){let i=this.virtualizer.visibleRect.width,s=this.rowHeight,c=!1;if(s==null){let m=this.layoutNodes.get(e.key);m?(s=m.layoutInfo.rect.height,c=i!==this.lastWidth||e!==m.node||m.layoutInfo.estimatedSize):(s=this.estimatedRowHeight,c=!0)}s==null&&(s=tD),typeof this.indentationForItem=="function"&&(n+=this.indentationForItem(this.collection,e.key)||0);let o=new Ur(n,r,i-n,s),f=new ku(e.type,e.key,o);return f.allowOverflow=!0,f.estimatedSize=c,{layoutInfo:f,validRect:f.rect}}updateItemSize(e,n){let r=this.layoutInfos.get(e);if(!r)return!1;if(r.estimatedSize=!1,r.rect.height!==n.height){let i=r.copy();i.rect.height=n.height,this.layoutInfos.set(e,i),this.updateLayoutNode(e,r,i);let s=this.collection.getItem(r.parentKey);for(;s;)this.updateLayoutNode(s.key,r,i),s=this.collection.getItem(s.parentKey);return!0}return!1}updateLayoutNode(e,n,r){let i=this.layoutNodes.get(e);i&&(i.validRect=new Ur,i.header===n?i.header=r:i.layoutInfo===n&&(i.layoutInfo=r))}getContentSize(){return this.contentSize}getKeyAbove(e){let n=this.collection;for(e=n.getKeyBefore(e);e!=null;){let r=n.getItem(e);if(r.type==="item"&&(this.allowDisabledKeyFocus||!this.disabledKeys.has(r.key)))return e;e=n.getKeyBefore(e)}}getKeyBelow(e){let n=this.collection;for(e=n.getKeyAfter(e);e!=null;){let r=n.getItem(e);if(r.type==="item"&&(this.allowDisabledKeyFocus||!this.disabledKeys.has(r.key)))return e;e=n.getKeyAfter(e)}}getKeyPageAbove(e){let n=this.getLayoutInfo(e);if(n){let r=Math.max(0,n.rect.y+n.rect.height-this.virtualizer.visibleRect.height);for(;n&&n.rect.y>r;){let i=this.getKeyAbove(n.key);n=this.getLayoutInfo(i)}if(n)return n.key}return this.getFirstKey()}getKeyPageBelow(e){let n=this.getLayoutInfo(e??this.getFirstKey());if(n){let r=Math.min(this.virtualizer.contentSize.height,n.rect.y-n.rect.height+this.virtualizer.visibleRect.height);for(;n&&n.rect.y<r;){let i=this.getKeyBelow(n.key);n=this.getLayoutInfo(i)}if(n)return n.key}return this.getLastKey()}getFirstKey(){let e=this.collection,n=e.getFirstKey();for(;n!=null;){let r=e.getItem(n);if(r.type==="item"&&(this.allowDisabledKeyFocus||!this.disabledKeys.has(r.key)))return n;n=e.getKeyAfter(n)}}getLastKey(){let e=this.collection,n=e.getLastKey();for(;n!=null;){let r=e.getItem(n);if(r.type==="item"&&(this.allowDisabledKeyFocus||!this.disabledKeys.has(r.key)))return n;n=e.getKeyBefore(n)}}getKeyForSearch(e,n){if(!this.collator)return null;let r=this.collection,i=n||this.getFirstKey();for(;i!=null;){let s=r.getItem(i),c=s.textValue.slice(0,e.length);if(s.textValue&&this.collator.compare(c,e)===0)return i;i=this.getKeyBelow(i)}return null}getInitialLayoutInfo(e){return e.opacity=0,e.transform="scale3d(0.8, 0.8, 0.8)",e}getFinalLayoutInfo(e){return e.opacity=0,e.transform="scale3d(0.8, 0.8, 0.8)",e}getDropTargetFromPoint(e,n,r){e+=this.virtualizer.visibleRect.x,n+=this.virtualizer.visibleRect.y;let i=this.virtualizer.keyAtPoint(new Vs(e,n));if(i==null||this.collection.size===0)return{type:"root"};let s=this.getLayoutInfo(i),c=s.rect,o={type:"item",key:s.key,dropPosition:"on"};return r(o)?n<=c.y+10&&r({...o,dropPosition:"before"})?o.dropPosition="before":n>=c.maxY-10&&r({...o,dropPosition:"after"})&&(o.dropPosition="after"):n<=c.y+c.height/2&&r({...o,dropPosition:"before"})?o.dropPosition="before":r({...o,dropPosition:"after"})&&(o.dropPosition="after"),o}constructor(e={}){super(),Cr(this,"disabledKeys",new Set),Cr(this,"allowDisabledKeyFocus",!1),this.rowHeight=e.rowHeight,this.estimatedRowHeight=e.estimatedRowHeight,this.headingHeight=e.headingHeight,this.estimatedHeadingHeight=e.estimatedHeadingHeight,this.padding=e.padding||0,this.indentationForItem=e.indentationForItem,this.collator=e.collator,this.loaderHeight=e.loaderHeight,this.placeholderHeight=e.placeholderHeight,this.layoutInfos=new Map,this.layoutNodes=new Map,this.rootNodes=[],this.lastWidth=0,this.lastCollection=null,this.allowDisabledKeyFocus=e.allowDisabledKeyFocus,this.lastValidRect=new Ur,this.validRect=new Ur,this.contentSize=new ad}}function dxe(t){let{value:e=0,minValue:n=0,maxValue:r=100,valueLabel:i,isIndeterminate:s,formatOptions:c={style:"percent"}}=t,o=ps(t,{labelable:!0}),{labelProps:f,fieldProps:m}=i$({...t,labelElementType:"span"});e=ig(e,n,r);let x=(e-n)/(r-n),S=eve(c);if(!s&&!i){let T=c.style==="percent"?x:e;i=S.format(T)}return{progressBarProps:kn(o,{...m,"aria-valuenow":s?void 0:e,"aria-valuemin":n,"aria-valuemax":r,"aria-valuetext":s?void 0:i,role:"progressbar"}),labelProps:f}}function ml(t){return t&&t.__esModule?t.default:t}function rr(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var Xs={};rr(Xs,"spectrum-BarLoader",()=>r3,t=>r3=t);rr(Xs,"spectrum-BarLoader--indeterminate",()=>i3,t=>i3=t);rr(Xs,"spectrum-BarLoader--sideLabel",()=>s3,t=>s3=t);rr(Xs,"spectrum-BarLoader-track",()=>o3,t=>o3=t);rr(Xs,"spectrum-BarLoader-fill",()=>a3,t=>a3=t);rr(Xs,"spectrum-BarLoader-label",()=>l3,t=>l3=t);rr(Xs,"spectrum-BarLoader-percentage",()=>c3,t=>c3=t);rr(Xs,"spectrum-BarLoader--small",()=>u3,t=>u3=t);rr(Xs,"indeterminate-loop-ltr",()=>d3,t=>d3=t);rr(Xs,"indeterminate-loop-rtl",()=>h3,t=>h3=t);rr(Xs,"spectrum-BarLoader--overBackground",()=>f3,t=>f3=t);rr(Xs,"is-positive",()=>p3,t=>p3=t);rr(Xs,"is-warning",()=>m3,t=>m3=t);rr(Xs,"is-critical",()=>g3,t=>g3=t);var r3,i3,s3,o3,a3,l3,c3,u3,d3,h3,f3,p3,m3,g3;r3="spectrum-BarLoader_48541f";i3="spectrum-BarLoader--indeterminate_48541f";s3="spectrum-BarLoader--sideLabel_48541f";o3="spectrum-BarLoader-track_48541f";a3="spectrum-BarLoader-fill_48541f";l3="spectrum-BarLoader-label_48541f";c3="spectrum-BarLoader-percentage_48541f";u3="spectrum-BarLoader--small_48541f";d3="indeterminate-loop-ltr_48541f";h3="indeterminate-loop-rtl_48541f";f3="spectrum-BarLoader--overBackground_48541f";p3="is-positive_48541f";m3="is-warning_48541f";g3="is-critical_48541f";var Ir={};rr(Ir,"spectrum-CircleLoader--indeterminate-fill-submask-2",()=>y3,t=>y3=t);rr(Ir,"spectrum-fill-mask-2",()=>_3,t=>_3=t);rr(Ir,"spectrum-CircleLoader",()=>v3,t=>v3=t);rr(Ir,"spectrum-CircleLoader-track",()=>b3,t=>b3=t);rr(Ir,"spectrum-CircleLoader-fills",()=>x3,t=>x3=t);rr(Ir,"spectrum-CircleLoader-fill",()=>w3,t=>w3=t);rr(Ir,"spectrum-CircleLoader-fillMask1",()=>E3,t=>E3=t);rr(Ir,"spectrum-CircleLoader-fillMask2",()=>T3,t=>T3=t);rr(Ir,"spectrum-CircleLoader-fillSubMask1",()=>S3,t=>S3=t);rr(Ir,"spectrum-CircleLoader-fillSubMask2",()=>A3,t=>A3=t);rr(Ir,"spectrum-CircleLoader--small",()=>P3,t=>P3=t);rr(Ir,"spectrum-CircleLoader--large",()=>C3,t=>C3=t);rr(Ir,"spectrum-CircleLoader--indeterminate",()=>I3,t=>I3=t);rr(Ir,"spectrum-fills-rotate",()=>L3,t=>L3=t);rr(Ir,"spectrum-fill-mask-1",()=>R3,t=>R3=t);rr(Ir,"spectrum-CircleLoader--overBackground",()=>$3,t=>$3=t);var y3,_3,v3,b3,x3,w3,E3,T3,S3,A3,P3,C3,I3,L3,R3,$3;y3="spectrum-CircleLoader--indeterminate-fill-submask-2_7c1153";_3="spectrum-fill-mask-2_7c1153";v3="spectrum-CircleLoader_7c1153";b3="spectrum-CircleLoader-track_7c1153";x3="spectrum-CircleLoader-fills_7c1153";w3="spectrum-CircleLoader-fill_7c1153";E3="spectrum-CircleLoader-fillMask1_7c1153";T3="spectrum-CircleLoader-fillMask2_7c1153";S3="spectrum-CircleLoader-fillSubMask1_7c1153";A3="spectrum-CircleLoader-fillSubMask2_7c1153";P3="spectrum-CircleLoader--small_7c1153";C3="spectrum-CircleLoader--large_7c1153";I3="spectrum-CircleLoader--indeterminate_7c1153";L3="spectrum-fills-rotate_7c1153";R3="spectrum-fill-mask-1_7c1153";$3="spectrum-CircleLoader--overBackground_7c1153";function hxe(t,e){let{value:n=0,minValue:r=0,maxValue:i=100,size:s="M",variant:c,isIndeterminate:o=!1,"aria-label":f,"aria-labelledby":m,...x}=t,S=ma(e),{styleProps:T}=Ni(x);n=ig(n,r,i);let{progressBarProps:C}=dxe({...t,value:n}),R={},D={};if(!o){let H=(n-r)/(i-r)*100,F;H>0&&H<=50?(F=-180+H/50*180,R.transform=`rotate(${F}deg)`,D.transform="rotate(-180deg)"):H>50&&(F=-180+(H-50)/50*180,R.transform="rotate(0deg)",D.transform=`rotate(${F}deg)`)}return!f&&!m&&console.warn("ProgressCircle requires an aria-label or aria-labelledby attribute for accessibility"),ce.createElement("div",{...T,...C,ref:S,className:st(ml(Ir),"spectrum-CircleLoader",{"spectrum-CircleLoader--indeterminate":o,"spectrum-CircleLoader--small":s==="S","spectrum-CircleLoader--large":s==="L","spectrum-CircleLoader--overBackground":c==="overBackground"},T.className)},ce.createElement("div",{className:st(ml(Ir),"spectrum-CircleLoader-track")}),ce.createElement("div",{className:st(ml(Ir),"spectrum-CircleLoader-fills")},ce.createElement("div",{className:st(ml(Ir),"spectrum-CircleLoader-fillMask1")},ce.createElement("div",{className:st(ml(Ir),"spectrum-CircleLoader-fillSubMask1"),"data-testid":"fillSubMask1",style:R},ce.createElement("div",{className:st(ml(Ir),"spectrum-CircleLoader-fill")}))),ce.createElement("div",{className:st(ml(Ir),"spectrum-CircleLoader-fillMask2")},ce.createElement("div",{className:st(ml(Ir),"spectrum-CircleLoader-fillSubMask2"),"data-testid":"fillSubMask2",style:D},ce.createElement("div",{className:st(ml(Ir),"spectrum-CircleLoader-fill")})))))}let s$=ce.forwardRef(hxe),lh=null;function fxe(t=!1){if(lh===null||t){const e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";const r=document.createElement("div"),i=r.style;return i.width="100px",i.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?lh="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?lh="negative":lh="positive-ascending"),document.body.removeChild(e),lh}return lh}function pxe(t,e){let{scrollLeft:n}=t;if(e==="rtl"){let{scrollWidth:r,clientWidth:i}=t;switch(fxe()){case"negative":n=-n;break;case"positive-descending":n=r-i-n;break}}return n}function mxe(t,e){let{contentSize:n,onVisibleRectChange:r,children:i,innerStyle:s,sizeToFit:c,onScrollStart:o,onScrollEnd:f,scrollDirection:m="both",...x}=t,S=ee.useRef();e=e||S;let T=ee.useRef({scrollTop:0,scrollLeft:0,scrollEndTime:0,scrollTimeout:null,width:0,height:0,isScrolling:!1}).current,{direction:C}=pa(),[R,D]=ee.useState(!1),H=ee.useCallback(N=>{N.target===N.currentTarget&&(t.onScroll&&t.onScroll(N),Gu.flushSync(()=>{let U=N.currentTarget.scrollTop,ie=pxe(N.currentTarget,C);T.scrollTop=Math.max(0,Math.min(U,n.height-T.height)),T.scrollLeft=Math.max(0,Math.min(ie,n.width-T.width)),r(new Ur(T.scrollLeft,T.scrollTop,T.width,T.height)),T.isScrolling||(T.isScrolling=!0,D(!0),o&&o());let he=Date.now();T.scrollEndTime<=he+50&&(T.scrollEndTime=he+300,clearTimeout(T.scrollTimeout),T.scrollTimeout=setTimeout(()=>{T.isScrolling=!1,D(!1),T.scrollTimeout=null,f&&f()},300))}))},[t,C,T,n,r,o,f]);ee.useEffect(()=>()=>{clearTimeout(T.scrollTimeout)},[]);let F=ee.useCallback(()=>{let N=e.current;if(!N)return;let U=N.clientWidth,ie=N.clientHeight;c&&n.width>0&&n.height>0&&(c==="width"?U=Math.min(U,n.width):c==="height"&&(ie=Math.min(ie,n.height))),(T.width!==U||T.height!==ie)&&(T.width=U,T.height=ie,r(new Ur(T.scrollLeft,T.scrollTop,U,ie)))},[r,e,T,c,n]);wr(()=>{F()},[F]),BR({ref:e,onResize:F});let k={padding:0,...x.style};return m==="horizontal"?(k.overflowX="auto",k.overflowY="hidden"):m==="vertical"?(k.overflowY="auto",k.overflowX="hidden"):k.overflow="auto",ce.createElement("div",{...x,style:k,ref:e,onScroll:H},ce.createElement("div",{role:"presentation",style:{width:n.width,height:n.height,pointerEvents:R?"none":"auto",position:"relative",...s}},i))}const gxe=ce.forwardRef(mxe);function bV(t){let{reusableView:{layoutInfo:e,virtualizer:n},ref:r}=t,i=ee.useCallback(()=>{let s=yxe(r.current);n.updateItemSize(e.key,s)},[n,e.key,r]);return wr(()=>{e.estimatedSize&&i()}),{updateSize:i}}function yxe(t){let e=t.style.height;t.style.height="";let n=new ad(t.scrollWidth,t.scrollHeight);return t.style.height=e,n}function xV(t){let{className:e,reusableView:n,parent:r}=t,{direction:i}=pa(),s=ee.useRef();return bV({reusableView:n,ref:s}),ce.createElement("div",{role:"presentation",ref:s,className:e,style:M3(n.layoutInfo,i,r&&r.layoutInfo)},n.rendered)}let nD=new WeakMap;function M3(t,e,n){let r=e==="rtl"?"right":"left",i=nD.get(t);if(i&&i[r]!=null){if(!n)return i;let c=t.rect.y-n.rect.y,o=t.rect.x-n.rect.x;if(i.top===c&&i[r]===o)return i}let s={position:t.isSticky?"sticky":"absolute",display:t.isSticky?"inline-block":void 0,overflow:t.allowOverflow?"visible":"hidden",top:t.rect.y-(n?n.rect.y:0),[r]:t.rect.x-(n?n.rect.x:0),transition:"all",WebkitTransition:"all",WebkitTransitionDuration:"inherit",transitionDuration:"inherit",width:t.rect.width,height:t.rect.height,opacity:t.opacity,zIndex:t.zIndex,transform:t.transform,contain:"size layout style"};return nD.set(t,s),s}function _xe(t,e){let{children:n,renderWrapper:r,layout:i,collection:s,sizeToFit:c,scrollDirection:o,transitionDuration:f,isLoading:m,onLoadMore:x,focusedKey:S,shouldUseVirtualFocus:T,scrollToItem:C,...R}=t,D=ee.useRef();e=e||D;let H=cxe({transitionDuration:f,layout:i,collection:s,renderView:n,renderWrapper:r||xxe,onVisibleRectChange(N){e.current.scrollLeft=N.x,e.current.scrollTop=N.y}}),{virtualizerProps:F}=vxe(t,H,e),k=ee.useCallback(N=>{if(H.setVisibleRect(N),!m&&x){let U=H.virtualizer.contentSize.height-N.height*2;N.y>U&&x()}},[m,x,H]);return wr(()=>{!m&&x&&!H.isAnimating&&H.contentSize.height>0&&H.contentSize.height<=H.virtualizer.visibleRect.height&&x()},[H.contentSize,H.isAnimating,H.virtualizer,x,m]),ce.createElement(gxe,{...kn(R,F),ref:e,innerStyle:H.isAnimating?{transition:`none ${H.virtualizer.transitionDuration}ms`}:void 0,contentSize:H.contentSize,onVisibleRectChange:k,onScrollStart:H.startScrolling,onScrollEnd:H.endScrolling,sizeToFit:c,scrollDirection:o},H.visibleViews)}function vxe(t,e,n){let{focusedKey:r,scrollToItem:i,shouldUseVirtualFocus:s}=t,{virtualizer:c}=e,o=ee.useRef(null),f=ee.useRef(!1);ee.useEffect(()=>{if(c.visibleRect.height===0)return;let C=bv();r!==o.current&&(C!=="pointer"||!f.current)&&(i?i(r):(c.scrollToItem(r,{duration:0}),C==="keyboard"&&n.current.contains(document.activeElement)&&w9(document.activeElement,{containingElement:n.current}))),o.current=r},[r,c.visibleRect.height,c,o,i,n]),c.persistedKeys=ee.useMemo(()=>r?new Set([r]):new Set,[r]);let m=ee.useCallback(C=>{let R=bv();!f.current&&n.current.contains(C.target)&&R!=="pointer"&&(i?i(r):c.scrollToItem(r,{duration:0})),f.current=C.target!==n.current},[n,c,r,i]),x=ee.useCallback(C=>{f.current=n.current.contains(C.relatedTarget)},[n]),S=c.getView(r);ee.useEffect(()=>{r&&!S&&f.current&&document.activeElement!==n.current&&wl(n.current)});let T;return s||(T=S?-1:0,c.collection.size===0&&t.tabIndex!=null&&(T=t.tabIndex)),{virtualizerProps:{tabIndex:T,onFocus:m,onBlur:x}}}const bxe=ce.forwardRef(_xe);function xxe(t,e){return ce.createElement(xV,{key:e.key,reusableView:e,parent:t})}function fo(t){return t&&t.__esModule?t.default:t}function zr(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var wV={},EV={};EV={loading:"جارٍ التحميل...",loadingMore:"جارٍ تحميل المزيد..."};var TV={};TV={loading:"Зареждане...",loadingMore:"Зареждане на още..."};var SV={};SV={loading:"Načítání...",loadingMore:"Načítání dalších..."};var AV={};AV={loading:"Indlæser ...",loadingMore:"Indlæser flere ..."};var PV={};PV={loading:"Laden...",loadingMore:"Mehr laden ..."};var CV={};CV={loading:"Φόρτωση...",loadingMore:"Φόρτωση περισσότερων..."};var IV={};IV={loading:"Loading…",loadingMore:"Loading more…"};var LV={};LV={loading:"Cargando…",loadingMore:"Cargando más…"};var RV={};RV={loading:"Laadimine...",loadingMore:"Laadi rohkem..."};var $V={};$V={loading:"Ladataan…",loadingMore:"Ladataan lisää…"};var MV={};MV={loading:"Chargement...",loadingMore:"Chargement supplémentaire..."};var kV={};kV={loading:"טוען...",loadingMore:"טוען עוד..."};var OV={};OV={loading:"Učitavam...",loadingMore:"Učitavam još..."};var DV={};DV={loading:"Betöltés folyamatban…",loadingMore:"Továbbiak betöltése folyamatban…"};var FV={};FV={loading:"Caricamento...",loadingMore:"Caricamento altri..."};var zV={};zV={loading:"読み込み中...",loadingMore:"さらに読み込み中..."};var NV={};NV={loading:"로드 중",loadingMore:"추가 로드 중"};var BV={};BV={loading:"Įkeliama...",loadingMore:"Įkeliama daugiau..."};var UV={};UV={loading:"Notiek ielāde...",loadingMore:"Tiek ielādēts vēl..."};var VV={};VV={loading:"Laster inn ...",loadingMore:"Laster inn flere ..."};var GV={};GV={loading:"Laden...",loadingMore:"Meer laden..."};var jV={};jV={loading:"Ładowanie...",loadingMore:"Wczytywanie większej liczby..."};var HV={};HV={loading:"Carregando...",loadingMore:"Carregando mais..."};var WV={};WV={loading:"A carregar...",loadingMore:"A carregar mais..."};var KV={};KV={loading:"Se încarcă...",loadingMore:"Se încarcă mai multe..."};var qV={};qV={loading:"Загрузка...",loadingMore:"Дополнительная загрузка..."};var XV={};XV={loading:"Načítava sa...",loadingMore:"Načítava sa viac..."};var ZV={};ZV={loading:"Nalaganje...",loadingMore:"Nalaganje več vsebine..."};var YV={};YV={loading:"Učitavam...",loadingMore:"Učitavam još..."};var JV={};JV={loading:"Läser in...",loadingMore:"Läser in mer..."};var QV={};QV={loading:"Yükleniyor...",loadingMore:"Daha fazla yükleniyor..."};var eG={};eG={loading:"Завантаження…",loadingMore:"Завантаження інших об’єктів..."};var tG={};tG={loading:"正在加载...",loadingMore:"正在加载更多..."};var nG={};nG={loading:"正在載入",loadingMore:"正在載入更多…"};wV={"ar-AE":EV,"bg-BG":TV,"cs-CZ":SV,"da-DK":AV,"de-DE":PV,"el-GR":CV,"en-US":IV,"es-ES":LV,"et-EE":RV,"fi-FI":$V,"fr-FR":MV,"he-IL":kV,"hr-HR":OV,"hu-HU":DV,"it-IT":FV,"ja-JP":zV,"ko-KR":NV,"lt-LT":BV,"lv-LV":UV,"nb-NO":VV,"nl-NL":GV,"pl-PL":jV,"pt-BR":HV,"pt-PT":WV,"ro-RO":KV,"ru-RU":qV,"sk-SK":XV,"sl-SI":ZV,"sr-SP":YV,"sv-SE":JV,"tr-TR":QV,"uk-UA":eG,"zh-CN":tG,"zh-TW":nG};const o$=ce.createContext(null);var $n={};zr($n,"spectrum-Menu-popover",()=>k3,t=>k3=t);zr($n,"spectrum-Menu",()=>O3,t=>O3=t);zr($n,"spectrum-Menu-sectionHeading",()=>D3,t=>D3=t);zr($n,"spectrum-Menu-checkmark",()=>F3,t=>F3=t);zr($n,"spectrum-Menu-item",()=>z3,t=>z3=t);zr($n,"is-selected",()=>N3,t=>N3=t);zr($n,"spectrum-Icon",()=>B3,t=>B3=t);zr($n,"spectrum-Menu-itemLabel",()=>U3,t=>U3=t);zr($n,"spectrum-Menu-itemIcon",()=>V3,t=>V3=t);zr($n,"spectrum-Menu-itemLabel--wrapping",()=>G3,t=>G3=t);zr($n,"spectrum-Menu-divider",()=>j3,t=>j3=t);zr($n,"spectrum-Menu-itemGrid",()=>H3,t=>H3=t);zr($n,"is-selectable",()=>W3,t=>W3=t);zr($n,"spectrum-Menu-end",()=>K3,t=>K3=t);zr($n,"spectrum-Menu-icon",()=>q3,t=>q3=t);zr($n,"spectrum-Menu-description",()=>X3,t=>X3=t);zr($n,"spectrum-Menu-keyboard",()=>Z3,t=>Z3=t);zr($n,"focus-ring",()=>Y3,t=>Y3=t);zr($n,"is-focused",()=>J3,t=>J3=t);zr($n,"is-hovered",()=>Q3,t=>Q3=t);zr($n,"is-highlighted",()=>eP,t=>eP=t);zr($n,"is-open",()=>tP,t=>tP=t);zr($n,"is-active",()=>nP,t=>nP=t);zr($n,"is-disabled",()=>rP,t=>rP=t);var k3,O3,D3,F3,z3,N3,B3,U3,V3,G3,j3,H3,W3,K3,q3,X3,Z3,Y3,J3,Q3,eP,tP,nP,rP;k3="spectrum-Menu-popover_7ea47c";O3="spectrum-Menu_7ea47c";D3="spectrum-Menu-sectionHeading_7ea47c";F3="spectrum-Menu-checkmark_7ea47c";z3="spectrum-Menu-item_7ea47c";N3="is-selected_7ea47c";B3="spectrum-Icon_7ea47c";U3="spectrum-Menu-itemLabel_7ea47c";V3="spectrum-Menu-itemIcon_7ea47c";G3="spectrum-Menu-itemLabel--wrapping_7ea47c";j3="spectrum-Menu-divider_7ea47c";H3="spectrum-Menu-itemGrid_7ea47c";W3="is-selectable_7ea47c";K3="spectrum-Menu-end_7ea47c";q3="spectrum-Menu-icon_7ea47c";X3="spectrum-Menu-description_7ea47c";Z3="spectrum-Menu-keyboard_7ea47c";Y3="focus-ring_7ea47c";J3="is-focused_7ea47c";Q3="is-hovered_7ea47c";eP="is-highlighted_7ea47c";tP="is-open_7ea47c";nP="is-active_7ea47c";rP="is-disabled_7ea47c";function wxe(t){let{item:e,shouldSelectOnPressUp:n,shouldFocusOnHover:r,shouldUseVirtualFocus:i}=t,{rendered:s,key:c}=e,o=ps(e.props);delete o.id;let f=ee.useContext(o$),m=ee.useRef(),{optionProps:x,labelProps:S,descriptionProps:T,isSelected:C,isDisabled:R,isFocused:D}=Z1e({"aria-label":e["aria-label"],key:c,shouldSelectOnPressUp:n,shouldFocusOnHover:r,isVirtualized:!0,shouldUseVirtualFocus:i},f,m),{hoverProps:H,isHovered:F}=Xc({...t,isDisabled:R}),k=typeof s=="string"?ce.createElement(YR,null,s):s,N=ag();return ce.createElement(Af,{focusRingClass:st(fo($n),"focus-ring")},ce.createElement("div",{...kn(x,r?{}:H,o),ref:m,className:st(fo($n),"spectrum-Menu-item",{"is-focused":i&&D&&N,"is-disabled":R,"is-selected":C,"is-selectable":f.selectionManager.selectionMode!=="none","is-hovered":F&&!r||D&&!N})},ce.createElement(T1e,{UNSAFE_className:st(fo($n),"spectrum-Menu-itemGrid")},ce.createElement(k9,null,ce.createElement(Sb,{slots:{text:{UNSAFE_className:fo($n)["spectrum-Menu-itemLabel"],...S},icon:{size:"S",UNSAFE_className:fo($n)["spectrum-Menu-icon"]},description:{UNSAFE_className:fo($n)["spectrum-Menu-description"],...T}}},k,C&&ce.createElement(e$,{slot:"checkmark",UNSAFE_className:st(fo($n),"spectrum-Menu-checkmark")}))))))}function Exe(t){let{children:e,reusableView:n,header:r}=t,i=n.content,{headingProps:s,groupProps:c}=Y1e({heading:i.rendered,"aria-label":i["aria-label"]}),{separatorProps:o}=I1e({elementType:"li"}),f=ee.useRef();bV({reusableView:r,ref:f});let{direction:m}=pa(),x=ee.useContext(o$);return ce.createElement(ee.Fragment,null,ce.createElement("div",{role:"presentation",ref:f,style:M3(r.layoutInfo,m)},i.key!==x.collection.getFirstKey()&&ce.createElement("div",{...o,className:st(fo($n),"spectrum-Menu-divider")}),i.rendered&&ce.createElement("div",{...s,className:st(fo($n),"spectrum-Menu-sectionHeading")},i.rendered)),ce.createElement("div",{...c,style:M3(n.layoutInfo,m),className:st(fo($n),"spectrum-Menu")},e))}function a$(t){let{scale:e}=yd(),n=jR({usage:"search",sensitivity:"base"}),r=ee.useMemo(()=>new uxe({estimatedRowHeight:e==="large"?48:32,estimatedHeadingHeight:e==="large"?33:26,padding:e==="large"?5:4,loaderHeight:40,placeholderHeight:e==="large"?48:32,collator:n}),[n,e]);return r.collection=t.collection,r.disabledKeys=t.disabledKeys,r}function Txe(t,e){let{layout:n,state:r,shouldSelectOnPressUp:i,focusOnPointerEnter:s,shouldUseVirtualFocus:c,domProps:o={},transitionDuration:f=0,onScroll:m}=t,{listBoxProps:x}=X1e({...t,keyboardDelegate:n,isVirtualized:!0},r,e),{styleProps:S}=Ni(t),T=Nl(fo(wV));n.isLoading=t.isLoading;let C=(R,D,H,F)=>D.viewType==="section"?ce.createElement(Exe,{key:D.key,reusableView:D,header:H.find(k=>k.viewType==="header")},F(H.filter(k=>k.viewType==="item"))):ce.createElement(xV,{key:D.key,reusableView:D,parent:R});return ce.createElement(o$.Provider,{value:r},ce.createElement(qR,null,ce.createElement(bxe,{...S,...kn(x,o),ref:e,focusedKey:r.selectionManager.focusedKey,sizeToFit:"height",scrollDirection:"vertical",className:st(fo($n),"spectrum-Menu",S.className),layout:n,collection:r.collection,renderWrapper:C,transitionDuration:f,isLoading:t.isLoading,onLoadMore:t.onLoadMore,shouldUseVirtualFocus:c,onScroll:m},(R,D)=>{if(R==="item")return ce.createElement(wxe,{item:D,shouldSelectOnPressUp:i,shouldFocusOnHover:s,shouldUseVirtualFocus:c});if(R==="loader")return ce.createElement("div",{role:"option",style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}},ce.createElement(s$,{isIndeterminate:!0,size:"S","aria-label":r.collection.size>0?T.format("loadingMore"):T.format("loading"),UNSAFE_className:st(fo($n),"spectrum-Dropdown-progressCircle")}));if(R==="placeholder"){let H=t.renderEmptyState?t.renderEmptyState():null;return H==null?null:ce.createElement("div",{role:"option"},H)}})))}const l$=ce.forwardRef(Txe);function Sxe(t,e){let n=IU(t),r=a$(n),i=ma(e);return ce.createElement(l$,{...t,ref:i,state:n,layout:r})}const Axe=ce.forwardRef(Sxe);function Pxe(t,e){let{inputElementType:n="input",isDisabled:r=!1,isRequired:i=!1,isReadOnly:s=!1,validationState:c,type:o="text",onChange:f=()=>{}}=t,{focusableProps:m}=V9(t,e),{labelProps:x,fieldProps:S,descriptionProps:T,errorMessageProps:C}=_V(t),R=ps(t,{labelable:!0});const D={type:o,pattern:t.pattern};return{labelProps:x,inputProps:kn(R,n==="input"&&D,{disabled:r,readOnly:s,"aria-required":i||void 0,"aria-invalid":c==="invalid"||void 0,"aria-errormessage":t["aria-errormessage"],"aria-activedescendant":t["aria-activedescendant"],"aria-autocomplete":t["aria-autocomplete"],"aria-haspopup":t["aria-haspopup"],value:t.value,defaultValue:t.value?void 0:t.defaultValue,onChange:H=>f(H.target.value),autoComplete:t.autoComplete,maxLength:t.maxLength,minLength:t.minLength,name:t.name,placeholder:t.placeholder,inputMode:t.inputMode,onCopy:t.onCopy,onCut:t.onCut,onPaste:t.onPaste,onCompositionEnd:t.onCompositionEnd,onCompositionStart:t.onCompositionStart,onCompositionUpdate:t.onCompositionUpdate,onSelect:t.onSelect,onBeforeInput:t.onBeforeInput,onInput:t.onInput,...m,...S}),descriptionProps:T,errorMessageProps:C}}function Kp(t){return t&&t.__esModule?t.default:t}function Bi(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var jr={};Bi(jr,"spectrum-Textfield-input",()=>iP,t=>iP=t);Bi(jr,"spectrum-Textfield",()=>sP,t=>sP=t);Bi(jr,"focus-ring",()=>oP,t=>oP=t);Bi(jr,"spectrum-Textfield--quiet",()=>aP,t=>aP=t);Bi(jr,"spectrum-Textfield--multiline",()=>lP,t=>lP=t);Bi(jr,"is-placeholder",()=>cP,t=>cP=t);Bi(jr,"is-hovered",()=>uP,t=>uP=t);Bi(jr,"spectrum-Textfield--valid",()=>dP,t=>dP=t);Bi(jr,"spectrum-Textfield--invalid",()=>hP,t=>hP=t);Bi(jr,"spectrum-Textfield--loadable",()=>fP,t=>fP=t);Bi(jr,"spectrum-Textfield-wrapper",()=>pP,t=>pP=t);Bi(jr,"spectrum-Textfield-wrapper--quiet",()=>mP,t=>mP=t);Bi(jr,"spectrum-Textfield-validationIcon",()=>gP,t=>gP=t);Bi(jr,"spectrum-Textfield-icon",()=>yP,t=>yP=t);Bi(jr,"spectrum-Textfield-inputIcon",()=>_P,t=>_P=t);Bi(jr,"spectrum-Textfield-circleLoader",()=>vP,t=>vP=t);Bi(jr,"is-focused",()=>bP,t=>bP=t);Bi(jr,"is-disabled",()=>xP,t=>xP=t);var iP,sP,oP,aP,lP,cP,uP,dP,hP,fP,pP,mP,gP,yP,_P,vP,bP,xP;iP="spectrum-Textfield-input_73bc77";sP="spectrum-Textfield_73bc77";oP="focus-ring_73bc77";aP="spectrum-Textfield--quiet_73bc77";lP="spectrum-Textfield--multiline_73bc77";cP="is-placeholder_73bc77";uP="is-hovered_73bc77";dP="spectrum-Textfield--valid_73bc77";hP="spectrum-Textfield--invalid_73bc77";fP="spectrum-Textfield--loadable_73bc77";pP="spectrum-Textfield-wrapper_73bc77";mP="spectrum-Textfield-wrapper--quiet_73bc77";gP="spectrum-Textfield-validationIcon_73bc77";yP="spectrum-Textfield-icon_73bc77";_P="spectrum-Textfield-inputIcon_73bc77";vP="spectrum-Textfield-circleLoader_73bc77";bP="is-focused_73bc77";xP="is-disabled_73bc77";function Cxe(t,e){let{validationState:n,icon:r,isQuiet:i=!1,isDisabled:s,multiLine:c,autoFocus:o,inputClassName:f,wrapperChildren:m,labelProps:x,inputProps:S,descriptionProps:T,errorMessageProps:C,inputRef:R,isLoading:D,loadingIndicator:H,validationIconClassName:F,disableFocusRing:k}=t,{hoverProps:N,isHovered:U}=Xc({isDisabled:s}),ie=ee.useRef(null),he=ee.useRef(null),le=R||he;ee.useImperativeHandle(e,()=>({...L9(ie,le),select(){le.current&&le.current.select()},getInputElement(){return le.current}}));let ve=c?"textarea":"input",Oe=n==="invalid"&&!s;if(r){let Jt=st(Kp(jr),r.props&&r.props.UNSAFE_className,"spectrum-Textfield-icon");r=ee.cloneElement(r,{UNSAFE_className:Jt,size:"S"})}let Re=Oe?ce.createElement(n$,null):ce.createElement(e$,null),Ee=ee.cloneElement(Re,{UNSAFE_className:st(Kp(jr),"spectrum-Textfield-validationIcon",F)}),{focusProps:$e,isFocusVisible:we}=U9({isTextInput:!0,autoFocus:o}),Be=ce.createElement("div",{className:st(Kp(jr),"spectrum-Textfield",{"spectrum-Textfield--invalid":Oe,"spectrum-Textfield--valid":n==="valid"&&!s,"spectrum-Textfield--loadable":H,"spectrum-Textfield--quiet":i,"spectrum-Textfield--multiline":c,"focus-ring":!k&&we})},ce.createElement(ve,{...kn(S,N,$e),ref:le,rows:c?1:void 0,className:st(Kp(jr),"spectrum-Textfield-input",{"spectrum-Textfield-inputIcon":r,"is-hovered":U},f)}),r,n&&!D&&!s?Ee:null,D&&H,m);return ce.createElement(r$,{...t,labelProps:x,descriptionProps:T,errorMessageProps:C,wrapperClassName:st(Kp(jr),"spectrum-Textfield-wrapper",{"spectrum-Textfield-wrapper--quiet":i}),showErrorIcon:!1,ref:ie},Be)}const rG=ee.forwardRef(Cxe);function Ixe(t){return t&&t.__esModule?t.default:t}var iG={},sG={};sG={buttonLabel:"عرض المقترحات",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} خيار`,other:()=>`${e.number(t.optionCount)} خيارات`})} متاحة.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`المجموعة المدخلة ${t.groupTitle}, مع ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} خيار`,other:()=>`${e.number(t.groupCount)} خيارات`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", محدد",other:""},t.isSelected)}`,listboxLabel:"مقترحات",selectedAnnouncement:t=>`${t.optionText}، محدد`};var oG={};oG={buttonLabel:"Покажи предложения",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} опция`,other:()=>`${e.number(t.optionCount)} опции`})} на разположение.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Въведена група ${t.groupTitle}, с ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} опция`,other:()=>`${e.number(t.groupCount)} опции`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", избрани",other:""},t.isSelected)}`,listboxLabel:"Предложения",selectedAnnouncement:t=>`${t.optionText}, избрани`};var aG={};aG={buttonLabel:"Zobrazit doporučení",countAnnouncement:(t,e)=>`K dispozici ${e.plural(t.optionCount,{one:()=>`je ${e.number(t.optionCount)} možnost`,other:()=>`jsou/je ${e.number(t.optionCount)} možnosti/-í`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Zadaná skupina „${t.groupTitle}“ ${e.plural(t.groupCount,{one:()=>`s ${e.number(t.groupCount)} možností`,other:()=>`se ${e.number(t.groupCount)} možnostmi`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:" (vybráno)",other:""},t.isSelected)}`,listboxLabel:"Návrhy",selectedAnnouncement:t=>`${t.optionText}, vybráno`};var lG={};lG={buttonLabel:"Vis forslag",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} mulighed tilgængelig`,other:()=>`${e.number(t.optionCount)} muligheder tilgængelige`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Angivet gruppe ${t.groupTitle}, med ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} mulighed`,other:()=>`${e.number(t.groupCount)} muligheder`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", valgt",other:""},t.isSelected)}`,listboxLabel:"Forslag",selectedAnnouncement:t=>`${t.optionText}, valgt`};var cG={};cG={buttonLabel:"Empfehlungen anzeigen",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} Option`,other:()=>`${e.number(t.optionCount)} Optionen`})} verfügbar.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Eingetretene Gruppe ${t.groupTitle}, mit ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} Option`,other:()=>`${e.number(t.groupCount)} Optionen`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ausgewählt",other:""},t.isSelected)}`,listboxLabel:"Empfehlungen",selectedAnnouncement:t=>`${t.optionText}, ausgewählt`};var uG={};uG={buttonLabel:"Προβολή προτάσεων",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} επιλογή`,other:()=>`${e.number(t.optionCount)} επιλογές `})} διαθέσιμες.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Εισαγμένη ομάδα ${t.groupTitle}, με ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} επιλογή`,other:()=>`${e.number(t.groupCount)} επιλογές`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", επιλεγμένο",other:""},t.isSelected)}`,listboxLabel:"Προτάσεις",selectedAnnouncement:t=>`${t.optionText}, επιλέχθηκε`};var dG={};dG={focusAnnouncement:(t,e)=>`${e.select({true:()=>`Entered group ${t.groupTitle}, with ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} option`,other:()=>`${e.number(t.groupCount)} options`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", selected",other:""},t.isSelected)}`,countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} option`,other:()=>`${e.number(t.optionCount)} options`})} available.`,selectedAnnouncement:t=>`${t.optionText}, selected`,buttonLabel:"Show suggestions",listboxLabel:"Suggestions"};var hG={};hG={buttonLabel:"Mostrar sugerencias",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opción`,other:()=>`${e.number(t.optionCount)} opciones`})} disponible(s).`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Se ha unido al grupo ${t.groupTitle}, con ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opción`,other:()=>`${e.number(t.groupCount)} opciones`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", seleccionado",other:""},t.isSelected)}`,listboxLabel:"Sugerencias",selectedAnnouncement:t=>`${t.optionText}, seleccionado`};var fG={};fG={buttonLabel:"Kuva soovitused",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} valik`,other:()=>`${e.number(t.optionCount)} valikud`})} saadaval.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Sisestatud rühm ${t.groupTitle}, valikuga ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} valik`,other:()=>`${e.number(t.groupCount)} valikud`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", valitud",other:""},t.isSelected)}`,listboxLabel:"Soovitused",selectedAnnouncement:t=>`${t.optionText}, valitud`};var pG={};pG={buttonLabel:"Näytä ehdotukset",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} vaihtoehto`,other:()=>`${e.number(t.optionCount)} vaihtoehdot`})} saatavilla.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Mentiin ryhmään ${t.groupTitle}, ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} vaihtoehdon`,other:()=>`${e.number(t.groupCount)} vaihtoehdon`})} kanssa.`,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", valittu",other:""},t.isSelected)}`,listboxLabel:"Ehdotukset",selectedAnnouncement:t=>`${t.optionText}, valittu`};var mG={};mG={buttonLabel:"Afficher les suggestions",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} option`,other:()=>`${e.number(t.optionCount)} options`})} disponible(s).`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Groupe ${t.groupTitle} saisi, avec ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} option`,other:()=>`${e.number(t.groupCount)} options`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", sélectionné(s)",other:""},t.isSelected)}`,listboxLabel:"Suggestions",selectedAnnouncement:t=>`${t.optionText}, sélectionné`};var gG={};gG={buttonLabel:"הצג הצעות",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`אפשרות ${e.number(t.optionCount)}`,other:()=>`${e.number(t.optionCount)} אפשרויות`})} במצב זמין.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`נכנס לקבוצה ${t.groupTitle}, עם ${e.plural(t.groupCount,{one:()=>`אפשרות ${e.number(t.groupCount)}`,other:()=>`${e.number(t.groupCount)} אפשרויות`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", נבחר",other:""},t.isSelected)}`,listboxLabel:"הצעות",selectedAnnouncement:t=>`${t.optionText}, נבחר`};var yG={};yG={buttonLabel:"Prikaži prijedloge",countAnnouncement:(t,e)=>`Dostupno još: ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcija`,other:()=>`${e.number(t.optionCount)} opcije/a`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Unesena skupina ${t.groupTitle}, s ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opcijom`,other:()=>`${e.number(t.groupCount)} opcije/a`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", odabranih",other:""},t.isSelected)}`,listboxLabel:"Prijedlozi",selectedAnnouncement:t=>`${t.optionText}, odabrano`};var _G={};_G={buttonLabel:"Javaslatok megjelenítése",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} lehetőség`,other:()=>`${e.number(t.optionCount)} lehetőség`})} áll rendelkezésre.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Belépett a(z) ${t.groupTitle} csoportba, amely ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} lehetőséget`,other:()=>`${e.number(t.groupCount)} lehetőséget`})} tartalmaz. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", kijelölve",other:""},t.isSelected)}`,listboxLabel:"Javaslatok",selectedAnnouncement:t=>`${t.optionText}, kijelölve`};var vG={};vG={buttonLabel:"Mostra suggerimenti",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opzione disponibile`,other:()=>`${e.number(t.optionCount)} opzioni disponibili`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Ingresso nel gruppo ${t.groupTitle}, con ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opzione`,other:()=>`${e.number(t.groupCount)} opzioni`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", selezionato",other:""},t.isSelected)}`,listboxLabel:"Suggerimenti",selectedAnnouncement:t=>`${t.optionText}, selezionato`};var bG={};bG={buttonLabel:"候補を表示",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} 個のオプション`,other:()=>`${e.number(t.optionCount)} 個のオプション`})}を利用できます。`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`入力されたグループ ${t.groupTitle}、${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} 個のオプション`,other:()=>`${e.number(t.groupCount)} 個のオプション`})}を含む。`,other:""},t.isGroupChange)}${t.optionText}${e.select({true:"、選択済み",other:""},t.isSelected)}`,listboxLabel:"候補",selectedAnnouncement:t=>`${t.optionText}、選択済み`};var xG={};xG={buttonLabel:"제안 사항 표시",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)}개 옵션`,other:()=>`${e.number(t.optionCount)}개 옵션`})}을 사용할 수 있습니다.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`입력한 그룹 ${t.groupTitle}, ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)}개 옵션`,other:()=>`${e.number(t.groupCount)}개 옵션`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", 선택됨",other:""},t.isSelected)}`,listboxLabel:"제안",selectedAnnouncement:t=>`${t.optionText}, 선택됨`};var wG={};wG={buttonLabel:"Rodyti pasiūlymus",countAnnouncement:(t,e)=>`Yra ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} parinktis`,other:()=>`${e.number(t.optionCount)} parinktys (-ių)`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Įvesta grupė ${t.groupTitle}, su ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} parinktimi`,other:()=>`${e.number(t.groupCount)} parinktimis (-ių)`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", pasirinkta",other:""},t.isSelected)}`,listboxLabel:"Pasiūlymai",selectedAnnouncement:t=>`${t.optionText}, pasirinkta`};var EG={};EG={buttonLabel:"Rādīt ieteikumus",countAnnouncement:(t,e)=>`Pieejamo opciju skaits: ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcija`,other:()=>`${e.number(t.optionCount)} opcijas`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Ievadīta grupa ${t.groupTitle}, ar ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opciju`,other:()=>`${e.number(t.groupCount)} opcijām`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", atlasīta",other:""},t.isSelected)}`,listboxLabel:"Ieteikumi",selectedAnnouncement:t=>`${t.optionText}, atlasīta`};var TG={};TG={buttonLabel:"Vis forslag",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} alternativ`,other:()=>`${e.number(t.optionCount)} alternativer`})} finnes.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Angitt gruppe ${t.groupTitle}, med ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} alternativ`,other:()=>`${e.number(t.groupCount)} alternativer`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", valgt",other:""},t.isSelected)}`,listboxLabel:"Forslag",selectedAnnouncement:t=>`${t.optionText}, valgt`};var SG={};SG={buttonLabel:"Suggesties weergeven",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} optie`,other:()=>`${e.number(t.optionCount)} opties`})} beschikbaar.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Groep ${t.groupTitle} ingevoerd met ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} optie`,other:()=>`${e.number(t.groupCount)} opties`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", geselecteerd",other:""},t.isSelected)}`,listboxLabel:"Suggesties",selectedAnnouncement:t=>`${t.optionText}, geselecteerd`};var AG={};AG={buttonLabel:"Wyświetlaj sugestie",countAnnouncement:(t,e)=>`dostępna/dostępne(-nych) ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcja`,other:()=>`${e.number(t.optionCount)} opcje(-i)`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Dołączono do grupy ${t.groupTitle}, z ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opcją`,other:()=>`${e.number(t.groupCount)} opcjami`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", wybrano",other:""},t.isSelected)}`,listboxLabel:"Sugestie",selectedAnnouncement:t=>`${t.optionText}, wybrano`};var PG={};PG={buttonLabel:"Mostrar sugestões",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opção`,other:()=>`${e.number(t.optionCount)} opções`})} disponível.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Grupo inserido ${t.groupTitle}, com ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opção`,other:()=>`${e.number(t.groupCount)} opções`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", selecionado",other:""},t.isSelected)}`,listboxLabel:"Sugestões",selectedAnnouncement:t=>`${t.optionText}, selecionado`};var CG={};CG={buttonLabel:"Apresentar sugestões",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opção`,other:()=>`${e.number(t.optionCount)} opções`})} disponível.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Grupo introduzido ${t.groupTitle}, com ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opção`,other:()=>`${e.number(t.groupCount)} opções`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", selecionado",other:""},t.isSelected)}`,listboxLabel:"Sugestões",selectedAnnouncement:t=>`${t.optionText}, selecionado`};var IG={};IG={buttonLabel:"Afișare sugestii",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opțiune`,other:()=>`${e.number(t.optionCount)} opțiuni`})} disponibile.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Grup ${t.groupTitle} introdus, cu ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opțiune`,other:()=>`${e.number(t.groupCount)} opțiuni`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", selectat",other:""},t.isSelected)}`,listboxLabel:"Sugestii",selectedAnnouncement:t=>`${t.optionText}, selectat`};var LG={};LG={buttonLabel:"Показать предложения",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} параметр`,other:()=>`${e.number(t.optionCount)} параметров`})} доступно.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Введенная группа ${t.groupTitle}, с ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} параметром`,other:()=>`${e.number(t.groupCount)} параметрами`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", выбранными",other:""},t.isSelected)}`,listboxLabel:"Предложения",selectedAnnouncement:t=>`${t.optionText}, выбрано`};var RG={};RG={buttonLabel:"Zobraziť návrhy",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} možnosť`,other:()=>`${e.number(t.optionCount)} možnosti/-í`})} k dispozícii.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Zadaná skupina ${t.groupTitle}, s ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} možnosťou`,other:()=>`${e.number(t.groupCount)} možnosťami`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", vybraté",other:""},t.isSelected)}`,listboxLabel:"Návrhy",selectedAnnouncement:t=>`${t.optionText}, vybraté`};var $G={};$G={buttonLabel:"Prikaži predloge",countAnnouncement:(t,e)=>`Na voljo je ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcija`,other:()=>`${e.number(t.optionCount)} opcije`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Vnesena skupina ${t.groupTitle}, z ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opcija`,other:()=>`${e.number(t.groupCount)} opcije`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", izbrano",other:""},t.isSelected)}`,listboxLabel:"Predlogi",selectedAnnouncement:t=>`${t.optionText}, izbrano`};var MG={};MG={buttonLabel:"Prikaži predloge",countAnnouncement:(t,e)=>`Dostupno još: ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcija`,other:()=>`${e.number(t.optionCount)} opcije/a`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Unesena grupa ${t.groupTitle}, s ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opcijom`,other:()=>`${e.number(t.groupCount)} optione/a`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", izabranih",other:""},t.isSelected)}`,listboxLabel:"Predlozi",selectedAnnouncement:t=>`${t.optionText}, izabrano`};var kG={};kG={buttonLabel:"Visa förslag",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} alternativ`,other:()=>`${e.number(t.optionCount)} alternativ`})} tillgängliga.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Ingick i gruppen ${t.groupTitle} med ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} alternativ`,other:()=>`${e.number(t.groupCount)} alternativ`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", valda",other:""},t.isSelected)}`,listboxLabel:"Förslag",selectedAnnouncement:t=>`${t.optionText}, valda`};var OG={};OG={buttonLabel:"Önerileri göster",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} seçenek`,other:()=>`${e.number(t.optionCount)} seçenekler`})} kullanılabilir.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Girilen grup ${t.groupTitle}, ile ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} seçenek`,other:()=>`${e.number(t.groupCount)} seçenekler`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", seçildi",other:""},t.isSelected)}`,listboxLabel:"Öneriler",selectedAnnouncement:t=>`${t.optionText}, seçildi`};var DG={};DG={buttonLabel:"Показати пропозиції",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} параметр`,other:()=>`${e.number(t.optionCount)} параметри(-ів)`})} доступно.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Введена група ${t.groupTitle}, з ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} параметр`,other:()=>`${e.number(t.groupCount)} параметри(-ів)`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", вибрано",other:""},t.isSelected)}`,listboxLabel:"Пропозиції",selectedAnnouncement:t=>`${t.optionText}, вибрано`};var FG={};FG={buttonLabel:"显示建议",countAnnouncement:(t,e)=>`有 ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} 个选项`,other:()=>`${e.number(t.optionCount)} 个选项`})}可用。`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`进入了 ${t.groupTitle} 组，其中有 ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} 个选项`,other:()=>`${e.number(t.groupCount)} 个选项`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", 已选择",other:""},t.isSelected)}`,listboxLabel:"建议",selectedAnnouncement:t=>`${t.optionText}, 已选择`};var zG={};zG={buttonLabel:"顯示建議",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} 選項`,other:()=>`${e.number(t.optionCount)} 選項`})} 可用。`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`輸入的群組 ${t.groupTitle}, 有 ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} 選項`,other:()=>`${e.number(t.groupCount)} 選項`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", 已選取",other:""},t.isSelected)}`,listboxLabel:"建議",selectedAnnouncement:t=>`${t.optionText}, 已選取`};iG={"ar-AE":sG,"bg-BG":oG,"cs-CZ":aG,"da-DK":lG,"de-DE":cG,"el-GR":uG,"en-US":dG,"es-ES":hG,"et-EE":fG,"fi-FI":pG,"fr-FR":mG,"he-IL":gG,"hr-HR":yG,"hu-HU":_G,"it-IT":vG,"ja-JP":bG,"ko-KR":xG,"lt-LT":wG,"lv-LV":EG,"nb-NO":TG,"nl-NL":SG,"pl-PL":AG,"pt-BR":PG,"pt-PT":CG,"ro-RO":IG,"ru-RU":LG,"sk-SK":RG,"sl-SI":$G,"sr-SP":MG,"sv-SE":kG,"tr-TR":OG,"uk-UA":DG,"zh-CN":FG,"zh-TW":zG};function NG(t,e){let{buttonRef:n,popoverRef:r,inputRef:i,listBoxRef:s,keyboardDelegate:c,shouldFocusWrap:o,isReadOnly:f,isDisabled:m}=t,x=Nl(Ixe(iG)),{menuTriggerProps:S,menuProps:T}=d1e({type:"listbox",isDisabled:m||f},e,n);Mb.set(e,{id:T.id});let C=ee.useMemo(()=>c||new H7(e.collection,e.disabledKeys,s),[c,e.collection,e.disabledKeys,s]),{collectionProps:R}=j7({selectionManager:e.selectionManager,keyboardDelegate:C,disallowTypeAhead:!0,disallowEmptySelection:!0,shouldFocusWrap:o,ref:i,isVirtualized:!0}),D=Ke=>{switch(Ke.key){case"Enter":case"Tab":e.isOpen&&Ke.key==="Enter"&&Ke.preventDefault(),e.commit();break;case"Escape":(e.selectedKey!==null||e.inputValue===""||t.allowsCustomValue)&&Ke.continuePropagation(),e.revert();break;case"ArrowDown":e.open("first","manual");break;case"ArrowUp":e.open("last","manual");break;case"ArrowLeft":case"ArrowRight":e.selectionManager.setFocusedKey(null);break}},H=Ke=>{var Je;Ke.relatedTarget===(n==null?void 0:n.current)||!((Je=r.current)===null||Je===void 0)&&Je.contains(Ke.relatedTarget)||(t.onBlur&&t.onBlur(Ke),e.setFocused(!1))},F=Ke=>{e.isFocused||(t.onFocus&&t.onFocus(Ke),e.setFocused(!0))},{labelProps:k,inputProps:N,descriptionProps:U,errorMessageProps:ie}=Pxe({...t,onChange:e.setInputValue,onKeyDown:!f&&og(e.isOpen&&R.onKeyDown,D,t.onKeyDown),onBlur:H,value:e.inputValue,onFocus:F,autoComplete:"off"},i),he=Ke=>{Ke.pointerType==="touch"&&(i.current.focus(),e.toggle(null,"manual"))},le=Ke=>{Ke.pointerType!=="touch"&&(i.current.focus(),e.toggle(Ke.pointerType==="keyboard"||Ke.pointerType==="virtual"?"first":null,"manual"))},ve=mv({id:S.id,"aria-label":x.format("buttonLabel"),"aria-labelledby":t["aria-labelledby"]||k.id}),Oe=mv({id:T.id,"aria-label":x.format("listboxLabel"),"aria-labelledby":t["aria-labelledby"]||k.id}),Re=ee.useRef(0),Ee=Ke=>{if(m||f)return;if(Ke.timeStamp-Re.current<500){Ke.preventDefault(),i.current.focus();return}let Je=Ke.target.getBoundingClientRect(),Ot=Ke.changedTouches[0],ht=Math.ceil(Je.left+.5*Je.width),Ct=Math.ceil(Je.top+.5*Je.height);Ot.clientX===ht&&Ot.clientY===Ct&&(Ke.preventDefault(),i.current.focus(),e.toggle(null,"manual"),Re.current=Ke.timeStamp)},$e=e.selectionManager.focusedKey!=null&&e.isOpen?e.collection.getItem(e.selectionManager.focusedKey):void 0;var we;let Be=(we=$e==null?void 0:$e.parentKey)!==null&&we!==void 0?we:null;var Jt;let mt=(Jt=e.selectionManager.focusedKey)!==null&&Jt!==void 0?Jt:null,an=ee.useRef(Be),ot=ee.useRef(mt);ee.useEffect(()=>{if(p0()&&$e!=null&&mt!==ot.current){let Ke=e.selectionManager.isSelected(mt),Je=Be!=null?e.collection.getItem(Be):null,Ot=(Je==null?void 0:Je["aria-label"])||(typeof(Je==null?void 0:Je.rendered)=="string"?Je.rendered:"")||"",ht=x.format("focusAnnouncement",{isGroupChange:Je&&Be!==an.current,groupTitle:Ot,groupCount:Je?[...pf(Je,e.collection)].length:0,optionText:$e["aria-label"]||$e.textValue||"",isSelected:Ke});$w(ht)}an.current=Be,ot.current=mt});let It=y9(e.collection),at=ee.useRef(It),kt=ee.useRef(e.isOpen);ee.useEffect(()=>{let Ke=e.isOpen!==kt.current&&(e.selectionManager.focusedKey==null||p0());if(e.isOpen&&(Ke||It!==at.current)){let Je=x.format("countAnnouncement",{optionCount:It});$w(Je)}at.current=It,kt.current=e.isOpen});let Pe=ee.useRef(e.selectedKey);return ee.useEffect(()=>{if(p0()&&e.isFocused&&e.selectedItem&&e.selectedKey!==Pe.current){let Ke=e.selectedItem["aria-label"]||e.selectedItem.textValue||"",Je=x.format("selectedAnnouncement",{optionText:Ke});$w(Je)}Pe.current=e.selectedKey}),ee.useEffect(()=>{if(e.isOpen)return JR([i.current,r.current])},[e.isOpen,i,r]),{labelProps:k,buttonProps:{...S,...ve,excludeFromTabOrder:!0,onPress:he,onPressStart:le,isDisabled:m||f},inputProps:kn(N,{role:"combobox","aria-expanded":S["aria-expanded"],"aria-controls":e.isOpen?T.id:void 0,"aria-autocomplete":"list","aria-activedescendant":$e?vV(e,$e.key):void 0,onTouchEnd:Ee,autoCorrect:"off",spellCheck:"false"}),listBoxProps:kn(T,Oe,{autoFocus:e.focusStrategy,shouldUseVirtualFocus:!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0}),descriptionProps:U,errorMessageProps:ie}}function BG(t){var e;let{defaultFilter:n,menuTrigger:r="input",allowsEmptyCollection:i=!1,allowsCustomValue:s,shouldCloseOnBlur:c=!0}=t,[o,f]=ee.useState(!1),[m,x]=ee.useState(!1);var S;let[T,C]=xb(t.inputValue,(S=t.defaultInputValue)!==null&&S!==void 0?S:"",t.onInputChange),R=Et=>{t.onSelectionChange&&t.onSelectionChange(Et),Et===k&&(ot(),mt())};var D;let{collection:H,selectionManager:F,selectedKey:k,setSelectedKey:N,selectedItem:U,disabledKeys:ie}=R1e({...t,onSelectionChange:R,items:(D=t.items)!==null&&D!==void 0?D:t.defaultItems}),he=H,le=ee.useMemo(()=>t.items!=null||!n?H:Lxe(H,T,n),[H,T,n,t.items]),[ve,Oe]=ee.useState(le),Re=ee.useRef("focus"),$e=f1e({...t,onOpenChange:Et=>{t.onOpenChange&&t.onOpenChange(Et,Et?Re.current:void 0),F.setFocused(Et),Et||F.setFocusedKey(null)},isOpen:void 0,defaultOpen:void 0}),we=(Et,Dt)=>{let mn=Dt==="manual"||Dt==="focus"&&r==="focus";(i||le.size>0||mn&&he.size>0||t.items)&&(mn&&!$e.isOpen&&t.items===void 0&&f(!0),Re.current=Dt,$e.open(Et))},Be=(Et,Dt)=>{let mn=Dt==="manual"||Dt==="focus"&&r==="focus";!(i||le.size>0||mn&&he.size>0||t.items)&&!$e.isOpen||(mn&&!$e.isOpen&&t.items===void 0&&f(!0),$e.isOpen||(Re.current=Dt),Jt(Et))},Jt=ee.useCallback(Et=>{$e.isOpen&&Oe(le),$e.toggle(Et)},[$e,le]),mt=ee.useCallback(()=>{$e.isOpen&&(Oe(le),$e.close())},[$e,le]),an=ee.useRef(T),ot=()=>{var Et,Dt;let mn=(Dt=(Et=H.getItem(k))===null||Et===void 0?void 0:Et.textValue)!==null&&Dt!==void 0?Dt:"";an.current=mn,C(mn)},It=ee.useRef(!0);var at,kt;let Pe=ee.useRef((kt=(at=t.selectedKey)!==null&&at!==void 0?at:t.defaultSelectedKey)!==null&&kt!==void 0?kt:null);var Ke;let Je=ee.useRef((Ke=(e=H.getItem(k))===null||e===void 0?void 0:e.textValue)!==null&&Ke!==void 0?Ke:"");ee.useEffect(()=>{var Et;m&&(le.size>0||i)&&!$e.isOpen&&T!==an.current&&r!=="manual"&&we(null,"input"),!o&&!i&&$e.isOpen&&le.size===0&&mt(),k!=null&&k!==Pe.current&&mt(),T!==an.current&&(F.setFocusedKey(null),f(!1),T===""&&(t.inputValue===void 0||t.selectedKey===void 0)&&N(null)),It.current&&t.inputValue===void 0&&t.defaultInputValue===void 0&&ot(),k!==Pe.current&&(t.inputValue===void 0||t.selectedKey===void 0)?ot():an.current=T;var Dt;let mn=(Dt=(Et=H.getItem(k))===null||Et===void 0?void 0:Et.textValue)!==null&&Dt!==void 0?Dt:"";!m&&k!=null&&t.inputValue===void 0&&k===Pe.current&&Je.current!==mn&&(an.current=mn,C(mn)),It.current=!1,Pe.current=k,Je.current=mn});let Ot=()=>{s&&k==null?ht():Ct()},ht=()=>{Pe.current=null,N(null),mt()},Ct=()=>{if(t.selectedKey!==void 0&&t.inputValue!==void 0){var Et;t.onSelectionChange(k);var Dt;let mn=(Dt=(Et=H.getItem(k))===null||Et===void 0?void 0:Et.textValue)!==null&&Dt!==void 0?Dt:"";an.current=mn,mt()}else ot(),mt()},Zt=()=>{$e.isOpen&&F.focusedKey!=null?k===F.focusedKey?Ct():N(F.focusedKey):s?ht():Ct()},lt=()=>{var Et,Dt;let mn=(Dt=(Et=H.getItem(k))===null||Et===void 0?void 0:Et.textValue)!==null&&Dt!==void 0?Dt:"";s&&T!==mn?ht():Ct(),mt()},en=Et=>{Et?r==="focus"&&we(null,"focus"):c&&lt(),x(Et)},Nn=ee.useMemo(()=>$e.isOpen?o?he:le:ve,[$e.isOpen,he,le,o,ve]);return{...$e,toggle:Be,open:we,close:lt,selectionManager:F,selectedKey:k,setSelectedKey:N,disabledKeys:ie,isFocused:m,setFocused:en,selectedItem:U,collection:Nn,inputValue:T,setInputValue:C,commit:Zt,revert:Ot}}function Lxe(t,e,n){return new lA(UG(t,t,e,n))}function UG(t,e,n,r){let i=[];for(let s of e)if(s.type==="section"&&s.hasChildNodes){let c=UG(t,pf(s,t),n,r);[...c].some(o=>o.type==="item")&&i.push({...s,childNodes:c})}else s.type==="item"&&r(s.textValue,n)?i.push({...s}):s.type!=="item"&&i.push({...s});return i}function Rxe(t,e){let{role:n="dialog"}=t,r=sg();r=t["aria-label"]?void 0:r;let i=ee.useRef(!1);return ee.useEffect(()=>{if(e.current&&!e.current.contains(document.activeElement)){od(e.current);let s=setTimeout(()=>{document.activeElement===e.current&&(i.current=!0,e.current.blur(),od(e.current),i.current=!1)},500);return()=>{clearTimeout(s)}}},[e]),I7(),{dialogProps:{...ps(t,{labelable:!0}),role:n,tabIndex:-1,"aria-labelledby":t["aria-labelledby"]||r,onBlur:s=>{i.current&&s.stopPropagation()}},titleProps:{id:r}}}function _n(t){return t&&t.__esModule?t.default:t}function tt(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var Fi={};tt(Fi,"no-results",()=>wP,t=>wP=t);tt(Fi,"mobile-combobox",()=>EP,t=>EP=t);tt(Fi,"mobile-input",()=>TP,t=>TP=t);tt(Fi,"mobile-value",()=>SP,t=>SP=t);tt(Fi,"tray-dialog",()=>AP,t=>AP=t);tt(Fi,"tray-textfield",()=>PP,t=>PP=t);tt(Fi,"has-label",()=>CP,t=>CP=t);tt(Fi,"tray-textfield-input",()=>IP,t=>IP=t);tt(Fi,"tray-listbox",()=>LP,t=>LP=t);var wP,EP,TP,SP,AP,PP,CP,IP,LP;wP="no-results_743018";EP="mobile-combobox_743018";TP="mobile-input_743018";SP="mobile-value_743018";AP="tray-dialog_743018";PP="tray-textfield_743018";CP="has-label_743018";IP="tray-textfield-input_743018";LP="tray-listbox_743018";var zg={},VG={};VG={clear:"مسح",invalid:"(غير صالح)",loading:"جارٍ التحميل...",noResults:"لا توجد نتائج"};var GG={};GG={clear:"Изчисти",invalid:"(невалиден)",loading:"Зареждане...",noResults:"Няма резултати"};var jG={};jG={clear:"Vymazat",invalid:"(neplatné)",loading:"Načítání...",noResults:"Žádné výsledky"};var HG={};HG={clear:"Ryd",invalid:"(ugyldig)",loading:"Indlæser ...",noResults:"Ingen resultater"};var WG={};WG={clear:"Löschen",invalid:"(ungültig)",loading:"Wird geladen...",noResults:"Keine Ergebnisse"};var KG={};KG={clear:"Καθαρισμός",invalid:"(δεν ισχύει)",loading:"Φόρτωση...",noResults:"Χωρίς αποτέλεσμα"};var qG={};qG={loading:"Loading...",noResults:"No results",clear:"Clear",invalid:"(invalid)"};var XG={};XG={clear:"Borrar",invalid:"(no válido)",loading:"Cargando...",noResults:"Sin resultados"};var ZG={};ZG={clear:"Puhasta",invalid:"(kehtetu)",loading:"Laadimine...",noResults:"Tulemusi pole"};var YG={};YG={clear:"Kirkas",invalid:"(epäkelpo)",loading:"Ladataan...",noResults:"Ei tuloksia"};var JG={};JG={clear:"Effacer",invalid:"(non valide)",loading:"Chargement en cours...",noResults:"Aucun résultat"};var QG={};QG={clear:"נקי",invalid:"(לא חוקי)",loading:"טוען...",noResults:"אין תוצאות"};var ej={};ej={clear:"Izbriši",invalid:"(nevažeće)",loading:"Učitavam...",noResults:"Nema rezultata"};var tj={};tj={clear:"Törlés",invalid:"(érvénytelen)",loading:"Betöltés folyamatban…",noResults:"Nincsenek találatok"};var nj={};nj={clear:"Cancella",invalid:"(non valido)",loading:"Caricamento in corso...",noResults:"Nessun risultato"};var rj={};rj={clear:"クリア",invalid:"(無効)",loading:"読み込み中...",noResults:"結果なし"};var ij={};ij={clear:"지우기",invalid:"(유효하지 않음)",loading:"로드 중...",noResults:"결과 없음"};var sj={};sj={clear:"Skaidrus",invalid:"(netinkama)",loading:"Įkeliama...",noResults:"Be rezultatų"};var oj={};oj={clear:"Notīrīt",invalid:"(nederīgs)",loading:"Notiek ielāde...",noResults:"Nav rezultātu"};var aj={};aj={clear:"Tøm",invalid:"(ugyldig)",loading:"Laster inn ...",noResults:"Ingen resultater"};var lj={};lj={clear:"Helder",invalid:"(ongeldig)",loading:"Laden...",noResults:"Geen resultaten"};var cj={};cj={clear:"Wyczyść",invalid:"(nieprawidłowy)",loading:"Trwa ładowanie...",noResults:"Brak wyników"};var uj={};uj={clear:"Limpar",invalid:"(inválido)",loading:"Carregando...",noResults:"Nenhum resultado"};var dj={};dj={clear:"Limpar",invalid:"(inválido)",loading:"A carregar...",noResults:"Sem resultados"};var hj={};hj={clear:"Golire",invalid:"(nevalid)",loading:"Se încarcă...",noResults:"Niciun rezultat"};var fj={};fj={clear:"Очистить",invalid:"(недействительно)",loading:"Загрузка...",noResults:"Результаты отсутствуют"};var pj={};pj={clear:"Vymazať",invalid:"(neplatné)",loading:"Načítava sa...",noResults:"Žiadne výsledky"};var mj={};mj={clear:"Jasen",invalid:"(neveljavno)",loading:"Nalaganje...",noResults:"Ni rezultatov"};var gj={};gj={clear:"Izbriši",invalid:"(nevažeće)",loading:"Učitavam...",noResults:"Nema rezultata"};var yj={};yj={clear:"Rensa",invalid:"(ogiltigt)",loading:"Läser in...",noResults:"Inga resultat"};var _j={};_j={clear:"Temizle",invalid:"(geçersiz)",loading:"Yükleniyor...",noResults:"Sonuç yok"};var vj={};vj={clear:"Очистити",invalid:"(недійсне)",loading:"Завантаження...",noResults:"Результатів немає"};var bj={};bj={clear:"透明",invalid:"（无效）",loading:"正在加载...",noResults:"无结果"};var xj={};xj={clear:"清除",invalid:"(無效)",loading:"正在載入...",noResults:"無任何結果"};zg={"ar-AE":VG,"bg-BG":GG,"cs-CZ":jG,"da-DK":HG,"de-DE":WG,"el-GR":KG,"en-US":qG,"es-ES":XG,"et-EE":ZG,"fi-FI":YG,"fr-FR":JG,"he-IL":QG,"hr-HR":ej,"hu-HU":tj,"it-IT":nj,"ja-JP":rj,"ko-KR":ij,"lt-LT":sj,"lv-LV":oj,"nb-NO":aj,"nl-NL":lj,"pl-PL":cj,"pt-BR":uj,"pt-PT":dj,"ro-RO":hj,"ru-RU":fj,"sk-SK":pj,"sl-SI":mj,"sr-SP":gj,"sv-SE":yj,"tr-TR":_j,"uk-UA":vj,"zh-CN":bj,"zh-TW":xj};var Jn={};tt(Jn,"spectrum-Button",()=>RP,t=>RP=t);tt(Jn,"spectrum-ActionButton",()=>$P,t=>$P=t);tt(Jn,"spectrum-LogicButton",()=>MP,t=>MP=t);tt(Jn,"spectrum-FieldButton",()=>kP,t=>kP=t);tt(Jn,"spectrum-ClearButton",()=>OP,t=>OP=t);tt(Jn,"focus-ring",()=>DP,t=>DP=t);tt(Jn,"spectrum-FieldButton--quiet",()=>FP,t=>FP=t);tt(Jn,"spectrum-Icon",()=>zP,t=>zP=t);tt(Jn,"is-hovered",()=>NP,t=>NP=t);tt(Jn,"spectrum-Button-label",()=>BP,t=>BP=t);tt(Jn,"spectrum-Button--iconOnly",()=>UP,t=>UP=t);tt(Jn,"spectrum-ActionButton-label",()=>VP,t=>VP=t);tt(Jn,"spectrum-ActionButton-hold",()=>GP,t=>GP=t);tt(Jn,"spectrum-ActionButton--quiet",()=>jP,t=>jP=t);tt(Jn,"is-disabled",()=>HP,t=>HP=t);tt(Jn,"is-open",()=>WP,t=>WP=t);tt(Jn,"spectrum-ClearButton--small",()=>KP,t=>KP=t);tt(Jn,"is-active",()=>qP,t=>qP=t);tt(Jn,"spectrum-ClearButton--overBackground",()=>XP,t=>XP=t);tt(Jn,"is-selected",()=>ZP,t=>ZP=t);tt(Jn,"spectrum-ActionButton--emphasized",()=>YP,t=>YP=t);tt(Jn,"spectrum-ActionButton--staticWhite",()=>JP,t=>JP=t);tt(Jn,"spectrum-ActionButton--staticBlack",()=>QP,t=>QP=t);tt(Jn,"spectrum-ActionButton--staticColor",()=>eC,t=>eC=t);tt(Jn,"spectrum-LogicButton--and",()=>tC,t=>tC=t);tt(Jn,"spectrum-LogicButton--or",()=>nC,t=>nC=t);tt(Jn,"is-focused",()=>rC,t=>rC=t);tt(Jn,"is-placeholder",()=>iC,t=>iC=t);tt(Jn,"spectrum-FieldButton--invalid",()=>sC,t=>sC=t);tt(Jn,"spectrum-Button--overBackground",()=>oC,t=>oC=t);var RP,$P,MP,kP,OP,DP,FP,zP,NP,BP,UP,VP,GP,jP,HP,WP,KP,qP,XP,ZP,YP,JP,QP,eC,tC,nC,rC,iC,sC,oC;RP="spectrum-Button_e2d99e";$P="spectrum-ActionButton_e2d99e";MP="spectrum-LogicButton_e2d99e";kP="spectrum-FieldButton_e2d99e";OP="spectrum-ClearButton_e2d99e";DP="focus-ring_e2d99e";FP="spectrum-FieldButton--quiet_e2d99e";zP="spectrum-Icon_e2d99e";NP="is-hovered_e2d99e";BP="spectrum-Button-label_e2d99e";UP="spectrum-Button--iconOnly_e2d99e";VP="spectrum-ActionButton-label_e2d99e";GP="spectrum-ActionButton-hold_e2d99e";jP="spectrum-ActionButton--quiet_e2d99e";HP="is-disabled_e2d99e";WP="is-open_e2d99e";KP="spectrum-ClearButton--small_e2d99e";qP="is-active_e2d99e";XP="spectrum-ClearButton--overBackground_e2d99e";ZP="is-selected_e2d99e";YP="spectrum-ActionButton--emphasized_e2d99e";JP="spectrum-ActionButton--staticWhite_e2d99e";QP="spectrum-ActionButton--staticBlack_e2d99e";eC="spectrum-ActionButton--staticColor_e2d99e";tC="spectrum-LogicButton--and_e2d99e";nC="spectrum-LogicButton--or_e2d99e";rC="is-focused_e2d99e";iC="is-placeholder_e2d99e";sC="spectrum-FieldButton--invalid_e2d99e";oC="spectrum-Button--overBackground_e2d99e";var ui={};tt(ui,"spectrum-FieldLabel",()=>aC,t=>aC=t);tt(ui,"spectrum-FieldLabel--positionSide",()=>lC,t=>lC=t);tt(ui,"spectrum-FieldLabel-requiredIcon",()=>cC,t=>cC=t);tt(ui,"spectrum-FieldLabel--alignEnd",()=>uC,t=>uC=t);tt(ui,"spectrum-Field",()=>dC,t=>dC=t);tt(ui,"spectrum-Field-contextualHelp",()=>hC,t=>hC=t);tt(ui,"spectrum-Field--positionTop",()=>fC,t=>fC=t);tt(ui,"spectrum-Field-field",()=>pC,t=>pC=t);tt(ui,"spectrum-Field--alignEnd",()=>mC,t=>mC=t);tt(ui,"spectrum-Field--positionSide",()=>gC,t=>gC=t);tt(ui,"spectrum-Field-wrapper",()=>yC,t=>yC=t);tt(ui,"spectrum-Field--hasContextualHelp",()=>_C,t=>_C=t);tt(ui,"spectrum-Form",()=>vC,t=>vC=t);tt(ui,"spectrum-Form--positionSide",()=>bC,t=>bC=t);tt(ui,"spectrum-Field-labelCell",()=>xC,t=>xC=t);tt(ui,"spectrum-Field-labelWrapper",()=>wC,t=>wC=t);tt(ui,"spectrum-Form--positionTop",()=>EC,t=>EC=t);tt(ui,"spectrum-LabeledValue",()=>TC,t=>TC=t);tt(ui,"spectrum-Form-itemLabel",()=>SC,t=>SC=t);tt(ui,"is-disabled",()=>AC,t=>AC=t);var aC,lC,cC,uC,dC,hC,fC,pC,mC,gC,yC,_C,vC,bC,xC,wC,EC,TC,SC,AC;aC="spectrum-FieldLabel_d2db1f";lC="spectrum-FieldLabel--positionSide_d2db1f";cC="spectrum-FieldLabel-requiredIcon_d2db1f";uC="spectrum-FieldLabel--alignEnd_d2db1f";dC="spectrum-Field_d2db1f";hC="spectrum-Field-contextualHelp_d2db1f";fC="spectrum-Field--positionTop_d2db1f";pC="spectrum-Field-field_d2db1f";mC="spectrum-Field--alignEnd_d2db1f";gC="spectrum-Field--positionSide_d2db1f";yC="spectrum-Field-wrapper_d2db1f";_C="spectrum-Field--hasContextualHelp_d2db1f";vC="spectrum-Form_d2db1f";bC="spectrum-Form--positionSide_d2db1f";xC="spectrum-Field-labelCell_d2db1f";wC="spectrum-Field-labelWrapper_d2db1f";EC="spectrum-Form--positionTop_d2db1f";TC="spectrum-LabeledValue_d2db1f";SC="spectrum-Form-itemLabel_d2db1f";AC="is-disabled_d2db1f";var Cs={};tt(Cs,"spectrum-Search",()=>PC,t=>PC=t);tt(Cs,"spectrum-ClearButton",()=>CC,t=>CC=t);tt(Cs,"is-quiet",()=>IC,t=>IC=t);tt(Cs,"spectrum-Search-input",()=>LC,t=>LC=t);tt(Cs,"spectrum-Search--invalid",()=>RC,t=>RC=t);tt(Cs,"spectrum-Search--valid",()=>$C,t=>$C=t);tt(Cs,"spectrum-Search--loadable",()=>MC,t=>MC=t);tt(Cs,"spectrum-Search-circleLoader",()=>kC,t=>kC=t);tt(Cs,"spectrum-Search-validationIcon",()=>OC,t=>OC=t);tt(Cs,"spectrum-Textfield",()=>DC,t=>DC=t);var PC,CC,IC,LC,RC,$C,MC,kC,OC,DC;PC="spectrum-Search_d3c0f3";CC="spectrum-ClearButton_d3c0f3";IC="is-quiet_d3c0f3";LC="spectrum-Search-input_d3c0f3";RC="spectrum-Search--invalid_d3c0f3";$C="spectrum-Search--valid_d3c0f3";MC="spectrum-Search--loadable_d3c0f3";kC="spectrum-Search-circleLoader_d3c0f3";OC="spectrum-Search-validationIcon_d3c0f3";DC="spectrum-Textfield_d3c0f3";var Sn={};tt(Sn,"spectrum-InputGroup",()=>FC,t=>FC=t);tt(Sn,"focus-ring",()=>zC,t=>zC=t);tt(Sn,"spectrum-InputGroup--quiet",()=>NC,t=>NC=t);tt(Sn,"spectrum-FieldButton",()=>BC,t=>BC=t);tt(Sn,"is-disabled",()=>UC,t=>UC=t);tt(Sn,"spectrum-InputGroup--invalid",()=>VC,t=>VC=t);tt(Sn,"spectrum-InputGroup-field",()=>GC,t=>GC=t);tt(Sn,"spectrum-InputGroup-input-validationIcon",()=>jC,t=>jC=t);tt(Sn,"spectrum-InputGroup-input-circleLoader",()=>HC,t=>HC=t);tt(Sn,"spectrum-InputGroup-input",()=>WC,t=>WC=t);tt(Sn,"spectrum-InputGroup-icon",()=>KC,t=>KC=t);tt(Sn,"spectrum-InputGroup-popover--quiet",()=>qC,t=>qC=t);tt(Sn,"spectrum-Datepicker--range",()=>XC,t=>XC=t);tt(Sn,"spectrum-Datepicker--datetimeRange",()=>ZC,t=>ZC=t);tt(Sn,"spectrum-Datepicker-startField",()=>YC,t=>YC=t);tt(Sn,"spectrum-Datepicker-endField",()=>JC,t=>JC=t);tt(Sn,"spectrum-Datepicker--rangeDash",()=>QC,t=>QC=t);tt(Sn,"is-focused",()=>eI,t=>eI=t);tt(Sn,"spectrum-Datepicker-focusRing",()=>tI,t=>tI=t);tt(Sn,"is-hovered",()=>nI,t=>nI=t);tt(Sn,"is-selected",()=>rI,t=>rI=t);tt(Sn,"spectrum-FieldButton--invalid",()=>iI,t=>iI=t);var FC,zC,NC,BC,UC,VC,GC,jC,HC,WC,KC,qC,XC,ZC,YC,JC,QC,eI,tI,nI,rI,iI;FC="spectrum-InputGroup_a0942f";zC="focus-ring_a0942f";NC="spectrum-InputGroup--quiet_a0942f";BC="spectrum-FieldButton_a0942f";UC="is-disabled_a0942f";VC="spectrum-InputGroup--invalid_a0942f";GC="spectrum-InputGroup-field_a0942f";jC="spectrum-InputGroup-input-validationIcon_a0942f";HC="spectrum-InputGroup-input-circleLoader_a0942f";WC="spectrum-InputGroup-input_a0942f";KC="spectrum-InputGroup-icon_a0942f";qC="spectrum-InputGroup-popover--quiet_a0942f";XC="spectrum-Datepicker--range_a0942f";ZC="spectrum-Datepicker--datetimeRange_a0942f";YC="spectrum-Datepicker-startField_a0942f";JC="spectrum-Datepicker-endField_a0942f";QC="spectrum-Datepicker--rangeDash_a0942f";eI="is-focused_a0942f";tI="spectrum-Datepicker-focusRing_a0942f";nI="is-hovered_a0942f";rI="is-selected_a0942f";iI="spectrum-FieldButton--invalid_a0942f";var Wr={};tt(Wr,"spectrum-Textfield-input",()=>sI,t=>sI=t);tt(Wr,"spectrum-Textfield",()=>oI,t=>oI=t);tt(Wr,"focus-ring",()=>aI,t=>aI=t);tt(Wr,"spectrum-Textfield--quiet",()=>lI,t=>lI=t);tt(Wr,"spectrum-Textfield--multiline",()=>cI,t=>cI=t);tt(Wr,"is-placeholder",()=>uI,t=>uI=t);tt(Wr,"is-hovered",()=>dI,t=>dI=t);tt(Wr,"spectrum-Textfield--valid",()=>hI,t=>hI=t);tt(Wr,"spectrum-Textfield--invalid",()=>fI,t=>fI=t);tt(Wr,"spectrum-Textfield--loadable",()=>pI,t=>pI=t);tt(Wr,"spectrum-Textfield-wrapper",()=>mI,t=>mI=t);tt(Wr,"spectrum-Textfield-wrapper--quiet",()=>gI,t=>gI=t);tt(Wr,"spectrum-Textfield-validationIcon",()=>yI,t=>yI=t);tt(Wr,"spectrum-Textfield-icon",()=>_I,t=>_I=t);tt(Wr,"spectrum-Textfield-inputIcon",()=>vI,t=>vI=t);tt(Wr,"spectrum-Textfield-circleLoader",()=>bI,t=>bI=t);tt(Wr,"is-focused",()=>xI,t=>xI=t);tt(Wr,"is-disabled",()=>wI,t=>wI=t);var sI,oI,aI,lI,cI,uI,dI,hI,fI,pI,mI,gI,yI,_I,vI,bI,xI,wI;sI="spectrum-Textfield-input_73bc77";oI="spectrum-Textfield_73bc77";aI="focus-ring_73bc77";lI="spectrum-Textfield--quiet_73bc77";cI="spectrum-Textfield--multiline_73bc77";uI="is-placeholder_73bc77";dI="is-hovered_73bc77";hI="spectrum-Textfield--valid_73bc77";fI="spectrum-Textfield--invalid_73bc77";pI="spectrum-Textfield--loadable_73bc77";mI="spectrum-Textfield-wrapper_73bc77";gI="spectrum-Textfield-wrapper--quiet_73bc77";yI="spectrum-Textfield-validationIcon_73bc77";_I="spectrum-Textfield-icon_73bc77";vI="spectrum-Textfield-inputIcon_73bc77";bI="spectrum-Textfield-circleLoader_73bc77";xI="is-focused_73bc77";wI="is-disabled_73bc77";const $xe=ce.forwardRef(function(e,n){e=Rb(e);let{isQuiet:r,isDisabled:i,validationState:s,isReadOnly:c}=e,{contains:o}=C9({sensitivity:"base"}),f=BG({...e,defaultFilter:o,allowsEmptyCollection:!0,shouldCloseOnBlur:!1}),m=ee.useRef(),x=Dg(n,m),{triggerProps:S,overlayProps:T}=H9({type:"listbox"},f,m),{labelProps:C,fieldProps:R}=_V({...e,labelElementType:"span"});return C.onClick=()=>{e.isDisabled||(m.current.focus(),Tve("keyboard"))},ce.createElement(ce.Fragment,null,ce.createElement(r$,{...e,labelProps:C,elementType:"span",ref:x,includeNecessityIndicatorInAccessibilityName:!0},ce.createElement(Mxe,{...kn(S,R,{autoFocus:e.autoFocus}),ref:m,isQuiet:r,isDisabled:i,isPlaceholder:!f.inputValue,validationState:s,onPress:()=>!c&&f.open(null,"manual")},f.inputValue||e.placeholder||"")),ce.createElement(i1e,{state:f,isFixedHeight:!0,...T},ce.createElement(kxe,{...e,onClose:f.close,overlayProps:T,state:f})))}),Mxe=ce.forwardRef(function(e,n){let{isQuiet:r,isDisabled:i,isPlaceholder:s,validationState:c,children:o,style:f,className:m}=e,x=Nl(_n(zg)),S=jo(),T=jo(),C=c==="invalid"?ce.createElement(n$,{id:T,"aria-label":x.format("invalid")}):ce.createElement(e$,null),R=ce.cloneElement(C,{UNSAFE_className:st(_n(Wr),"spectrum-Textfield-validationIcon",st(_n(Sn),"spectrum-InputGroup-input-validationIcon"))}),{hoverProps:D,isHovered:H}=Xc({}),{buttonProps:F,isPressed:k}=Cb({...e,"aria-labelledby":[e["aria-labelledby"],e["aria-label"]&&!e["aria-labelledby"]?e.id:null,S,c==="invalid"?T:null].filter(Boolean).join(" "),elementType:"div"},n);return ce.createElement(Af,{focusClass:st(_n(Sn),"is-focused"),focusRingClass:st(_n(Sn),"focus-ring")},ce.createElement("div",{...kn(D,F),"aria-haspopup":"dialog",ref:n,style:{...f,outline:"none"},className:st(_n(Sn),"spectrum-InputGroup",{"spectrum-InputGroup--quiet":r,"is-disabled":i,"spectrum-InputGroup--invalid":c==="invalid"&&!i,"is-hovered":H},st(_n(Fi),"mobile-combobox"),m)},ce.createElement("div",{className:st(_n(Wr),"spectrum-Textfield",{"spectrum-Textfield--invalid":c==="invalid"&&!i,"spectrum-Textfield--valid":c==="valid"&&!i,"spectrum-Textfield--quiet":r},st(_n(Sn),"spectrum-InputGroup-field"))},ce.createElement("div",{className:st(_n(Wr),"spectrum-Textfield-input",{"is-hovered":H,"is-placeholder":s,"is-disabled":i},st(_n(Sn),"spectrum-InputGroup-input",st(_n(ui),"spectrum-Field-field")),st(_n(Fi),"mobile-input"))},ce.createElement("span",{id:S,className:st(_n(Fi),"mobile-value")},o)),c&&!i?R:null),ce.createElement("div",{className:st(_n(Jn),"spectrum-FieldButton",{"spectrum-FieldButton--quiet":r,"is-active":k,"is-disabled":i,"spectrum-FieldButton--invalid":c==="invalid"&&!i,"is-hovered":H},st(_n(Sn),"spectrum-FieldButton"))},ce.createElement(N7,{UNSAFE_className:st(_n(Sn),"spectrum-Dropdown-chevron")}))))});function kxe(t){let{state:e,isDisabled:n,validationState:r,label:i,overlayProps:s,loadingState:c,onLoadMore:o,onClose:f}=t,m=ee.useRef(null),[x,S]=ee.useState(!1),T=ee.useRef(),C=ee.useRef(),R=ee.useRef(),D=ee.useRef(),H=a$(e),F=Nl(_n(zg)),{inputProps:k,listBoxProps:N,labelProps:U}=NG({...t,keyboardDelegate:H,buttonRef:R9(C),popoverRef:R,listBoxRef:D,inputRef:T},e);ce.useEffect(()=>(od(T.current),()=>{e.setFocused(!1)}),[]);let{dialogProps:ie}=Rxe({"aria-labelledby":jo(U.id)},R);k.role="searchbox",k["aria-haspopup"]="listbox",delete k["aria-expanded"],delete k.onTouchEnd;let he=ce.createElement(Fbe,{preventFocus:!0,"aria-label":F.format("clear"),excludeFromTabOrder:!0,onPress:()=>{e.setInputValue(""),T.current.focus()},UNSAFE_className:st(_n(Cs),"spectrum-ClearButton"),isDisabled:n}),le=ce.createElement(s$,{"aria-label":F.format("loading"),size:"S",isIndeterminate:!0,UNSAFE_className:st(_n(Cs),"spectrum-Search-circleLoader",st(_n(Wr),"spectrum-Textfield-circleLoader"))}),ve=ee.useRef(!1),Oe=()=>{ve.current=!0},Re=()=>{ve.current=!1},Ee=ee.useCallback(()=>{!T.current||document.activeElement!==T.current||!ve.current||R.current.focus()},[T,R,ve]),$e=k.value,we=ee.useRef($e);ee.useEffect(()=>{c==="filtering"&&!x?(m.current===null&&(m.current=setTimeout(()=>{S(!0)},500)),$e!==we.current&&(clearTimeout(m.current),m.current=setTimeout(()=>{S(!0)},500))):c!=="filtering"&&(S(!1),clearTimeout(m.current),m.current=null),we.current=$e},[c,$e,x]);let Be=Jt=>{Jt.key==="Enter"&&e.selectionManager.focusedKey==null?R.current.focus():k.onKeyDown(Jt)};return ce.createElement(qR,{restoreFocus:!0,contain:!0},ce.createElement("div",{...kn(s,ie),ref:R,className:st(_n(Fi),"tray-dialog")},ce.createElement(mf,{onDismiss:f}),ce.createElement(rG,{label:i,labelProps:U,inputProps:{...k,onKeyDown:Be},inputRef:T,isDisabled:n,isLoading:x&&c==="filtering",loadingIndicator:c!=null&&le,validationState:r,labelAlign:"start",labelPosition:"top",wrapperChildren:(e.inputValue!==""||c==="filtering"||r!=null)&&!t.isReadOnly&&he,UNSAFE_className:st(_n(Cs),"spectrum-Search","spectrum-Textfield","spectrum-Search--loadable",{"spectrum-Search--invalid":r==="invalid"&&!n,"spectrum-Search--valid":r==="valid"&&!n},st(_n(Fi),"tray-textfield",{"has-label":!!t.label})),inputClassName:st(_n(Fi),"tray-textfield-input",st(_n(Cs),"spectrum-Search-input")),validationIconClassName:st(_n(Cs),"spectrum-Search-validationIcon")}),ce.createElement(l$,{...N,domProps:{onTouchStart:Oe,onTouchEnd:Re},disallowEmptySelection:!0,shouldSelectOnPressUp:!0,focusOnPointerEnter:!0,layout:H,state:e,shouldUseVirtualFocus:!0,renderEmptyState:()=>c!=="loading"&&ce.createElement("span",{className:st(_n(Fi),"no-results")},F.format("noResults")),UNSAFE_className:st(_n(Fi),"tray-listbox"),ref:D,onScroll:Ee,onLoadMore:o,isLoading:c==="loading"||c==="loadingMore"}),ce.createElement(mf,{onDismiss:f})))}function Oxe(t,e){return t=Rb(t),t.placeholder&&console.warn("Placeholders are deprecated due to accessibility issues. Please use help text instead. See the docs for details: https://react-spectrum.adobe.com/react-spectrum/ComboBox.html#help-text"),dve()?ce.createElement($xe,{...t,menuTrigger:"input",ref:e}):ce.createElement(Dxe,{...t,ref:e})}const Dxe=ce.forwardRef(function(e,n){let{menuTrigger:r="input",shouldFlip:i=!0,direction:s="bottom",isQuiet:c,loadingState:o,onLoadMore:f}=e,m=Nl(_n(zg)),x=o!=null,S=ee.useRef(),T=CO(S),C=ee.useRef(),R=CO(C),D=ee.useRef(),H=ee.useRef(),F=Dg(n,H),{contains:k}=C9({sensitivity:"base"}),N=BG({...e,defaultFilter:k,allowsEmptyCollection:x}),U=a$(N),{buttonProps:ie,inputProps:he,listBoxProps:le,labelProps:ve,descriptionProps:Oe,errorMessageProps:Re}=NG({...e,keyboardDelegate:U,buttonRef:R,popoverRef:T,listBoxRef:D,inputRef:H,menuTrigger:r},N),[Ee,$e]=ee.useState(null),{scale:we}=yd(),Be=ee.useCallback(()=>{if(R.current&&H.current){let mt=R.current.offsetWidth,an=H.current.offsetWidth;$e(mt+an)}},[R,H,$e]);BR({ref:F,onResize:Be}),wr(Be,[we,Be]);let Jt={width:c?null:Ee,minWidth:c?`calc(${Ee}px + calc(2 * var(--spectrum-dropdown-quiet-offset)))`:Ee};return ce.createElement(ce.Fragment,null,ce.createElement(r$,{...e,descriptionProps:Oe,errorMessageProps:Re,labelProps:ve,ref:F},ce.createElement(Fxe,{...e,isOpen:N.isOpen,loadingState:o,inputProps:he,inputRef:H,triggerProps:ie,triggerRef:C})),ce.createElement(t1e,{state:N,UNSAFE_style:Jt,UNSAFE_className:st(_n(Sn),"spectrum-InputGroup-popover",{"spectrum-InputGroup-popover--quiet":c}),ref:S,triggerRef:R,scrollRef:D,placement:`${s} end`,hideArrow:!0,isNonModal:!0,shouldFlip:i},ce.createElement(l$,{...le,ref:D,disallowEmptySelection:!0,autoFocus:N.focusStrategy,shouldSelectOnPressUp:!0,focusOnPointerEnter:!0,layout:U,state:N,shouldUseVirtualFocus:!0,isLoading:o==="loadingMore",onLoadMore:f,renderEmptyState:()=>x&&ce.createElement("span",{className:st(_n(Fi),"no-results")},o==="loading"?m.format("loading"):m.format("noResults"))})))}),Fxe=ce.forwardRef(function(e,n){let{isQuiet:r,isDisabled:i,validationState:s,inputProps:c,inputRef:o,triggerProps:f,triggerRef:m,autoFocus:x,style:S,className:T,loadingState:C,isOpen:R,menuTrigger:D}=e,{hoverProps:H,isHovered:F}=Xc({}),k=Nl(_n(zg)),N=ee.useRef(null),[U,ie]=ee.useState(!1),he=ce.createElement(s$,{"aria-label":k.format("loading"),size:"S",isIndeterminate:!0,UNSAFE_className:st(_n(Wr),"spectrum-Textfield-circleLoader",st(_n(Sn),"spectrum-InputGroup-input-circleLoader"))}),le=C==="loading"||C==="filtering",ve=c.value,Oe=ee.useRef(ve);return ee.useEffect(()=>{le&&!U?(N.current===null&&(N.current=setTimeout(()=>{ie(!0)},500)),ve!==Oe.current&&(clearTimeout(N.current),N.current=setTimeout(()=>{ie(!0)},500))):le||(ie(!1),clearTimeout(N.current),N.current=null),Oe.current=ve},[le,U,ve]),ce.createElement(Af,{within:!0,isTextInput:!0,focusClass:st(_n(Sn),"is-focused"),focusRingClass:st(_n(Sn),"focus-ring"),autoFocus:x},ce.createElement("div",{...H,ref:n,style:S,className:st(_n(Sn),"spectrum-InputGroup",{"spectrum-InputGroup--quiet":r,"is-disabled":i,"spectrum-InputGroup--invalid":s==="invalid"&&!i,"is-hovered":F},T)},ce.createElement(rG,{inputProps:c,inputRef:o,UNSAFE_className:st(_n(Sn),"spectrum-InputGroup-field"),inputClassName:st(_n(Sn),"spectrum-InputGroup-input"),validationIconClassName:st(_n(Sn),"spectrum-InputGroup-input-validationIcon"),isDisabled:i,isQuiet:r,validationState:s,isLoading:U&&(R||D==="manual"||C==="loading"),loadingIndicator:C!=null&&he,disableFocusRing:!0}),ce.createElement(yve,{preventFocusOnPress:!0,isPressed:R},ce.createElement(Obe,{...f,ref:m,UNSAFE_className:st(_n(Sn),"spectrum-FieldButton"),isQuiet:r,validationState:s},ce.createElement(N7,{UNSAFE_className:st(_n(Sn),"spectrum-Dropdown-chevron")})))))}),zxe=ce.forwardRef(Oxe);function Nxe(t,e){t=Fg(t,"header");let{children:n,...r}=t,{styleProps:i}=Ni(r),s=ma(e);return ce.createElement("header",{...ps(r),...i,ref:s},ce.createElement(k9,null,n))}const wj=ee.forwardRef(Nxe);function qp(t){return t&&t.__esModule?t.default:t}function ya(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var Ej={};ya(Ej,"spectrum--darkest",()=>EI,t=>EI=t);var EI;EI="spectrum--darkest_256eeb";var Zc={};ya(Zc,"spectrum",()=>TI,t=>TI=t);ya(Zc,"spectrum--medium",()=>SI,t=>SI=t);ya(Zc,"spectrum--large",()=>AI,t=>AI=t);ya(Zc,"spectrum--darkest",()=>PI,t=>PI=t);ya(Zc,"spectrum--dark",()=>CI,t=>CI=t);ya(Zc,"spectrum--light",()=>II,t=>II=t);ya(Zc,"spectrum--lightest",()=>LI,t=>LI=t);var TI,SI,AI,PI,CI,II,LI;TI="spectrum_9e130c";SI="spectrum--medium_9e130c";AI="spectrum--large_9e130c";PI="spectrum--darkest_9e130c";CI="spectrum--dark_9e130c";II="spectrum--light_9e130c";LI="spectrum--lightest_9e130c";var Tj={};ya(Tj,"spectrum--large",()=>RI,t=>RI=t);var RI;RI="spectrum--large_c40598";var Sj={};ya(Sj,"spectrum--lightest",()=>$I,t=>$I=t);var $I;$I="spectrum--lightest_ddefb6";var Aj={};ya(Aj,"spectrum--medium",()=>MI,t=>MI=t);var MI;MI="spectrum--medium_4b172c";let Bxe={global:qp(Zc),light:qp(Sj),dark:qp(Ej),medium:qp(Aj),large:qp(Tj)};const Uxe=()=>lr.jsx("div",{}),Vxe=()=>{const t=_c(p9);if(t===null)return null;const e=t.users.map(n=>({id:n.user_id,label:n.user_id}));return lr.jsxs("div",{children:[lr.jsxs(wj,{children:["Group has ",t.users.length," Users"]}),lr.jsx("div",{style:{height:"200px",overflowY:"auto"},children:lr.jsx(Axe,{children:e.map(n=>lr.jsx(g9,{id:n.id,children:n.label}))})})]})},Gxe=()=>{const t=_c(f9),[e,n]=B2(DR),r=t.map(i=>({id:`${i}`,name:`${i}`}));return lr.jsx("div",{style:{width:"250px",height:"95vh",top:"2.5vh",right:"20px",position:"absolute",zIndex:1,backgroundColor:"white",boxSizing:"border-box",padding:"10px",boxShadow:"1px 1px 26px 2px rgba(0,0,0,0.75)"},children:lr.jsxs(aA,{direction:"column",children:[e!==null&&lr.jsx(wj,{children:lr.jsxs(aA,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[lr.jsxs(YR,{children:["Selected Group : ",e]}),lr.jsx(Mbe,{onPress:()=>n(null),children:" Clear"})]})}),lr.jsx(zxe,{width:"100%",label:"Group",defaultItems:r,selectedKey:e,onSelectionChange:i=>n(parseInt(i)),children:i=>lr.jsx(g9,{children:i.name},i.id)}),lr.jsx(Uxe,{}),lr.jsx(Vxe,{})]})})};function jxe(){return lr.jsx($7,{theme:Bxe,children:lr.jsx(kte,{children:lr.jsxs(ce.Suspense,{fallback:lr.jsx("h1",{children:"Loading"}),children:[lr.jsx(p0e,{}),lr.jsx(Gxe,{})]})})})}Fw.createRoot(document.getElementById("root")).render(lr.jsx(jxe,{}));export{gW as c};

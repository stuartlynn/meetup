function RY(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var MY=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function az(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function lz(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){if(this instanceof r){var i=[null];i.push.apply(i,arguments);var s=Function.bind.apply(e,i);return new s}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Yt={},$Y={get exports(){return Yt},set exports(t){Yt=t}},v1={},te={},kY={get exports(){return te},set exports(t){te=t}},jn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ry=Symbol.for("react.element"),OY=Symbol.for("react.portal"),DY=Symbol.for("react.fragment"),FY=Symbol.for("react.strict_mode"),NY=Symbol.for("react.profiler"),zY=Symbol.for("react.provider"),BY=Symbol.for("react.context"),UY=Symbol.for("react.forward_ref"),VY=Symbol.for("react.suspense"),jY=Symbol.for("react.memo"),GY=Symbol.for("react.lazy"),F6=Symbol.iterator;function WY(t){return t===null||typeof t!="object"?null:(t=F6&&t[F6]||t["@@iterator"],typeof t=="function"?t:null)}var cz={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},uz=Object.assign,dz={};function yp(t,e,n){this.props=t,this.context=e,this.refs=dz,this.updater=n||cz}yp.prototype.isReactComponent={};yp.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};yp.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function hz(){}hz.prototype=yp.prototype;function wR(t,e,n){this.props=t,this.context=e,this.refs=dz,this.updater=n||cz}var TR=wR.prototype=new hz;TR.constructor=wR;uz(TR,yp.prototype);TR.isPureReactComponent=!0;var N6=Array.isArray,fz=Object.prototype.hasOwnProperty,ER={current:null},pz={key:!0,ref:!0,__self:!0,__source:!0};function mz(t,e,n){var r,i={},s=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(s=""+e.key),e)fz.call(e,r)&&!pz.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var h=Array(o),p=0;p<o;p++)h[p]=arguments[p+2];i.children=h}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:Ry,type:t,key:s,ref:l,props:i,_owner:ER.current}}function HY(t,e){return{$$typeof:Ry,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function SR(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ry}function qY(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var z6=/\/+/g;function jw(t,e){return typeof t=="object"&&t!==null&&t.key!=null?qY(""+t.key):e.toString(36)}function x_(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case Ry:case OY:l=!0}}if(l)return l=t,i=i(l),t=r===""?"."+jw(l,0):r,N6(i)?(n="",t!=null&&(n=t.replace(z6,"$&/")+"/"),x_(i,e,n,"",function(p){return p})):i!=null&&(SR(i)&&(i=HY(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(z6,"$&/")+"/")+t)),e.push(i)),1;if(l=0,r=r===""?".":r+":",N6(t))for(var o=0;o<t.length;o++){s=t[o];var h=r+jw(s,o);l+=x_(s,e,n,h,i)}else if(h=WY(t),typeof h=="function")for(t=h.call(t),o=0;!(s=t.next()).done;)s=s.value,h=r+jw(s,o++),l+=x_(s,e,n,h,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function uv(t,e,n){if(t==null)return t;var r=[],i=0;return x_(t,r,"","",function(s){return e.call(n,s,i++)}),r}function KY(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Bs={current:null},w_={transition:null},XY={ReactCurrentDispatcher:Bs,ReactCurrentBatchConfig:w_,ReactCurrentOwner:ER};jn.Children={map:uv,forEach:function(t,e,n){uv(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return uv(t,function(){e++}),e},toArray:function(t){return uv(t,function(e){return e})||[]},only:function(t){if(!SR(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};jn.Component=yp;jn.Fragment=DY;jn.Profiler=NY;jn.PureComponent=wR;jn.StrictMode=FY;jn.Suspense=VY;jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XY;jn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=uz({},t.props),i=t.key,s=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,l=ER.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(h in e)fz.call(e,h)&&!pz.hasOwnProperty(h)&&(r[h]=e[h]===void 0&&o!==void 0?o[h]:e[h])}var h=arguments.length-2;if(h===1)r.children=n;else if(1<h){o=Array(h);for(var p=0;p<h;p++)o[p]=arguments[p+2];r.children=o}return{$$typeof:Ry,type:t.type,key:i,ref:s,props:r,_owner:l}};jn.createContext=function(t){return t={$$typeof:BY,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:zY,_context:t},t.Consumer=t};jn.createElement=mz;jn.createFactory=function(t){var e=mz.bind(null,t);return e.type=t,e};jn.createRef=function(){return{current:null}};jn.forwardRef=function(t){return{$$typeof:UY,render:t}};jn.isValidElement=SR;jn.lazy=function(t){return{$$typeof:GY,_payload:{_status:-1,_result:t},_init:KY}};jn.memo=function(t,e){return{$$typeof:jY,type:t,compare:e===void 0?null:e}};jn.startTransition=function(t){var e=w_.transition;w_.transition={};try{t()}finally{w_.transition=e}};jn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};jn.useCallback=function(t,e){return Bs.current.useCallback(t,e)};jn.useContext=function(t){return Bs.current.useContext(t)};jn.useDebugValue=function(){};jn.useDeferredValue=function(t){return Bs.current.useDeferredValue(t)};jn.useEffect=function(t,e){return Bs.current.useEffect(t,e)};jn.useId=function(){return Bs.current.useId()};jn.useImperativeHandle=function(t,e,n){return Bs.current.useImperativeHandle(t,e,n)};jn.useInsertionEffect=function(t,e){return Bs.current.useInsertionEffect(t,e)};jn.useLayoutEffect=function(t,e){return Bs.current.useLayoutEffect(t,e)};jn.useMemo=function(t,e){return Bs.current.useMemo(t,e)};jn.useReducer=function(t,e,n){return Bs.current.useReducer(t,e,n)};jn.useRef=function(t){return Bs.current.useRef(t)};jn.useState=function(t){return Bs.current.useState(t)};jn.useSyncExternalStore=function(t,e,n){return Bs.current.useSyncExternalStore(t,e,n)};jn.useTransition=function(){return Bs.current.useTransition()};jn.version="18.2.0";(function(t){t.exports=jn})(kY);const le=az(te);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZY=te,YY=Symbol.for("react.element"),JY=Symbol.for("react.fragment"),QY=Object.prototype.hasOwnProperty,eJ=ZY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tJ={key:!0,ref:!0,__self:!0,__source:!0};function gz(t,e,n){var r,i={},s=null,l=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)QY.call(e,r)&&!tJ.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:YY,type:t,key:s,ref:l,props:i,_owner:eJ.current}}v1.Fragment=JY;v1.jsx=gz;v1.jsxs=gz;(function(t){t.exports=v1})($Y);var rE={},Ad={},nJ={get exports(){return Ad},set exports(t){Ad=t}},Mo={},iE={},rJ={get exports(){return iE},set exports(t){iE=t}},yz={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(ot,yt){var at=ot.length;ot.push(yt);e:for(;0<at;){var Mt=at-1>>>1,Re=ot[Mt];if(0<i(Re,yt))ot[Mt]=yt,ot[at]=Re,at=Mt;else break e}}function n(ot){return ot.length===0?null:ot[0]}function r(ot){if(ot.length===0)return null;var yt=ot[0],at=ot.pop();if(at!==yt){ot[0]=at;e:for(var Mt=0,Re=ot.length,Ke=Re>>>1;Mt<Ke;){var Je=2*(Mt+1)-1,kt=ot[Je],ft=Je+1,Pt=ot[ft];if(0>i(kt,at))ft<Re&&0>i(Pt,kt)?(ot[Mt]=Pt,ot[ft]=at,Mt=ft):(ot[Mt]=kt,ot[Je]=at,Mt=Je);else if(ft<Re&&0>i(Pt,at))ot[Mt]=Pt,ot[ft]=at,Mt=ft;else break e}}return yt}function i(ot,yt){var at=ot.sortIndex-yt.sortIndex;return at!==0?at:ot.id-yt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var h=[],p=[],b=1,x=null,w=3,A=!1,L=!1,M=!1,U=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,$=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(ot){for(var yt=n(p);yt!==null;){if(yt.callback===null)r(p);else if(yt.startTime<=ot)r(p),yt.sortIndex=yt.expirationTime,e(h,yt);else break;yt=n(p)}}function B(ot){if(M=!1,N(ot),!L)if(n(h)!==null)L=!0,ut(Z);else{var yt=n(p);yt!==null&&rn(B,yt.startTime-ot)}}function Z(ot,yt){L=!1,M&&(M=!1,D(ve),ve=-1),A=!0;var at=w;try{for(N(yt),x=n(h);x!==null&&(!(x.expirationTime>yt)||ot&&!fe());){var Mt=x.callback;if(typeof Mt=="function"){x.callback=null,w=x.priorityLevel;var Re=Mt(x.expirationTime<=yt);yt=t.unstable_now(),typeof Re=="function"?x.callback=Re:x===n(h)&&r(h),N(yt)}else r(h);x=n(h)}if(x!==null)var Ke=!0;else{var Je=n(p);Je!==null&&rn(B,Je.startTime-yt),Ke=!1}return Ke}finally{x=null,w=at,A=!1}}var ie=!1,re=null,ve=-1,Te=5,Ae=-1;function fe(){return!(t.unstable_now()-Ae<Te)}function Pe(){if(re!==null){var ot=t.unstable_now();Ae=ot;var yt=!0;try{yt=re(!0,ot)}finally{yt?_e():(ie=!1,re=null)}}else ie=!1}var _e;if(typeof $=="function")_e=function(){$(Pe)};else if(typeof MessageChannel<"u"){var ke=new MessageChannel,Vt=ke.port2;ke.port1.onmessage=Pe,_e=function(){Vt.postMessage(null)}}else _e=function(){U(Pe,0)};function ut(ot){re=ot,ie||(ie=!0,_e())}function rn(ot,yt){ve=U(function(){ot(t.unstable_now())},yt)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ot){ot.callback=null},t.unstable_continueExecution=function(){L||A||(L=!0,ut(Z))},t.unstable_forceFrameRate=function(ot){0>ot||125<ot?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Te=0<ot?Math.floor(1e3/ot):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return n(h)},t.unstable_next=function(ot){switch(w){case 1:case 2:case 3:var yt=3;break;default:yt=w}var at=w;w=yt;try{return ot()}finally{w=at}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ot,yt){switch(ot){case 1:case 2:case 3:case 4:case 5:break;default:ot=3}var at=w;w=ot;try{return yt()}finally{w=at}},t.unstable_scheduleCallback=function(ot,yt,at){var Mt=t.unstable_now();switch(typeof at=="object"&&at!==null?(at=at.delay,at=typeof at=="number"&&0<at?Mt+at:Mt):at=Mt,ot){case 1:var Re=-1;break;case 2:Re=250;break;case 5:Re=1073741823;break;case 4:Re=1e4;break;default:Re=5e3}return Re=at+Re,ot={id:b++,callback:yt,priorityLevel:ot,startTime:at,expirationTime:Re,sortIndex:-1},at>Mt?(ot.sortIndex=at,e(p,ot),n(h)===null&&ot===n(p)&&(M?(D(ve),ve=-1):M=!0,rn(B,at-Mt))):(ot.sortIndex=Re,e(h,ot),L||A||(L=!0,ut(Z))),ot},t.unstable_shouldYield=fe,t.unstable_wrapCallback=function(ot){var yt=w;return function(){var at=w;w=yt;try{return ot.apply(this,arguments)}finally{w=at}}}})(yz);(function(t){t.exports=yz})(rJ);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vz=te,Lo=iE;function dt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _z=new Set,jg={};function Xd(t,e){Vf(t,e),Vf(t+"Capture",e)}function Vf(t,e){for(jg[t]=e,t=0;t<e.length;t++)_z.add(e[t])}var Jl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sE=Object.prototype.hasOwnProperty,iJ=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,B6={},U6={};function sJ(t){return sE.call(U6,t)?!0:sE.call(B6,t)?!1:iJ.test(t)?U6[t]=!0:(B6[t]=!0,!1)}function oJ(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function aJ(t,e,n,r){if(e===null||typeof e>"u"||oJ(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Us(t,e,n,r,i,s,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=l}var rs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){rs[t]=new Us(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];rs[e]=new Us(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){rs[t]=new Us(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){rs[t]=new Us(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){rs[t]=new Us(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){rs[t]=new Us(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){rs[t]=new Us(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){rs[t]=new Us(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){rs[t]=new Us(t,5,!1,t.toLowerCase(),null,!1,!1)});var AR=/[\-:]([a-z])/g;function PR(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(AR,PR);rs[e]=new Us(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(AR,PR);rs[e]=new Us(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(AR,PR);rs[e]=new Us(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){rs[t]=new Us(t,1,!1,t.toLowerCase(),null,!1,!1)});rs.xlinkHref=new Us("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){rs[t]=new Us(t,1,!1,t.toLowerCase(),null,!0,!0)});function CR(t,e,n,r){var i=rs.hasOwnProperty(e)?rs[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(aJ(e,n,i,r)&&(n=null),r||i===null?sJ(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var sc=vz.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dv=Symbol.for("react.element"),rf=Symbol.for("react.portal"),sf=Symbol.for("react.fragment"),LR=Symbol.for("react.strict_mode"),oE=Symbol.for("react.profiler"),bz=Symbol.for("react.provider"),xz=Symbol.for("react.context"),IR=Symbol.for("react.forward_ref"),aE=Symbol.for("react.suspense"),lE=Symbol.for("react.suspense_list"),RR=Symbol.for("react.memo"),Vc=Symbol.for("react.lazy"),wz=Symbol.for("react.offscreen"),V6=Symbol.iterator;function Pm(t){return t===null||typeof t!="object"?null:(t=V6&&t[V6]||t["@@iterator"],typeof t=="function"?t:null)}var Jr=Object.assign,Gw;function ag(t){if(Gw===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Gw=e&&e[1]||""}return`
`+Gw+t}var Ww=!1;function Hw(t,e){if(!t||Ww)return"";Ww=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(p){var r=p}Reflect.construct(t,[],e)}else{try{e.call()}catch(p){r=p}t.call(e.prototype)}else{try{throw Error()}catch(p){r=p}t()}}catch(p){if(p&&r&&typeof p.stack=="string"){for(var i=p.stack.split(`
`),s=r.stack.split(`
`),l=i.length-1,o=s.length-1;1<=l&&0<=o&&i[l]!==s[o];)o--;for(;1<=l&&0<=o;l--,o--)if(i[l]!==s[o]){if(l!==1||o!==1)do if(l--,o--,0>o||i[l]!==s[o]){var h=`
`+i[l].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=l&&0<=o);break}}}finally{Ww=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ag(t):""}function lJ(t){switch(t.tag){case 5:return ag(t.type);case 16:return ag("Lazy");case 13:return ag("Suspense");case 19:return ag("SuspenseList");case 0:case 2:case 15:return t=Hw(t.type,!1),t;case 11:return t=Hw(t.type.render,!1),t;case 1:return t=Hw(t.type,!0),t;default:return""}}function cE(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case sf:return"Fragment";case rf:return"Portal";case oE:return"Profiler";case LR:return"StrictMode";case aE:return"Suspense";case lE:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xz:return(t.displayName||"Context")+".Consumer";case bz:return(t._context.displayName||"Context")+".Provider";case IR:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case RR:return e=t.displayName||null,e!==null?e:cE(t.type)||"Memo";case Vc:e=t._payload,t=t._init;try{return cE(t(e))}catch{}}return null}function cJ(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cE(e);case 8:return e===LR?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function mu(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Tz(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function uJ(t){var e=Tz(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(l){r=""+l,s.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function hv(t){t._valueTracker||(t._valueTracker=uJ(t))}function Ez(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Tz(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Y_(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function uE(t,e){var n=e.checked;return Jr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function j6(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=mu(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Sz(t,e){e=e.checked,e!=null&&CR(t,"checked",e,!1)}function dE(t,e){Sz(t,e);var n=mu(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?hE(t,e.type,n):e.hasOwnProperty("defaultValue")&&hE(t,e.type,mu(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function G6(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function hE(t,e,n){(e!=="number"||Y_(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var lg=Array.isArray;function Ef(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+mu(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function fE(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(dt(91));return Jr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function W6(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(dt(92));if(lg(n)){if(1<n.length)throw Error(dt(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:mu(n)}}function Az(t,e){var n=mu(e.value),r=mu(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function H6(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Pz(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pE(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Pz(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var fv,Cz=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(fv=fv||document.createElement("div"),fv.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=fv.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Gg(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var wg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dJ=["Webkit","ms","Moz","O"];Object.keys(wg).forEach(function(t){dJ.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),wg[e]=wg[t]})});function Lz(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||wg.hasOwnProperty(t)&&wg[t]?(""+e).trim():e+"px"}function Iz(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Lz(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var hJ=Jr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mE(t,e){if(e){if(hJ[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(dt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(dt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(dt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(dt(62))}}function gE(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yE=null;function MR(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var vE=null,Sf=null,Af=null;function q6(t){if(t=ky(t)){if(typeof vE!="function")throw Error(dt(280));var e=t.stateNode;e&&(e=T1(e),vE(t.stateNode,t.type,e))}}function Rz(t){Sf?Af?Af.push(t):Af=[t]:Sf=t}function Mz(){if(Sf){var t=Sf,e=Af;if(Af=Sf=null,q6(t),e)for(t=0;t<e.length;t++)q6(e[t])}}function $z(t,e){return t(e)}function kz(){}var qw=!1;function Oz(t,e,n){if(qw)return t(e,n);qw=!0;try{return $z(t,e,n)}finally{qw=!1,(Sf!==null||Af!==null)&&(kz(),Mz())}}function Wg(t,e){var n=t.stateNode;if(n===null)return null;var r=T1(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(dt(231,e,typeof n));return n}var _E=!1;if(Jl)try{var Cm={};Object.defineProperty(Cm,"passive",{get:function(){_E=!0}}),window.addEventListener("test",Cm,Cm),window.removeEventListener("test",Cm,Cm)}catch{_E=!1}function fJ(t,e,n,r,i,s,l,o,h){var p=Array.prototype.slice.call(arguments,3);try{e.apply(n,p)}catch(b){this.onError(b)}}var Tg=!1,J_=null,Q_=!1,bE=null,pJ={onError:function(t){Tg=!0,J_=t}};function mJ(t,e,n,r,i,s,l,o,h){Tg=!1,J_=null,fJ.apply(pJ,arguments)}function gJ(t,e,n,r,i,s,l,o,h){if(mJ.apply(this,arguments),Tg){if(Tg){var p=J_;Tg=!1,J_=null}else throw Error(dt(198));Q_||(Q_=!0,bE=p)}}function Zd(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Dz(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function K6(t){if(Zd(t)!==t)throw Error(dt(188))}function yJ(t){var e=t.alternate;if(!e){if(e=Zd(t),e===null)throw Error(dt(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return K6(i),t;if(s===r)return K6(i),e;s=s.sibling}throw Error(dt(188))}if(n.return!==r.return)n=i,r=s;else{for(var l=!1,o=i.child;o;){if(o===n){l=!0,n=i,r=s;break}if(o===r){l=!0,r=i,n=s;break}o=o.sibling}if(!l){for(o=s.child;o;){if(o===n){l=!0,n=s,r=i;break}if(o===r){l=!0,r=s,n=i;break}o=o.sibling}if(!l)throw Error(dt(189))}}if(n.alternate!==r)throw Error(dt(190))}if(n.tag!==3)throw Error(dt(188));return n.stateNode.current===n?t:e}function Fz(t){return t=yJ(t),t!==null?Nz(t):null}function Nz(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Nz(t);if(e!==null)return e;t=t.sibling}return null}var zz=Lo.unstable_scheduleCallback,X6=Lo.unstable_cancelCallback,vJ=Lo.unstable_shouldYield,_J=Lo.unstable_requestPaint,pi=Lo.unstable_now,bJ=Lo.unstable_getCurrentPriorityLevel,$R=Lo.unstable_ImmediatePriority,Bz=Lo.unstable_UserBlockingPriority,eb=Lo.unstable_NormalPriority,xJ=Lo.unstable_LowPriority,Uz=Lo.unstable_IdlePriority,_1=null,ol=null;function wJ(t){if(ol&&typeof ol.onCommitFiberRoot=="function")try{ol.onCommitFiberRoot(_1,t,void 0,(t.current.flags&128)===128)}catch{}}var Ea=Math.clz32?Math.clz32:SJ,TJ=Math.log,EJ=Math.LN2;function SJ(t){return t>>>=0,t===0?32:31-(TJ(t)/EJ|0)|0}var pv=64,mv=4194304;function cg(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function tb(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,l=n&268435455;if(l!==0){var o=l&~i;o!==0?r=cg(o):(s&=l,s!==0&&(r=cg(s)))}else l=n&~i,l!==0?r=cg(l):s!==0&&(r=cg(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ea(e),i=1<<n,r|=t[n],e&=~i;return r}function AJ(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function PJ(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var l=31-Ea(s),o=1<<l,h=i[l];h===-1?(!(o&n)||o&r)&&(i[l]=AJ(o,e)):h<=e&&(t.expiredLanes|=o),s&=~o}}function xE(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Vz(){var t=pv;return pv<<=1,!(pv&4194240)&&(pv=64),t}function Kw(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function My(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ea(e),t[e]=n}function CJ(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ea(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function kR(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ea(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var cr=0;function jz(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Gz,OR,Wz,Hz,qz,wE=!1,gv=[],tu=null,nu=null,ru=null,Hg=new Map,qg=new Map,Wc=[],LJ="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Z6(t,e){switch(t){case"focusin":case"focusout":tu=null;break;case"dragenter":case"dragleave":nu=null;break;case"mouseover":case"mouseout":ru=null;break;case"pointerover":case"pointerout":Hg.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":qg.delete(e.pointerId)}}function Lm(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=ky(e),e!==null&&OR(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function IJ(t,e,n,r,i){switch(e){case"focusin":return tu=Lm(tu,t,e,n,r,i),!0;case"dragenter":return nu=Lm(nu,t,e,n,r,i),!0;case"mouseover":return ru=Lm(ru,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Hg.set(s,Lm(Hg.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,qg.set(s,Lm(qg.get(s)||null,t,e,n,r,i)),!0}return!1}function Kz(t){var e=md(t.target);if(e!==null){var n=Zd(e);if(n!==null){if(e=n.tag,e===13){if(e=Dz(n),e!==null){t.blockedOn=e,qz(t.priority,function(){Wz(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function T_(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=TE(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);yE=r,n.target.dispatchEvent(r),yE=null}else return e=ky(n),e!==null&&OR(e),t.blockedOn=n,!1;e.shift()}return!0}function Y6(t,e,n){T_(t)&&n.delete(e)}function RJ(){wE=!1,tu!==null&&T_(tu)&&(tu=null),nu!==null&&T_(nu)&&(nu=null),ru!==null&&T_(ru)&&(ru=null),Hg.forEach(Y6),qg.forEach(Y6)}function Im(t,e){t.blockedOn===e&&(t.blockedOn=null,wE||(wE=!0,Lo.unstable_scheduleCallback(Lo.unstable_NormalPriority,RJ)))}function Kg(t){function e(i){return Im(i,t)}if(0<gv.length){Im(gv[0],t);for(var n=1;n<gv.length;n++){var r=gv[n];r.blockedOn===t&&(r.blockedOn=null)}}for(tu!==null&&Im(tu,t),nu!==null&&Im(nu,t),ru!==null&&Im(ru,t),Hg.forEach(e),qg.forEach(e),n=0;n<Wc.length;n++)r=Wc[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Wc.length&&(n=Wc[0],n.blockedOn===null);)Kz(n),n.blockedOn===null&&Wc.shift()}var Pf=sc.ReactCurrentBatchConfig,nb=!0;function MJ(t,e,n,r){var i=cr,s=Pf.transition;Pf.transition=null;try{cr=1,DR(t,e,n,r)}finally{cr=i,Pf.transition=s}}function $J(t,e,n,r){var i=cr,s=Pf.transition;Pf.transition=null;try{cr=4,DR(t,e,n,r)}finally{cr=i,Pf.transition=s}}function DR(t,e,n,r){if(nb){var i=TE(t,e,n,r);if(i===null)i2(t,e,r,rb,n),Z6(t,r);else if(IJ(i,t,e,n,r))r.stopPropagation();else if(Z6(t,r),e&4&&-1<LJ.indexOf(t)){for(;i!==null;){var s=ky(i);if(s!==null&&Gz(s),s=TE(t,e,n,r),s===null&&i2(t,e,r,rb,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else i2(t,e,r,null,n)}}var rb=null;function TE(t,e,n,r){if(rb=null,t=MR(r),t=md(t),t!==null)if(e=Zd(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Dz(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return rb=t,null}function Xz(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bJ()){case $R:return 1;case Bz:return 4;case eb:case xJ:return 16;case Uz:return 536870912;default:return 16}default:return 16}}var Zc=null,FR=null,E_=null;function Zz(){if(E_)return E_;var t,e=FR,n=e.length,r,i="value"in Zc?Zc.value:Zc.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===i[s-r];r++);return E_=i.slice(t,1<r?1-r:void 0)}function S_(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function yv(){return!0}function J6(){return!1}function $o(t){function e(n,r,i,s,l){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=l,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?yv:J6,this.isPropagationStopped=J6,this}return Jr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=yv)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=yv)},persist:function(){},isPersistent:yv}),e}var vp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},NR=$o(vp),$y=Jr({},vp,{view:0,detail:0}),kJ=$o($y),Xw,Zw,Rm,b1=Jr({},$y,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zR,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Rm&&(Rm&&t.type==="mousemove"?(Xw=t.screenX-Rm.screenX,Zw=t.screenY-Rm.screenY):Zw=Xw=0,Rm=t),Xw)},movementY:function(t){return"movementY"in t?t.movementY:Zw}}),Q6=$o(b1),OJ=Jr({},b1,{dataTransfer:0}),DJ=$o(OJ),FJ=Jr({},$y,{relatedTarget:0}),Yw=$o(FJ),NJ=Jr({},vp,{animationName:0,elapsedTime:0,pseudoElement:0}),zJ=$o(NJ),BJ=Jr({},vp,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),UJ=$o(BJ),VJ=Jr({},vp,{data:0}),e5=$o(VJ),jJ={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},GJ={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WJ={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HJ(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=WJ[t])?!!e[t]:!1}function zR(){return HJ}var qJ=Jr({},$y,{key:function(t){if(t.key){var e=jJ[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=S_(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?GJ[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zR,charCode:function(t){return t.type==="keypress"?S_(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?S_(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),KJ=$o(qJ),XJ=Jr({},b1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),t5=$o(XJ),ZJ=Jr({},$y,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zR}),YJ=$o(ZJ),JJ=Jr({},vp,{propertyName:0,elapsedTime:0,pseudoElement:0}),QJ=$o(JJ),eQ=Jr({},b1,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),tQ=$o(eQ),nQ=[9,13,27,32],BR=Jl&&"CompositionEvent"in window,Eg=null;Jl&&"documentMode"in document&&(Eg=document.documentMode);var rQ=Jl&&"TextEvent"in window&&!Eg,Yz=Jl&&(!BR||Eg&&8<Eg&&11>=Eg),n5=String.fromCharCode(32),r5=!1;function Jz(t,e){switch(t){case"keyup":return nQ.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qz(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var of=!1;function iQ(t,e){switch(t){case"compositionend":return Qz(e);case"keypress":return e.which!==32?null:(r5=!0,n5);case"textInput":return t=e.data,t===n5&&r5?null:t;default:return null}}function sQ(t,e){if(of)return t==="compositionend"||!BR&&Jz(t,e)?(t=Zz(),E_=FR=Zc=null,of=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Yz&&e.locale!=="ko"?null:e.data;default:return null}}var oQ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function i5(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!oQ[t.type]:e==="textarea"}function e9(t,e,n,r){Rz(r),e=ib(e,"onChange"),0<e.length&&(n=new NR("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Sg=null,Xg=null;function aQ(t){d9(t,0)}function x1(t){var e=cf(t);if(Ez(e))return t}function lQ(t,e){if(t==="change")return e}var t9=!1;if(Jl){var Jw;if(Jl){var Qw="oninput"in document;if(!Qw){var s5=document.createElement("div");s5.setAttribute("oninput","return;"),Qw=typeof s5.oninput=="function"}Jw=Qw}else Jw=!1;t9=Jw&&(!document.documentMode||9<document.documentMode)}function o5(){Sg&&(Sg.detachEvent("onpropertychange",n9),Xg=Sg=null)}function n9(t){if(t.propertyName==="value"&&x1(Xg)){var e=[];e9(e,Xg,t,MR(t)),Oz(aQ,e)}}function cQ(t,e,n){t==="focusin"?(o5(),Sg=e,Xg=n,Sg.attachEvent("onpropertychange",n9)):t==="focusout"&&o5()}function uQ(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return x1(Xg)}function dQ(t,e){if(t==="click")return x1(e)}function hQ(t,e){if(t==="input"||t==="change")return x1(e)}function fQ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ca=typeof Object.is=="function"?Object.is:fQ;function Zg(t,e){if(Ca(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!sE.call(e,i)||!Ca(t[i],e[i]))return!1}return!0}function a5(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function l5(t,e){var n=a5(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=a5(n)}}function r9(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?r9(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function i9(){for(var t=window,e=Y_();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Y_(t.document)}return e}function UR(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function pQ(t){var e=i9(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&r9(n.ownerDocument.documentElement,n)){if(r!==null&&UR(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=l5(n,s);var l=l5(n,r);i&&l&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mQ=Jl&&"documentMode"in document&&11>=document.documentMode,af=null,EE=null,Ag=null,SE=!1;function c5(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;SE||af==null||af!==Y_(r)||(r=af,"selectionStart"in r&&UR(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ag&&Zg(Ag,r)||(Ag=r,r=ib(EE,"onSelect"),0<r.length&&(e=new NR("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=af)))}function vv(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var lf={animationend:vv("Animation","AnimationEnd"),animationiteration:vv("Animation","AnimationIteration"),animationstart:vv("Animation","AnimationStart"),transitionend:vv("Transition","TransitionEnd")},e2={},s9={};Jl&&(s9=document.createElement("div").style,"AnimationEvent"in window||(delete lf.animationend.animation,delete lf.animationiteration.animation,delete lf.animationstart.animation),"TransitionEvent"in window||delete lf.transitionend.transition);function w1(t){if(e2[t])return e2[t];if(!lf[t])return t;var e=lf[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in s9)return e2[t]=e[n];return t}var o9=w1("animationend"),a9=w1("animationiteration"),l9=w1("animationstart"),c9=w1("transitionend"),u9=new Map,u5="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vu(t,e){u9.set(t,e),Xd(e,[t])}for(var t2=0;t2<u5.length;t2++){var n2=u5[t2],gQ=n2.toLowerCase(),yQ=n2[0].toUpperCase()+n2.slice(1);vu(gQ,"on"+yQ)}vu(o9,"onAnimationEnd");vu(a9,"onAnimationIteration");vu(l9,"onAnimationStart");vu("dblclick","onDoubleClick");vu("focusin","onFocus");vu("focusout","onBlur");vu(c9,"onTransitionEnd");Vf("onMouseEnter",["mouseout","mouseover"]);Vf("onMouseLeave",["mouseout","mouseover"]);Vf("onPointerEnter",["pointerout","pointerover"]);Vf("onPointerLeave",["pointerout","pointerover"]);Xd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xd("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ug="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(ug));function d5(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,gJ(r,e,void 0,t),t.currentTarget=null}function d9(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var l=r.length-1;0<=l;l--){var o=r[l],h=o.instance,p=o.currentTarget;if(o=o.listener,h!==s&&i.isPropagationStopped())break e;d5(i,o,p),s=h}else for(l=0;l<r.length;l++){if(o=r[l],h=o.instance,p=o.currentTarget,o=o.listener,h!==s&&i.isPropagationStopped())break e;d5(i,o,p),s=h}}}if(Q_)throw t=bE,Q_=!1,bE=null,t}function Rr(t,e){var n=e[IE];n===void 0&&(n=e[IE]=new Set);var r=t+"__bubble";n.has(r)||(h9(e,t,2,!1),n.add(r))}function r2(t,e,n){var r=0;e&&(r|=4),h9(n,t,r,e)}var _v="_reactListening"+Math.random().toString(36).slice(2);function Yg(t){if(!t[_v]){t[_v]=!0,_z.forEach(function(n){n!=="selectionchange"&&(vQ.has(n)||r2(n,!1,t),r2(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[_v]||(e[_v]=!0,r2("selectionchange",!1,e))}}function h9(t,e,n,r){switch(Xz(e)){case 1:var i=MJ;break;case 4:i=$J;break;default:i=DR}n=i.bind(null,e,n,t),i=void 0,!_E||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function i2(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(l===4)for(l=r.return;l!==null;){var h=l.tag;if((h===3||h===4)&&(h=l.stateNode.containerInfo,h===i||h.nodeType===8&&h.parentNode===i))return;l=l.return}for(;o!==null;){if(l=md(o),l===null)return;if(h=l.tag,h===5||h===6){r=s=l;continue e}o=o.parentNode}}r=r.return}Oz(function(){var p=s,b=MR(n),x=[];e:{var w=u9.get(t);if(w!==void 0){var A=NR,L=t;switch(t){case"keypress":if(S_(n)===0)break e;case"keydown":case"keyup":A=KJ;break;case"focusin":L="focus",A=Yw;break;case"focusout":L="blur",A=Yw;break;case"beforeblur":case"afterblur":A=Yw;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=Q6;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=DJ;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=YJ;break;case o9:case a9:case l9:A=zJ;break;case c9:A=QJ;break;case"scroll":A=kJ;break;case"wheel":A=tQ;break;case"copy":case"cut":case"paste":A=UJ;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=t5}var M=(e&4)!==0,U=!M&&t==="scroll",D=M?w!==null?w+"Capture":null:w;M=[];for(var $=p,N;$!==null;){N=$;var B=N.stateNode;if(N.tag===5&&B!==null&&(N=B,D!==null&&(B=Wg($,D),B!=null&&M.push(Jg($,B,N)))),U)break;$=$.return}0<M.length&&(w=new A(w,L,null,n,b),x.push({event:w,listeners:M}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",A=t==="mouseout"||t==="pointerout",w&&n!==yE&&(L=n.relatedTarget||n.fromElement)&&(md(L)||L[Ql]))break e;if((A||w)&&(w=b.window===b?b:(w=b.ownerDocument)?w.defaultView||w.parentWindow:window,A?(L=n.relatedTarget||n.toElement,A=p,L=L?md(L):null,L!==null&&(U=Zd(L),L!==U||L.tag!==5&&L.tag!==6)&&(L=null)):(A=null,L=p),A!==L)){if(M=Q6,B="onMouseLeave",D="onMouseEnter",$="mouse",(t==="pointerout"||t==="pointerover")&&(M=t5,B="onPointerLeave",D="onPointerEnter",$="pointer"),U=A==null?w:cf(A),N=L==null?w:cf(L),w=new M(B,$+"leave",A,n,b),w.target=U,w.relatedTarget=N,B=null,md(b)===p&&(M=new M(D,$+"enter",L,n,b),M.target=N,M.relatedTarget=U,B=M),U=B,A&&L)t:{for(M=A,D=L,$=0,N=M;N;N=Mh(N))$++;for(N=0,B=D;B;B=Mh(B))N++;for(;0<$-N;)M=Mh(M),$--;for(;0<N-$;)D=Mh(D),N--;for(;$--;){if(M===D||D!==null&&M===D.alternate)break t;M=Mh(M),D=Mh(D)}M=null}else M=null;A!==null&&h5(x,w,A,M,!1),L!==null&&U!==null&&h5(x,U,L,M,!0)}}e:{if(w=p?cf(p):window,A=w.nodeName&&w.nodeName.toLowerCase(),A==="select"||A==="input"&&w.type==="file")var Z=lQ;else if(i5(w))if(t9)Z=hQ;else{Z=uQ;var ie=cQ}else(A=w.nodeName)&&A.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&(Z=dQ);if(Z&&(Z=Z(t,p))){e9(x,Z,n,b);break e}ie&&ie(t,w,p),t==="focusout"&&(ie=w._wrapperState)&&ie.controlled&&w.type==="number"&&hE(w,"number",w.value)}switch(ie=p?cf(p):window,t){case"focusin":(i5(ie)||ie.contentEditable==="true")&&(af=ie,EE=p,Ag=null);break;case"focusout":Ag=EE=af=null;break;case"mousedown":SE=!0;break;case"contextmenu":case"mouseup":case"dragend":SE=!1,c5(x,n,b);break;case"selectionchange":if(mQ)break;case"keydown":case"keyup":c5(x,n,b)}var re;if(BR)e:{switch(t){case"compositionstart":var ve="onCompositionStart";break e;case"compositionend":ve="onCompositionEnd";break e;case"compositionupdate":ve="onCompositionUpdate";break e}ve=void 0}else of?Jz(t,n)&&(ve="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ve="onCompositionStart");ve&&(Yz&&n.locale!=="ko"&&(of||ve!=="onCompositionStart"?ve==="onCompositionEnd"&&of&&(re=Zz()):(Zc=b,FR="value"in Zc?Zc.value:Zc.textContent,of=!0)),ie=ib(p,ve),0<ie.length&&(ve=new e5(ve,t,null,n,b),x.push({event:ve,listeners:ie}),re?ve.data=re:(re=Qz(n),re!==null&&(ve.data=re)))),(re=rQ?iQ(t,n):sQ(t,n))&&(p=ib(p,"onBeforeInput"),0<p.length&&(b=new e5("onBeforeInput","beforeinput",null,n,b),x.push({event:b,listeners:p}),b.data=re))}d9(x,e)})}function Jg(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ib(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Wg(t,n),s!=null&&r.unshift(Jg(t,s,i)),s=Wg(t,e),s!=null&&r.push(Jg(t,s,i))),t=t.return}return r}function Mh(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function h5(t,e,n,r,i){for(var s=e._reactName,l=[];n!==null&&n!==r;){var o=n,h=o.alternate,p=o.stateNode;if(h!==null&&h===r)break;o.tag===5&&p!==null&&(o=p,i?(h=Wg(n,s),h!=null&&l.unshift(Jg(n,h,o))):i||(h=Wg(n,s),h!=null&&l.push(Jg(n,h,o)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var _Q=/\r\n?/g,bQ=/\u0000|\uFFFD/g;function f5(t){return(typeof t=="string"?t:""+t).replace(_Q,`
`).replace(bQ,"")}function bv(t,e,n){if(e=f5(e),f5(t)!==e&&n)throw Error(dt(425))}function sb(){}var AE=null,PE=null;function CE(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var LE=typeof setTimeout=="function"?setTimeout:void 0,xQ=typeof clearTimeout=="function"?clearTimeout:void 0,p5=typeof Promise=="function"?Promise:void 0,wQ=typeof queueMicrotask=="function"?queueMicrotask:typeof p5<"u"?function(t){return p5.resolve(null).then(t).catch(TQ)}:LE;function TQ(t){setTimeout(function(){throw t})}function s2(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Kg(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Kg(e)}function iu(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function m5(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var _p=Math.random().toString(36).slice(2),el="__reactFiber$"+_p,Qg="__reactProps$"+_p,Ql="__reactContainer$"+_p,IE="__reactEvents$"+_p,EQ="__reactListeners$"+_p,SQ="__reactHandles$"+_p;function md(t){var e=t[el];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ql]||n[el]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=m5(t);t!==null;){if(n=t[el])return n;t=m5(t)}return e}t=n,n=t.parentNode}return null}function ky(t){return t=t[el]||t[Ql],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function cf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(dt(33))}function T1(t){return t[Qg]||null}var RE=[],uf=-1;function _u(t){return{current:t}}function Fr(t){0>uf||(t.current=RE[uf],RE[uf]=null,uf--)}function Sr(t,e){uf++,RE[uf]=t.current,t.current=e}var gu={},_s=_u(gu),Qs=_u(!1),Pd=gu;function jf(t,e){var n=t.type.contextTypes;if(!n)return gu;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function eo(t){return t=t.childContextTypes,t!=null}function ob(){Fr(Qs),Fr(_s)}function g5(t,e,n){if(_s.current!==gu)throw Error(dt(168));Sr(_s,e),Sr(Qs,n)}function f9(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(dt(108,cJ(t)||"Unknown",i));return Jr({},n,r)}function ab(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gu,Pd=_s.current,Sr(_s,t),Sr(Qs,Qs.current),!0}function y5(t,e,n){var r=t.stateNode;if(!r)throw Error(dt(169));n?(t=f9(t,e,Pd),r.__reactInternalMemoizedMergedChildContext=t,Fr(Qs),Fr(_s),Sr(_s,t)):Fr(Qs),Sr(Qs,n)}var Bl=null,E1=!1,o2=!1;function p9(t){Bl===null?Bl=[t]:Bl.push(t)}function AQ(t){E1=!0,p9(t)}function bu(){if(!o2&&Bl!==null){o2=!0;var t=0,e=cr;try{var n=Bl;for(cr=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Bl=null,E1=!1}catch(i){throw Bl!==null&&(Bl=Bl.slice(t+1)),zz($R,bu),i}finally{cr=e,o2=!1}}return null}var df=[],hf=0,lb=null,cb=0,qo=[],Ko=0,Cd=null,Gl=1,Wl="";function ad(t,e){df[hf++]=cb,df[hf++]=lb,lb=t,cb=e}function m9(t,e,n){qo[Ko++]=Gl,qo[Ko++]=Wl,qo[Ko++]=Cd,Cd=t;var r=Gl;t=Wl;var i=32-Ea(r)-1;r&=~(1<<i),n+=1;var s=32-Ea(e)+i;if(30<s){var l=i-i%5;s=(r&(1<<l)-1).toString(32),r>>=l,i-=l,Gl=1<<32-Ea(e)+i|n<<i|r,Wl=s+t}else Gl=1<<s|n<<i|r,Wl=t}function VR(t){t.return!==null&&(ad(t,1),m9(t,1,0))}function jR(t){for(;t===lb;)lb=df[--hf],df[hf]=null,cb=df[--hf],df[hf]=null;for(;t===Cd;)Cd=qo[--Ko],qo[Ko]=null,Wl=qo[--Ko],qo[Ko]=null,Gl=qo[--Ko],qo[Ko]=null}var Po=null,So=null,Ur=!1,ya=null;function g9(t,e){var n=Zo(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function v5(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Po=t,So=iu(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Po=t,So=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Cd!==null?{id:Gl,overflow:Wl}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Zo(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Po=t,So=null,!0):!1;default:return!1}}function ME(t){return(t.mode&1)!==0&&(t.flags&128)===0}function $E(t){if(Ur){var e=So;if(e){var n=e;if(!v5(t,e)){if(ME(t))throw Error(dt(418));e=iu(n.nextSibling);var r=Po;e&&v5(t,e)?g9(r,n):(t.flags=t.flags&-4097|2,Ur=!1,Po=t)}}else{if(ME(t))throw Error(dt(418));t.flags=t.flags&-4097|2,Ur=!1,Po=t}}}function _5(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Po=t}function xv(t){if(t!==Po)return!1;if(!Ur)return _5(t),Ur=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!CE(t.type,t.memoizedProps)),e&&(e=So)){if(ME(t))throw y9(),Error(dt(418));for(;e;)g9(t,e),e=iu(e.nextSibling)}if(_5(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(dt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){So=iu(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}So=null}}else So=Po?iu(t.stateNode.nextSibling):null;return!0}function y9(){for(var t=So;t;)t=iu(t.nextSibling)}function Gf(){So=Po=null,Ur=!1}function GR(t){ya===null?ya=[t]:ya.push(t)}var PQ=sc.ReactCurrentBatchConfig;function fa(t,e){if(t&&t.defaultProps){e=Jr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var ub=_u(null),db=null,ff=null,WR=null;function HR(){WR=ff=db=null}function qR(t){var e=ub.current;Fr(ub),t._currentValue=e}function kE(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Cf(t,e){db=t,WR=ff=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Js=!0),t.firstContext=null)}function Qo(t){var e=t._currentValue;if(WR!==t)if(t={context:t,memoizedValue:e,next:null},ff===null){if(db===null)throw Error(dt(308));ff=t,db.dependencies={lanes:0,firstContext:t}}else ff=ff.next=t;return e}var gd=null;function KR(t){gd===null?gd=[t]:gd.push(t)}function v9(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,KR(e)):(n.next=i.next,i.next=n),e.interleaved=n,ec(t,r)}function ec(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var jc=!1;function XR(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _9(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Zl(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function su(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Yn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ec(t,n)}return i=r.interleaved,i===null?(e.next=e,KR(r)):(e.next=i.next,i.next=e),r.interleaved=e,ec(t,n)}function A_(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,kR(t,n)}}function b5(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=l:s=s.next=l,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function hb(t,e,n,r){var i=t.updateQueue;jc=!1;var s=i.firstBaseUpdate,l=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var h=o,p=h.next;h.next=null,l===null?s=p:l.next=p,l=h;var b=t.alternate;b!==null&&(b=b.updateQueue,o=b.lastBaseUpdate,o!==l&&(o===null?b.firstBaseUpdate=p:o.next=p,b.lastBaseUpdate=h))}if(s!==null){var x=i.baseState;l=0,b=p=h=null,o=s;do{var w=o.lane,A=o.eventTime;if((r&w)===w){b!==null&&(b=b.next={eventTime:A,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var L=t,M=o;switch(w=e,A=n,M.tag){case 1:if(L=M.payload,typeof L=="function"){x=L.call(A,x,w);break e}x=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=M.payload,w=typeof L=="function"?L.call(A,x,w):L,w==null)break e;x=Jr({},x,w);break e;case 2:jc=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,w=i.effects,w===null?i.effects=[o]:w.push(o))}else A={eventTime:A,lane:w,tag:o.tag,payload:o.payload,callback:o.callback,next:null},b===null?(p=b=A,h=x):b=b.next=A,l|=w;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;w=o,o=w.next,w.next=null,i.lastBaseUpdate=w,i.shared.pending=null}}while(1);if(b===null&&(h=x),i.baseState=h,i.firstBaseUpdate=p,i.lastBaseUpdate=b,e=i.shared.interleaved,e!==null){i=e;do l|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Id|=l,t.lanes=l,t.memoizedState=x}}function x5(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(dt(191,i));i.call(r)}}}var b9=new vz.Component().refs;function OE(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Jr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var S1={isMounted:function(t){return(t=t._reactInternals)?Zd(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=zs(),i=au(t),s=Zl(r,i);s.payload=e,n!=null&&(s.callback=n),e=su(t,s,i),e!==null&&(Sa(e,t,i,r),A_(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=zs(),i=au(t),s=Zl(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=su(t,s,i),e!==null&&(Sa(e,t,i,r),A_(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=zs(),r=au(t),i=Zl(n,r);i.tag=2,e!=null&&(i.callback=e),e=su(t,i,r),e!==null&&(Sa(e,t,r,n),A_(e,t,r))}};function w5(t,e,n,r,i,s,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,l):e.prototype&&e.prototype.isPureReactComponent?!Zg(n,r)||!Zg(i,s):!0}function x9(t,e,n){var r=!1,i=gu,s=e.contextType;return typeof s=="object"&&s!==null?s=Qo(s):(i=eo(e)?Pd:_s.current,r=e.contextTypes,s=(r=r!=null)?jf(t,i):gu),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=S1,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function T5(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&S1.enqueueReplaceState(e,e.state,null)}function DE(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=b9,XR(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Qo(s):(s=eo(e)?Pd:_s.current,i.context=jf(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(OE(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&S1.enqueueReplaceState(i,i.state,null),hb(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Mm(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(dt(309));var r=n.stateNode}if(!r)throw Error(dt(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(l){var o=i.refs;o===b9&&(o=i.refs={}),l===null?delete o[s]:o[s]=l},e._stringRef=s,e)}if(typeof t!="string")throw Error(dt(284));if(!n._owner)throw Error(dt(290,t))}return t}function wv(t,e){throw t=Object.prototype.toString.call(e),Error(dt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function E5(t){var e=t._init;return e(t._payload)}function w9(t){function e(D,$){if(t){var N=D.deletions;N===null?(D.deletions=[$],D.flags|=16):N.push($)}}function n(D,$){if(!t)return null;for(;$!==null;)e(D,$),$=$.sibling;return null}function r(D,$){for(D=new Map;$!==null;)$.key!==null?D.set($.key,$):D.set($.index,$),$=$.sibling;return D}function i(D,$){return D=lu(D,$),D.index=0,D.sibling=null,D}function s(D,$,N){return D.index=N,t?(N=D.alternate,N!==null?(N=N.index,N<$?(D.flags|=2,$):N):(D.flags|=2,$)):(D.flags|=1048576,$)}function l(D){return t&&D.alternate===null&&(D.flags|=2),D}function o(D,$,N,B){return $===null||$.tag!==6?($=f2(N,D.mode,B),$.return=D,$):($=i($,N),$.return=D,$)}function h(D,$,N,B){var Z=N.type;return Z===sf?b(D,$,N.props.children,B,N.key):$!==null&&($.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===Vc&&E5(Z)===$.type)?(B=i($,N.props),B.ref=Mm(D,$,N),B.return=D,B):(B=M_(N.type,N.key,N.props,null,D.mode,B),B.ref=Mm(D,$,N),B.return=D,B)}function p(D,$,N,B){return $===null||$.tag!==4||$.stateNode.containerInfo!==N.containerInfo||$.stateNode.implementation!==N.implementation?($=p2(N,D.mode,B),$.return=D,$):($=i($,N.children||[]),$.return=D,$)}function b(D,$,N,B,Z){return $===null||$.tag!==7?($=wd(N,D.mode,B,Z),$.return=D,$):($=i($,N),$.return=D,$)}function x(D,$,N){if(typeof $=="string"&&$!==""||typeof $=="number")return $=f2(""+$,D.mode,N),$.return=D,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case dv:return N=M_($.type,$.key,$.props,null,D.mode,N),N.ref=Mm(D,null,$),N.return=D,N;case rf:return $=p2($,D.mode,N),$.return=D,$;case Vc:var B=$._init;return x(D,B($._payload),N)}if(lg($)||Pm($))return $=wd($,D.mode,N,null),$.return=D,$;wv(D,$)}return null}function w(D,$,N,B){var Z=$!==null?$.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return Z!==null?null:o(D,$,""+N,B);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case dv:return N.key===Z?h(D,$,N,B):null;case rf:return N.key===Z?p(D,$,N,B):null;case Vc:return Z=N._init,w(D,$,Z(N._payload),B)}if(lg(N)||Pm(N))return Z!==null?null:b(D,$,N,B,null);wv(D,N)}return null}function A(D,$,N,B,Z){if(typeof B=="string"&&B!==""||typeof B=="number")return D=D.get(N)||null,o($,D,""+B,Z);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case dv:return D=D.get(B.key===null?N:B.key)||null,h($,D,B,Z);case rf:return D=D.get(B.key===null?N:B.key)||null,p($,D,B,Z);case Vc:var ie=B._init;return A(D,$,N,ie(B._payload),Z)}if(lg(B)||Pm(B))return D=D.get(N)||null,b($,D,B,Z,null);wv($,B)}return null}function L(D,$,N,B){for(var Z=null,ie=null,re=$,ve=$=0,Te=null;re!==null&&ve<N.length;ve++){re.index>ve?(Te=re,re=null):Te=re.sibling;var Ae=w(D,re,N[ve],B);if(Ae===null){re===null&&(re=Te);break}t&&re&&Ae.alternate===null&&e(D,re),$=s(Ae,$,ve),ie===null?Z=Ae:ie.sibling=Ae,ie=Ae,re=Te}if(ve===N.length)return n(D,re),Ur&&ad(D,ve),Z;if(re===null){for(;ve<N.length;ve++)re=x(D,N[ve],B),re!==null&&($=s(re,$,ve),ie===null?Z=re:ie.sibling=re,ie=re);return Ur&&ad(D,ve),Z}for(re=r(D,re);ve<N.length;ve++)Te=A(re,D,ve,N[ve],B),Te!==null&&(t&&Te.alternate!==null&&re.delete(Te.key===null?ve:Te.key),$=s(Te,$,ve),ie===null?Z=Te:ie.sibling=Te,ie=Te);return t&&re.forEach(function(fe){return e(D,fe)}),Ur&&ad(D,ve),Z}function M(D,$,N,B){var Z=Pm(N);if(typeof Z!="function")throw Error(dt(150));if(N=Z.call(N),N==null)throw Error(dt(151));for(var ie=Z=null,re=$,ve=$=0,Te=null,Ae=N.next();re!==null&&!Ae.done;ve++,Ae=N.next()){re.index>ve?(Te=re,re=null):Te=re.sibling;var fe=w(D,re,Ae.value,B);if(fe===null){re===null&&(re=Te);break}t&&re&&fe.alternate===null&&e(D,re),$=s(fe,$,ve),ie===null?Z=fe:ie.sibling=fe,ie=fe,re=Te}if(Ae.done)return n(D,re),Ur&&ad(D,ve),Z;if(re===null){for(;!Ae.done;ve++,Ae=N.next())Ae=x(D,Ae.value,B),Ae!==null&&($=s(Ae,$,ve),ie===null?Z=Ae:ie.sibling=Ae,ie=Ae);return Ur&&ad(D,ve),Z}for(re=r(D,re);!Ae.done;ve++,Ae=N.next())Ae=A(re,D,ve,Ae.value,B),Ae!==null&&(t&&Ae.alternate!==null&&re.delete(Ae.key===null?ve:Ae.key),$=s(Ae,$,ve),ie===null?Z=Ae:ie.sibling=Ae,ie=Ae);return t&&re.forEach(function(Pe){return e(D,Pe)}),Ur&&ad(D,ve),Z}function U(D,$,N,B){if(typeof N=="object"&&N!==null&&N.type===sf&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case dv:e:{for(var Z=N.key,ie=$;ie!==null;){if(ie.key===Z){if(Z=N.type,Z===sf){if(ie.tag===7){n(D,ie.sibling),$=i(ie,N.props.children),$.return=D,D=$;break e}}else if(ie.elementType===Z||typeof Z=="object"&&Z!==null&&Z.$$typeof===Vc&&E5(Z)===ie.type){n(D,ie.sibling),$=i(ie,N.props),$.ref=Mm(D,ie,N),$.return=D,D=$;break e}n(D,ie);break}else e(D,ie);ie=ie.sibling}N.type===sf?($=wd(N.props.children,D.mode,B,N.key),$.return=D,D=$):(B=M_(N.type,N.key,N.props,null,D.mode,B),B.ref=Mm(D,$,N),B.return=D,D=B)}return l(D);case rf:e:{for(ie=N.key;$!==null;){if($.key===ie)if($.tag===4&&$.stateNode.containerInfo===N.containerInfo&&$.stateNode.implementation===N.implementation){n(D,$.sibling),$=i($,N.children||[]),$.return=D,D=$;break e}else{n(D,$);break}else e(D,$);$=$.sibling}$=p2(N,D.mode,B),$.return=D,D=$}return l(D);case Vc:return ie=N._init,U(D,$,ie(N._payload),B)}if(lg(N))return L(D,$,N,B);if(Pm(N))return M(D,$,N,B);wv(D,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,$!==null&&$.tag===6?(n(D,$.sibling),$=i($,N),$.return=D,D=$):(n(D,$),$=f2(N,D.mode,B),$.return=D,D=$),l(D)):n(D,$)}return U}var Wf=w9(!0),T9=w9(!1),Oy={},al=_u(Oy),ey=_u(Oy),ty=_u(Oy);function yd(t){if(t===Oy)throw Error(dt(174));return t}function ZR(t,e){switch(Sr(ty,e),Sr(ey,t),Sr(al,Oy),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:pE(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=pE(e,t)}Fr(al),Sr(al,e)}function Hf(){Fr(al),Fr(ey),Fr(ty)}function E9(t){yd(ty.current);var e=yd(al.current),n=pE(e,t.type);e!==n&&(Sr(ey,t),Sr(al,n))}function YR(t){ey.current===t&&(Fr(al),Fr(ey))}var qr=_u(0);function fb(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var a2=[];function JR(){for(var t=0;t<a2.length;t++)a2[t]._workInProgressVersionPrimary=null;a2.length=0}var P_=sc.ReactCurrentDispatcher,l2=sc.ReactCurrentBatchConfig,Ld=0,Zr=null,ki=null,Ui=null,pb=!1,Pg=!1,ny=0,CQ=0;function hs(){throw Error(dt(321))}function QR(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ca(t[n],e[n]))return!1;return!0}function eM(t,e,n,r,i,s){if(Ld=s,Zr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,P_.current=t===null||t.memoizedState===null?MQ:$Q,t=n(r,i),Pg){s=0;do{if(Pg=!1,ny=0,25<=s)throw Error(dt(301));s+=1,Ui=ki=null,e.updateQueue=null,P_.current=kQ,t=n(r,i)}while(Pg)}if(P_.current=mb,e=ki!==null&&ki.next!==null,Ld=0,Ui=ki=Zr=null,pb=!1,e)throw Error(dt(300));return t}function tM(){var t=ny!==0;return ny=0,t}function Ya(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ui===null?Zr.memoizedState=Ui=t:Ui=Ui.next=t,Ui}function ea(){if(ki===null){var t=Zr.alternate;t=t!==null?t.memoizedState:null}else t=ki.next;var e=Ui===null?Zr.memoizedState:Ui.next;if(e!==null)Ui=e,ki=t;else{if(t===null)throw Error(dt(310));ki=t,t={memoizedState:ki.memoizedState,baseState:ki.baseState,baseQueue:ki.baseQueue,queue:ki.queue,next:null},Ui===null?Zr.memoizedState=Ui=t:Ui=Ui.next=t}return Ui}function ry(t,e){return typeof e=="function"?e(t):e}function c2(t){var e=ea(),n=e.queue;if(n===null)throw Error(dt(311));n.lastRenderedReducer=t;var r=ki,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var l=i.next;i.next=s.next,s.next=l}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=l=null,h=null,p=s;do{var b=p.lane;if((Ld&b)===b)h!==null&&(h=h.next={lane:0,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null}),r=p.hasEagerState?p.eagerState:t(r,p.action);else{var x={lane:b,action:p.action,hasEagerState:p.hasEagerState,eagerState:p.eagerState,next:null};h===null?(o=h=x,l=r):h=h.next=x,Zr.lanes|=b,Id|=b}p=p.next}while(p!==null&&p!==s);h===null?l=r:h.next=o,Ca(r,e.memoizedState)||(Js=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=h,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Zr.lanes|=s,Id|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function u2(t){var e=ea(),n=e.queue;if(n===null)throw Error(dt(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var l=i=i.next;do s=t(s,l.action),l=l.next;while(l!==i);Ca(s,e.memoizedState)||(Js=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function S9(){}function A9(t,e){var n=Zr,r=ea(),i=e(),s=!Ca(r.memoizedState,i);if(s&&(r.memoizedState=i,Js=!0),r=r.queue,nM(L9.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ui!==null&&Ui.memoizedState.tag&1){if(n.flags|=2048,iy(9,C9.bind(null,n,r,i,e),void 0,null),Wi===null)throw Error(dt(349));Ld&30||P9(n,e,i)}return i}function P9(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Zr.updateQueue,e===null?(e={lastEffect:null,stores:null},Zr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function C9(t,e,n,r){e.value=n,e.getSnapshot=r,I9(e)&&R9(t)}function L9(t,e,n){return n(function(){I9(e)&&R9(t)})}function I9(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ca(t,n)}catch{return!0}}function R9(t){var e=ec(t,1);e!==null&&Sa(e,t,1,-1)}function S5(t){var e=Ya();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ry,lastRenderedState:t},e.queue=t,t=t.dispatch=RQ.bind(null,Zr,t),[e.memoizedState,t]}function iy(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Zr.updateQueue,e===null?(e={lastEffect:null,stores:null},Zr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function M9(){return ea().memoizedState}function C_(t,e,n,r){var i=Ya();Zr.flags|=t,i.memoizedState=iy(1|e,n,void 0,r===void 0?null:r)}function A1(t,e,n,r){var i=ea();r=r===void 0?null:r;var s=void 0;if(ki!==null){var l=ki.memoizedState;if(s=l.destroy,r!==null&&QR(r,l.deps)){i.memoizedState=iy(e,n,s,r);return}}Zr.flags|=t,i.memoizedState=iy(1|e,n,s,r)}function A5(t,e){return C_(8390656,8,t,e)}function nM(t,e){return A1(2048,8,t,e)}function $9(t,e){return A1(4,2,t,e)}function k9(t,e){return A1(4,4,t,e)}function O9(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function D9(t,e,n){return n=n!=null?n.concat([t]):null,A1(4,4,O9.bind(null,e,t),n)}function rM(){}function F9(t,e){var n=ea();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&QR(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function N9(t,e){var n=ea();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&QR(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function z9(t,e,n){return Ld&21?(Ca(n,e)||(n=Vz(),Zr.lanes|=n,Id|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Js=!0),t.memoizedState=n)}function LQ(t,e){var n=cr;cr=n!==0&&4>n?n:4,t(!0);var r=l2.transition;l2.transition={};try{t(!1),e()}finally{cr=n,l2.transition=r}}function B9(){return ea().memoizedState}function IQ(t,e,n){var r=au(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},U9(t))V9(e,n);else if(n=v9(t,e,n,r),n!==null){var i=zs();Sa(n,t,r,i),j9(n,e,r)}}function RQ(t,e,n){var r=au(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(U9(t))V9(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var l=e.lastRenderedState,o=s(l,n);if(i.hasEagerState=!0,i.eagerState=o,Ca(o,l)){var h=e.interleaved;h===null?(i.next=i,KR(e)):(i.next=h.next,h.next=i),e.interleaved=i;return}}catch{}finally{}n=v9(t,e,i,r),n!==null&&(i=zs(),Sa(n,t,r,i),j9(n,e,r))}}function U9(t){var e=t.alternate;return t===Zr||e!==null&&e===Zr}function V9(t,e){Pg=pb=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function j9(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,kR(t,n)}}var mb={readContext:Qo,useCallback:hs,useContext:hs,useEffect:hs,useImperativeHandle:hs,useInsertionEffect:hs,useLayoutEffect:hs,useMemo:hs,useReducer:hs,useRef:hs,useState:hs,useDebugValue:hs,useDeferredValue:hs,useTransition:hs,useMutableSource:hs,useSyncExternalStore:hs,useId:hs,unstable_isNewReconciler:!1},MQ={readContext:Qo,useCallback:function(t,e){return Ya().memoizedState=[t,e===void 0?null:e],t},useContext:Qo,useEffect:A5,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,C_(4194308,4,O9.bind(null,e,t),n)},useLayoutEffect:function(t,e){return C_(4194308,4,t,e)},useInsertionEffect:function(t,e){return C_(4,2,t,e)},useMemo:function(t,e){var n=Ya();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ya();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=IQ.bind(null,Zr,t),[r.memoizedState,t]},useRef:function(t){var e=Ya();return t={current:t},e.memoizedState=t},useState:S5,useDebugValue:rM,useDeferredValue:function(t){return Ya().memoizedState=t},useTransition:function(){var t=S5(!1),e=t[0];return t=LQ.bind(null,t[1]),Ya().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Zr,i=Ya();if(Ur){if(n===void 0)throw Error(dt(407));n=n()}else{if(n=e(),Wi===null)throw Error(dt(349));Ld&30||P9(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,A5(L9.bind(null,r,s,t),[t]),r.flags|=2048,iy(9,C9.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Ya(),e=Wi.identifierPrefix;if(Ur){var n=Wl,r=Gl;n=(r&~(1<<32-Ea(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ny++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=CQ++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},$Q={readContext:Qo,useCallback:F9,useContext:Qo,useEffect:nM,useImperativeHandle:D9,useInsertionEffect:$9,useLayoutEffect:k9,useMemo:N9,useReducer:c2,useRef:M9,useState:function(){return c2(ry)},useDebugValue:rM,useDeferredValue:function(t){var e=ea();return z9(e,ki.memoizedState,t)},useTransition:function(){var t=c2(ry)[0],e=ea().memoizedState;return[t,e]},useMutableSource:S9,useSyncExternalStore:A9,useId:B9,unstable_isNewReconciler:!1},kQ={readContext:Qo,useCallback:F9,useContext:Qo,useEffect:nM,useImperativeHandle:D9,useInsertionEffect:$9,useLayoutEffect:k9,useMemo:N9,useReducer:u2,useRef:M9,useState:function(){return u2(ry)},useDebugValue:rM,useDeferredValue:function(t){var e=ea();return ki===null?e.memoizedState=t:z9(e,ki.memoizedState,t)},useTransition:function(){var t=u2(ry)[0],e=ea().memoizedState;return[t,e]},useMutableSource:S9,useSyncExternalStore:A9,useId:B9,unstable_isNewReconciler:!1};function qf(t,e){try{var n="",r=e;do n+=lJ(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function d2(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function FE(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var OQ=typeof WeakMap=="function"?WeakMap:Map;function G9(t,e,n){n=Zl(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){yb||(yb=!0,qE=r),FE(t,e)},n}function W9(t,e,n){n=Zl(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){FE(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){FE(t,e),typeof r!="function"&&(ou===null?ou=new Set([this]):ou.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function P5(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new OQ;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=XQ.bind(null,t,e,n),e.then(t,t))}function C5(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function L5(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Zl(-1,1),e.tag=2,su(n,e,1))),n.lanes|=1),t)}var DQ=sc.ReactCurrentOwner,Js=!1;function Ms(t,e,n,r){e.child=t===null?T9(e,null,n,r):Wf(e,t.child,n,r)}function I5(t,e,n,r,i){n=n.render;var s=e.ref;return Cf(e,i),r=eM(t,e,n,r,s,i),n=tM(),t!==null&&!Js?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,tc(t,e,i)):(Ur&&n&&VR(e),e.flags|=1,Ms(t,e,r,i),e.child)}function R5(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!dM(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,H9(t,e,s,r,i)):(t=M_(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var l=s.memoizedProps;if(n=n.compare,n=n!==null?n:Zg,n(l,r)&&t.ref===e.ref)return tc(t,e,i)}return e.flags|=1,t=lu(s,r),t.ref=e.ref,t.return=e,e.child=t}function H9(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Zg(s,r)&&t.ref===e.ref)if(Js=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Js=!0);else return e.lanes=t.lanes,tc(t,e,i)}return NE(t,e,n,r,i)}function q9(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sr(mf,bo),bo|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Sr(mf,bo),bo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Sr(mf,bo),bo|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Sr(mf,bo),bo|=r;return Ms(t,e,i,n),e.child}function K9(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function NE(t,e,n,r,i){var s=eo(n)?Pd:_s.current;return s=jf(e,s),Cf(e,i),n=eM(t,e,n,r,s,i),r=tM(),t!==null&&!Js?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,tc(t,e,i)):(Ur&&r&&VR(e),e.flags|=1,Ms(t,e,n,i),e.child)}function M5(t,e,n,r,i){if(eo(n)){var s=!0;ab(e)}else s=!1;if(Cf(e,i),e.stateNode===null)L_(t,e),x9(e,n,r),DE(e,n,r,i),r=!0;else if(t===null){var l=e.stateNode,o=e.memoizedProps;l.props=o;var h=l.context,p=n.contextType;typeof p=="object"&&p!==null?p=Qo(p):(p=eo(n)?Pd:_s.current,p=jf(e,p));var b=n.getDerivedStateFromProps,x=typeof b=="function"||typeof l.getSnapshotBeforeUpdate=="function";x||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==r||h!==p)&&T5(e,l,r,p),jc=!1;var w=e.memoizedState;l.state=w,hb(e,r,l,i),h=e.memoizedState,o!==r||w!==h||Qs.current||jc?(typeof b=="function"&&(OE(e,n,b,r),h=e.memoizedState),(o=jc||w5(e,n,o,r,w,h,p))?(x||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=h),l.props=r,l.state=h,l.context=p,r=o):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,_9(t,e),o=e.memoizedProps,p=e.type===e.elementType?o:fa(e.type,o),l.props=p,x=e.pendingProps,w=l.context,h=n.contextType,typeof h=="object"&&h!==null?h=Qo(h):(h=eo(n)?Pd:_s.current,h=jf(e,h));var A=n.getDerivedStateFromProps;(b=typeof A=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(o!==x||w!==h)&&T5(e,l,r,h),jc=!1,w=e.memoizedState,l.state=w,hb(e,r,l,i);var L=e.memoizedState;o!==x||w!==L||Qs.current||jc?(typeof A=="function"&&(OE(e,n,A,r),L=e.memoizedState),(p=jc||w5(e,n,p,r,w,L,h)||!1)?(b||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,L,h),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,L,h)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||o===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=L),l.props=r,l.state=L,l.context=h,r=p):(typeof l.componentDidUpdate!="function"||o===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),r=!1)}return zE(t,e,n,r,s,i)}function zE(t,e,n,r,i,s){K9(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return i&&y5(e,n,!1),tc(t,e,s);r=e.stateNode,DQ.current=e;var o=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=Wf(e,t.child,null,s),e.child=Wf(e,null,o,s)):Ms(t,e,o,s),e.memoizedState=r.state,i&&y5(e,n,!0),e.child}function X9(t){var e=t.stateNode;e.pendingContext?g5(t,e.pendingContext,e.pendingContext!==e.context):e.context&&g5(t,e.context,!1),ZR(t,e.containerInfo)}function $5(t,e,n,r,i){return Gf(),GR(i),e.flags|=256,Ms(t,e,n,r),e.child}var BE={dehydrated:null,treeContext:null,retryLane:0};function UE(t){return{baseLanes:t,cachePool:null,transitions:null}}function Z9(t,e,n){var r=e.pendingProps,i=qr.current,s=!1,l=(e.flags&128)!==0,o;if((o=l)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Sr(qr,i&1),t===null)return $E(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,s?(r=e.mode,s=e.child,l={mode:"hidden",children:l},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=l):s=L1(l,r,0,null),t=wd(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=UE(n),e.memoizedState=BE,t):iM(e,l));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return FQ(t,e,l,r,o,i,n);if(s){s=r.fallback,l=e.mode,i=t.child,o=i.sibling;var h={mode:"hidden",children:r.children};return!(l&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=h,e.deletions=null):(r=lu(i,h),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=lu(o,s):(s=wd(s,l,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,l=t.child.memoizedState,l=l===null?UE(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=t.childLanes&~n,e.memoizedState=BE,r}return s=t.child,t=s.sibling,r=lu(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function iM(t,e){return e=L1({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Tv(t,e,n,r){return r!==null&&GR(r),Wf(e,t.child,null,n),t=iM(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function FQ(t,e,n,r,i,s,l){if(n)return e.flags&256?(e.flags&=-257,r=d2(Error(dt(422))),Tv(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=L1({mode:"visible",children:r.children},i,0,null),s=wd(s,i,l,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Wf(e,t.child,null,l),e.child.memoizedState=UE(l),e.memoizedState=BE,s);if(!(e.mode&1))return Tv(t,e,l,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(dt(419)),r=d2(s,r,void 0),Tv(t,e,l,r)}if(o=(l&t.childLanes)!==0,Js||o){if(r=Wi,r!==null){switch(l&-l){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|l)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ec(t,i),Sa(r,t,i,-1))}return uM(),r=d2(Error(dt(421))),Tv(t,e,l,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=ZQ.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,So=iu(i.nextSibling),Po=e,Ur=!0,ya=null,t!==null&&(qo[Ko++]=Gl,qo[Ko++]=Wl,qo[Ko++]=Cd,Gl=t.id,Wl=t.overflow,Cd=e),e=iM(e,r.children),e.flags|=4096,e)}function k5(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),kE(t.return,e,n)}function h2(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Y9(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Ms(t,e,r.children,n),r=qr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&k5(t,n,e);else if(t.tag===19)k5(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Sr(qr,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&fb(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),h2(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&fb(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}h2(e,!0,n,null,s);break;case"together":h2(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function L_(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function tc(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Id|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(dt(153));if(e.child!==null){for(t=e.child,n=lu(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=lu(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function NQ(t,e,n){switch(e.tag){case 3:X9(e),Gf();break;case 5:E9(e);break;case 1:eo(e.type)&&ab(e);break;case 4:ZR(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Sr(ub,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Sr(qr,qr.current&1),e.flags|=128,null):n&e.child.childLanes?Z9(t,e,n):(Sr(qr,qr.current&1),t=tc(t,e,n),t!==null?t.sibling:null);Sr(qr,qr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Y9(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Sr(qr,qr.current),r)break;return null;case 22:case 23:return e.lanes=0,q9(t,e,n)}return tc(t,e,n)}var J9,VE,Q9,e7;J9=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};VE=function(){};Q9=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,yd(al.current);var s=null;switch(n){case"input":i=uE(t,i),r=uE(t,r),s=[];break;case"select":i=Jr({},i,{value:void 0}),r=Jr({},r,{value:void 0}),s=[];break;case"textarea":i=fE(t,i),r=fE(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=sb)}mE(n,r);var l;n=null;for(p in i)if(!r.hasOwnProperty(p)&&i.hasOwnProperty(p)&&i[p]!=null)if(p==="style"){var o=i[p];for(l in o)o.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else p!=="dangerouslySetInnerHTML"&&p!=="children"&&p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&p!=="autoFocus"&&(jg.hasOwnProperty(p)?s||(s=[]):(s=s||[]).push(p,null));for(p in r){var h=r[p];if(o=i!=null?i[p]:void 0,r.hasOwnProperty(p)&&h!==o&&(h!=null||o!=null))if(p==="style")if(o){for(l in o)!o.hasOwnProperty(l)||h&&h.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in h)h.hasOwnProperty(l)&&o[l]!==h[l]&&(n||(n={}),n[l]=h[l])}else n||(s||(s=[]),s.push(p,n)),n=h;else p==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,o=o?o.__html:void 0,h!=null&&o!==h&&(s=s||[]).push(p,h)):p==="children"?typeof h!="string"&&typeof h!="number"||(s=s||[]).push(p,""+h):p!=="suppressContentEditableWarning"&&p!=="suppressHydrationWarning"&&(jg.hasOwnProperty(p)?(h!=null&&p==="onScroll"&&Rr("scroll",t),s||o===h||(s=[])):(s=s||[]).push(p,h))}n&&(s=s||[]).push("style",n);var p=s;(e.updateQueue=p)&&(e.flags|=4)}};e7=function(t,e,n,r){n!==r&&(e.flags|=4)};function $m(t,e){if(!Ur)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function fs(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function zQ(t,e,n){var r=e.pendingProps;switch(jR(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fs(e),null;case 1:return eo(e.type)&&ob(),fs(e),null;case 3:return r=e.stateNode,Hf(),Fr(Qs),Fr(_s),JR(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(xv(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ya!==null&&(ZE(ya),ya=null))),VE(t,e),fs(e),null;case 5:YR(e);var i=yd(ty.current);if(n=e.type,t!==null&&e.stateNode!=null)Q9(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(dt(166));return fs(e),null}if(t=yd(al.current),xv(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[el]=e,r[Qg]=s,t=(e.mode&1)!==0,n){case"dialog":Rr("cancel",r),Rr("close",r);break;case"iframe":case"object":case"embed":Rr("load",r);break;case"video":case"audio":for(i=0;i<ug.length;i++)Rr(ug[i],r);break;case"source":Rr("error",r);break;case"img":case"image":case"link":Rr("error",r),Rr("load",r);break;case"details":Rr("toggle",r);break;case"input":j6(r,s),Rr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Rr("invalid",r);break;case"textarea":W6(r,s),Rr("invalid",r)}mE(n,s),i=null;for(var l in s)if(s.hasOwnProperty(l)){var o=s[l];l==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&bv(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&bv(r.textContent,o,t),i=["children",""+o]):jg.hasOwnProperty(l)&&o!=null&&l==="onScroll"&&Rr("scroll",r)}switch(n){case"input":hv(r),G6(r,s,!0);break;case"textarea":hv(r),H6(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=sb)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Pz(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[el]=e,t[Qg]=r,J9(t,e,!1,!1),e.stateNode=t;e:{switch(l=gE(n,r),n){case"dialog":Rr("cancel",t),Rr("close",t),i=r;break;case"iframe":case"object":case"embed":Rr("load",t),i=r;break;case"video":case"audio":for(i=0;i<ug.length;i++)Rr(ug[i],t);i=r;break;case"source":Rr("error",t),i=r;break;case"img":case"image":case"link":Rr("error",t),Rr("load",t),i=r;break;case"details":Rr("toggle",t),i=r;break;case"input":j6(t,r),i=uE(t,r),Rr("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Jr({},r,{value:void 0}),Rr("invalid",t);break;case"textarea":W6(t,r),i=fE(t,r),Rr("invalid",t);break;default:i=r}mE(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var h=o[s];s==="style"?Iz(t,h):s==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&Cz(t,h)):s==="children"?typeof h=="string"?(n!=="textarea"||h!=="")&&Gg(t,h):typeof h=="number"&&Gg(t,""+h):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(jg.hasOwnProperty(s)?h!=null&&s==="onScroll"&&Rr("scroll",t):h!=null&&CR(t,s,h,l))}switch(n){case"input":hv(t),G6(t,r,!1);break;case"textarea":hv(t),H6(t);break;case"option":r.value!=null&&t.setAttribute("value",""+mu(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Ef(t,!!r.multiple,s,!1):r.defaultValue!=null&&Ef(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=sb)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return fs(e),null;case 6:if(t&&e.stateNode!=null)e7(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(dt(166));if(n=yd(ty.current),yd(al.current),xv(e)){if(r=e.stateNode,n=e.memoizedProps,r[el]=e,(s=r.nodeValue!==n)&&(t=Po,t!==null))switch(t.tag){case 3:bv(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&bv(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[el]=e,e.stateNode=r}return fs(e),null;case 13:if(Fr(qr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ur&&So!==null&&e.mode&1&&!(e.flags&128))y9(),Gf(),e.flags|=98560,s=!1;else if(s=xv(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(dt(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(dt(317));s[el]=e}else Gf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;fs(e),s=!1}else ya!==null&&(ZE(ya),ya=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||qr.current&1?Oi===0&&(Oi=3):uM())),e.updateQueue!==null&&(e.flags|=4),fs(e),null);case 4:return Hf(),VE(t,e),t===null&&Yg(e.stateNode.containerInfo),fs(e),null;case 10:return qR(e.type._context),fs(e),null;case 17:return eo(e.type)&&ob(),fs(e),null;case 19:if(Fr(qr),s=e.memoizedState,s===null)return fs(e),null;if(r=(e.flags&128)!==0,l=s.rendering,l===null)if(r)$m(s,!1);else{if(Oi!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=fb(t),l!==null){for(e.flags|=128,$m(s,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,l=s.alternate,l===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Sr(qr,qr.current&1|2),e.child}t=t.sibling}s.tail!==null&&pi()>Kf&&(e.flags|=128,r=!0,$m(s,!1),e.lanes=4194304)}else{if(!r)if(t=fb(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),$m(s,!0),s.tail===null&&s.tailMode==="hidden"&&!l.alternate&&!Ur)return fs(e),null}else 2*pi()-s.renderingStartTime>Kf&&n!==1073741824&&(e.flags|=128,r=!0,$m(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(n=s.last,n!==null?n.sibling=l:e.child=l,s.last=l)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=pi(),e.sibling=null,n=qr.current,Sr(qr,r?n&1|2:n&1),e):(fs(e),null);case 22:case 23:return cM(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?bo&1073741824&&(fs(e),e.subtreeFlags&6&&(e.flags|=8192)):fs(e),null;case 24:return null;case 25:return null}throw Error(dt(156,e.tag))}function BQ(t,e){switch(jR(e),e.tag){case 1:return eo(e.type)&&ob(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Hf(),Fr(Qs),Fr(_s),JR(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return YR(e),null;case 13:if(Fr(qr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(dt(340));Gf()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Fr(qr),null;case 4:return Hf(),null;case 10:return qR(e.type._context),null;case 22:case 23:return cM(),null;case 24:return null;default:return null}}var Ev=!1,ys=!1,UQ=typeof WeakSet=="function"?WeakSet:Set,Ut=null;function pf(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){oi(t,e,r)}else n.current=null}function jE(t,e,n){try{n()}catch(r){oi(t,e,r)}}var O5=!1;function VQ(t,e){if(AE=nb,t=i9(),UR(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var l=0,o=-1,h=-1,p=0,b=0,x=t,w=null;t:for(;;){for(var A;x!==n||i!==0&&x.nodeType!==3||(o=l+i),x!==s||r!==0&&x.nodeType!==3||(h=l+r),x.nodeType===3&&(l+=x.nodeValue.length),(A=x.firstChild)!==null;)w=x,x=A;for(;;){if(x===t)break t;if(w===n&&++p===i&&(o=l),w===s&&++b===r&&(h=l),(A=x.nextSibling)!==null)break;x=w,w=x.parentNode}x=A}n=o===-1||h===-1?null:{start:o,end:h}}else n=null}n=n||{start:0,end:0}}else n=null;for(PE={focusedElem:t,selectionRange:n},nb=!1,Ut=e;Ut!==null;)if(e=Ut,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ut=t;else for(;Ut!==null;){e=Ut;try{var L=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var M=L.memoizedProps,U=L.memoizedState,D=e.stateNode,$=D.getSnapshotBeforeUpdate(e.elementType===e.type?M:fa(e.type,M),U);D.__reactInternalSnapshotBeforeUpdate=$}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(dt(163))}}catch(B){oi(e,e.return,B)}if(t=e.sibling,t!==null){t.return=e.return,Ut=t;break}Ut=e.return}return L=O5,O5=!1,L}function Cg(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&jE(e,n,s)}i=i.next}while(i!==r)}}function P1(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function GE(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function t7(t){var e=t.alternate;e!==null&&(t.alternate=null,t7(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[el],delete e[Qg],delete e[IE],delete e[EQ],delete e[SQ])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function n7(t){return t.tag===5||t.tag===3||t.tag===4}function D5(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||n7(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function WE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=sb));else if(r!==4&&(t=t.child,t!==null))for(WE(t,e,n),t=t.sibling;t!==null;)WE(t,e,n),t=t.sibling}function HE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(HE(t,e,n),t=t.sibling;t!==null;)HE(t,e,n),t=t.sibling}var es=null,pa=!1;function $c(t,e,n){for(n=n.child;n!==null;)r7(t,e,n),n=n.sibling}function r7(t,e,n){if(ol&&typeof ol.onCommitFiberUnmount=="function")try{ol.onCommitFiberUnmount(_1,n)}catch{}switch(n.tag){case 5:ys||pf(n,e);case 6:var r=es,i=pa;es=null,$c(t,e,n),es=r,pa=i,es!==null&&(pa?(t=es,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):es.removeChild(n.stateNode));break;case 18:es!==null&&(pa?(t=es,n=n.stateNode,t.nodeType===8?s2(t.parentNode,n):t.nodeType===1&&s2(t,n),Kg(t)):s2(es,n.stateNode));break;case 4:r=es,i=pa,es=n.stateNode.containerInfo,pa=!0,$c(t,e,n),es=r,pa=i;break;case 0:case 11:case 14:case 15:if(!ys&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,l=s.destroy;s=s.tag,l!==void 0&&(s&2||s&4)&&jE(n,e,l),i=i.next}while(i!==r)}$c(t,e,n);break;case 1:if(!ys&&(pf(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){oi(n,e,o)}$c(t,e,n);break;case 21:$c(t,e,n);break;case 22:n.mode&1?(ys=(r=ys)||n.memoizedState!==null,$c(t,e,n),ys=r):$c(t,e,n);break;default:$c(t,e,n)}}function F5(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new UQ),e.forEach(function(r){var i=YQ.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ua(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,l=e,o=l;e:for(;o!==null;){switch(o.tag){case 5:es=o.stateNode,pa=!1;break e;case 3:es=o.stateNode.containerInfo,pa=!0;break e;case 4:es=o.stateNode.containerInfo,pa=!0;break e}o=o.return}if(es===null)throw Error(dt(160));r7(s,l,i),es=null,pa=!1;var h=i.alternate;h!==null&&(h.return=null),i.return=null}catch(p){oi(i,e,p)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)i7(e,t),e=e.sibling}function i7(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ua(e,t),Ga(t),r&4){try{Cg(3,t,t.return),P1(3,t)}catch(M){oi(t,t.return,M)}try{Cg(5,t,t.return)}catch(M){oi(t,t.return,M)}}break;case 1:ua(e,t),Ga(t),r&512&&n!==null&&pf(n,n.return);break;case 5:if(ua(e,t),Ga(t),r&512&&n!==null&&pf(n,n.return),t.flags&32){var i=t.stateNode;try{Gg(i,"")}catch(M){oi(t,t.return,M)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,l=n!==null?n.memoizedProps:s,o=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&Sz(i,s),gE(o,l);var p=gE(o,s);for(l=0;l<h.length;l+=2){var b=h[l],x=h[l+1];b==="style"?Iz(i,x):b==="dangerouslySetInnerHTML"?Cz(i,x):b==="children"?Gg(i,x):CR(i,b,x,p)}switch(o){case"input":dE(i,s);break;case"textarea":Az(i,s);break;case"select":var w=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var A=s.value;A!=null?Ef(i,!!s.multiple,A,!1):w!==!!s.multiple&&(s.defaultValue!=null?Ef(i,!!s.multiple,s.defaultValue,!0):Ef(i,!!s.multiple,s.multiple?[]:"",!1))}i[Qg]=s}catch(M){oi(t,t.return,M)}}break;case 6:if(ua(e,t),Ga(t),r&4){if(t.stateNode===null)throw Error(dt(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(M){oi(t,t.return,M)}}break;case 3:if(ua(e,t),Ga(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Kg(e.containerInfo)}catch(M){oi(t,t.return,M)}break;case 4:ua(e,t),Ga(t);break;case 13:ua(e,t),Ga(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(aM=pi())),r&4&&F5(t);break;case 22:if(b=n!==null&&n.memoizedState!==null,t.mode&1?(ys=(p=ys)||b,ua(e,t),ys=p):ua(e,t),Ga(t),r&8192){if(p=t.memoizedState!==null,(t.stateNode.isHidden=p)&&!b&&t.mode&1)for(Ut=t,b=t.child;b!==null;){for(x=Ut=b;Ut!==null;){switch(w=Ut,A=w.child,w.tag){case 0:case 11:case 14:case 15:Cg(4,w,w.return);break;case 1:pf(w,w.return);var L=w.stateNode;if(typeof L.componentWillUnmount=="function"){r=w,n=w.return;try{e=r,L.props=e.memoizedProps,L.state=e.memoizedState,L.componentWillUnmount()}catch(M){oi(r,n,M)}}break;case 5:pf(w,w.return);break;case 22:if(w.memoizedState!==null){z5(x);continue}}A!==null?(A.return=w,Ut=A):z5(x)}b=b.sibling}e:for(b=null,x=t;;){if(x.tag===5){if(b===null){b=x;try{i=x.stateNode,p?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=x.stateNode,h=x.memoizedProps.style,l=h!=null&&h.hasOwnProperty("display")?h.display:null,o.style.display=Lz("display",l))}catch(M){oi(t,t.return,M)}}}else if(x.tag===6){if(b===null)try{x.stateNode.nodeValue=p?"":x.memoizedProps}catch(M){oi(t,t.return,M)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===t)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===t)break e;for(;x.sibling===null;){if(x.return===null||x.return===t)break e;b===x&&(b=null),x=x.return}b===x&&(b=null),x.sibling.return=x.return,x=x.sibling}}break;case 19:ua(e,t),Ga(t),r&4&&F5(t);break;case 21:break;default:ua(e,t),Ga(t)}}function Ga(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(n7(n)){var r=n;break e}n=n.return}throw Error(dt(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Gg(i,""),r.flags&=-33);var s=D5(t);HE(t,s,i);break;case 3:case 4:var l=r.stateNode.containerInfo,o=D5(t);WE(t,o,l);break;default:throw Error(dt(161))}}catch(h){oi(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function jQ(t,e,n){Ut=t,s7(t)}function s7(t,e,n){for(var r=(t.mode&1)!==0;Ut!==null;){var i=Ut,s=i.child;if(i.tag===22&&r){var l=i.memoizedState!==null||Ev;if(!l){var o=i.alternate,h=o!==null&&o.memoizedState!==null||ys;o=Ev;var p=ys;if(Ev=l,(ys=h)&&!p)for(Ut=i;Ut!==null;)l=Ut,h=l.child,l.tag===22&&l.memoizedState!==null?B5(i):h!==null?(h.return=l,Ut=h):B5(i);for(;s!==null;)Ut=s,s7(s),s=s.sibling;Ut=i,Ev=o,ys=p}N5(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Ut=s):N5(t)}}function N5(t){for(;Ut!==null;){var e=Ut;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ys||P1(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ys)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:fa(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&x5(e,s,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}x5(e,l,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&n.focus();break;case"img":h.src&&(n.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var p=e.alternate;if(p!==null){var b=p.memoizedState;if(b!==null){var x=b.dehydrated;x!==null&&Kg(x)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(dt(163))}ys||e.flags&512&&GE(e)}catch(w){oi(e,e.return,w)}}if(e===t){Ut=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ut=n;break}Ut=e.return}}function z5(t){for(;Ut!==null;){var e=Ut;if(e===t){Ut=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ut=n;break}Ut=e.return}}function B5(t){for(;Ut!==null;){var e=Ut;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{P1(4,e)}catch(h){oi(e,n,h)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(h){oi(e,i,h)}}var s=e.return;try{GE(e)}catch(h){oi(e,s,h)}break;case 5:var l=e.return;try{GE(e)}catch(h){oi(e,l,h)}}}catch(h){oi(e,e.return,h)}if(e===t){Ut=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ut=o;break}Ut=e.return}}var GQ=Math.ceil,gb=sc.ReactCurrentDispatcher,sM=sc.ReactCurrentOwner,Yo=sc.ReactCurrentBatchConfig,Yn=0,Wi=null,Ti=null,ts=0,bo=0,mf=_u(0),Oi=0,sy=null,Id=0,C1=0,oM=0,Lg=null,Ks=null,aM=0,Kf=1/0,zl=null,yb=!1,qE=null,ou=null,Sv=!1,Yc=null,vb=0,Ig=0,KE=null,I_=-1,R_=0;function zs(){return Yn&6?pi():I_!==-1?I_:I_=pi()}function au(t){return t.mode&1?Yn&2&&ts!==0?ts&-ts:PQ.transition!==null?(R_===0&&(R_=Vz()),R_):(t=cr,t!==0||(t=window.event,t=t===void 0?16:Xz(t.type)),t):1}function Sa(t,e,n,r){if(50<Ig)throw Ig=0,KE=null,Error(dt(185));My(t,n,r),(!(Yn&2)||t!==Wi)&&(t===Wi&&(!(Yn&2)&&(C1|=n),Oi===4&&Hc(t,ts)),to(t,r),n===1&&Yn===0&&!(e.mode&1)&&(Kf=pi()+500,E1&&bu()))}function to(t,e){var n=t.callbackNode;PJ(t,e);var r=tb(t,t===Wi?ts:0);if(r===0)n!==null&&X6(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&X6(n),e===1)t.tag===0?AQ(U5.bind(null,t)):p9(U5.bind(null,t)),wQ(function(){!(Yn&6)&&bu()}),n=null;else{switch(jz(r)){case 1:n=$R;break;case 4:n=Bz;break;case 16:n=eb;break;case 536870912:n=Uz;break;default:n=eb}n=f7(n,o7.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function o7(t,e){if(I_=-1,R_=0,Yn&6)throw Error(dt(327));var n=t.callbackNode;if(Lf()&&t.callbackNode!==n)return null;var r=tb(t,t===Wi?ts:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=_b(t,r);else{e=r;var i=Yn;Yn|=2;var s=l7();(Wi!==t||ts!==e)&&(zl=null,Kf=pi()+500,xd(t,e));do try{qQ();break}catch(o){a7(t,o)}while(1);HR(),gb.current=s,Yn=i,Ti!==null?e=0:(Wi=null,ts=0,e=Oi)}if(e!==0){if(e===2&&(i=xE(t),i!==0&&(r=i,e=XE(t,i))),e===1)throw n=sy,xd(t,0),Hc(t,r),to(t,pi()),n;if(e===6)Hc(t,r);else{if(i=t.current.alternate,!(r&30)&&!WQ(i)&&(e=_b(t,r),e===2&&(s=xE(t),s!==0&&(r=s,e=XE(t,s))),e===1))throw n=sy,xd(t,0),Hc(t,r),to(t,pi()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(dt(345));case 2:ld(t,Ks,zl);break;case 3:if(Hc(t,r),(r&130023424)===r&&(e=aM+500-pi(),10<e)){if(tb(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){zs(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=LE(ld.bind(null,t,Ks,zl),e);break}ld(t,Ks,zl);break;case 4:if(Hc(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var l=31-Ea(r);s=1<<l,l=e[l],l>i&&(i=l),r&=~s}if(r=i,r=pi()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*GQ(r/1960))-r,10<r){t.timeoutHandle=LE(ld.bind(null,t,Ks,zl),r);break}ld(t,Ks,zl);break;case 5:ld(t,Ks,zl);break;default:throw Error(dt(329))}}}return to(t,pi()),t.callbackNode===n?o7.bind(null,t):null}function XE(t,e){var n=Lg;return t.current.memoizedState.isDehydrated&&(xd(t,e).flags|=256),t=_b(t,e),t!==2&&(e=Ks,Ks=n,e!==null&&ZE(e)),t}function ZE(t){Ks===null?Ks=t:Ks.push.apply(Ks,t)}function WQ(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ca(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Hc(t,e){for(e&=~oM,e&=~C1,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ea(e),r=1<<n;t[n]=-1,e&=~r}}function U5(t){if(Yn&6)throw Error(dt(327));Lf();var e=tb(t,0);if(!(e&1))return to(t,pi()),null;var n=_b(t,e);if(t.tag!==0&&n===2){var r=xE(t);r!==0&&(e=r,n=XE(t,r))}if(n===1)throw n=sy,xd(t,0),Hc(t,e),to(t,pi()),n;if(n===6)throw Error(dt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ld(t,Ks,zl),to(t,pi()),null}function lM(t,e){var n=Yn;Yn|=1;try{return t(e)}finally{Yn=n,Yn===0&&(Kf=pi()+500,E1&&bu())}}function Rd(t){Yc!==null&&Yc.tag===0&&!(Yn&6)&&Lf();var e=Yn;Yn|=1;var n=Yo.transition,r=cr;try{if(Yo.transition=null,cr=1,t)return t()}finally{cr=r,Yo.transition=n,Yn=e,!(Yn&6)&&bu()}}function cM(){bo=mf.current,Fr(mf)}function xd(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,xQ(n)),Ti!==null)for(n=Ti.return;n!==null;){var r=n;switch(jR(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ob();break;case 3:Hf(),Fr(Qs),Fr(_s),JR();break;case 5:YR(r);break;case 4:Hf();break;case 13:Fr(qr);break;case 19:Fr(qr);break;case 10:qR(r.type._context);break;case 22:case 23:cM()}n=n.return}if(Wi=t,Ti=t=lu(t.current,null),ts=bo=e,Oi=0,sy=null,oM=C1=Id=0,Ks=Lg=null,gd!==null){for(e=0;e<gd.length;e++)if(n=gd[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var l=s.next;s.next=i,r.next=l}n.pending=r}gd=null}return t}function a7(t,e){do{var n=Ti;try{if(HR(),P_.current=mb,pb){for(var r=Zr.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}pb=!1}if(Ld=0,Ui=ki=Zr=null,Pg=!1,ny=0,sM.current=null,n===null||n.return===null){Oi=1,sy=e,Ti=null;break}e:{var s=t,l=n.return,o=n,h=e;if(e=ts,o.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var p=h,b=o,x=b.tag;if(!(b.mode&1)&&(x===0||x===11||x===15)){var w=b.alternate;w?(b.updateQueue=w.updateQueue,b.memoizedState=w.memoizedState,b.lanes=w.lanes):(b.updateQueue=null,b.memoizedState=null)}var A=C5(l);if(A!==null){A.flags&=-257,L5(A,l,o,s,e),A.mode&1&&P5(s,p,e),e=A,h=p;var L=e.updateQueue;if(L===null){var M=new Set;M.add(h),e.updateQueue=M}else L.add(h);break e}else{if(!(e&1)){P5(s,p,e),uM();break e}h=Error(dt(426))}}else if(Ur&&o.mode&1){var U=C5(l);if(U!==null){!(U.flags&65536)&&(U.flags|=256),L5(U,l,o,s,e),GR(qf(h,o));break e}}s=h=qf(h,o),Oi!==4&&(Oi=2),Lg===null?Lg=[s]:Lg.push(s),s=l;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var D=G9(s,h,e);b5(s,D);break e;case 1:o=h;var $=s.type,N=s.stateNode;if(!(s.flags&128)&&(typeof $.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(ou===null||!ou.has(N)))){s.flags|=65536,e&=-e,s.lanes|=e;var B=W9(s,o,e);b5(s,B);break e}}s=s.return}while(s!==null)}u7(n)}catch(Z){e=Z,Ti===n&&n!==null&&(Ti=n=n.return);continue}break}while(1)}function l7(){var t=gb.current;return gb.current=mb,t===null?mb:t}function uM(){(Oi===0||Oi===3||Oi===2)&&(Oi=4),Wi===null||!(Id&268435455)&&!(C1&268435455)||Hc(Wi,ts)}function _b(t,e){var n=Yn;Yn|=2;var r=l7();(Wi!==t||ts!==e)&&(zl=null,xd(t,e));do try{HQ();break}catch(i){a7(t,i)}while(1);if(HR(),Yn=n,gb.current=r,Ti!==null)throw Error(dt(261));return Wi=null,ts=0,Oi}function HQ(){for(;Ti!==null;)c7(Ti)}function qQ(){for(;Ti!==null&&!vJ();)c7(Ti)}function c7(t){var e=h7(t.alternate,t,bo);t.memoizedProps=t.pendingProps,e===null?u7(t):Ti=e,sM.current=null}function u7(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=BQ(n,e),n!==null){n.flags&=32767,Ti=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Oi=6,Ti=null;return}}else if(n=zQ(n,e,bo),n!==null){Ti=n;return}if(e=e.sibling,e!==null){Ti=e;return}Ti=e=t}while(e!==null);Oi===0&&(Oi=5)}function ld(t,e,n){var r=cr,i=Yo.transition;try{Yo.transition=null,cr=1,KQ(t,e,n,r)}finally{Yo.transition=i,cr=r}return null}function KQ(t,e,n,r){do Lf();while(Yc!==null);if(Yn&6)throw Error(dt(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(dt(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(CJ(t,s),t===Wi&&(Ti=Wi=null,ts=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Sv||(Sv=!0,f7(eb,function(){return Lf(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Yo.transition,Yo.transition=null;var l=cr;cr=1;var o=Yn;Yn|=4,sM.current=null,VQ(t,n),i7(n,t),pQ(PE),nb=!!AE,PE=AE=null,t.current=n,jQ(n),_J(),Yn=o,cr=l,Yo.transition=s}else t.current=n;if(Sv&&(Sv=!1,Yc=t,vb=i),s=t.pendingLanes,s===0&&(ou=null),wJ(n.stateNode),to(t,pi()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(yb)throw yb=!1,t=qE,qE=null,t;return vb&1&&t.tag!==0&&Lf(),s=t.pendingLanes,s&1?t===KE?Ig++:(Ig=0,KE=t):Ig=0,bu(),null}function Lf(){if(Yc!==null){var t=jz(vb),e=Yo.transition,n=cr;try{if(Yo.transition=null,cr=16>t?16:t,Yc===null)var r=!1;else{if(t=Yc,Yc=null,vb=0,Yn&6)throw Error(dt(331));var i=Yn;for(Yn|=4,Ut=t.current;Ut!==null;){var s=Ut,l=s.child;if(Ut.flags&16){var o=s.deletions;if(o!==null){for(var h=0;h<o.length;h++){var p=o[h];for(Ut=p;Ut!==null;){var b=Ut;switch(b.tag){case 0:case 11:case 15:Cg(8,b,s)}var x=b.child;if(x!==null)x.return=b,Ut=x;else for(;Ut!==null;){b=Ut;var w=b.sibling,A=b.return;if(t7(b),b===p){Ut=null;break}if(w!==null){w.return=A,Ut=w;break}Ut=A}}}var L=s.alternate;if(L!==null){var M=L.child;if(M!==null){L.child=null;do{var U=M.sibling;M.sibling=null,M=U}while(M!==null)}}Ut=s}}if(s.subtreeFlags&2064&&l!==null)l.return=s,Ut=l;else e:for(;Ut!==null;){if(s=Ut,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Cg(9,s,s.return)}var D=s.sibling;if(D!==null){D.return=s.return,Ut=D;break e}Ut=s.return}}var $=t.current;for(Ut=$;Ut!==null;){l=Ut;var N=l.child;if(l.subtreeFlags&2064&&N!==null)N.return=l,Ut=N;else e:for(l=$;Ut!==null;){if(o=Ut,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:P1(9,o)}}catch(Z){oi(o,o.return,Z)}if(o===l){Ut=null;break e}var B=o.sibling;if(B!==null){B.return=o.return,Ut=B;break e}Ut=o.return}}if(Yn=i,bu(),ol&&typeof ol.onPostCommitFiberRoot=="function")try{ol.onPostCommitFiberRoot(_1,t)}catch{}r=!0}return r}finally{cr=n,Yo.transition=e}}return!1}function V5(t,e,n){e=qf(n,e),e=G9(t,e,1),t=su(t,e,1),e=zs(),t!==null&&(My(t,1,e),to(t,e))}function oi(t,e,n){if(t.tag===3)V5(t,t,n);else for(;e!==null;){if(e.tag===3){V5(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ou===null||!ou.has(r))){t=qf(n,t),t=W9(e,t,1),e=su(e,t,1),t=zs(),e!==null&&(My(e,1,t),to(e,t));break}}e=e.return}}function XQ(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=zs(),t.pingedLanes|=t.suspendedLanes&n,Wi===t&&(ts&n)===n&&(Oi===4||Oi===3&&(ts&130023424)===ts&&500>pi()-aM?xd(t,0):oM|=n),to(t,e)}function d7(t,e){e===0&&(t.mode&1?(e=mv,mv<<=1,!(mv&130023424)&&(mv=4194304)):e=1);var n=zs();t=ec(t,e),t!==null&&(My(t,e,n),to(t,n))}function ZQ(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),d7(t,n)}function YQ(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(dt(314))}r!==null&&r.delete(e),d7(t,n)}var h7;h7=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qs.current)Js=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Js=!1,NQ(t,e,n);Js=!!(t.flags&131072)}else Js=!1,Ur&&e.flags&1048576&&m9(e,cb,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;L_(t,e),t=e.pendingProps;var i=jf(e,_s.current);Cf(e,n),i=eM(null,e,r,t,i,n);var s=tM();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,eo(r)?(s=!0,ab(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,XR(e),i.updater=S1,e.stateNode=i,i._reactInternals=e,DE(e,r,t,n),e=zE(null,e,r,!0,s,n)):(e.tag=0,Ur&&s&&VR(e),Ms(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(L_(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=QQ(r),t=fa(r,t),i){case 0:e=NE(null,e,r,t,n);break e;case 1:e=M5(null,e,r,t,n);break e;case 11:e=I5(null,e,r,t,n);break e;case 14:e=R5(null,e,r,fa(r.type,t),n);break e}throw Error(dt(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:fa(r,i),NE(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:fa(r,i),M5(t,e,r,i,n);case 3:e:{if(X9(e),t===null)throw Error(dt(387));r=e.pendingProps,s=e.memoizedState,i=s.element,_9(t,e),hb(e,r,null,n);var l=e.memoizedState;if(r=l.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=qf(Error(dt(423)),e),e=$5(t,e,r,n,i);break e}else if(r!==i){i=qf(Error(dt(424)),e),e=$5(t,e,r,n,i);break e}else for(So=iu(e.stateNode.containerInfo.firstChild),Po=e,Ur=!0,ya=null,n=T9(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Gf(),r===i){e=tc(t,e,n);break e}Ms(t,e,r,n)}e=e.child}return e;case 5:return E9(e),t===null&&$E(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,l=i.children,CE(r,i)?l=null:s!==null&&CE(r,s)&&(e.flags|=32),K9(t,e),Ms(t,e,l,n),e.child;case 6:return t===null&&$E(e),null;case 13:return Z9(t,e,n);case 4:return ZR(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Wf(e,null,r,n):Ms(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:fa(r,i),I5(t,e,r,i,n);case 7:return Ms(t,e,e.pendingProps,n),e.child;case 8:return Ms(t,e,e.pendingProps.children,n),e.child;case 12:return Ms(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,l=i.value,Sr(ub,r._currentValue),r._currentValue=l,s!==null)if(Ca(s.value,l)){if(s.children===i.children&&!Qs.current){e=tc(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){l=s.child;for(var h=o.firstContext;h!==null;){if(h.context===r){if(s.tag===1){h=Zl(-1,n&-n),h.tag=2;var p=s.updateQueue;if(p!==null){p=p.shared;var b=p.pending;b===null?h.next=h:(h.next=b.next,b.next=h),p.pending=h}}s.lanes|=n,h=s.alternate,h!==null&&(h.lanes|=n),kE(s.return,n,e),o.lanes|=n;break}h=h.next}}else if(s.tag===10)l=s.type===e.type?null:s.child;else if(s.tag===18){if(l=s.return,l===null)throw Error(dt(341));l.lanes|=n,o=l.alternate,o!==null&&(o.lanes|=n),kE(l,n,e),l=s.sibling}else l=s.child;if(l!==null)l.return=s;else for(l=s;l!==null;){if(l===e){l=null;break}if(s=l.sibling,s!==null){s.return=l.return,l=s;break}l=l.return}s=l}Ms(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Cf(e,n),i=Qo(i),r=r(i),e.flags|=1,Ms(t,e,r,n),e.child;case 14:return r=e.type,i=fa(r,e.pendingProps),i=fa(r.type,i),R5(t,e,r,i,n);case 15:return H9(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:fa(r,i),L_(t,e),e.tag=1,eo(r)?(t=!0,ab(e)):t=!1,Cf(e,n),x9(e,r,i),DE(e,r,i,n),zE(null,e,r,!0,t,n);case 19:return Y9(t,e,n);case 22:return q9(t,e,n)}throw Error(dt(156,e.tag))};function f7(t,e){return zz(t,e)}function JQ(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zo(t,e,n,r){return new JQ(t,e,n,r)}function dM(t){return t=t.prototype,!(!t||!t.isReactComponent)}function QQ(t){if(typeof t=="function")return dM(t)?1:0;if(t!=null){if(t=t.$$typeof,t===IR)return 11;if(t===RR)return 14}return 2}function lu(t,e){var n=t.alternate;return n===null?(n=Zo(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function M_(t,e,n,r,i,s){var l=2;if(r=t,typeof t=="function")dM(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case sf:return wd(n.children,i,s,e);case LR:l=8,i|=8;break;case oE:return t=Zo(12,n,e,i|2),t.elementType=oE,t.lanes=s,t;case aE:return t=Zo(13,n,e,i),t.elementType=aE,t.lanes=s,t;case lE:return t=Zo(19,n,e,i),t.elementType=lE,t.lanes=s,t;case wz:return L1(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case bz:l=10;break e;case xz:l=9;break e;case IR:l=11;break e;case RR:l=14;break e;case Vc:l=16,r=null;break e}throw Error(dt(130,t==null?t:typeof t,""))}return e=Zo(l,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function wd(t,e,n,r){return t=Zo(7,t,r,e),t.lanes=n,t}function L1(t,e,n,r){return t=Zo(22,t,r,e),t.elementType=wz,t.lanes=n,t.stateNode={isHidden:!1},t}function f2(t,e,n){return t=Zo(6,t,null,e),t.lanes=n,t}function p2(t,e,n){return e=Zo(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function eee(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kw(0),this.expirationTimes=Kw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kw(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function hM(t,e,n,r,i,s,l,o,h){return t=new eee(t,e,n,o,h),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Zo(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},XR(s),t}function tee(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:rf,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function p7(t){if(!t)return gu;t=t._reactInternals;e:{if(Zd(t)!==t||t.tag!==1)throw Error(dt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(eo(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(dt(171))}if(t.tag===1){var n=t.type;if(eo(n))return f9(t,n,e)}return e}function m7(t,e,n,r,i,s,l,o,h){return t=hM(n,r,!0,t,i,s,l,o,h),t.context=p7(null),n=t.current,r=zs(),i=au(n),s=Zl(r,i),s.callback=e??null,su(n,s,i),t.current.lanes=i,My(t,i,r),to(t,r),t}function I1(t,e,n,r){var i=e.current,s=zs(),l=au(i);return n=p7(n),e.context===null?e.context=n:e.pendingContext=n,e=Zl(s,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=su(i,e,l),t!==null&&(Sa(t,i,l,s),A_(t,i,l)),l}function bb(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function j5(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function fM(t,e){j5(t,e),(t=t.alternate)&&j5(t,e)}function nee(){return null}var g7=typeof reportError=="function"?reportError:function(t){console.error(t)};function pM(t){this._internalRoot=t}R1.prototype.render=pM.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(dt(409));I1(t,e,null,null)};R1.prototype.unmount=pM.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Rd(function(){I1(null,t,null,null)}),e[Ql]=null}};function R1(t){this._internalRoot=t}R1.prototype.unstable_scheduleHydration=function(t){if(t){var e=Hz();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Wc.length&&e!==0&&e<Wc[n].priority;n++);Wc.splice(n,0,t),n===0&&Kz(t)}};function mM(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function M1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function G5(){}function ree(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var p=bb(l);s.call(p)}}var l=m7(e,r,t,0,null,!1,!1,"",G5);return t._reactRootContainer=l,t[Ql]=l.current,Yg(t.nodeType===8?t.parentNode:t),Rd(),l}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var p=bb(h);o.call(p)}}var h=hM(t,0,!1,null,null,!1,!1,"",G5);return t._reactRootContainer=h,t[Ql]=h.current,Yg(t.nodeType===8?t.parentNode:t),Rd(function(){I1(e,h,n,r)}),h}function $1(t,e,n,r,i){var s=n._reactRootContainer;if(s){var l=s;if(typeof i=="function"){var o=i;i=function(){var h=bb(l);o.call(h)}}I1(e,l,t,i)}else l=ree(n,e,t,i,r);return bb(l)}Gz=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=cg(e.pendingLanes);n!==0&&(kR(e,n|1),to(e,pi()),!(Yn&6)&&(Kf=pi()+500,bu()))}break;case 13:Rd(function(){var r=ec(t,1);if(r!==null){var i=zs();Sa(r,t,1,i)}}),fM(t,1)}};OR=function(t){if(t.tag===13){var e=ec(t,134217728);if(e!==null){var n=zs();Sa(e,t,134217728,n)}fM(t,134217728)}};Wz=function(t){if(t.tag===13){var e=au(t),n=ec(t,e);if(n!==null){var r=zs();Sa(n,t,e,r)}fM(t,e)}};Hz=function(){return cr};qz=function(t,e){var n=cr;try{return cr=t,e()}finally{cr=n}};vE=function(t,e,n){switch(e){case"input":if(dE(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=T1(r);if(!i)throw Error(dt(90));Ez(r),dE(r,i)}}}break;case"textarea":Az(t,n);break;case"select":e=n.value,e!=null&&Ef(t,!!n.multiple,e,!1)}};$z=lM;kz=Rd;var iee={usingClientEntryPoint:!1,Events:[ky,cf,T1,Rz,Mz,lM]},km={findFiberByHostInstance:md,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},see={bundleType:km.bundleType,version:km.version,rendererPackageName:km.rendererPackageName,rendererConfig:km.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sc.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fz(t),t===null?null:t.stateNode},findFiberByHostInstance:km.findFiberByHostInstance||nee,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Av=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Av.isDisabled&&Av.supportsFiber)try{_1=Av.inject(see),ol=Av}catch{}}Mo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iee;Mo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!mM(e))throw Error(dt(200));return tee(t,e,null,n)};Mo.createRoot=function(t,e){if(!mM(t))throw Error(dt(299));var n=!1,r="",i=g7;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=hM(t,1,!1,null,null,n,!1,r,i),t[Ql]=e.current,Yg(t.nodeType===8?t.parentNode:t),new pM(e)};Mo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(dt(188)):(t=Object.keys(t).join(","),Error(dt(268,t)));return t=Fz(e),t=t===null?null:t.stateNode,t};Mo.flushSync=function(t){return Rd(t)};Mo.hydrate=function(t,e,n){if(!M1(e))throw Error(dt(200));return $1(null,t,e,!0,n)};Mo.hydrateRoot=function(t,e,n){if(!mM(t))throw Error(dt(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",l=g7;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=m7(e,null,t,1,n??null,i,!1,s,l),t[Ql]=e.current,Yg(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new R1(e)};Mo.render=function(t,e,n){if(!M1(e))throw Error(dt(200));return $1(null,t,e,!1,n)};Mo.unmountComponentAtNode=function(t){if(!M1(t))throw Error(dt(40));return t._reactRootContainer?(Rd(function(){$1(null,null,t,!1,function(){t._reactRootContainer=null,t[Ql]=null})}),!0):!1};Mo.unstable_batchedUpdates=lM;Mo.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!M1(n))throw Error(dt(200));if(t==null||t._reactInternals===void 0)throw Error(dt(38));return $1(t,e,n,!1,r)};Mo.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=Mo})(nJ);const vd=az(Ad);var W5=Ad;rE.createRoot=W5.createRoot,rE.hydrateRoot=W5.hydrateRoot;function oee(t){const e=new Error(t);if(e.stack===void 0)try{throw e}catch{}return e}var aee=oee,In=aee;function lee(t){return!!t&&typeof t.then=="function"}var Dr=lee;function cee(t,e){if(t!=null)return t;throw In(e??"Got unexpected null or undefined")}var Vr=cee;function An(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class k1{getValue(){throw In("BaseLoadable")}toPromise(){throw In("BaseLoadable")}valueMaybe(){throw In("BaseLoadable")}valueOrThrow(){throw In(`Loadable expected value, but in "${this.state}" state`)}promiseMaybe(){throw In("BaseLoadable")}promiseOrThrow(){throw In(`Loadable expected promise, but in "${this.state}" state`)}errorMaybe(){throw In("BaseLoadable")}errorOrThrow(){throw In(`Loadable expected error, but in "${this.state}" state`)}is(e){return e.state===this.state&&e.contents===this.contents}map(e){throw In("BaseLoadable")}}class uee extends k1{constructor(e){super(),An(this,"state","hasValue"),An(this,"contents",void 0),this.contents=e}getValue(){return this.contents}toPromise(){return Promise.resolve(this.contents)}valueMaybe(){return this.contents}valueOrThrow(){return this.contents}promiseMaybe(){}errorMaybe(){}map(e){try{const n=e(this.contents);return Dr(n)?Md(n):Xf(n)?n:Dy(n)}catch(n){return Dr(n)?Md(n.next(()=>this.map(e))):O1(n)}}}class dee extends k1{constructor(e){super(),An(this,"state","hasError"),An(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return Promise.reject(this.contents)}valueMaybe(){}promiseMaybe(){}errorMaybe(){return this.contents}errorOrThrow(){return this.contents}map(e){return this}}class y7 extends k1{constructor(e){super(),An(this,"state","loading"),An(this,"contents",void 0),this.contents=e}getValue(){throw this.contents}toPromise(){return this.contents}valueMaybe(){}promiseMaybe(){return this.contents}promiseOrThrow(){return this.contents}errorMaybe(){}map(e){return Md(this.contents.then(n=>{const r=e(n);if(Xf(r)){const i=r;switch(i.state){case"hasValue":return i.contents;case"hasError":throw i.contents;case"loading":return i.contents}}return r}).catch(n=>{if(Dr(n))return n.then(()=>this.map(e).contents);throw n}))}}function Dy(t){return Object.freeze(new uee(t))}function O1(t){return Object.freeze(new dee(t))}function Md(t){return Object.freeze(new y7(t))}function v7(){return Object.freeze(new y7(new Promise(()=>{})))}function hee(t){return t.every(e=>e.state==="hasValue")?Dy(t.map(e=>e.contents)):t.some(e=>e.state==="hasError")?O1(Vr(t.find(e=>e.state==="hasError"),"Invalid loadable passed to loadableAll").contents):Md(Promise.all(t.map(e=>e.contents)))}function _7(t){const n=(Array.isArray(t)?t:Object.getOwnPropertyNames(t).map(i=>t[i])).map(i=>Xf(i)?i:Dr(i)?Md(i):Dy(i)),r=hee(n);return Array.isArray(t)?r:r.map(i=>Object.getOwnPropertyNames(t).reduce((s,l,o)=>({...s,[l]:i[o]}),{}))}function Xf(t){return t instanceof k1}const fee={of:t=>Dr(t)?Md(t):Xf(t)?t:Dy(t),error:t=>O1(t),loading:()=>v7(),all:_7,isLoadable:Xf};var Yd={loadableWithValue:Dy,loadableWithError:O1,loadableWithPromise:Md,loadableLoading:v7,loadableAll:_7,isLoadable:Xf,RecoilLoadable:fee},pee=Yd.loadableWithValue,mee=Yd.loadableWithError,gee=Yd.loadableWithPromise,yee=Yd.loadableLoading,vee=Yd.loadableAll,_ee=Yd.isLoadable,bee=Yd.RecoilLoadable,Fy=Object.freeze({__proto__:null,loadableWithValue:pee,loadableWithError:mee,loadableWithPromise:gee,loadableLoading:yee,loadableAll:vee,isLoadable:_ee,RecoilLoadable:bee});const YE={RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED:!0,RECOIL_GKS_ENABLED:new Set(["recoil_hamt_2020","recoil_sync_external_store","recoil_suppress_rerender_in_callback","recoil_memory_managament_2020"])};function xee(t,e){var n,r;const i=(n=process.env[t])===null||n===void 0||(r=n.toLowerCase())===null||r===void 0?void 0:r.trim();if(i==null||i==="")return;if(!["true","false"].includes(i))throw In(`({}).${t} value must be 'true', 'false', or empty: ${i}`);e(i==="true")}function wee(t,e){var n;const r=(n=process.env[t])===null||n===void 0?void 0:n.trim();r==null||r===""||e(r.split(/\s*,\s*|\s+/))}function Tee(){var t;typeof process>"u"||((t=process)===null||t===void 0?void 0:t.env)!=null&&(xee("RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED",e=>{YE.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED=e}),wee("RECOIL_GKS_ENABLED",e=>{e.forEach(n=>{YE.RECOIL_GKS_ENABLED.add(n)})}))}Tee();var bp=YE;function D1(t){return bp.RECOIL_GKS_ENABLED.has(t)}D1.setPass=t=>{bp.RECOIL_GKS_ENABLED.add(t)};D1.setFail=t=>{bp.RECOIL_GKS_ENABLED.delete(t)};D1.clear=()=>{bp.RECOIL_GKS_ENABLED.clear()};var br=D1;function Eee(t,e,{error:n}={}){return null}var See=Eee,gM=See,m2,g2,y2;const Aee=(m2=le.createMutableSource)!==null&&m2!==void 0?m2:le.unstable_createMutableSource,b7=(g2=le.useMutableSource)!==null&&g2!==void 0?g2:le.unstable_useMutableSource,x7=(y2=le.useSyncExternalStore)!==null&&y2!==void 0?y2:le.unstable_useSyncExternalStore;function Pee(){var t;const{ReactCurrentDispatcher:e,ReactCurrentOwner:n}=le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;return((t=e==null?void 0:e.current)!==null&&t!==void 0?t:n.currentDispatcher).useSyncExternalStore!=null}function Cee(){return br("recoil_transition_support")?{mode:"TRANSITION_SUPPORT",early:!0,concurrent:!0}:br("recoil_sync_external_store")&&x7!=null?{mode:"SYNC_EXTERNAL_STORE",early:!0,concurrent:!1}:br("recoil_mutable_source")&&b7!=null&&typeof window<"u"&&!window.$disableRecoilValueMutableSource_TEMP_HACK_DO_NOT_USE?br("recoil_suppress_rerender_in_callback")?{mode:"MUTABLE_SOURCE",early:!0,concurrent:!0}:{mode:"MUTABLE_SOURCE",early:!1,concurrent:!1}:br("recoil_suppress_rerender_in_callback")?{mode:"LEGACY",early:!0,concurrent:!1}:{mode:"LEGACY",early:!1,concurrent:!1}}function Lee(){return!1}var Ny={createMutableSource:Aee,useMutableSource:b7,useSyncExternalStore:x7,currentRendererSupportsUseSyncExternalStore:Pee,reactMode:Cee,isFastRefreshEnabled:Lee};class yM{constructor(e){An(this,"key",void 0),this.key=e}toJSON(){return{key:this.key}}}class w7 extends yM{}class T7 extends yM{}function Iee(t){return t instanceof w7||t instanceof T7}var F1={AbstractRecoilValue:yM,RecoilState:w7,RecoilValueReadOnly:T7,isRecoilValue:Iee},Ree=F1.AbstractRecoilValue,Mee=F1.RecoilState,$ee=F1.RecoilValueReadOnly,kee=F1.isRecoilValue,Zf=Object.freeze({__proto__:null,AbstractRecoilValue:Ree,RecoilState:Mee,RecoilValueReadOnly:$ee,isRecoilValue:kee});function Oee(t,e){return function*(){let n=0;for(const r of t)yield e(r,n++)}()}var N1=Oee;class E7{}const Dee=new E7,$d=new Map,vM=new Map;function Fee(t){return N1(t,e=>Vr(vM.get(e)))}function Nee(t){if($d.has(t)){const e=`Duplicate atom key "${t}". This is a FATAL ERROR in
      production. But it is safe to ignore this warning if it occurred because of
      hot module replacement.`;console.warn(e)}}function zee(t){bp.RECOIL_DUPLICATE_ATOM_KEY_CHECKING_ENABLED&&Nee(t.key),$d.set(t.key,t);const e=t.set==null?new Zf.RecoilValueReadOnly(t.key):new Zf.RecoilState(t.key);return vM.set(t.key,e),e}class S7 extends Error{}function Bee(t){const e=$d.get(t);if(e==null)throw new S7(`Missing definition for RecoilValue: "${t}""`);return e}function Uee(t){return $d.get(t)}const xb=new Map;function Vee(t){var e;if(!br("recoil_memory_managament_2020"))return;const n=$d.get(t);if(n!=null&&(e=n.shouldDeleteConfigOnRelease)!==null&&e!==void 0&&e.call(n)){var r;$d.delete(t),(r=A7(t))===null||r===void 0||r(),xb.delete(t)}}function jee(t,e){br("recoil_memory_managament_2020")&&(e===void 0?xb.delete(t):xb.set(t,e))}function A7(t){return xb.get(t)}var ro={nodes:$d,recoilValues:vM,registerNode:zee,getNode:Bee,getNodeMaybe:Uee,deleteNodeConfigIfPossible:Vee,setConfigDeletionHandler:jee,getConfigDeletionHandler:A7,recoilValuesForKeys:Fee,NodeMissingError:S7,DefaultValue:E7,DEFAULT_VALUE:Dee};function Gee(t,e){e()}var Wee={enqueueExecution:Gee};function Hee(t,e){return e={exports:{}},t(e,e.exports),e.exports}var qee=Hee(function(t){var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(De){return typeof De}:function(De){return De&&typeof Symbol=="function"&&De.constructor===Symbol&&De!==Symbol.prototype?"symbol":typeof De},n={},r=5,i=Math.pow(2,r),s=i-1,l=i/2,o=i/4,h={},p=function(Ie){return function(){return Ie}},b=n.hash=function(De){var Ie=typeof De>"u"?"undefined":e(De);if(Ie==="number")return De;Ie!=="string"&&(De+="");for(var Me=0,Qe=0,Ye=De.length;Qe<Ye;++Qe){var vt=De.charCodeAt(Qe);Me=(Me<<5)-Me+vt|0}return Me},x=function(Ie){return Ie-=Ie>>1&1431655765,Ie=(Ie&858993459)+(Ie>>2&858993459),Ie=Ie+(Ie>>4)&252645135,Ie+=Ie>>8,Ie+=Ie>>16,Ie&127},w=function(Ie,Me){return Me>>>Ie&s},A=function(Ie){return 1<<Ie},L=function(Ie,Me){return x(Ie&Me-1)},M=function(Ie,Me,Qe,Ye){var vt=Ye;if(!Ie){var Kt=Ye.length;vt=new Array(Kt);for(var st=0;st<Kt;++st)vt[st]=Ye[st]}return vt[Me]=Qe,vt},U=function(Ie,Me,Qe){var Ye=Qe.length-1,vt=0,Kt=0,st=Qe;if(Ie)vt=Kt=Me;else for(st=new Array(Ye);vt<Me;)st[Kt++]=Qe[vt++];for(++vt;vt<=Ye;)st[Kt++]=Qe[vt++];return Ie&&(st.length=Ye),st},D=function(Ie,Me,Qe,Ye){var vt=Ye.length;if(Ie){for(var Kt=vt;Kt>=Me;)Ye[Kt--]=Ye[Kt];return Ye[Me]=Qe,Ye}for(var st=0,jt=0,Xt=new Array(vt+1);st<Me;)Xt[jt++]=Ye[st++];for(Xt[Me]=Qe;st<vt;)Xt[++jt]=Ye[st++];return Xt},$=1,N=2,B=3,Z=4,ie={__hamt_isEmpty:!0},re=function(Ie){return Ie===ie||Ie&&Ie.__hamt_isEmpty},ve=function(Ie,Me,Qe,Ye){return{type:$,edit:Ie,hash:Me,key:Qe,value:Ye,_modify:ot}},Te=function(Ie,Me,Qe){return{type:N,edit:Ie,hash:Me,children:Qe,_modify:yt}},Ae=function(Ie,Me,Qe){return{type:B,edit:Ie,mask:Me,children:Qe,_modify:at}},fe=function(Ie,Me,Qe){return{type:Z,edit:Ie,size:Me,children:Qe,_modify:Mt}},Pe=function(Ie){return Ie===ie||Ie.type===$||Ie.type===N},_e=function(Ie,Me,Qe,Ye,vt){for(var Kt=[],st=Ye,jt=0,Xt=0;st;++Xt)st&1&&(Kt[Xt]=vt[jt++]),st>>>=1;return Kt[Me]=Qe,fe(Ie,jt+1,Kt)},ke=function(Ie,Me,Qe,Ye){for(var vt=new Array(Me-1),Kt=0,st=0,jt=0,Xt=Ye.length;jt<Xt;++jt)if(jt!==Qe){var Gn=Ye[jt];Gn&&!re(Gn)&&(vt[Kt++]=Gn,st|=1<<jt)}return Ae(Ie,st,vt)},Vt=function De(Ie,Me,Qe,Ye,vt,Kt){if(Qe===vt)return Te(Ie,Qe,[Kt,Ye]);var st=w(Me,Qe),jt=w(Me,vt);return Ae(Ie,A(st)|A(jt),st===jt?[De(Ie,Me+r,Qe,Ye,vt,Kt)]:st<jt?[Ye,Kt]:[Kt,Ye])},ut=function(Ie,Me,Qe,Ye,vt,Kt,st,jt){for(var Xt=vt.length,Gn=0;Gn<Xt;++Gn){var Mn=vt[Gn];if(Qe(st,Mn.key)){var $n=Mn.value,un=Kt($n);return un===$n?vt:un===h?(--jt.value,U(Ie,Gn,vt)):M(Ie,Gn,ve(Me,Ye,st,un),vt)}}var Qr=Kt();return Qr===h?vt:(++jt.value,M(Ie,Xt,ve(Me,Ye,st,Qr),vt))},rn=function(Ie,Me){return Ie===Me.edit},ot=function(Ie,Me,Qe,Ye,vt,Kt,st){if(Me(Kt,this.key)){var jt=Ye(this.value);return jt===this.value?this:jt===h?(--st.value,ie):rn(Ie,this)?(this.value=jt,this):ve(Ie,vt,Kt,jt)}var Xt=Ye();return Xt===h?this:(++st.value,Vt(Ie,Qe,this.hash,this,vt,ve(Ie,vt,Kt,Xt)))},yt=function(Ie,Me,Qe,Ye,vt,Kt,st){if(vt===this.hash){var jt=rn(Ie,this),Xt=ut(jt,Ie,Me,this.hash,this.children,Ye,Kt,st);return Xt===this.children?this:Xt.length>1?Te(Ie,this.hash,Xt):Xt[0]}var Gn=Ye();return Gn===h?this:(++st.value,Vt(Ie,Qe,this.hash,this,vt,ve(Ie,vt,Kt,Gn)))},at=function(Ie,Me,Qe,Ye,vt,Kt,st){var jt=this.mask,Xt=this.children,Gn=w(Qe,vt),Mn=A(Gn),$n=L(jt,Mn),un=jt&Mn,Qr=un?Xt[$n]:ie,li=Qr._modify(Ie,Me,Qe+r,Ye,vt,Kt,st);if(Qr===li)return this;var Pi=rn(Ie,this),Ki=jt,os=void 0;if(un&&re(li)){if(Ki&=~Mn,!Ki)return ie;if(Xt.length<=2&&Pe(Xt[$n^1]))return Xt[$n^1];os=U(Pi,$n,Xt)}else if(!un&&!re(li)){if(Xt.length>=l)return _e(Ie,Gn,li,jt,Xt);Ki|=Mn,os=D(Pi,$n,li,Xt)}else os=M(Pi,$n,li,Xt);return Pi?(this.mask=Ki,this.children=os,this):Ae(Ie,Ki,os)},Mt=function(Ie,Me,Qe,Ye,vt,Kt,st){var jt=this.size,Xt=this.children,Gn=w(Qe,vt),Mn=Xt[Gn],$n=(Mn||ie)._modify(Ie,Me,Qe+r,Ye,vt,Kt,st);if(Mn===$n)return this;var un=rn(Ie,this),Qr=void 0;if(re(Mn)&&!re($n))++jt,Qr=M(un,Gn,$n,Xt);else if(!re(Mn)&&re($n)){if(--jt,jt<=o)return ke(Ie,jt,Gn,Xt);Qr=M(un,Gn,ie,Xt)}else Qr=M(un,Gn,$n,Xt);return un?(this.size=jt,this.children=Qr,this):fe(Ie,jt,Qr)};ie._modify=function(De,Ie,Me,Qe,Ye,vt,Kt){var st=Qe();return st===h?ie:(++Kt.value,ve(De,Ye,vt,st))};function Re(De,Ie,Me,Qe,Ye){this._editable=De,this._edit=Ie,this._config=Me,this._root=Qe,this._size=Ye}Re.prototype.setTree=function(De,Ie){return this._editable?(this._root=De,this._size=Ie,this):De===this._root?this:new Re(this._editable,this._edit,this._config,De,Ie)};var Ke=n.tryGetHash=function(De,Ie,Me,Qe){for(var Ye=Qe._root,vt=0,Kt=Qe._config.keyEq;;)switch(Ye.type){case $:return Kt(Me,Ye.key)?Ye.value:De;case N:{if(Ie===Ye.hash)for(var st=Ye.children,jt=0,Xt=st.length;jt<Xt;++jt){var Gn=st[jt];if(Kt(Me,Gn.key))return Gn.value}return De}case B:{var Mn=w(vt,Ie),$n=A(Mn);if(Ye.mask&$n){Ye=Ye.children[L(Ye.mask,$n)],vt+=r;break}return De}case Z:{if(Ye=Ye.children[w(vt,Ie)],Ye){vt+=r;break}return De}default:return De}};Re.prototype.tryGetHash=function(De,Ie,Me){return Ke(De,Ie,Me,this)};var Je=n.tryGet=function(De,Ie,Me){return Ke(De,Me._config.hash(Ie),Ie,Me)};Re.prototype.tryGet=function(De,Ie){return Je(De,Ie,this)};var kt=n.getHash=function(De,Ie,Me){return Ke(void 0,De,Ie,Me)};Re.prototype.getHash=function(De,Ie){return kt(De,Ie,this)},n.get=function(De,Ie){return Ke(void 0,Ie._config.hash(De),De,Ie)},Re.prototype.get=function(De,Ie){return Je(Ie,De,this)};var ft=n.has=function(De,Ie,Me){return Ke(h,De,Ie,Me)!==h};Re.prototype.hasHash=function(De,Ie){return ft(De,Ie,this)};var Pt=n.has=function(De,Ie){return ft(Ie._config.hash(De),De,Ie)};Re.prototype.has=function(De){return Pt(De,this)};var qt=function(Ie,Me){return Ie===Me};n.make=function(De){return new Re(0,0,{keyEq:De&&De.keyEq||qt,hash:De&&De.hash||b},ie,0)},n.empty=n.make();var lt=n.isEmpty=function(De){return De&&!!re(De._root)};Re.prototype.isEmpty=function(){return lt(this)};var tn=n.modifyHash=function(De,Ie,Me,Qe){var Ye={value:Qe._size},vt=Qe._root._modify(Qe._editable?Qe._edit:NaN,Qe._config.keyEq,0,De,Ie,Me,Ye);return Qe.setTree(vt,Ye.value)};Re.prototype.modifyHash=function(De,Ie,Me){return tn(Me,De,Ie,this)};var Fn=n.modify=function(De,Ie,Me){return tn(De,Me._config.hash(Ie),Ie,Me)};Re.prototype.modify=function(De,Ie){return Fn(Ie,De,this)};var St=n.setHash=function(De,Ie,Me,Qe){return tn(p(Me),De,Ie,Qe)};Re.prototype.setHash=function(De,Ie,Me){return St(De,Ie,Me,this)};var bt=n.set=function(De,Ie,Me){return St(Me._config.hash(De),De,Ie,Me)};Re.prototype.set=function(De,Ie){return bt(De,Ie,this)};var hn=p(h),ur=n.removeHash=function(De,Ie,Me){return tn(hn,De,Ie,Me)};Re.prototype.removeHash=Re.prototype.deleteHash=function(De,Ie){return ur(De,Ie,this)};var On=n.remove=function(De,Ie){return ur(Ie._config.hash(De),De,Ie)};Re.prototype.remove=Re.prototype.delete=function(De){return On(De,this)};var Ln=n.beginMutation=function(De){return new Re(De._editable+1,De._edit+1,De._config,De._root,De._size)};Re.prototype.beginMutation=function(){return Ln(this)};var is=n.endMutation=function(De){return De._editable=De._editable&&De._editable-1,De};Re.prototype.endMutation=function(){return is(this)};var dn=n.mutate=function(De,Ie){var Me=Ln(Ie);return De(Me),is(Me)};Re.prototype.mutate=function(De){return dn(De,this)};var mr=function(Ie){return Ie&&vn(Ie[0],Ie[1],Ie[2],Ie[3],Ie[4])},vn=function(Ie,Me,Qe,Ye,vt){for(;Qe<Ie;){var Kt=Me[Qe++];if(Kt&&!re(Kt))return Nr(Kt,Ye,[Ie,Me,Qe,Ye,vt])}return mr(vt)},Nr=function(Ie,Me,Qe){switch(Ie.type){case $:return{value:Me(Ie),rest:Qe};case N:case Z:case B:var Ye=Ie.children;return vn(Ye.length,Ye,0,Me,Qe);default:return mr(Qe)}},bs={done:!0};function Cr(De){this.v=De}Cr.prototype.next=function(){if(!this.v)return bs;var De=this.v;return this.v=mr(De.rest),De},Cr.prototype[Symbol.iterator]=function(){return this};var ai=function(Ie,Me){return new Cr(Nr(Ie._root,Me))},ko=function(Ie){return[Ie.key,Ie.value]},ss=n.entries=function(De){return ai(De,ko)};Re.prototype.entries=Re.prototype[Symbol.iterator]=function(){return ss(this)};var We=function(Ie){return Ie.key},pt=n.keys=function(De){return ai(De,We)};Re.prototype.keys=function(){return pt(this)};var Vs=function(Ie){return Ie.value},yi=n.values=Re.prototype.values=function(De){return ai(De,Vs)};Re.prototype.values=function(){return yi(this)};var fn=n.fold=function(De,Ie,Me){var Qe=Me._root;if(Qe.type===$)return De(Ie,Qe.value,Qe.key);for(var Ye=[Qe.children],vt=void 0;vt=Ye.pop();)for(var Kt=0,st=vt.length;Kt<st;){var jt=vt[Kt++];jt&&jt.type&&(jt.type===$?Ie=De(Ie,jt.value,jt.key):Ye.push(jt.children))}return Ie};Re.prototype.fold=function(De,Ie){return fn(De,Ie,this)};var Di=n.forEach=function(De,Ie){return fn(function(Me,Qe,Ye){return De(Qe,Ye,Ie)},null,Ie)};Re.prototype.forEach=function(De){return Di(De,this)};var Ai=n.count=function(De){return De._size};Re.prototype.count=function(){return Ai(this)},Object.defineProperty(Re.prototype,"size",{get:Re.prototype.count}),t.exports?t.exports=n:(void 0).hamt=n});class Kee{constructor(e){An(this,"_map",void 0),this._map=new Map(e==null?void 0:e.entries())}keys(){return this._map.keys()}entries(){return this._map.entries()}get(e){return this._map.get(e)}has(e){return this._map.has(e)}set(e,n){return this._map.set(e,n),this}delete(e){return this._map.delete(e),this}clone(){return bM(this)}toMap(){return new Map(this._map)}}class _M{constructor(e){if(An(this,"_hamt",qee.empty.beginMutation()),e instanceof _M){const n=e._hamt.endMutation();e._hamt=n.beginMutation(),this._hamt=n.beginMutation()}else if(e)for(const[n,r]of e.entries())this._hamt.set(n,r)}keys(){return this._hamt.keys()}entries(){return this._hamt.entries()}get(e){return this._hamt.get(e)}has(e){return this._hamt.has(e)}set(e,n){return this._hamt.set(e,n),this}delete(e){return this._hamt.delete(e),this}clone(){return bM(this)}toMap(){return new Map(this._hamt)}}function bM(t){return br("recoil_hamt_2020")?new _M(t):new Kee(t)}var Xee={persistentMap:bM},Zee=Xee.persistentMap,Yee=Object.freeze({__proto__:null,persistentMap:Zee});function Jee(t,...e){const n=new Set;e:for(const r of t){for(const i of e)if(i.has(r))continue e;n.add(r)}return n}var Rg=Jee;function Qee(t,e){const n=new Map;return t.forEach((r,i)=>{n.set(i,e(r,i))}),n}var wb=Qee;function ete(){return{nodeDeps:new Map,nodeToNodeSubscriptions:new Map}}function tte(t){return{nodeDeps:wb(t.nodeDeps,e=>new Set(e)),nodeToNodeSubscriptions:wb(t.nodeToNodeSubscriptions,e=>new Set(e))}}function v2(t,e,n,r){const{nodeDeps:i,nodeToNodeSubscriptions:s}=n,l=i.get(t);if(l&&r&&l!==r.nodeDeps.get(t))return;i.set(t,e);const o=l==null?e:Rg(e,l);for(const h of o)s.has(h)||s.set(h,new Set),Vr(s.get(h)).add(t);if(l){const h=Rg(l,e);for(const p of h){if(!s.has(p))return;const b=Vr(s.get(p));b.delete(t),b.size===0&&s.delete(p)}}}function nte(t,e,n,r){var i,s,l,o;const h=n.getState();r===h.currentTree.version||r===((i=h.nextTree)===null||i===void 0?void 0:i.version)||((s=h.previousTree)===null||s===void 0||s.version);const p=n.getGraph(r);if(v2(t,e,p),r===((l=h.previousTree)===null||l===void 0?void 0:l.version)){const x=n.getGraph(h.currentTree.version);v2(t,e,x,p)}if(r===((o=h.previousTree)===null||o===void 0?void 0:o.version)||r===h.currentTree.version){var b;const x=(b=h.nextTree)===null||b===void 0?void 0:b.version;if(x!==void 0){const w=n.getGraph(x);v2(t,e,w,p)}}}var zy={cloneGraph:tte,graph:ete,saveDepsToStore:nte};let rte=0;const ite=()=>rte++;let ste=0;const ote=()=>ste++;let ate=0;const lte=()=>ate++;var z1={getNextTreeStateVersion:ite,getNextStoreID:ote,getNextComponentID:lte};const{persistentMap:H5}=Yee,{graph:cte}=zy,{getNextTreeStateVersion:P7}=z1;function C7(){const t=P7();return{version:t,stateID:t,transactionMetadata:{},dirtyAtoms:new Set,atomValues:H5(),nonvalidatedAtoms:H5()}}function ute(){const t=C7();return{currentTree:t,nextTree:null,previousTree:null,commitDepth:0,knownAtoms:new Set,knownSelectors:new Set,transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(t.version,cte()),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map}}var L7={makeEmptyTreeState:C7,makeEmptyStoreState:ute,getNextTreeStateVersion:P7};class I7{}function dte(){return new I7}var B1={RetentionZone:I7,retentionZone:dte};function hte(t,e){const n=new Set(t);return n.add(e),n}function fte(t,e){const n=new Set(t);return n.delete(e),n}function pte(t,e,n){const r=new Map(t);return r.set(e,n),r}function mte(t,e,n){const r=new Map(t);return r.set(e,n(r.get(e))),r}function gte(t,e){const n=new Map(t);return n.delete(e),n}function yte(t,e){const n=new Map(t);return e.forEach(r=>n.delete(r)),n}var R7={setByAddingToSet:hte,setByDeletingFromSet:fte,mapBySettingInMap:pte,mapByUpdatingInMap:mte,mapByDeletingFromMap:gte,mapByDeletingMultipleFromMap:yte};function*vte(t,e){let n=0;for(const r of t)e(r,n++)&&(yield r)}var xM=vte;function _te(t,e){return new Proxy(t,{get:(r,i)=>(!(i in r)&&i in e&&(r[i]=e[i]()),r[i]),ownKeys:r=>Object.keys(r)})}var M7=_te;const{getNode:By,getNodeMaybe:bte,recoilValuesForKeys:q5}=ro,{RetentionZone:K5}=B1,{setByAddingToSet:xte}=R7,wte=Object.freeze(new Set);class Tte extends Error{}function Ete(t,e,n){if(!br("recoil_memory_managament_2020"))return()=>{};const{nodesRetainedByZone:r}=t.getState().retention;function i(s){let l=r.get(s);l||r.set(s,l=new Set),l.add(e)}if(n instanceof K5)i(n);else if(Array.isArray(n))for(const s of n)i(s);return()=>{if(!br("recoil_memory_managament_2020"))return;const{retention:s}=t.getState();function l(o){const h=s.nodesRetainedByZone.get(o);h==null||h.delete(e),h&&h.size===0&&s.nodesRetainedByZone.delete(o)}if(n instanceof K5)l(n);else if(Array.isArray(n))for(const o of n)l(o)}}function wM(t,e,n,r){const i=t.getState();if(i.nodeCleanupFunctions.has(n))return;const s=By(n),l=Ete(t,n,s.retainedBy),o=s.init(t,e,r);i.nodeCleanupFunctions.set(n,()=>{o(),l()})}function Ste(t,e,n){wM(t,t.getState().currentTree,e,n)}function Ate(t,e){var n;const r=t.getState();(n=r.nodeCleanupFunctions.get(e))===null||n===void 0||n(),r.nodeCleanupFunctions.delete(e)}function Pte(t,e,n){return wM(t,e,n,"get"),By(n).get(t,e)}function $7(t,e,n){return By(n).peek(t,e)}function Cte(t,e,n){var r;const i=bte(e);return i==null||(r=i.invalidate)===null||r===void 0||r.call(i,t),{...t,atomValues:t.atomValues.clone().delete(e),nonvalidatedAtoms:t.nonvalidatedAtoms.clone().set(e,n),dirtyAtoms:xte(t.dirtyAtoms,e)}}function Lte(t,e,n,r){const i=By(n);if(i.set==null)throw new Tte(`Attempt to set read-only RecoilValue: ${n}`);const s=i.set;return wM(t,e,n,"set"),s(t,e,r)}function Ite(t,e,n){const r=t.getState(),i=t.getGraph(e.version),s=By(n).nodeType;return M7({type:s},{loadable:()=>$7(t,e,n),isActive:()=>r.knownAtoms.has(n)||r.knownSelectors.has(n),isSet:()=>s==="selector"?!1:e.atomValues.has(n),isModified:()=>e.dirtyAtoms.has(n),deps:()=>{var l;return q5((l=i.nodeDeps.get(n))!==null&&l!==void 0?l:[])},subscribers:()=>{var l,o;return{nodes:q5(xM(k7(t,e,new Set([n])),h=>h!==n)),components:N1((l=(o=r.nodeToComponentSubscriptions.get(n))===null||o===void 0?void 0:o.values())!==null&&l!==void 0?l:[],([h])=>({name:h}))}}})}function k7(t,e,n){const r=new Set,i=Array.from(n),s=t.getGraph(e.version);for(let o=i.pop();o;o=i.pop()){var l;r.add(o);const h=(l=s.nodeToNodeSubscriptions.get(o))!==null&&l!==void 0?l:wte;for(const p of h)r.has(p)||i.push(p)}return r}var xu={getNodeLoadable:Pte,peekNodeLoadable:$7,setNodeValue:Lte,initializeNode:Ste,cleanUpNode:Ate,setUnvalidatedAtomValue_DEPRECATED:Cte,peekNodeInfo:Ite,getDownstreamNodes:k7};let O7=null;function Rte(t){O7=t}function Mte(){var t;(t=O7)===null||t===void 0||t()}var D7={setInvalidateMemoizedSnapshot:Rte,invalidateMemoizedSnapshot:Mte};const{getDownstreamNodes:$te,getNodeLoadable:F7,setNodeValue:kte}=xu,{getNextComponentID:Ote}=z1,{getNode:Dte,getNodeMaybe:N7}=ro,{DefaultValue:TM}=ro,{reactMode:Fte}=Ny,{AbstractRecoilValue:Nte,RecoilState:zte,RecoilValueReadOnly:Bte,isRecoilValue:Ute}=Zf,{invalidateMemoizedSnapshot:Vte}=D7;function jte(t,{key:e},n=t.getState().currentTree){var r,i;const s=t.getState();n.version===s.currentTree.version||n.version===((r=s.nextTree)===null||r===void 0?void 0:r.version)||(n.version,(i=s.previousTree)===null||i===void 0||i.version);const l=F7(t,n,e);return l.state==="loading"&&l.contents.catch(()=>{}),l}function Gte(t,e){const n=t.clone();return e.forEach((r,i)=>{r.state==="hasValue"&&r.contents instanceof TM?n.delete(i):n.set(i,r)}),n}function Wte(t,e,{key:n},r){if(typeof r=="function"){const i=F7(t,e,n);if(i.state==="loading"){const s=`Tried to set atom or selector "${n}" using an updater function while the current state is pending, this is not currently supported.`;throw In(s)}else if(i.state==="hasError")throw i.contents;return r(i.contents)}else return r}function Hte(t,e,n){if(n.type==="set"){const{recoilValue:i,valueOrUpdater:s}=n,l=Wte(t,e,i,s),o=kte(t,e,i.key,l);for(const[h,p]of o.entries())JE(e,h,p)}else if(n.type==="setLoadable"){const{recoilValue:{key:i},loadable:s}=n;JE(e,i,s)}else if(n.type==="markModified"){const{recoilValue:{key:i}}=n;e.dirtyAtoms.add(i)}else if(n.type==="setUnvalidated"){var r;const{recoilValue:{key:i},unvalidatedValue:s}=n,l=N7(i);l==null||(r=l.invalidate)===null||r===void 0||r.call(l,e),e.atomValues.delete(i),e.nonvalidatedAtoms.set(i,s),e.dirtyAtoms.add(i)}else gM(`Unknown action ${n.type}`)}function JE(t,e,n){n.state==="hasValue"&&n.contents instanceof TM?t.atomValues.delete(e):t.atomValues.set(e,n),t.dirtyAtoms.add(e),t.nonvalidatedAtoms.delete(e)}function z7(t,e){t.replaceState(n=>{const r=B7(n);for(const i of e)Hte(t,r,i);return U7(t,r),Vte(),r})}function U1(t,e){if(Mg.length){const n=Mg[Mg.length-1];let r=n.get(t);r||n.set(t,r=[]),r.push(e)}else z7(t,[e])}const Mg=[];function qte(){const t=new Map;return Mg.push(t),()=>{for(const[e,n]of t)z7(e,n);Mg.pop()}}function B7(t){return{...t,atomValues:t.atomValues.clone(),nonvalidatedAtoms:t.nonvalidatedAtoms.clone(),dirtyAtoms:new Set(t.dirtyAtoms)}}function U7(t,e){const n=$te(t,e,e.dirtyAtoms);for(const s of n){var r,i;(r=N7(s))===null||r===void 0||(i=r.invalidate)===null||i===void 0||i.call(r,e)}}function V7(t,e,n){U1(t,{type:"set",recoilValue:e,valueOrUpdater:n})}function Kte(t,e,n){if(n instanceof TM)return V7(t,e,n);U1(t,{type:"setLoadable",recoilValue:e,loadable:n})}function Xte(t,e){U1(t,{type:"markModified",recoilValue:e})}function Zte(t,e,n){U1(t,{type:"setUnvalidated",recoilValue:e,unvalidatedValue:n})}function Yte(t,{key:e},n,r=null){const i=Ote(),s=t.getState();s.nodeToComponentSubscriptions.has(e)||s.nodeToComponentSubscriptions.set(e,new Map),Vr(s.nodeToComponentSubscriptions.get(e)).set(i,[r??"<not captured>",n]);const l=Fte();if(l.early&&(l.mode==="LEGACY"||l.mode==="MUTABLE_SOURCE")){const o=t.getState().nextTree;o&&o.dirtyAtoms.has(e)&&n(o)}return{release:()=>{const o=t.getState(),h=o.nodeToComponentSubscriptions.get(e);h===void 0||!h.has(i)||(h.delete(i),h.size===0&&o.nodeToComponentSubscriptions.delete(e))}}}function Jte(t,e){var n;const{currentTree:r}=t.getState(),i=Dte(e.key);(n=i.clearCache)===null||n===void 0||n.call(i,t,r)}var hl={RecoilValueReadOnly:Bte,AbstractRecoilValue:Nte,RecoilState:zte,getRecoilValueAsLoadable:jte,setRecoilValue:V7,setRecoilValueLoadable:Kte,markRecoilValueModified:Xte,setUnvalidatedRecoilValue:Zte,subscribeToRecoilValue:Yte,isRecoilValue:Ute,applyAtomValueWrites:Gte,batchStart:qte,writeLoadableToTreeState:JE,invalidateDownstreams:U7,copyTreeState:B7,refreshRecoilValue:Jte};function Qte(t,e,n){const r=t.entries();let i=r.next();for(;!i.done;){const s=i.value;if(e.call(n,s[1],s[0],t))return!0;i=r.next()}return!1}var ene=Qte;const{cleanUpNode:tne}=xu,{deleteNodeConfigIfPossible:nne,getNode:j7}=ro,{RetentionZone:G7}=B1,rne=12e4,W7=new Set;function H7(t,e){const n=t.getState(),r=n.currentTree;if(n.nextTree)return;const i=new Set;for(const l of e)if(l instanceof G7)for(const o of ane(n,l))i.add(o);else i.add(l);const s=ine(t,i);for(const l of s)one(t,r,l)}function ine(t,e){const n=t.getState(),r=n.currentTree,i=t.getGraph(r.version),s=new Set,l=new Set;return o(e),s;function o(h){const p=new Set,b=sne(t,r,h,s,l);for(const L of b){var x;if(j7(L).retainedBy==="recoilRoot"){l.add(L);continue}if(((x=n.retention.referenceCounts.get(L))!==null&&x!==void 0?x:0)>0){l.add(L);continue}if(q7(L).some(U=>n.retention.referenceCounts.get(U))){l.add(L);continue}const M=i.nodeToNodeSubscriptions.get(L);if(M&&ene(M,U=>l.has(U))){l.add(L);continue}s.add(L),p.add(L)}const w=new Set;for(const L of p)for(const M of(A=i.nodeDeps.get(L))!==null&&A!==void 0?A:W7){var A;s.has(M)||w.add(M)}w.size&&o(w)}}function sne(t,e,n,r,i){const s=t.getGraph(e.version),l=[],o=new Set;for(;n.size>0;)h(Vr(n.values().next().value));return l;function h(p){if(r.has(p)||i.has(p)){n.delete(p);return}if(o.has(p))return;const b=s.nodeToNodeSubscriptions.get(p);if(b)for(const x of b)h(x);o.add(p),n.delete(p),l.push(p)}}function one(t,e,n){if(!br("recoil_memory_managament_2020"))return;tne(t,n);const r=t.getState();r.knownAtoms.delete(n),r.knownSelectors.delete(n),r.nodeTransactionSubscriptions.delete(n),r.retention.referenceCounts.delete(n);const i=q7(n);for(const h of i){var s;(s=r.retention.nodesRetainedByZone.get(h))===null||s===void 0||s.delete(n)}e.atomValues.delete(n),e.dirtyAtoms.delete(n),e.nonvalidatedAtoms.delete(n);const l=r.graphsByVersion.get(e.version);if(l){const h=l.nodeDeps.get(n);if(h!==void 0){l.nodeDeps.delete(n);for(const p of h){var o;(o=l.nodeToNodeSubscriptions.get(p))===null||o===void 0||o.delete(n)}}l.nodeToNodeSubscriptions.delete(n)}nne(n)}function ane(t,e){var n;return(n=t.retention.nodesRetainedByZone.get(e))!==null&&n!==void 0?n:W7}function q7(t){const e=j7(t).retainedBy;return e===void 0||e==="components"||e==="recoilRoot"?[]:e instanceof G7?[e]:e}function lne(t,e){const n=t.getState();n.nextTree?n.retention.retainablesToCheckForRelease.add(e):H7(t,new Set([e]))}function cne(t,e,n){var r;if(!br("recoil_memory_managament_2020"))return;const i=t.getState().retention.referenceCounts,s=((r=i.get(e))!==null&&r!==void 0?r:0)+n;s===0?K7(t,e):i.set(e,s)}function K7(t,e){if(!br("recoil_memory_managament_2020"))return;t.getState().retention.referenceCounts.delete(e),lne(t,e)}function une(t){if(!br("recoil_memory_managament_2020"))return;const e=t.getState();H7(t,e.retention.retainablesToCheckForRelease),e.retention.retainablesToCheckForRelease.clear()}function dne(t){return t===void 0?"recoilRoot":t}var Jd={SUSPENSE_TIMEOUT_MS:rne,updateRetainCount:cne,updateRetainCountToZero:K7,releaseScheduledRetainablesNow:une,retainedByOptionWithDefault:dne};const{unstable_batchedUpdates:hne}=vd;var fne={unstable_batchedUpdates:hne};const{unstable_batchedUpdates:pne}=fne;var mne={unstable_batchedUpdates:pne};const{batchStart:gne}=hl,{unstable_batchedUpdates:yne}=mne;let EM=yne||(t=>t());const vne=t=>{EM=t},_ne=()=>EM,bne=t=>{EM(()=>{let e=()=>{};try{e=gne(),t()}finally{e()}})};var V1={getBatcher:_ne,setBatcher:vne,batchUpdates:bne};function*xne(t){for(const e of t)for(const n of e)yield n}var X7=xne;const Z7=typeof Window>"u"||typeof window>"u",wne=t=>!Z7&&(t===window||t instanceof Window),Tne=typeof navigator<"u"&&navigator.product==="ReactNative";var j1={isSSR:Z7,isReactNative:Tne,isWindow:wne};function Ene(t,e){let n;return(...r)=>{n||(n={});const i=e(...r);return Object.hasOwnProperty.call(n,i)||(n[i]=t(...r)),n[i]}}function Sne(t,e){let n,r;return(...i)=>{const s=e(...i);return n===s||(n=s,r=t(...i)),r}}function Ane(t,e){let n,r;return[(...l)=>{const o=e(...l);return n===o||(n=o,r=t(...l)),r},()=>{n=null}]}var Pne={memoizeWithArgsHash:Ene,memoizeOneWithArgsHash:Sne,memoizeOneWithArgsHashAndInvalidation:Ane};const{batchUpdates:QE}=V1,{initializeNode:Cne,peekNodeInfo:Lne}=xu,{graph:Ine}=zy,{getNextStoreID:Rne}=z1,{DEFAULT_VALUE:Mne,recoilValues:X5,recoilValuesForKeys:Z5}=ro,{AbstractRecoilValue:$ne,getRecoilValueAsLoadable:kne,setRecoilValue:Y5,setUnvalidatedRecoilValue:One}=hl,{updateRetainCount:$_}=Jd,{setInvalidateMemoizedSnapshot:Dne}=D7,{getNextTreeStateVersion:Fne,makeEmptyStoreState:Nne}=L7,{isSSR:zne}=j1,{memoizeOneWithArgsHashAndInvalidation:Bne}=Pne;class G1{constructor(e,n){An(this,"_store",void 0),An(this,"_refCount",1),An(this,"getLoadable",r=>(this.checkRefCount_INTERNAL(),kne(this._store,r))),An(this,"getPromise",r=>(this.checkRefCount_INTERNAL(),this.getLoadable(r).toPromise())),An(this,"getNodes_UNSTABLE",r=>{if(this.checkRefCount_INTERNAL(),(r==null?void 0:r.isModified)===!0){if((r==null?void 0:r.isInitialized)===!1)return[];const l=this._store.getState().currentTree;return Z5(l.dirtyAtoms)}const i=this._store.getState().knownAtoms,s=this._store.getState().knownSelectors;return(r==null?void 0:r.isInitialized)==null?X5.values():r.isInitialized===!0?Z5(X7([i,s])):xM(X5.values(),({key:l})=>!i.has(l)&&!s.has(l))}),An(this,"getInfo_UNSTABLE",({key:r})=>(this.checkRefCount_INTERNAL(),Lne(this._store,this._store.getState().currentTree,r))),An(this,"map",r=>{this.checkRefCount_INTERNAL();const i=new eS(this,QE);return r(i),i}),An(this,"asyncMap",async r=>{this.checkRefCount_INTERNAL();const i=new eS(this,QE);return i.retain(),await r(i),i.autoRelease_INTERNAL(),i}),this._store={storeID:Rne(),parentStoreID:n,getState:()=>e,replaceState:r=>{e.currentTree=r(e.currentTree)},getGraph:r=>{const i=e.graphsByVersion;if(i.has(r))return Vr(i.get(r));const s=Ine();return i.set(r,s),s},subscribeToTransactions:()=>({release:()=>{}}),addTransactionMetadata:()=>{throw In("Cannot subscribe to Snapshots")}};for(const r of this._store.getState().knownAtoms)Cne(this._store,r,"get"),$_(this._store,r,1);this.autoRelease_INTERNAL()}retain(){this._refCount<=0,this._refCount++;let e=!1;return()=>{e||(e=!0,this._release())}}autoRelease_INTERNAL(){zne||window.setTimeout(()=>this._release(),10)}_release(){if(this._refCount--,this._refCount===0){if(this._store.getState().nodeCleanupFunctions.forEach(e=>e()),this._store.getState().nodeCleanupFunctions.clear(),!br("recoil_memory_managament_2020"))return}else this._refCount<0}isRetained(){return this._refCount>0}checkRefCount_INTERNAL(){br("recoil_memory_managament_2020")&&this._refCount<=0}getStore_INTERNAL(){return this.checkRefCount_INTERNAL(),this._store}getID(){return this.checkRefCount_INTERNAL(),this._store.getState().currentTree.stateID}getStoreID(){return this.checkRefCount_INTERNAL(),this._store.storeID}}function Y7(t,e,n=!1){const r=t.getState(),i=n?Fne():e.version;return{currentTree:{version:n?i:e.version,stateID:n?i:e.stateID,transactionMetadata:{...e.transactionMetadata},dirtyAtoms:new Set(e.dirtyAtoms),atomValues:e.atomValues.clone(),nonvalidatedAtoms:e.nonvalidatedAtoms.clone()},commitDepth:0,nextTree:null,previousTree:null,knownAtoms:new Set(r.knownAtoms),knownSelectors:new Set(r.knownSelectors),transactionSubscriptions:new Map,nodeTransactionSubscriptions:new Map,nodeToComponentSubscriptions:new Map,queuedComponentCallbacks_DEPRECATED:[],suspendedComponentResolvers:new Set,graphsByVersion:new Map().set(i,t.getGraph(e.version)),retention:{referenceCounts:new Map,nodesRetainedByZone:new Map,retainablesToCheckForRelease:new Set},nodeCleanupFunctions:new Map(N1(r.nodeCleanupFunctions.entries(),([s])=>[s,()=>{}]))}}function Une(t){const e=new G1(Nne());return t!=null?e.map(t):e}const[J5,J7]=Bne((t,e)=>{var n;const r=t.getState(),i=e==="latest"?(n=r.nextTree)!==null&&n!==void 0?n:r.currentTree:Vr(r.previousTree);return new G1(Y7(t,i),t.storeID)},(t,e)=>{var n,r;return String(e)+String(t.storeID)+String((n=t.getState().nextTree)===null||n===void 0?void 0:n.version)+String(t.getState().currentTree.version)+String((r=t.getState().previousTree)===null||r===void 0?void 0:r.version)});Dne(J7);function Vne(t,e="latest"){const n=J5(t,e);return n.isRetained()?n:(J7(),J5(t,e))}class eS extends G1{constructor(e,n){super(Y7(e.getStore_INTERNAL(),e.getStore_INTERNAL().getState().currentTree,!0),e.getStoreID()),An(this,"_batch",void 0),An(this,"set",(r,i)=>{this.checkRefCount_INTERNAL();const s=this.getStore_INTERNAL();this._batch(()=>{$_(s,r.key,1),Y5(this.getStore_INTERNAL(),r,i)})}),An(this,"reset",r=>{this.checkRefCount_INTERNAL();const i=this.getStore_INTERNAL();this._batch(()=>{$_(i,r.key,1),Y5(this.getStore_INTERNAL(),r,Mne)})}),An(this,"setUnvalidatedAtomValues_DEPRECATED",r=>{this.checkRefCount_INTERNAL();const i=this.getStore_INTERNAL();QE(()=>{for(const[s,l]of r.entries())$_(i,s,1),One(i,new $ne(s),l)})}),this._batch=n}}var W1={Snapshot:G1,MutableSnapshot:eS,freshSnapshot:Une,cloneSnapshot:Vne},jne=W1.Snapshot,Gne=W1.MutableSnapshot,Wne=W1.freshSnapshot,Hne=W1.cloneSnapshot,H1=Object.freeze({__proto__:null,Snapshot:jne,MutableSnapshot:Gne,freshSnapshot:Wne,cloneSnapshot:Hne});function qne(...t){const e=new Set;for(const n of t)for(const r of n)e.add(r);return e}var Kne=qne;const{useRef:Xne}=le;function Zne(t){const e=Xne(t);return e.current===t&&typeof t=="function"&&(e.current=t()),e}var Q5=Zne;const{getNextTreeStateVersion:Yne,makeEmptyStoreState:Q7}=L7,{cleanUpNode:Jne,getDownstreamNodes:Qne,initializeNode:ere,setNodeValue:tre,setUnvalidatedAtomValue_DEPRECATED:nre}=xu,{graph:rre}=zy,{cloneGraph:ire}=zy,{getNextStoreID:eB}=z1,{createMutableSource:_2,reactMode:tB}=Ny,{applyAtomValueWrites:sre}=hl,{releaseScheduledRetainablesNow:nB}=Jd,{freshSnapshot:ore}=H1,{useCallback:are,useContext:rB,useEffect:tS,useMemo:lre,useRef:cre,useState:ure}=le;function Om(){throw In("This component must be used inside a <RecoilRoot> component.")}const iB=Object.freeze({storeID:eB(),getState:Om,replaceState:Om,getGraph:Om,subscribeToTransactions:Om,addTransactionMetadata:Om});let nS=!1;function e8(t){if(nS)throw In("An atom update was triggered within the execution of a state updater function. State updater functions provided to Recoil must be pure functions.");const e=t.getState();if(e.nextTree===null){br("recoil_memory_managament_2020")&&br("recoil_release_on_cascading_update_killswitch_2021")&&e.commitDepth>0&&nB(t);const n=e.currentTree.version,r=Yne();e.nextTree={...e.currentTree,version:r,stateID:r,dirtyAtoms:new Set,transactionMetadata:{}},e.graphsByVersion.set(r,ire(Vr(e.graphsByVersion.get(n))))}}const sB=le.createContext({current:iB}),q1=()=>rB(sB),oB=le.createContext(null);function dre(){return rB(oB)}function SM(t,e,n){const r=Qne(t,n,n.dirtyAtoms);for(const i of r){const s=e.nodeToComponentSubscriptions.get(i);if(s)for(const[l,[o,h]]of s)h(n)}}function aB(t){const e=t.getState(),n=e.currentTree,r=n.dirtyAtoms;if(r.size){for(const[i,s]of e.nodeTransactionSubscriptions)if(r.has(i))for(const[l,o]of s)o(t);for(const[i,s]of e.transactionSubscriptions)s(t);(!tB().early||e.suspendedComponentResolvers.size>0)&&(SM(t,e,n),e.suspendedComponentResolvers.forEach(i=>i()),e.suspendedComponentResolvers.clear())}e.queuedComponentCallbacks_DEPRECATED.forEach(i=>i(n)),e.queuedComponentCallbacks_DEPRECATED.splice(0,e.queuedComponentCallbacks_DEPRECATED.length)}function hre(t){const e=t.getState();e.commitDepth++;try{const{nextTree:n}=e;if(n==null)return;e.previousTree=e.currentTree,e.currentTree=n,e.nextTree=null,aB(t),e.previousTree!=null?e.graphsByVersion.delete(e.previousTree.version):gM("Ended batch with no previous state, which is unexpected","recoil"),e.previousTree=null,br("recoil_memory_managament_2020")&&n==null&&nB(t)}finally{e.commitDepth--}}function fre({setNotifyBatcherOfChange:t}){const e=q1(),[,n]=ure([]);return t(()=>n({})),tS(()=>(t(()=>n({})),()=>{t(()=>{})}),[t]),tS(()=>{Wee.enqueueExecution("Batcher",()=>{hre(e.current)})}),null}function pre(t,e){const n=Q7();return e({set:(r,i)=>{const s=n.currentTree,l=tre(t,s,r.key,i),o=new Set(l.keys()),h=s.nonvalidatedAtoms.clone();for(const p of o)h.delete(p);n.currentTree={...s,dirtyAtoms:Kne(s.dirtyAtoms,o),atomValues:sre(s.atomValues,l),nonvalidatedAtoms:h}},setUnvalidatedAtomValues:r=>{r.forEach((i,s)=>{n.currentTree=nre(n.currentTree,s,i)})}}),n}function mre(t){const e=ore(t),n=e.getStore_INTERNAL().getState();return e.retain(),n.nodeCleanupFunctions.forEach(r=>r()),n.nodeCleanupFunctions.clear(),n}let t8=0;function gre({initializeState_DEPRECATED:t,initializeState:e,store_INTERNAL:n,children:r}){let i;const s=A=>{const L=i.current.graphsByVersion;if(L.has(A))return Vr(L.get(A));const M=rre();return L.set(A,M),M},l=(A,L)=>{if(L==null){const{transactionSubscriptions:M}=x.current.getState(),U=t8++;return M.set(U,A),{release:()=>{M.delete(U)}}}else{const{nodeTransactionSubscriptions:M}=x.current.getState();M.has(L)||M.set(L,new Map);const U=t8++;return Vr(M.get(L)).set(U,A),{release:()=>{const D=M.get(L);D&&(D.delete(U),D.size===0&&M.delete(L))}}}},o=A=>{e8(x.current);for(const L of Object.keys(A))Vr(x.current.getState().nextTree).transactionMetadata[L]=A[L]},h=A=>{e8(x.current);const L=Vr(i.current.nextTree);let M;try{nS=!0,M=A(L)}finally{nS=!1}M!==L&&(i.current.nextTree=M,tB().early&&SM(x.current,i.current,M),Vr(p.current)())},p=cre(null),b=are(A=>{p.current=A},[p]),x=Q5(()=>n??{storeID:eB(),getState:()=>i.current,replaceState:h,getGraph:s,subscribeToTransactions:l,addTransactionMetadata:o});n!=null&&(x.current=n),i=Q5(()=>t!=null?pre(x.current,t):e!=null?mre(e):Q7());const w=lre(()=>_2==null?void 0:_2(i,()=>i.current.currentTree.version),[i]);return tS(()=>{const A=x.current;for(const L of new Set(A.getState().knownAtoms))ere(A,L,"get");return()=>{for(const L of A.getState().knownAtoms)Jne(A,L)}},[x]),le.createElement(sB.Provider,{value:x},le.createElement(oB.Provider,{value:w},le.createElement(fre,{setNotifyBatcherOfChange:b}),r))}function yre(t){const{override:e,...n}=t,r=q1();return e===!1&&r.current!==iB?t.children:le.createElement(gre,n)}function vre(){return q1().current.storeID}var oc={RecoilRoot:yre,useStoreRef:q1,useRecoilMutableSource:dre,useRecoilStoreID:vre,notifyComponents_FOR_TESTING:SM,sendEndOfBatchNotifications_FOR_TESTING:aB};function _re(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}var bre=_re;const{useEffect:xre,useRef:wre}=le;function Tre(t){const e=wre();return xre(()=>{e.current=t}),e.current}var lB=Tre;const{useStoreRef:Ere}=oc,{SUSPENSE_TIMEOUT_MS:Sre}=Jd,{updateRetainCount:Dm}=Jd,{RetentionZone:Are}=B1,{useEffect:Pre,useRef:Cre}=le,{isSSR:n8}=j1;function Lre(t){if(br("recoil_memory_managament_2020"))return Ire(t)}function Ire(t){const n=(Array.isArray(t)?t:[t]).map(l=>l instanceof Are?l:l.key),r=Ere();Pre(()=>{if(!br("recoil_memory_managament_2020"))return;const l=r.current;if(i.current&&!n8)window.clearTimeout(i.current),i.current=null;else for(const o of n)Dm(l,o,1);return()=>{for(const o of n)Dm(l,o,-1)}},[r,...n]);const i=Cre(),s=lB(n);if(!n8&&(s===void 0||!bre(s,n))){const l=r.current;for(const o of n)Dm(l,o,1);if(s)for(const o of s)Dm(l,o,-1);i.current&&window.clearTimeout(i.current),i.current=window.setTimeout(()=>{i.current=null;for(const o of n)Dm(l,o,-1)},Sre)}}var AM=Lre;function Rre(){return"<component name not available>"}var Uy=Rre;const{batchUpdates:Mre}=V1,{DEFAULT_VALUE:cB}=ro,{currentRendererSupportsUseSyncExternalStore:$re,reactMode:xp,useMutableSource:kre,useSyncExternalStore:Ore}=Ny,{useRecoilMutableSource:Dre,useStoreRef:fl}=oc,{AbstractRecoilValue:rS,getRecoilValueAsLoadable:Vy,setRecoilValue:Tb,setUnvalidatedRecoilValue:Fre,subscribeToRecoilValue:Yf}=hl,{useCallback:no,useEffect:Jf,useMemo:uB,useRef:$g,useState:PM}=le,{setByAddingToSet:Nre}=R7,{isSSR:zre}=j1;function CM(t,e,n){if(t.state==="hasValue")return t.contents;throw t.state==="loading"?new Promise(i=>{const s=n.current.getState().suspendedComponentResolvers;s.add(i),zre&&Dr(t.contents)&&t.contents.finally(()=>{s.delete(i)})}):t.state==="hasError"?t.contents:In(`Invalid value of loadable atom "${e.key}"`)}function Bre(){const t=Uy(),e=fl(),[,n]=PM([]),r=$g(new Set);r.current=new Set;const i=$g(new Set),s=$g(new Map),l=no(h=>{const p=s.current.get(h);p&&(p.release(),s.current.delete(h))},[s]),o=no((h,p)=>{s.current.has(p)&&n([])},[]);return Jf(()=>{const h=e.current;Rg(r.current,i.current).forEach(p=>{if(s.current.has(p))return;const b=Yf(h,new rS(p),w=>o(w,p),t);s.current.set(p,b),h.getState().nextTree?h.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{o(h.getState(),p)}):o(h.getState(),p)}),Rg(i.current,r.current).forEach(p=>{l(p)}),i.current=r.current}),Jf(()=>{const h=s.current;return Rg(r.current,new Set(h.keys())).forEach(p=>{const b=Yf(e.current,new rS(p),x=>o(x,p),t);h.set(p,b)}),()=>h.forEach((p,b)=>l(b))},[t,e,l,o]),uB(()=>{function h(L){return M=>{Tb(e.current,L,M)}}function p(L){return()=>Tb(e.current,L,cB)}function b(L){var M;r.current.has(L.key)||(r.current=Nre(r.current,L.key));const U=e.current.getState();return Vy(e.current,L,xp().early&&(M=U.nextTree)!==null&&M!==void 0?M:U.currentTree)}function x(L){const M=b(L);return CM(M,L,e)}function w(L){return[x(L),h(L)]}function A(L){return[b(L),h(L)]}return{getRecoilValue:x,getRecoilValueLoadable:b,getRecoilState:w,getRecoilStateLoadable:A,getSetRecoilState:h,getResetRecoilState:p}},[r,e])}const Ure={current:0};function Vre(t){const e=fl(),n=Uy(),r=no(()=>{var o;const h=e.current,p=h.getState(),b=xp().early&&(o=p.nextTree)!==null&&o!==void 0?o:p.currentTree;return{loadable:Vy(h,t,b),key:t.key}},[e,t]),i=no(o=>{let h;return()=>{var p,b;const x=o();return(p=h)!==null&&p!==void 0&&p.loadable.is(x.loadable)&&((b=h)===null||b===void 0?void 0:b.key)===x.key?h:(h=x,x)}},[]),s=uB(()=>i(r),[r,i]),l=no(o=>{const h=e.current;return Yf(h,t,o,n).release},[e,t,n]);return Ore(l,s,s).loadable}function jre(t){const e=fl(),n=no(()=>{var p;const b=e.current,x=b.getState(),w=xp().early&&(p=x.nextTree)!==null&&p!==void 0?p:x.currentTree;return Vy(b,t,w)},[e,t]),r=no(()=>n(),[n]),i=Uy(),s=no((p,b)=>{const x=e.current;return Yf(x,t,()=>{if(!br("recoil_suppress_rerender_in_callback"))return b();const A=n();h.current.is(A)||b(),h.current=A},i).release},[e,t,i,n]),l=Dre();if(l==null)throw In("Recoil hooks must be used in components contained within a <RecoilRoot> component.");const o=kre(l,r,s),h=$g(o);return Jf(()=>{h.current=o}),o}function iS(t){const e=fl(),n=Uy(),r=no(()=>{var h;const p=e.current,b=p.getState(),x=xp().early&&(h=b.nextTree)!==null&&h!==void 0?h:b.currentTree;return Vy(p,t,x)},[e,t]),i=no(()=>({loadable:r(),key:t.key}),[r,t.key]),s=no(h=>{const p=i();return h.loadable.is(p.loadable)&&h.key===p.key?h:p},[i]);Jf(()=>{const h=Yf(e.current,t,p=>{o(s)},n);return o(s),h.release},[n,t,e,s]);const[l,o]=PM(i);return l.key!==t.key?i().loadable:l.loadable}function Gre(t){const e=fl(),[,n]=PM([]),r=Uy(),i=no(()=>{var o;const h=e.current,p=h.getState(),b=xp().early&&(o=p.nextTree)!==null&&o!==void 0?o:p.currentTree;return Vy(h,t,b)},[e,t]),s=i(),l=$g(s);return Jf(()=>{l.current=s}),Jf(()=>{const o=e.current,h=o.getState(),p=Yf(o,t,x=>{var w;if(!br("recoil_suppress_rerender_in_callback"))return n([]);const A=i();(w=l.current)!==null&&w!==void 0&&w.is(A)||n(A),l.current=A},r);if(h.nextTree)o.getState().queuedComponentCallbacks_DEPRECATED.push(()=>{l.current=null,n([])});else{var b;if(!br("recoil_suppress_rerender_in_callback"))return n([]);const x=i();(b=l.current)!==null&&b!==void 0&&b.is(x)||n(x),l.current=x}return p.release},[r,i,t,e]),s}function LM(t){return br("recoil_memory_managament_2020")&&AM(t),{TRANSITION_SUPPORT:iS,SYNC_EXTERNAL_STORE:$re()?Vre:iS,MUTABLE_SOURCE:jre,LEGACY:Gre}[xp().mode](t)}function dB(t){const e=fl(),n=LM(t);return CM(n,t,e)}function K1(t){const e=fl();return no(n=>{Tb(e.current,t,n)},[e,t])}function Wre(t){const e=fl();return no(()=>{Tb(e.current,t,cB)},[e,t])}function Hre(t){return[dB(t),K1(t)]}function qre(t){return[LM(t),K1(t)]}function Kre(){const t=fl();return(e,n={})=>{Mre(()=>{t.current.addTransactionMetadata(n),e.forEach((r,i)=>Fre(t.current,new rS(i),r))})}}function hB(t){return br("recoil_memory_managament_2020")&&AM(t),iS(t)}function fB(t){const e=fl(),n=hB(t);return CM(n,t,e)}function Xre(t){return[fB(t),K1(t)]}var Zre={recoilComponentGetRecoilValueCount_FOR_TESTING:Ure,useRecoilInterface:Bre,useRecoilState:Hre,useRecoilStateLoadable:qre,useRecoilValue:dB,useRecoilValueLoadable:LM,useResetRecoilState:Wre,useSetRecoilState:K1,useSetUnvalidatedAtomValues:Kre,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:hB,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:fB,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:Xre};function Yre(t,e){const n=new Map;for(const[r,i]of t)e(i,r)&&n.set(r,i);return n}var Jre=Yre;function Qre(t,e){const n=new Set;for(const r of t)e(r)&&n.add(r);return n}var eie=Qre;function tie(...t){const e=new Map;for(let n=0;n<t.length;n++){const r=t[n].keys();let i;for(;!(i=r.next()).done;)e.set(i.value,t[n].get(i.value))}return e}var nie=tie;const{batchUpdates:rie}=V1,{DEFAULT_VALUE:iie,getNode:pB,nodes:sie}=ro,{useStoreRef:IM}=oc,{AbstractRecoilValue:oie,setRecoilValueLoadable:aie}=hl,{SUSPENSE_TIMEOUT_MS:lie}=Jd,{cloneSnapshot:Eb}=H1,{useCallback:X1,useEffect:mB,useRef:r8,useState:cie}=le,{isSSR:i8}=j1;function Z1(t){const e=IM();mB(()=>e.current.subscribeToTransactions(t).release,[t,e])}function s8(t){const e=t.atomValues.toMap(),n=wb(Jre(e,(r,i)=>{const l=pB(i).persistence_UNSTABLE;return l!=null&&l.type!=="none"&&r.state==="hasValue"}),r=>r.contents);return nie(t.nonvalidatedAtoms.toMap(),n)}function uie(t){Z1(X1(e=>{let n=e.getState().previousTree;const r=e.getState().currentTree;n||(n=e.getState().currentTree);const i=s8(r),s=s8(n),l=wb(sie,h=>{var p,b,x,w;return{persistence_UNSTABLE:{type:(p=(b=h.persistence_UNSTABLE)===null||b===void 0?void 0:b.type)!==null&&p!==void 0?p:"none",backButton:(x=(w=h.persistence_UNSTABLE)===null||w===void 0?void 0:w.backButton)!==null&&x!==void 0?x:!1}}}),o=eie(r.dirtyAtoms,h=>i.has(h)||s.has(h));t({atomValues:i,previousAtomValues:s,atomInfo:l,modifiedAtoms:o,transactionMetadata:{...r.transactionMetadata}})},[t]))}function die(t){Z1(X1(e=>{const n=Eb(e,"latest"),r=Eb(e,"previous");t({snapshot:n,previousSnapshot:r})},[t]))}function hie(){const t=IM(),[e,n]=cie(()=>Eb(t.current)),r=lB(e),i=r8(),s=r8();if(Z1(X1(o=>n(Eb(o)),[])),mB(()=>{const o=e.retain();if(i.current&&!i8){var h;window.clearTimeout(i.current),i.current=null,(h=s.current)===null||h===void 0||h.call(s),s.current=null}return()=>{window.setTimeout(o,10)}},[e]),r!==e&&!i8){if(i.current){var l;window.clearTimeout(i.current),i.current=null,(l=s.current)===null||l===void 0||l.call(s),s.current=null}s.current=e.retain(),i.current=window.setTimeout(()=>{var o;i.current=null,(o=s.current)===null||o===void 0||o.call(s),s.current=null},lie)}return e}function gB(t,e){var n;const r=t.getState(),i=(n=r.nextTree)!==null&&n!==void 0?n:r.currentTree,s=e.getStore_INTERNAL().getState().currentTree;rie(()=>{const l=new Set;for(const p of[i.atomValues.keys(),s.atomValues.keys()])for(const b of p){var o,h;((o=i.atomValues.get(b))===null||o===void 0?void 0:o.contents)!==((h=s.atomValues.get(b))===null||h===void 0?void 0:h.contents)&&pB(b).shouldRestoreFromSnapshots&&l.add(b)}l.forEach(p=>{aie(t,new oie(p),s.atomValues.has(p)?Vr(s.atomValues.get(p)):iie)}),t.replaceState(p=>({...p,stateID:e.getID()}))})}function fie(){const t=IM();return X1(e=>gB(t.current,e),[t])}var yB={useRecoilSnapshot:hie,gotoSnapshot:gB,useGotoRecoilSnapshot:fie,useRecoilTransactionObserver:die,useTransactionObservation_DEPRECATED:uie,useTransactionSubscription_DEPRECATED:Z1};const{peekNodeInfo:pie}=xu,{useStoreRef:mie}=oc;function gie(){const t=mie();return({key:e})=>pie(t.current,t.current.getState().currentTree,e)}var yie=gie;const{reactMode:vie}=Ny,{RecoilRoot:_ie,useStoreRef:bie}=oc,{useMemo:xie}=le;function wie(){vie().mode==="MUTABLE_SOURCE"&&console.warn("Warning: There are known issues using useRecoilBridgeAcrossReactRoots() in recoil_mutable_source rendering mode.  Please consider upgrading to recoil_sync_external_store mode.");const t=bie().current;return xie(()=>{function e({children:n}){return le.createElement(_ie,{store_INTERNAL:t},n)}return e},[t])}var Tie=wie;const{loadableWithValue:Eie}=Fy,{initializeNode:Sie}=xu,{DEFAULT_VALUE:Aie,getNode:Pie}=ro,{copyTreeState:Cie,getRecoilValueAsLoadable:Lie,invalidateDownstreams:Iie,writeLoadableToTreeState:Rie}=hl;function o8(t){return Pie(t.key).nodeType==="atom"}class Mie{constructor(e,n){An(this,"_store",void 0),An(this,"_treeState",void 0),An(this,"_changes",void 0),An(this,"get",r=>{if(this._changes.has(r.key))return this._changes.get(r.key);if(!o8(r))throw In("Reading selectors within atomicUpdate is not supported");const i=Lie(this._store,r,this._treeState);if(i.state==="hasValue")return i.contents;throw i.state==="hasError"?i.contents:In(`Expected Recoil atom ${r.key} to have a value, but it is in a loading state.`)}),An(this,"set",(r,i)=>{if(!o8(r))throw In("Setting selectors within atomicUpdate is not supported");if(typeof i=="function"){const s=this.get(r);this._changes.set(r.key,i(s))}else Sie(this._store,r.key,"set"),this._changes.set(r.key,i)}),An(this,"reset",r=>{this.set(r,Aie)}),this._store=e,this._treeState=n,this._changes=new Map}newTreeState_INTERNAL(){if(this._changes.size===0)return this._treeState;const e=Cie(this._treeState);for(const[n,r]of this._changes)Rie(e,n,Eie(r));return Iie(this._store,e),e}}function $ie(t){return e=>{t.replaceState(n=>{const r=new Mie(t,n);return e(r),r.newTreeState_INTERNAL()})}}var kie={atomicUpdater:$ie},Oie=kie.atomicUpdater,vB=Object.freeze({__proto__:null,atomicUpdater:Oie});function Die(t,e){if(!t)throw new Error(e)}var Fie=Die,dg=Fie;const{atomicUpdater:Nie}=vB,{batchUpdates:zie}=V1,{DEFAULT_VALUE:Bie}=ro,{useStoreRef:Uie}=oc,{refreshRecoilValue:Vie,setRecoilValue:a8}=hl,{cloneSnapshot:jie}=H1,{gotoSnapshot:Gie}=yB,{useCallback:Wie}=le;class _B{}const Hie=new _B;function bB(t,e,n,r){let i=Hie,s;if(zie(()=>{const o="useRecoilCallback() expects a function that returns a function: it accepts a function of the type (RecoilInterface) => (Args) => ReturnType and returns a callback function (Args) => ReturnType, where RecoilInterface is an object {snapshot, set, ...} and Args and ReturnType are the argument and return types of the callback you want to create.  Please see the docs at recoiljs.org for details.";if(typeof e!="function")throw In(o);const h=M7({...r??{},set:(b,x)=>a8(t,b,x),reset:b=>a8(t,b,Bie),refresh:b=>Vie(t,b),gotoSnapshot:b=>Gie(t,b),transact_UNSTABLE:b=>Nie(t)(b)},{snapshot:()=>{const b=jie(t);return s=b.retain(),b}}),p=e(h);if(typeof p!="function")throw In(o);i=p(...n)}),i instanceof _B&&dg(!1),Dr(i))i=i.finally(()=>{var o;(o=s)===null||o===void 0||o()});else{var l;(l=s)===null||l===void 0||l()}return i}function qie(t,e){const n=Uie();return Wie((...r)=>bB(n.current,t,r),e!=null?[...e,n]:void 0)}var xB={recoilCallback:bB,useRecoilCallback:qie};const{useStoreRef:Kie}=oc,{refreshRecoilValue:Xie}=hl,{useCallback:Zie}=le;function Yie(t){const e=Kie();return Zie(()=>{const n=e.current;Xie(n,t)},[t,e])}var Jie=Yie;const{atomicUpdater:Qie}=vB,{useStoreRef:ese}=oc,{useMemo:tse}=le;function nse(t,e){const n=ese();return tse(()=>(...r)=>{Qie(n.current)(s=>{t(s)(...r)})},e!=null?[...e,n]:void 0)}var rse=nse;class ise{constructor(e){An(this,"value",void 0),this.value=e}}var sse={WrappedValue:ise},ose=sse.WrappedValue,wB=Object.freeze({__proto__:null,WrappedValue:ose});const{isFastRefreshEnabled:ase}=Ny;class l8 extends Error{}class lse{constructor(e){var n,r,i;An(this,"_name",void 0),An(this,"_numLeafs",void 0),An(this,"_root",void 0),An(this,"_onHit",void 0),An(this,"_onSet",void 0),An(this,"_mapNodeValue",void 0),this._name=e==null?void 0:e.name,this._numLeafs=0,this._root=null,this._onHit=(n=e==null?void 0:e.onHit)!==null&&n!==void 0?n:()=>{},this._onSet=(r=e==null?void 0:e.onSet)!==null&&r!==void 0?r:()=>{},this._mapNodeValue=(i=e==null?void 0:e.mapNodeValue)!==null&&i!==void 0?i:s=>s}size(){return this._numLeafs}root(){return this._root}get(e,n){var r;return(r=this.getLeafNode(e,n))===null||r===void 0?void 0:r.value}getLeafNode(e,n){if(this._root==null)return;let r=this._root;for(;r;){if(n==null||n.onNodeVisit(r),r.type==="leaf")return this._onHit(r),r;const i=this._mapNodeValue(e(r.nodeKey));r=r.branches.get(i)}}set(e,n,r){const i=()=>{var s,l,o,h;let p,b;for(const[U,D]of e){var x,w,A;const $=this._root;if(($==null?void 0:$.type)==="leaf")throw this.invalidCacheError();const N=p;if(p=N?N.branches.get(b):$,p=(x=p)!==null&&x!==void 0?x:{type:"branch",nodeKey:U,parent:N,branches:new Map,branchKey:b},p.type!=="branch"||p.nodeKey!==U)throw this.invalidCacheError();N==null||N.branches.set(b,p),r==null||(w=r.onNodeVisit)===null||w===void 0||w.call(r,p),b=this._mapNodeValue(D),this._root=(A=this._root)!==null&&A!==void 0?A:p}const L=p?(s=p)===null||s===void 0?void 0:s.branches.get(b):this._root;if(L!=null&&(L.type!=="leaf"||L.branchKey!==b))throw this.invalidCacheError();const M={type:"leaf",value:n,parent:p,branchKey:b};(l=p)===null||l===void 0||l.branches.set(b,M),this._root=(o=this._root)!==null&&o!==void 0?o:M,this._numLeafs++,this._onSet(M),r==null||(h=r.onNodeVisit)===null||h===void 0||h.call(r,M)};try{i()}catch(s){if(s instanceof l8)this.clear(),i();else throw s}}delete(e){const n=this.root();if(!n)return!1;if(e===n)return this._root=null,this._numLeafs=0,!0;let r=e.parent,i=e.branchKey;for(;r;){var s;if(r.branches.delete(i),r===n)return r.branches.size===0?(this._root=null,this._numLeafs=0):this._numLeafs--,!0;if(r.branches.size>0)break;i=(s=r)===null||s===void 0?void 0:s.branchKey,r=r.parent}for(;r!==n;r=r.parent)if(r==null)return!1;return this._numLeafs--,!0}clear(){this._numLeafs=0,this._root=null}invalidCacheError(){const e=ase()?"Possible Fast Refresh module reload detected.  This may also be caused by an selector returning inconsistent values. Resetting cache.":"Invalid cache values.  This happens when selectors do not return consistent values for the same input dependency values.  That may also be caused when using Fast Refresh to change a selector implementation.  Resetting cache.";throw gM(e+(this._name!=null?` - ${this._name}`:"")),new l8}}var cse={TreeCache:lse},use=cse.TreeCache,TB=Object.freeze({__proto__:null,TreeCache:use});let dse=class{constructor(e){var n;An(this,"_maxSize",void 0),An(this,"_size",void 0),An(this,"_head",void 0),An(this,"_tail",void 0),An(this,"_map",void 0),An(this,"_keyMapper",void 0),this._maxSize=e.maxSize,this._size=0,this._head=null,this._tail=null,this._map=new Map,this._keyMapper=(n=e.mapKey)!==null&&n!==void 0?n:r=>r}head(){return this._head}tail(){return this._tail}size(){return this._size}maxSize(){return this._maxSize}has(e){return this._map.has(this._keyMapper(e))}get(e){const n=this._keyMapper(e),r=this._map.get(n);if(r)return this.set(e,r.value),r.value}set(e,n){const r=this._keyMapper(e);this._map.get(r)&&this.delete(e);const s=this.head(),l={key:e,right:s,left:null,value:n};s?s.left=l:this._tail=l,this._map.set(r,l),this._head=l,this._size++,this._maybeDeleteLRU()}_maybeDeleteLRU(){this.size()>this.maxSize()&&this.deleteLru()}deleteLru(){const e=this.tail();e&&this.delete(e.key)}delete(e){const n=this._keyMapper(e);if(!this._size||!this._map.has(n))return;const r=Vr(this._map.get(n)),i=r.right,s=r.left;i&&(i.left=r.left),s&&(s.right=r.right),r===this.head()&&(this._head=i),r===this.tail()&&(this._tail=s),this._map.delete(n),this._size--}clear(){this._size=0,this._head=null,this._tail=null,this._map=new Map}};var hse={LRUCache:dse},fse=hse.LRUCache,EB=Object.freeze({__proto__:null,LRUCache:fse});const{LRUCache:pse}=EB,{TreeCache:mse}=TB;function gse({name:t,maxSize:e,mapNodeValue:n=r=>r}){const r=new pse({maxSize:e}),i=new mse({name:t,mapNodeValue:n,onHit:s=>{r.set(s,!0)},onSet:s=>{const l=r.tail();r.set(s,!0),l&&i.size()>e&&i.delete(l.key)}});return i}var c8=gse;function ha(t,e,n){if(typeof t=="string"&&!t.includes('"')&&!t.includes("\\"))return`"${t}"`;switch(typeof t){case"undefined":return"";case"boolean":return t?"true":"false";case"number":case"symbol":return String(t);case"string":return JSON.stringify(t);case"function":if((e==null?void 0:e.allowFunctions)!==!0)throw In("Attempt to serialize function in a Recoil cache key");return`__FUNCTION(${t.name})__`}if(t===null)return"null";if(typeof t!="object"){var r;return(r=JSON.stringify(t))!==null&&r!==void 0?r:""}if(Dr(t))return"__PROMISE__";if(Array.isArray(t))return`[${t.map((i,s)=>ha(i,e,s.toString()))}]`;if(typeof t.toJSON=="function")return ha(t.toJSON(n),e,n);if(t instanceof Map){const i={};for(const[s,l]of t)i[typeof s=="string"?s:ha(s,e)]=l;return ha(i,e,n)}return t instanceof Set?ha(Array.from(t).sort((i,s)=>ha(i,e).localeCompare(ha(s,e))),e,n):Symbol!==void 0&&t[Symbol.iterator]!=null&&typeof t[Symbol.iterator]=="function"?ha(Array.from(t),e,n):`{${Object.keys(t).filter(i=>t[i]!==void 0).sort().map(i=>`${ha(i,e)}:${ha(t[i],e,i)}`).join(",")}}`}function yse(t,e={allowFunctions:!1}){return ha(t,e)}var Y1=yse;const{TreeCache:vse}=TB,Pv={equality:"reference",eviction:"keep-all",maxSize:1/0};function _se({equality:t=Pv.equality,eviction:e=Pv.eviction,maxSize:n=Pv.maxSize}=Pv,r){const i=bse(t);return xse(e,n,i,r)}function bse(t){switch(t){case"reference":return e=>e;case"value":return e=>Y1(e)}throw In(`Unrecognized equality policy ${t}`)}function xse(t,e,n,r){switch(t){case"keep-all":return new vse({name:r,mapNodeValue:n});case"lru":return c8({name:r,maxSize:Vr(e),mapNodeValue:n});case"most-recent":return c8({name:r,maxSize:1,mapNodeValue:n})}throw In(`Unrecognized eviction policy ${t}`)}var wse=_se;function Tse(t){return()=>null}var Ese={startPerfBlock:Tse};const{isLoadable:Sse,loadableWithError:Cv,loadableWithPromise:Ase,loadableWithValue:b2}=Fy,{WrappedValue:SB}=wB,{getNodeLoadable:Lv,peekNodeLoadable:Pse,setNodeValue:Cse}=xu,{saveDepsToStore:Lse}=zy,{DEFAULT_VALUE:Ise,getConfigDeletionHandler:Rse,getNode:Mse,registerNode:u8}=ro,{isRecoilValue:$se}=Zf,{markRecoilValueModified:d8}=hl,{retainedByOptionWithDefault:kse}=Jd,{recoilCallback:Ose}=xB,{startPerfBlock:Dse}=Ese;class AB{}const Fm=new AB,Nm=[],Iv=new Map,Fse=(()=>{let t=0;return()=>t++})();function PB(t){let e=null;const{key:n,get:r,cachePolicy_UNSTABLE:i}=t,s=t.set!=null?t.set:void 0,l=new Set,o=wse(i??{equality:"reference",eviction:"keep-all"},n),h=kse(t.retainedBy_UNSTABLE),p=new Map;let b=0;function x(){return!br("recoil_memory_managament_2020")||b>0}function w(Re){return Re.getState().knownSelectors.add(n),b++,()=>{b--}}function A(){return Rse(n)!==void 0&&!x()}function L(Re,Ke,Je,kt,ft){ut(Ke,kt,ft),M(Re,Je)}function M(Re,Ke){ke(Re,Ke)&&_e(Re),D(Ke,!0)}function U(Re,Ke){ke(Re,Ke)&&(Vr(Ae(Re)).stateVersions.clear(),D(Ke,!1))}function D(Re,Ke){const Je=Iv.get(Re);if(Je!=null){for(const kt of Je)d8(kt,Vr(e));Ke&&Iv.delete(Re)}}function $(Re,Ke){let Je=Iv.get(Ke);Je==null&&Iv.set(Ke,Je=new Set),Je.add(Re)}function N(Re,Ke,Je,kt,ft,Pt){return Ke.then(qt=>{if(!x())throw _e(Re),Fm;const lt=b2(qt);return L(Re,Je,ft,lt,kt),qt}).catch(qt=>{if(!x())throw _e(Re),Fm;if(Dr(qt))return B(Re,qt,Je,kt,ft,Pt);const lt=Cv(qt);throw L(Re,Je,ft,lt,kt),qt})}function B(Re,Ke,Je,kt,ft,Pt){return Ke.then(qt=>{if(!x())throw _e(Re),Fm;Pt.loadingDepKey!=null&&Pt.loadingDepPromise===Ke?Je.atomValues.set(Pt.loadingDepKey,b2(qt)):Re.getState().knownSelectors.forEach(St=>{Je.atomValues.delete(St)});const lt=re(Re,Je);if(lt&&lt.state!=="loading"){if((ke(Re,ft)||Ae(Re)==null)&&M(Re,ft),lt.state==="hasValue")return lt.contents;throw lt.contents}if(!ke(Re,ft)){const St=Te(Re,Je);if(St!=null)return St.loadingLoadable.contents}const[tn,Fn]=ie(Re,Je,ft);if(tn.state!=="loading"&&L(Re,Je,ft,tn,Fn),tn.state==="hasError")throw tn.contents;return tn.contents}).catch(qt=>{if(qt instanceof AB)throw Fm;if(!x())throw _e(Re),Fm;const lt=Cv(qt);throw L(Re,Je,ft,lt,kt),qt})}function Z(Re,Ke,Je,kt){var ft,Pt,qt,lt;if(ke(Re,kt)||Ke.version===((ft=Re.getState())===null||ft===void 0||(Pt=ft.currentTree)===null||Pt===void 0?void 0:Pt.version)||Ke.version===((qt=Re.getState())===null||qt===void 0||(lt=qt.nextTree)===null||lt===void 0?void 0:lt.version)){var tn,Fn,St;Lse(n,Je,Re,(tn=(Fn=Re.getState())===null||Fn===void 0||(St=Fn.nextTree)===null||St===void 0?void 0:St.version)!==null&&tn!==void 0?tn:Re.getState().currentTree.version)}for(const bt of Je)l.add(bt)}function ie(Re,Ke,Je){const kt=Dse(n);let ft=!0,Pt=!0;const qt=()=>{kt(),Pt=!1};let lt,tn=!1,Fn;const St={loadingDepKey:null,loadingDepPromise:null},bt=new Map;function hn({key:On}){const Ln=Lv(Re,Ke,On);switch(bt.set(On,Ln),ft||(Z(Re,Ke,new Set(bt.keys()),Je),U(Re,Je)),Ln.state){case"hasValue":return Ln.contents;case"hasError":throw Ln.contents;case"loading":throw St.loadingDepKey=On,St.loadingDepPromise=Ln.contents,Ln.contents}throw In("Invalid Loadable state")}const ur=On=>(...Ln)=>{if(Pt)throw In("Callbacks from getCallback() should only be called asynchronously after the selector is evalutated.  It can be used for selectors to return objects with callbacks that can work with Recoil state without a subscription.");return e==null&&dg(!1),Ose(Re,On,Ln,{node:e})};try{lt=r({get:hn,getCallback:ur}),lt=$se(lt)?hn(lt):lt,Sse(lt)&&(lt.state==="hasError"&&(tn=!0),lt=lt.contents),Dr(lt)?lt=N(Re,lt,Ke,bt,Je,St).finally(qt):qt(),lt=lt instanceof SB?lt.value:lt}catch(On){lt=On,Dr(lt)?lt=B(Re,lt,Ke,bt,Je,St).finally(qt):(tn=!0,qt())}return tn?Fn=Cv(lt):Dr(lt)?Fn=Ase(lt):Fn=b2(lt),ft=!1,Pe(Re,Je,bt),Z(Re,Ke,new Set(bt.keys()),Je),[Fn,bt]}function re(Re,Ke){let Je=Ke.atomValues.get(n);if(Je!=null)return Je;const kt=new Set;try{Je=o.get(Pt=>(typeof Pt!="string"&&dg(!1),Lv(Re,Ke,Pt).contents),{onNodeVisit:Pt=>{Pt.type==="branch"&&Pt.nodeKey!==n&&kt.add(Pt.nodeKey)}})}catch(Pt){throw In(`Problem with cache lookup for selector "${n}": ${Pt.message}`)}if(Je){var ft;Ke.atomValues.set(n,Je),Z(Re,Ke,kt,(ft=Ae(Re))===null||ft===void 0?void 0:ft.executionID)}return Je}function ve(Re,Ke){const Je=re(Re,Ke);if(Je!=null)return _e(Re),Je;const kt=Te(Re,Ke);if(kt!=null){var ft;return((ft=kt.loadingLoadable)===null||ft===void 0?void 0:ft.state)==="loading"&&$(Re,kt.executionID),kt.loadingLoadable}const Pt=Fse(),[qt,lt]=ie(Re,Ke,Pt);return qt.state==="loading"?(fe(Re,Pt,qt,lt,Ke),$(Re,Pt)):(_e(Re),ut(Ke,qt,lt)),qt}function Te(Re,Ke){const Je=X7([p.has(Re)?[Vr(p.get(Re))]:[],N1(xM(p,([ft])=>ft!==Re),([,ft])=>ft)]);function kt(ft){for(const[Pt,qt]of ft)if(!Lv(Re,Ke,Pt).is(qt))return!0;return!1}for(const ft of Je){if(ft.stateVersions.get(Ke.version)||!kt(ft.depValuesDiscoveredSoFarDuringAsyncWork))return ft.stateVersions.set(Ke.version,!0),ft;ft.stateVersions.set(Ke.version,!1)}}function Ae(Re){return p.get(Re)}function fe(Re,Ke,Je,kt,ft){p.set(Re,{depValuesDiscoveredSoFarDuringAsyncWork:kt,executionID:Ke,loadingLoadable:Je,stateVersions:new Map([[ft.version,!0]])})}function Pe(Re,Ke,Je){if(ke(Re,Ke)){const kt=Ae(Re);kt!=null&&(kt.depValuesDiscoveredSoFarDuringAsyncWork=Je)}}function _e(Re){p.delete(Re)}function ke(Re,Ke){var Je;return Ke===((Je=Ae(Re))===null||Je===void 0?void 0:Je.executionID)}function Vt(Re){return Array.from(Re.entries()).map(([Ke,Je])=>[Ke,Je.contents])}function ut(Re,Ke,Je){Re.atomValues.set(n,Ke);try{o.set(Vt(Je),Ke)}catch(kt){throw In(`Problem with setting cache for selector "${n}": ${kt.message}`)}}function rn(Re){if(Nm.includes(n)){const Ke=`Recoil selector has circular dependencies: ${Nm.slice(Nm.indexOf(n)).join("  ")}`;return Cv(In(Ke))}Nm.push(n);try{return Re()}finally{Nm.pop()}}function ot(Re,Ke){const Je=Ke.atomValues.get(n);return Je??o.get(kt=>{var ft;return typeof kt!="string"&&dg(!1),(ft=Pse(Re,Ke,kt))===null||ft===void 0?void 0:ft.contents})}function yt(Re,Ke){return rn(()=>ve(Re,Ke))}function at(Re){Re.atomValues.delete(n)}function Mt(Re,Ke){e==null&&dg(!1);for(const kt of l){var Je;const ft=Mse(kt);(Je=ft.clearCache)===null||Je===void 0||Je.call(ft,Re,Ke)}l.clear(),at(Ke),o.clear(),d8(Re,e)}return s!=null?e=u8({key:n,nodeType:"selector",peek:ot,get:yt,set:(Ke,Je,kt)=>{let ft=!1;const Pt=new Map;function qt({key:St}){if(ft)throw In("Recoil: Async selector sets are not currently supported.");const bt=Lv(Ke,Je,St);if(bt.state==="hasValue")return bt.contents;if(bt.state==="loading"){const hn=`Getting value of asynchronous atom or selector "${St}" in a pending state while setting selector "${n}" is not yet supported.`;throw In(hn)}else throw bt.contents}function lt(St,bt){if(ft)throw In("Recoil: Async selector sets are not currently supported.");const hn=typeof bt=="function"?bt(qt(St)):bt;Cse(Ke,Je,St.key,hn).forEach((On,Ln)=>Pt.set(Ln,On))}function tn(St){lt(St,Ise)}const Fn=s({set:lt,get:qt,reset:tn},kt);if(Fn!==void 0)throw Dr(Fn)?In("Recoil: Async selector sets are not currently supported."):In("Recoil: selector set should be a void function.");return ft=!0,Pt},init:w,invalidate:at,clearCache:Mt,shouldDeleteConfigOnRelease:A,dangerouslyAllowMutability:t.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:h}):e=u8({key:n,nodeType:"selector",peek:ot,get:yt,init:w,invalidate:at,clearCache:Mt,shouldDeleteConfigOnRelease:A,dangerouslyAllowMutability:t.dangerouslyAllowMutability,shouldRestoreFromSnapshots:!1,retainedBy:h})}PB.value=t=>new SB(t);var Qf=PB;const{isLoadable:Nse,loadableWithError:x2,loadableWithPromise:w2,loadableWithValue:$h}=Fy,{WrappedValue:CB}=wB,{peekNodeInfo:zse}=xu,{DEFAULT_VALUE:fd,DefaultValue:Gc,getConfigDeletionHandler:LB,registerNode:Bse,setConfigDeletionHandler:Use}=ro,{isRecoilValue:Vse}=Zf,{getRecoilValueAsLoadable:jse,markRecoilValueModified:Gse,setRecoilValue:h8,setRecoilValueLoadable:Wse}=hl,{retainedByOptionWithDefault:Hse}=Jd,zm=t=>t instanceof CB?t.value:t;function qse(t){const{key:e,persistence_UNSTABLE:n}=t,r=Hse(t.retainedBy_UNSTABLE);let i=0;function s($){return w2($.then(N=>(l=$h(N),N)).catch(N=>{throw l=x2(N),N}))}let l=Dr(t.default)?s(t.default):Nse(t.default)?t.default.state==="loading"?s(t.default.contents):t.default:$h(zm(t.default));l.contents;let o;const h=new Map;function p($){return $}function b($,N){const B=N.then(Z=>{var ie,re;return((re=((ie=$.getState().nextTree)!==null&&ie!==void 0?ie:$.getState().currentTree).atomValues.get(e))===null||re===void 0?void 0:re.contents)===B&&h8($,D,Z),Z}).catch(Z=>{var ie,re;throw((re=((ie=$.getState().nextTree)!==null&&ie!==void 0?ie:$.getState().currentTree).atomValues.get(e))===null||re===void 0?void 0:re.contents)===B&&Wse($,D,x2(Z)),Z});return B}function x($,N,B){var Z;i++;const ie=()=>{var Ae;i--,(Ae=h.get($))===null||Ae===void 0||Ae.forEach(fe=>fe()),h.delete($)};if($.getState().knownAtoms.add(e),l.state==="loading"){const Ae=()=>{var fe;((fe=$.getState().nextTree)!==null&&fe!==void 0?fe:$.getState().currentTree).atomValues.has(e)||Gse($,D)};l.contents.finally(Ae)}const re=(Z=t.effects)!==null&&Z!==void 0?Z:t.effects_UNSTABLE;if(re!=null){let ke=function(at){if(fe&&at.key===e){const Mt=Ae;return Mt instanceof Gc?w($,N):Dr(Mt)?w2(Mt.then(Re=>Re instanceof Gc?l.toPromise():Re)):$h(Mt)}return jse($,at)},Vt=function(at){return ke(at).toPromise()},ut=function(at){var Mt;const Re=zse($,(Mt=$.getState().nextTree)!==null&&Mt!==void 0?Mt:$.getState().currentTree,at.key);return fe&&at.key===e&&!(Ae instanceof Gc)?{...Re,isSet:!0,loadable:ke(at)}:Re},Ae=fd,fe=!0,Pe=!1,_e=null;const rn=at=>Mt=>{if(fe){const Re=ke(D),Ke=Re.state==="hasValue"?Re.contents:fd;Ae=typeof Mt=="function"?Mt(Ke):Mt,Dr(Ae)&&(Ae=Ae.then(Je=>(_e={effect:at,value:Je},Je)))}else{if(Dr(Mt))throw In("Setting atoms to async values is not implemented.");typeof Mt!="function"&&(_e={effect:at,value:zm(Mt)}),h8($,D,typeof Mt=="function"?Re=>{const Ke=zm(Mt(Re));return _e={effect:at,value:Ke},Ke}:zm(Mt))}},ot=at=>()=>rn(at)(fd),yt=at=>Mt=>{var Re;const{release:Ke}=$.subscribeToTransactions(Je=>{var kt;let{currentTree:ft,previousTree:Pt}=Je.getState();Pt||(Pt=ft);const qt=(kt=ft.atomValues.get(e))!==null&&kt!==void 0?kt:l;if(qt.state==="hasValue"){var lt,tn,Fn,St;const bt=qt.contents,hn=(lt=Pt.atomValues.get(e))!==null&&lt!==void 0?lt:l,ur=hn.state==="hasValue"?hn.contents:fd;((tn=_e)===null||tn===void 0?void 0:tn.effect)!==at||((Fn=_e)===null||Fn===void 0?void 0:Fn.value)!==bt?Mt(bt,ur,!ft.atomValues.has(e)):((St=_e)===null||St===void 0?void 0:St.effect)===at&&(_e=null)}},e);h.set($,[...(Re=h.get($))!==null&&Re!==void 0?Re:[],Ke])};for(const at of re)try{const Mt=at({node:D,storeID:$.storeID,parentStoreID_UNSTABLE:$.parentStoreID,trigger:B,setSelf:rn(at),resetSelf:ot(at),onSet:yt(at),getPromise:Vt,getLoadable:ke,getInfo_UNSTABLE:ut});if(Mt!=null){var ve;h.set($,[...(ve=h.get($))!==null&&ve!==void 0?ve:[],Mt])}}catch(Mt){Ae=Mt,Pe=!0}if(fe=!1,!(Ae instanceof Gc)){var Te;const at=Pe?x2(Ae):Dr(Ae)?w2(b($,Ae)):$h(zm(Ae));at.contents,N.atomValues.set(e,at),(Te=$.getState().nextTree)===null||Te===void 0||Te.atomValues.set(e,at)}}return ie}function w($,N){var B,Z;return(B=(Z=N.atomValues.get(e))!==null&&Z!==void 0?Z:o)!==null&&B!==void 0?B:l}function A($,N){if(N.atomValues.has(e))return Vr(N.atomValues.get(e));if(N.nonvalidatedAtoms.has(e)){if(o!=null)return o;if(n==null)return l;const B=N.nonvalidatedAtoms.get(e),Z=n.validator(B,fd);return o=Z instanceof Gc?l:$h(Z),o}else return l}function L(){o=void 0}function M($,N,B){if(N.atomValues.has(e)){const Z=Vr(N.atomValues.get(e));if(Z.state==="hasValue"&&B===Z.contents)return new Map}else if(!N.nonvalidatedAtoms.has(e)&&B instanceof Gc)return new Map;return o=void 0,new Map().set(e,$h(B))}function U(){return LB(e)!==void 0&&i<=0}const D=Bse({key:e,nodeType:"atom",peek:w,get:A,set:M,init:x,invalidate:L,shouldDeleteConfigOnRelease:U,dangerouslyAllowMutability:t.dangerouslyAllowMutability,persistence_UNSTABLE:t.persistence_UNSTABLE?{type:t.persistence_UNSTABLE.type,backButton:t.persistence_UNSTABLE.backButton}:void 0,shouldRestoreFromSnapshots:!0,retainedBy:r});return D}function RM(t){const{...e}=t,n="default"in t?t.default:new Promise(()=>{});return Vse(n)?Kse({...e,default:n}):qse({...e,default:n})}function Kse(t){const e=RM({...t,default:fd,persistence_UNSTABLE:t.persistence_UNSTABLE===void 0?void 0:{...t.persistence_UNSTABLE,validator:r=>r instanceof Gc?r:Vr(t.persistence_UNSTABLE).validator(r,fd)},effects:t.effects,effects_UNSTABLE:t.effects_UNSTABLE}),n=Qf({key:`${t.key}__withFallback`,get:({get:r})=>{const i=r(e);return i instanceof Gc?t.default:i},set:({set:r},i)=>r(e,i),cachePolicy_UNSTABLE:{eviction:"most-recent"},dangerouslyAllowMutability:t.dangerouslyAllowMutability});return Use(n.key,LB(t.key)),n}RM.value=t=>new CB(t);var IB=RM;let Xse=class{constructor(e){var n;An(this,"_map",void 0),An(this,"_keyMapper",void 0),this._map=new Map,this._keyMapper=(n=e==null?void 0:e.mapKey)!==null&&n!==void 0?n:r=>r}size(){return this._map.size}has(e){return this._map.has(this._keyMapper(e))}get(e){return this._map.get(this._keyMapper(e))}set(e,n){this._map.set(this._keyMapper(e),n)}delete(e){this._map.delete(this._keyMapper(e))}clear(){this._map.clear()}};var Zse={MapCache:Xse},Yse=Zse.MapCache,Jse=Object.freeze({__proto__:null,MapCache:Yse});const{LRUCache:f8}=EB,{MapCache:Qse}=Jse,Rv={equality:"reference",eviction:"none",maxSize:1/0};function eoe({equality:t=Rv.equality,eviction:e=Rv.eviction,maxSize:n=Rv.maxSize}=Rv){const r=toe(t);return noe(e,n,r)}function toe(t){switch(t){case"reference":return e=>e;case"value":return e=>Y1(e)}throw In(`Unrecognized equality policy ${t}`)}function noe(t,e,n){switch(t){case"keep-all":return new Qse({mapKey:n});case"lru":return new f8({mapKey:n,maxSize:Vr(e)});case"most-recent":return new f8({mapKey:n,maxSize:1})}throw In(`Unrecognized eviction policy ${t}`)}var RB=eoe;const{setConfigDeletionHandler:roe}=ro;function ioe(t){var e,n;const r=RB({equality:(e=(n=t.cachePolicyForParams_UNSTABLE)===null||n===void 0?void 0:n.equality)!==null&&e!==void 0?e:"value",eviction:"keep-all"});return i=>{var s,l;const o=r.get(i);if(o!=null)return o;const{cachePolicyForParams_UNSTABLE:h,...p}=t,b="default"in t?t.default:new Promise(()=>{}),x=IB({...p,key:`${t.key}__${(s=Y1(i))!==null&&s!==void 0?s:"void"}`,default:typeof b=="function"?b(i):b,retainedBy_UNSTABLE:typeof t.retainedBy_UNSTABLE=="function"?t.retainedBy_UNSTABLE(i):t.retainedBy_UNSTABLE,effects:typeof t.effects=="function"?t.effects(i):typeof t.effects_UNSTABLE=="function"?t.effects_UNSTABLE(i):(l=t.effects)!==null&&l!==void 0?l:t.effects_UNSTABLE});return r.set(i,x),roe(x.key,()=>{r.delete(i)}),x}}var soe=ioe;const{setConfigDeletionHandler:ooe}=ro;let aoe=0;function loe(t){var e,n;const r=RB({equality:(e=(n=t.cachePolicyForParams_UNSTABLE)===null||n===void 0?void 0:n.equality)!==null&&e!==void 0?e:"value",eviction:"keep-all"});return i=>{var s;let l;try{l=r.get(i)}catch(w){throw In(`Problem with cache lookup for selector ${t.key}: ${w.message}`)}if(l!=null)return l;const o=`${t.key}__selectorFamily/${(s=Y1(i,{allowFunctions:!0}))!==null&&s!==void 0?s:"void"}/${aoe++}`,h=w=>t.get(i)(w),p=t.cachePolicy_UNSTABLE,b=typeof t.retainedBy_UNSTABLE=="function"?t.retainedBy_UNSTABLE(i):t.retainedBy_UNSTABLE;let x;if(t.set!=null){const w=t.set;x=Qf({key:o,get:h,set:(L,M)=>w(i)(L,M),cachePolicy_UNSTABLE:p,dangerouslyAllowMutability:t.dangerouslyAllowMutability,retainedBy_UNSTABLE:b})}else x=Qf({key:o,get:h,cachePolicy_UNSTABLE:p,dangerouslyAllowMutability:t.dangerouslyAllowMutability,retainedBy_UNSTABLE:b});return r.set(i,x),ooe(x.key,()=>{r.delete(i)}),x}}var wu=loe;const coe=wu({key:"__constant",get:t=>()=>t,cachePolicyForParams_UNSTABLE:{equality:"reference"}});function uoe(t){return coe(t)}var doe=uoe;const hoe=wu({key:"__error",get:t=>()=>{throw In(t)},cachePolicyForParams_UNSTABLE:{equality:"reference"}});function foe(t){return hoe(t)}var poe=foe;function moe(t){return t}var goe=moe;const{loadableWithError:MB,loadableWithPromise:$B,loadableWithValue:kB}=Fy;function J1(t,e){const n=Array(e.length).fill(void 0),r=Array(e.length).fill(void 0);for(const[i,s]of e.entries())try{n[i]=t(s)}catch(l){r[i]=l}return[n,r]}function yoe(t){return t!=null&&!Dr(t)}function Q1(t){return Array.isArray(t)?t:Object.getOwnPropertyNames(t).map(e=>t[e])}function sS(t,e){return Array.isArray(t)?e:Object.getOwnPropertyNames(t).reduce((n,r,i)=>({...n,[r]:e[i]}),{})}function If(t,e,n){const r=n.map((i,s)=>i==null?kB(e[s]):Dr(i)?$B(i):MB(i));return sS(t,r)}function voe(t,e){return e.map((n,r)=>n===void 0?t[r]:n)}const _oe=wu({key:"__waitForNone",get:t=>({get:e})=>{const n=Q1(t),[r,i]=J1(e,n);return If(t,r,i)},dangerouslyAllowMutability:!0}),boe=wu({key:"__waitForAny",get:t=>({get:e})=>{const n=Q1(t),[r,i]=J1(e,n);return i.some(s=>!Dr(s))?If(t,r,i):new Promise(s=>{for(const[l,o]of i.entries())Dr(o)&&o.then(h=>{r[l]=h,i[l]=void 0,s(If(t,r,i))}).catch(h=>{i[l]=h,s(If(t,r,i))})})},dangerouslyAllowMutability:!0}),xoe=wu({key:"__waitForAll",get:t=>({get:e})=>{const n=Q1(t),[r,i]=J1(e,n);if(i.every(l=>l==null))return sS(t,r);const s=i.find(yoe);if(s!=null)throw s;return Promise.all(i).then(l=>sS(t,voe(r,l)))},dangerouslyAllowMutability:!0}),woe=wu({key:"__waitForAllSettled",get:t=>({get:e})=>{const n=Q1(t),[r,i]=J1(e,n);return i.every(s=>!Dr(s))?If(t,r,i):Promise.all(i.map((s,l)=>Dr(s)?s.then(o=>{r[l]=o,i[l]=void 0}).catch(o=>{r[l]=void 0,i[l]=o}):null)).then(()=>If(t,r,i))},dangerouslyAllowMutability:!0}),Toe=wu({key:"__noWait",get:t=>({get:e})=>{try{return Qf.value(kB(e(t)))}catch(n){return Qf.value(Dr(n)?$B(n):MB(n))}},dangerouslyAllowMutability:!0});var Eoe={waitForNone:_oe,waitForAny:boe,waitForAll:xoe,waitForAllSettled:woe,noWait:Toe};const{RecoilLoadable:Soe}=Fy,{DefaultValue:Aoe}=ro,{RecoilRoot:Poe,useRecoilStoreID:Coe}=oc,{isRecoilValue:Loe}=Zf,{retentionZone:Ioe}=B1,{freshSnapshot:Roe}=H1,{useRecoilState:Moe,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:$oe,useRecoilStateLoadable:koe,useRecoilValue:Ooe,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:Doe,useRecoilValueLoadable:Foe,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:Noe,useResetRecoilState:zoe,useSetRecoilState:Boe}=Zre,{useGotoRecoilSnapshot:Uoe,useRecoilSnapshot:Voe,useRecoilTransactionObserver:joe}=yB,{useRecoilCallback:Goe}=xB,{noWait:Woe,waitForAll:Hoe,waitForAllSettled:qoe,waitForAny:Koe,waitForNone:Xoe}=Eoe;var jy={DefaultValue:Aoe,isRecoilValue:Loe,RecoilLoadable:Soe,RecoilEnv:bp,RecoilRoot:Poe,useRecoilStoreID:Coe,useRecoilBridgeAcrossReactRoots_UNSTABLE:Tie,atom:IB,selector:Qf,atomFamily:soe,selectorFamily:wu,constSelector:doe,errorSelector:poe,readOnlySelector:goe,noWait:Woe,waitForNone:Xoe,waitForAny:Koe,waitForAll:Hoe,waitForAllSettled:qoe,useRecoilValue:Ooe,useRecoilValueLoadable:Foe,useRecoilState:Moe,useRecoilStateLoadable:koe,useSetRecoilState:Boe,useResetRecoilState:zoe,useGetRecoilValueInfo_UNSTABLE:yie,useRecoilRefresher_UNSTABLE:Jie,useRecoilValueLoadable_TRANSITION_SUPPORT_UNSTABLE:Noe,useRecoilValue_TRANSITION_SUPPORT_UNSTABLE:Doe,useRecoilState_TRANSITION_SUPPORT_UNSTABLE:$oe,useRecoilCallback:Goe,useRecoilTransaction_UNSTABLE:rse,useGotoRecoilSnapshot:Uoe,useRecoilSnapshot:Voe,useRecoilTransactionObserver_UNSTABLE:joe,snapshot_UNSTABLE:Roe,useRetain:AM,retentionZone:Ioe},Zoe=jy.RecoilRoot,OB=jy.atom,ac=jy.selector,Ja=jy.useRecoilValue,oS=jy.useRecoilState;const Yoe="modulepreload",Joe=function(t){return"/"+t},p8={},Qoe=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=Joe(s),s in p8)return;p8[s]=!0;const l=s.endsWith(".css"),o=l?'[rel="stylesheet"]':"";if(!!r)for(let b=i.length-1;b>=0;b--){const x=i[b];if(x.href===s&&(!l||x.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const p=document.createElement("link");if(p.rel=l?"stylesheet":Yoe,l||(p.as="script",p.crossOrigin=""),p.href=s,document.head.appendChild(p),l)return new Promise((b,x)=>{p.addEventListener("load",b),p.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())},eae=te.createContext(null);function tae(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function m8(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function g8(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const nae=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function y8(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{const i=e[r.ref];let s=null;if("interactive"in r&&(s={...r},delete s.interactive),i){s=s||{...r},delete s.ref;for(const l of nae)l in i&&(s[l]=i[l])}return s||r});return{...t,layers:n}}function rae(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function qc(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!qc(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!qc(t[i],e[i]))return!1;return!0}return!1}const v8={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},T2={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},_8={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},iae=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],sae=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class ep{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[_8[i.type]];s&&s(i)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[v8[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[T2[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=ep.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n,r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:l}=e;return l&&(l.bounds?i.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):r._updateViewState(l,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i.triggerRepaint(),r}_initialize(e){const{props:n}=this,r={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||oae()||null,container:e,style:y8(n.mapStyle)},i=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),n.gl){const p=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=p,n.gl)}const s=new this._MapClass(r);i.padding&&s.setPadding(i.padding),n.cursor&&(s.getCanvas().style.cursor=n.cursor),this._createShadowTransform(s);const l=s._render;s._render=p=>{this._inRender=!0,l.call(s,p),this._inRender=!1};const o=s._renderTaskQueue.run;s._renderTaskQueue.run=p=>{o.call(s._renderTaskQueue,p),this._onBeforeRepaint()},s.on("render",()=>this._onAfterRepaint());const h=s.fire;s.fire=this._fireEvent.bind(this,h),s.on("resize",()=>{this._renderTransform.resize(s.transform.width,s.transform.height)}),s.on("styledata",()=>this._updateStyleComponents(this.props,{})),s.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const p in v8)s.on(p,this._onPointerEvent);for(const p in T2)s.on(p,this._onCameraEvent);for(const p in _8)s.on(p,this._onEvent);this._map=s}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),ep.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=tae(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:l,bearing:o}=i,h=r.isMoving();h&&(i.cameraElevationReference="sea");const p=g8(i,{...m8(r.transform),...e});if(h&&(i.cameraElevationReference="ground"),p&&n){const b=this._deferredEvents;b.move=!0,b.zoom||(b.zoom=s!==i.zoom),b.rotate||(b.rotate=o!==i.bearing),b.pitch||(b.pitch=l!==i.pitch)}return h||g8(r.transform,e),p}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of iae)s in e&&!qc(e[s],n[s])&&(i=!0,r[`set${s[0].toUpperCase()}${s.slice(1)}`](e[s]));return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==n.mapStyle){const r={diff:e.styleDiffing};return"localIdeographFontFamily"in e&&(r.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(y8(e.mapStyle),r),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.style.loaded()&&("light"in e&&!qc(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&!qc(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&!qc(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){const r=this._map;let i=!1;for(const s of sae){const l=e[s];qc(l,n[s])||(i=!0,l?r[s].enable(l):r[s].disable())}return i}_queryRenderedFeatures(e){const n=this._map,{interactiveLayerIds:r=[]}=this.props;try{return n.queryRenderedFeatures(e,{layers:r.filter(n.getLayer.bind(n))})}catch{return[]}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,l=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,o=this._queryRenderedFeatures(e.point),h=o.length>0;!h&&l&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=o,h&&!l&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,l=typeof n=="string"?n:n.type;return l==="move"&&this._updateViewState(this.props,!1),l in T2&&(typeof n=="object"&&(n.viewState=m8(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=n}}}ep.savedMaps=[];function oae(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const aae=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function lae(t,e){if(!t)return null;const n=t.map,r={getMap:()=>n,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:i=>t.transform.locationPoint(e.LngLat.convert(i)),unproject:i=>t.transform.pointLocation(e.Point.convert(i)),queryTerrainElevation:(i,s)=>{const l=n.transform;n.transform=t.transform;const o=n.queryTerrainElevation(i,s);return n.transform=l,o}};for(const i of cae(n))!(i in r)&&!aae.includes(i)&&(r[i]=n[i].bind(n));return r}function cae(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const uae=typeof document<"u"?te.useLayoutEffect:te.useEffect,dae=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function hae(t,e){for(const n of dae)n in e&&(t[n]=e[n]);e.RTLTextPlugin&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(e.RTLTextPlugin,n=>{n&&console.error(n)},!1)}const ex=te.createContext(null),fae={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:t=>console.error(t.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},MM=te.forwardRef((t,e)=>{const n=te.useContext(eae),[r,i]=te.useState(null),s=te.useRef(),{current:l}=te.useRef({mapLib:null,map:null});te.useEffect(()=>{const p=t.mapLib;let b=!0,x;return Promise.resolve(p||Qoe(()=>import("./mapbox-gl-15e49793.js").then(w=>w.m),[])).then(w=>{if(b){if(w.Map||(w=w.default),!w||!w.Map)throw new Error("Invalid mapLib");if(hae(w,t),w.supported(t))t.reuseMaps&&(x=ep.reuse(t,s.current)),x||(x=new ep(w.Map,t,s.current)),l.map=lae(x,w),l.mapLib=w,i(x),n==null||n.onMapMount(l.map,t.id);else throw new Error("Map is not supported by this browser")}}).catch(w=>{t.onError({type:"error",target:null,originalEvent:null,error:w})}),()=>{b=!1,x&&(n==null||n.onMapUnmount(t.id),t.reuseMaps?x.recycle():x.destroy())}},[]),uae(()=>{r&&r.setProps(t)}),te.useImperativeHandle(e,()=>l.map,[r]);const o=te.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),h={height:"100%"};return te.createElement("div",{id:t.id,ref:s,style:o},r&&te.createElement(ex.Provider,{value:l},te.createElement("div",{"mapboxgl-children":"",style:h},t.children)))});MM.displayName="Map";MM.defaultProps=fae;const pae=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Qd(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!pae.test(r)?n[r]=`${i}px`:n[r]=i}}const mae={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function DB(t){const{map:e,mapLib:n}=te.useContext(ex),r=te.useRef({props:t});r.current.props=t;const i=te.useMemo(()=>{let s=!1;te.Children.forEach(t.children,h=>{h&&(s=!0)});const l={...t,element:s?document.createElement("div"):null},o=new n.Marker(l).setLngLat([t.longitude,t.latitude]);return o.getElement().addEventListener("click",h=>{var p,b;(b=(p=r.current.props).onClick)===null||b===void 0||b.call(p,{type:"click",target:o,originalEvent:h})}),o.on("dragstart",h=>{var p,b;const x=h;x.lngLat=i.getLngLat(),(b=(p=r.current.props).onDragStart)===null||b===void 0||b.call(p,x)}),o.on("drag",h=>{var p,b;const x=h;x.lngLat=i.getLngLat(),(b=(p=r.current.props).onDrag)===null||b===void 0||b.call(p,x)}),o.on("dragend",h=>{var p,b;const x=h;x.lngLat=i.getLngLat(),(b=(p=r.current.props).onDragEnd)===null||b===void 0||b.call(p,x)}),o},[]);return te.useEffect(()=>(i.addTo(e.getMap()),()=>{i.remove()}),[]),te.useEffect(()=>{Qd(i.getElement(),t.style)},[t.style]),(i.getLngLat().lng!==t.longitude||i.getLngLat().lat!==t.latitude)&&i.setLngLat([t.longitude,t.latitude]),t.offset&&!rae(i.getOffset(),t.offset)&&i.setOffset(t.offset),i.isDraggable()!==t.draggable&&i.setDraggable(t.draggable),i.getRotation()!==t.rotation&&i.setRotation(t.rotation),i.getRotationAlignment()!==t.rotationAlignment&&i.setRotationAlignment(t.rotationAlignment),i.getPitchAlignment()!==t.pitchAlignment&&i.setPitchAlignment(t.pitchAlignment),i.getPopup()!==t.popup&&i.setPopup(t.popup),Ad.createPortal(t.children,i.getElement())}DB.defaultProps=mae;te.memo(DB);function b8(t){return new Set(t?t.trim().split(/\s+/):[])}function gae(t){const{map:e,mapLib:n}=te.useContext(ex),r=te.useMemo(()=>document.createElement("div"),[]),i=te.useRef({props:t});i.current.props=t;const s=te.useMemo(()=>{const l={...t},o=new n.Popup(l).setLngLat([t.longitude,t.latitude]);return o.once("open",h=>{var p,b;(b=(p=i.current.props).onOpen)===null||b===void 0||b.call(p,h)}),o},[]);if(te.useEffect(()=>{const l=o=>{var h,p;(p=(h=i.current.props).onClose)===null||p===void 0||p.call(h,o)};return s.on("close",l),s.setDOMContent(r).addTo(e.getMap()),()=>{s.off("close",l),s.isOpen()&&s.remove()}},[]),te.useEffect(()=>{Qd(s.getElement(),t.style)},[t.style]),s.isOpen()&&((s.getLngLat().lng!==t.longitude||s.getLngLat().lat!==t.latitude)&&s.setLngLat([t.longitude,t.latitude]),t.offset&&!qc(s.options.offset,t.offset)&&s.setOffset(t.offset),(s.options.anchor!==t.anchor||s.options.maxWidth!==t.maxWidth)&&(s.options.anchor=t.anchor,s.setMaxWidth(t.maxWidth)),s.options.className!==t.className)){const l=b8(s.options.className),o=b8(t.className);for(const h of l)o.has(h)||s.removeClassName(h);for(const h of o)l.has(h)||s.addClassName(h);s.options.className=t.className}return Ad.createPortal(t.children,r)}te.memo(gae);function Gy(t,e,n,r){const i=te.useContext(ex),s=te.useMemo(()=>t(i),[]);return te.useEffect(()=>{const l=r||n||e,o=typeof e=="function"&&typeof n=="function"?e:null,h=typeof n=="function"?n:typeof e=="function"?e:null,{map:p}=i;return p.hasControl(s)||(p.addControl(s,l==null?void 0:l.position),o&&o(i)),()=>{h&&h(i),p.hasControl(s)&&p.removeControl(s)}},[]),s}function yae(t){const e=Gy(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return te.useEffect(()=>{Qd(e._container,t.style)},[t.style]),null}te.memo(yae);function vae(t){const e=Gy(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return te.useEffect(()=>{Qd(e._controlContainer,t.style)},[t.style]),null}te.memo(vae);const FB=te.forwardRef((t,e)=>{const n=te.useRef({props:t}),r=Gy(({mapLib:i})=>{const s=new i.GeolocateControl(t),l=s._setupUI;return s._setupUI=o=>{s._container.hasChildNodes()||l(o)},s.on("geolocate",o=>{var h,p;(p=(h=n.current.props).onGeolocate)===null||p===void 0||p.call(h,o)}),s.on("error",o=>{var h,p;(p=(h=n.current.props).onError)===null||p===void 0||p.call(h,o)}),s.on("outofmaxbounds",o=>{var h,p;(p=(h=n.current.props).onOutOfMaxBounds)===null||p===void 0||p.call(h,o)}),s.on("trackuserlocationstart",o=>{var h,p;(p=(h=n.current.props).onTrackUserLocationStart)===null||p===void 0||p.call(h,o)}),s.on("trackuserlocationend",o=>{var h,p;(p=(h=n.current.props).onTrackUserLocationEnd)===null||p===void 0||p.call(h,o)}),s},{position:t.position});return n.current.props=t,te.useImperativeHandle(e,()=>({trigger:()=>r.trigger()}),[]),te.useEffect(()=>{Qd(r._container,t.style)},[t.style]),null});FB.displayName="GeolocateControl";te.memo(FB);function _ae(t){const e=Gy(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return te.useEffect(()=>{Qd(e._container,t.style)},[t.style]),null}const bae=te.memo(_ae),xae={unit:"metric",maxWidth:100};function NB(t){const e=Gy(({mapLib:n})=>new n.ScaleControl(t),{position:t.position});return(e.options.unit!==t.unit||e.options.maxWidth!==t.maxWidth)&&(e.options.maxWidth=t.maxWidth,e.setUnit(t.unit)),te.useEffect(()=>{Qd(e._container,t.style)},[t.style]),null}NB.defaultProps=xae;te.memo(NB);function Sb(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const $M=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),x8=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);x8&&parseFloat(x8[1]);const wae="3.3.5";function nc(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const k_=typeof process!="object"||String(process)!=="[object process]"||process.browser,Tae=typeof window<"u"&&typeof window.orientation<"u",w8=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);w8&&parseFloat(w8[1]);function oy(t){"@babel/helpers - typeof";return oy=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oy(t)}function Eae(t,e){if(oy(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(oy(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sae(t){var e=Eae(t,"string");return oy(e)==="symbol"?e:String(e)}function K(t,e,n){return e=Sae(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Aae{constructor(e,n){K(this,"name",void 0),K(this,"workerThread",void 0),K(this,"isRunning",!0),K(this,"result",void 0),K(this,"_resolve",()=>{}),K(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){nc(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){nc(this.isRunning),this.isRunning=!1,this._reject(e)}}let E2=class{terminate(){}};const S2=new Map;function Pae(t){nc(t.source&&!t.url||!t.source&&t.url);let e=S2.get(t.source||t.url);return e||(t.url&&(e=Cae(t.url),S2.set(t.url,e)),t.source&&(e=zB(t.source),S2.set(t.source,e))),nc(e),e}function Cae(t){if(!t.startsWith("http"))return t;const e=Lae(t);return zB(e)}function zB(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Lae(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function BB(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(T8(t))r.add(t);else if(T8(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)BB(t[i],e,r)}}return n===void 0?Array.from(r):[]}function T8(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const A2=()=>{};class aS{static isSupported(){return typeof Worker<"u"&&k_||typeof E2<"u"&&!k_}constructor(e){K(this,"name",void 0),K(this,"source",void 0),K(this,"url",void 0),K(this,"terminated",!1),K(this,"worker",void 0),K(this,"onMessage",void 0),K(this,"onError",void 0),K(this,"_loadableURL","");const{name:n,source:r,url:i}=e;nc(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=A2,this.onError=s=>console.log(s),this.worker=k_?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=A2,this.onError=A2,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||BB(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=Pae({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new E2(r,{eval:!1})}else if(this.source)e=new E2(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class Iae{static isSupported(){return aS.isSupported()}constructor(e){K(this,"name","unnamed"),K(this,"source",void 0),K(this,"url",void 0),K(this,"maxConcurrency",1),K(this,"maxMobileConcurrency",1),K(this,"onDebug",()=>{}),K(this,"reuseWorkers",!0),K(this,"props",{}),K(this,"jobQueue",[]),K(this,"idleQueue",[]),K(this,"count",0),K(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(s,l,o)=>s.done(o),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(s,l)=>s.error(l);const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new Aae(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new aS({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Tae?this.maxMobileConcurrency:this.maxConcurrency}}const Rae={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class jl{static isSupported(){return aS.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return jl._workerFarm=jl._workerFarm||new jl({}),jl._workerFarm.setProps(e),jl._workerFarm}constructor(e){K(this,"props",void 0),K(this,"workerPools",new Map),this.props={...Rae},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new Iae({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}K(jl,"_workerFarm",void 0);const Mae="latest";function $ae(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let s=t.version;s==="latest"&&(s=Mae);const l=s?"@".concat(s):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(l,"/dist/").concat(r)}return nc(i),i}function kae(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:wae;nc(t,"no worker provided");const n=t.version;return!(!e||!n)}function Oae(t,e){return!jl.isSupported()||!k_&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function Dae(t,e,n,r,i){const s=t.id,l=$ae(t,n),h=jl.getWorkerFarm(n).getWorkerPool({name:s,url:l});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const p=await h.startJob("process-on-worker",Fae.bind(null,i));return p.postMessage("process",{input:e,options:n,context:r}),await(await p.result).result}async function Fae(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:l}=r;try{const o=await t(s,l);e.postMessage("done",{id:i,result:o})}catch(o){const h=o instanceof Error?o.message:"unknown error";e.postMessage("error",{id:i,error:h})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function Nae(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function zae(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),i=r.reduce((o,h)=>o+h.byteLength,0),s=new Uint8Array(i);let l=0;for(const o of r)s.set(o,l),l+=o.byteLength;return s.buffer}async function Bae(t){const e=[];for await(const n of t)e.push(n);return zae(...e)}function E8(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let S8=class{constructor(e,n){K(this,"name",void 0),K(this,"type",void 0),K(this,"sampleSize",1),K(this,"time",void 0),K(this,"count",void 0),K(this,"samples",void 0),K(this,"lastTiming",void 0),K(this,"lastSampleTime",void 0),K(this,"lastSampleCount",void 0),K(this,"_count",0),K(this,"_time",0),K(this,"_samples",0),K(this,"_startTime",0),K(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=E8(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(E8()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},kM=class{constructor(e){K(this,"id",void 0),K(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof S8?this.stats[n]=e:this.stats[n]=new S8(n,r)),this.stats[n]}},Uae="";const A8={};function Vae(t){for(const e in A8)if(t.startsWith(e)){const n=A8[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(Uae).concat(t)),t}function jae(t){return t&&typeof t=="object"&&t.isBuffer}function UB(t){if(jae(t))return(void 0)(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function Gae(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}const Wae=t=>typeof t=="boolean",kg=t=>typeof t=="function",Wy=t=>t!==null&&typeof t=="object",P8=t=>Wy(t)&&t.constructor==={}.constructor,Hae=t=>t&&typeof t[Symbol.iterator]=="function",qae=t=>t&&typeof t[Symbol.asyncIterator]=="function",wp=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Tp=t=>typeof Blob<"u"&&t instanceof Blob,Kae=t=>t&&typeof t=="object"&&t.isBuffer,Xae=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Wy(t)&&kg(t.tee)&&kg(t.cancel)&&kg(t.getReader),Zae=t=>Wy(t)&&kg(t.read)&&kg(t.pipe)&&Wae(t.readable),VB=t=>Xae(t)||Zae(t),Yae=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Jae=/^([-\w.]+\/[-\w.+]+)/;function Qae(t){const e=Jae.exec(t);return e?e[1]:t}function C8(t){const e=Yae.exec(t);return e?e[1]:""}const ele=/\?.*/;function tx(t){if(wp(t)){const e=P2(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:Qae(n)||C8(e)}}return Tp(t)?{url:P2(t.name||""),type:t.type||""}:typeof t=="string"?{url:P2(t),type:C8(t)}:{url:"",type:""}}function tle(t){return wp(t)?t.headers["content-length"]||-1:Tp(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function P2(t){return t.replace(ele,"")}async function jB(t){if(wp(t))return t;const e={},n=tle(t);n>=0&&(e["content-length"]=String(n));const{url:r,type:i}=tx(t);i&&(e["content-type"]=i);const s=await ile(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const l=new Response(t,{headers:e});return Object.defineProperty(l,"url",{value:r}),l}async function nle(t){if(!t.ok){const e=await rle(t);throw new Error(e)}}async function rle(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function ile(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var l;return r(s==null||(l=s.target)===null||l===void 0?void 0:l.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=sle(n);return"data:base64,".concat(r)}return null}function sle(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function L8(t,e){if(typeof t=="string"){t=Vae(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await jB(t)}function GB(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function lc(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||GB()}const O_={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Mv=O_.window||O_.self||O_.global,Bm=O_.process||{},WB=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";lc();const C2=globalThis;function HB(t){if(!t&&!lc())return"Node";if(GB(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":C2.chrome?"Chrome":C2.safari?"Safari":C2.mozInnerScreenX?"Firefox":"Unknown"}function ole(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let ale=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";K(this,"storage",void 0),K(this,"id",void 0),K(this,"config",void 0),this.storage=ole(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function lle(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function cle(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function L2(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let Ab;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ab||(Ab={}));function I8(t){return typeof t=="string"?Ab[t.toUpperCase()]||Ab.WHITE:t}function ule(t,e,n){return!lc&&typeof t=="string"&&(e&&(e=I8(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=I8(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function dle(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function Pb(t,e){if(!t)throw new Error(e||"Assertion failed")}function kh(){let t;if(lc&&"performance"in Mv){var e,n;t=Mv==null||(e=Mv.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in Bm){var r;const i=Bm==null||(r=Bm.hrtime)===null||r===void 0?void 0:r.call(Bm);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Oh={debug:lc&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},hle={enabled:!0,level:0};function Wo(){}const R8={},M8={once:!0};let Hy=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};K(this,"id",void 0),K(this,"VERSION",WB),K(this,"_startTs",kh()),K(this,"_deltaTs",kh()),K(this,"_storage",void 0),K(this,"userData",{}),K(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new ale("__probe-".concat(this.id,"__"),hle),this.timeStamp("".concat(this.id," started")),dle(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((kh()-this._startTs).toPrecision(10))}getDelta(){return Number((kh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Pb(e,n)}warn(e){return this._getLogFunction(0,e,Oh.warn,arguments,M8)}error(e){return this._getLogFunction(0,e,Oh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Oh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Oh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Oh.debug||Oh.info,arguments,M8)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Wo,r&&[r],{tag:gle(n)}):Wo}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?lc?mle({image:i,message:s,scale:l}):ple():Wo}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Wo)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=$8({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Wo)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=qB(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=$8({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,Pb(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=kh();const l=s.tag||s.message;if(s.once)if(!R8[l])R8[l]=kh();else return Wo;return n=fle(this.id,s.message,s),r.bind(console,n,...s.args)}return Wo}};K(Hy,"VERSION",WB);function qB(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Pb(Number.isFinite(e)&&e>=0),e}function $8(t){const{logLevel:e,message:n}=t;t.logLevel=qB(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return Pb(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function fle(t,e,n){if(typeof e=="string"){const r=n.time?cle(lle(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=ule(e,n.color,n.background)}return e}function ple(t){return console.warn("removed"),Wo}function mle(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=L2(s,n,r);console.log(...l)},s.src=e,Wo}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...L2(e,n,r)),Wo;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...L2(s,n,r)),s.src=e.toDataURL(),Wo}return Wo}function gle(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const k8=new Hy({id:"loaders.gl"});class yle{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class vle{constructor(){K(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const KB={fetch:null,mimeType:void 0,nothrow:!1,log:new vle,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:$M,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},_le={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function XB(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const ZB=()=>{const t=XB();return t.globalOptions=t.globalOptions||{...KB},t.globalOptions};function ble(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],xle(t,n),Tle(e,t,r)}function YB(t,e){const n=ZB(),r=t||n;return typeof r.fetch=="function"?r.fetch:Wy(r.fetch)?i=>L8(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:L8}function xle(t,e){O8(t,null,KB,_le,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};O8(r,n.id,i,s,e)}}function O8(t,e,n,r,i){const s=e||"Top level",l=e?"".concat(e,"."):"";for(const o in t){const h=!e&&Wy(t[o]),p=o==="baseUri"&&!e,b=o==="workerUrl"&&e;if(!(o in n)&&!p&&!b){if(o in r)k8.warn("".concat(s," loader option '").concat(l).concat(o,"' no longer supported, use '").concat(r[o],"'"))();else if(!h){const x=wle(o,i);k8.warn("".concat(s," loader option '").concat(l).concat(o,"' not recognized. ").concat(x))()}}}}function wle(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return"Did you mean '".concat(i.id,".").concat(s,"'?");const l=s.toLowerCase();(n.startsWith(l)||l.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(s,"'?"))}return r}function Tle(t,e,n){const i={...t.options||{}};return Ele(i,n),i.log===null&&(i.log=new yle),D8(i,ZB()),D8(i,e),i}function D8(t,e){for(const n in e)if(n in e){const r=e[n];P8(r)&&P8(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function Ele(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function OM(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function DM(t){var e,n;Sb(t,"null loader"),Sb(OM(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const JB=()=>{const t=XB();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function Sle(t){const e=JB();t=Array.isArray(t)?t:[t];for(const n of t){const r=DM(n);e.find(i=>r===i)||e.unshift(r)}}function Ale(){return JB()}const Ple=new Hy({id:"loaders.gl"}),Cle=/\.([^.]+)$/;async function Lle(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!QB(t))return null;let i=F8(t,e,{...n,nothrow:!0},r);if(i)return i;if(Tp(t)&&(t=await t.slice(0,10).arrayBuffer(),i=F8(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(eU(t));return i}function F8(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!QB(t))return null;if(e&&!Array.isArray(e))return DM(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...Ale()),Rle(i);const s=Ile(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(eU(t));return s}function Ile(t,e,n,r){const{url:i,type:s}=tx(t),l=i||(r==null?void 0:r.url);let o=null,h="";if(n!=null&&n.mimeType&&(o=I2(e,n==null?void 0:n.mimeType),h="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),o=o||Mle(e,l),h=h||(o?"matched url ".concat(l):""),o=o||I2(e,s),h=h||(o?"matched MIME type ".concat(s):""),o=o||kle(e,t),h=h||(o?"matched initial data ".concat(tU(t)):""),o=o||I2(e,n==null?void 0:n.fallbackMimeType),h=h||(o?"matched fallback MIME type ".concat(s):""),h){var p;Ple.log(1,"selectLoader selected ".concat((p=o)===null||p===void 0?void 0:p.name,": ").concat(h,"."))}return o}function QB(t){return!(t instanceof Response&&t.status===204)}function eU(t){const{url:e,type:n}=tx(t);let r="No valid loader found (";r+=e?"".concat(Gae(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?tU(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function Rle(t){for(const e of t)DM(e)}function Mle(t,e){const n=e&&Cle.exec(e),r=n&&n[1];return r?$le(t,r):null}function $le(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function I2(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function kle(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(Ole(e,n))return n}else if(ArrayBuffer.isView(e)){if(N8(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&N8(e,0,n))return n;return null}function Ole(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function N8(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>Dle(t,e,n,i))}function Dle(t,e,n,r){if(r instanceof ArrayBuffer)return Nae(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=lS(t,e,r.length);return r===i;default:return!1}}function tU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?lS(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?lS(t,0,e):""}function lS(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const Fle=256*1024;function*Nle(t,e){const n=(e==null?void 0:e.chunkSize)||Fle;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),l=t.slice(r,r+s);r+=s,yield i.encode(l)}}const zle=256*1024;function*Ble(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{chunkSize:n=zle}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),l=new Uint8Array(t,r,i);new Uint8Array(s).set(l),r+=i,yield s}}const Ule=1024*1024;async function*Vle(t,e){const n=(e==null?void 0:e.chunkSize)||Ule;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function z8(t,e){return $M?jle(t,e):Gle(t)}async function*jle(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:l}=await i;if(s)return;yield UB(l)}}catch{n.releaseLock()}}async function*Gle(t,e){for await(const n of t)yield UB(n)}function Wle(t,e){if(typeof t=="string")return Nle(t,e);if(t instanceof ArrayBuffer)return Ble(t,e);if(Tp(t))return Vle(t,e);if(VB(t))return z8(t,e);if(wp(t))return z8(t.body,e);throw new Error("makeIterator")}const nU="Cannot convert supplied data type";function Hle(t,e,n){if(e.text&&typeof t=="string")return t;if(Kae(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(nU)}async function qle(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return Hle(t,e);if(Tp(t)&&(t=await jB(t)),wp(t)){const i=t;return await nle(i),e.binary?await i.arrayBuffer():await i.text()}if(VB(t)&&(t=Wle(t,n)),Hae(t)||qae(t))return Bae(t);throw new Error(nU)}function Kle(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(n)return n;const r={fetch:YB(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}function Xle(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function FM(t,e,n,r){nc(!r||typeof r=="object"),e&&!Array.isArray(e)&&!OM(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:i}=tx(t),l=Xle(e,r),o=await Lle(t,l,n);return o?(n=ble(n,o,l,i),r=Kle({url:i,parse:FM,loaders:l},n,r),await Zle(o,t,n,r)):null}async function Zle(t,e,n,r){if(kae(t),wp(e)){const i=e,{ok:s,redirected:l,status:o,statusText:h,type:p,url:b}=i,x=Object.fromEntries(i.headers.entries());r.response={headers:x,ok:s,redirected:l,status:o,statusText:h,type:p,url:b}}if(e=await qle(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(Oae(t,n))return await Dae(t,e,n,r,FM);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw nc(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Cb(t,e,n,r){!Array.isArray(e)&&!OM(e)&&(n=e,e=void 0);const i=YB(n);let s=t;return typeof t=="string"&&(s=await i(t)),Tp(t)&&(s=await i(t)),await FM(s,e,n)}const Yle="3.3.5",{_parseImageNode:Jle}=globalThis,cS=typeof Image<"u",uS=typeof ImageBitmap<"u",Qle=!!Jle,dS=$M?!0:Qle;function ece(t){switch(t){case"auto":return uS||cS||dS;case"imagebitmap":return uS;case"image":return cS;case"data":return dS;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function tce(){if(uS)return"imagebitmap";if(cS)return"image";if(dS)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function nce(t){const e=ice(t);if(!e)throw new Error("Not an image");return e}function rce(t){switch(nce(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function ice(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const sce=/^data:image\/svg\+xml/,oce=/\.svg((\?|#).*)?$/;function NM(t){return t&&(sce.test(t)||oce.test(t))}function ace(t,e){if(NM(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return rU(t,e)}function rU(t,e){if(NM(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function iU(t,e,n){const r=ace(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await lce(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function lce(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>i(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){i(s)}})}const cce={};let B8=!0;async function uce(t,e,n){let r;NM(n)?r=await iU(t,e,n):r=rU(t,n);const i=e&&e.imagebitmap;return await dce(r,i)}async function dce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((hce(e)||!B8)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),B8=!1}return await createImageBitmap(t)}function hce(t){for(const e in t||cce)return!1;return!0}const tl=!1,Og=!0;function sU(t){const e=qy(t);return fce(e)||gce(e)||pce(e)||mce(e)}function fce(t){const e=qy(t);return e.byteLength>=24&&e.getUint32(0,tl)===2303741511?{mimeType:"image/png",width:e.getUint32(16,tl),height:e.getUint32(20,tl)}:null}function pce(t){const e=qy(t);return e.byteLength>=10&&e.getUint32(0,tl)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Og),height:e.getUint16(8,Og)}:null}function mce(t){const e=qy(t);return e.byteLength>=14&&e.getUint16(0,tl)===16973&&e.getUint32(2,Og)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Og),height:e.getUint32(22,Og)}:null}function gce(t){const e=qy(t);if(!(e.byteLength>=3&&e.getUint16(0,tl)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=yce();let s=2;for(;s+9<e.byteLength;){const l=e.getUint16(s,tl);if(i.has(l))return{mimeType:"image/jpeg",height:e.getUint16(s+5,tl),width:e.getUint16(s+7,tl)};if(!r.has(l))return null;s+=2,s+=e.getUint16(s,tl)}return null}function yce(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function qy(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function vce(t,e){const{mimeType:n}=sU(t)||{},r=globalThis._parseImageNode;return Sb(r),await r(t,n)}async function _ce(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},l=bce(i);let o;switch(l){case"imagebitmap":o=await uce(t,e,s);break;case"image":o=await iU(t,e,s);break;case"data":o=await vce(t);break;default:Sb(!1)}return i==="data"&&(o=rce(o)),o}function bce(t){switch(t){case"auto":case"data":return tce();default:return ece(t),t}}const xce=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],wce=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],Tce={image:{type:"auto",decode:!0}},Ece={id:"image",module:"images",name:"Images",version:Yle,mimeTypes:wce,extensions:xce,parse:_ce,tests:[t=>!!sU(new DataView(t))],options:Tce},Nn=new Hy({id:"deck"});let hS={};function Sce(t){hS=t}function gs(t,e,n,r){Nn.level>0&&hS[t]&&hS[t].call(null,e,n,r)}function Ace(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const Pce={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:Ace,parseTextSync:JSON.parse};function Cce(){const t="8.9.15",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(Nn.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Nn,_registerLoggers:Sce},Sle([Pce,[Ece,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const Lce=Cce(),Qn={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Qn,"IDENTITY",{get:()=>(Nn.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const rl={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},kd={common:0,meters:1,pixels:2},U8={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},en=new Hy({id:"luma.gl"});function Os(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const Ice="Invalid WebGLRenderingContext",Rce="Requires WebGL2";function nx(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Un(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Mce(t){return Un(t)?t:null}function rx(t){return Os(nx(t),Ice),t}function vs(t){return Os(Un(t),Rce),t}const hg={};function $ce(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function kce(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function Oce(t,e){hg[t]=!0,e!==void 0&&$ce(e)}function Dce(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(hg[r]=!0);while(r!==0);for(r in hg)if(hg[r])return delete hg[r],parseInt(r,10);return 0}}const Ky=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};Ky.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};Ky.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const eh=function(e){const n=this;this.gl=e,Dce(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,s);const o=l.attribs[s];return o.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,s);const o=l.attribs[s];return o.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,l){switch(s){case 34962:n.currentArrayBuffer=l;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=l;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,l){const h=n.currentVertexArrayObject.attribs[s];switch(l){case 34975:return h.buffer;case 34338:return h.enabled;case 34339:return h.size;case 34340:return h.stride;case 34341:return h.type;case 34922:return h.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,l,o,h,p,b){const x=n.currentVertexArrayObject;x.maxAttrib=Math.max(x.maxAttrib,s);const w=x.attribs[s];return w.buffer=n.currentArrayBuffer,w.size=l,w.type=o,w.normalized=h,w.stride=p,w.offset=b,w.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{kce("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};eh.prototype.VERTEX_ARRAY_BINDING_OES=34229;eh.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new Ky(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};eh.prototype.createVertexArrayOES=function(){const e=new Ky(this);return this.vertexArrayObjects.push(e),e};eh.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};eh.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof Ky&&e.hasBeenBound&&e.ext===this)};eh.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){Oce(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let l=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let h=0;h<=o;h++){const p=s.attribs[h],b=i?i.attribs[h]:null;if((!i||p.enabled!==b.enabled)&&(p.enabled?r.enableVertexAttribArray.call(n,h):r.disableVertexAttribArray.call(n,h)),p.enabled){let x=!1;(!i||p.buffer!==b.buffer)&&(l!==p.buffer&&(r.bindBuffer.call(n,34962,p.buffer),l=p.buffer),x=!0),(x||p.cached!==b.cached)&&r.vertexAttribPointer.call(n,h,p.size,p.type,p.normalized,p.stride,p.offset)}}this.currentArrayBuffer!==l&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function Fce(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new eh(this)),this.__OESVertexArrayObject))}}const V8="OES_element_index",j8="WEBGL_draw_buffers",Nce="EXT_disjoint_timer_query",zce="EXT_disjoint_timer_query_webgl2",Bce="EXT_texture_filter_anisotropic",G8="WEBGL_debug_renderer_info",Uce=35723,Vce=4352,jce=36795,Gce=34047,Wce=37445,Hce=37446,Tr=t=>Un(t)?void 0:0,qce={[3074]:t=>Un(t)?void 0:36064,[Uce]:t=>Un(t)?void 0:Vce,[35977]:Tr,[32937]:Tr,[jce]:(t,e)=>{const n=Un(t)?t.getExtension(zce):t.getExtension(Nce);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[Wce]:(t,e)=>{const n=t.getExtension(G8);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[Hce]:(t,e)=>{const n=t.getExtension(G8);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[Gce]:(t,e)=>{const n=t.luma.extensions[Bce];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:Tr,[35071]:Tr,[37447]:Tr,[36063]:(t,e)=>{if(!Un(t)){const n=t.getExtension(j8);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:Tr,[35374]:Tr,[35377]:Tr,[34852]:t=>{if(!Un(t)){const e=t.getExtension(j8);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(V8)?2147483647:65535,[33001]:t=>t.getExtension(V8)?16777216:65535,[33e3]:t=>16777216,[37157]:Tr,[35373]:Tr,[35657]:Tr,[36183]:Tr,[37137]:Tr,[34045]:Tr,[35978]:Tr,[35979]:Tr,[35968]:Tr,[35376]:Tr,[35375]:Tr,[35659]:Tr,[37154]:Tr,[35371]:Tr,[35658]:Tr,[35076]:Tr,[35077]:Tr,[35380]:Tr};function Kce(t,e,n){const r=qce[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const Xce="OES_vertex_array_object",oU="ANGLE_instanced_arrays",Zce="WEBGL_draw_buffers",Yce="EXT_disjoint_timer_query",Jce="EXT_texture_filter_anisotropic",Qce="VertexArray requires WebGL2 or OES_vertex_array_object extension";function eue(t,e){return{webgl2:Un(t),ext:t.getExtension(e)}}const aU={[Xce]:{meta:{suffix:"OES"},createVertexArray:()=>{Os(!1,Qce)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[oU]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Os(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[Zce]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Os(!1)}},[Yce]:{meta:{suffix:"EXT"},createQuery:()=>{Os(!1)},deleteQuery:()=>{Os(!1)},beginQuery:()=>{Os(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},R2={readBuffer:(t,e,n)=>{Un(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=eue(t,oU);let l;switch(r){case 35069:l=i?void 0:!1;break;case 35070:l=!i&&!s?0:void 0;break}return l!==void 0?l:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Un(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!Un(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[Jce];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:Kce,hint(t,e,n,r){return e(n,r)}};function tue(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(Fce(t),nue(t),iue(t,aU),rue(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=tue;function nue(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function rue(t,e){let{target:n,target2:r}=e;Object.keys(R2).forEach(i=>{if(typeof R2[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},l=R2[i].bind(null,t,s);n[i]=l,r[i]=l}})}function iue(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&sue(t,{extension:n,target:t.luma,target2:t})}function sue(t,e){let{extension:n,target:r,target2:i}=e;const s=aU[n];Os(s);const{meta:l={}}=s,{suffix:o=""}=l,h=t.getExtension(n);for(const p of Object.keys(s)){const b="".concat(p).concat(o);let x=null;p==="meta"||typeof t[p]=="function"||(h&&typeof h[b]=="function"?x=function(){return h[b](...arguments)}:typeof s[p]=="function"&&(x=s[p].bind(r))),x&&(r[p]=x,i[p]=x)}}const zM={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},kc=(t,e,n)=>e?t.enable(n):t.disable(n),W8=(t,e,n)=>t.hint(n,e),mo=(t,e,n)=>t.pixelStorei(n,e),oue=(t,e)=>{const n=Un(t)?36009:36160;return t.bindFramebuffer(n,e)},aue=(t,e)=>t.bindFramebuffer(36008,e);function Um(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const lue={[3042]:kc,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:kc,[2885]:(t,e)=>t.cullFace(e),[2929]:kc,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:kc,[35723]:W8,[36006]:oue,[2886]:(t,e)=>t.frontFace(e),[33170]:W8,[2849]:(t,e)=>t.lineWidth(e),[32823]:kc,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:kc,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:kc,[3088]:(t,e)=>t.scissor(...e),[2960]:kc,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:mo,[3317]:mo,[37440]:mo,[37441]:mo,[37443]:mo,[3330]:mo,[3332]:mo,[3331]:mo,[36010]:aue,[3314]:mo,[32878]:mo,[3316]:mo,[3315]:mo,[32877]:mo,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Um(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Um(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Um(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Um(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,l,o]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,l,o)},stencilOp:(t,e)=>{e=Um(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,l,o]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,l,o)},viewport:(t,e)=>t.viewport(...e)};function ri(t,e,n){return e[t]!==void 0?e[t]:n[t]}const cue={blendEquation:(t,e,n)=>t.blendEquationSeparate(ri(32777,e,n),ri(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(ri(32969,e,n),ri(32968,e,n),ri(32971,e,n),ri(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(ri(32824,e,n),ri(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(ri(32938,e,n),ri(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,ri(2962,e,n),ri(2967,e,n),ri(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,ri(34816,e,n),ri(36003,e,n),ri(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,ri(2964,e,n),ri(2965,e,n),ri(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,ri(34817,e,n),ri(34818,e,n),ri(34819,e,n))},H8={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,i)=>t({[32773]:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,i)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:i}),clearColor:(t,e,n,r,i)=>t({[3106]:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,i)=>t({[3107]:[e,n,r,i]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,i)=>t({[3088]:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({[2978]:[e,n,r,i]})},Wa=(t,e)=>t.isEnabled(e),q8={[3042]:Wa,[2884]:Wa,[2929]:Wa,[3024]:Wa,[32823]:Wa,[32926]:Wa,[32928]:Wa,[3089]:Wa,[2960]:Wa,[35977]:Wa};function lU(t){for(const e in t)return!1;return!0}function uue(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function K8(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function due(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,l=new Array(s),o=0;o<s;o++)l[o]=arguments[o];const{valueChanged:h,oldValue:p}=n(t.state._updateCache,...l);return h&&r(...l),p},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function hue(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}let fue=class{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?mue(e):Object.assign({},zM),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Os(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];rc(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Os(s!==void 0);const l=e[s],o=this.cache[s];uue(l,o)||(n=!0,r=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=l)}return{valueChanged:n,oldValue:r}}};function cU(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Os(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new fue(t,{copyState:r}),hue(t);for(const s in H8){const l=H8[s];due(t,s,l)}K8(t,"getParameter"),K8(t,"isEnabled")}return t.state.enable=n,t}function pue(t){t.state||cU(t,{copyState:!1}),t.state.push()}function X8(t){Os(t.state),t.state.pop()}function rc(t,e){if(Os(nx(t),"setParameters requires a WebGL context"),lU(e))return;const n={};for(const i in e){const s=Number(i),l=lue[i];l&&(typeof l=="string"?n[l]=!0:l(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=cue[i];s(t,e,r)}}function mue(t,e){if(e=e||zM,typeof e=="number"){const i=e,s=q8[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=q8[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function gue(t){rc(t,zM)}function Aa(t,e,n){if(lU(e))return n(t);const{nocatch:r=!0}=e;pue(t),rc(t,e);let i;if(r)i=n(t),X8(t);else try{i=n(t)}finally{X8(t)}return i}function tp(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function M2(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=tp(t),i=t.drawingBufferWidth,s=t.drawingBufferHeight;return vue(e,r,i,s,n)}function yue(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function vue(t,e,n,r,i){const s=Z8(t[0],e,n);let l=Y8(t[1],e,r,i),o=Z8(t[0]+1,e,n);const h=o===n-1?o:o-1;o=Y8(t[1]+1,e,r,i);let p;return i?(o=o===0?o:o+1,p=l,l=o):p=o===r-1?o:o-1,{x:s,y:l,width:Math.max(h-s+1,1),height:Math.max(p-l+1,1)}}function Z8(t,e,n){return Math.min(Math.round(t*e),n-1)}function Y8(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const BM=lc(),_ue=BM&&typeof document<"u",uU={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function dU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Os(BM,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},uU,t);const{width:e,height:n}=t;function r(o){if(t.throwOnError)throw new Error(o);return console.error(o),null}t.onError=r;let i;const{canvas:s}=t,l=Tue({canvas:s,width:e,height:n,onError:r});return i=wue(l,t),i?(i=UM(i,t),Eue(i),i):null}function UM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||Sue(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},uU,e);const{manageState:n,debug:r}=e;return n&&cU(t,{copyState:!1,log:function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return en.log(1,...s)()}}),BM&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),en.level=Math.max(en.level,1)):en.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function bue(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),s=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function xue(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=yue(e.useDevicePixels);Aue(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function wue(t,e){const{onError:n}=e;let r=null;const i=h=>r=h.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:s=!0,webgl2:l=!0}=e;let o=null;return l&&(o=o||t.getContext("webgl2",e),o=o||t.getContext("experimental-webgl2",e)),s&&(o=o||t.getContext("webgl",e),o=o||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),o?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),o):n("Failed to create ".concat(l&&!s?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function Tue(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,s;return typeof e=="string"?(_ue&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function Eue(t){const e=Un(t)?"WebGL2":"WebGL1",n=bue(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";en.info(1,"".concat(e).concat(i," context ").concat(r))()}function Sue(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function Aue(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(en.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let l=e;const o=Math.floor(r*l),h=Math.floor(i*l);t.canvas.width=o,t.canvas.height=h,(t.drawingBufferWidth!==o||t.drawingBufferHeight!==h)&&(en.warn("Device pixel ratio clamped")(),l=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*l),t.canvas.height=Math.floor(i*l)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}const Dg="8.5.20",Pue="set luma.log.level=1 (or higher) to trace rendering";let Cue=class{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new kM({id:e})),this.stats.get(e)}};const _d=new Cue;if(globalThis.luma&&globalThis.luma.VERSION!==Dg)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Dg));globalThis.luma||(lc()&&en.log(1,"luma.gl ".concat(Dg," - ").concat(Pue))(),globalThis.luma=globalThis.luma||{VERSION:Dg,version:Dg,log:en,stats:_d,globals:{modules:{},nodeIO:{}}});function Lue(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function Iue(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Ft(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function $2(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return Ft(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function cu(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const k2={};function yu(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";k2[t]=k2[t]||1;const e=k2[t]++;return"".concat(t,"-").concat(e)}function J8(t){return Ft(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function np(t){let e=!0;for(const n in t){e=!1;break}return e}function hU(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(l=>{s.methodName||(s[l]=()=>{throw en.removed("Calling removed method ".concat(e,".").concat(l,": "),i)(),new Error(l)})})}const Dh="Resource subclass must define virtual methods";let cc=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};rx(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||yu(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=$2(this.gl,e),Ft(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=Un(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,h="webgl2"in i?i.webgl2:i.webgl1;return s?h:o}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=Un(this.gl),l={},o=n||Object.keys(i);for(const h of o){const p=i[h];if(p&&(!("webgl2"in p)||s)&&(!("extension"in p)||this.gl.getExtension(p.extension))){const x=r?cu(this.gl,h):h;l[x]=this.getParameter(h,e),r&&p.type==="GLenum"&&(l[x]=cu(this.gl,l[x]))}}return l}setParameter(e,n){e=$2(this.gl,e),Ft(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=Un(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=$2(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return hU(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Dh)}_deleteHandle(){throw new Error(Dh)}_bindHandle(e){throw new Error(Dh)}_getOptsFromHandle(){throw new Error(Dh)}_getParameter(e,n){throw new Error(Dh)}_setParameter(e,n){throw new Error(Dh)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=_d.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];_d.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=_d.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=_d.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const Rue="Failed to deduce GL constant from typed array";function fS(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(Rue)}}function ay(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Mue(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const l=n*i;s=s||new Uint8Array(l);for(let o=0;o<r/2;++o){const h=o*l,p=(r-o-1)*l;s.set(e.subarray(h,h+l)),e.copyWithin(h,p,p+l),e.set(s,p)}}function $ue(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),l=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let h=0;h<i;h++)for(let p=0;p<4;p++)l[(o*i+h)*4+p]=e[(o*2*n+h*2)*4+p];return{data:l,width:i,height:s}}function pS(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const o in r)if(o in e){const p=r[o]?"".concat(t,".").concat(r[o]):"N/A";en.removed("".concat(t,".").concat(o),p)()}for(const o in i)if(o in e){const h=i[o];en.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(h))()}let l=null;for(const o in s)if(o in e){const h=s[o];en.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(h))(),l=l||Object.assign({},e),l[h]=e[o],delete l[o]}return l||e}const kue={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Oue={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};let Ul=class D_{static getBytesPerElement(e){return ay(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Ft(e.size),ay(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new D_(kue,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return D_.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return D_.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=pS("Accessor",e,Oue),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}};const Q8=10,fU={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Due={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:fU},Fue={removedProps:fU};let fr=class extends cc{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ul.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Ul.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=pS("Buffer",e,Due),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=pS("Buffer",e,Fue),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Ul(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;Ft(n);const l=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(l,this.handle),i!==0||s!==void 0?(vs(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(l,r,n),this.gl.bindBuffer(l,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:l}=this;return vs(l),l.bindBuffer(36662,n.handle),l.bindBuffer(36663,this.handle),l.copyBufferSubData(36662,36663,r,i,s),l.bindBuffer(36662,null),l.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vs(this.gl);const s=ay(this.accessor.type||5126,{clamped:!1}),l=this._getAvailableElementCount(n),o=r;let h,p;e?(p=e.length,h=p-o):(h=Math.min(l,i||l),p=o+h);const b=Math.min(l,h);return i=i||b,Ft(i<=b),e=e||new s(p),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(Ft(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(Q8,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Ft(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,Q8),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=fS(e);return Ft(s),this.setAccessor(new Ul(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Ft(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=ay(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new Ul(this.accessor,{type:fS(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return en.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return en.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return en.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return en.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Ul(this.accessor,e),this}};const VM={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},pU={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},mU={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function Nue(t,e){const n=VM[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=Un(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function zue(t,e){const n=VM[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const Bue=[9729,9728],eO=globalThis.WebGLBuffer||function(){};let Od=class extends cc{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&Nue(e,r),s=s&&(!i||zue(e,r))),s}constructor(e,n){const{id:r=yu("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then($=>this.initialize(Object.assign({},e,{pixels:$,data:$}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:l=0,recreate:o=!1,parameters:h={},pixelStore:p={},textureUnit:b=void 0}=e;n||(n=i);let{width:x,height:w,dataFormat:A,type:L,compressed:M=!1,mipmaps:U=!0}=e;const{depth:D=0}=e;return{width:x,height:w,compressed:M,dataFormat:A,type:L}=this._deduceParameters({format:s,type:L,dataFormat:A,compressed:M,data:n,width:x,height:w}),this.width=x,this.height=w,this.depth=D,this.format=s,this.type=L,this.dataFormat=A,this.border=l,this.textureUnit=b,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),U&&this._isNPOT()&&(en.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),U=!1,this._updateForNPOT(h)),this.mipmaps=U,this.setImageData({data:n,width:x,height:w,depth:D,format:s,type:L,dataFormat:A,border:l,mipmaps:U,parameters:p,compressed:M}),U&&this.generateMipmap(),this.setParameters(h),o&&(this.data=n),r&&(this._video={video:n,parameters:h,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(en.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Aa(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:l=this.border,offset:o=0,parameters:h={}}=e;let{data:p=null,type:b=this.type,width:x=this.width,height:w=this.height,dataFormat:A=this.dataFormat,compressed:L=!1}=e;p||(p=r),{type:b,dataFormat:A,compressed:L,width:x,height:w}=this._deduceParameters({format:s,type:b,dataFormat:A,compressed:L,data:p,width:x,height:w});const{gl:M}=this;M.bindTexture(this.target,this.handle);let U=null;({data:p,dataType:U}=this._getDataType({data:p,compressed:L}));let D,$=0;if(Aa(this.gl,h,()=>{switch(U){case"null":M.texImage2D(n,i,s,x,w,l,A,b,p);break;case"typed-array":M.texImage2D(n,i,s,x,w,l,A,b,p,o);break;case"buffer":D=vs(M),D.bindBuffer(35052,p.handle||p),D.texImage2D(n,i,s,x,w,l,A,b,o),D.bindBuffer(35052,null);break;case"browser-object":Un(M)?M.texImage2D(n,i,s,x,w,l,A,b,p):M.texImage2D(n,i,s,A,b,p);break;case"compressed":for(const[N,B]of p.entries())M.compressedTexImage2D(n,N,B.format,B.width,B.height,l,B.data),$+=B.levelSize;break;default:Ft(!1,"Unknown image data type")}}),U==="compressed")this._trackAllocatedMemory($,"Texture");else if(p&&p.byteLength)this._trackAllocatedMemory(p.byteLength,"Texture");else{const N=pU[this.dataFormat]||4,B=mU[this.type]||1;this._trackAllocatedMemory(this.width*this.height*N*B,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:l=0,width:o=this.width,height:h=this.height,level:p=0,format:b=this.format,type:x=this.type,dataFormat:w=this.dataFormat,compressed:A=!1,offset:L=0,border:M=this.border,parameters:U={}}=e;if({type:x,dataFormat:w,compressed:A,width:o,height:h}=this._deduceParameters({format:b,type:x,dataFormat:w,compressed:A,data:i,width:o,height:h}),Ft(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const D=i;i=D.data,o=D.shape[0],h=D.shape[1]}i instanceof fr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Aa(this.gl,U,()=>{if(A)this.gl.compressedTexSubImage2D(n,p,s,l,o,h,b,i);else if(i===null)this.gl.texSubImage2D(n,p,s,l,o,h,w,x,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,p,s,l,o,h,w,x,i,L);else if(i instanceof eO){const D=vs(this.gl);D.bindBuffer(35052,i),D.texSubImage2D(n,p,s,l,o,h,w,x,L),D.bindBuffer(35052,null)}else Un(this.gl)?vs(this.gl).texSubImage2D(n,p,s,l,o,h,w,x,i):this.gl.texSubImage2D(n,p,s,l,w,x,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return en.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof fr?{data:n.handle,dataType:"buffer"}:n instanceof eO?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:l,type:o,compressed:h}=e;const p=VM[n];return l=l||p&&p.dataFormat,o=o||p&&p.types[0],h=h||p&&p.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:l,type:o,compressed:h,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},Ft(i,"Could not deduced texture size"),Ft(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),Ft(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Ft(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Un(this.gl)||!this.width||!this.height?!1:!J8(this.width)||!J8(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:Bue.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}},Uue="";function Vue(t,e){return Ft(typeof t=="string"),t=Uue+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}let Io=class extends Od{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Od.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};rx(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:Vue(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}};const mS=[34069,34070,34071,34072,34073,34074];class gU extends Od{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};rx(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:s=0,mipmapLevel:l=0}=e;return this._subImage({target:n,data:r,x:i,y:s,mipmapLevel:l})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:s,border:l=0,format:o=6408,type:h=5121}=e;const{gl:p}=this,b=i||s,x=await Promise.all(mS.map(w=>{const A=b[w];return Promise.all(Array.isArray(A)?A:[A])}));this.bind(),mS.forEach((w,A)=>{x[A].length>1&&this.opts.mipmaps!==!1&&en.warn("".concat(this.id," has mipmap and multiple LODs."))(),x[A].forEach((L,M)=>{n&&r?p.texImage2D(w,M,o,n,r,l,o,h,L):p.texImage2D(w,M,o,o,h,L)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:s,data:l,border:o=0,format:h=6408,type:p=5121}=e,{gl:b}=this,x=s||l;return this.bind(),x instanceof Promise?x.then(w=>this.setImageDataForFace(Object.assign({},e,{face:n,data:w,pixels:w}))):this.width||this.height?b.texImage2D(n,0,h,r,i,o,h,p,x):b.texImage2D(n,0,h,h,p,x),this}}gU.FACES=mS;class jue extends Od{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Un(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};vs(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:s,depth:l=1,border:o=0,format:h,type:p=5121,offset:b=0,data:x,parameters:w={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Aa(this.gl,w,()=>{ArrayBuffer.isView(x)&&this.gl.texImage3D(this.target,n,r,i,s,l,o,h,p,x),x instanceof fr&&(this.gl.bindBuffer(35052,x.handle),this.gl.texImage3D(this.target,n,r,i,s,l,o,h,p,b))}),x&&x.byteLength)this._trackAllocatedMemory(x.byteLength,"Texture");else{const A=pU[this.dataFormat]||4,L=mU[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*A*L,"Texture")}return this.loaded=!0,this}}const td="EXT_color_buffer_float",tO={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:td,bpp:2},[33327]:{gl2:td,bpp:4},[34842]:{gl2:td,bpp:8},[33326]:{gl2:td,bpp:4},[33328]:{gl2:td,bpp:8},[34836]:{gl2:td,bpp:16},[35898]:{gl2:td,bpp:4}};function Gue(t,e,n){const r=n[e];if(!r)return!1;const i=Un(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}let gf=class extends cc{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||Gue(e,n,tO)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return Ft(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&Un(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*tO[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}};const Wue=256,Hue=1024,que=16384,nO=6144,rO=6145,iO=6146,sO=34041,yU="clear: bad arguments";function jM(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let l=0;n&&(l|=que,n!==!0&&(s.clearColor=n)),r&&(l|=Wue,r!==!0&&(s.clearDepth=r)),i&&(l|=Hue,r!==!0&&(s.clearStencil=r)),Ft(l!==0,yU),Aa(t,s,()=>{t.clear(l)})}function Kue(t){let{framebuffer:e=null,buffer:n=nO,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};vs(t),Aa(t,{framebuffer:e},()=>{switch(n){case nO:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case rO:t.clearBufferfv(rO,0,[i]);break;case iO:t.clearBufferiv(iO,0,[i]);break;case sO:const[s,l]=i;t.clearBufferfi(sO,0,s,l);break;default:Ft(!1,yU)}})}function Xue(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Ft(!1),0}}function ix(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:l=null,sourceWidth:o,sourceHeight:h,sourceType:p}=e;const{framebuffer:b,deleteFramebuffer:x}=vU(t);Ft(b);const{gl:w,handle:A,attachments:L}=b;o=o||b.width,h=h||b.height,s===36064&&A===null&&(s=1028),Ft(L[s]),p=p||L[s].type,l=Yue(l,p,i,o,h),p=p||fS(l);const M=w.bindFramebuffer(36160,A);return w.readPixels(n,r,o,h,i,p,l),w.bindFramebuffer(36160,M||null),x&&b.delete(),l}function oO(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=ix(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=$ue({data:r,width:i,height:s}));Mue({data:r,width:i,height:s});const l=document.createElement("canvas");l.width=i,l.height=s;const o=l.getContext("2d"),h=o.createImageData(i,s);return h.data.set(r),o.putImageData(h,0,0),l.toDataURL()}function Zue(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:s=0,targetInternalFormat:l=6408}=n;let{targetX:o,targetY:h,targetZ:p,width:b,height:x}=n;const{framebuffer:w,deleteFramebuffer:A}=vU(t);Ft(w);const{gl:L,handle:M}=w,U=typeof o<"u"||typeof h<"u"||typeof p<"u";o=o||0,h=h||0,p=p||0;const D=L.bindFramebuffer(36160,M);Ft(e);let $=null;if(e instanceof Od&&($=e,b=Number.isFinite(b)?b:$.width,x=Number.isFinite(x)?x:$.height,$.bind(0),e=$.target),!U)L.copyTexImage2D(e,s,l,r,i,b,x,0);else switch(e){case 3553:case 34067:L.copyTexSubImage2D(e,s,o,h,r,i,b,x);break;case 35866:case 32879:vs(L).copyTexSubImage3D(e,s,o,h,p,r,i,b,x);break}return $&&$.unbind(),L.bindFramebuffer(36160,D||null),A&&w.delete(),$}function vU(t){return t instanceof ns?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:ade(t),deleteFramebuffer:!0}}function Yue(t,e,n,r,i){if(t)return t;e=e||5121;const s=ay(e,{clamped:!1}),l=Xue(n);return new s(r*i*l)}const Mr={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function Jue(t){const e=new Io(t,{format:6408,type:5126,dataFormat:6408}),n=new ns(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const _U={[Mr.WEBGL2]:[!1,!0],[Mr.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Mr.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Mr.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Mr.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Mr.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Mr.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Mr.FLOAT_BLEND]:["EXT_float_blend"],[Mr.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Mr.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Mr.TEXTURE_FLOAT]:["OES_texture_float",!0],[Mr.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Mr.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Mr.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Mr.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Mr.COLOR_ATTACHMENT_RGBA32F]:[Jue,"EXT_color_buffer_float"],[Mr.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Mr.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Mr.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Mr.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Mr.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Mr.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},Que=2;function ede(t,e){return GM(t,e)}function GM(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>bU(t,n))}function tde(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in _U)t.luma.caps[e]===void 0&&(t.luma.caps[e]=bU(t,e));return t.luma.caps}function bU(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=nde(t,e)),t.luma.caps[e]||en.log(Que,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function nde(t,e){const n=_U[e];Ft(n,e);let r;const i=Un(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:Ft(!1);return r}const aO="Multiple render targets not supported";let ns=class xU extends cc{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new xU(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=vs(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=vs(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:l=!0,stencil:o=!1,check:h=!0,readBuffer:p=void 0,drawBuffers:b=void 0}=e;if(Ft(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const x in i){const w=i[x];(Array.isArray(w)?w[0]:w).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,l,o,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:p,drawBuffers:b}),i&&h&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:l=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:l});const{gl:o}=this,h=o.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,h||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return Ft(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&en.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(l=>{i[l]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const l in i){Ft(l!==void 0,"Misspelled framebuffer binding point?");const o=Number(l),h=i[o];let p=h;if(!p)this._unattach(o);else if(p instanceof gf)this._attachRenderbuffer({attachment:o,renderbuffer:p});else if(Array.isArray(h)){const[b,x=0,w=0]=h;p=b,this._attachTexture({attachment:o,texture:b,layer:x,level:w})}else this._attachTexture({attachment:o,texture:p,layer:0,level:0});r&&p&&p.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(l=>!this.attachments[l]).forEach(l=>{delete this.attachments[l]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(ide(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,l=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&jM(this.gl,{color:n,depth:r,stencil:i}),s.forEach((o,h)=>{Kue(this.gl,{drawBuffer:h,value:o})}),this.gl.bindFramebuffer(36160,l||null),this}readPixels(){return en.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return en.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return en.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return en.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return en.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return en.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:l}=e;const o=vs(this.gl),h=o.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&l===void 0?o.invalidateFramebuffer(36008,n):o.invalidateFramebuffer(36008,n,r,i,s,l),o.bindFramebuffer(36008,h),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=cu(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const l=n?cu(this.gl,s):s;i[l]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),l=e?cu(this.gl,s):s;r[l]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(oO(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>en.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=oO(this,{targetMaxHeight:100});return en.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let l=null;return e&&(l=l||{},l[36064]=new Io(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(l[36064])),n&&r?(l=l||{},l[33306]=new gf(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(l[33306])):n?(l=l||{},l[36096]=new gf(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(l[36096])):r&&Ft(!1),l}_unattach(e){const n=this.attachments[e];n&&(n instanceof gf?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:l}=this;switch(l.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:vs(l).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const h=rde(i);l.framebufferTexture2D(36160,n,h,r.handle,s);break;case 3553:l.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:Ft(!1,"Illegal texture type")}l.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=Mce(this.gl);n?n.readBuffer(e):Ft(e===36064||e===1029,aO),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=vs(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):Ft(e.length===1&&(e[0]===36064||e[0]===1029),aO)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=tde(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}};function rde(t){return t<34069?t+34069:t}function ide(t){return(ns.STATUS||{})[t]||"Framebuffer error ".concat(t)}const sde=[36049,36048,33296,33298,33299,33300,33301,33302,33303];ns.ATTACHMENT_PARAMETERS=sde;function ode(t,e){Ft(t instanceof Io||t instanceof gU||t instanceof jue);const n=t.constructor,{gl:r,width:i,height:s,format:l,type:o,dataFormat:h,border:p,mipmaps:b}=t,x=Object.assign({width:i,height:s,format:l,type:o,dataFormat:h,border:p,mipmaps:b},e);return new n(r,x)}function ade(t,e){const{gl:n,width:r,height:i,id:s}=t;return new ns(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{[36064]:t}}))}function F_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const lde=35632,cde=35633;function ude(t){switch(t){case lde:return"fragment";case cde:return"vertex";default:return"unknown type"}}function dde(t,e,n,r){const i=t.split(/\r?\n/),s={},l={},o=r||F_(e)||"(unnamed)",h="".concat(ude(n)," shader ").concat(o);for(let b=0;b<i.length;b++){const x=i[b];if(x.length<=1)continue;const w=x.split(":"),A=w[0],L=parseInt(w[2],10);if(isNaN(L))throw new Error("GLSL compilation error in ".concat(h,": ").concat(t));A!=="WARNING"?s[L]=x:l[L]=x}const p=hde(e);return{shaderName:h,errors:lO(s,p),warnings:lO(l,p)}}function lO(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],l=s.split(":",3),o=l[0],h=parseInt(l[1],10)||0,p=s.substring(l.join(":").length+1).trim();n+=wU("^^^ ".concat(o,": ").concat(p,`

`),h)}}return n}function hde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,l)=>{const o=String(l+e),h=o.length;return wU(o,i-h)+n+s})}function wU(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function TU(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const fde="Shader: GLSL source code must be a JavaScript string";let EU=class gS extends cc{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Ft(!1),"unknown"}}constructor(e,n){rx(e),Ft(typeof n.source=="string",fde);const r=F_(n.source,null)||n.id||yu("unnamed ".concat(gS.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=F_(n,null);r&&(this.id=yu(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(gS.getTypeName(this.shaderType),":").concat(this.id)}getName(){return F_(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:l}=dde(r,this.source,this.shaderType,this.id);throw en.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),en.warn("GLSL compilation warnings in ".concat(i,`
`).concat(l))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}},O2=class extends EU{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}},D2=class extends EU{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}};const pde={[5126]:Lr.bind(null,"uniform1fv",go,1,ps),[35664]:Lr.bind(null,"uniform2fv",go,2,ps),[35665]:Lr.bind(null,"uniform3fv",go,3,ps),[35666]:Lr.bind(null,"uniform4fv",go,4,ps),[5124]:Lr.bind(null,"uniform1iv",Oc,1,ps),[35667]:Lr.bind(null,"uniform2iv",Oc,2,ps),[35668]:Lr.bind(null,"uniform3iv",Oc,3,ps),[35669]:Lr.bind(null,"uniform4iv",Oc,4,ps),[35670]:Lr.bind(null,"uniform1iv",Oc,1,ps),[35671]:Lr.bind(null,"uniform2iv",Oc,2,ps),[35672]:Lr.bind(null,"uniform3iv",Oc,3,ps),[35673]:Lr.bind(null,"uniform4iv",Oc,4,ps),[35674]:Lr.bind(null,"uniformMatrix2fv",go,4,Ll),[35675]:Lr.bind(null,"uniformMatrix3fv",go,9,Ll),[35676]:Lr.bind(null,"uniformMatrix4fv",go,16,Ll),[35678]:Ji,[35680]:Ji,[5125]:Lr.bind(null,"uniform1uiv",$v,1,ps),[36294]:Lr.bind(null,"uniform2uiv",$v,2,ps),[36295]:Lr.bind(null,"uniform3uiv",$v,3,ps),[36296]:Lr.bind(null,"uniform4uiv",$v,4,ps),[35685]:Lr.bind(null,"uniformMatrix2x3fv",go,6,Ll),[35686]:Lr.bind(null,"uniformMatrix2x4fv",go,8,Ll),[35687]:Lr.bind(null,"uniformMatrix3x2fv",go,6,Ll),[35688]:Lr.bind(null,"uniformMatrix3x4fv",go,12,Ll),[35689]:Lr.bind(null,"uniformMatrix4x2fv",go,8,Ll),[35690]:Lr.bind(null,"uniformMatrix4x3fv",go,12,Ll),[35678]:Ji,[35680]:Ji,[35679]:Ji,[35682]:Ji,[36289]:Ji,[36292]:Ji,[36293]:Ji,[36298]:Ji,[36299]:Ji,[36300]:Ji,[36303]:Ji,[36306]:Ji,[36307]:Ji,[36308]:Ji,[36311]:Ji},mde={},gde={},yde={},cO=[0];function WM(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(cO[0]=t,t=cO);const i=t.length;if(i%e&&en.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let l=0;l<i;l++)s[l]=t[l];return s}function go(t,e){return WM(t,e,Float32Array,mde)}function Oc(t,e){return WM(t,e,Int32Array,gde)}function $v(t,e){return WM(t,e,Uint32Array,yde)}function uO(t,e,n){const r=pde[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function vde(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function _de(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!bde(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function bde(t){return Array.isArray(t)||ArrayBuffer.isView(t)?wde(t):isFinite(t)||t===!0||t===!1||t instanceof Od||t instanceof gf?!0:t instanceof ns?!!t.texture:!1}function xde(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function wde(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ji(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Lr(t,e,n,r){let i=null,s=null;return(l,o,h)=>{const p=e(h,n),b=p.length;let x=!1;if(i===null)i=new Float32Array(b),s=b,x=!0;else{Ft(s===b,"Uniform length cannot change.");for(let w=0;w<b;++w)if(p[w]!==i[w]){x=!0;break}}return x&&(r(l,t,o,p),i.set(p)),x}}function ps(t,e,n,r){t[e](n,r)}function Ll(t,e,n,r){t[e](n,!1,r)}const Tde=5120,Ede=5121,Sde=5122,Ade=5123,dO=0,kv=1,Pde=2,Cde=3,Ov=4,Lde=5,Ide=6,Ri=5126,Rde=35664,Mde=35665,$de=35666,Vm=5124,kde=35667,Ode=35668,Dde=35669,jm=5125,Fde=36294,Nde=36295,zde=36296,Bde=35670,Ude=35671,Vde=35672,jde=35673,Gde=35674,Wde=35675,Hde=35676,qde=35685,Kde=35686,Xde=35687,Zde=35688,Yde=35689,Jde=35690,yS={[Ri]:[Ri,1,"float"],[Rde]:[Ri,2,"vec2"],[Mde]:[Ri,3,"vec3"],[$de]:[Ri,4,"vec4"],[Vm]:[Vm,1,"int"],[kde]:[Vm,2,"ivec2"],[Ode]:[Vm,3,"ivec3"],[Dde]:[Vm,4,"ivec4"],[jm]:[jm,1,"uint"],[Fde]:[jm,2,"uvec2"],[Nde]:[jm,3,"uvec3"],[zde]:[jm,4,"uvec4"],[Bde]:[Ri,1,"bool"],[Ude]:[Ri,2,"bvec2"],[Vde]:[Ri,3,"bvec3"],[jde]:[Ri,4,"bvec4"],[Gde]:[Ri,8,"mat2"],[qde]:[Ri,8,"mat2x3"],[Kde]:[Ri,8,"mat2x4"],[Wde]:[Ri,12,"mat3"],[Xde]:[Ri,12,"mat3x2"],[Zde]:[Ri,12,"mat3x4"],[Hde]:[Ri,16,"mat4"],[Yde]:[Ri,16,"mat4x2"],[Jde]:[Ri,16,"mat4x3"]};function Qde(t){switch(t){case dO:return dO;case kv:return kv;case Cde:return kv;case Pde:return kv;case Ov:return Ov;case Lde:return Ov;case Ide:return Ov;default:return Ft(!1),0}}function hO(t){const e=yS[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function SU(t,e){switch(t){case Tde:case Ede:case Sde:case Ade:t=Ri;break}for(const n in yS){const[r,i,s]=yS[n];if(r===t&&i===e)return{glType:n,name:s}}return null}let ehe=class{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:l,size:o}=n.getActiveAttrib(e.handle,i),h=n.getAttribLocation(e.handle,s);h>=0&&this._addAttribute(h,s,l,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Un(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:l,size:o}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,l,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:l}=hO(r),o={type:s,size:i*l};this._inferProperties(e,n,o);const h={location:e,name:n,accessor:new Ul(o)};this.attributeInfos.push(h),this.attributeInfosByLocation[e]=h,this.attributeInfosByName[h.name]=h}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:l}=hO(r),o=new Ul({type:s,size:i*l}),h={location:e,name:n,accessor:o};this.varyingInfos.push(h),this.varyingInfosByName[h.name]=h}};const fO=4,the=35981,nhe=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];let AU=class extends cc{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",nhe),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:l=the}=e;return this.hash=n||"",this.vs=typeof r=="string"?new O2(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new D2(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,Ft(this.vs instanceof O2),Ft(this.fs instanceof D2),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(vs(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,l)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new ehe(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:l,end:o,isIndexed:h=!1,indexType:p=5123,instanceCount:b=0,isInstanced:x=b>0,vertexArray:w=null,transformFeedback:A,framebuffer:L,parameters:M={},uniforms:U,samplers:D}=e;if((U||D)&&(en.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(U||{})),en.priority>=n){const $=L?L.id:"default",N="mode=".concat(cu(this.gl,r)," verts=").concat(i," ")+"instances=".concat(b," indexType=").concat(cu(this.gl,p)," ")+"isInstanced=".concat(x," isIndexed=").concat(h," ")+"Framebuffer=".concat($);en.log(n,N)()}return Ft(w),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||x&&b===0?!1:(w.bindForDraw(i,b,()=>{if(L!==void 0&&(M=Object.assign({},M,{framebuffer:L})),A){const $=Qde(r);A.begin($)}this._bindTextures(),Aa(this.gl,M,()=>{h&&x?this.gl2.drawElementsInstanced(r,i,p,s,b):h&&Un(this.gl)&&!isNaN(l)&&!isNaN(o)?this.gl2.drawRangeElements(r,l,o,i,p,s):h?this.gl.drawElements(r,i,p,s):x?this.gl2.drawArraysInstanced(r,s,i,b):this.gl.drawArrays(r,s,i)}),A&&A.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};en.priority>=2&&_de(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,l=!1;if(s instanceof ns&&(s=s.texture),s instanceof Od)if(l=this.uniforms[n]!==r,l){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:h}=i;o.bind(h),s=h,this._textureUniforms[n]=o}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||l)&&xde(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new O2({handle:i});break;case 35632:r.fs=new D2({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=yu(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),en.time(fO,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),en.timeEnd(fO,"linkProgram for ".concat(this._getName()))(),e.debug||en.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=vde(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=uO(e,s,r),r.size>1)for(let l=0;l<r.size;l++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(l,"]")),this._uniformSetters["".concat(i,"[").concat(l,"]")]=uO(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}};const rhe=34918,ihe=34919,she=35007,ohe=36795,ahe=35976,lhe=35887,che=36202;class Lb extends cc{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=Un(e),i=GM(e,Mr.TIMER_QUERY);let s=r||i;for(const l of n)switch(l){case"queries":s=s&&r;break;case"timers":s=s&&i;break;default:Ft(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(she)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?che:lhe)}beginTransformFeedbackQuery(){return this.begin(ahe)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,ihe);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(ohe)}getResult(){return this.gl2.getQueryParameter(this.handle,rhe)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const s=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return Lb.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}let PU=class extends cc{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Un(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};vs(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,np(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:l}=this._getBufferParams(n);return r<0?(this.unused[e]=i,en.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,l,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof fr?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}},Dv=null;function uhe(t){return(!Dv||Dv.byteLength<t)&&(Dv=new ArrayBuffer(t)),Dv}function dhe(t,e){const n=uhe(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function hhe(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,l=i*s;let o=0;for(let h=r;o<s;o++)e[h++]=n[o];for(;o<l;)o<l-o?(e.copyWithin(r+o,r,r+o),o*=2):(e.copyWithin(r+o,r,r+l-o),o=l);return e}const fhe="elements must be GL.ELEMENT_ARRAY_BUFFER";let F2=class Za extends cc{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Un(e)||HB()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Za(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Za.MAX_ATTRIBUTES=Za.MAX_ATTRIBUTES||e.getParameter(34921),Za.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:Za._setConstantFloatArray(e,n,r);break;case Int32Array:Za._setConstantIntArray(e,n,r);break;case Uint32Array:Za._setConstantUintArray(e,n,r);break;default:Ft(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Za.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Ft(!e||e.target===34963,fhe),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:l,offset:o,normalized:h,integer:p,divisor:b}=r,{gl:x,gl2:w}=this;return e=Number(e),this.bind(()=>{x.bindBuffer(34962,n.handle),p?(Ft(Un(x)),w.vertexAttribIPointer(e,i,s,l,o)):x.vertexAttribPointer(e,i,s,h,l,o),x.enableVertexAttribArray(e),w.vertexAttribDivisor(e,b||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Za.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let l=!this.buffer;if(this.buffer=this.buffer||new fr(this.gl,i),l=l||this.buffer.reallocate(i),l=l||!this._compareConstantArrayValues(r,this.bufferValue),l){const o=dhe(n.constructor,s);hhe({target:o,source:r,start:0,count:s}),this.buffer.subData(o),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:Ft(!1)}}static _setConstantIntArray(e,n,r){switch(Ft(Un(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:Ft(!1)}}static _setConstantUintArray(e,n,r){switch(Ft(Un(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:Ft(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return Ft(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}};const phe="VertexArray: attributes must be Buffers or constants (i.e. typed array)",mhe=/^(.+)__LOCATION_([0-9]+)$/,ghe=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];let yhe=class{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new F2(e),hU(this,"VertexArray","v6.0",ghe),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new fr(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof fr&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof fr&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:l,name:o}=this._getAttributeIndex(e);if(!Number.isFinite(l)||l<0)return this.unused[e]=n,en.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const h=this._getAttributeInfo(o||l);if(!h)return s;const p=this.accessors[l]||{},b=Ul.resolve(h.accessor,p,r,i),{size:x,type:w}=b;return Ft(Number.isFinite(x)&&Number.isFinite(w)),{location:l,accessor:b}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=mhe.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof fr)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof fr){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof fr){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(phe)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(F2.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){F2.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,l=s>0;if(e.isInstanced=e.isInstanced||l,r instanceof fr){const o=r;if(l){const h=o.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,h)}else{const h=o.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,h)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return en.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}};function vhe(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let l=0;l<t.length&&l<n;++l)l>0&&(i+=",".concat(l%r===0?" ":"")),i+=ly(t[l],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function ly(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return vhe(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function pO(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;Ft(n);const s=".*_.*",l=".*Matrix",o=n._uniformSetters,h={},p=Object.keys(o).sort();let b=0;for(const A of p)!A.match(s)&&!A.match(l)&&N2({table:h,header:e,uniforms:r,uniformName:A,undefinedOnly:i})&&b++;for(const A of p)A.match(l)&&N2({table:h,header:e,uniforms:r,uniformName:A,undefinedOnly:i})&&b++;for(const A of p)h[A]||N2({table:h,header:e,uniforms:r,uniformName:A,undefinedOnly:i})&&b++;let x=0;const w={};if(!i)for(const A in r){const L=r[A];h[A]||(x++,w[A]={Type:"NOT USED: ".concat(L),[e]:ly(L)})}return{table:h,count:b,unusedTable:w,unusedCount:x}}function N2(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const l=r[i],o=_he(l);return!s||!o?(e[i]={[n]:o?ly(l):"N/A","Uniform Type":o?l:"NOT PROVIDED"},!0):!1}function _he(t){return t!=null}function bhe(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=mO(e,e.elements,null,n));const i=e.values;for(const s in i){const l=e._getAttributeInfo(s);if(l){let o="".concat(s,": ").concat(l.name);const h=e.accessors[l.location];h&&(o="".concat(s,": ").concat(xhe(l.name,h))),r[o]=mO(e,i[s],h,n)}}return r}function mO(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",l=1,o=0,h=0,p,b,x;if(n&&(s=n.type,l=n.size,s=String(s).replace("Array",""),p=s.indexOf("nt")!==-1),e instanceof fr){const w=e,{data:A,changed:L}=w.getDebugData();b=L?"*":"",x=A,h=w.byteLength,o=h/A.BYTES_PER_ELEMENT/l;let M;if(n){const U=n.divisor>0;M="".concat(U?"I ":"P "," ").concat(o," (x").concat(l,"=").concat(h," bytes ").concat(cu(i,s),")")}else p=!0,M="".concat(h," bytes");return{[r]:"".concat(b).concat(ly(x,{size:l,isInteger:p})),"Format ":M}}return x=e,l=e.length,s=String(e.constructor.name).replace("Array",""),p=s.indexOf("nt")!==-1,{[r]:"".concat(ly(x,{size:l,isInteger:p})," (constant)"),"Format ":"".concat(l,"x").concat(s," (constant)")}}function xhe(t,e){const{type:n,size:r}=e,i=SU(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function whe(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=gO(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=gO(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function gO(t){const{type:e,size:n}=t.accessor,r=SU(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const yO=lc()&&typeof document<"u";let The=0;class Ehe{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=U=>dU(U),onAddHTML:r=null,onInitialize:i=()=>{},onRender:s=()=>{},onFinalize:l=()=>{},onError:o,gl:h=null,glOptions:p={},debug:b=!1,createFramebuffer:x=!1,autoResizeViewport:w=!0,autoResizeDrawingBuffer:A=!0,stats:L=_d.get("animation-loop-".concat(The++))}=e;let{useDevicePixels:M=!0}=e;"useDevicePixelRatio"in e&&(en.deprecated("useDevicePixelRatio","useDevicePixels")(),M=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:s,onFinalize:l,onError:o,gl:h,glOptions:p,debug:b,createFramebuffer:x},this.gl=h,this.needsRedraw=null,this.timeline=null,this.stats=L,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:w,autoResizeDrawingBuffer:A,useDevicePixels:M}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Ft(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Lb.isSupported(this.gl,["timers"])?new Lb(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return en.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=yO?new Promise((e,n)=>{if(yO&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):Iue(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):Lue(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?UM(this.props.gl,e):this.onCreateContext(e),!nx(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");gue(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&xue(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new ns(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const Xy="vs",HM="fs";function Co(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const z2={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function She(t){const e={};for(const n in t){const r=t[n],i=Ahe(r);e[n]=i}return e}function Ahe(t){let e=vO(t);return e==="object"?t?"type"in t?Object.assign({},t,z2[t.type]):"value"in t?(e=vO(t.value),Object.assign({type:e},t,z2[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},z2[e])}function vO(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Phe="vs",Che="fs";let _O=class{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:l,getUniforms:o,deprecations:h=[],defines:p={},inject:b={},vertexShader:x,fragmentShader:w}=e;Co(typeof n=="string"),this.name=n,this.vs=r||x,this.fs=i||w,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(h),this.defines=p,this.injections=Lhe(b),l&&(this.uniforms=She(l))}getModuleSource(e){let n;switch(e){case Phe:n=this.vs||"";break;case Che:n=this.fs||"";break;default:Co(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Co(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}};function Lhe(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function Ihe(t){return Rhe(LU(t))}function Rhe(t){const e={},n={};return CU({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function CU(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&CU({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function LU(t,e){return t.map(n=>(n instanceof _O||(Co(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Co(n.name,"shader module has no name"),n=new _O(n),n.dependencies=LU(n.dependencies)),n))}function Mhe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const $he=7936,khe=7937,Ohe=7938,Dhe=35724,qM={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},cd={};Object.keys(qM).forEach(t=>{cd[t]=t});function Fhe(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Nhe(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||$he),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||khe);return{gpuVendor:zhe(n,r),vendor:n,renderer:r,version:t.getParameter(Ohe),shadingLanguageVersion:t.getParameter(Dhe)}}function zhe(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const B2={};function bO(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=qM[e];if(Co(r,e),!Mhe(n))return!0;if(e in B2)return B2[e];const i=r[0],s=n.behavior||"enable",l="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=t.createShader(35633);t.shaderSource(o,l),t.compileShader(o);const h=t.getShaderParameter(o,35713);return t.deleteShader(o),B2[e]=h,h}function Bhe(t,e){const n=qM[e];Co(n,e);const r=Fhe(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return Co(i===!1||i===!0),i}function Fv(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Bhe(t,n))}function Uhe(t){switch(Nhe(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Vhe(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return Fv(t,cd.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),Fv(t,cd.GLSL_DERIVATIVES)&&bO(t,cd.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),Fv(t,cd.GLSL_FRAG_DATA)&&bO(t,cd.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),Fv(t,cd.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const jhe=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,Ghe=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,Whe={[Xy]:jhe,[HM]:Ghe},N_="__LUMA_INJECT_DECLARATIONS__",xO=/void\s+main\s*\([^)]*\)\s*\{\n?/,wO=/}\n?[^{}]*$/,U2=[];function TO(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===Xy;for(const s in n){const l=n[s];l.sort((h,p)=>h.order-p.order),U2.length=l.length;for(let h=0,p=l.length;h<p;++h)U2[h]=l[h].injection;const o="".concat(U2.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(N_,o));break;case"vs:#main-start":i&&(t=t.replace(xO,h=>h+o));break;case"vs:#main-end":i&&(t=t.replace(wO,h=>o+h));break;case"fs:#decl":i||(t=t.replace(N_,o));break;case"fs:#main-start":i||(t=t.replace(xO,h=>h+o));break;case"fs:#main-end":i||(t=t.replace(wO,h=>o+h));break;default:t=t.replace(s,h=>h+o)}}return t=t.replace(N_,""),r&&(t=t.replace(/\}\s*$/,s=>s+Whe[e])),t}function vS(t){const e={};return Co(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function rp(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const IU=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Hhe=[...IU,[rp("attribute"),"in $1"],[rp("varying"),"out $1"]],qhe=[...IU,[rp("varying"),"in $1"]],RU=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],Khe=[...RU,[rp("in"),"attribute $1"],[rp("out"),"varying $1"]],Xhe=[...RU,[rp("in"),"varying $1"]],_S="gl_FragColor",bS=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Zhe=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Yhe(t,e,n){switch(e){case 300:return n?Ib(t,Hhe):Jhe(t);case 100:return n?Ib(t,Khe):Qhe(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Ib(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function Jhe(t){t=Ib(t,qhe);const e=t.match(bS);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(_S,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(Zhe,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(_S,"\\b"),"g"),n)}return t}function Qhe(t){t=Ib(t,Xhe);const e=t.match(bS);if(e){const n=e[1];t=t.replace(bS,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),_S)}return t}const efe=`

`.concat(N_,`

`),MU={[Xy]:"vertex",[HM]:"fragment"},tfe=`precision highp float;

`;function nfe(t,e){const{vs:n,fs:r}=e,i=Ihe(e.modules||[]);return{gl:t,vs:EO(t,Object.assign({},e,{source:n,type:Xy,modules:i})),fs:EO(t,Object.assign({},e,{source:r,type:HM,modules:i})),getUniforms:rfe(i)}}function EO(t,e){let{id:n,source:r,type:i,modules:s,defines:l={},hookFunctions:o=[],inject:h={},transpileToGLSL100:p=!1,prologue:b=!0,log:x}=e;Co(typeof r=="string","shader source must be a string");const w=i===Xy,A=r.split(`
`);let L=100,M="",U=r;A[0].indexOf("#version ")===0?(L=300,M=A[0],U=A.slice(1).join(`
`)):M="#version ".concat(L);const D={};s.forEach(re=>{Object.assign(D,re.getDefines())}),Object.assign(D,l);let $=b?"".concat(M,`
`).concat(sfe({id:n,source:r,type:i}),`
`).concat(ife({type:i}),`
`).concat(Uhe(t),`
`).concat(Vhe(t),`
`).concat(ofe(D),`
`).concat(w?"":tfe,`
`):"".concat(M,`
`);const N=lfe(o),B={},Z={},ie={};for(const re in h){const ve=typeof h[re]=="string"?{injection:h[re],order:0}:h[re],Te=re.match(/^(v|f)s:(#)?([\w-]+)$/);if(Te){const Ae=Te[2],fe=Te[3];Ae?fe==="decl"?Z[re]=[ve]:ie[re]=[ve]:B[re]=[ve]}else ie[re]=[ve]}for(const re of s){x&&re.checkDeprecations(U,x);const ve=re.getModuleSource(i,L);$+=ve;const Te=re.injections[i];for(const Ae in Te){const fe=Ae.match(/^(v|f)s:#([\w-]+)$/);if(fe){const _e=fe[2]==="decl"?Z:ie;_e[Ae]=_e[Ae]||[],_e[Ae].push(Te[Ae])}else B[Ae]=B[Ae]||[],B[Ae].push(Te[Ae])}}return $+=efe,$=TO($,i,Z),$+=afe(N[i],B),$+=U,$=TO($,i,ie),$=Yhe($,p?100:L,w),$}function rfe(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function ife(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(MU[e].toUpperCase(),`
`)}function sfe(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(MU[r],`

`):""}function ofe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function afe(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((l,o)=>l.order-o.order);for(const l of s)n+="  ".concat(l.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function lfe(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),l=n.replace(/\(.+/,"");e[i][l]=Object.assign(r,{signature:s})}),e}const cfe="void main() {gl_FragColor = vec4(0);}",$U=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,ufe=`#version 300 es
`.concat($U);function kU(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,s]=n;if(!e.includes(r)||!i||!s)return null;const l=s.split(";")[0];return{qualifier:r,type:i,name:l}}function OU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?ufe:e>300?"#version ".concat(e,`
`).concat($U):cfe;const s=ffe(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(s,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function dfe(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return Co(!1),null}}function hfe(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return Co(!1),null}}function ffe(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return Co(!1),null}}const pfe=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,mfe={name:"fp32",vs:pfe,fs:null};function SO(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Ao={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function gfe(t,{precision:e=Ao.precision}={}){return t=yfe(t),"".concat(parseFloat(t.toPrecision(e)))}function ip(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Jc(t,e,n){return _fe(t,r=>Math.max(e,Math.min(n,r)))}function cy(t,e,n){return ip(t)?t.map((r,i)=>cy(r,e[i],n)):n*e+(1-n)*t}function uy(t,e,n){const r=Ao.EPSILON;n&&(Ao.EPSILON=n);try{if(t===e)return!0;if(ip(t)&&ip(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!uy(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Ao.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Ao.EPSILON=r}}function yfe(t){return Math.round(t/Ao.EPSILON)*Ao.EPSILON}function vfe(t){return t.clone?t.clone():new Array(t.length)}function _fe(t,e,n){if(ip(t)){const r=t;n=n||vfe(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function bfe(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class DU extends bfe(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:ip(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ao)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+gfe(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!uy(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i];this[i]=s+r*(n[i]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Ao.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function xfe(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function xo(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function V2(t,e,n=""){if(Ao.debug&&!xfe(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class wfe extends DU{get x(){return this[0]}set x(e){this[0]=xo(e)}get y(){return this[1]}set y(e){this[1]=xo(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return xo(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return xo(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return SO(e>=0&&e<this.ELEMENTS,"index is out of range"),xo(this[e])}setComponent(e,n){return SO(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var z_=1e-6,sp=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Tfe(){var t=new sp(2);return sp!=Float32Array&&(t[0]=0,t[1]=0),t}function xS(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Efe(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Sfe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function Afe(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function Pfe(t,e){return t[0]=-e[0],t[1]=-e[1],t}function FU(t,e,n,r){var i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function Cfe(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var Lfe=Efe;(function(){var t=Tfe();return function(e,n,r,i,s,l){var o,h;for(n||(n=2),r||(r=0),i?h=Math.min(i*n+r,e.length):h=e.length,o=r;o<h;o+=n)t[0]=e[o],t[1]=e[o+1],s(t,t,l),e[o]=t[0],e[o+1]=t[1];return e}})();function Ife(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function NU(t,e,n){const r=e[0],i=e[1],s=e[2],l=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/l,t[1]=(n[1]*r+n[5]*i+n[9]*s)/l,t[2]=(n[2]*r+n[6]*i+n[10]*s)/l,t}function Rfe(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function Mfe(){var t=new sp(3);return sp!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function $fe(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function kfe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Ofe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Dfe(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[0],o=n[1],h=n[2];return t[0]=i*h-s*o,t[1]=s*l-r*h,t[2]=r*o-i*l,t}function zU(t,e,n){var r=e[0],i=e[1],s=e[2],l=n[3]*r+n[7]*i+n[11]*s+n[15];return l=l||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/l,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/l,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/l,t}function Ffe(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function Nfe(t,e,n){var r=n[0],i=n[1],s=n[2],l=n[3],o=e[0],h=e[1],p=e[2],b=i*p-s*h,x=s*o-r*p,w=r*h-i*o,A=i*w-s*x,L=s*b-r*w,M=r*x-i*b,U=l*2;return b*=U,x*=U,w*=U,A*=2,L*=2,M*=2,t[0]=o+b+A,t[1]=h+x+L,t[2]=p+w+M,t}function zfe(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Bfe(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Ufe(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Vfe(t,e){var n=t[0],r=t[1],i=t[2],s=e[0],l=e[1],o=e[2],h=Math.sqrt(n*n+r*r+i*i),p=Math.sqrt(s*s+l*l+o*o),b=h*p,x=b&&Ofe(t,e)/b;return Math.acos(Math.min(Math.max(x,-1),1))}var jfe=$fe;(function(){var t=Mfe();return function(e,n,r,i,s,l){var o,h;for(n||(n=3),r||(r=0),i?h=Math.min(i*n+r,e.length):h=e.length,o=r;o<h;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,l),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();const j2=[0,0,0];let Nv;class cl extends wfe{static get ZERO(){return Nv||(Nv=new cl(0,0,0),Object.freeze(Nv)),Nv}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&ip(e)?this.copy(e):(Ao.debug&&(xo(e),xo(n),xo(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Ao.debug&&(xo(e.x),xo(e.y),xo(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=xo(e)}angle(e){return Vfe(this,e)}cross(e){return Dfe(this,this,e),this.check()}rotateX({radians:e,origin:n=j2}){return zfe(this,this,n,e),this.check()}rotateY({radians:e,origin:n=j2}){return Bfe(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=j2}){return Ufe(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return zU(this,this,e),this.check()}transformAsVector(e){return NU(this,this,e),this.check()}transformByMatrix3(e){return Ffe(this,this,e),this.check()}transformByMatrix2(e){return Rfe(this,this,e),this.check()}transformByQuaternion(e){return Nfe(this,this,e),this.check()}}class Gfe extends DU{toString(){let e="[";if(Ao.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=xo(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function Wfe(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hfe(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],l=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=l,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function wS(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=e[4],o=e[5],h=e[6],p=e[7],b=e[8],x=e[9],w=e[10],A=e[11],L=e[12],M=e[13],U=e[14],D=e[15],$=n*o-r*l,N=n*h-i*l,B=n*p-s*l,Z=r*h-i*o,ie=r*p-s*o,re=i*p-s*h,ve=b*M-x*L,Te=b*U-w*L,Ae=b*D-A*L,fe=x*U-w*M,Pe=x*D-A*M,_e=w*D-A*U,ke=$*_e-N*Pe+B*fe+Z*Ae-ie*Te+re*ve;return ke?(ke=1/ke,t[0]=(o*_e-h*Pe+p*fe)*ke,t[1]=(i*Pe-r*_e-s*fe)*ke,t[2]=(M*re-U*ie+D*Z)*ke,t[3]=(w*ie-x*re-A*Z)*ke,t[4]=(h*Ae-l*_e-p*Te)*ke,t[5]=(n*_e-i*Ae+s*Te)*ke,t[6]=(U*B-L*re-D*N)*ke,t[7]=(b*re-w*B+A*N)*ke,t[8]=(l*Pe-o*Ae+p*ve)*ke,t[9]=(r*Ae-n*Pe-s*ve)*ke,t[10]=(L*ie-M*B+D*$)*ke,t[11]=(x*B-b*ie-A*$)*ke,t[12]=(o*Te-l*fe-h*ve)*ke,t[13]=(n*fe-r*Te+i*ve)*ke,t[14]=(M*N-L*Z-U*$)*ke,t[15]=(b*Z-x*N+w*$)*ke,t):null}function qfe(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],l=t[5],o=t[6],h=t[7],p=t[8],b=t[9],x=t[10],w=t[11],A=t[12],L=t[13],M=t[14],U=t[15],D=e*l-n*s,$=e*o-r*s,N=e*h-i*s,B=n*o-r*l,Z=n*h-i*l,ie=r*h-i*o,re=p*L-b*A,ve=p*M-x*A,Te=p*U-w*A,Ae=b*M-x*L,fe=b*U-w*L,Pe=x*U-w*M;return D*Pe-$*fe+N*Ae+B*Te-Z*ve+ie*re}function Td(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3],o=e[4],h=e[5],p=e[6],b=e[7],x=e[8],w=e[9],A=e[10],L=e[11],M=e[12],U=e[13],D=e[14],$=e[15],N=n[0],B=n[1],Z=n[2],ie=n[3];return t[0]=N*r+B*o+Z*x+ie*M,t[1]=N*i+B*h+Z*w+ie*U,t[2]=N*s+B*p+Z*A+ie*D,t[3]=N*l+B*b+Z*L+ie*$,N=n[4],B=n[5],Z=n[6],ie=n[7],t[4]=N*r+B*o+Z*x+ie*M,t[5]=N*i+B*h+Z*w+ie*U,t[6]=N*s+B*p+Z*A+ie*D,t[7]=N*l+B*b+Z*L+ie*$,N=n[8],B=n[9],Z=n[10],ie=n[11],t[8]=N*r+B*o+Z*x+ie*M,t[9]=N*i+B*h+Z*w+ie*U,t[10]=N*s+B*p+Z*A+ie*D,t[11]=N*l+B*b+Z*L+ie*$,N=n[12],B=n[13],Z=n[14],ie=n[15],t[12]=N*r+B*o+Z*x+ie*M,t[13]=N*i+B*h+Z*w+ie*U,t[14]=N*s+B*p+Z*A+ie*D,t[15]=N*l+B*b+Z*L+ie*$,t}function Rb(t,e,n){var r=n[0],i=n[1],s=n[2],l,o,h,p,b,x,w,A,L,M,U,D;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(l=e[0],o=e[1],h=e[2],p=e[3],b=e[4],x=e[5],w=e[6],A=e[7],L=e[8],M=e[9],U=e[10],D=e[11],t[0]=l,t[1]=o,t[2]=h,t[3]=p,t[4]=b,t[5]=x,t[6]=w,t[7]=A,t[8]=L,t[9]=M,t[10]=U,t[11]=D,t[12]=l*r+b*i+L*s+e[12],t[13]=o*r+x*i+M*s+e[13],t[14]=h*r+w*i+U*s+e[14],t[15]=p*r+A*i+D*s+e[15]),t}function KM(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Kfe(t,e,n,r){var i=r[0],s=r[1],l=r[2],o=Math.hypot(i,s,l),h,p,b,x,w,A,L,M,U,D,$,N,B,Z,ie,re,ve,Te,Ae,fe,Pe,_e,ke,Vt;return o<z_?null:(o=1/o,i*=o,s*=o,l*=o,h=Math.sin(n),p=Math.cos(n),b=1-p,x=e[0],w=e[1],A=e[2],L=e[3],M=e[4],U=e[5],D=e[6],$=e[7],N=e[8],B=e[9],Z=e[10],ie=e[11],re=i*i*b+p,ve=s*i*b+l*h,Te=l*i*b-s*h,Ae=i*s*b-l*h,fe=s*s*b+p,Pe=l*s*b+i*h,_e=i*l*b+s*h,ke=s*l*b-i*h,Vt=l*l*b+p,t[0]=x*re+M*ve+N*Te,t[1]=w*re+U*ve+B*Te,t[2]=A*re+D*ve+Z*Te,t[3]=L*re+$*ve+ie*Te,t[4]=x*Ae+M*fe+N*Pe,t[5]=w*Ae+U*fe+B*Pe,t[6]=A*Ae+D*fe+Z*Pe,t[7]=L*Ae+$*fe+ie*Pe,t[8]=x*_e+M*ke+N*Vt,t[9]=w*_e+U*ke+B*Vt,t[10]=A*_e+D*ke+Z*Vt,t[11]=L*_e+$*ke+ie*Vt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function BU(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],l=e[5],o=e[6],h=e[7],p=e[8],b=e[9],x=e[10],w=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+p*r,t[5]=l*i+b*r,t[6]=o*i+x*r,t[7]=h*i+w*r,t[8]=p*i-s*r,t[9]=b*i-l*r,t[10]=x*i-o*r,t[11]=w*i-h*r,t}function Xfe(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],l=e[1],o=e[2],h=e[3],p=e[8],b=e[9],x=e[10],w=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-p*r,t[1]=l*i-b*r,t[2]=o*i-x*r,t[3]=h*i-w*r,t[8]=s*r+p*i,t[9]=l*r+b*i,t[10]=o*r+x*i,t[11]=h*r+w*i,t}function UU(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],l=e[1],o=e[2],h=e[3],p=e[4],b=e[5],x=e[6],w=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+p*r,t[1]=l*i+b*r,t[2]=o*i+x*r,t[3]=h*i+w*r,t[4]=p*i-s*r,t[5]=b*i-l*r,t[6]=x*i-o*r,t[7]=w*i-h*r,t}function Zfe(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],l=n+n,o=r+r,h=i+i,p=n*l,b=r*l,x=r*o,w=i*l,A=i*o,L=i*h,M=s*l,U=s*o,D=s*h;return t[0]=1-x-L,t[1]=b+D,t[2]=w-U,t[3]=0,t[4]=b-D,t[5]=1-p-L,t[6]=A+M,t[7]=0,t[8]=w+U,t[9]=A-M,t[10]=1-p-x,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Yfe(t,e,n,r,i,s,l){var o=1/(n-e),h=1/(i-r),p=1/(s-l);return t[0]=s*2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*h,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(i+r)*h,t[10]=(l+s)*p,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*s*2*p,t[15]=0,t}function Jfe(t,e,n,r,i){var s=1/Math.tan(e/2),l;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(l=1/(r-i),t[10]=(i+r)*l,t[14]=2*i*r*l):(t[10]=-1,t[14]=-2*r),t}var Qfe=Jfe;function epe(t,e,n,r,i,s,l){var o=1/(e-n),h=1/(r-i),p=1/(s-l);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*p,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*h,t[14]=(l+s)*p,t[15]=1,t}var tpe=epe;function npe(t,e,n,r){var i,s,l,o,h,p,b,x,w,A,L=e[0],M=e[1],U=e[2],D=r[0],$=r[1],N=r[2],B=n[0],Z=n[1],ie=n[2];return Math.abs(L-B)<z_&&Math.abs(M-Z)<z_&&Math.abs(U-ie)<z_?Wfe(t):(b=L-B,x=M-Z,w=U-ie,A=1/Math.hypot(b,x,w),b*=A,x*=A,w*=A,i=$*w-N*x,s=N*b-D*w,l=D*x-$*b,A=Math.hypot(i,s,l),A?(A=1/A,i*=A,s*=A,l*=A):(i=0,s=0,l=0),o=x*l-w*s,h=w*i-b*l,p=b*s-x*i,A=Math.hypot(o,h,p),A?(A=1/A,o*=A,h*=A,p*=A):(o=0,h=0,p=0),t[0]=i,t[1]=o,t[2]=b,t[3]=0,t[4]=s,t[5]=h,t[6]=x,t[7]=0,t[8]=l,t[9]=p,t[10]=w,t[11]=0,t[12]=-(i*L+s*M+l*U),t[13]=-(o*L+h*M+p*U),t[14]=-(b*L+x*M+w*U),t[15]=1,t)}function rpe(){var t=new sp(4);return sp!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function ipe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Zy(t,e,n){var r=e[0],i=e[1],s=e[2],l=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*l,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*l,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*l,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*l,t}(function(){var t=rpe();return function(e,n,r,i,s,l){var o,h;for(n||(n=4),r||(r=0),i?h=Math.min(i*n+r,e.length):h=e.length,o=r;o<h;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,l),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();var TS;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(TS||(TS={}));const spe=45*Math.PI/180,ope=1,G2=.1,W2=500,ape=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class ul extends Gfe{static get IDENTITY(){return cpe()}static get ZERO(){return lpe()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return TS}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,l,o,h,p,b,x,w,A,L,M,U){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=l,this[6]=o,this[7]=h,this[8]=p,this[9]=b,this[10]=x,this[11]=w,this[12]=A,this[13]=L,this[14]=M,this[15]=U,this.check()}setRowMajor(e,n,r,i,s,l,o,h,p,b,x,w,A,L,M,U){return this[0]=e,this[1]=s,this[2]=p,this[3]=A,this[4]=n,this[5]=l,this[6]=b,this[7]=L,this[8]=r,this[9]=o,this[10]=x,this[11]=M,this[12]=i,this[13]=h,this[14]=w,this[15]=U,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(ape)}fromObject(e){return this.check()}fromQuaternion(e){return Zfe(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:l=G2,far:o=W2}=e;return o===1/0?upe(this,n,r,i,s,l):Yfe(this,n,r,i,s,l,o),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return npe(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:l=G2,far:o=W2}=e;return tpe(this,n,r,i,s,l,o),this.check()}orthographic(e){const{fovy:n=spe,aspect:r=ope,focalDistance:i=1,near:s=G2,far:l=W2}=e;AO(n);const o=n/2,h=i*Math.tan(o),p=h*r;return this.ortho({left:-p,right:p,bottom:-h,top:h,near:s,far:l})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return AO(n),Qfe(this,n,r,i,s),this.check()}determinant(){return qfe(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],l=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*l,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*l,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],l=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*l,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*l,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*l,e}transpose(){return Hfe(this,this),this.check()}invert(){return wS(this,this),this.check()}multiplyLeft(e){return Td(this,e,this),this.check()}multiplyRight(e){return Td(this,this,e),this.check()}rotateX(e){return BU(this,this,e),this.check()}rotateY(e){return Xfe(this,this,e),this.check()}rotateZ(e){return UU(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Kfe(this,this,e,n),this.check()}scale(e){return KM(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Rb(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Zy(n||[-0,-0,-0,-0],e,this),V2(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=Cfe(n||[-0,-0],e,this);break;case 3:i=zU(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return V2(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=Ife(n||[-0,-0],e,this);break;case 3:r=NU(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return V2(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let zv,Bv;function lpe(){return zv||(zv=new ul([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(zv)),zv}function cpe(){return Bv||(Bv=new ul,Object.freeze(Bv)),Bv}function AO(t){if(t>Math.PI*2)throw Error("expected radians")}function upe(t,e,n,r,i,s){const l=2*s/(n-e),o=2*s/(i-r),h=(n+e)/(n-e),p=(i+r)/(i-r),b=-1,x=-1,w=-2*s;return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=h,t[9]=p,t[10]=b,t[11]=x,t[12]=0,t[13]=0,t[14]=w,t[15]=0,t}const PO=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,dpe={lightSources:{}};function H2(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function hpe(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=H2(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,l)=>{i["lighting_uPointLight[".concat(l,"].color")]=H2(s),i["lighting_uPointLight[".concat(l,"].position")]=s.position,i["lighting_uPointLight[".concat(l,"].attenuation")]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((s,l)=>{i["lighting_uDirectionalLight[".concat(l,"].color")]=H2(s),i["lighting_uDirectionalLight[".concat(l,"].direction")]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function VU(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dpe;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},hpe({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return VU({lightSources:e})}return{}}const fpe={name:"lights",vs:PO,fs:PO,getUniforms:VU,defines:{MAX_LIGHTS:3}},ppe=new Uint8Array([0,255,255,255]),mpe={pickingSelectedColor:null,pickingHighlightColor:ppe,pickingActive:!1,pickingAttribute:!1};function gpe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mpe;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const ype=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,vpe=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,_pe={name:"picking",vs:ype,fs:vpe,getUniforms:gpe},bpe=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,xpe={};function wpe(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function Tpe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xpe;if(!("material"in t))return{};const{material:e}=t;return e?wpe(e):{lighting_uEnabled:!1}}const Epe={name:"gouraud-lighting",dependencies:[fpe],vs:bpe,defines:{LIGHTING_VERTEX:1},getUniforms:Tpe},Spe=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,Ape={name:"transform",vs:Spe,fs:null};let XM=class jU{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new jU(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:l=[],bufferMode:o=35981,transpileToGLSL100:h=!1}=e,p=this._getModuleList(e.modules),b=this._getHash(n),x=this._getHash(r),w=p.map(N=>this._getHash(N.name)).sort(),A=l.map(N=>this._getHash(N)),L=Object.keys(i).sort(),M=Object.keys(s).sort(),U=[],D=[];for(const N of L)U.push(this._getHash(N)),U.push(this._getHash(i[N]));for(const N of M)D.push(this._getHash(N)),D.push(this._getHash(s[N]));const $="".concat(b,"/").concat(x,"D").concat(U.join("/"),"M").concat(w.join("/"),"I").concat(D.join("/"),"V").concat(A.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(h?"T":"");if(!this._programCache[$]){const N=nfe(this.gl,{vs:n,fs:r,modules:p,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:h});this._programCache[$]=new AU(this.gl,{hash:$,vs:N.vs,fs:N.fs,varyings:l,bufferMode:o}),this._getUniforms[$]=N.getUniforms||(B=>{}),this._useCounts[$]=0}return this._useCounts[$]++,this._programCache[$]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,l=this._defaultModules.length;s<l;++s){const o=this._defaultModules[s],h=o.name;n[i++]=o,r[h]=!0}for(let s=0,l=e.length;s<l;++s){const o=e[s],h=o.name;r[h]||(n[i++]=o,r[h]=!0)}return n.length=i,n}};const Ppe={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Cpe(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const l=e.attributes[s],o=Lpe(s,n);if(s==="indices")i=l;else if(l.constant)r[o]=l.value;else{const h=l.value,p={...l};delete p.value,r[o]=[new fr(t,h),p],Ipe(s,p)}}if(i){const s=i.value||i;Ft(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const l={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new fr(t,{data:s,target:34963}),l]}return r}function Lpe(t,e){const{attributeMap:n=Ppe}=e||{};return n&&n[t]||t}function Ipe(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Ft(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Fh=2,Rpe=1e4,Mpe="Model needs drawMode and vertexCount",CO=()=>{},$pe={};let Dd=class{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=yu("model")}=n;Ft(nx(e)),this.id=r,this.gl=e,this.id=n.id||yu("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||XM.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:h,bufferMode:p,transpileToGLSL100:b}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:h,bufferMode:p,transpileToGLSL100:b},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Ft(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),Mpe)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:h,bufferMode:p,transpileToGLSL100:b}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:h,bufferMode:p,transpileToGLSL100:b},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Ft(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Ft(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=Cpe(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(np(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return jM(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:l=this.transformFeedback,parameters:o={},vertexArray:h=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let p;en.priority>=Fh&&(p=this._logDrawCallStart(Fh));const b=this.vertexArray.getDrawParams(),{isIndexed:x=b.isIndexed,indexType:w=b.indexType,indexOffset:A=b.indexOffset,vertexArrayInstanced:L=b.isInstanced}=this.props;L&&!this.isInstanced&&en.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:M,instanceCount:U}=this,{onBeforeRender:D=CO,onAfterRender:$=CO}=this.props;D(),this.program.setUniforms(this.uniforms);const N=this.program.draw(Object.assign($pe,e,{logPriority:p,uniforms:null,framebuffer:r,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:h,transformFeedback:l,isIndexed:x,indexType:w,isInstanced:M,instanceCount:U,offset:x?A:0}));return $(),en.priority>=Fh&&this._logDrawCallEnd(p,h,r),N}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{[35977]:n})),i.forEach(l=>l.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(l=>l.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return en.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:l,defines:o,varyings:h,bufferMode:p,transpileToGLSL100:b}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:l,defines:o,varyings:h,bufferMode:p,transpileToGLSL100:b}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Ft(n instanceof AU,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new yhe(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof fr&&n.delete()}}_setAnimationProps(e){this.animated&&Ft(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(np(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new PU(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:Rpe;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),en.group(Fh,">>> DRAWING MODEL ".concat(this.id),{collapsed:en.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=bhe({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:l,unusedTable:o,unusedCount:h}=pO({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:p,count:b}=pO({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});b>0&&en.log("MISSING UNIFORMS",Object.keys(p))(),h>0&&en.log("UNUSED UNIFORMS",Object.keys(o))();const x=whe(this.vertexArray.configuration);en.table(e,s)(),en.table(e,l)(),en.table(e+1,x)(),i&&i.log({logLevel:Fh,message:"Rendered to ".concat(i.id)}),en.groupEnd(Fh)()}};class kpe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof fr?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Ft(Un(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const s=this.feedbackMap[i];i in n&&(r[s]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const s=r[i];if(typeof s=="string"){const l=n[s],{byteLength:o,usage:h,accessor:p}=l;r[i]=this._createNewBuffer(i,{byteLength:o,usage:h,accessor:p})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new PU(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const s=this.feedbackMap[i];n[i]=e.feedbackBuffers[s],r[s]=e.sourceBuffers[i],Ft(r[s]instanceof fr)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new fr(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const Ope="transform_uSampler_",Mb="transform_uSize_",LO="transform_position";function Dpe(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,l=Object.keys(n).length,o=null;const h={};let p=e,b={};if(l>0||r){const x=p.split(`
`),w=x.slice();if(x.forEach((A,L,M)=>{if(l>0){const U=Upe(A,n);if(U){const{updatedLine:D,inject:$}=U;w[L]=D,b=vS([b,$]),Object.assign(h,U.samplerTextureMap),l--}}r&&!o&&(o=Bpe(A,r))}),r){Ft(i);const A="".concat(Mb).concat(r),L="uniform vec2 ".concat(A,`;
`),M="     vec2 ".concat(LO," = transform_getPos(").concat(A,`);
     gl_Position = vec4(`).concat(LO,`, 0, 1.);
`);b=vS([b,{"vs:#decl":L,"vs:#main-start":M}])}p=w.join(`
`)}return{vs:p,targetTextureType:o,inject:b,samplerTextureMap:h}}function Fpe(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let s,l;n&&({width:s,height:l}=r,i["".concat(Mb).concat(n)]=[s,l]);for(const o in e)({width:s,height:l}=e[o]),i["".concat(Mb).concat(o)]=[s,l];return i}function Npe(t){return kU(t,["attribute","in"])}function zpe(t){const e="".concat(Ope).concat(t),n="".concat(Mb).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function Bpe(t,e){const n=kU(t,["varying","out"]);return n&&n.name===e?n.type:null}function Upe(t,e){const n={},r=Npe(t);if(!r)return null;const{type:i,name:s}=r;if(s&&e[s]){const l="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:o,sizeName:h,uniformDeclerations:p}=zpe(s),b=dfe(i),x="  ".concat(i," ").concat(s," = transform_getInput(").concat(o,", ").concat(h,").").concat(b,`;
`);return n[o]=s,{updatedLine:l,inject:{"vs:#decl":p,"vs:#main-start":x},samplerTextureMap:n}}return null}const Vpe={[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},jpe="transform_output";class Gpe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:s}=this.bindings[this.currentIndex],l=Object.assign({},n,e.attributes),o=Object.assign({},e.uniforms),h=Object.assign({},e.parameters);let p=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){l.transform_elementID=this.elementIDBuffer;for(const x in this.samplerTextureMap){const w=this.samplerTextureMap[x];o[x]=r[w]}this._setSourceTextureParameters();const b=Fpe({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(o,b)}return this.hasTargetTexture&&(p=!1,h.viewport=[0,0,i.width,i.height]),{attributes:l,framebuffer:i,uniforms:o,discard:p,parameters:h}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=ix(n);if(!e)return r;const i=r.constructor,s=hfe(this.targetTextureType),l=new i(r.length*s/4);let o=0;for(let h=0;h<r.length;h+=4)for(let p=0;p<s;p++)l[o++]=r[h+p];return l}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof Io)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,s=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,s)=>{s[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new fr(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),s){e.targetTexture=s;const{width:l,height:o}=s,{framebuffer:h}=e;h?(h.update({attachments:{[36064]:s},resizeAttachments:!1}),h.resize({width:l,height:o})):e.framebuffer=new ns(this.gl,{id:"transform-framebuffer",width:l,height:o,attachments:{[36064]:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(Vpe)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=ode(e,{parameters:{[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},pixelStore:{[37440]:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:s,targetTextureType:l,inject:o,samplerTextureMap:h}=Dpe({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),p=vS([e.inject||{},o]);this.targetTextureType=l,this.samplerTextureMap=h;const b=e._fs||OU({version:TU(i),input:this.targetTextureVarying,inputType:l,output:jpe}),x=this.hasSourceTextures||this.targetTextureVarying?[Ape].concat(e.modules||[]):e.modules;return{vs:i,fs:b,modules:x,uniforms:s,inject:p}}}class ZM{static isSupported(e){return Un(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();Ft(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Dd(n,Object.assign({},e,{fs:e.fs||OU({version:TU(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){Wpe(n)&&(this.bufferTransform=new kpe(e,n)),Hpe(n)&&(this.textureTransform=new Gpe(e,n)),Ft(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function Wpe(t){return!!(!np(t.feedbackBuffers)||!np(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function Hpe(t){return!!(!np(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const IO={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class Yy{static get DRAW_MODE(){return IO}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=yu("geometry"),drawMode:r=IO.TRIANGLES,attributes:i={},indices:s=null,vertexCount:l=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=l||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,Ft(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(Ft(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const s=e[i],{value:l,size:o,constant:h}=s;!h&&l&&o>=1&&(r=Math.min(r,l.length/o))}return Ft(Number.isFinite(r)),r}}let qpe=1,Kpe=1;class GU{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,l=qpe++,o={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(o,this.time),this.channels.set(l,o),l}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:l}=i;s.setTime(this.getTime(l))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=Kpe++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const Xpe=[255,255,255],Zpe=1;let Ype=0;class Jpe{constructor(e={}){K(this,"id",void 0),K(this,"color",void 0),K(this,"intensity",void 0),K(this,"type","ambient");const{color:n=Xpe}=e,{intensity:r=Zpe}=e;this.id=e.id||"ambient-".concat(Ype++),this.color=n,this.intensity=r}}const Qpe=[255,255,255],eme=1,tme=[0,0,-1];let nme=0;class RO{constructor(e={}){K(this,"id",void 0),K(this,"color",void 0),K(this,"intensity",void 0),K(this,"type","directional"),K(this,"direction",void 0),K(this,"shadow",void 0);const{color:n=Qpe}=e,{intensity:r=eme}=e,{direction:i=tme}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(nme++),this.color=n,this.intensity=r,this.type="directional",this.direction=new cl(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class rme{constructor(e,n={id:"pass"}){K(this,"id",void 0),K(this,"gl",void 0),K(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class YM extends rme{constructor(...e){super(...e),K(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return rc(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:s,onViewportActive:l,clearStack:o=!0,clearCanvas:h=!0}=e;e.pass=e.pass||"unknown";const p=this.gl;h&&sme(p,n),o&&(this._lastRenderIndex=-1);const b=[];for(const x of i){const w=s&&s[x.id];l==null||l(x);const A=this._getDrawLayerParams(x,e),L=x.subViewports||[x];for(const M of L){const U=this._drawLayersInViewport(p,{target:n,moduleParameters:r,viewport:M,view:w,pass:e.pass,layers:e.layers},A);b.push(U)}}return b}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:l,effects:o,moduleParameters:h},p=!1){const b=[],x=WU(this._lastRenderIndex+1),w={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:l},A={};for(let L=0;L<n.length;L++){const M=n[L],U=this._shouldDrawLayer(M,w,s,A),D={shouldDrawLayer:U};U&&!p&&(D.layerRenderIndex=x(M,U),D.moduleParameters=this._getModuleParameters(M,o,r,h),D.layerParameters=this.getLayerParameters(M,L,e)),b[L]=D}return b}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:l,view:o},h){const p=ime(e,{moduleParameters:r,target:s,viewport:l});if(o&&o.props.clear){const x=o.props.clear===!0?{color:!0,depth:!0}:o.props.clear;Aa(e,{scissorTest:!0,scissor:p},()=>jM(e,x))}const b={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};rc(e,{viewport:p});for(let x=0;x<n.length;x++){const w=n[x],{shouldDrawLayer:A,layerRenderIndex:L,moduleParameters:M,layerParameters:U}=h[x];if(A&&w.props.pickable&&b.pickableCount++,w.isComposite)b.compositeCount++;else if(A){b.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,L),M.viewport=l;try{w._drawLayer({moduleParameters:M,uniforms:{layerIndex:L},parameters:U})}catch(D){w.raiseError(D,"drawing ".concat(w," to ").concat(i))}}}return b}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let l=e.parent;for(;l;){if(!l.props.visible||!l.filterSubLayer(n))return!1;n.layer=l,l=l.parent}if(r){const o=n.layer.id;if(o in i||(i[o]=r(n)),!i[o])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var s;const l=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:tp(this.gl)});if(n)for(const h of n){var o;Object.assign(l,(o=h.getModuleParameters)===null||o===void 0?void 0:o.call(h,e))}return Object.assign(l,this.getModuleParameters(e,n),i)}}function WU(t=0,e={}){const n={},r=(i,s)=>{const l=i.props._offset,o=i.id,h=i.parent&&i.parent.id;let p;if(h&&!(h in e)&&r(i.parent,!1),h in n){const b=n[h]=n[h]||WU(e[h],e);p=b(i,s),n[o]=b}else Number.isFinite(l)?(p=l+(e[h]||0),n[o]=null):p=t;return s&&p>=t&&(t=p+1),e[o]=p,p};return r}function ime(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||tp(t),l=i?n.height:t.drawingBufferHeight,o=r;return[o.x*s,l-(o.y+o.height)*s,o.width*s,o.height*s]}function sme(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;rc(t,{viewport:[0,0,n,r]}),t.clear(16640)}class ome extends YM{constructor(e,n){super(e,n),K(this,"shadowMap",void 0),K(this,"depthBuffer",void 0),K(this,"fbo",void 0),this.shadowMap=new Io(e,{width:1,height:1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.depthBuffer=new gf(e,{format:33189,width:1,height:1}),this.fbo=new ns(e,{id:"shadowmap",width:1,height:1,attachments:{[36064]:this.shadowMap,[36096]:this.depthBuffer}})}render(e){const n=this.fbo;Aa(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=tp(this.gl),s=r.width*i,l=r.height*i;(s!==n.width||l!==n.height)&&n.resize({width:s,height:l}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const HU="#define SMOOTH_EDGE_RADIUS 0.5",ame=`
`.concat(HU,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),lme=`
`.concat(HU,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),cme={name:"geometry",vs:ame,fs:lme},ume=Object.keys(Qn).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Qn[t],";")).join(""),dme=Object.keys(rl).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(rl[t],";")).join(""),hme=Object.keys(kd).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(kd[t],";")).join(""),fme="".concat(ume,`
`).concat(dme,`
`).concat(hme,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function pme(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Jy(t){let e={},n;return r=>{for(const i in r)if(!pme(r[i],e[i])){n=t(r),e=r;break}return n}}const MO=[0,0,0,0],mme=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],qU=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],gme=[0,0,0],KU=[0,0,0],yme=Jy(bme);function XU(t,e,n=KU){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===Qn.LNGLAT_OFFSETS||e===Qn.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case rl.WEB_MERCATOR:(e===Qn.LNGLAT||e===Qn.CARTESIAN)&&(i=[0,0,0],s=!1);break;case rl.WEB_MERCATOR_AUTO_OFFSET:e===Qn.LNGLAT?r=i:e===Qn.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case rl.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case rl.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function vme(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:l}=t,o=MO,h=MO,p=t.cameraPosition;const{geospatialOrigin:b,shaderCoordinateOrigin:x,offsetMode:w}=XU(t,e,n);return w&&(h=t.projectPosition(b||x),p=[p[0]-h[0],p[1]-h[1],p[2]-h[2]],h[3]=1,o=Zy([],h,l),s=r||s,l=Td([],i,s),l=Td([],l,mme)),{viewMatrix:s,viewProjectionMatrix:l,projectionCenter:o,originCommon:h,cameraPosCommon:p,shaderCoordinateOrigin:x,geospatialOrigin:b}}function _me({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Qn.DEFAULT,coordinateOrigin:i=KU,autoWrapLongitude:s=!1}){r===Qn.DEFAULT&&(r=t.isGeospatial?Qn.LNGLAT:Qn.CARTESIAN);const l=yme({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return l.project_uWrapLongitude=s,l.project_uModelMatrix=n||qU,l}function bme({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:l,cameraPosCommon:o,shaderCoordinateOrigin:h,geospatialOrigin:p}=vme(t,n,r),b=t.getDistanceScales(),x=[t.width*e,t.height*e],w=Zy([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,A={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:h,project_uCommonOrigin:l.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:x,project_uDevicePixelRatio:e,project_uFocalDistance:w,project_uCommonUnitsPerMeter:b.unitsPerMeter,project_uCommonUnitsPerWorldUnit:b.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:gme,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:qU,project_uCameraPosition:o};if(p){const L=t.getDistanceScales(p);switch(n){case Qn.METER_OFFSETS:A.project_uCommonUnitsPerWorldUnit=L.unitsPerMeter,A.project_uCommonUnitsPerWorldUnit2=L.unitsPerMeter2;break;case Qn.LNGLAT:case Qn.LNGLAT_OFFSETS:t._pseudoMeters||(A.project_uCommonUnitsPerMeter=L.unitsPerMeter),A.project_uCommonUnitsPerWorldUnit=L.unitsPerDegree,A.project_uCommonUnitsPerWorldUnit2=L.unitsPerDegree2;break;case Qn.CARTESIAN:A.project_uCommonUnitsPerWorldUnit=[1,1,L.unitsPerMeter[2]],A.project_uCommonUnitsPerWorldUnit2=[0,0,L.unitsPerMeter2[2]];break}}return A}const xme={};function wme(t=xme){return"viewport"in t?_me(t):{}}const JM={name:"project",dependencies:[mfe,cme],vs:fme,getUniforms:wme};function Tme(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Rf(t,e){const n=Zy([],e,t);return ipe(n,n,1/n[3]),n}function $O(t,e){const n=t%e;return n<0?e+n:n}function Eme(t,e,n){return n*e+(1-n)*t}function ES(t,e,n){return t<e?e:t>n?n:t}function Sme(t){return Math.log(t)*Math.LOG2E}const QM=Math.log2||Sme;function ic(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const ba=Math.PI,ZU=ba/4,Jo=ba/180,SS=180/ba,op=512,$b=4003e4,Uv=85.051129,Ame=1.5;function kO(t){return Math.pow(2,t)}function YU(t){return QM(t)}function ap(t){const[e,n]=t;ic(Number.isFinite(e)),ic(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Jo,i=n*Jo,s=op*(r+ba)/(2*ba),l=op*(ba+Math.log(Math.tan(ZU+i*.5)))/(2*ba);return[s,l]}function Fd(t){const[e,n]=t,r=e/op*(2*ba)-ba,i=2*(Math.atan(Math.exp(n/op*(2*ba)-ba))-ZU);return[r*SS,i*SS]}function Pme(t){const{latitude:e}=t;ic(Number.isFinite(e));const n=Math.cos(e*Jo);return YU($b*n)-9}function q2(t){const e=Math.cos(t*Jo);return op/$b/e}function AS(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;ic(Number.isFinite(e)&&Number.isFinite(n));const i=op,s=Math.cos(e*Jo),l=i/360,o=l/s,h=i/$b/s,p={unitsPerMeter:[h,h,h],metersPerUnit:[1/h,1/h,1/h],unitsPerDegree:[l,o,h],degreesPerUnit:[1/l,1/o,1/h]};if(r){const b=Jo*Math.tan(e*Jo)/s,x=l*b/2,w=i/$b*b,A=w/o*h;p.unitsPerDegree2=[0,x,w],p.unitsPerMeter2=[A,0,A]}return p}function JU(t,e){const[n,r,i]=t,[s,l,o]=e,{unitsPerMeter:h,unitsPerMeter2:p}=AS({longitude:n,latitude:r,highPrecision:!0}),b=ap(t);b[0]+=s*(h[0]+p[0]*l),b[1]+=l*(h[1]+p[1]*l);const x=Fd(b),w=(i||0)+(o||0);return Number.isFinite(i)||Number.isFinite(o)?[x[0],x[1],w]:x}function Cme(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:l}=t,o=Tme();Rb(o,o,[0,0,-i]),BU(o,o,-n*Jo),UU(o,o,r*Jo);const h=s/e;return KM(o,o,[h,h,h]),l&&Rb(o,o,kfe([],l)),o}function Lme(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:l,scale:o,nearZMultiplier:h=1,farZMultiplier:p=1}=t;let{fovy:b=kb(Ame)}=t;r!==void 0&&(b=kb(r));const x=b*Jo,w=i*Jo,A=QU(b);let L=A;l&&(L+=l[2]*o/Math.cos(w)/n);const M=x*(.5+(s?s[1]:0)/n),U=Math.sin(M)*L/Math.sin(ES(Math.PI/2-w-M,.01,Math.PI-.01)),D=Math.sin(w)*U+L,$=L*10,N=Math.min(D*p,$);return{fov:x,aspect:e/n,focalDistance:A,near:h,far:N}}function kb(t){return 2*Math.atan(.5/t)*SS}function QU(t){return .5/Math.tan(.5*t*Jo)}function eV(t,e){const[n,r,i=0]=t;return ic(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),Rf(e,[n,r,i,1])}function e$(t,e,n=0){const[r,i,s]=t;if(ic(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return Rf(e,[r,i,s,1]);const l=Rf(e,[r,i,0,1]),o=Rf(e,[r,i,1,1]),h=l[2],p=o[2],b=h===p?0:((n||0)-h)/(p-h);return FU([],l,o,b)}function Ime(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:l=[0,0]}=t,[[o,h],[p,b]]=r,x=Rme(t.padding),w=ap([o,ES(b,-Uv,Uv)]),A=ap([p,ES(h,-Uv,Uv)]),L=[Math.max(Math.abs(A[0]-w[0]),i),Math.max(Math.abs(A[1]-w[1]),i)],M=[e-x.left-x.right-Math.abs(l[0])*2,n-x.top-x.bottom-Math.abs(l[1])*2];ic(M[0]>0&&M[1]>0);const U=M[0]/L[0],D=M[1]/L[1],$=(x.right-x.left)/2/U,N=(x.top-x.bottom)/2/D,B=[(A[0]+w[0])/2+$,(A[1]+w[1])/2+N],Z=Fd(B),ie=Math.min(s,QM(Math.abs(Math.min(U,D))));return ic(Number.isFinite(ie)),{longitude:Z[0],latitude:Z[1],zoom:ie}}function Rme(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(ic(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const OO=Math.PI/180;function Mme(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},l=i([0,r],s),o=i([n,r],s);let h,p;const b=t.fovy?.5*t.fovy*OO:Math.atan(.5/t.altitude),x=(90-t.pitch)*OO;return b>x-.01?(h=DO(t,0,e),p=DO(t,n,e)):(h=i([0,0],s),p=i([n,0],s)),[l,o,p,h]}function DO(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=Rf(r,[e,0,1,1]),s=Rf(r,[e,t.height,1,1]),o=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),h=FU([],i,s,o),p=Fd(h);return p.push(n),p}const FO=512;function $me(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:l,bearing:o=0}=t;(i<-180||i>180)&&(i=$O(i+180,360)-180),(o<-180||o>180)&&(o=$O(o+180,360)-180);const h=QM(n/FO);if(l<=h)l=h,s=0;else{const p=n/2/Math.pow(2,l),b=Fd([0,p])[1];if(s<b)s=b;else{const x=Fd([0,FO-p])[1];s>x&&(s=x)}}return{width:e,height:n,longitude:i,latitude:s,zoom:l,pitch:r,bearing:o}}const tV=.01,kme=["longitude","latitude","zoom"],nV={curve:1.414,speed:1.2};function Ome(t,e,n,r){const{startZoom:i,startCenterXY:s,uDelta:l,w0:o,u1:h,S:p,rho:b,rho2:x,r0:w}=rV(t,e,r);if(h<tV){const B={};for(const Z of kme){const ie=t[Z],re=e[Z];B[Z]=Eme(ie,re,n)}return B}const A=n*p,L=Math.cosh(w)/Math.cosh(w+b*A),M=o*((Math.cosh(w)*Math.tanh(w+b*A)-Math.sinh(w))/x)/h,U=1/L,D=i+YU(U),$=Sfe([],l,M);xS($,$,s);const N=Fd($);return{longitude:N[0],latitude:N[1],zoom:D}}function Dme(t,e,n){const r={...nV,...n},{screenSpeed:i,speed:s,maxDuration:l}=r,{S:o,rho:h}=rV(t,e,r),p=1e3*o;let b;return Number.isFinite(i)?b=p/(i/h):b=p/s,Number.isFinite(l)&&b>l?0:b}function rV(t,e,n){n=Object.assign({},nV,n);const r=n.curve,i=t.zoom,s=[t.longitude,t.latitude],l=kO(i),o=e.zoom,h=[e.longitude,e.latitude],p=kO(o-i),b=ap(s),x=ap(h),w=Lfe([],x,b),A=Math.max(t.width,t.height),L=A/p,M=Afe(w)*l,U=Math.max(M,tV),D=r*r,$=(L*L-A*A+D*D*U*U)/(2*A*D*U),N=(L*L-A*A-D*D*U*U)/(2*L*D*U),B=Math.log(Math.sqrt($*$+1)-$),Z=Math.log(Math.sqrt(N*N+1)-N),ie=(Z-B)/r;return{startZoom:i,startCenterXY:b,uDelta:w,w0:A,u1:M,S:ie,rho:r,rho2:D,r0:B,r1:Z}}const Fme=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,Nme=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,zme=Jy(Gme),Bme=Jy(Wme),Ume=[0,0,0,1],Vme=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function jme(t,e){const[n,r,i]=t,s=e$([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function Gme({viewport:t,center:e}){return new ul(t.viewProjectionMatrix).invert().transform(e)}function Wme({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(l=>jme(l,r));for(const l of e){const o=l.clone().translate(new cl(t.center).negate()),h=s.map(b=>o.transform(b)),p=new ul().ortho({left:Math.min(...h.map(b=>b[0])),right:Math.max(...h.map(b=>b[0])),bottom:Math.min(...h.map(b=>b[1])),top:Math.max(...h.map(b=>b[1])),near:Math.min(...h.map(b=>-b[2])),far:Math.max(...h.map(b=>-b[2]))});n.push(p.multiplyRight(l))}return n}function Hme(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||Ume,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=zme({viewport:t.viewport,center:e.project_uCenter}),s=[],l=Bme({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let o=0;o<t.shadowMatrices.length;o++){const h=l[o],p=h.clone().translate(new cl(t.viewport.center).negate());e.project_uCoordinateSystem===Qn.LNGLAT&&e.project_uProjectionMode===rl.WEB_MERCATOR?(l[o]=p,s[o]=i):(l[o]=h.clone().multiplyRight(Vme),s[o]=p.transform(i))}for(let o=0;o<l.length;o++)r["shadow_uViewProjectionMatrices[".concat(o,"]")]=l[o],r["shadow_uProjectCenters[".concat(o,"]")]=s[o],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(o)]=t.shadowMaps[o]:r["shadow_uShadowMap".concat(o)]=t.dummyShadowMap;return r}const K2={name:"shadow",dependencies:[JM],vs:Fme,fs:Nme,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?Hme(t,e):{}},qme={color:[255,255,255],intensity:1},NO=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],Kme=[0,0,0,200/255];class iV{constructor(e={}){K(this,"id","lighting-effect"),K(this,"props",void 0),K(this,"shadowColor",Kme),K(this,"shadow",void 0),K(this,"ambientLight",void 0),K(this,"directionalLights",void 0),K(this,"pointLights",void 0),K(this,"shadowPasses",[]),K(this,"shadowMaps",[]),K(this,"dummyShadowMap",null),K(this,"programManager",void 0),K(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:l}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=XM.getDefaultProgramManager(e),K2&&this.programManager.addDefaultModule(K2)),this.dummyShadowMap||(this.dummyShadowMap=new Io(e,{width:1,height:1}));for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:n,layerFilter:r,viewports:i,onViewportActive:s,views:l,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(K2),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new ul().lookAt({eye:new cl(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new ome(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new Jpe(qme),this.directionalLights.push(new RO(NO[0]),new RO(NO[1])))}}class Xme{constructor(e={}){K(this,"_pool",[]),K(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:l=!1,initialize:o=!1,maxCount:h}){const p=i||e&&e.constructor||Float32Array,b=n*r+s;if(ArrayBuffer.isView(e)){if(b<=e.length)return e;if(b*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new p(e.buffer,0,b)}let x=1/0;h&&(x=h*r+s);const w=this._allocate(p,b,o,x);return e&&l?w.set(e):o||w.fill(0,0,4),this._release(e),w}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const l=this._pool,o=e.BYTES_PER_ELEMENT*s,h=l.findIndex(p=>p.byteLength>=o);if(h>=0){const p=new e(l.splice(h,1)[0],0,s);return r&&p.fill(0),p}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(l=>l.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const lp=new Xme;function fg(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Zme(t){return[t[12],t[13],t[14]]}function Yme(t){return{left:Nh(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Nh(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Nh(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Nh(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Nh(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Nh(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const zO=new cl;function Nh(t,e,n,r){zO.set(t,e,n);const i=zO.len();return{distance:r/i,normal:new cl(-t/i,-e/i,-n/i)}}function Jme(t){return t-Math.fround(t)}let Gm;function X2(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Gm=lp.allocate(Gm,s,{type:Float32Array,size:n*2});let l=r,o=0;for(;l<i;){for(let h=0;h<n;h++){const p=t[l++];Gm[o+h]=p,Gm[o+h+n]=Jme(p)}o+=n*2}return Gm.subarray(0,s*n*2)}function Qme(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const ege=Math.PI/180,tge=fg(),BO=[0,0,0],nge={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function rge({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:l,far:o}){const h=t/e,p=n?new ul().orthographic({fovy:r,aspect:h,focalDistance:i,near:l,far:o}):new ul().perspective({fovy:r,aspect:h,near:l,far:o});if(s){const{left:b=0,right:x=0,top:w=0,bottom:A=0}=s,L=Jc((b+t-x)/2,0,t)-t/2,M=Jc((w+e-A)/2,0,e)-e/2;p[8]-=L*2/t,p[9]+=M*2/e}return p}class Ep{constructor(e={}){K(this,"id",void 0),K(this,"x",void 0),K(this,"y",void 0),K(this,"width",void 0),K(this,"height",void 0),K(this,"padding",void 0),K(this,"isGeospatial",void 0),K(this,"zoom",void 0),K(this,"focalDistance",void 0),K(this,"position",void 0),K(this,"modelMatrix",void 0),K(this,"distanceScales",void 0),K(this,"scale",void 0),K(this,"center",void 0),K(this,"cameraPosition",void 0),K(this,"projectionMatrix",void 0),K(this,"viewMatrix",void 0),K(this,"viewMatrixUncentered",void 0),K(this,"viewMatrixInverse",void 0),K(this,"viewProjectionMatrix",void 0),K(this,"pixelProjectionMatrix",void 0),K(this,"pixelUnprojectionMatrix",void 0),K(this,"resolution",void 0),K(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||nge,this.focalDistance=e.focalDistance||1,this.position=e.position||BO,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?rl.WEB_MERCATOR:rl.WEB_MERCATOR_AUTO_OFFSET:rl.IDENTITY}equals(e){return e instanceof Ep?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&uy(e.projectionMatrix,this.projectionMatrix)&&uy(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=eV(r,this.pixelProjectionMatrix),[s,l]=i,o=n?l:this.height-l;return e.length===2?[s,o]:[s,o,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,l]=e,o=n?s:this.height-s,h=r&&r*this.distanceScales.unitsPerMeter[2],p=e$([i,o,l],this.pixelUnprojectionMatrix,h),[b,x,w]=this.unprojectPosition(p);return Number.isFinite(l)?[b,x,w]:Number.isFinite(r)?[b,x,r]:[b,x]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=ap(e);return n[1]=Jc(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Fd(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),l=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],l[0]),Math.min(r[1],i[1],s[1],l[1]),Math.max(r[0],i[0],s[0],l[0]),Math.max(r[1],i[1],s[1],l[1])]}getDistanceScales(e){return e?AS({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,Yme(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=Pme({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||AS({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:l}=e;let o=BO;if(s&&(o=l?new ul(l).transformAsVector(s,[]):s),this.isGeospatial){const h=this.projectPosition([n,r,0]);this.center=new cl(o).scale(this.distanceScales.unitsPerMeter).add(h)}else this.center=this.projectPosition(o)}_initMatrices(e){const{viewMatrix:n=tge,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:l=75,near:o=.1,far:h=1e3,padding:p=null,focalDistance:b=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new ul().multiplyRight(n).translate(new cl(this.center).negate()),this.projectionMatrix=r||rge({width:this.width,height:this.height,orthographic:i,fovyRadians:s||l*ege,focalDistance:b,padding:p,near:o,far:h});const x=fg();Td(x,x,this.projectionMatrix),Td(x,x,this.viewMatrix),this.viewProjectionMatrix=x,this.viewMatrixInverse=wS([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=Zme(this.viewMatrixInverse);const w=fg(),A=fg();KM(w,w,[this.width/2,-this.height/2,1]),Rb(w,w,[1,-1,0]),Td(A,w,this.viewProjectionMatrix),this.pixelProjectionMatrix=A,this.pixelUnprojectionMatrix=wS(fg(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Nn.warn("Pixel project matrix not invertible")()}}K(Ep,"displayName","Viewport");class Nd extends Ep{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:l=0,nearZMultiplier:o=.1,farZMultiplier:h=1.01,orthographic:p=!1,projectionMatrix:b,repeat:x=!1,worldOffset:w=0,position:A,padding:L,legacyMeterSizes:M=!1}=e;let{width:U,height:D,altitude:$=1.5}=e;const N=Math.pow(2,i);U=U||1,D=D||1;let B,Z=null;if(b)$=b[5]/2,B=kb($);else{e.fovy?(B=e.fovy,$=QU(B)):B=kb($);let re;if(L){const{top:ve=0,bottom:Te=0}=L;re=[0,Jc((ve+D-Te)/2,0,D)-D/2]}Z=Lme({width:U,height:D,scale:N,center:A&&[0,0,A[2]*q2(n)],offset:re,pitch:s,fovy:B,nearZMultiplier:o,farZMultiplier:h})}let ie=Cme({height:D,pitch:s,bearing:l,scale:N,altitude:$});w&&(ie=new ul().translate([512*w,0,0]).multiplyLeft(ie)),super({...e,width:U,height:D,viewMatrix:ie,longitude:r,latitude:n,zoom:i,...Z,fovy:B,focalDistance:$}),K(this,"longitude",void 0),K(this,"latitude",void 0),K(this,"pitch",void 0),K(this,"bearing",void 0),K(this,"altitude",void 0),K(this,"fovy",void 0),K(this,"orthographic",void 0),K(this,"_subViewports",void 0),K(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=l,this.altitude=$,this.fovy=B,this.orthographic=p,this._subViewports=x?[]:null,this._pseudoMeters=M,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new Nd({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*q2(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/q2(r);return[n,r,i]}addMetersToLngLat(e,n){return JU(e,n)}panByPosition(e,n){const r=e$(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=xS([],i,Pfe([],r)),l=xS([],this.center,s),[o,h]=this.unprojectFlat(l);return{longitude:o,latitude:h}}getBounds(e={}){const n=Mme(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:l,zoom:o}=Ime({width:r,height:i,bounds:e,...n});return new Nd({width:r,height:i,longitude:s,latitude:l,zoom:o})}}K(Nd,"displayName","WebMercatorViewport");const UO=[0,0,0];function Z2(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Nd){const[i,s,l=0]=t,o=e.getDistanceScales([i,s]);r[2]=l*o.unitsPerMeter[2]}return r}function ige(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:l}=t;return i===Qn.DEFAULT&&(i=e.isGeospatial?Qn.LNGLAT:Qn.CARTESIAN),s===void 0&&(s=i),l===void 0&&(l=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:l}}function sV(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[l,o,h=0]=t;switch(n&&([l,o,h]=Zy([],[l,o,h,1],n)),r){case Qn.LNGLAT:return Z2([l,o,h],e,s);case Qn.LNGLAT_OFFSETS:return Z2([l+i[0],o+i[1],h+(i[2]||0)],e,s);case Qn.METER_OFFSETS:return Z2(JU(i,[l,o,h]),e,s);case Qn.CARTESIAN:default:return e.isGeospatial?[l+i[0],o+i[1],h+i[2]]:e.projectPosition([l,o,h])}}function sge(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:l,fromCoordinateOrigin:o}=ige(e),{autoOffset:h=!0}=e,{geospatialOrigin:p=UO,shaderCoordinateOrigin:b=UO,offsetMode:x=!1}=h?XU(n,r,i):{},w=sV(t,{viewport:n,modelMatrix:s,coordinateSystem:l,coordinateOrigin:o,offsetMode:x});if(x){const A=n.projectPosition(p||b);jfe(w,w,A)}return w}const VO={blendFunc:[1,0,32771,0],blendEquation:32774};class oV extends YM{constructor(...e){super(...e),K(this,"pickZ",void 0),K(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:l,deviceRect:{x:o,y:h,width:p,height:b},cullRect:x,effects:w,pass:A="picking",pickZ:L,moduleParameters:M}){const U=this.gl;this.pickZ=L;const D=this._resetColorEncoder(L),$=Aa(U,{scissorTest:!0,scissor:[o,h,p,b],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...VO,blend:!L},()=>super.render({target:l,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:x,effects:w==null?void 0:w.filter(B=>B.useInPicking),pass:A,isPicking:!0,moduleParameters:M}));return this._colorEncoderState=null,{decodePickingColor:D&&age.bind(null,D),stats:$}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:s,operation:l}=e.props;return this._colorEncoderState?s&&l.includes("draw")&&(Object.assign(i,VO),i.blend=!0,i.blendColor=oge(this._colorEncoderState,e,r)):i.blend=!1,l.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function oge(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,l=r.get(e);return l?(l.viewports.push(n),s=l.a):(s=r.size+1,s<=255?(l={a:s,layer:e,viewports:[n]},r.set(e,l),i[s]=l):(Nn.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function age(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Jh={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Ob=Symbol.for("component"),uu=Symbol.for("propTypes"),Y2=Symbol.for("deprecatedProps"),Mf=Symbol.for("asyncPropDefaults"),zd=Symbol.for("asyncPropOriginal"),Qc=Symbol.for("asyncPropResolved");function t$(t,e=()=>!0){return Array.isArray(t)?aV(t,e,[]):e(t)?[t]:[]}function aV(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?aV(i,e,n):e(i)&&n.push(i)}return n}function lge({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let l=0;for(let o=n;l<i;l++)t[o++]=e[l];for(;l<s;)l<s-l?(t.copyWithin(n+l,n,n+l),l*=2):(t.copyWithin(n+l,n,n+s-l),l=s);return t}let cge=class{constructor(e,n,r){K(this,"id",void 0),K(this,"context",void 0),K(this,"isLoaded",void 0),K(this,"persistent",void 0),K(this,"_loadCount",0),K(this,"_subscribers",new Set),K(this,"_data",void 0),K(this,"_loader",void 0),K(this,"_error",void 0),K(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=Cb(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}};class uge{constructor({gl:e,protocol:n}){K(this,"protocol",void 0),K(this,"_context",void 0),K(this,"_resources",void 0),K(this,"_consumers",void 0),K(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new cge(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:l}=this;e.startsWith(l)&&(e=e.replace(l,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const o=s[e];if(this._track(r,i,o,n),o)return o.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,l=s[e]=s[e]||{},o=l[n]||{},h=o.resourceId&&this._resources[o.resourceId];h&&(h.unsubscribe(o),this.prune()),r&&(l[n]=o,o.onChange=i,o.resourceId=r.id,r.subscribe(o))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const dge=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Qy={name:"project32",dependencies:[JM],vs:dge},e0={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},..._pe},hge=[JM],fge=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function pge(t){const e=XM.getDefaultProgramManager(t);for(const n of hge)e.addDefaultModule(n);for(const n of fge)e.addShaderHook(n);return e}const mge="layerManager.setLayers",gge="layerManager.activateViewport";class yge{constructor(e,{deck:n,stats:r,viewport:i,timeline:s}={}){K(this,"layers",void 0),K(this,"context",void 0),K(this,"resourceManager",void 0),K(this,"_lastRenderedLayers",[]),K(this,"_needsRedraw",!1),K(this,"_needsUpdate",!1),K(this,"_nextLayers",null),K(this,"_debug",!1),K(this,"activateViewport",l=>{gs(gge,this,l),l&&(this.context.viewport=l)}),this.layers=[],this.resourceManager=new uge({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&pge(e),stats:r||new kM({id:"deck.gl"}),viewport:i||new Ep({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new GU,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){gs(mge,this,n,e),this._lastRenderedLayers=e;const r=t$(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const l of e)r[l.id]?Nn.warn("Multiple old layers with same id ".concat(l.id))():r[l.id]=l;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const l of i)if(l.hasUniformTransition()){s="Uniform transition in ".concat(l);break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&Nn.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let l=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),l=i.isComposite?i.getSubLayers():null}catch(o){this._handleError("matching",o,i)}l&&this._updateSublayersRecursively(l,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Jh.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Jh.MATCHED,n!==e&&(e.lifecycle=Jh.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=Jh.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Jh.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function il(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!il(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!il(t[s],e[s],n-1))return!1;return!0}return!1}class vge{constructor(e){K(this,"width",void 0),K(this,"height",void 0),K(this,"views",void 0),K(this,"viewState",void 0),K(this,"controllers",void 0),K(this,"timeline",void 0),K(this,"_viewports",void 0),K(this,"_viewportMap",void 0),K(this,"_isUpdating",void 0),K(this,"_needsRedraw",void 0),K(this,"_needsUpdate",void 0),K(this,"_eventManager",void 0),K(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const l=r[s];if(l.containsPixel(i)){const o=e.slice();return o[0]-=l.x,o[1]-=l.y,l.unproject(o,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=t$(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!il(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Nn.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var l;return(l=this.getView(e.id))===null||l===void 0?void 0:l.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const l={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return i||(i=this._createController(e,l)),i&&i.setProps(l),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],l=this.getViewState(s),o=s.makeViewport({viewState:l,width:this.width,height:this.height});let h=n[s.id];const p=!!s.controller;p&&!h&&(r=!0),(r||!p)&&h&&(h.finalize(),h=null),this.controllers[s.id]=this._updateController(s,l,o,h),o&&this._viewports.unshift(o)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const _ge=/([0-9]+\.?[0-9]*)(%|px)/;function Dc(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=_ge.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Fc(t,e){return t.relative?Math.round(t.position*e):t.position}function Vi(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class cp{constructor(e){K(this,"id",void 0),K(this,"viewportInstance",void 0),K(this,"_x",void 0),K(this,"_y",void 0),K(this,"_width",void 0),K(this,"_height",void 0),K(this,"_padding",void 0),K(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:s="100%",height:l="100%",padding:o=null,viewportInstance:h}=e||{};Vi(!h||h instanceof Ep),this.viewportInstance=h,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Dc(r),this._y=Dc(i),this._width=Dc(s),this._height=Dc(l),this._padding=o&&{left:Dc(o.left||0),right:Dc(o.right||0),top:Dc(o.top||0),bottom:Dc(o.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&il(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:Fc(this._x,e),y:Fc(this._y,n),width:Fc(this._width,e),height:Fc(this._height,n)};return this._padding&&(r.padding={left:Fc(this._padding.left,e),top:Fc(this._padding.top,n),right:Fc(this._padding.right,e),bottom:Fc(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let t0=class{constructor(e){K(this,"_inProgress",void 0),K(this,"_handle",void 0),K(this,"_timeline",void 0),K(this,"time",void 0),K(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const jO=()=>{},PS={BREAK:1,SNAP_TO_END:2,IGNORE:3},bge=t=>t,xge=PS.BREAK;class wge{constructor(e){K(this,"getControllerState",void 0),K(this,"props",void 0),K(this,"propsInTransition",void 0),K(this,"transition",void 0),K(this,"onViewStateChange",void 0),K(this,"onStateChange",void 0),K(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:l,duration:o,easing:h}}=n,p=h(r/o),b=i.interpolateProps(s,l,p);this.propsInTransition=this.getControllerState({...this.props,...b}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new t0(e.timeline),this.onViewStateChange=e.onViewStateChange||jO,this.onStateChange=e.onStateChange||jO}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:l}=this.transition.settings;i={...r,...s===PS.SNAP_TO_END?l:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===PS.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,l=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(l===0)return;const o=s.initializeProps(e,i);this.propsInTransition={};const h={duration:l,easing:n.transitionEasing||bge,interpolator:s,interruption:n.transitionInterruption||xge,startProps:o.start,endProps:o.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(h),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class lV{constructor(e){K(this,"_propsToCompare",void 0),K(this,"_propsToExtract",void 0),K(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!uy(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Vi(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const Tge=["longitude","latitude","zoom","bearing","pitch"],Ege=["longitude","latitude","zoom"];class cV extends lV{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:Tge,required:Ege},super(r.transitionProps),K(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const l=i(e),o=i(n),h=l.unproject(s);r.start.around=s,Object.assign(r.end,{around:o.project(h),aroundPosition:h,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=cy(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,cy(e.around,n.around,r)))}return i}}const Nc={transitionDuration:0},Sge=300,Vv=t=>1-(1-t)*(1-t),zh={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},nd={};class Age{constructor(e){K(this,"props",void 0),K(this,"state",{}),K(this,"transitionManager",void 0),K(this,"eventManager",void 0),K(this,"onViewStateChange",void 0),K(this,"onStateChange",void 0),K(this,"makeViewport",void 0),K(this,"_controllerState",void 0),K(this,"_events",{}),K(this,"_interactionState",{isDragging:!1}),K(this,"_customEvents",[]),K(this,"_eventStartBlocked",null),K(this,"_panMove",!1),K(this,"invertPan",!1),K(this,"dragMode","rotate"),K(this,"inertia",0),K(this,"scrollZoom",!0),K(this,"dragPan",!0),K(this,"dragRotate",!0),K(this,"doubleClickZoom",!0),K(this,"touchZoom",!0),K(this,"touchRotate",!1),K(this,"keyboard",!0),this.transitionManager=new wge({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?Sge:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:l=!0,touchZoom:o=!0,touchRotate:h=!1,keyboard:p=!0}=e,b=!!this.onViewStateChange;this.toggleEvents(zh.WHEEL,b&&r),this.toggleEvents(zh.PAN,b&&(i||s)),this.toggleEvents(zh.PINCH,b&&(o||h)),this.toggleEvents(zh.TRIPLE_PAN,b&&h),this.toggleEvents(zh.DOUBLE_TAP,b&&l),this.toggleEvents(zh.KEYBOARD,b&&p),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=l,this.touchZoom=o,this.touchRotate=h,this.keyboard=p}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const l=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:l})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,Nc,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,Nc,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Vv},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Nc,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Vv},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let l=2/(1+Math.exp(-Math.abs(s*r)));s<0&&l!==0&&(l=1/l);const o=this.controllerState.zoom({pos:n,scale:l});return this.updateViewport(o,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,Nc,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,Nc,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:Vv},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return nd._startPinchRotation=e.rotation,nd._lastPinchEvent=e,this.updateViewport(r,Nc,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:nd._startPinchRotation-r})}return this.updateViewport(n,Nc,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),nd._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=nd;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const l=Math.log2(e.scale),o=(l-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),h=Math.pow(2,l+o*n/2);s=s.zoom({pos:i,scale:h}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:Vv},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return nd._startPinchRotation=null,nd._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:l}=this.keyboard===!0?{}:this.keyboard,{controllerState:o}=this;let h;const p={};switch(e.srcEvent.code){case"Minus":h=n?o.zoomOut(r).zoomOut(r):o.zoomOut(r),p.isZooming=!0;break;case"Equal":h=n?o.zoomIn(r).zoomIn(r):o.zoomIn(r),p.isZooming=!0;break;case"ArrowLeft":n?(h=o.rotateLeft(s),p.isRotating=!0):(h=o.moveLeft(i),p.isPanning=!0);break;case"ArrowRight":n?(h=o.rotateRight(s),p.isRotating=!0):(h=o.moveRight(i),p.isPanning=!0);break;case"ArrowUp":n?(h=o.rotateUp(l),p.isRotating=!0):(h=o.moveUp(i),p.isPanning=!0);break;case"ArrowDown":n?(h=o.rotateDown(l),p.isRotating=!0):(h=o.moveDown(i),p.isPanning=!0);break;default:return!1}return this.updateViewport(h,this._getTransitionProps(),p),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Nc:e?{...n,transitionInterpolator:new cV({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class Pge{constructor(e,n){K(this,"_viewportProps",void 0),K(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const GO=5,Cge=1.2;class Lge extends Pge{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:l,bearing:o=0,pitch:h=0,altitude:p=1.5,position:b=[0,0,0],maxZoom:x=20,minZoom:w=0,maxPitch:A=60,minPitch:L=0,startPanLngLat:M,startZoomLngLat:U,startRotatePos:D,startBearing:$,startPitch:N,startZoom:B,normalize:Z=!0}=e;Vi(Number.isFinite(s)),Vi(Number.isFinite(i)),Vi(Number.isFinite(l)),super({width:n,height:r,latitude:i,longitude:s,zoom:l,bearing:o,pitch:h,altitude:p,maxZoom:x,minZoom:w,maxPitch:A,minPitch:L,normalize:Z,position:b},{startPanLngLat:M,startZoomLngLat:U,startRotatePos:D,startBearing:$,startPitch:N,startZoom:B}),K(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:l}=this.getState();if(!i||s===void 0||l===void 0)return this;let o;return e?o=this._getNewRotation(e,i,l,s):o={bearing:s+n,pitch:l+r},this._getUpdatedState(o)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:l,minZoom:o}=this.getViewportProps();let h=i+Math.log2(r);h=Jc(h,o,l);const p=this.makeViewport({...this.getViewportProps(),zoom:h});return this._getUpdatedState({zoom:h,...p.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Jc(i,r,n);const{maxPitch:s,minPitch:l,pitch:o}=e;e.pitch=Jc(o,l,s);const{normalize:h=!0}=e;return h&&Object.assign(e,$me(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],l=e[1]-n[1],o=e[1],h=n[1],{width:p,height:b}=this.getViewportProps(),x=s/p;let w=0;l>0?Math.abs(b-h)>GO&&(w=l/(h-b)*Cge):l<0&&h>GO&&(w=1-o/h),w=Jc(w,-1,1);const{minPitch:A,maxPitch:L}=this.getViewportProps(),M=i+180*x;let U=r;return w>0?U=r+w*(L-r):w<0&&(U=r-w*(A-r)),{pitch:U,bearing:M}}}class Ige extends Age{constructor(...e){super(...e),K(this,"ControllerState",Lge),K(this,"transition",{transitionDuration:300,transitionInterpolator:new cV({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),K(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}let uV=class extends cp{get ViewportType(){return Nd}get ControllerType(){return Ige}};K(uV,"displayName","MapView");const Rge=new iV;function Mge(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,s=(r=e.order)!==null&&r!==void 0?r:1/0;return i-s}class $ge{constructor(){K(this,"effects",void 0),K(this,"_resolvedEffects",[]),K(this,"_defaultEffects",[]),K(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>Mge(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(il(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];s&&s!==i?s.setProps?(s.setProps(i.props),r.push(s)):(s.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof iV)||this._resolvedEffects.push(Rge),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class kge extends YM{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const Oge="deckRenderer.renderLayers";class Dge{constructor(e){K(this,"gl",void 0),K(this,"layerFilter",void 0),K(this,"drawPickingColors",void 0),K(this,"drawLayersPass",void 0),K(this,"pickLayersPass",void 0),K(this,"renderCount",void 0),K(this,"_needsRedraw",void 0),K(this,"renderBuffers",void 0),K(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new kge(e),this.pickLayersPass=new oV(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||ns.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,gs(Oge,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new ns(this.gl),new ns(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const s of e)if(s.postRender){if(s.id===this.lastPostProcessEffect){i.target=n.target,s.postRender(this.gl,i);break}const l=s.postRender(this.gl,i);i.inputBuffer=l,i.swapBuffer=l===r[0]?r[1]:r[0]}}}const Fge={pickedColor:null,pickedObjectIndex:-1};function Nge({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:l,y:o,width:h,height:p}=s;let b=i*i,x=-1,w=0;for(let A=0;A<p;A++){const L=A+o-r,M=L*L;if(M>b)w+=4*h;else for(let U=0;U<h;U++){if(t[w+3]-1>=0){const $=U+l-n,N=$*$+M;N<=b&&(b=N,x=w)}w+=4}}if(x>=0){const A=t.slice(x,x+4),L=e(A);if(L){const M=Math.floor(x/4/h),U=x/4-M*h;return{...L,pickedColor:A,pickedX:l+U,pickedY:o+M}}Nn.error("Picked non-existent layer. Is picking buffer corrupt?")()}return Fge}function zge({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),l=s.join(",");if(!n.has(l)){const o=e(s);o?n.set(l,{...o,color:s}):Nn.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function dV({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let l=e[0];e.length>1&&(l=Uge((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let o;if(l){const h=[r-l.x,i-l.y];s!==void 0&&(h[2]=s),o=l.unproject(h)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:o,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function Bge(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:l,pickedObjectIndex:o}=e,h=l?[l]:[];if(r==="hover"){const x=n.index,w=n.layerId,A=l?l.props.id:null;if(A!==w||o!==x){if(A!==w){const L=i.find(M=>M.props.id===w);L&&h.unshift(L)}n.layerId=A,n.index=o,n.info=null}}const p=dV(t),b=new Map;return b.set(null,p),h.forEach(x=>{let w={...p};x===l&&(w.color=s,w.index=o,w.picked=!0),w=hV({layer:x,info:w,mode:r});const A=w.layer;x===l&&r==="hover"&&(n.info=w),b.set(A.id,w),r==="hover"&&A.updateAutoHighlight(w)}),b}function hV({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function Uge(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class Vge{constructor(e){K(this,"gl",void 0),K(this,"pickingFBO",void 0),K(this,"depthFBO",void 0),K(this,"pickLayersPass",void 0),K(this,"layerFilter",void 0),K(this,"lastPickedInfo",void 0),K(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new oV(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const l=s&&s.layer&&s.layer.id,o=s&&s.viewport&&s.viewport.id,h=l?r.find(w=>w.id===l):null,p=o&&i.find(w=>w.id===o)||i[0],b=p&&p.unproject([e-p.x,n-p.y]);return{...s,...{x:e,y:n,viewport:p,coordinate:b,layer:h}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new ns(r),ns.isSupported(r,{colorBufferFloat:!0}))){const i=new ns(r);i.attach({[36064]:new Io(r,{format:Un(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:l=0,depth:o=1,mode:h="query",unproject3D:p,onViewportActive:b,effects:x}){const w=this._getPickable(e),A=tp(this.gl);if(!w)return{result:[],emptyInfo:dV({viewports:r,x:i,y:s,pixelRatio:A})};this._resizeBuffer();const L=M2(this.gl,[i,s],!0),M=[L.x+Math.floor(L.width/2),L.y+Math.floor(L.height/2)],U=Math.round(l*A),{width:D,height:$}=this.pickingFBO,N=this._getPickingRect({deviceX:M[0],deviceY:M[1],deviceRadius:U,deviceWidth:D,deviceHeight:$}),B={x:i-l,y:s-l,width:l*2+1,height:l*2+1};let Z;const ie=[],re=new Set;for(let ve=0;ve<o;ve++){let Te;if(N){const fe=this._drawAndSample({layers:w,views:n,viewports:r,onViewportActive:b,deviceRect:N,cullRect:B,effects:x,pass:"picking:".concat(h)});Te=Nge({...fe,deviceX:M[0],deviceY:M[1],deviceRadius:U,deviceRect:N})}else Te={pickedColor:null,pickedObjectIndex:-1};let Ae;if(Te.pickedLayer&&p&&this.depthFBO){const{pickedColors:fe}=this._drawAndSample({layers:[Te.pickedLayer],views:n,viewports:r,onViewportActive:b,deviceRect:{x:Te.pickedX,y:Te.pickedY,width:1,height:1},cullRect:B,effects:x,pass:"picking:".concat(h,":z")},!0);fe[3]&&(Ae=fe[0])}Te.pickedLayer&&ve+1<o&&(re.add(Te.pickedLayer),Te.pickedLayer.disablePickingIndex(Te.pickedObjectIndex)),Z=Bge({pickInfo:Te,lastPickedInfo:this.lastPickedInfo,mode:h,layers:w,viewports:r,x:i,y:s,z:Ae,pixelRatio:A});for(const fe of Z.values())fe.layer&&ie.push(fe);if(!Te.pickedColor)break}for(const ve of re)ve.restorePickingColors();return{result:ie,emptyInfo:Z.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:l=1,height:o=1,mode:h="query",maxObjects:p=null,onViewportActive:b,effects:x}){const w=this._getPickable(e);if(!w)return[];this._resizeBuffer();const A=tp(this.gl),L=M2(this.gl,[i,s],!0),M=L.x,U=L.y+L.height,D=M2(this.gl,[i+l,s+o],!0),$=D.x+D.width,N=D.y,B={x:M,y:N,width:$-M,height:U-N},Z=this._drawAndSample({layers:w,views:n,viewports:r,onViewportActive:b,deviceRect:B,cullRect:{x:i,y:s,width:l,height:o},effects:x,pass:"picking:".concat(h)}),ie=zge(Z),re=new Map,ve=Number.isFinite(p);for(let Te=0;Te<ie.length&&!(ve&&p&&re.size>=p);Te++){const Ae=ie[Te];let fe={color:Ae.pickedColor,layer:null,index:Ae.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:A};fe=hV({layer:Ae.pickedLayer,info:fe,mode:h}),re.has(fe.object)||re.set(fe.object,fe)}return Array.from(re.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:l,effects:o,pass:h},p=!1){const b=p?this.depthFBO:this.pickingFBO,x={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:b,deviceRect:s,cullRect:l,effects:o,pass:h,pickZ:p,preRenderStats:{}};for(const $ of o)$.useInPicking&&(x.preRenderStats[$.id]=$.preRender(this.gl,x));const{decodePickingColor:w}=this.pickLayersPass.render(x),{x:A,y:L,width:M,height:U}=s,D=new(p?Float32Array:Uint8Array)(M*U*4);return ix(b,{sourceX:A,sourceY:L,sourceWidth:M,sourceHeight:U,target:D}),{pickedColors:D,decodePickingColor:w}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const l=Math.max(0,e-r),o=Math.max(0,n-r),h=Math.min(i,e+r+1)-l,p=Math.min(s,n+r+1)-o;return h<=0||p<=0?null:{x:l,y:o,width:h,height:p}}}const jge={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};let Gge=class{constructor(e){K(this,"el",null),K(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,jge),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className),Object.assign(i.style,e.style);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}};var Bd={},Wge={get exports(){return Bd},set exports(t){Bd=t}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],l=n.createElement("div"),o="function",h=Math.round,p=Math.abs,b=Date.now;function x(J,oe,be){return setTimeout(N(J,be),oe)}function w(J,oe,be){return Array.isArray(J)?(A(J,be[oe],be),!0):!1}function A(J,oe,be){var Ue;if(J)if(J.forEach)J.forEach(oe,be);else if(J.length!==i)for(Ue=0;Ue<J.length;)oe.call(be,J[Ue],Ue,J),Ue++;else for(Ue in J)J.hasOwnProperty(Ue)&&oe.call(be,J[Ue],Ue,J)}function L(J,oe,be){var Ue="DEPRECATED METHOD: "+oe+`
`+be+` AT 
`;return function(){var rt=new Error("get-stack-trace"),$t=rt&&rt.stack?rt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",bn=e.console&&(e.console.warn||e.console.log);return bn&&bn.call(e.console,Ue,$t),J.apply(this,arguments)}}var M;typeof Object.assign!="function"?M=function(oe){if(oe===i||oe===null)throw new TypeError("Cannot convert undefined or null to object");for(var be=Object(oe),Ue=1;Ue<arguments.length;Ue++){var rt=arguments[Ue];if(rt!==i&&rt!==null)for(var $t in rt)rt.hasOwnProperty($t)&&(be[$t]=rt[$t])}return be}:M=Object.assign;var U=L(function(oe,be,Ue){for(var rt=Object.keys(be),$t=0;$t<rt.length;)(!Ue||Ue&&oe[rt[$t]]===i)&&(oe[rt[$t]]=be[rt[$t]]),$t++;return oe},"extend","Use `assign`."),D=L(function(oe,be){return U(oe,be,!0)},"merge","Use `assign`.");function $(J,oe,be){var Ue=oe.prototype,rt;rt=J.prototype=Object.create(Ue),rt.constructor=J,rt._super=Ue,be&&M(rt,be)}function N(J,oe){return function(){return J.apply(oe,arguments)}}function B(J,oe){return typeof J==o?J.apply(oe&&oe[0]||i,oe):J}function Z(J,oe){return J===i?oe:J}function ie(J,oe,be){A(Ae(oe),function(Ue){J.addEventListener(Ue,be,!1)})}function re(J,oe,be){A(Ae(oe),function(Ue){J.removeEventListener(Ue,be,!1)})}function ve(J,oe){for(;J;){if(J==oe)return!0;J=J.parentNode}return!1}function Te(J,oe){return J.indexOf(oe)>-1}function Ae(J){return J.trim().split(/\s+/g)}function fe(J,oe,be){if(J.indexOf&&!be)return J.indexOf(oe);for(var Ue=0;Ue<J.length;){if(be&&J[Ue][be]==oe||!be&&J[Ue]===oe)return Ue;Ue++}return-1}function Pe(J){return Array.prototype.slice.call(J,0)}function _e(J,oe,be){for(var Ue=[],rt=[],$t=0;$t<J.length;){var bn=oe?J[$t][oe]:J[$t];fe(rt,bn)<0&&Ue.push(J[$t]),rt[$t]=bn,$t++}return be&&(oe?Ue=Ue.sort(function(mn,Gr){return mn[oe]>Gr[oe]}):Ue=Ue.sort()),Ue}function ke(J,oe){for(var be,Ue,rt=oe[0].toUpperCase()+oe.slice(1),$t=0;$t<s.length;){if(be=s[$t],Ue=be?be+rt:oe,Ue in J)return Ue;$t++}return i}var Vt=1;function ut(){return Vt++}function rn(J){var oe=J.ownerDocument||J;return oe.defaultView||oe.parentWindow||e}var ot=/mobile|tablet|ip(ad|hone|od)|android/i,yt="ontouchstart"in e,at=ke(e,"PointerEvent")!==i,Mt=yt&&ot.test(navigator.userAgent),Re="touch",Ke="pen",Je="mouse",kt="kinect",ft=25,Pt=1,qt=2,lt=4,tn=8,Fn=1,St=2,bt=4,hn=8,ur=16,On=St|bt,Ln=hn|ur,is=On|Ln,dn=["x","y"],mr=["clientX","clientY"];function vn(J,oe){var be=this;this.manager=J,this.callback=oe,this.element=J.element,this.target=J.options.inputTarget,this.domHandler=function(Ue){B(J.options.enable,[J])&&be.handler(Ue)},this.init()}vn.prototype={handler:function(){},init:function(){this.evEl&&ie(this.element,this.evEl,this.domHandler),this.evTarget&&ie(this.target,this.evTarget,this.domHandler),this.evWin&&ie(rn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&re(this.element,this.evEl,this.domHandler),this.evTarget&&re(this.target,this.evTarget,this.domHandler),this.evWin&&re(rn(this.element),this.evWin,this.domHandler)}};function Nr(J){var oe,be=J.options.inputClass;return be?oe=be:at?oe=jt:Mt?oe=Pi:yt?oe=ae:oe=Qe,new oe(J,bs)}function bs(J,oe,be){var Ue=be.pointers.length,rt=be.changedPointers.length,$t=oe&Pt&&Ue-rt===0,bn=oe&(lt|tn)&&Ue-rt===0;be.isFirst=!!$t,be.isFinal=!!bn,$t&&(J.session={}),be.eventType=oe,Cr(J,be),J.emit("hammer.input",be),J.recognize(be),J.session.prevInput=be}function Cr(J,oe){var be=J.session,Ue=oe.pointers,rt=Ue.length;be.firstInput||(be.firstInput=ss(oe)),rt>1&&!be.firstMultiple?be.firstMultiple=ss(oe):rt===1&&(be.firstMultiple=!1);var $t=be.firstInput,bn=be.firstMultiple,xr=bn?bn.center:$t.center,mn=oe.center=We(Ue);oe.timeStamp=b(),oe.deltaTime=oe.timeStamp-$t.timeStamp,oe.angle=fn(xr,mn),oe.distance=yi(xr,mn),ai(be,oe),oe.offsetDirection=Vs(oe.deltaX,oe.deltaY);var Gr=pt(oe.deltaTime,oe.deltaX,oe.deltaY);oe.overallVelocityX=Gr.x,oe.overallVelocityY=Gr.y,oe.overallVelocity=p(Gr.x)>p(Gr.y)?Gr.x:Gr.y,oe.scale=bn?Ai(bn.pointers,Ue):1,oe.rotation=bn?Di(bn.pointers,Ue):0,oe.maxPointers=be.prevInput?oe.pointers.length>be.prevInput.maxPointers?oe.pointers.length:be.prevInput.maxPointers:oe.pointers.length,ko(be,oe);var xs=J.element;ve(oe.srcEvent.target,xs)&&(xs=oe.srcEvent.target),oe.target=xs}function ai(J,oe){var be=oe.center,Ue=J.offsetDelta||{},rt=J.prevDelta||{},$t=J.prevInput||{};(oe.eventType===Pt||$t.eventType===lt)&&(rt=J.prevDelta={x:$t.deltaX||0,y:$t.deltaY||0},Ue=J.offsetDelta={x:be.x,y:be.y}),oe.deltaX=rt.x+(be.x-Ue.x),oe.deltaY=rt.y+(be.y-Ue.y)}function ko(J,oe){var be=J.lastInterval||oe,Ue=oe.timeStamp-be.timeStamp,rt,$t,bn,xr;if(oe.eventType!=tn&&(Ue>ft||be.velocity===i)){var mn=oe.deltaX-be.deltaX,Gr=oe.deltaY-be.deltaY,xs=pt(Ue,mn,Gr);$t=xs.x,bn=xs.y,rt=p(xs.x)>p(xs.y)?xs.x:xs.y,xr=Vs(mn,Gr),J.lastInterval=oe}else rt=be.velocity,$t=be.velocityX,bn=be.velocityY,xr=be.direction;oe.velocity=rt,oe.velocityX=$t,oe.velocityY=bn,oe.direction=xr}function ss(J){for(var oe=[],be=0;be<J.pointers.length;)oe[be]={clientX:h(J.pointers[be].clientX),clientY:h(J.pointers[be].clientY)},be++;return{timeStamp:b(),pointers:oe,center:We(oe),deltaX:J.deltaX,deltaY:J.deltaY}}function We(J){var oe=J.length;if(oe===1)return{x:h(J[0].clientX),y:h(J[0].clientY)};for(var be=0,Ue=0,rt=0;rt<oe;)be+=J[rt].clientX,Ue+=J[rt].clientY,rt++;return{x:h(be/oe),y:h(Ue/oe)}}function pt(J,oe,be){return{x:oe/J||0,y:be/J||0}}function Vs(J,oe){return J===oe?Fn:p(J)>=p(oe)?J<0?St:bt:oe<0?hn:ur}function yi(J,oe,be){be||(be=dn);var Ue=oe[be[0]]-J[be[0]],rt=oe[be[1]]-J[be[1]];return Math.sqrt(Ue*Ue+rt*rt)}function fn(J,oe,be){be||(be=dn);var Ue=oe[be[0]]-J[be[0]],rt=oe[be[1]]-J[be[1]];return Math.atan2(rt,Ue)*180/Math.PI}function Di(J,oe){return fn(oe[1],oe[0],mr)+fn(J[1],J[0],mr)}function Ai(J,oe){return yi(oe[0],oe[1],mr)/yi(J[0],J[1],mr)}var De={mousedown:Pt,mousemove:qt,mouseup:lt},Ie="mousedown",Me="mousemove mouseup";function Qe(){this.evEl=Ie,this.evWin=Me,this.pressed=!1,vn.apply(this,arguments)}$(Qe,vn,{handler:function(oe){var be=De[oe.type];be&Pt&&oe.button===0&&(this.pressed=!0),be&qt&&oe.which!==1&&(be=lt),this.pressed&&(be&lt&&(this.pressed=!1),this.callback(this.manager,be,{pointers:[oe],changedPointers:[oe],pointerType:Je,srcEvent:oe}))}});var Ye={pointerdown:Pt,pointermove:qt,pointerup:lt,pointercancel:tn,pointerout:tn},vt={2:Re,3:Ke,4:Je,5:kt},Kt="pointerdown",st="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Kt="MSPointerDown",st="MSPointerMove MSPointerUp MSPointerCancel");function jt(){this.evEl=Kt,this.evWin=st,vn.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}$(jt,vn,{handler:function(oe){var be=this.store,Ue=!1,rt=oe.type.toLowerCase().replace("ms",""),$t=Ye[rt],bn=vt[oe.pointerType]||oe.pointerType,xr=bn==Re,mn=fe(be,oe.pointerId,"pointerId");$t&Pt&&(oe.button===0||xr)?mn<0&&(be.push(oe),mn=be.length-1):$t&(lt|tn)&&(Ue=!0),!(mn<0)&&(be[mn]=oe,this.callback(this.manager,$t,{pointers:be,changedPointers:[oe],pointerType:bn,srcEvent:oe}),Ue&&be.splice(mn,1))}});var Xt={touchstart:Pt,touchmove:qt,touchend:lt,touchcancel:tn},Gn="touchstart",Mn="touchstart touchmove touchend touchcancel";function $n(){this.evTarget=Gn,this.evWin=Mn,this.started=!1,vn.apply(this,arguments)}$($n,vn,{handler:function(oe){var be=Xt[oe.type];if(be===Pt&&(this.started=!0),!!this.started){var Ue=un.call(this,oe,be);be&(lt|tn)&&Ue[0].length-Ue[1].length===0&&(this.started=!1),this.callback(this.manager,be,{pointers:Ue[0],changedPointers:Ue[1],pointerType:Re,srcEvent:oe})}}});function un(J,oe){var be=Pe(J.touches),Ue=Pe(J.changedTouches);return oe&(lt|tn)&&(be=_e(be.concat(Ue),"identifier",!0)),[be,Ue]}var Qr={touchstart:Pt,touchmove:qt,touchend:lt,touchcancel:tn},li="touchstart touchmove touchend touchcancel";function Pi(){this.evTarget=li,this.targetIds={},vn.apply(this,arguments)}$(Pi,vn,{handler:function(oe){var be=Qr[oe.type],Ue=Ki.call(this,oe,be);Ue&&this.callback(this.manager,be,{pointers:Ue[0],changedPointers:Ue[1],pointerType:Re,srcEvent:oe})}});function Ki(J,oe){var be=Pe(J.touches),Ue=this.targetIds;if(oe&(Pt|qt)&&be.length===1)return Ue[be[0].identifier]=!0,[be,be];var rt,$t,bn=Pe(J.changedTouches),xr=[],mn=this.target;if($t=be.filter(function(Gr){return ve(Gr.target,mn)}),oe===Pt)for(rt=0;rt<$t.length;)Ue[$t[rt].identifier]=!0,rt++;for(rt=0;rt<bn.length;)Ue[bn[rt].identifier]&&xr.push(bn[rt]),oe&(lt|tn)&&delete Ue[bn[rt].identifier],rt++;if(xr.length)return[_e($t.concat(xr),"identifier",!0),xr]}var os=2500,Oo=25;function ae(){vn.apply(this,arguments);var J=N(this.handler,this);this.touch=new Pi(this.manager,J),this.mouse=new Qe(this.manager,J),this.primaryTouch=null,this.lastTouches=[]}$(ae,vn,{handler:function(oe,be,Ue){var rt=Ue.pointerType==Re,$t=Ue.pointerType==Je;if(!($t&&Ue.sourceCapabilities&&Ue.sourceCapabilities.firesTouchEvents)){if(rt)V.call(this,be,Ue);else if($t&&ne.call(this,Ue))return;this.callback(oe,be,Ue)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function V(J,oe){J&Pt?(this.primaryTouch=oe.changedPointers[0].identifier,H.call(this,oe)):J&(lt|tn)&&H.call(this,oe)}function H(J){var oe=J.changedPointers[0];if(oe.identifier===this.primaryTouch){var be={x:oe.clientX,y:oe.clientY};this.lastTouches.push(be);var Ue=this.lastTouches,rt=function(){var $t=Ue.indexOf(be);$t>-1&&Ue.splice($t,1)};setTimeout(rt,os)}}function ne(J){for(var oe=J.srcEvent.clientX,be=J.srcEvent.clientY,Ue=0;Ue<this.lastTouches.length;Ue++){var rt=this.lastTouches[Ue],$t=Math.abs(oe-rt.x),bn=Math.abs(be-rt.y);if($t<=Oo&&bn<=Oo)return!0}return!1}var se=ke(l.style,"touchAction"),ye=se!==i,Ee="compute",xe="auto",ge="manipulation",Se="none",je="pan-x",et="pan-y",Ve=xt();function It(J,oe){this.manager=J,this.set(oe)}It.prototype={set:function(J){J==Ee&&(J=this.compute()),ye&&this.manager.element.style&&Ve[J]&&(this.manager.element.style[se]=J),this.actions=J.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var J=[];return A(this.manager.recognizers,function(oe){B(oe.options.enable,[oe])&&(J=J.concat(oe.getTouchAction()))}),Ot(J.join(" "))},preventDefaults:function(J){var oe=J.srcEvent,be=J.offsetDirection;if(this.manager.session.prevented){oe.preventDefault();return}var Ue=this.actions,rt=Te(Ue,Se)&&!Ve[Se],$t=Te(Ue,et)&&!Ve[et],bn=Te(Ue,je)&&!Ve[je];if(rt){var xr=J.pointers.length===1,mn=J.distance<2,Gr=J.deltaTime<250;if(xr&&mn&&Gr)return}if(!(bn&&$t)&&(rt||$t&&be&On||bn&&be&Ln))return this.preventSrc(oe)},preventSrc:function(J){this.manager.session.prevented=!0,J.preventDefault()}};function Ot(J){if(Te(J,Se))return Se;var oe=Te(J,je),be=Te(J,et);return oe&&be?Se:oe||be?oe?je:et:Te(J,ge)?ge:xe}function xt(){if(!ye)return!1;var J={},oe=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(be){J[be]=oe?e.CSS.supports("touch-action",be):!0}),J}var Gt=1,zt=2,pn=4,Zt=8,nn=Zt,_n=16,En=32;function ir(J){this.options=M({},this.defaults,J||{}),this.id=ut(),this.manager=null,this.options.enable=Z(this.options.enable,!0),this.state=Gt,this.simultaneous={},this.requireFail=[]}ir.prototype={defaults:{},set:function(J){return M(this.options,J),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(J){if(w(J,"recognizeWith",this))return this;var oe=this.simultaneous;return J=oo(J,this),oe[J.id]||(oe[J.id]=J,J.recognizeWith(this)),this},dropRecognizeWith:function(J){return w(J,"dropRecognizeWith",this)?this:(J=oo(J,this),delete this.simultaneous[J.id],this)},requireFailure:function(J){if(w(J,"requireFailure",this))return this;var oe=this.requireFail;return J=oo(J,this),fe(oe,J)===-1&&(oe.push(J),J.requireFailure(this)),this},dropRequireFailure:function(J){if(w(J,"dropRequireFailure",this))return this;J=oo(J,this);var oe=fe(this.requireFail,J);return oe>-1&&this.requireFail.splice(oe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(J){return!!this.simultaneous[J.id]},emit:function(J){var oe=this,be=this.state;function Ue(rt){oe.manager.emit(rt,J)}be<Zt&&Ue(oe.options.event+sr(be)),Ue(oe.options.event),J.additionalEvent&&Ue(J.additionalEvent),be>=Zt&&Ue(oe.options.event+sr(be))},tryEmit:function(J){if(this.canEmit())return this.emit(J);this.state=En},canEmit:function(){for(var J=0;J<this.requireFail.length;){if(!(this.requireFail[J].state&(En|Gt)))return!1;J++}return!0},recognize:function(J){var oe=M({},J);if(!B(this.options.enable,[this,oe])){this.reset(),this.state=En;return}this.state&(nn|_n|En)&&(this.state=Gt),this.state=this.process(oe),this.state&(zt|pn|Zt|_n)&&this.tryEmit(oe)},process:function(J){},getTouchAction:function(){},reset:function(){}};function sr(J){return J&_n?"cancel":J&Zt?"end":J&pn?"move":J&zt?"start":""}function ci(J){return J==ur?"down":J==hn?"up":J==St?"left":J==bt?"right":""}function oo(J,oe){var be=oe.manager;return be?be.get(J):J}function Ci(){ir.apply(this,arguments)}$(Ci,ir,{defaults:{pointers:1},attrTest:function(J){var oe=this.options.pointers;return oe===0||J.pointers.length===oe},process:function(J){var oe=this.state,be=J.eventType,Ue=oe&(zt|pn),rt=this.attrTest(J);return Ue&&(be&tn||!rt)?oe|_n:Ue||rt?be&lt?oe|Zt:oe&zt?oe|pn:zt:En}});function zn(){Ci.apply(this,arguments),this.pX=null,this.pY=null}$(zn,Ci,{defaults:{event:"pan",threshold:10,pointers:1,direction:is},getTouchAction:function(){var J=this.options.direction,oe=[];return J&On&&oe.push(et),J&Ln&&oe.push(je),oe},directionTest:function(J){var oe=this.options,be=!0,Ue=J.distance,rt=J.direction,$t=J.deltaX,bn=J.deltaY;return rt&oe.direction||(oe.direction&On?(rt=$t===0?Fn:$t<0?St:bt,be=$t!=this.pX,Ue=Math.abs(J.deltaX)):(rt=bn===0?Fn:bn<0?hn:ur,be=bn!=this.pY,Ue=Math.abs(J.deltaY))),J.direction=rt,be&&Ue>oe.threshold&&rt&oe.direction},attrTest:function(J){return Ci.prototype.attrTest.call(this,J)&&(this.state&zt||!(this.state&zt)&&this.directionTest(J))},emit:function(J){this.pX=J.deltaX,this.pY=J.deltaY;var oe=ci(J.direction);oe&&(J.additionalEvent=this.options.event+oe),this._super.emit.call(this,J)}});function pl(){Ci.apply(this,arguments)}$(pl,Ci,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Se]},attrTest:function(J){return this._super.attrTest.call(this,J)&&(Math.abs(J.scale-1)>this.options.threshold||this.state&zt)},emit:function(J){if(J.scale!==1){var oe=J.scale<1?"in":"out";J.additionalEvent=this.options.event+oe}this._super.emit.call(this,J)}});function ml(){ir.apply(this,arguments),this._timer=null,this._input=null}$(ml,ir,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[xe]},process:function(J){var oe=this.options,be=J.pointers.length===oe.pointers,Ue=J.distance<oe.threshold,rt=J.deltaTime>oe.time;if(this._input=J,!Ue||!be||J.eventType&(lt|tn)&&!rt)this.reset();else if(J.eventType&Pt)this.reset(),this._timer=x(function(){this.state=nn,this.tryEmit()},oe.time,this);else if(J.eventType&lt)return nn;return En},reset:function(){clearTimeout(this._timer)},emit:function(J){this.state===nn&&(J&&J.eventType&lt?this.manager.emit(this.options.event+"up",J):(this._input.timeStamp=b(),this.manager.emit(this.options.event,this._input)))}});function fc(){Ci.apply(this,arguments)}$(fc,Ci,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Se]},attrTest:function(J){return this._super.attrTest.call(this,J)&&(Math.abs(J.rotation)>this.options.threshold||this.state&zt)}});function pc(){Ci.apply(this,arguments)}$(pc,Ci,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:On|Ln,pointers:1},getTouchAction:function(){return zn.prototype.getTouchAction.call(this)},attrTest:function(J){var oe=this.options.direction,be;return oe&(On|Ln)?be=J.overallVelocity:oe&On?be=J.overallVelocityX:oe&Ln&&(be=J.overallVelocityY),this._super.attrTest.call(this,J)&&oe&J.offsetDirection&&J.distance>this.options.threshold&&J.maxPointers==this.options.pointers&&p(be)>this.options.velocity&&J.eventType&lt},emit:function(J){var oe=ci(J.offsetDirection);oe&&this.manager.emit(this.options.event+oe,J),this.manager.emit(this.options.event,J)}});function ka(){ir.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}$(ka,ir,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ge]},process:function(J){var oe=this.options,be=J.pointers.length===oe.pointers,Ue=J.distance<oe.threshold,rt=J.deltaTime<oe.time;if(this.reset(),J.eventType&Pt&&this.count===0)return this.failTimeout();if(Ue&&rt&&be){if(J.eventType!=lt)return this.failTimeout();var $t=this.pTime?J.timeStamp-this.pTime<oe.interval:!0,bn=!this.pCenter||yi(this.pCenter,J.center)<oe.posThreshold;this.pTime=J.timeStamp,this.pCenter=J.center,!bn||!$t?this.count=1:this.count+=1,this._input=J;var xr=this.count%oe.taps;if(xr===0)return this.hasRequireFailures()?(this._timer=x(function(){this.state=nn,this.tryEmit()},oe.interval,this),zt):nn}return En},failTimeout:function(){return this._timer=x(function(){this.state=En},this.options.interval,this),En},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==nn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ao(J,oe){return oe=oe||{},oe.recognizers=Z(oe.recognizers,ao.defaults.preset),new yc(J,oe)}ao.VERSION="2.0.7",ao.defaults={domEvents:!1,touchAction:Ee,enable:!0,inputTarget:null,inputClass:null,preset:[[fc,{enable:!1}],[pl,{enable:!1},["rotate"]],[pc,{direction:On}],[zn,{direction:On},["swipe"]],[ka],[ka,{event:"doubletap",taps:2},["tap"]],[ml]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var mc=1,gc=2;function yc(J,oe){this.options=M({},ao.defaults,oe||{}),this.options.inputTarget=this.options.inputTarget||J,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=J,this.input=Nr(this),this.touchAction=new It(this,this.options.touchAction),Lu(this,!0),A(this.options.recognizers,function(be){var Ue=this.add(new be[0](be[1]));be[2]&&Ue.recognizeWith(be[2]),be[3]&&Ue.requireFailure(be[3])},this)}yc.prototype={set:function(J){return M(this.options,J),J.touchAction&&this.touchAction.update(),J.inputTarget&&(this.input.destroy(),this.input.target=J.inputTarget,this.input.init()),this},stop:function(J){this.session.stopped=J?gc:mc},recognize:function(J){var oe=this.session;if(!oe.stopped){this.touchAction.preventDefaults(J);var be,Ue=this.recognizers,rt=oe.curRecognizer;(!rt||rt&&rt.state&nn)&&(rt=oe.curRecognizer=null);for(var $t=0;$t<Ue.length;)be=Ue[$t],oe.stopped!==gc&&(!rt||be==rt||be.canRecognizeWith(rt))?be.recognize(J):be.reset(),!rt&&be.state&(zt|pn|Zt)&&(rt=oe.curRecognizer=be),$t++}},get:function(J){if(J instanceof ir)return J;for(var oe=this.recognizers,be=0;be<oe.length;be++)if(oe[be].options.event==J)return oe[be];return null},add:function(J){if(w(J,"add",this))return this;var oe=this.get(J.options.event);return oe&&this.remove(oe),this.recognizers.push(J),J.manager=this,this.touchAction.update(),J},remove:function(J){if(w(J,"remove",this))return this;if(J=this.get(J),J){var oe=this.recognizers,be=fe(oe,J);be!==-1&&(oe.splice(be,1),this.touchAction.update())}return this},on:function(J,oe){if(J!==i&&oe!==i){var be=this.handlers;return A(Ae(J),function(Ue){be[Ue]=be[Ue]||[],be[Ue].push(oe)}),this}},off:function(J,oe){if(J!==i){var be=this.handlers;return A(Ae(J),function(Ue){oe?be[Ue]&&be[Ue].splice(fe(be[Ue],oe),1):delete be[Ue]}),this}},emit:function(J,oe){this.options.domEvents&&sh(J,oe);var be=this.handlers[J]&&this.handlers[J].slice();if(!(!be||!be.length)){oe.type=J,oe.preventDefault=function(){oe.srcEvent.preventDefault()};for(var Ue=0;Ue<be.length;)be[Ue](oe),Ue++}},destroy:function(){this.element&&Lu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Lu(J,oe){var be=J.element;if(be.style){var Ue;A(J.options.cssProps,function(rt,$t){Ue=ke(be.style,$t),oe?(J.oldCssProps[Ue]=be.style[Ue],be.style[Ue]=rt):be.style[Ue]=J.oldCssProps[Ue]||""}),oe||(J.oldCssProps={})}}function sh(J,oe){var be=n.createEvent("Event");be.initEvent(J,!0,!0),be.gesture=oe,oe.target.dispatchEvent(be)}M(ao,{INPUT_START:Pt,INPUT_MOVE:qt,INPUT_END:lt,INPUT_CANCEL:tn,STATE_POSSIBLE:Gt,STATE_BEGAN:zt,STATE_CHANGED:pn,STATE_ENDED:Zt,STATE_RECOGNIZED:nn,STATE_CANCELLED:_n,STATE_FAILED:En,DIRECTION_NONE:Fn,DIRECTION_LEFT:St,DIRECTION_RIGHT:bt,DIRECTION_UP:hn,DIRECTION_DOWN:ur,DIRECTION_HORIZONTAL:On,DIRECTION_VERTICAL:Ln,DIRECTION_ALL:is,Manager:yc,Input:vn,TouchAction:It,TouchInput:Pi,MouseInput:Qe,PointerEventInput:jt,TouchMouseInput:ae,SingleTouchInput:$n,Recognizer:ir,AttrRecognizer:Ci,Tap:ka,Pan:zn,Swipe:pc,Pinch:pl,Rotate:fc,Press:ml,on:ie,off:re,each:A,merge:D,extend:U,assign:M,inherit:$,bindFn:N,prefixed:ke});var na=typeof e<"u"?e:typeof self<"u"?self:{};na.Hammer=ao,typeof i=="function"&&i.amd?i(function(){return ao}):t.exports?t.exports=ao:e[r]=ao})(window,document,"Hammer")})(Wge);const Hge=Bd,Ha=RY({__proto__:null,default:Hge},[Bd]),fV=1,pV=2,CS=4,qge={mousedown:fV,mousemove:pV,mouseup:CS};function Kge(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function Xge(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(Kge(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function Zge(t){t.prototype.handler=function(n){let r=qge[n.type];r&fV&&n.button>=0&&(this.pressed=!0),r&pV&&n.which===0&&(r=CS),this.pressed&&(r&CS&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}Xge(Bd.PointerEventInput);Zge(Bd.MouseInput);const Yge=Bd.Manager;class sx{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const Jge=Ha?[[Ha.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Ha.Rotate,{enable:!1}],[Ha.Pinch,{enable:!1}],[Ha.Swipe,{enable:!1}],[Ha.Pan,{threshold:0,enable:!1}],[Ha.Press,{enable:!1}],[Ha.Tap,{event:"doubletap",taps:2,enable:!1}],[Ha.Tap,{event:"anytap",enable:!1}],[Ha.Tap,{enable:!1}]]:null,WO={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Qge={doubletap:["tap"]},eye={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},n$={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},tye={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},HO={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},nye=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",yf=typeof window<"u"?window:global;let LS=!1;try{const t={get passive(){return LS=!0,!0}};yf.addEventListener("test",null,t),yf.removeEventListener("test",null)}catch{LS=!1}const rye=nye.indexOf("firefox")!==-1,{WHEEL_EVENTS:iye}=n$,qO="wheel",KO=4.000244140625,sye=40,oye=.25;class aye extends sx{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;yf.WheelEvent&&(rye&&i.deltaMode===yf.WheelEvent.DOM_DELTA_PIXEL&&(s/=yf.devicePixelRatio),i.deltaMode===yf.WheelEvent.DOM_DELTA_LINE&&(s*=sye)),s!==0&&s%KO===0&&(s=Math.floor(s/KO)),i.shiftKey&&s&&(s=s*oye),this.callback({type:qO,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(iye),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,LS?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===qO&&(this.options.enable=n)}}const{MOUSE_EVENTS:lye}=n$,XO="pointermove",ZO="pointerover",YO="pointerout",JO="pointerenter",QO="pointerleave";class cye extends sx{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(lye),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===XO&&(this.enableMoveEvent=n),e===ZO&&(this.enableOverEvent=n),e===YO&&(this.enableOutEvent=n),e===JO&&(this.enableEnterEvent=n),e===QO&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(ZO,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(YO,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(JO,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(QO,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(XO,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:uye}=n$,eD="keydown",tD="keyup";class dye extends sx{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:eD,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:tD,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(uye),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===eD&&(this.enableDownEvent=n),e===tD&&(this.enableUpEvent=n)}}const nD="contextmenu";class hye extends sx{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:nD,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===nD&&(this.options.enable=n)}}const IS=1,Db=2,RS=4,fye={pointerdown:IS,pointermove:Db,pointerup:RS,mousedown:IS,mousemove:Db,mouseup:RS},pye=1,mye=2,gye=3,yye=0,vye=1,_ye=2,bye=1,xye=2,wye=4;function Tye(t){const e=fye[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let s=!1,l=!1,o=!1;return e===RS||e===Db&&!Number.isFinite(n)?(s=i===pye,l=i===mye,o=i===gye):e===Db?(s=!!(n&bye),l=!!(n&wye),o=!!(n&xye)):e===IS&&(s=r===yye,l=r===vye,o=r===_ye),{leftButton:s,middleButton:l,rightButton:o}}function Eye(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,l={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:l}}const J2={srcElement:"root",priority:0};class Sye{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:l,handlersByElement:o}=this;let h=J2;typeof r=="string"||r&&r.addEventListener?h={...J2,srcElement:r}:r&&(h={...J2,...r});let p=o.get(h.srcElement);p||(p=[],o.set(h.srcElement,p));const b={type:e,handler:n,srcElement:h.srcElement,priority:h.priority};i&&(b.once=!0),s&&(b.passive=!0),l.push(b),this._active=this._active||!b.passive;let x=p.length-1;for(;x>=0&&!(p[x].priority>=b.priority);)x--;p.splice(x+1,0,b)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const l=r[s];if(l.type===e&&l.handler===n){r.splice(s,1);const o=i.get(l.srcElement);o.splice(o.indexOf(l),1),o.length===0&&i.delete(l.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},l=()=>{e.handled=!0,i=!0},o=[];for(let h=0;h<r.length;h++){const{type:p,handler:b,once:x}=r[h];if(b({...e,type:p,stopPropagation:s,stopImmediatePropagation:l}),x&&o.push(r[h]),i)break}for(let h=0;h<o.length;h++){const{type:p,handler:b}=o[h];this.remove(p,b)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...Tye(e),...Eye(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const Aye={events:null,recognizers:null,recognizerOptions:{},Manager:Yge,touchAction:"none",tabIndex:0};class Pye{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,l=eye[s.type];l&&this.manager.emit(l,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...Aye,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||Jge}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(WO).forEach(i=>{const s=this.manager.get(i);s&&WO[i].forEach(l=>{s.recognizeWith(l)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const l=n.recognizerOptions[i];delete l.enable,s.set(l)}}this.wheelInput=new aye(e,this._onOtherEvent,{enable:!1}),this.moveInput=new cye(e,this._onOtherEvent,{enable:!1}),this.keyInput=new dye(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new hye(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=Qge[e];s&&!this.options.recognizers&&s.forEach(l=>{const o=r.get(l);n?(o.requireFailure(e),i.dropRequireFailure(l)):o.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const b in e)this._addEventHandler(b,e[b],r,i,s);return}const{manager:l,events:o}=this,h=HO[e]||e;let p=o.get(h);p||(p=new Sye(this),o.set(h,p),p.recognizerName=tye[h]||h,l&&l.on(h,p.handleEvent)),p.add(e,n,r,i,s),p.isEmpty()||this._toggleRecognizer(p.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const l in e)this._removeEventHandler(l,e[l]);return}const{events:r}=this,i=HO[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:l}=s;let o=!1;for(const h of r.values())if(h.recognizerName===l&&!h.isEmpty()){o=!0;break}o||this._toggleRecognizer(l,!1)}}}function rd(){}const Cye=({isDragging:t})=>t?"grabbing":"grab",mV={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:rd,onResize:rd,onViewStateChange:rd,onInteractionStateChange:rd,onBeforeRender:rd,onAfterRender:rd,onLoad:rd,onError:t=>Nn.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:Cye,getTooltip:null,debug:!1,drawPickingColors:!1};class ox{constructor(e){K(this,"props",void 0),K(this,"width",0),K(this,"height",0),K(this,"userData",{}),K(this,"canvas",null),K(this,"viewManager",null),K(this,"layerManager",null),K(this,"effectManager",null),K(this,"deckRenderer",null),K(this,"deckPicker",null),K(this,"eventManager",null),K(this,"tooltip",null),K(this,"metrics",void 0),K(this,"animationLoop",void 0),K(this,"stats",void 0),K(this,"viewState",void 0),K(this,"cursorState",void 0),K(this,"_needsRedraw",void 0),K(this,"_pickRequest",void 0),K(this,"_lastPointerDownInfo",null),K(this,"_metricsCounter",void 0),K(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),K(this,"_onEvent",n=>{const r=U8[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const s=this.layerManager.getLayers(),l=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:s,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:o}=l,h=o&&(o[r.handler]||o.props[r.handler]),p=this.props[r.handler];let b=!1;h&&(b=h.call(o,l,n)),!b&&p&&p(l,n)}),K(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...mV,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Nn.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),HB()==="IE"&&Nn.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new kM({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&lp.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,l,o;if(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(r=this.effectManager)===null||r===void 0||r.finalize(),this.effectManager=null,(i=this.deckRenderer)===null||i===void 0||i.finalize(),this.deckRenderer=null,(s=this.deckPicker)===null||s===void 0||s.finalize(),this.deckPicker=null,(l=this.eventManager)===null||l===void 0||l.destroy(),this.eventManager=null,(o=this.tooltip)===null||o===void 0||o.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var h;(h=this.canvas.parentElement)===null||h===void 0||h.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Nn.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Nn.removed("onLayerClick","onClick")(),e.initialViewState&&!il(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),l=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||l,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Vi(this.viewManager),this.viewManager.views}getViewports(e){return Vi(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){Vi(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Vi(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(r||r===0){var i;const s=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,s=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||s!==this.height){var l;this.width=i,this.height=s,(l=this.viewManager)===null||l===void 0||l.setProps({width:i,height:s}),this.props.onResize({width:i,height:s})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:s,debug:l,onError:o,onBeforeRender:h,onAfterRender:p,useDevicePixels:b}=e;return new Ehe({width:n,height:r,useDevicePixels:b,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:x=>dU({...s,...x,canvas:this.canvas,debug:l,onContextLost:()=>this._onContextLost()}),onInitialize:x=>this._setGLContext(x.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:h,onAfterRender:p,onError:o})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new uV({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let s=i,l=!1;for(const o of r){var n;s=o,l=((n=o.layer)===null||n===void 0?void 0:n.onHover(o,e.event))||l}if(!l&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const o=this.props.getTooltip(s);this.tooltip.setTooltip(o,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,UM(e,{enable:!0,copyState:!0})),this.tooltip=new Gge(this.canvas),rc(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new GU;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new Pye(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in U8)this.eventManager.on(i,this._onEvent);this.viewManager=new vge({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new yge(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new $ge,this.deckRenderer=new Dge(e),this.deckPicker=new Vge(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;rc(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Nn.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=_d.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}K(ox,"defaultProps",mV);K(ox,"VERSION",Lce);class Q2{constructor(e,n){K(this,"opts",void 0),K(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let s=r;if(r&&r.length!==i){s=new Float32Array(i);const l=n.elementOffset||0;for(let o=0;o<i;++o)s[o]=r[l+o]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function Lye(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function B_(t){return t.stride||t.size*t.bytesPerElement}function gV(t,e){e.offset&&Nn.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=B_(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function Iye(t,e){const n=gV(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class Rye{constructor(e,n,r){K(this,"gl",void 0),K(this,"id",void 0),K(this,"size",void 0),K(this,"settings",void 0),K(this,"value",void 0),K(this,"doublePrecision",void 0),K(this,"_buffer",void 0),K(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i===5130;let{defaultValue:l}=n;l=Number.isFinite(l)?[l]:l||new Array(this.size).fill(0);let o;s?o=5126:!i&&n.isIndexed?o=e&&ede(e,Mr.ELEMENT_INDEX_UINT32)?5125:5123:o=i||5126;let h=Lye(i||o||5126);this.doublePrecision=s,s&&n.fp64===!1&&(h=Float32Array),this.value=null,this.settings={...n,defaultType:h,defaultValue:l,logicalType:i,type:o,size:this.size,bytesPerElement:h.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new fr(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*B_(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),lp.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,s=Iye(this.getAccessor(),n||{});return r[e]=new Q2(this,s.high),r["".concat(e,"64Low")]=i?new Q2(this,s.low):new Float32Array(this.size),r}if(n){const r=gV(this.getAccessor(),n);return{[e]:new Q2(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const l=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let h=0;h<s;)for(let p=0;p<i;p++){const b=n[h++];b<l[p]&&(l[p]=b),b>o[p]&&(o[p]=b)}e=[l,o]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof fr?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null;const l=r.value instanceof Float64Array;i.type=r.type||s.accessor.type,i.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(l?2:1),i.stride=B_(i)}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s,i.bytesPerElement=s.BYTES_PER_ELEMENT,i.stride=B_(i);const{buffer:l,byteOffset:o}=this;this.doublePrecision&&s instanceof Float64Array&&(s=X2(s,i));const h=s.byteLength+o+i.stride*2;l.byteLength<h&&l.reallocate(h),l.setAccessor(null),l.subData({data:s,offset:o}),i.type=r.type||l.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?X2(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=lp.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:l,byteOffset:o}=this;return l.byteLength<s.byteLength+o&&(l.reallocate(s.byteLength+o),n&&i&&l.subData({data:i instanceof Float64Array?X2(i,this):i,offset:o})),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&Nn.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let l=s;for(;--l>=0;)n[r+l]=i[l];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let l=s;for(;--l>=0;)n[r+l]=Number.isFinite(e[l])?e[l]:i[l]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const rD=[],iD=[];function ax(t,e=0,n=1/0){let r=rD;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(iD.length=t.length,r=iD):r=rD,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function yV(t){return t&&t[Symbol.asyncIterator]}function vV(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:l}=e,o=t.BYTES_PER_ELEMENT,h=r?r/o:n,p=i?i/o:0,b=Math.floor((t.length-p)/h);return(x,{index:w,target:A})=>{if(!s){const D=w*h+p;for(let $=0;$<n;$++)A[$]=t[D+$];return A}const L=s[w],M=s[w+1]||b;let U;if(l){U=new Array(M-L);for(let D=L;D<M;D++){const $=D*h+p;A=new Array(n);for(let N=0;N<n;N++)A[N]=t[$+N];U[D-L]=A}}else if(h===n)U=t.subarray(L*n+p,M*n+p);else{U=new t.constructor((M-L)*n);let D=0;for(let $=L;$<M;$++){const N=$*h+p;for(let B=0;B<n;B++)U[D++]=t[N+B]}}return U}}const Mye=[],U_=[[0,1/0]];function $ye(t,e){if(t===U_||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const l=t[s];l[1]<e[0]?(n.push(l),i=s+1):l[0]>e[1]?n.push(l):e=[Math.min(l[0],e[0]),Math.max(l[1],e[1])]}return n.splice(i,0,e),n}function eT(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,l=t.end||n.length,o=e.length,h=l-r;if(o>h){n.set(e.subarray(0,h),r);return}if(n.set(e,r),!s)return;let p=o;for(;p<h;){const b=s(p,e);for(let x=0;x<i;x++)n[r+p]=b[x]||0,p++}}function kye({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!Array.isArray(s))return eT({source:t,target:e,size:n,getData:r}),e;let l=0,o=0;const h=r&&((b,x)=>r(b+o,x)),p=Math.min(i.length,s.length);for(let b=1;b<p;b++){const x=i[b]*n,w=s[b]*n;eT({source:t.subarray(l,x),target:e,start:o,end:w,size:n,getData:h}),l=x,o=w}return o<e.length&&eT({source:[],target:e,start:o,size:n,getData:h}),e}const Oye={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function _V(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...Oye[n],...e,...t,type:n}}function bV(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function xV(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function wV(t){t.push(t.shift())}function r$(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,l=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*s)*l}function TV({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:s=l=>l}){const l=n.doublePrecision&&n.value instanceof Float64Array?2:1,o=n.size*l,h=n.byteOffset,p=n.startIndices,b=i&&p,x=r$(n,e),w=n.isConstant;if(!b&&r>=x)return;const A=w?n.value:n.getBuffer().getData({srcByteOffset:h});if(n.settings.normalized&&!w){const D=s;s=($,N)=>n.normalizeConstant(D($,N))}const L=w?(D,$)=>s(A,$):(D,$)=>s(A.subarray(D,D+o),$),M=t.getData({length:r}),U=new Float32Array(x);kye({source:M,target:U,sourceStartIndices:i,targetStartIndices:p,size:o,getData:L}),t.byteLength<U.byteLength+h&&t.reallocate(U.byteLength+h),t.subData({data:U,offset:h})}class i$ extends Rye{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:U_}),K(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return _V(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=$ye(this.state.updateRanges,[r,i])}else this.state.updateRanges=U_}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Mye}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==U_),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:l,noAlloc:o}}=this;let h=!0;if(l){for(const[p,b]of s)l.call(i,this,{data:n,startRow:p,endRow:b,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[p,b]of s){const x=Number.isFinite(p)?this.getVertexOffset(p):0,w=Number.isFinite(b)?this.getVertexOffset(b):o||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:x,endOffset:w})}this._checkAttributeArray()}else h=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),h}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const l=e;Vi(ArrayBuffer.isView(l.value),"invalid ".concat(i.accessor));const o=!!l.size&&l.size!==this.size;return r.binaryAccessor=vV(l.value,{size:l.size||this.size,stride:l.stride,offset:l.offset,startIndices:n,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:l}){if(e.constant)return;const{settings:o,state:h,value:p,size:b,startIndices:x}=e,{accessor:w,transform:A}=o,L=h.binaryAccessor||(typeof w=="function"?w:s[w]);Vi(typeof L=="function",'accessor "'.concat(w,'" is not a function'));let M=e.getVertexOffset(r);const{iterable:U,objectInfo:D}=ax(n,r,i);for(const $ of U){D.index++;let N=L($,D);if(A&&(N=A.call(this,N)),x){const B=(D.index<x.length-1?x[D.index+1]:l)-x[D.index];if(N&&Array.isArray(N[0])){let Z=M;for(const ie of N)e._normalizeValue(ie,p,Z),Z+=b}else N&&N.length>b?p.set(N,M):(e._normalizeValue(N,D.target,0),lge({target:p,source:D.target,start:M,count:B}));M+=B*b}else e._normalizeValue(N,p,M),M+=b}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class Dye{constructor({gl:e,attribute:n,timeline:r}){K(this,"gl",void 0),K(this,"type","interpolation"),K(this,"attributeInTransition",void 0),K(this,"settings",void 0),K(this,"attribute",void 0),K(this,"transition",void 0),K(this,"currentStartIndices",void 0),K(this,"currentLength",void 0),K(this,"transform",void 0),K(this,"buffers",void 0),this.gl=e,this.transition=new t0(r),this.attribute=n,this.attributeInTransition=new i$(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=Nye(e,n);const i={byteLength:0,usage:35050};this.buffers=[new fr(e,i),new fr(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:s}=this;wV(i);const l={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)TV({buffer:o,...l});this.currentStartIndices=s.startIndices,this.currentLength=r$(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:i[0],aTo:bV(r,s)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let s=i/n;r&&(s=r(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const Fye=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function Nye(t,e){const n=xV(e.size);return new ZM(t,{vs:Fye,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class zye{constructor({gl:e,attribute:n,timeline:r}){K(this,"gl",void 0),K(this,"type","spring"),K(this,"attributeInTransition",void 0),K(this,"settings",void 0),K(this,"attribute",void 0),K(this,"transition",void 0),K(this,"currentStartIndices",void 0),K(this,"currentLength",void 0),K(this,"texture",void 0),K(this,"framebuffer",void 0),K(this,"transform",void 0),K(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new t0(r),this.attribute=n,this.attributeInTransition=new i$(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=Uye(e),this.framebuffer=Vye(e,this.texture),this.transform=Bye(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new fr(e,i),new fr(e,i),new fr(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:s}=this,l={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const o of i)TV({buffer:o,...l});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=r$(s,n),this.attributeInTransition.setData({buffer:i[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:bV(r,s)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const l=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:l.stiffness,damping:l.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),wV(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),ix(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function Bye(t,e,n){const r=xV(e.size);return new ZM(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function Uye(t){return new Io(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function Vye(t,e){return new ns(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{[36064]:e}})}const jye={interpolation:Dye,spring:zye};class Gye{constructor(e,{id:n,timeline:r}){K(this,"id",void 0),K(this,"isSupported",void 0),K(this,"gl",void 0),K(this,"timeline",void 0),K(this,"transitions",void 0),K(this,"needsRedraw",void 0),K(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=ZM.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],l=s.getTransitionSetting(n);l&&this._updateAttribute(i,s,l)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){if(!this.isSupported){Nn.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const l=jye[r.type];l?this.transitions[e]=new l({attribute:n,timeline:this.timeline,gl:this.gl}):(Nn.error("unsupported transition type '".concat(r.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const sD="attributeManager.invalidate",Wye="attributeManager.updateStart",Hye="attributeManager.updateEnd",qye="attribute.updateStart",Kye="attribute.allocate",Xye="attribute.updateEnd";class Zye{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){K(this,"id",void 0),K(this,"gl",void 0),K(this,"attributes",void 0),K(this,"updateTriggers",void 0),K(this,"needsRedraw",void 0),K(this,"userData",void 0),K(this,"stats",void 0),K(this,"attributeTransitionManager",void 0),K(this,"mergeBoundsMemoized",Jy(Qme)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new Gye(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);gs(sD,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);gs(sD,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:l={},context:o={}}){let h=!1;gs(Wye,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const p in this.attributes){const b=this.attributes[p],x=b.settings.accessor;b.startIndices=r,b.numInstances=n,s[p]&&Nn.removed("props.".concat(p),"data.attributes.".concat(p))(),b.setExternalBuffer(l[p])||b.setBinaryValue(typeof x=="string"?l[x]:void 0,e.startIndices)||typeof x=="string"&&!l[x]&&b.setConstantValue(s[x])||b.needsUpdate()&&(h=!0,this._updateAttribute({attribute:b,numInstances:n,data:e,props:s,context:o})),this.needsRedraw=this.needsRedraw||b.needsRedraw()}h&&gs(Hye,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const l=n[s];l.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=l)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new i$(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(l=>{const o=r[l];o&&o.setNeedsUpdate(o.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(gs(qye,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&gs(Kye,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,gs(Xye,n,r))}}class Yye extends t0{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,l=s(e/i);this._value=cy(n,r,l)}}const oD=1e-5;function aD(t,e,n,r,i){const s=e-t,o=(n-e)*i,h=-s*r;return o+h+s+e}function Jye(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let l=0;l<n.length;l++)s[l]=aD(t[l],e[l],n[l],r,i);return s}return aD(t,e,n,r,i)}function lD(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class Qye extends t0{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:l=e}=this;let o=Jye(s,l,n,r,i);const h=lD(o,n),p=lD(o,l);h<oD&&p<oD&&(o=n,this.end()),this._prevValue=l,this._currValue=o}}const e0e={interpolation:Yye,spring:Qye};class t0e{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const h=s.get(e),{value:p=h.settings.fromValue}=h;n=p,this.remove(e)}if(i=_V(i),!i)return;const l=e0e[i.type];if(!l){Nn.error("unsupported transition type '".concat(i.type,"'"))();return}const o=new l(this.timeline);o.start({...i,fromValue:n,toValue:r}),s.set(e,o)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function n0e(t){const e=t[uu];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function r0e(t,e){const n=EV({newProps:t,oldProps:e,propTypes:t[uu],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=s0e(t,e);let i=!1;return r||(i=o0e(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:a0e(t,e),transitionsChanged:i0e(t,e)}}function i0e(t,e){if(!t.transitions)return!1;const n={},r=t[uu];let i=!1;for(const s in t.transitions){const l=r[s],o=l&&l.type;(o==="number"||o==="color"||o==="array")&&MS(t[s],e[s],l)&&(n[s]=!0,i=!0)}return i?n:!1}function EV({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(i,".").concat(s," added");const l=MS(t[s],e[s],r[s]);if(l)return"".concat(i,".").concat(s," ").concat(l)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(i,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const l=MS(t[s],e[s],r[s]);if(l)return"".concat(i,".").concat(s," ").concat(l)}}return!1}function MS(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function s0e(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function o0e(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&cD(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&cD(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function a0e(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function cD(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},EV({oldProps:i,newProps:r,triggerName:n})}const l0e="count(): argument not an object",c0e="count(): argument not a container";function u0e(t){if(!h0e(t))throw new Error(l0e);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(d0e(t))return Object.keys(t).length;throw new Error(c0e)}function d0e(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function h0e(t){return t!==null&&typeof t=="object"}function f0e(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const p0e={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071},$S={};function m0e(t,e,n,r){if(n instanceof Io)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={[10241]:n.data.length>1?9985:9729});const s=new Io(e,{...n,parameters:{...p0e,...i,...r}});return $S[s.id]=t,s}function g0e(t,e){!e||!(e instanceof Io)||$S[e.id]===t&&(e.delete(),delete $S[e.id])}const y0e={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||kS(t)&&(t.length===3||t.length===4)},equal(t,e,n){return il(t,e,1)}},accessor:{validate(t,e){const n=Fb(t);return n==="function"||n===Fb(e.value)},equal(t,e,n){return typeof e=="function"?!0:il(t,e,1)}},array:{validate(t,e){return e.optional&&!t||kS(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?il(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?il(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:m0e(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{g0e(n.id,t)}}};function v0e(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const l=s==null?void 0:s.deprecatedFor;if(l)r[i]=Array.isArray(l)?l:[l];else{const o=_0e(i,s);e[i]=o,n[i]=o.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function _0e(t,e){switch(Fb(e)){case"object":return Wm(t,e);case"array":return Wm(t,{type:"array",value:e,compare:!1});case"boolean":return Wm(t,{type:"boolean",value:e});case"number":return Wm(t,{type:"number",value:e});case"function":return Wm(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Wm(t,e){return"type"in e?{name:t,...y0e[e.type],...e}:"value"in e?{name:t,type:Fb(e.value),...e}:{name:t,type:"object",value:e}}function kS(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Fb(t){return kS(t)?"array":t===null?"null":typeof t}function b0e(t,e){let n;for(let s=e.length-1;s>=0;s--){const l=e[s];"extensions"in l&&(n=l.extensions)}const r=OS(t.constructor,n),i=Object.create(r);i[Ob]=t,i[zd]={},i[Qc]={};for(let s=0;s<e.length;++s){const l=e[s];for(const o in l)i[o]=l[o]}return Object.freeze(i),i}const x0e="_mergedDefaultProps";function OS(t,e){let n=x0e;if(e)for(const i of e){const s=i.constructor;s&&(n+=":".concat(s.extensionName||s.name))}const r=SV(t,n);return r||(t[n]=w0e(t,e||[]))}function w0e(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=OS(r),s=SV(t,"defaultProps")||{},l=v0e(s),o=Object.assign(Object.create(null),i,l.defaultProps),h=Object.assign(Object.create(null),i==null?void 0:i[uu],l.propTypes),p=Object.assign(Object.create(null),i==null?void 0:i[Y2],l.deprecatedProps);for(const b of e){const x=OS(b.constructor);x&&(Object.assign(o,x),Object.assign(h,x[uu]),Object.assign(p,x[Y2]))}return T0e(o,t),S0e(o,h),E0e(o,p),o[uu]=h,o[Y2]=p,e.length===0&&!s$(t,"_propTypes")&&(t._propTypes=h),o}function T0e(t,e){const n=P0e(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function E0e(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const s of e[n])s$(this,s)||(this[s]=r);Nn.deprecated(i,e[n].join("/"))()}})}function S0e(t,e){const n={},r={};for(const i in e){const s=e[i],{name:l,value:o}=s;s.async&&(n[l]=o,r[l]=A0e(l))}t[Mf]=n,t[zd]={},Object.defineProperties(t,r)}function A0e(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||yV(e)?this[zd][t]=e:this[Qc][t]=e},get(){if(this[Qc]){if(t in this[Qc])return this[Qc][t]||this[Mf][t];if(t in this[zd]){const e=this[Ob]&&this[Ob].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Mf][t]}}return this[Mf][t]}}}function s$(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function SV(t,e){return s$(t,e)&&t[e]}function P0e(t){const e=t.componentName;return e||Nn.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let C0e=0;class o${constructor(...e){K(this,"id",void 0),K(this,"props",void 0),K(this,"count",void 0),this.props=b0e(this,e),this.id=this.props.id,this.count=C0e++}clone(e){const{props:n}=this,r={};for(const i in n[Mf])i in n[Qc]?r[i]=n[Qc][i]:i in n[zd]&&(r[i]=n[zd][i]);return new this.constructor({...n,...r,...e})}}K(o$,"componentName","Component");K(o$,"defaultProps",{});const L0e=Object.freeze({});class I0e{constructor(e){K(this,"component",void 0),K(this,"onAsyncPropUpdated",void 0),K(this,"asyncProps",void 0),K(this,"oldProps",void 0),K(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||L0e}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[Ob]||this.component;const n=e[Qc]||{},r=e[zd]||e,i=e[Mf]||{};for(const s in n){const l=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,l),n[s]=this.getAsyncProp(s)}for(const s in r){const l=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,l)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(yV(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],l=0;for await(const o of n){if(!this.component)return;const{dataTransform:h}=this.component.props;h?s=h(o,s):s=s.concat(o),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:l,endRow:s.length}]}),l=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[uu];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class R0e extends I0e{constructor({attributeManager:e,layer:n}){super(n),K(this,"attributeManager",void 0),K(this,"needsRedraw",void 0),K(this,"needsUpdate",void 0),K(this,"subLayers",void 0),K(this,"usesPickingColorCache",void 0),K(this,"hasPickingBuffer",void 0),K(this,"changeFlags",void 0),K(this,"viewport",void 0),K(this,"uniformTransitions",void 0),K(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const M0e="layer.changeFlag",$0e="layer.initialize",k0e="layer.update",O0e="layer.finalize",D0e="layer.matched",uD=2**24-1,F0e=Object.freeze([]),N0e=Jy(({oldViewport:t,viewport:e})=>t.equals(e));let qa=new Uint8ClampedArray(0);const z0e={data:{type:"data",value:F0e,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:l}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,s){var o;i={...i,fetch:{...(o=i)===null||o===void 0?void 0:o.fetch,signal:s}}}let h=l.contains(t);return!h&&!i&&(l.add({resourceId:t,data:Cb(t,r),persistent:!1}),h=!0),h?l.subscribe({resourceId:t,onChange:p=>{var b;return(b=n.internalState)===null||b===void 0?void 0:b.reloadAsyncProp(e,p)},consumerId:n.id,requestId:e}):Cb(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Qn.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class uc extends o${constructor(...e){super(...e),K(this,"internalState",null),K(this,"lifecycle",Jh.NO_STATE),K(this,"context",void 0),K(this,"state",void 0),K(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){Vi(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=sV(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,l]=eV(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,l]}unproject(e){return Vi(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Vi(this.internalState);const r=this.internalState.viewport||this.context.viewport;return sge(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Qn.DEFAULT||e===Qn.LNGLAT||e===Qn.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Vi(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:u0e(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=f0e(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,l=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(o=>o.getNeedsPickingBuffer.call(this,o));if(s!==l){this.internalState.hasPickingBuffer=l;const{pickingColors:o,instancePickingColors:h}=n.attributes,p=o||h;p&&(l&&p.constant&&(p.constant=!1,n.invalidate(p.id)),!p.value&&!l&&(p.constant=!0,p.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e.message="".concat(n,": ").concat(e.message)),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var s,l;(s=this.context)===null||s===void 0||(l=s.onError)===null||l===void 0||l.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!N0e({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(qa.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>uD&&Nn.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),qa=lp.allocate(qa,n,{size:3,copy:!0,maxCount:Math.max(n,uD)});const i=Math.floor(qa.length/3),s=[];for(let l=r;l<i;l++)this.encodePickingColor(l,s),qa[l*3+0]=s[0],qa[l*3+1]=s[1],qa[l*3+2]=s[2]}e.value=qa.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},s=r.getShaderAttributes(n,i);e.setAttributes(s)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,l=s&&n.attributes&&n.attributes[s.id];if(l&&l.value){const o=l.value,h=this.encodePickingColor(e);for(let p=0;p<n.length;p++){const b=s.getVertexOffset(p);o[b]===h[0]&&o[b+1]===h[1]&&o[b+2]===h[2]&&this._disablePickingIndex(p)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),l=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(l-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==qa.buffer&&(r.value=qa.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Vi(!this.internalState),Vi(Number.isFinite(this.props.coordinateSystem)),gs($0e,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new R0e({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Nn.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new t0e(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){gs(D0e,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(gs(k0e,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,l=this._updateUniformTransition();i.propsInTransition=l,r.viewport=i.viewport||s,this.props=l;try{const o=this._getUpdateParams(),h=this.getModels();if(r.gl)this.updateState(o);else try{this.updateState(o)}catch{}for(const b of this.props.extensions)b.updateState.call(this,o,b);const p=this.getModels()[0]!==h[0];this._postUpdate(o,p)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){gs(O0e,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,s=this.context;this.props=this.internalState.propsInTransition||i;const l=this.props.opacity;n.opacity=Math.pow(l,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:o}=this.props,h=o&&o(n)||[0,0];rc(s.gl,{polygonOffset:h}),Aa(s.gl,r,()=>{const p={moduleParameters:e,uniforms:n,parameters:r,context:s};for(const b of this.props.extensions)b.draw.call(this,p,b);this.draw(p)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const l=e[i],o=n[i];l&&Array.isArray(o)&&(n.dataChanged=Array.isArray(l)?o.concat(l):l,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&gs(M0e,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=r0e(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)===null||i===void 0?void 0:i[s])}return this.setChangeFlags(r)}validateProps(){n0e(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Zye(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:l,highlightedObjectIndex:o,highlightColor:h}=r;if(n||i.autoHighlight!==l||i.highlightedObjectIndex!==o||i.highlightColor!==h){const p={};l||(p.pickingSelectedColor=null),Array.isArray(h)&&(p.pickingHighlightColor=h),(n||o!==i.highlightedObjectIndex)&&(p.pickingSelectedColor=Number.isFinite(o)&&o>=0?this.encodePickingColor(o):null),this.setModuleParameters(p)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}K(uc,"defaultProps",z0e);K(uc,"layerName","Layer");const B0e="compositeLayer.renderLayers";class a$ extends uc{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:s,parameters:l,getPolygonOffset:o,highlightedObjectIndex:h,autoHighlight:p,highlightColor:b,coordinateSystem:x,coordinateOrigin:w,wrapLongitude:A,positionFormat:L,modelMatrix:M,extensions:U,fetch:D,operation:$,_subLayerProps:N}=this.props,B={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:l,getPolygonOffset:o,highlightedObjectIndex:h,autoHighlight:p,highlightColor:b,coordinateSystem:x,coordinateOrigin:w,wrapLongitude:A,positionFormat:L,modelMatrix:M,extensions:U,fetch:D,operation:$},Z=N&&e.id&&N[e.id],ie=Z&&Z.updateTriggers,re=e.id||"sublayer";if(Z){const ve=this.props[uu],Te=e.type?e.type._propTypes:{};for(const Ae in Z){const fe=Te[Ae]||ve[Ae];fe&&fe.type==="accessor"&&(Z[Ae]=this.getSubLayerAccessor(Z[Ae]))}}Object.assign(B,e,Z),B.id="".concat(this.props.id,"-").concat(re),B.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...ie};for(const ve of U){const Te=ve.getSubLayerProps.call(this,ve);Te&&Object.assign(B,Te,{updateTriggers:Object.assign(B.updateTriggers,Te.updateTriggers)})}return B}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=t$(s,Boolean),this.internalState.subLayers=r}gs(B0e,this,i,r);for(const s of r)s.parent=this}}K(a$,"layerName","CompositeLayer");const U0e=["bearing","pitch"],V0e={speed:1.2,curve:1.414};class j0e extends lV{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}),K(this,"opts",void 0),this.opts={...V0e,...e}}interpolateProps(e,n,r){const i=Ome(e,n,r,this.opts);for(const s of U0e)i[s]=cy(e[s]||0,n[s]||0,r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=Dme(e,n,this.opts)),r}}class AV{constructor(e){K(this,"opts",void 0),K(this,"typedArrayManager",void 0),K(this,"indexStarts",[0]),K(this,"vertexStarts",[0]),K(this,"vertexCount",0),K(this,"instanceCount",0),K(this,"attributes",void 0),K(this,"_attributeDefs",void 0),K(this,"data",void 0),K(this,"getGeometry",void 0),K(this,"geometryBuffer",void 0),K(this,"buffers",void 0),K(this,"positionSize",void 0),K(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=lp,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:l,dataChanged:o,normalize:h=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(l==="XY"?2:3),this.buffers=r,this.normalize=h,s&&(Vi(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),h||(r.positions=s)),this.geometryBuffer=r.positions,Array.isArray(o))for(const p of o)this._rebuildGeometry(p);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?vV(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:l}=this;for(const o in s)if(o in i)l.release(r[o]),r[o]=null;else{const h=s[o];h.copy=n,r[o]=l.allocate(r[o],e,h)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:l,objectInfo:o}=ax(i,n,r);for(const h of l){o.index++;const p=s?s(h,o):null;e(p,o.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:l}=this,{startRow:o=0,endRow:h=1/0}=e||{},p={};if(e||(n=[0],r=[0]),this.normalize||!l)this._forEachGeometry((x,w)=>{const A=x&&this.normalizeGeometry(x);p[w]=A,r[w+1]=r[w]+(A?this.getGeometrySize(A):0)},o,h),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(l))i=i||l.length/this.positionSize;else if(l instanceof fr){const x=l.accessor.stride||this.positionSize*4;i=i||l.byteLength/x}else if(l.buffer){const x=l.stride||this.positionSize*4;i=i||l.buffer.byteLength/x}else if(l.value){const x=l.value,w=l.stride/x.BYTES_PER_ELEMENT||this.positionSize;i=i||x.length/w}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const b={};this._forEachGeometry((x,w)=>{const A=p[w]||x;b.vertexStart=r[w],b.indexStart=n[w];const L=w<r.length-1?r[w+1]:i;b.geometrySize=L-r[w],b.geometryIndex=w,this.updateGeometryAttributes(A,b)},o,h),this.vertexCount=n[n.length-1]}}const G0e=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,W0e=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,H0e=1024,q0e=4,dD=()=>{},hD={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071};function K0e(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function X0e(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),l=Math.floor(e.height*i);return i===1?{data:e,width:s,height:l}:(t.canvas.height=l,t.canvas.width=s,t.clearRect(0,0,s,l),t.drawImage(e,0,0,e.width,e.height,0,0,s,l),{data:t.canvas,width:s,height:l})}function dy(t){return t&&(t.id||t.url)}function Z0e(t,e,n,r){const i=t.width,s=t.height,l=new Io(t.gl,{width:e,height:n,parameters:r});return Zue(t,l,{targetY:0,width:i,height:s}),t.delete(),l}function fD(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],l=dy(i);t[l]={...i,x:s,y:n}}}function Y0e({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:l}){let o=[];for(let h=0;h<t.length;h++){const p=t[h],b=dy(p);if(!n[b]){const{height:x,width:w}=p;r+w+e>l&&(fD(n,o,i),r=0,i=s+i+e,s=0,o=[]),o.push({icon:p,xOffset:r}),r=r+w+e,s=Math.max(s,x)}}return o.length>0&&fD(n,o,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:l,canvasHeight:K0e(s+i+e)}}function J0e(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=ax(t);for(const l of i){s.index++;const o=e(l,s),h=dy(o);if(!o)throw new Error("Icon is missing.");if(!o.url)throw new Error("Icon url is missing.");!r[h]&&(!n[h]||o.url!==n[h].url)&&(r[h]={...o,source:l,sourceIndex:s.index})}return r}class Q0e{constructor(e,{onUpdate:n=dD,onError:r=dD}){K(this,"gl",void 0),K(this,"onUpdate",void 0),K(this,"onError",void 0),K(this,"_loadOptions",null),K(this,"_texture",null),K(this,"_externalTexture",null),K(this,"_mapping",{}),K(this,"_textureParameters",null),K(this,"_pendingCount",0),K(this,"_autoPacking",!1),K(this,"_xOffset",0),K(this,"_yOffset",0),K(this,"_rowHeight",0),K(this,"_buffer",q0e),K(this,"_canvasWidth",H0e),K(this,"_canvasHeight",0),K(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?dy(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var l;(l=this._texture)===null||l===void 0||l.delete(),this._texture=null,this._externalTexture=r}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(J0e(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:l,rowHeight:o,canvasHeight:h}=Y0e({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=o,this._mapping=i,this._xOffset=s,this._yOffset=l,this._canvasHeight=h,this._texture||(this._texture=new Io(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||hD})),this._texture.height!==this._canvasHeight&&(this._texture=Z0e(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||hD)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,Cb(r.url,this._loadOptions).then(i=>{const s=dy(r),l=this._mapping[s],{x:o,y:h,width:p,height:b}=l,{data:x,width:w,height:A}=X0e(n,i,p,b);this._texture.setSubImageData({data:x,x:o+(p-w)/2,y:h+(b-A)/2,width:w,height:A}),l.width=w,l.height=A,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const PV=[0,0,0,255],eve={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:PV},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class lx extends uc{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(){return super.getShaders({vs:G0e,fs:W0e,modules:[Qy,e0]})}initializeState(){this.state={iconManager:new Q0e(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:PV},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:l,iconMapping:o,data:h,getIcon:p,textureParameters:b}=n,{iconManager:x}=this.state,w=l||this.internalState.isAsyncPropLoading("iconAtlas");if(x.setProps({loadOptions:n.loadOptions,autoPacking:!w,iconAtlas:l,iconMapping:w?o:null,textureParameters:b}),w?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&x.packIcons(h,p),i.extensionsChanged){var A;const{gl:L}=this.context;(A=this.state.model)===null||A===void 0||A.delete(),this.state.model=this._getModel(L),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:l,alphaCutoff:o}=this.props,{iconManager:h}=this.state,p=h.getTexture();p&&this.state.model.setUniforms(e).setUniforms({iconsTexture:p,iconsTextureDim:[p.width,p.height],sizeUnits:kd[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:l,alphaCutoff:o}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Dd(e,{...this.getShaders(),id:this.props.id,geometry:new Yy({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):Nn.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}}K(lx,"defaultProps",eve);K(lx,"layerName","IconLayer");const tve=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,nve=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (filled) {
    gl_FragColor = vFillColor;
  } else {
    discard;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,pD=[0,0,0,255],rve={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:pD},getLineColor:{type:"accessor",value:pD},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class l$ extends uc{getShaders(){return super.getShaders({vs:tve,fs:nve,modules:[Qy,e0]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:l,filled:o,billboard:h,antialiasing:p,lineWidthUnits:b,lineWidthScale:x,lineWidthMinPixels:w,lineWidthMaxPixels:A}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:l?1:0,filled:o,billboard:h,antialiasing:p,radiusUnits:kd[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:kd[b],lineWidthScale:x,lineWidthMinPixels:w,lineWidthMaxPixels:A}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Dd(e,{...this.getShaders(),id:this.props.id,geometry:new Yy({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}K(l$,"defaultProps",rve);K(l$,"layerName","ScatterplotLayer");const CV={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function LV(t,e,n={}){return ive(t,n)!==e?(ove(t,n),!0):!1}function ive(t,e={}){return Math.sign(sve(t,e))}function sve(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let s=0;for(let l=n,o=r-i;l<r;l+=i)s+=(t[l]-t[o])*(t[l+1]+t[o+1]),o=l;return s/2}function ove(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,l=Math.floor(s/2);for(let o=0;o<l;++o){const h=n+o*i,p=n+(s-1-o)*i;for(let b=0;b<i;++b){const x=t[h+b];t[h+b]=t[p+b],t[p+b]=x}}}function xa(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function DS(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function hy(t,e,n,r,i=[]){const s=r+e*n;for(let l=0;l<n;l++)i[l]=t[s+l];return i}function FS(t,e,n,r,i=[]){let s,l;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),l=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),l=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),l=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),l=0;else return null;for(let o=0;o<t.length;o++)i[o]=(l&1)===o?r[l]:s*(e[o]-t[o])+t[o];return i}function V_(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function IV(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:l=0,endIndex:o=t.length}=e||{},h=(o-l)/n;let p=[];const b=[p],x=hy(t,0,n,l);let w,A;const L=MV(x,i,s,[]),M=[];xa(p,x);for(let U=1;U<h;U++){for(w=hy(t,U,n,l,w),A=V_(w,L);A;){FS(x,w,A,L,M);const D=V_(M,L);D&&(FS(x,M,D,L,M),A=D),xa(p,M),DS(x,M),lve(L,i,A),r&&p.length>n&&(p=[],b.push(p),xa(p,x)),A=V_(w,L)}xa(p,w),DS(x,w)}return r?b:b[0]}const mD=0,ave=1;function jv(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function RV(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:l=!1}=n||{},o=[],h=[{pos:t,types:l?new Array(t.length/r).fill(ave):null,holes:e||[]}],p=[[],[]];let b=[];for(;h.length;){const{pos:x,types:w,holes:A}=h.shift();cve(x,r,A[0]||x.length,p),b=MV(p[0],i,s,b);const L=V_(p[1],b);if(L){let M=gD(x,w,r,0,A[0]||x.length,b,L);const U={pos:M[0].pos,types:M[0].types,holes:[]},D={pos:M[1].pos,types:M[1].types,holes:[]};h.push(U,D);for(let $=0;$<A.length;$++)M=gD(x,w,r,A[$],A[$+1]||x.length,b,L),M[0]&&(U.holes.push(U.pos.length),U.pos=jv(U.pos,M[0].pos),l&&(U.types=jv(U.types,M[0].types))),M[1]&&(D.holes.push(D.pos.length),D.pos=jv(D.pos,M[1].pos),l&&(D.types=jv(D.types,M[1].types)))}else{const M={positions:x};l&&(M.edgeTypes=w),A.length&&(M.holeIndices=A),o.push(M)}}return o}function gD(t,e,n,r,i,s,l){const o=(i-r)/n,h=[],p=[],b=[],x=[],w=[];let A,L,M;const U=hy(t,o-1,n,r);let D=Math.sign(l&8?U[1]-s[3]:U[0]-s[2]),$=e&&e[o-1],N=0,B=0;for(let Z=0;Z<o;Z++)A=hy(t,Z,n,r,A),L=Math.sign(l&8?A[1]-s[3]:A[0]-s[2]),M=e&&e[r/n+Z],L&&D&&D!==L&&(FS(U,A,l,s,w),xa(h,w)&&b.push($),xa(p,w)&&x.push($)),L<=0?(xa(h,A)&&b.push(M),N-=L):b.length&&(b[b.length-1]=mD),L>=0?(xa(p,A)&&x.push(M),B+=L):x.length&&(x[x.length-1]=mD),DS(U,A),D=L,$=M;return[N?{pos:h,types:e&&b}:null,B?{pos:p,types:e&&x}:null]}function MV(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function lve(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function cve(t,e,n,r){let i=1/0,s=-1/0,l=1/0,o=-1/0;for(let h=0;h<n;h+=e){const p=t[h],b=t[h+1];i=p<i?p:i,s=p>s?p:s,l=b<l?b:l,o=b>o?b:o}return r[0][0]=i,r[0][1]=l,r[1][0]=s,r[1][1]=o,r}const uve=85.051129;function dve(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},l=t.slice(r,i);$V(l,n,0,i-r);const o=IV(l,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const h of o)kV(h,n);return o}function hve(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const l=[],o=[];let h=0,p=0;for(let x=0;x<=e.length;x++){const w=e[x]||t.length,A=p,L=fve(t,r,h,w);for(let M=L;M<w;M++)l[p++]=t[M];for(let M=h;M<L;M++)l[p++]=t[M];$V(l,r,A,p),pve(l,r,A,p,n==null?void 0:n.maxLatitude),h=w,o[x]=p}o.pop();const b=RV(l,o,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const x of b)kV(x.positions,r);return b}function fve(t,e,n,r){let i=-1,s=-1;for(let l=n+1;l<r;l+=e){const o=Math.abs(t[l]);o>i&&(i=o,s=l-1)}return s}function pve(t,e,n,r,i=uve){const s=t[n],l=t[r-e];if(Math.abs(s-l)>180){const o=hy(t,0,e,n);o[0]+=Math.round((l-s)/360)*360,xa(t,o),o[1]=Math.sign(o[1])*i,xa(t,o),o[0]=s,xa(t,o)}}function $V(t,e,n,r){let i=t[0],s;for(let l=n;l<r;l+=e){s=t[l];const o=s-i;(o>180||o<-180)&&(s-=Math.round(o/360)*360),t[l]=i=s}}function kV(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function mve(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let l=0;l<t.length;l++)for(let o=0;o<e;o++)i[l*e+o]=t[l][o]||0}else i=t;return n?IV(i,{size:e,gridResolution:n}):r?dve(i,{size:e}):i}const gve=1,yve=2,tT=4;class vve extends AV{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?mve(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(yD(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&yD(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:l}=n;r.fill(0,s,s+l),i?(r[s]=tT,r[s+l-2]=tT):(r[s]+=gve,r[s+l-2]+=yve),r[s+l-1]=tT}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,l=new Array(3);for(let o=i,h=0;h<s;o++,h++)this.getPointOnPath(e,h,l),r[o*3]=l[0],r[o*3+1]=l[1],r[o*3+2]=l[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function yD(t){return Array.isArray(t[0])}const _ve=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,bve=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,OV=[0,0,0,255],xve={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:OV},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},nT={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class c$ extends uc{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(){return super.getShaders({vs:_ve,fs:bve,modules:[Qy,e0]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:nT,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:nT,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:nT,defaultValue:OV},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new vve({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:o}=this.state,h=n.data.attributes||{};o.updateGeometry({data:n.data,geometryBuffer:h.getPath,buffers:h,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var l;const{gl:o}=this.context;(l=this.state.model)===null||l===void 0||l.delete(),this.state.model=this._getModel(o),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:l,widthScale:o,widthMinPixels:h,widthMaxPixels:p}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:kd[l],widthScale:o,miterLimit:s,widthMinPixels:h,widthMaxPixels:p}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Dd(e,{...this.getShaders(),id:this.props.id,geometry:new Yy({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}K(c$,"defaultProps",xve);K(c$,"layerName","PathLayer");var Nb={},wve={get exports(){return Nb},set exports(t){Nb=t}};wve.exports=cx;Nb.default=cx;function cx(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=DV(t,0,i,n,!0),l=[];if(!s||s.next===s.prev)return l;var o,h,p,b,x,w,A;if(r&&(s=Pve(t,e,s,n)),t.length>80*n){o=p=t[0],h=b=t[1];for(var L=n;L<i;L+=n)x=t[L],w=t[L+1],x<o&&(o=x),w<h&&(h=w),x>p&&(p=x),w>b&&(b=w);A=Math.max(p-o,b-h),A=A!==0?32767/A:0}return fy(s,l,n,o,h,A,0),l}function DV(t,e,n,r,i){var s,l;if(i===BS(t,e,n,r)>0)for(s=e;s<n;s+=r)l=vD(s,t[s],t[s+1],l);else for(s=n-r;s>=e;s-=r)l=vD(s,t[s],t[s+1],l);return l&&ux(l,l.next)&&(my(l),l=l.next),l}function Ud(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(ux(n,n.next)||Kr(n.prev,n,n.next)===0)){if(my(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function fy(t,e,n,r,i,s,l){if(t){!l&&s&&Mve(t,r,i,s);for(var o=t,h,p;t.prev!==t.next;){if(h=t.prev,p=t.next,s?Eve(t,r,i,s):Tve(t)){e.push(h.i/n|0),e.push(t.i/n|0),e.push(p.i/n|0),my(t),t=p.next,o=p.next;continue}if(t=p,t===o){l?l===1?(t=Sve(Ud(t),e,n),fy(t,e,n,r,i,s,2)):l===2&&Ave(t,e,n,r,i,s):fy(Ud(t),e,n,r,i,s,1);break}}}}function Tve(t){var e=t.prev,n=t,r=t.next;if(Kr(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,l=r.x,o=e.y,h=n.y,p=r.y,b=i<s?i<l?i:l:s<l?s:l,x=o<h?o<p?o:p:h<p?h:p,w=i>s?i>l?i:l:s>l?s:l,A=o>h?o>p?o:p:h>p?h:p,L=r.next;L!==e;){if(L.x>=b&&L.x<=w&&L.y>=x&&L.y<=A&&vf(i,o,s,h,l,p,L.x,L.y)&&Kr(L.prev,L,L.next)>=0)return!1;L=L.next}return!0}function Eve(t,e,n,r){var i=t.prev,s=t,l=t.next;if(Kr(i,s,l)>=0)return!1;for(var o=i.x,h=s.x,p=l.x,b=i.y,x=s.y,w=l.y,A=o<h?o<p?o:p:h<p?h:p,L=b<x?b<w?b:w:x<w?x:w,M=o>h?o>p?o:p:h>p?h:p,U=b>x?b>w?b:w:x>w?x:w,D=NS(A,L,e,n,r),$=NS(M,U,e,n,r),N=t.prevZ,B=t.nextZ;N&&N.z>=D&&B&&B.z<=$;){if(N.x>=A&&N.x<=M&&N.y>=L&&N.y<=U&&N!==i&&N!==l&&vf(o,b,h,x,p,w,N.x,N.y)&&Kr(N.prev,N,N.next)>=0||(N=N.prevZ,B.x>=A&&B.x<=M&&B.y>=L&&B.y<=U&&B!==i&&B!==l&&vf(o,b,h,x,p,w,B.x,B.y)&&Kr(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;N&&N.z>=D;){if(N.x>=A&&N.x<=M&&N.y>=L&&N.y<=U&&N!==i&&N!==l&&vf(o,b,h,x,p,w,N.x,N.y)&&Kr(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;B&&B.z<=$;){if(B.x>=A&&B.x<=M&&B.y>=L&&B.y<=U&&B!==i&&B!==l&&vf(o,b,h,x,p,w,B.x,B.y)&&Kr(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function Sve(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!ux(i,s)&&FV(i,r,r.next,s)&&py(i,s)&&py(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),my(r),my(r.next),r=t=s),r=r.next}while(r!==t);return Ud(r)}function Ave(t,e,n,r,i,s){var l=t;do{for(var o=l.next.next;o!==l.prev;){if(l.i!==o.i&&Ove(l,o)){var h=NV(l,o);l=Ud(l,l.next),h=Ud(h,h.next),fy(l,e,n,r,i,s,0),fy(h,e,n,r,i,s,0);return}o=o.next}l=l.next}while(l!==t)}function Pve(t,e,n,r){var i=[],s,l,o,h,p;for(s=0,l=e.length;s<l;s++)o=e[s]*r,h=s<l-1?e[s+1]*r:t.length,p=DV(t,o,h,r,!1),p===p.next&&(p.steiner=!0),i.push(kve(p));for(i.sort(Cve),s=0;s<i.length;s++)n=Lve(i[s],n);return n}function Cve(t,e){return t.x-e.x}function Lve(t,e){var n=Ive(t,e);if(!n)return e;var r=NV(n,t);return Ud(r,r.next),Ud(n,n.next)}function Ive(t,e){var n=e,r=t.x,i=t.y,s=-1/0,l;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var o=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>s&&(s=o,l=n.x<n.next.x?n:n.next,o===r))return l}n=n.next}while(n!==e);if(!l)return null;var h=l,p=l.x,b=l.y,x=1/0,w;n=l;do r>=n.x&&n.x>=p&&r!==n.x&&vf(i<b?r:s,i,p,b,i<b?s:r,i,n.x,n.y)&&(w=Math.abs(i-n.y)/(r-n.x),py(n,t)&&(w<x||w===x&&(n.x>l.x||n.x===l.x&&Rve(l,n)))&&(l=n,x=w)),n=n.next;while(n!==h);return l}function Rve(t,e){return Kr(t.prev,t,e.prev)<0&&Kr(e.next,t,t.next)<0}function Mve(t,e,n,r){var i=t;do i.z===0&&(i.z=NS(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,$ve(i)}function $ve(t){var e,n,r,i,s,l,o,h,p=1;do{for(n=t,t=null,s=null,l=0;n;){for(l++,r=n,o=0,e=0;e<p&&(o++,r=r.nextZ,!!r);e++);for(h=p;o>0||h>0&&r;)o!==0&&(h===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,h--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,p*=2}while(l>1);return t}function NS(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function kve(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function vf(t,e,n,r,i,s,l,o){return(i-l)*(e-o)>=(t-l)*(s-o)&&(t-l)*(r-o)>=(n-l)*(e-o)&&(n-l)*(s-o)>=(i-l)*(r-o)}function Ove(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Dve(t,e)&&(py(t,e)&&py(e,t)&&Fve(t,e)&&(Kr(t.prev,t,e.prev)||Kr(t,e.prev,e))||ux(t,e)&&Kr(t.prev,t,t.next)>0&&Kr(e.prev,e,e.next)>0)}function Kr(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function ux(t,e){return t.x===e.x&&t.y===e.y}function FV(t,e,n,r){var i=Wv(Kr(t,e,n)),s=Wv(Kr(t,e,r)),l=Wv(Kr(n,r,t)),o=Wv(Kr(n,r,e));return!!(i!==s&&l!==o||i===0&&Gv(t,n,e)||s===0&&Gv(t,r,e)||l===0&&Gv(n,t,r)||o===0&&Gv(n,e,r))}function Gv(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Wv(t){return t>0?1:t<0?-1:0}function Dve(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&FV(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function py(t,e){return Kr(t.prev,t,t.next)<0?Kr(t,e,t.next)>=0&&Kr(t,t.prev,e)>=0:Kr(t,e,t.prev)<0||Kr(t,t.next,e)<0}function Fve(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function NV(t,e){var n=new zS(t.i,t.x,t.y),r=new zS(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function vD(t,e,n,r){var i=new zS(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function my(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function zS(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}cx.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,l=Math.abs(BS(t,0,s,n));if(i)for(var o=0,h=e.length;o<h;o++){var p=e[o]*n,b=o<h-1?e[o+1]*n:t.length;l-=Math.abs(BS(t,p,b,n))}var x=0;for(o=0;o<r.length;o+=3){var w=r[o]*n,A=r[o+1]*n,L=r[o+2]*n;x+=Math.abs((t[w]-t[L])*(t[A+1]-t[w+1])-(t[w]-t[A])*(t[L+1]-t[w+1]))}return l===0&&x===0?0:Math.abs((x-l)/l)};function BS(t,e,n,r){for(var i=0,s=e,l=n-r;s<n;s+=r)i+=(t[l]-t[s])*(t[s+1]+t[l+1]),l=s;return i}cx.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var l=0;l<e;l++)n.vertices.push(t[i][s][l]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};const Hv=CV.CLOCKWISE,_D=CV.COUNTER_CLOCKWISE,eu={isClosed:!0};function Nve(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function pg(t){return"positions"in t?t.positions:t}function j_(t){return"holeIndices"in t?t.holeIndices:null}function zve(t){return Array.isArray(t[0])}function Bve(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function Uve(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function Vve(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function bD(t,e,n,r,i){let s=e;const l=n.length;for(let o=0;o<l;o++)for(let h=0;h<r;h++)t[s++]=n[o][h]||0;if(!Uve(n))for(let o=0;o<r;o++)t[s++]=n[0][o]||0;return eu.start=e,eu.end=s,eu.size=r,LV(t,i,eu),s}function xD(t,e,n,r,i=0,s,l){s=s||n.length;const o=s-i;if(o<=0)return e;let h=e;for(let p=0;p<o;p++)t[h++]=n[i+p];if(!Vve(n,r,i,s))for(let p=0;p<r;p++)t[h++]=n[i+p];return eu.start=e,eu.end=h,eu.size=r,LV(t,l,eu),h}function jve(t,e){Nve(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let l=0;for(let o=0;o<=s.length;o++)l=xD(n,l,i,e,s[o-1],s[o],o===0?Hv:_D),r.push(l);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!zve(t))return xD(n,0,t,e,0,n.length,Hv),n;if(!Bve(t)){let i=0;for(const[s,l]of t.entries())i=bD(n,i,l,e,s===0?Hv:_D),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return bD(n,0,t,e,Hv),n}function rT(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const l=(s+1)%r;i+=t[s*3+e]*t[l*3+n],i-=t[l*3+e]*t[s*3+n]}return Math.abs(i/2)}function wD(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const l=s*3,o=t[l+0],h=t[l+1],p=t[l+2];t[l+e]=o,t[l+n]=h,t[l+r]=p}}function Gve(t,e,n,r){let i=j_(t);i&&(i=i.map(o=>o/e));let s=pg(t);const l=r&&e===3;if(n){const o=s.length;s=s.slice();const h=[];for(let p=0;p<o;p+=e){h[0]=s[p],h[1]=s[p+1],l&&(h[2]=s[p+2]);const b=n(h);s[p]=b[0],s[p+1]=b[1],l&&(s[p+2]=b[2])}}if(l){const o=rT(s,0,1),h=rT(s,0,2),p=rT(s,1,2);if(!o&&!h&&!p)return[];o>h&&o>p||(h>p?(n||(s=s.slice()),wD(s,0,2,1)):(n||(s=s.slice()),wD(s,2,0,1)))}return Nb(s,i,e)}class Wve extends AV{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=jve(e,this.positionSize);return this.opts.resolution?RV(pg(n),j_(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?hve(pg(n),j_(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(TD(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return pg(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&TD(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:l,typedArrayManager:o}=this;let h=s.indices;if(!h||!e)return;let p=i;const b=Gve(e,this.positionSize,this.opts.preproject,this.opts.full3d);h=o.allocate(h,i+b.length,{copy:!0});for(let x=0;x<b.length;x++)h[p++]=b[x]+r;l[n+1]=i+b.length,s.indices=h}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const l=pg(e);for(let o=n,h=0;h<r;o++,h++){const p=l[h*s],b=l[h*s+1],x=s>2?l[h*s+2]:0;i[o*3]=p,i[o*3+1]=b,i[o*3+2]=x}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,l=e&&j_(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),l)for(let o=0;o<l.length;o++)s[n+l[o]/i-1]=0;s[n+r-1]=0}}function TD(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const zV=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Hve=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(zV,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),qve=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(zV,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),Kve=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,zb=[0,0,0,255],Xve={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:zb},getLineColor:{type:"accessor",value:zb},material:!0},qv={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class u$ extends uc{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?Hve:qve,fs:Kve,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Qy,Epe,e0]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===Qn.DEFAULT&&(r=Qn.LNGLAT);let s;r===Qn.LNGLAT&&(i?s=n.projectPosition.bind(n):s=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new Wve({preproject:s,fp64:this.use64bitPositions(),IndexType:!e||GM(e,Mr.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const l=this.getAttributeManager(),o=!0;l.remove(["instancePickingColors"]),l.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:qv,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,transition:qv,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:qv,accessor:"getFillColor",defaultValue:zb,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:qv,accessor:"getLineColor",defaultValue:zb,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(h,{index:p,target:b})=>this.encodePickingColor(h&&h.__source?h.__source.index:p,b),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:l,sideModel:o,polygonTesselator:h}=this.state,p={...e,extruded:!!n,elevationScale:s};o&&(o.setInstanceCount(h.instanceCount-1),o.setUniforms(p),i&&(o.setDrawMode(3),o.setUniforms({isWireframe:!0}).draw()),r&&(o.setDrawMode(6),o.setUniforms({isWireframe:!1}).draw())),l&&(l.setVertexCount(h.vertexCount),l.setUniforms(p).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var o;(o=this.state.models)===null||o===void 0||o.forEach(h=>h.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,l=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:l.getPolygon,buffers:l,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let s,l;if(r){const o=this.getShaders("top");o.defines.NON_INSTANCED_MODEL=1,s=new Dd(e,{...o,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(l=new Dd(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Yy({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),l.userData.excludeAttributes={indices:!0}),{models:[l,s].filter(Boolean),topModel:s,sideModel:l}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}K(u$,"defaultProps",Xve);K(u$,"layerName","SolidPolygonLayer");function Zve({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,l=t.length;let o=l,h=l;for(let w=0;w<l;w++){const A=e(t[w]);if(o>w&&A>=i&&(o=w),A>=s){h=w;break}}let p=o;const x=h-o!==r.length?t.slice(h):void 0;for(let w=0;w<r.length;w++)t[p++]=r[w];if(x){for(let w=0;w<x.length;w++)t[p++]=x[w];t.length=p}return{startRow:o,endRow:o+r.length}}function Yve(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?Jve(t,r,n):null}function Jve(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function Qve(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let l=0;l<i.length;l++)e(i[l],s),n[r][l*3+0]=s[0],n[r][l*3+1]=s[1],n[r][l*3+2]=s[2]}return n}const e_e=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,iT=192/256,ED=[],t_e={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class d$ extends lx{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:e_e}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&Nn.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,l=i?Math.max(r,iT*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:iT,outlineBuffer:l,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:o}=this.state;o.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:iT}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):ED}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):ED}}K(d$,"defaultProps",t_e);K(d$,"layerName","MultiIconLayer");const Fg=1e20;class n_e{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:l="normal",fontStyle:o="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const h=this.size=e+n*4,p=this._createCanvas(h),b=this.ctx=p.getContext("2d",{willReadFrequently:!0});b.font=`${o} ${l} ${e}px ${s}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(h*h),this.gridInner=new Float64Array(h*h),this.f=new Float64Array(h),this.z=new Float64Array(h+1),this.v=new Uint16Array(h)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:l}=this.ctx.measureText(e),o=Math.ceil(r),h=0,p=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(l-s))),b=Math.min(this.size-this.buffer,o+Math.ceil(i)),x=p+2*this.buffer,w=b+2*this.buffer,A=Math.max(x*w,0),L=new Uint8ClampedArray(A),M={data:L,width:x,height:w,glyphWidth:p,glyphHeight:b,glyphTop:o,glyphLeft:h,glyphAdvance:n};if(p===0||b===0)return M;const{ctx:U,buffer:D,gridInner:$,gridOuter:N}=this;U.clearRect(D,D,p,b),U.fillText(e,D,D+o);const B=U.getImageData(D,D,p,b);N.fill(Fg,0,A),$.fill(0,0,A);for(let Z=0;Z<b;Z++)for(let ie=0;ie<p;ie++){const re=B.data[4*(Z*p+ie)+3]/255;if(re===0)continue;const ve=(Z+D)*x+ie+D;if(re===1)N[ve]=0,$[ve]=Fg;else{const Te=.5-re;N[ve]=Te>0?Te*Te:0,$[ve]=Te<0?Te*Te:0}}SD(N,0,0,x,w,x,this.f,this.v,this.z),SD($,D,D,p,b,x,this.f,this.v,this.z);for(let Z=0;Z<A;Z++){const ie=Math.sqrt(N[Z])-Math.sqrt($[Z]);L[Z]=Math.round(255-255*(ie/this.radius+this.cutoff))}return M}}function SD(t,e,n,r,i,s,l,o,h){for(let p=e;p<e+r;p++)AD(t,n*s+p,s,i,l,o,h);for(let p=n;p<n+i;p++)AD(t,p*s+e,1,r,l,o,h)}function AD(t,e,n,r,i,s,l){s[0]=0,l[0]=-Fg,l[1]=Fg,i[0]=t[e];for(let o=1,h=0,p=0;o<r;o++){i[o]=t[e+o*n];const b=o*o;do{const x=s[h];p=(i[o]-i[x]+b-x*x)/(o-x)/2}while(p<=l[h]&&--h>-1);h++,s[h]=o,l[h]=p,l[h+1]=Fg}for(let o=0,h=0;o<r;o++){for(;l[h+1]<o;)h++;const p=s[h],b=o-p;t[e+o*n]=i[p]+b*b}}const r_e=32,i_e=[];function s_e(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function o_e({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:l=0,yOffset:o=0}){let h=0,p=l;const b=n+r*2;for(const x of t)if(!s[x]){const w=e(x);p+w+r*2>i&&(p=0,h++),s[x]={x:p+r,y:o+h*b+r,width:w,height:b,layoutWidth:w,layoutHeight:n},p+=w+r*2}return{mapping:s,xOffset:p,yOffset:o+h*b,canvasHeight:s_e(o+(h+1)*b)}}function BV(t,e,n,r){let i=0;for(let l=e;l<n;l++){var s;const o=t[l];i+=((s=r[o])===null||s===void 0?void 0:s.layoutWidth)||0}return i}function UV(t,e,n,r,i,s){let l=e,o=0;for(let h=e;h<n;h++){const p=BV(t,h,h+1,i);o+p>r&&(l<h&&s.push(h),l=h,o=0),o+=p}return o}function a_e(t,e,n,r,i,s){let l=e,o=e,h=e,p=0;for(let b=e;b<n;b++)if((t[b]===" "||t[b+1]===" "||b+1===n)&&(h=b+1),h>o){let x=BV(t,o,h,i);p+x>r&&(l<o&&(s.push(o),l=o,p=0),x>r&&(x=UV(t,o,h,r,i,s),l=s[s.length-1])),o=h,p+=x}return p}function l_e(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const l=[];return e==="break-all"?UV(t,i,s,n,r,l):a_e(t,i,s,n,r,l),l}function c_e(t,e,n,r,i,s){let l=0,o=0;for(let h=e;h<n;h++){const p=t[h],b=r[p];b?(o||(o=b.layoutHeight),i[h]=l+b.layoutWidth/2,l+=b.layoutWidth):(Nn.warn("Missing character: ".concat(p," (").concat(p.codePointAt(0),")"))(),i[h]=l,l+=r_e)}s[0]=l,s[1]=o}function u_e(t,e,n,r,i){const s=Array.from(t),l=s.length,o=new Array(l),h=new Array(l),p=new Array(l),b=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,x=[0,0],w=[0,0];let A=0,L=0,M=0;for(let D=0;D<=l;D++){const $=s[D];if(($===`
`||D===l)&&(M=D),M>L){const N=b?l_e(s,n,r,i,L,M):i_e;for(let B=0;B<=N.length;B++){const Z=B===0?L:N[B-1],ie=B<N.length?N[B]:M;c_e(s,Z,ie,i,o,w);for(let re=Z;re<ie;re++){var U;const ve=s[re],Te=((U=i[ve])===null||U===void 0?void 0:U.layoutOffsetY)||0;h[re]=A+w[1]/2+Te,p[re]=w[0]}A=A+w[1]*e,x[0]=Math.max(x[0],w[0])}L=M}$===`
`&&(o[L]=0,h[L]=0,p[L]=0,L++)}return x[1]=A,{x:o,y:h,rowWidth:p,size:x}}function d_e({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const l=t.BYTES_PER_ELEMENT,o=n?n/l:1,h=r?r/l:0,p=i[e]||Math.ceil((t.length-h)/o),b=s&&new Set,x=new Array(e);let w=t;if(o>1||h>0){const A=t.constructor;w=new A(p);for(let L=0;L<p;L++)w[L]=t[L*o+h]}for(let A=0;A<e;A++){const L=i[A],M=i[A+1]||p,U=w.subarray(L,M);x[A]=String.fromCodePoint.apply(null,U),b&&U.forEach(b.add,b)}if(b)for(const A of b)s.add(String.fromCodePoint(A));return{texts:x,characterCount:p}}class VV{constructor(e=5){K(this,"limit",void 0),K(this,"_cache",{}),K(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function h_e(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const $f={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:h_e(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},PD=1024,CD=.9,LD=1.2,jV=3;let Bb=new VV(jV);function f_e(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=Bb.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function p_e(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function ID(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function m_e(t){Nn.assert(Number.isFinite(t)&&t>=jV,"Invalid cache limit"),Bb=new VV(t)}class g_e{constructor(){K(this,"props",{...$f}),K(this,"_key",void 0),K(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*LD+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=f_e(this._key,this.props.characterSet),r=Bb.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,Bb.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:l,sdf:o,radius:h,cutoff:p}=this.props;let b=n&&n.data;b||(b=document.createElement("canvas"),b.width=PD);const x=b.getContext("2d",{willReadFrequently:!0});ID(x,r,s,i);const{mapping:w,canvasHeight:A,xOffset:L,yOffset:M}=o_e({getFontWidth:U=>x.measureText(U).width,fontHeight:s*LD,buffer:l,characterSet:e,maxCanvasWidth:PD,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(b.height!==A){const U=x.getImageData(0,0,b.width,b.height);b.height=A,x.putImageData(U,0,0)}if(ID(x,r,s,i),o){const U=new n_e({fontSize:s,buffer:l,radius:h,cutoff:p,fontFamily:r,fontWeight:"".concat(i)});for(const D of e){const{data:$,width:N,height:B,glyphTop:Z}=U.draw(D);w[D].width=N,w[D].layoutOffsetY=s*CD-Z;const ie=x.createImageData(N,B);p_e($,ie),x.putImageData(ie,w[D].x,w[D].y)}}else for(const U of e)x.fillText(U,w[U].x,w[U].y+l+s*CD);return{xOffset:L,yOffset:M,mapping:w,data:b,width:b.width,height:b.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:l,cutoff:o}=this.props;return s?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(l," ").concat(o):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const y_e=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,v_e=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,__e={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class h$ extends uc{constructor(...e){super(...e),K(this,"state",void 0)}getShaders(){return super.getShaders({vs:y_e,fs:v_e,modules:[Qy,e0]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:l,getLineWidth:o}=this.props;let{padding:h}=this.props;h.length<4&&(h=[h[0],h[1],h[0],h[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!o,padding:h,sizeUnits:kd[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:l}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Dd(e,{...this.getShaders(),id:this.props.id,geometry:new Yy({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}K(h$,"defaultProps",__e);K(h$,"layerName","TextBackgroundLayer");const RD={start:1,middle:0,end:-1},MD={top:1,center:0,bottom:-1},sT=[0,0,0,255],b_e=1,x_e={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:sT},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:$f.characterSet},fontFamily:$f.fontFamily,fontWeight:$f.fontWeight,lineHeight:b_e,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:sT},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:sT},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class f$ extends a${constructor(...e){super(...e),K(this,"state",void 0),K(this,"getBoundingRect",(n,r)=>{let{size:[i,s]}=this.transformParagraph(n,r);const{fontSize:l}=this.state.fontAtlasManager.props;i/=l,s/=l;const{getTextAnchor:o,getAlignmentBaseline:h}=this.props,p=RD[typeof o=="function"?o(n,r):o],b=MD[typeof h=="function"?h(n,r):h];return[(p-1)*i/2,(b-1)*s/2,i,s]}),K(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:l,y:o,rowWidth:h,size:[p,b]}=this.transformParagraph(n,r),x=RD[typeof i=="function"?i(n,r):i],w=MD[typeof s=="function"?s(n,r):s],A=l.length,L=new Array(A*2);let M=0;for(let U=0;U<A;U++){const D=(1-x)*(p-h[U])/2;L[M++]=(x-1)*p/2+D+l[U],L[M++]=(w-1)*b/2+o[U]}return L})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new g_e},this.props.maxWidth>0&&Nn.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,l={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(l),!0;for(const o in l)if(l[o]!==i.props[o])return i.setProps(l),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,l=n.startIndices,o;const h=r==="auto"&&new Set;if(i&&l){const{texts:p,characterCount:b}=d_e({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:l,characterSet:h});o=b,s=(x,{index:w})=>p[w]}else{const{iterable:p,objectInfo:b}=ax(n);l=[0],o=0;for(const x of p){b.index++;const w=Array.from(s(x,b)||"");h&&w.forEach(h.add,h),o+=w.length,l.push(o)}}this.setState({getText:s,startIndices:l,numInstances:o,characterSet:h||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:l,lineHeight:o,maxWidth:h}=this.props,p=s(e,n)||"";return u_e(p,o,l,h*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:s,mapping:l},styleVersion:o}=this.state,{data:h,_dataDiff:p,getPosition:b,getColor:x,getSize:w,getAngle:A,getPixelOffset:L,getBackgroundColor:M,getBorderColor:U,getBorderWidth:D,backgroundPadding:$,background:N,billboard:B,fontSettings:Z,outlineWidth:ie,outlineColor:re,sizeScale:ve,sizeUnits:Te,sizeMinPixels:Ae,sizeMaxPixels:fe,transitions:Pe,updateTriggers:_e}=this.props,ke=this.getSubLayerClass("characters",d$),Vt=this.getSubLayerClass("background",h$);return[N&&new Vt({getFillColor:M,getLineColor:U,getLineWidth:D,padding:$,getPosition:b,getSize:w,getAngle:A,getPixelOffset:L,billboard:B,sizeScale:ve,sizeUnits:Te,sizeMinPixels:Ae,sizeMaxPixels:fe,transitions:Pe&&{getPosition:Pe.getPosition,getAngle:Pe.getAngle,getSize:Pe.getSize,getFillColor:Pe.getBackgroundColor,getLineColor:Pe.getBorderColor,getLineWidth:Pe.getBorderWidth,getPixelOffset:Pe.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:_e.getPosition,getAngle:_e.getAngle,getSize:_e.getSize,getFillColor:_e.getBackgroundColor,getLineColor:_e.getBorderColor,getLineWidth:_e.getBorderWidth,getPixelOffset:_e.getPixelOffset,getBoundingRect:{getText:_e.getText,getTextAnchor:_e.getTextAnchor,getAlignmentBaseline:_e.getAlignmentBaseline,styleVersion:o}}}),{data:h.attributes&&h.attributes.background?{length:h.length,attributes:h.attributes.background}:h,_dataDiff:p,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new ke({sdf:Z.sdf,smoothing:Number.isFinite(Z.smoothing)?Z.smoothing:$f.smoothing,outlineWidth:ie/(Z.radius||$f.radius),outlineColor:re,iconAtlas:s,iconMapping:l,getPosition:b,getColor:x,getSize:w,getAngle:A,getPixelOffset:L,billboard:B,sizeScale:ve*i,sizeUnits:Te,sizeMinPixels:Ae*i,sizeMaxPixels:fe*i,transitions:Pe&&{getPosition:Pe.getPosition,getAngle:Pe.getAngle,getColor:Pe.getColor,getSize:Pe.getSize,getPixelOffset:Pe.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:_e.getText,getPosition:_e.getPosition,getAngle:_e.getAngle,getColor:_e.getColor,getSize:_e.getSize,getPixelOffset:_e.getPixelOffset,getIconOffsets:{getTextAnchor:_e.getTextAnchor,getAlignmentBaseline:_e.getAlignmentBaseline,styleVersion:o}}}),{data:h,_dataDiff:p,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){m_e(e)}}K(f$,"defaultProps",x_e);K(f$,"layerName","TextLayer");const G_={circle:{type:l$,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:lx,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:f$,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},W_={type:c$,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},US={type:u$,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Hm({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function oT(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const l=e[s];let o=t.props[s];s.startsWith("get")&&(o=t.getSubLayerAccessor(o),i.updateTriggers[l]=r[s],n&&(i.transitions[l]=n[s])),i[l]=o}return i}function w_e(t){if(Array.isArray(t))return t;switch(Nn.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Nn.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function $D(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let l=i;l<s;l++){const o=t[l],{geometry:h}=o;if(h)if(h.type==="GeometryCollection"){Nn.assert(Array.isArray(h.geometries),"GeoJSON does not have geometries array");const{geometries:p}=h;for(let b=0;b<p.length;b++){const x=p[b];kD(x,r,e,o,l)}}else kD(h,r,e,o,l)}return r}function kD(t,e,n,r,i){const{type:s,coordinates:l}=t,{pointFeatures:o,lineFeatures:h,polygonFeatures:p,polygonOutlineFeatures:b}=e;if(!E_e(s,l)){Nn.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":o.push(n({geometry:t},r,i));break;case"MultiPoint":l.forEach(x=>{o.push(n({geometry:{type:"Point",coordinates:x}},r,i))});break;case"LineString":h.push(n({geometry:t},r,i));break;case"MultiLineString":l.forEach(x=>{h.push(n({geometry:{type:"LineString",coordinates:x}},r,i))});break;case"Polygon":p.push(n({geometry:t},r,i)),l.forEach(x=>{b.push(n({geometry:{type:"LineString",coordinates:x}},r,i))});break;case"MultiPolygon":l.forEach(x=>{p.push(n({geometry:{type:"Polygon",coordinates:x}},r,i)),x.forEach(w=>{b.push(n({geometry:{type:"LineString",coordinates:w}},r,i))})});break}}const T_e={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function E_e(t,e){let n=T_e[t];for(Nn.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function GV(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function Kv(t){return t.geometry.coordinates}function S_e(t,e){const n=GV(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:l}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=Kv,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=Kv,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=Kv,n.polygonsOutline.data=l,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=Kv,n}function A_e(t,e){const n=GV(),{points:r,lines:i,polygons:s}=t,l=Qve(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:l.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:l.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:l.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:l.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const P_e=["points","linestrings","polygons"],C_e={...Hm(G_.circle),...Hm(G_.icon),...Hm(G_.text),...Hm(W_),...Hm(US),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class Ng extends a${initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=A_e(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=w_e(e.data),i=this.getSubLayerRow.bind(this);let s={};const l={};if(Array.isArray(n.dataChanged)){const h=this.state.features;for(const p in h)s[p]=h[p].slice(),l[p]=[];for(const p of n.dataChanged){const b=$D(r,i,p);for(const x in h)l[x].push(Zve({data:s[x],getIndex:w=>w.__source.index,dataRange:p,replace:b[x]}))}}else s=$D(r,i);const o=S_e(s,l);this.setState({features:s,featuresDiff:l,layerProps:o})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=P_e.find(s=>i.id.startsWith("".concat(this.id,"-").concat(s,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,US.type);if(s){const l=oT(this,US.props),o=e&&n;return o||delete l.getLineColor,l.updateTriggers.lineColors=o,new s(l,this.getSubLayerProps({id:i,updateTriggers:l.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",l=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,W_.type),o=this.shouldRenderSubLayer(s,r.lines.data)&&this.getSubLayerClass(s,W_.type);if(l||o){const h=oT(this,W_.props);return[l&&new l(h,this.getSubLayerProps({id:i,updateTriggers:h.updateTriggers}),r.polygonsOutline),o&&new o(h,this.getSubLayerProps({id:s,updateTriggers:h.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(o=>o.__source.index===i));const s=new Set(e.split("+")),l=[];for(const o of s){const h="points-".concat(o),p=G_[o],b=p&&this.shouldRenderSubLayer(h,n.points.data)&&this.getSubLayerClass(h,p.type);if(b){const x=oT(this,p.props);let w=n.points;if(o==="text"&&r){const{instancePickingColors:A,...L}=w.data.attributes;w={...w,data:{...w.data,attributes:L}}}l.push(new b(x,this.getSubLayerProps({id:h,updateTriggers:x.updateTriggers,highlightedObjectIndex:i}),w))}}return l}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:l}=i,o=Yve(s,l);return e(o,i)}}}K(Ng,"layerName","GeoJsonLayer");K(Ng,"defaultProps",C_e);const L_e=typeof window<"u"?te.useLayoutEffect:te.useEffect,I_e=L_e;function Ub(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const R_e={position:"absolute",zIndex:-1};function WV(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>WV(n,e));if(dx(t)){if(M_e(t))return e.style=R_e,te.cloneElement(t,e);if($_e(t))return te.cloneElement(t,e)}return t}function dx(t){return t&&typeof t=="object"&&"type"in t||!1}function M_e(t){const e=t.type,n=e&&e.defaultProps;return n&&n.mapStyle}function $_e(t){const e=t.type;return e&&e.deckGLViewProps}function VS(t){if(typeof t=="function")return te.createElement(cp,{},t);if(Array.isArray(t))return t.map(VS);if(dx(t)){if(t.type===te.Fragment)return VS(t.props.children);if(Ub(t.type,cp))return t}return t}function k_e({children:t,layers:e=[],views:n=null}){const r=[],i=[],s={};return te.Children.forEach(VS(t),l=>{if(dx(l)){const o=l.type;if(Ub(o,uc)){const h=O_e(o,l.props);i.push(h)}else r.push(l);if(Ub(o,cp)&&o!==cp&&l.props.id){const h=new o(l.props);s[h.id]=h}}else l&&r.push(l)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(l=>{s[l.id]=l}):n&&(s[n.id]=n),n=Object.values(s)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function O_e(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function D_e({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},s=r.views[0].id;for(const l of t){let o=s,h=l;dx(l)&&Ub(l.type,cp)&&(o=l.props.id||s,h=l.props.children);const p=r.getViewport(o),b=r.getViewState(o);if(p){b.padding=p.padding;const{x,y:w,width:A,height:L}=p;h=WV(h,{x,y:w,width:A,height:L,viewport:p,viewState:b}),i[o]||(i[o]={viewport:p,children:[]}),i[o].children.push(h)}}return Object.keys(i).map(l=>{const{viewport:o,children:h}=i[l],{x:p,y:b,width:x,height:w}=o,A={position:"absolute",left:p,top:b,width:x,height:w},L="view-".concat(l),M=te.createElement("div",{key:L,id:L,style:A},...h);if(n){const U={viewport:o,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:D=>{D.viewId=l,e._onViewStateChange(D)}};return te.createElement(n,{key:L,value:U},M)}return M})}const F_e={mixBlendMode:null};function N_e({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const s in n)s in F_e?i[s]=n[s]:r[s]=n[s];return{containerStyle:r,canvasStyle:i}}function z_e(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function HV(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function B_e(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const s=r.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():HV(t)}});return r}const qV=te.forwardRef((t,e)=>{const[n,r]=te.useState(0),s=te.useRef({control:null,version:n,forceUpdate:()=>r(Z=>Z+1)}).current,l=te.useRef(null),o=te.useRef(null),h=te.useMemo(()=>k_e(t),[t.layers,t.views,t.children]);let p=!0;const b=Z=>{var ie;return p&&t.viewState?(s.viewStateUpdateRequested=Z,null):(s.viewStateUpdateRequested=null,(ie=t.onViewStateChange)===null||ie===void 0?void 0:ie.call(t,Z))},x=Z=>{if(p)s.interactionStateUpdateRequested=Z;else{var ie;s.interactionStateUpdateRequested=null,(ie=t.onInteractionStateChange)===null||ie===void 0||ie.call(t,Z)}},w=te.useMemo(()=>{const Z={...t,style:null,width:"100%",height:"100%",parent:l.current,canvas:o.current,layers:h.layers,views:h.views,onViewStateChange:b,onInteractionStateChange:x};return delete Z._customRender,s.deck&&s.deck.setProps(Z),Z},[t]);te.useEffect(()=>{const Z=t.Deck||ox;return s.deck=B_e(s,Z,{...w,parent:l.current,canvas:o.current}),()=>{var ie;return(ie=s.deck)===null||ie===void 0?void 0:ie.finalize()}},[]),I_e(()=>{HV(s);const{viewStateUpdateRequested:Z,interactionStateUpdateRequested:ie}=s;Z&&b(Z),ie&&x(ie)}),te.useImperativeHandle(e,()=>z_e(s),[]);const A=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:L,width:M,height:U,id:D,style:$}=t,{containerStyle:N,canvasStyle:B}=te.useMemo(()=>N_e({width:M,height:U,style:$}),[M,U,$]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===A||s.version!==n){s.lastRenderedViewports=A,s.version=n;const Z=D_e({children:h.children,deck:s.deck,ContextProvider:L}),ie=te.createElement("canvas",{key:"canvas",id:D||"deckgl-overlay",ref:o,style:B});s.control=te.createElement("div",{id:"".concat(D||"deckgl","-wrapper"),ref:l,style:N},[ie,Z])}return p=!1,s.control});qV.defaultProps=ox.defaultProps;const U_e=qV;function Vd(t){"@babel/helpers - typeof";return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vd(t)}function V_e(t,e){if(Vd(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(Vd(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KV(t){var e=V_e(t,"string");return Vd(e)==="symbol"?e:String(e)}function on(t,e,n){return e=KV(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function OD(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class DD{constructor(e,n){on(this,"name",void 0),on(this,"type",void 0),on(this,"sampleSize",1),on(this,"time",void 0),on(this,"count",void 0),on(this,"samples",void 0),on(this,"lastTiming",void 0),on(this,"lastSampleTime",void 0),on(this,"lastSampleCount",void 0),on(this,"_count",0),on(this,"_time",0),on(this,"_samples",0),on(this,"_startTime",0),on(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=OD(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(OD()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class j_e{constructor(e){on(this,"id",void 0),on(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof DD?this.stats[n]=e:this.stats[n]=new DD(n,r)),this.stats[n]}}function XV(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Tu(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||XV()}const H_={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},Xv=H_.window||H_.self||H_.global,qm=H_.process||{},ZV=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Tu();const aT=globalThis;function G_e(t){if(!t&&!Tu())return"Node";if(XV(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":aT.chrome?"Chrome":aT.safari?"Safari":aT.mozInnerScreenX?"Firefox":"Unknown"}function W_e(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class H_e{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";on(this,"storage",void 0),on(this,"id",void 0),on(this,"config",void 0),this.storage=W_e(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function q_e(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function K_e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function lT(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const s=t.width*n,l=t.height*n,o=["font-size:1px;","padding:".concat(Math.floor(l/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(l,"px;"),"background:url(".concat(i,");"),"background-size:".concat(s,"px ").concat(l,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),o]}let Vb;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Vb||(Vb={}));function FD(t){return typeof t=="string"?Vb[t.toUpperCase()]||Vb.WHITE:t}function X_e(t,e,n){return!Tu&&typeof t=="string"&&(e&&(e=FD(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=FD(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function Z_e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(s=>i===s)||(t[i]=t[i].bind(t)))}function jb(t,e){if(!t)throw new Error(e||"Assertion failed")}function Bh(){let t;if(Tu&&"performance"in Xv){var e,n;t=Xv==null||(e=Xv.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in qm){var r;const i=qm==null||(r=qm.hrtime)===null||r===void 0?void 0:r.call(qm);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Uh={debug:Tu&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Y_e={enabled:!0,level:0};function Ho(){}const ND={},zD={once:!0};class YV{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};on(this,"id",void 0),on(this,"VERSION",ZV),on(this,"_startTs",Bh()),on(this,"_deltaTs",Bh()),on(this,"_storage",void 0),on(this,"userData",{}),on(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new H_e("__probe-".concat(this.id,"__"),Y_e),this.timeStamp("".concat(this.id," started")),Z_e(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Bh()-this._startTs).toPrecision(10))}getDelta(){return Number((Bh()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){jb(e,n)}warn(e){return this._getLogFunction(0,e,Uh.warn,arguments,zD)}error(e){return this._getLogFunction(0,e,Uh.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Uh.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Uh.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return this._getLogFunction(e,n,Uh.debug||Uh.info,arguments,zD)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Ho,r&&[r],{tag:tbe(n)}):Ho}image(e){let{logLevel:n,priority:r,image:i,message:s="",scale:l=1}=e;return this._shouldLog(n||r)?Tu?ebe({image:i,message:s,scale:l}):Q_e():Ho}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Ho)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=BD({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ho)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=JV(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=BD({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,jb(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Bh();const l=s.tag||s.message;if(s.once)if(!ND[l])ND[l]=Bh();else return Ho;return n=J_e(this.id,s.message,s),r.bind(console,n,...s.args)}return Ho}}on(YV,"VERSION",ZV);function JV(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return jb(Number.isFinite(e)&&e>=0),e}function BD(t){const{logLevel:e,message:n}=t;t.logLevel=JV(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return jb(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function J_e(t,e,n){if(typeof e=="string"){const r=n.time?K_e(q_e(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=X_e(e,n.color,n.background)}return e}function Q_e(t){return console.warn("removed"),Ho}function ebe(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const l=lT(s,n,r);console.log(...l)},s.src=e,Ho}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...lT(e,n,r)),Ho;if(i.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...lT(s,n,r)),s.src=e.toDataURL(),Ho}return Ho}function tbe(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const ln=new YV({id:"luma.gl"});function Xs(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const nbe="Invalid WebGLRenderingContext",rbe="Requires WebGL2";function p$(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function nr(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function ibe(t){return nr(t)?t:null}function m$(t){return Xs(p$(t),nbe),t}function Zs(t){return Xs(nr(t),rbe),t}const mg={};function sbe(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function obe(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function abe(t,e){mg[t]=!0,e!==void 0&&sbe(e)}function lbe(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(mg[r]=!0);while(r!==0);for(r in mg)if(mg[r])return delete mg[r],parseInt(r,10);return 0}}const n0=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};n0.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};n0.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const th=function(e){const n=this;this.gl=e,lbe(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,s);const o=l.attribs[s];return o.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const l=n.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,s);const o=l.attribs[s];return o.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,l){switch(s){case 34962:n.currentArrayBuffer=l;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=l;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,l){const h=n.currentVertexArrayObject.attribs[s];switch(l){case 34975:return h.buffer;case 34338:return h.enabled;case 34339:return h.size;case 34340:return h.stride;case 34341:return h.type;case 34922:return h.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,l,o,h,p,b){const x=n.currentVertexArrayObject;x.maxAttrib=Math.max(x.maxAttrib,s);const w=x.attribs[s];return w.buffer=n.currentArrayBuffer,w.size=l,w.type=o,w.normalized=h,w.stride=p,w.offset=b,w.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{obe("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};th.prototype.VERTEX_ARRAY_BINDING_OES=34229;th.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new n0(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};th.prototype.createVertexArrayOES=function(){const e=new n0(this);return this.vertexArrayObjects.push(e),e};th.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};th.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof n0&&e.hasBeenBound&&e.ext===this)};th.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){abe(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(i===s)return;(!i||s.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,s.elementArrayBuffer);let l=this.currentArrayBuffer;const o=Math.max(i?i.maxAttrib:0,s.maxAttrib);for(let h=0;h<=o;h++){const p=s.attribs[h],b=i?i.attribs[h]:null;if((!i||p.enabled!==b.enabled)&&(p.enabled?r.enableVertexAttribArray.call(n,h):r.disableVertexAttribArray.call(n,h)),p.enabled){let x=!1;(!i||p.buffer!==b.buffer)&&(l!==p.buffer&&(r.bindBuffer.call(n,34962,p.buffer),l=p.buffer),x=!0),(x||p.cached!==b.cached)&&r.vertexAttribPointer.call(n,h,p.size,p.type,p.normalized,p.stride,p.offset)}}this.currentArrayBuffer!==l&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function cbe(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const s=n.call(this,i);return s||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new th(this)),this.__OESVertexArrayObject))}}const UD="OES_element_index",VD="WEBGL_draw_buffers",ube="EXT_disjoint_timer_query",dbe="EXT_disjoint_timer_query_webgl2",hbe="EXT_texture_filter_anisotropic",jD="WEBGL_debug_renderer_info",fbe=35723,pbe=4352,mbe=36795,gbe=34047,ybe=37445,vbe=37446,Er=t=>nr(t)?void 0:0,_be={[3074]:t=>nr(t)?void 0:36064,[fbe]:t=>nr(t)?void 0:pbe,[35977]:Er,[32937]:Er,[mbe]:(t,e)=>{const n=nr(t)?t.getExtension(dbe):t.getExtension(ube);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[ybe]:(t,e)=>{const n=t.getExtension(jD);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[vbe]:(t,e)=>{const n=t.getExtension(jD);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[gbe]:(t,e)=>{const n=t.luma.extensions[hbe];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:Er,[35071]:Er,[37447]:Er,[36063]:(t,e)=>{if(!nr(t)){const n=t.getExtension(VD);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:Er,[35374]:Er,[35377]:Er,[34852]:t=>{if(!nr(t)){const e=t.getExtension(VD);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(UD)?2147483647:65535,[33001]:t=>t.getExtension(UD)?16777216:65535,[33e3]:t=>16777216,[37157]:Er,[35373]:Er,[35657]:Er,[36183]:Er,[37137]:Er,[34045]:Er,[35978]:Er,[35979]:Er,[35968]:Er,[35376]:Er,[35375]:Er,[35659]:Er,[37154]:Er,[35371]:Er,[35658]:Er,[35076]:Er,[35077]:Er,[35380]:Er};function bbe(t,e,n){const r=_be[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const xbe="OES_vertex_array_object",QV="ANGLE_instanced_arrays",wbe="WEBGL_draw_buffers",Tbe="EXT_disjoint_timer_query",Ebe="EXT_texture_filter_anisotropic",Sbe="VertexArray requires WebGL2 or OES_vertex_array_object extension";function Abe(t,e){return{webgl2:nr(t),ext:t.getExtension(e)}}const ej={[xbe]:{meta:{suffix:"OES"},createVertexArray:()=>{Xs(!1,Sbe)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[QV]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Xs(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[wbe]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Xs(!1)}},[Tbe]:{meta:{suffix:"EXT"},createQuery:()=>{Xs(!1)},deleteQuery:()=>{Xs(!1)},beginQuery:()=>{Xs(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},cT={readBuffer:(t,e,n)=>{nr(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:s}=Abe(t,QV);let l;switch(r){case 35069:l=i?void 0:!1;break;case 35070:l=!i&&!s?0:void 0;break}return l!==void 0?l:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!nr(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!nr(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,s=i[Ebe];r=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:bbe,hint(t,e,n,r){return e(n,r)}};function Pbe(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(cbe(t),Cbe(t),Ibe(t,ej),Lbe(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=Pbe;function Cbe(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function Lbe(t,e){let{target:n,target2:r}=e;Object.keys(cT).forEach(i=>{if(typeof cT[i]=="function"){const s=t[i]?t[i].bind(t):()=>{},l=cT[i].bind(null,t,s);n[i]=l,r[i]=l}})}function Ibe(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&Rbe(t,{extension:n,target:t.luma,target2:t})}function Rbe(t,e){let{extension:n,target:r,target2:i}=e;const s=ej[n];Xs(s);const{meta:l={}}=s,{suffix:o=""}=l,h=t.getExtension(n);for(const p of Object.keys(s)){const b="".concat(p).concat(o);let x=null;p==="meta"||typeof t[p]=="function"||(h&&typeof h[b]=="function"?x=function(){return h[b](...arguments)}:typeof s[p]=="function"&&(x=s[p].bind(r))),x&&(r[p]=x,i[p]=x)}}const tj={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},zc=(t,e,n)=>e?t.enable(n):t.disable(n),GD=(t,e,n)=>t.hint(n,e),yo=(t,e,n)=>t.pixelStorei(n,e),Mbe=(t,e)=>{const n=nr(t)?36009:36160;return t.bindFramebuffer(n,e)},$be=(t,e)=>t.bindFramebuffer(36008,e);function Km(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const kbe={[3042]:zc,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:zc,[2885]:(t,e)=>t.cullFace(e),[2929]:zc,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:zc,[35723]:GD,[36006]:Mbe,[2886]:(t,e)=>t.frontFace(e),[33170]:GD,[2849]:(t,e)=>t.lineWidth(e),[32823]:zc,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:zc,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:zc,[3088]:(t,e)=>t.scissor(...e),[2960]:zc,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:yo,[3317]:yo,[37440]:yo,[37441]:yo,[37443]:yo,[3330]:yo,[3332]:yo,[3331]:yo,[36010]:$be,[3314]:yo,[32878]:yo,[3316]:yo,[3315]:yo,[32877]:yo,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Km(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Km(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Km(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Km(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,l,o]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,l,o)},stencilOp:(t,e)=>{e=Km(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,l,o]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,l,o)},viewport:(t,e)=>t.viewport(...e)};function ii(t,e,n){return e[t]!==void 0?e[t]:n[t]}const Obe={blendEquation:(t,e,n)=>t.blendEquationSeparate(ii(32777,e,n),ii(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(ii(32969,e,n),ii(32968,e,n),ii(32971,e,n),ii(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(ii(32824,e,n),ii(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(ii(32938,e,n),ii(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,ii(2962,e,n),ii(2967,e,n),ii(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,ii(34816,e,n),ii(36003,e,n),ii(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,ii(2964,e,n),ii(2965,e,n),ii(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,ii(34817,e,n),ii(34818,e,n),ii(34819,e,n))},WD={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,r,i)=>t({[32773]:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,r,i)=>t({[32969]:e,[32968]:n,[32971]:r,[32970]:i}),clearColor:(t,e,n,r,i)=>t({[3106]:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,r,i)=>t({[3107]:[e,n,r,i]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,r,i)=>t({[3088]:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({[2962]:e,[2967]:n,[2963]:r,[34816]:e,[36003]:n,[36004]:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({[2964]:e,[2965]:n,[2966]:r,[34817]:e,[34818]:n,[34819]:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({[2978]:[e,n,r,i]})},Ka=(t,e)=>t.isEnabled(e),HD={[3042]:Ka,[2884]:Ka,[2929]:Ka,[3024]:Ka,[32823]:Ka,[32926]:Ka,[32928]:Ka,[3089]:Ka,[2960]:Ka,[35977]:Ka};function nj(t){for(const e in t)return!1;return!0}function Dbe(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function qD(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function Fbe(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var s=arguments.length,l=new Array(s),o=0;o<s;o++)l[o]=arguments[o];const{valueChanged:h,oldValue:p}=n(t.state._updateCache,...l);return h&&r(...l),p},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function Nbe(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class zbe{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?Vbe(e):Object.assign({},tj),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Xs(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];rj(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Xs(s!==void 0);const l=e[s],o=this.cache[s];Dbe(l,o)||(n=!0,r=o,i&&!(s in i)&&(i[s]=o),this.cache[s]=l)}return{valueChanged:n,oldValue:r}}}function Bbe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Xs(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new zbe(t,{copyState:r}),Nbe(t);for(const s in WD){const l=WD[s];Fbe(t,s,l)}qD(t,"getParameter"),qD(t,"isEnabled")}return t.state.enable=n,t}function Ube(t){t.state||Bbe(t,{copyState:!1}),t.state.push()}function KD(t){Xs(t.state),t.state.pop()}function rj(t,e){if(Xs(p$(t),"setParameters requires a WebGL context"),nj(e))return;const n={};for(const i in e){const s=Number(i),l=kbe[i];l&&(typeof l=="string"?n[l]=!0:l(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=Obe[i];s(t,e,r)}}function Vbe(t,e){if(e=e||tj,typeof e=="number"){const i=e,s=HD[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=HD[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function kf(t,e,n){if(nj(e))return n(t);const{nocatch:r=!0}=e;Ube(t),rj(t,e);let i;if(r)i=n(t),KD(t);else try{i=n(t)}finally{KD(t)}return i}Tu();const zg="8.5.20",jbe="set luma.log.level=1 (or higher) to trace rendering";class Gbe{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new j_e({id:e})),this.stats.get(e)}}const gg=new Gbe;if(globalThis.luma&&globalThis.luma.VERSION!==zg)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(zg));globalThis.luma||(Tu()&&ln.log(1,"luma.gl ".concat(zg," - ").concat(jbe))(),globalThis.luma=globalThis.luma||{VERSION:zg,version:zg,log:ln,stats:gg,globals:{modules:{},nodeIO:{}}});function Qt(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function uT(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return Qt(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function du(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const dT={};function jd(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";dT[t]=dT[t]||1;const e=dT[t]++;return"".concat(t,"-").concat(e)}function XD(t){return Qt(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function jS(t){let e=!0;for(const n in t){e=!1;break}return e}function ij(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);r.forEach(l=>{s.methodName||(s[l]=()=>{throw ln.removed("Calling removed method ".concat(e,".").concat(l,": "),i)(),new Error(l)})})}const Vh="Resource subclass must define virtual methods";class Eu{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};m$(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||jd(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=uT(this.gl,e),Qt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=nr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const o=i.webgl1,h="webgl2"in i?i.webgl2:i.webgl1;return s?h:o}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},s=nr(this.gl),l={},o=n||Object.keys(i);for(const h of o){const p=i[h];if(p&&(!("webgl2"in p)||s)&&(!("extension"in p)||this.gl.getExtension(p.extension))){const x=r?du(this.gl,h):h;l[x]=this.getParameter(h,e),r&&p.type==="GLenum"&&(l[x]=du(this.gl,l[x]))}}return l}setParameter(e,n){e=uT(this.gl,e),Qt(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const s=nr(this.gl);if(!((!("webgl2"in i)||s)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=uT(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return ij(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(Vh)}_deleteHandle(){throw new Error(Vh)}_bindHandle(e){throw new Error(Vh)}_getOptsFromHandle(){throw new Error(Vh)}_getParameter(e,n){throw new Error(Vh)}_setParameter(e,n){throw new Error(Vh)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=gg.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];gg.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=gg.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=gg.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}}const Wbe="Failed to deduce GL constant from typed array";function GS(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(Wbe)}}function gy(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Hbe(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:s}=t;const l=n*i;s=s||new Uint8Array(l);for(let o=0;o<r/2;++o){const h=o*l,p=(r-o-1)*l;s.set(e.subarray(h,h+l)),e.copyWithin(h,p,p+l),e.set(s,p)}}function qbe(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),s=Math.round(r/2),l=new Uint8Array(i*s*4);for(let o=0;o<s;o++)for(let h=0;h<i;h++)for(let p=0;p<4;p++)l[(o*i+h)*4+p]=e[(o*2*n+h*2)*4+p];return{data:l,width:i,height:s}}function WS(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const o in r)if(o in e){const p=r[o]?"".concat(t,".").concat(r[o]):"N/A";ln.removed("".concat(t,".").concat(o),p)()}for(const o in i)if(o in e){const h=i[o];ln.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(h))()}let l=null;for(const o in s)if(o in e){const h=s[o];ln.deprecated("".concat(t,".").concat(o),"".concat(t,".").concat(h))(),l=l||Object.assign({},e),l[h]=e[o],delete l[o]}return l||e}const Kbe={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},Xbe={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class To{static getBytesPerElement(e){return gy(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Qt(e.size),gy(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new To(Kbe,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return To.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return To.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=WS("Accessor",e,Xbe),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const ZD=10,sj={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},Zbe={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:sj},Ybe={removedProps:sj};class ks extends Eu{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/To.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/To.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=WS("Buffer",e,Zbe),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=WS("Buffer",e,Ybe),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new To(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,s=e.byteLength||e.length;Qt(n);const l=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(l,this.handle),i!==0||s!==void 0?(Zs(this.gl),this.gl.bufferSubData(this.target,r,n,i,s)):this.gl.bufferSubData(l,r,n),this.gl.bindBuffer(l,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:s}=e;const{gl:l}=this;return Zs(l),l.bindBuffer(36662,n.handle),l.bindBuffer(36663,this.handle),l.copyBufferSubData(36662,36663,r,i,s),l.bindBuffer(36662,null),l.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zs(this.gl);const s=gy(this.accessor.type||5126,{clamped:!1}),l=this._getAvailableElementCount(n),o=r;let h,p;e?(p=e.length,h=p-o):(h=Math.min(l,i||l),p=o+h);const b=Math.min(l,h);return i=i||b,Qt(i<=b),e=e||new s(p),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(Qt(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(ZD,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Qt(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,ZD),this.bytesUsed=r,this._trackAllocatedMemory(r);const s=GS(e);return Qt(s),this.setAccessor(new To(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Qt(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=gy(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new To(this.accessor,{type:GS(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return ln.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return ln.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return ln.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return ln.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new To(this.accessor,e),this}}const g$={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},Jbe={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},Qbe={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function e1e(t,e){const n=g$[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=nr(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function t1e(t,e){const n=g$[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const n1e=[9729,9728],YD=globalThis.WebGLBuffer||function(){};class Gb extends Eu{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let s=!0;return r&&(s=s&&e1e(e,r),s=s&&(!i||t1e(e,r))),s}constructor(e,n){const{id:r=jd("texture"),handle:i,target:s}=n;super(e,{id:r,handle:i}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then($=>this.initialize(Object.assign({},e,{pixels:$,data:$}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:s=6408,border:l=0,recreate:o=!1,parameters:h={},pixelStore:p={},textureUnit:b=void 0}=e;n||(n=i);let{width:x,height:w,dataFormat:A,type:L,compressed:M=!1,mipmaps:U=!0}=e;const{depth:D=0}=e;return{width:x,height:w,compressed:M,dataFormat:A,type:L}=this._deduceParameters({format:s,type:L,dataFormat:A,compressed:M,data:n,width:x,height:w}),this.width=x,this.height=w,this.depth=D,this.format=s,this.type=L,this.dataFormat=A,this.border=l,this.textureUnit=b,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),U&&this._isNPOT()&&(ln.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),U=!1,this._updateForNPOT(h)),this.mipmaps=U,this.setImageData({data:n,width:x,height:w,depth:D,format:s,type:L,dataFormat:A,border:l,mipmaps:U,parameters:p,compressed:M}),U&&this.generateMipmap(),this.setParameters(h),o&&(this.data=n),r&&(this._video={video:n,parameters:h,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(ln.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),kf(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:s=this.format,border:l=this.border,offset:o=0,parameters:h={}}=e;let{data:p=null,type:b=this.type,width:x=this.width,height:w=this.height,dataFormat:A=this.dataFormat,compressed:L=!1}=e;p||(p=r),{type:b,dataFormat:A,compressed:L,width:x,height:w}=this._deduceParameters({format:s,type:b,dataFormat:A,compressed:L,data:p,width:x,height:w});const{gl:M}=this;M.bindTexture(this.target,this.handle);let U=null;({data:p,dataType:U}=this._getDataType({data:p,compressed:L}));let D,$=0;if(kf(this.gl,h,()=>{switch(U){case"null":M.texImage2D(n,i,s,x,w,l,A,b,p);break;case"typed-array":M.texImage2D(n,i,s,x,w,l,A,b,p,o);break;case"buffer":D=Zs(M),D.bindBuffer(35052,p.handle||p),D.texImage2D(n,i,s,x,w,l,A,b,o),D.bindBuffer(35052,null);break;case"browser-object":nr(M)?M.texImage2D(n,i,s,x,w,l,A,b,p):M.texImage2D(n,i,s,A,b,p);break;case"compressed":for(const[N,B]of p.entries())M.compressedTexImage2D(n,N,B.format,B.width,B.height,l,B.data),$+=B.levelSize;break;default:Qt(!1,"Unknown image data type")}}),U==="compressed")this._trackAllocatedMemory($,"Texture");else if(p&&p.byteLength)this._trackAllocatedMemory(p.byteLength,"Texture");else{const N=Jbe[this.dataFormat]||4,B=Qbe[this.type]||1;this._trackAllocatedMemory(this.width*this.height*N*B,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:l=0,width:o=this.width,height:h=this.height,level:p=0,format:b=this.format,type:x=this.type,dataFormat:w=this.dataFormat,compressed:A=!1,offset:L=0,border:M=this.border,parameters:U={}}=e;if({type:x,dataFormat:w,compressed:A,width:o,height:h}=this._deduceParameters({format:b,type:x,dataFormat:w,compressed:A,data:i,width:o,height:h}),Qt(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const D=i;i=D.data,o=D.shape[0],h=D.shape[1]}i instanceof ks&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),kf(this.gl,U,()=>{if(A)this.gl.compressedTexSubImage2D(n,p,s,l,o,h,b,i);else if(i===null)this.gl.texSubImage2D(n,p,s,l,o,h,w,x,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,p,s,l,o,h,w,x,i,L);else if(i instanceof YD){const D=Zs(this.gl);D.bindBuffer(35052,i),D.texSubImage2D(n,p,s,l,o,h,w,x,L),D.bindBuffer(35052,null)}else nr(this.gl)?Zs(this.gl).texSubImage2D(n,p,s,l,o,h,w,x,i):this.gl.texSubImage2D(n,p,s,l,w,x,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return ln.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ks?{data:n.handle,dataType:"buffer"}:n instanceof YD?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:s,dataFormat:l,type:o,compressed:h}=e;const p=g$[n];return l=l||p&&p.dataFormat,o=o||p&&p.types[0],h=h||p&&p.compressed,{width:i,height:s}=this._deduceImageSize(r,i,s),{dataFormat:l,type:o,compressed:h,width:i,height:s,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},Qt(i,"Could not deduced texture size"),Qt(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),Qt(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Qt(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return nr(this.gl)||!this.width||!this.height?!1:!XD(this.width)||!XD(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:n1e.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let r1e="";function i1e(t,e){return Qt(typeof t=="string"),t=r1e+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class y$ extends Gb{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return Gb.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};m$(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:i1e(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const id="EXT_color_buffer_float",JD={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:id,bpp:2},[33327]:{gl2:id,bpp:4},[34842]:{gl2:id,bpp:8},[33326]:{gl2:id,bpp:4},[33328]:{gl2:id,bpp:8},[34836]:{gl2:id,bpp:16},[35898]:{gl2:id,bpp:4}};function s1e(t,e,n){const r=n[e];if(!r)return!1;const i=nr(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class yg extends Eu{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||s1e(e,n,JD)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:s=0}=e;return Qt(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&nr(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*JD[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const o1e=256,a1e=1024,l1e=16384,QD=6144,eF=6145,tF=6146,nF=34041,oj="clear: bad arguments";function v$(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let l=0;n&&(l|=l1e,n!==!0&&(s.clearColor=n)),r&&(l|=o1e,r!==!0&&(s.clearDepth=r)),i&&(l|=a1e,r!==!0&&(s.clearStencil=r)),Qt(l!==0,oj),kf(t,s,()=>{t.clear(l)})}function c1e(t){let{framebuffer:e=null,buffer:n=QD,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Zs(t),kf(t,{framebuffer:e},()=>{switch(n){case QD:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case eF:t.clearBufferfv(eF,0,[i]);break;case tF:t.clearBufferiv(tF,0,[i]);break;case nF:const[s,l]=i;t.clearBufferfi(nF,0,s,l);break;default:Qt(!1,oj)}})}function u1e(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Qt(!1),0}}function aj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:s=36064,target:l=null,sourceWidth:o,sourceHeight:h,sourceType:p}=e;const{framebuffer:b,deleteFramebuffer:x}=d1e(t);Qt(b);const{gl:w,handle:A,attachments:L}=b;o=o||b.width,h=h||b.height,s===36064&&A===null&&(s=1028),Qt(L[s]),p=p||L[s].type,l=h1e(l,p,i,o,h),p=p||GS(l);const M=w.bindFramebuffer(36160,A);return w.readPixels(n,r,o,h,i,p,l),w.bindFramebuffer(36160,M||null),x&&b.delete(),l}function rF(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=aj(t,{sourceAttachment:e}),{width:i,height:s}=t;for(;s>n;)({data:r,width:i,height:s}=qbe({data:r,width:i,height:s}));Hbe({data:r,width:i,height:s});const l=document.createElement("canvas");l.width=i,l.height=s;const o=l.getContext("2d"),h=o.createImageData(i,s);return h.data.set(r),o.putImageData(h,0,0),l.toDataURL()}function d1e(t){return t instanceof La?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:x1e(t),deleteFramebuffer:!0}}function h1e(t,e,n,r,i){if(t)return t;e=e||5121;const s=gy(e,{clamped:!1}),l=u1e(n);return new s(r*i*l)}const si={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function f1e(t){const e=new y$(t,{format:6408,type:5126,dataFormat:6408}),n=new La(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const lj={[si.WEBGL2]:[!1,!0],[si.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[si.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[si.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[si.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[si.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[si.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[si.FLOAT_BLEND]:["EXT_float_blend"],[si.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[si.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[si.TEXTURE_FLOAT]:["OES_texture_float",!0],[si.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[si.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[si.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[si.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[si.COLOR_ATTACHMENT_RGBA32F]:[f1e,"EXT_color_buffer_float"],[si.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[si.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[si.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[si.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[si.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[si.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},p1e=2;function m1e(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in lj)t.luma.caps[e]===void 0&&(t.luma.caps[e]=g1e(t,e));return t.luma.caps}function g1e(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=y1e(t,e)),t.luma.caps[e]||ln.log(p1e,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function y1e(t,e){const n=lj[e];Qt(n,e);let r;const i=nr(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const s of i)r=r&&!!t.getExtension(s)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:Qt(!1);return r}const iF="Multiple render targets not supported";class La extends Eu{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let s=!0;return r&&(s=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(s=s&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new La(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Zs(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Zs(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:s=!0,depth:l=!0,stencil:o=!1,check:h=!0,readBuffer:p=void 0,drawBuffers:b=void 0}=e;if(Qt(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const x in i){const w=i[x];(Array.isArray(w)?w[0]:w).resize({width:n,height:r})}else i=this._createDefaultAttachments(s,l,o,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:p,drawBuffers:b}),i&&h&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:s=!1,resizeAttachments:l=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:l});const{gl:o}=this,h=o.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),o.bindFramebuffer(36160,h||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return Qt(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&ln.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(l=>{i[l]=null}),Object.assign(i,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const l in i){Qt(l!==void 0,"Misspelled framebuffer binding point?");const o=Number(l),h=i[o];let p=h;if(!p)this._unattach(o);else if(p instanceof yg)this._attachRenderbuffer({attachment:o,renderbuffer:p});else if(Array.isArray(h)){const[b,x=0,w=0]=h;p=b,this._attachTexture({attachment:o,texture:b,layer:x,level:w})}else this._attachTexture({attachment:o,texture:p,layer:0,level:0});r&&p&&p.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(l=>!this.attachments[l]).forEach(l=>{delete this.attachments[l]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(_1e(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:s=[]}=e,l=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&v$(this.gl,{color:n,depth:r,stencil:i}),s.forEach((o,h)=>{c1e(this.gl,{drawBuffer:h,value:o})}),this.gl.bindFramebuffer(36160,l||null),this}readPixels(){return ln.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return ln.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return ln.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return ln.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return ln.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return ln.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:s,height:l}=e;const o=Zs(this.gl),h=o.bindFramebuffer(36008,this.handle);return r===0&&i===0&&s===void 0&&l===void 0?o.invalidateFramebuffer(36008,n):o.invalidateFramebuffer(36008,n,r,i,s,l),o.bindFramebuffer(36008,h),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=du(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const s of r){const l=n?du(this.gl,s):s;i[l]=this.getAttachmentParameter(e,s,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const s=Number(i),l=e?du(this.gl,s):s;r[l]=this.getAttachmentParameters(s,e)}return r}show(){return typeof window<"u"&&window.open(rF(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>ln.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=rF(this,{targetMaxHeight:100});return ln.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,s){let l=null;return e&&(l=l||{},l[36064]=new y$(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:s,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(l[36064])),n&&r?(l=l||{},l[33306]=new yg(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(l[33306])):n?(l=l||{},l[36096]=new yg(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:s}),this.ownResources.push(l[36096])):r&&Qt(!1),l}_unattach(e){const n=this.attachments[e];n&&(n instanceof yg?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:s}=e;const{gl:l}=this;switch(l.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Zs(l).framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const h=v1e(i);l.framebufferTexture2D(36160,n,h,r.handle,s);break;case 3553:l.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:Qt(!1,"Illegal texture type")}l.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=ibe(this.gl);n?n.readBuffer(e):Qt(e===36064||e===1029,iF),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=Zs(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):Qt(e.length===1&&(e[0]===36064||e[0]===1029),iF)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=m1e(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function v1e(t){return t<34069?t+34069:t}function _1e(t){return(La.STATUS||{})[t]||"Framebuffer error ".concat(t)}const b1e=[36049,36048,33296,33298,33299,33300,33301,33302,33303];La.ATTACHMENT_PARAMETERS=b1e;function x1e(t,e){const{gl:n,width:r,height:i,id:s}=t;return new La(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:r,height:i,attachments:{[36064]:t}}))}function q_(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const w1e=35632,T1e=35633;function E1e(t){switch(t){case w1e:return"fragment";case T1e:return"vertex";default:return"unknown type"}}function S1e(t,e,n,r){const i=t.split(/\r?\n/),s={},l={},o=r||q_(e)||"(unnamed)",h="".concat(E1e(n)," shader ").concat(o);for(let b=0;b<i.length;b++){const x=i[b];if(x.length<=1)continue;const w=x.split(":"),A=w[0],L=parseInt(w[2],10);if(isNaN(L))throw new Error("GLSL compilation error in ".concat(h,": ").concat(t));A!=="WARNING"?s[L]=x:l[L]=x}const p=A1e(e);return{shaderName:h,errors:sF(s,p),warnings:sF(l,p)}}function sF(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const s=t[r+1],l=s.split(":",3),o=l[0],h=parseInt(l[1],10)||0,p=s.substring(l.join(":").length+1).trim();n+=cj("^^^ ".concat(o,": ").concat(p,`

`),h)}}return n}function A1e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((s,l)=>{const o=String(l+e),h=o.length;return cj(o,i-h)+n+s})}function cj(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}const P1e="Shader: GLSL source code must be a JavaScript string";class yy extends Eu{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Qt(!1),"unknown"}}constructor(e,n){m$(e),Qt(typeof n.source=="string",P1e);const r=q_(n.source,null)||n.id||jd("unnamed ".concat(yy.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=q_(n,null);r&&(this.id=jd(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(yy.getTypeName(this.shaderType),":").concat(this.id)}getName(){return q_(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:s,warnings:l}=S1e(r,this.source,this.shaderType,this.id);throw ln.error("GLSL compilation errors in ".concat(i,`
`).concat(s))(),ln.warn("GLSL compilation warnings in ".concat(i,`
`).concat(l))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class hT extends yy{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class fT extends yy{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const C1e={[5126]:Ir.bind(null,"uniform1fv",vo,1,ms),[35664]:Ir.bind(null,"uniform2fv",vo,2,ms),[35665]:Ir.bind(null,"uniform3fv",vo,3,ms),[35666]:Ir.bind(null,"uniform4fv",vo,4,ms),[5124]:Ir.bind(null,"uniform1iv",Bc,1,ms),[35667]:Ir.bind(null,"uniform2iv",Bc,2,ms),[35668]:Ir.bind(null,"uniform3iv",Bc,3,ms),[35669]:Ir.bind(null,"uniform4iv",Bc,4,ms),[35670]:Ir.bind(null,"uniform1iv",Bc,1,ms),[35671]:Ir.bind(null,"uniform2iv",Bc,2,ms),[35672]:Ir.bind(null,"uniform3iv",Bc,3,ms),[35673]:Ir.bind(null,"uniform4iv",Bc,4,ms),[35674]:Ir.bind(null,"uniformMatrix2fv",vo,4,Il),[35675]:Ir.bind(null,"uniformMatrix3fv",vo,9,Il),[35676]:Ir.bind(null,"uniformMatrix4fv",vo,16,Il),[35678]:Qi,[35680]:Qi,[5125]:Ir.bind(null,"uniform1uiv",Zv,1,ms),[36294]:Ir.bind(null,"uniform2uiv",Zv,2,ms),[36295]:Ir.bind(null,"uniform3uiv",Zv,3,ms),[36296]:Ir.bind(null,"uniform4uiv",Zv,4,ms),[35685]:Ir.bind(null,"uniformMatrix2x3fv",vo,6,Il),[35686]:Ir.bind(null,"uniformMatrix2x4fv",vo,8,Il),[35687]:Ir.bind(null,"uniformMatrix3x2fv",vo,6,Il),[35688]:Ir.bind(null,"uniformMatrix3x4fv",vo,12,Il),[35689]:Ir.bind(null,"uniformMatrix4x2fv",vo,8,Il),[35690]:Ir.bind(null,"uniformMatrix4x3fv",vo,12,Il),[35678]:Qi,[35680]:Qi,[35679]:Qi,[35682]:Qi,[36289]:Qi,[36292]:Qi,[36293]:Qi,[36298]:Qi,[36299]:Qi,[36300]:Qi,[36303]:Qi,[36306]:Qi,[36307]:Qi,[36308]:Qi,[36311]:Qi},L1e={},I1e={},R1e={},oF=[0];function _$(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(oF[0]=t,t=oF);const i=t.length;if(i%e&&ln.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=r[i];s||(s=new n(i),r[i]=s);for(let l=0;l<i;l++)s[l]=t[l];return s}function vo(t,e){return _$(t,e,Float32Array,L1e)}function Bc(t,e){return _$(t,e,Int32Array,I1e)}function Zv(t,e){return _$(t,e,Uint32Array,R1e)}function aF(t,e,n){const r=C1e[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function M1e(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function $1e(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!k1e(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function k1e(t){return Array.isArray(t)||ArrayBuffer.isView(t)?D1e(t):isFinite(t)||t===!0||t===!1||t instanceof Gb||t instanceof yg?!0:t instanceof La?!!t.texture:!1}function O1e(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,s=n.length;i<s;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function D1e(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Qi(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Ir(t,e,n,r){let i=null,s=null;return(l,o,h)=>{const p=e(h,n),b=p.length;let x=!1;if(i===null)i=new Float32Array(b),s=b,x=!0;else{Qt(s===b,"Uniform length cannot change.");for(let w=0;w<b;++w)if(p[w]!==i[w]){x=!0;break}}return x&&(r(l,t,o,p),i.set(p)),x}}function ms(t,e,n,r){t[e](n,r)}function Il(t,e,n,r){t[e](n,!1,r)}const F1e=5120,N1e=5121,z1e=5122,B1e=5123,lF=0,Yv=1,U1e=2,V1e=3,Jv=4,j1e=5,G1e=6,Mi=5126,W1e=35664,H1e=35665,q1e=35666,Xm=5124,K1e=35667,X1e=35668,Z1e=35669,Zm=5125,Y1e=36294,J1e=36295,Q1e=36296,exe=35670,txe=35671,nxe=35672,rxe=35673,ixe=35674,sxe=35675,oxe=35676,axe=35685,lxe=35686,cxe=35687,uxe=35688,dxe=35689,hxe=35690,HS={[Mi]:[Mi,1,"float"],[W1e]:[Mi,2,"vec2"],[H1e]:[Mi,3,"vec3"],[q1e]:[Mi,4,"vec4"],[Xm]:[Xm,1,"int"],[K1e]:[Xm,2,"ivec2"],[X1e]:[Xm,3,"ivec3"],[Z1e]:[Xm,4,"ivec4"],[Zm]:[Zm,1,"uint"],[Y1e]:[Zm,2,"uvec2"],[J1e]:[Zm,3,"uvec3"],[Q1e]:[Zm,4,"uvec4"],[exe]:[Mi,1,"bool"],[txe]:[Mi,2,"bvec2"],[nxe]:[Mi,3,"bvec3"],[rxe]:[Mi,4,"bvec4"],[ixe]:[Mi,8,"mat2"],[axe]:[Mi,8,"mat2x3"],[lxe]:[Mi,8,"mat2x4"],[sxe]:[Mi,12,"mat3"],[cxe]:[Mi,12,"mat3x2"],[uxe]:[Mi,12,"mat3x4"],[oxe]:[Mi,16,"mat4"],[dxe]:[Mi,16,"mat4x2"],[hxe]:[Mi,16,"mat4x3"]};function fxe(t){switch(t){case lF:return lF;case Yv:return Yv;case V1e:return Yv;case U1e:return Yv;case Jv:return Jv;case j1e:return Jv;case G1e:return Jv;default:return Qt(!1),0}}function cF(t){const e=HS[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function uj(t,e){switch(t){case F1e:case N1e:case z1e:case B1e:t=Mi;break}for(const n in HS){const[r,i,s]=HS[n];if(r===t&&i===e)return{glType:n,name:s}}return null}class pxe{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:s,type:l,size:o}=n.getActiveAttrib(e.handle,i),h=n.getAttribLocation(e.handle,s);h>=0&&this._addAttribute(h,s,l,o)}this.attributeInfos.sort((i,s)=>i.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!nr(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:s,type:l,size:o}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,s,l,o)}this.varyingInfos.sort((i,s)=>i.location-s.location)}_addAttribute(e,n,r,i){const{type:s,components:l}=cF(r),o={type:s,size:i*l};this._inferProperties(e,n,o);const h={location:e,name:n,accessor:new To(o)};this.attributeInfos.push(h),this.attributeInfosByLocation[e]=h,this.attributeInfosByName[h.name]=h}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:s,components:l}=cF(r),o=new To({type:s,size:i*l}),h={location:e,name:n,accessor:o};this.varyingInfos.push(h),this.varyingInfosByName[h.name]=h}}const uF=4,mxe=35981,gxe=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class dj extends Eu{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",gxe),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:s,bufferMode:l=mxe}=e;return this.hash=n||"",this.vs=typeof r=="string"?new hT(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new fT(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,Qt(this.vs instanceof hT),Qt(this.fs instanceof fT),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(Zs(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,l)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new pxe(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:s=0,start:l,end:o,isIndexed:h=!1,indexType:p=5123,instanceCount:b=0,isInstanced:x=b>0,vertexArray:w=null,transformFeedback:A,framebuffer:L,parameters:M={},uniforms:U,samplers:D}=e;if((U||D)&&(ln.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(U||{})),ln.priority>=n){const $=L?L.id:"default",N="mode=".concat(du(this.gl,r)," verts=").concat(i," ")+"instances=".concat(b," indexType=").concat(du(this.gl,p)," ")+"isInstanced=".concat(x," isIndexed=").concat(h," ")+"Framebuffer=".concat($);ln.log(n,N)()}return Qt(w),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||x&&b===0?!1:(w.bindForDraw(i,b,()=>{if(L!==void 0&&(M=Object.assign({},M,{framebuffer:L})),A){const $=fxe(r);A.begin($)}this._bindTextures(),kf(this.gl,M,()=>{h&&x?this.gl2.drawElementsInstanced(r,i,p,s,b):h&&nr(this.gl)&&!isNaN(l)&&!isNaN(o)?this.gl2.drawRangeElements(r,l,o,i,p,s):h?this.gl.drawElements(r,i,p,s):x?this.gl2.drawArraysInstanced(r,s,i,b):this.gl.drawArrays(r,s,i)}),A&&A.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ln.priority>=2&&$1e(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let s=r,l=!1;if(s instanceof La&&(s=s.texture),s instanceof Gb)if(l=this.uniforms[n]!==r,l){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const o=s,{textureIndex:h}=i;o.bind(h),s=h,this._textureUniforms[n]=o}else s=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(s)||l)&&O1e(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new hT({handle:i});break;case 35632:r.fs=new fT({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=jd(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),ln.time(uF,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),ln.timeEnd(uF,"linkProgram for ".concat(this._getName()))(),e.debug||ln.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=M1e(r.name);let s=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=aF(e,s,r),r.size>1)for(let l=0;l<r.size;l++)s=e.getUniformLocation(this.handle,"".concat(i,"[").concat(l,"]")),this._uniformSetters["".concat(i,"[").concat(l,"]")]=aF(e,s,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}class yxe extends Eu{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return nr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Zs(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,jS(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:s,byteOffset:l}=this._getBufferParams(n);return r<0?(this.unused[e]=i,ln.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,l,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof ks?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||i===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let Qv=null;function vxe(t){return(!Qv||Qv.byteLength<t)&&(Qv=new ArrayBuffer(t)),Qv}function _xe(t,e){const n=vxe(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function bxe(t){let{target:e,source:n,start:r=0,count:i=1}=t;const s=n.length,l=i*s;let o=0;for(let h=r;o<s;o++)e[h++]=n[o];for(;o<l;)o<l-o?(e.copyWithin(r+o,r,r+o),o*=2):(e.copyWithin(r+o,r,r+l-o),o=l);return e}const xxe="elements must be GL.ELEMENT_ARRAY_BUFFER";class _o extends Eu{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?nr(e)||G_e()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new _o(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return _o.MAX_ATTRIBUTES=_o.MAX_ATTRIBUTES||e.getParameter(34921),_o.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:_o._setConstantFloatArray(e,n,r);break;case Int32Array:_o._setConstantIntArray(e,n,r);break;case Uint32Array:_o._setConstantUintArray(e,n,r);break;default:Qt(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return _o.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Qt(!e||e.target===34963,xxe),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:s,stride:l,offset:o,normalized:h,integer:p,divisor:b}=r,{gl:x,gl2:w}=this;return e=Number(e),this.bind(()=>{x.bindBuffer(34962,n.handle),p?(Qt(nr(x)),w.vertexAttribIPointer(e,i,s,l,o)):x.vertexAttribPointer(e,i,s,h,l,o),x.enableVertexAttribArray(e),w.vertexAttribDivisor(e,b||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!_o.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,s=r.length*e;let l=!this.buffer;if(this.buffer=this.buffer||new ks(this.gl,i),l=l||this.buffer.reallocate(i),l=l||!this._compareConstantArrayValues(r,this.bufferValue),l){const o=_xe(n.constructor,s);bxe({target:o,source:r,start:0,count:s}),this.buffer.subData(o),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:Qt(!1)}}static _setConstantIntArray(e,n,r){switch(Qt(nr(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:Qt(!1)}}static _setConstantUintArray(e,n,r){switch(Qt(nr(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:Qt(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return Qt(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const wxe="VertexArray: attributes must be Buffers or constants (i.e. typed array)",Txe=/^(.+)__LOCATION_([0-9]+)$/,Exe=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Sxe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new _o(e),ij(this,"VertexArray","v6.0",Exe),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,s)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=s,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ks(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ks&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ks&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const s={location:-1,accessor:null},{location:l,name:o}=this._getAttributeIndex(e);if(!Number.isFinite(l)||l<0)return this.unused[e]=n,ln.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const h=this._getAttributeInfo(o||l);if(!h)return s;const p=this.accessors[l]||{},b=To.resolve(h.accessor,p,r,i),{size:x,type:w}=b;return Qt(Number.isFinite(x)&&Number.isFinite(w)),{location:l,accessor:b}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=Txe.exec(e),i=r?r[1]:e,s=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+s,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof ks)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ks){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof ks){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(wxe)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)i=this.values[s],ArrayBuffer.isView(i)&&this._setConstantAttribute(s,i)}_setConstantAttributeZero(e,n){if(_o.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){_o.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:s}=i,l=s>0;if(e.isInstanced=e.isInstanced||l,r instanceof ks){const o=r;if(l){const h=o.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,h)}else{const h=o.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,h)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ln.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function Axe(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let l=0;l<t.length&&l<n;++l)l>0&&(i+=",".concat(l%r===0?" ":"")),i+=vy(t[l],e);const s=t.length>n?"...":"]";return"".concat(i).concat(s)}function vy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return Axe(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function dF(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;Qt(n);const s=".*_.*",l=".*Matrix",o=n._uniformSetters,h={},p=Object.keys(o).sort();let b=0;for(const A of p)!A.match(s)&&!A.match(l)&&pT({table:h,header:e,uniforms:r,uniformName:A,undefinedOnly:i})&&b++;for(const A of p)A.match(l)&&pT({table:h,header:e,uniforms:r,uniformName:A,undefinedOnly:i})&&b++;for(const A of p)h[A]||pT({table:h,header:e,uniforms:r,uniformName:A,undefinedOnly:i})&&b++;let x=0;const w={};if(!i)for(const A in r){const L=r[A];h[A]||(x++,w[A]={Type:"NOT USED: ".concat(L),[e]:vy(L)})}return{table:h,count:b,unusedTable:w,unusedCount:x}}function pT(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:s}=t;const l=r[i],o=Pxe(l);return!s||!o?(e[i]={[n]:o?vy(l):"N/A","Uniform Type":o?l:"NOT PROVIDED"},!0):!1}function Pxe(t){return t!=null}function Cxe(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=hF(e,e.elements,null,n));const i=e.values;for(const s in i){const l=e._getAttributeInfo(s);if(l){let o="".concat(s,": ").concat(l.name);const h=e.accessors[l.location];h&&(o="".concat(s,": ").concat(Lxe(l.name,h))),r[o]=hF(e,i[s],h,n)}}return r}function hF(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let s="NOT PROVIDED",l=1,o=0,h=0,p,b,x;if(n&&(s=n.type,l=n.size,s=String(s).replace("Array",""),p=s.indexOf("nt")!==-1),e instanceof ks){const w=e,{data:A,changed:L}=w.getDebugData();b=L?"*":"",x=A,h=w.byteLength,o=h/A.BYTES_PER_ELEMENT/l;let M;if(n){const U=n.divisor>0;M="".concat(U?"I ":"P "," ").concat(o," (x").concat(l,"=").concat(h," bytes ").concat(du(i,s),")")}else p=!0,M="".concat(h," bytes");return{[r]:"".concat(b).concat(vy(x,{size:l,isInteger:p})),"Format ":M}}return x=e,l=e.length,s=String(e.constructor.name).replace("Array",""),p=s.indexOf("nt")!==-1,{[r]:"".concat(vy(x,{size:l,isInteger:p})," (constant)"),"Format ":"".concat(l,"x").concat(s," (constant)")}}function Lxe(t,e){const{type:n,size:r}=e,i=uj(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function Ixe(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=fF(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=fF(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function fF(t){const{type:e,size:n}=t.accessor,r=uj(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const r0="vs",b$="fs";function Yl(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const mT={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function Rxe(t){const e={};for(const n in t){const r=t[n],i=Mxe(r);e[n]=i}return e}function Mxe(t){let e=pF(t);return e==="object"?t?"type"in t?Object.assign({},t,mT[t.type]):"value"in t?(e=pF(t.value),Object.assign({type:e},t,mT[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},mT[e])}function pF(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const $xe="vs",kxe="fs";class mF{constructor(e){let{name:n,vs:r,fs:i,dependencies:s=[],uniforms:l,getUniforms:o,deprecations:h=[],defines:p={},inject:b={},vertexShader:x,fragmentShader:w}=e;Yl(typeof n=="string"),this.name=n,this.vs=r||x,this.fs=i||w,this.getModuleUniforms=o,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(h),this.defines=p,this.injections=Oxe(b),l&&(this.uniforms=Rxe(l))}getModuleSource(e){let n;switch(e){case $xe:n=this.vs||"";break;case kxe:n=this.fs||"";break;default:Yl(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Yl(s.validate(e[i],s),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=s.value}return n}}function Oxe(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function Dxe(t){return Fxe(fj(t))}function Fxe(t){const e={},n={};return hj({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function hj(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&hj({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function fj(t,e){return t.map(n=>(n instanceof mF||(Yl(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),Yl(n.name,"shader module has no name"),n=new mF(n),n.dependencies=fj(n.dependencies)),n))}function Nxe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const zxe=7936,Bxe=7937,Uxe=7938,Vxe=35724,x$={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},ud={};Object.keys(x$).forEach(t=>{ud[t]=t});function jxe(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function Gxe(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||zxe),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Bxe);return{gpuVendor:Wxe(n,r),vendor:n,renderer:r,version:t.getParameter(Uxe),shadingLanguageVersion:t.getParameter(Vxe)}}function Wxe(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const gT={};function gF(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=x$[e];if(Yl(r,e),!Nxe(n))return!0;if(e in gT)return gT[e];const i=r[0],s=n.behavior||"enable",l="#extension GL_".concat(i," : ").concat(s,`
void main(void) {}`),o=t.createShader(35633);t.shaderSource(o,l),t.compileShader(o);const h=t.getShaderParameter(o,35713);return t.deleteShader(o),gT[e]=h,h}function Hxe(t,e){const n=x$[e];Yl(n,e);const r=jxe(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return Yl(i===!1||i===!0),i}function e_(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Hxe(t,n))}function qxe(t){switch(Gxe(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Kxe(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return e_(t,ud.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),e_(t,ud.GLSL_DERIVATIVES)&&gF(t,ud.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),e_(t,ud.GLSL_FRAG_DATA)&&gF(t,ud.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),e_(t,ud.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const Xxe=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,Zxe=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,Yxe={[r0]:Xxe,[b$]:Zxe},K_="__LUMA_INJECT_DECLARATIONS__",yF=/void\s+main\s*\([^)]*\)\s*\{\n?/,vF=/}\n?[^{}]*$/,yT=[];function _F(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===r0;for(const s in n){const l=n[s];l.sort((h,p)=>h.order-p.order),yT.length=l.length;for(let h=0,p=l.length;h<p;++h)yT[h]=l[h].injection;const o="".concat(yT.join(`
`),`
`);switch(s){case"vs:#decl":i&&(t=t.replace(K_,o));break;case"vs:#main-start":i&&(t=t.replace(yF,h=>h+o));break;case"vs:#main-end":i&&(t=t.replace(vF,h=>o+h));break;case"fs:#decl":i||(t=t.replace(K_,o));break;case"fs:#main-start":i||(t=t.replace(yF,h=>h+o));break;case"fs:#main-end":i||(t=t.replace(vF,h=>o+h));break;default:t=t.replace(s,h=>h+o)}}return t=t.replace(K_,""),r&&(t=t.replace(/\}\s*$/,s=>s+Yxe[e])),t}function up(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const pj=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Jxe=[...pj,[up("attribute"),"in $1"],[up("varying"),"out $1"]],Qxe=[...pj,[up("varying"),"in $1"]],mj=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],ewe=[...mj,[up("in"),"attribute $1"],[up("out"),"varying $1"]],twe=[...mj,[up("in"),"varying $1"]],qS="gl_FragColor",KS=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,nwe=/void\s+main\s*\([^)]*\)\s*\{\n?/;function rwe(t,e,n){switch(e){case 300:return n?Wb(t,Jxe):iwe(t);case 100:return n?Wb(t,ewe):swe(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Wb(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function iwe(t){t=Wb(t,Qxe);const e=t.match(KS);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(qS,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(nwe,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(qS,"\\b"),"g"),n)}return t}function swe(t){t=Wb(t,twe);const e=t.match(KS);if(e){const n=e[1];t=t.replace(KS,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),qS)}return t}const owe=`

`.concat(K_,`

`),gj={[r0]:"vertex",[b$]:"fragment"},awe=`precision highp float;

`;function lwe(t,e){const{vs:n,fs:r}=e,i=Dxe(e.modules||[]);return{gl:t,vs:bF(t,Object.assign({},e,{source:n,type:r0,modules:i})),fs:bF(t,Object.assign({},e,{source:r,type:b$,modules:i})),getUniforms:cwe(i)}}function bF(t,e){let{id:n,source:r,type:i,modules:s,defines:l={},hookFunctions:o=[],inject:h={},transpileToGLSL100:p=!1,prologue:b=!0,log:x}=e;Yl(typeof r=="string","shader source must be a string");const w=i===r0,A=r.split(`
`);let L=100,M="",U=r;A[0].indexOf("#version ")===0?(L=300,M=A[0],U=A.slice(1).join(`
`)):M="#version ".concat(L);const D={};s.forEach(re=>{Object.assign(D,re.getDefines())}),Object.assign(D,l);let $=b?"".concat(M,`
`).concat(dwe({id:n,source:r,type:i}),`
`).concat(uwe({type:i}),`
`).concat(qxe(t),`
`).concat(Kxe(t),`
`).concat(hwe(D),`
`).concat(w?"":awe,`
`):"".concat(M,`
`);const N=pwe(o),B={},Z={},ie={};for(const re in h){const ve=typeof h[re]=="string"?{injection:h[re],order:0}:h[re],Te=re.match(/^(v|f)s:(#)?([\w-]+)$/);if(Te){const Ae=Te[2],fe=Te[3];Ae?fe==="decl"?Z[re]=[ve]:ie[re]=[ve]:B[re]=[ve]}else ie[re]=[ve]}for(const re of s){x&&re.checkDeprecations(U,x);const ve=re.getModuleSource(i,L);$+=ve;const Te=re.injections[i];for(const Ae in Te){const fe=Ae.match(/^(v|f)s:#([\w-]+)$/);if(fe){const _e=fe[2]==="decl"?Z:ie;_e[Ae]=_e[Ae]||[],_e[Ae].push(Te[Ae])}else B[Ae]=B[Ae]||[],B[Ae].push(Te[Ae])}}return $+=owe,$=_F($,i,Z),$+=fwe(N[i],B),$+=U,$=_F($,i,ie),$=rwe($,p?100:L,w),$}function cwe(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function uwe(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(gj[e].toUpperCase(),`
`)}function dwe(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(gj[r],`

`):""}function hwe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function fwe(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const s=e[r];s.sort((l,o)=>l.order-o.order);for(const l of s)n+="  ".concat(l.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function pwe(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,s]=n.split(":"),l=n.replace(/\(.+/,"");e[i][l]=Object.assign(r,{signature:s})}),e}class w${static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new w$(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:s={},varyings:l=[],bufferMode:o=35981,transpileToGLSL100:h=!1}=e,p=this._getModuleList(e.modules),b=this._getHash(n),x=this._getHash(r),w=p.map(N=>this._getHash(N.name)).sort(),A=l.map(N=>this._getHash(N)),L=Object.keys(i).sort(),M=Object.keys(s).sort(),U=[],D=[];for(const N of L)U.push(this._getHash(N)),U.push(this._getHash(i[N]));for(const N of M)D.push(this._getHash(N)),D.push(this._getHash(s[N]));const $="".concat(b,"/").concat(x,"D").concat(U.join("/"),"M").concat(w.join("/"),"I").concat(D.join("/"),"V").concat(A.join("/"),"H").concat(this.stateHash,"B").concat(o).concat(h?"T":"");if(!this._programCache[$]){const N=lwe(this.gl,{vs:n,fs:r,modules:p,inject:s,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:h});this._programCache[$]=new dj(this.gl,{hash:$,vs:N.vs,fs:N.fs,varyings:l,bufferMode:o}),this._getUniforms[$]=N.getUniforms||(B=>{}),this._useCounts[$]=0}return this._useCounts[$]++,this._programCache[$]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,l=this._defaultModules.length;s<l;++s){const o=this._defaultModules[s],h=o.name;n[i++]=o,r[h]=!0}for(let s=0,l=e.length;s<l;++s){const o=e[s],h=o.name;r[h]||(n[i++]=o,r[h]=!0)}return n.length=i,n}}const mwe={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function gwe(t,e,n){const r={};let i=e.indices;for(const s in e.attributes){const l=e.attributes[s],o=ywe(s,n);if(s==="indices")i=l;else if(l.constant)r[o]=l.value;else{const h=l.value,p={...l};delete p.value,r[o]=[new ks(t,h),p],vwe(s,p)}}if(i){const s=i.value||i;Qt(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const l={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new ks(t,{data:s,target:34963}),l]}return r}function ywe(t,e){const{attributeMap:n=mwe}=e||{};return n&&n[t]||t}function vwe(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Qt(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const jh=2,_we=1e4,bwe="Model needs drawMode and vertexCount",xF=()=>{},xwe={};class wwe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=jd("model")}=n;Qt(p$(e)),this.id=r,this.gl=e,this.id=n.id||jd("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||w$.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:h,bufferMode:p,transpileToGLSL100:b}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:h,bufferMode:p,transpileToGLSL100:b},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Qt(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),bwe)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:h,bufferMode:p,transpileToGLSL100:b}=e;this.programProps={program:n,vs:r,fs:i,modules:s,defines:l,inject:o,varyings:h,bufferMode:p,transpileToGLSL100:b},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Qt(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Qt(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=gwe(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(jS(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return v$(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:s={},transformFeedback:l=this.transformFeedback,parameters:o={},vertexArray:h=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(i);let p;ln.priority>=jh&&(p=this._logDrawCallStart(jh));const b=this.vertexArray.getDrawParams(),{isIndexed:x=b.isIndexed,indexType:w=b.indexType,indexOffset:A=b.indexOffset,vertexArrayInstanced:L=b.isInstanced}=this.props;L&&!this.isInstanced&&ln.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:M,instanceCount:U}=this,{onBeforeRender:D=xF,onAfterRender:$=xF}=this.props;D(),this.program.setUniforms(this.uniforms);const N=this.program.draw(Object.assign(xwe,e,{logPriority:p,uniforms:null,framebuffer:r,parameters:o,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:h,transformFeedback:l,isIndexed:x,indexType:w,isInstanced:M,instanceCount:U,offset:x?A:0}));return $(),ln.priority>=jh&&this._logDrawCallEnd(p,h,r),N}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:s}=e;r&&this._setFeedbackBuffers(r),n&&(s=Object.assign({},s,{[35977]:n})),i.forEach(l=>l.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{i.forEach(l=>l.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ln.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:s,inject:l,defines:o,varyings:h,bufferMode:p,transpileToGLSL100:b}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:s,inject:l,defines:o,varyings:h,bufferMode:p,transpileToGLSL100:b}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Qt(n instanceof dj,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Sxe(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ks&&n.delete()}}_setAnimationProps(e){this.animated&&Qt(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(jS(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new yxe(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:_we;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),ln.group(jh,">>> DRAWING MODEL ".concat(this.id),{collapsed:ln.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const s=Cxe({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:l,unusedTable:o,unusedCount:h}=dF({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:p,count:b}=dF({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});b>0&&ln.log("MISSING UNIFORMS",Object.keys(p))(),h>0&&ln.log("UNUSED UNIFORMS",Object.keys(o))();const x=Ixe(this.vertexArray.configuration);ln.table(e,s)(),ln.table(e,l)(),ln.table(e+1,x)(),i&&i.log({logLevel:jh,message:"Rendered to ".concat(i.id)}),ln.groupEnd(jh)()}}function XS(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!XS(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!XS(t[s],e[s],n-1))return!1;return!0}return!1}class T${static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){on(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&XS(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const s=n[i],l=this.props[i];r[i]=l,s&&s.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof l=="function"&&(r[i]=this.getSubLayerAccessor(l)))}return r}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}}on(T$,"defaultProps",{});on(T$,"extensionName","LayerExtension");const yj=`
uniform DATAFILTER_TYPE filter_min;
uniform DATAFILTER_TYPE filter_softMin;
uniform DATAFILTER_TYPE filter_softMax;
uniform DATAFILTER_TYPE filter_max;
uniform bool filter_useSoftMargin;
uniform bool filter_enabled;
uniform bool filter_transformSize;

#ifdef NON_INSTANCED_MODEL
  #define DATAFILTER_ATTRIB filterValues
  #define DATAFILTER_ATTRIB_64LOW filterValues64Low
#else
  #define DATAFILTER_ATTRIB instanceFilterValues
  #define DATAFILTER_ATTRIB_64LOW instanceFilterValues64Low
#endif

attribute DATAFILTER_TYPE DATAFILTER_ATTRIB;
#ifdef DATAFILTER_DOUBLE
  attribute DATAFILTER_TYPE DATAFILTER_ATTRIB_64LOW;

  uniform DATAFILTER_TYPE filter_min64High;
  uniform DATAFILTER_TYPE filter_max64High;
#endif

varying float dataFilter_value;

float dataFilter_reduceValue(float value) {
  return value;
}
float dataFilter_reduceValue(vec2 value) {
  return min(value.x, value.y);
}
float dataFilter_reduceValue(vec3 value) {
  return min(min(value.x, value.y), value.z);
}
float dataFilter_reduceValue(vec4 value) {
  return min(min(value.x, value.y), min(value.z, value.w));
}
void dataFilter_setValue(DATAFILTER_TYPE valueFromMin, DATAFILTER_TYPE valueFromMax) {
  if (filter_enabled) {
    if (filter_useSoftMargin) {
      dataFilter_value = dataFilter_reduceValue(
        smoothstep(filter_min, filter_softMin, valueFromMin) *
        (1.0 - smoothstep(filter_softMax, filter_max, valueFromMax))
      );
    } else {
      dataFilter_value = dataFilter_reduceValue(
        step(filter_min, valueFromMin) * step(valueFromMax, filter_max)
      );
    }
  } else {
    dataFilter_value = 1.0;
  }
}
`,vj=`
uniform bool filter_transformColor;
varying float dataFilter_value;
`;function _j(t){if(!t||!("extensions"in t))return{};const{filterRange:e=[-1,1],filterEnabled:n=!0,filterTransformSize:r=!0,filterTransformColor:i=!0}=t,s=t.filterSoftRange||e;return{...Number.isFinite(e[0])?{filter_min:e[0],filter_softMin:s[0],filter_softMax:s[1],filter_max:e[1]}:{filter_min:e.map(l=>l[0]),filter_softMin:s.map(l=>l[0]),filter_softMax:s.map(l=>l[1]),filter_max:e.map(l=>l[1])},filter_enabled:n,filter_useSoftMargin:!!t.filterSoftRange,filter_transformSize:n&&r,filter_transformColor:n&&i}}function Twe(t){if(!t||!("extensions"in t))return{};const e=_j(t);if(Number.isFinite(e.filter_min)){const n=Math.fround(e.filter_min);e.filter_min-=n,e.filter_softMin-=n,e.filter_min64High=n;const r=Math.fround(e.filter_max);e.filter_max-=r,e.filter_softMax-=r,e.filter_max64High=r}else{const n=e.filter_min.map(Math.fround);e.filter_min=e.filter_min.map((i,s)=>i-n[s]),e.filter_softMin=e.filter_softMin.map((i,s)=>i-n[s]),e.filter_min64High=n;const r=e.filter_max.map(Math.fround);e.filter_max=e.filter_max.map((i,s)=>i-r[s]),e.filter_softMax=e.filter_softMax.map((i,s)=>i-r[s]),e.filter_max64High=r}return e}const bj={"vs:#main-start":`
    #ifdef DATAFILTER_DOUBLE
      dataFilter_setValue(
        DATAFILTER_ATTRIB - filter_min64High + DATAFILTER_ATTRIB_64LOW,
        DATAFILTER_ATTRIB - filter_max64High + DATAFILTER_ATTRIB_64LOW
      );
    #else
      dataFilter_setValue(DATAFILTER_ATTRIB, DATAFILTER_ATTRIB);
    #endif
  `,"vs:#main-end":`
    if (dataFilter_value == 0.0) {
      gl_Position = vec4(0.);
    }
  `,"vs:DECKGL_FILTER_SIZE":`
    if (filter_transformSize) {
      size = size * dataFilter_value;
    }
  `,"fs:DECKGL_FILTER_COLOR":`
    if (dataFilter_value == 0.0) discard;
    if (filter_transformColor) {
      color.a *= dataFilter_value;
    }
  `},Ewe={name:"data-filter",vs:yj,fs:vj,inject:bj,getUniforms:_j},Swe={name:"data-filter-fp64",vs:yj,fs:vj,inject:bj,getUniforms:Twe},Awe=`#define SHADER_NAME data-filter-vertex-shader

#ifdef FLOAT_TARGET
  attribute float filterIndices;
  attribute float filterPrevIndices;
#else
  attribute vec2 filterIndices;
  attribute vec2 filterPrevIndices;
#endif

varying vec4 vColor;
const float component = 1.0 / 255.0;

void main() {
  #ifdef FLOAT_TARGET
    dataFilter_value *= float(filterIndices != filterPrevIndices);
    gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
    vColor = vec4(0.0, 0.0, 0.0, 1.0);
  #else
    // Float texture is not supported: pack result into 4 channels x 256 px x 64px
    dataFilter_value *= float(filterIndices.x != filterPrevIndices.x);
    float col = filterIndices.x;
    float row = filterIndices.y * 4.0;
    float channel = floor(row);
    row = fract(row);
    vColor = component * vec4(bvec4(channel == 0.0, channel == 1.0, channel == 2.0, channel == 3.0));
    gl_Position = vec4(col * 2.0 - 1.0, row * 2.0 - 1.0, 0.0, 1.0);
  #endif
  gl_PointSize = 1.0;
}
`,Pwe=`#define SHADER_NAME data-filter-fragment-shader
precision highp float;

varying vec4 vColor;

void main() {
  if (dataFilter_value < 0.5) {
    discard;
  }
  gl_FragColor = vColor;
}
`;function Cwe(t){return!!(t.getExtension("EXT_float_blend")&&(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")))}function Lwe(t,e){return e?new La(t,{width:1,height:1,attachments:{[36064]:new y$(t,{format:nr(t)?34836:6408,type:5126,mipmaps:!1})}}):new La(t,{width:256,height:64,depth:!1})}function Iwe(t,e,n){return e.defines.NON_INSTANCED_MODEL=1,n&&(e.defines.FLOAT_TARGET=1),new wwe(t,{id:"data-filter-aggregation-model",vertexCount:1,isInstanced:!1,drawMode:0,vs:Awe,fs:Pwe,...e})}const Rwe={blend:!0,blendFunc:[1,1,1,1],blendEquation:[32774,32774],depthTest:!1},Mwe={getFilterValue:{type:"accessor",value:0},onFilteredItemsChange:{type:"function",value:null,optional:!0},filterEnabled:!0,filterRange:[-1,1],filterSoftRange:null,filterTransformSize:!0,filterTransformColor:!0},wF={1:"float",2:"vec2",3:"vec3",4:"vec4"};class Bg extends T${constructor({filterSize:e=1,fp64:n=!1,countItems:r=!1}={}){if(!wF[e])throw new Error("filterSize out of range");super({filterSize:e,fp64:n,countItems:r})}getShaders(e){const{filterSize:n,fp64:r}=e.opts;return{modules:[r?Swe:Ewe],defines:{DATAFILTER_TYPE:wF[n],DATAFILTER_DOUBLE:!!r}}}initializeState(e,n){const r=this.getAttributeManager();r&&r.add({filterValues:{size:n.opts.filterSize,type:n.opts.fp64?5130:5126,accessor:"getFilterValue",shaderAttributes:{filterValues:{divisor:0},instanceFilterValues:{divisor:1}}}});const{gl:i}=this.context;if(r&&n.opts.countItems){const s=Cwe(i);r.add({filterIndices:{size:s?1:2,vertexOffset:1,type:5121,normalized:!0,accessor:(h,{index:p})=>{const b=h&&h.__source?h.__source.index:p;return s?(b+1)%255:[(b+1)%255,Math.floor(b/255)%255]},shaderAttributes:{filterPrevIndices:{vertexOffset:0},filterIndices:{vertexOffset:1}}}});const l=Lwe(i,s),o=Iwe(i,n.getShaders.call(this,n),s);this.setState({filterFBO:l,filterModel:o})}}updateState({props:e,oldProps:n}){if(this.state.filterModel){const i=this.getAttributeManager().attributes.filterValues.needsUpdate()||e.filterEnabled!==n.filterEnabled||e.filterRange!==n.filterRange||e.filterSoftRange!==n.filterSoftRange;i&&this.setState({filterNeedsUpdate:i})}}draw(e,n){const{filterFBO:r,filterModel:i,filterNeedsUpdate:s}=this.state,{onFilteredItemsChange:l}=this.props;if(s&&l&&i){const{attributes:{filterValues:o,filterIndices:h}}=this.getAttributeManager();i.setVertexCount(this.getNumInstances());const{gl:p}=this.context;v$(p,{framebuffer:r,color:[0,0,0,0]}),i.updateModuleSettings(e.moduleParameters).setAttributes({...o.getShaderAttributes(),...h&&h.getShaderAttributes()}).draw({framebuffer:r,parameters:{...Rwe,viewport:[0,0,r.width,r.height]}});const b=aj(r);let x=0;for(let w=0;w<b.length;w++)x+=b[w];l({id:this.id,count:x}),this.state.filterNeedsUpdate=!1}}finalizeState(){const{filterFBO:e,filterModel:n}=this.state;e&&(e.color.delete(),e.delete(),n.delete())}}on(Bg,"defaultProps",Mwe);on(Bg,"extensionName","DataFilterExtension");var ZS={},$we={get exports(){return ZS},set exports(t){ZS=t}};(function(t,e){(function(n,r){t.exports=r()})(MY,function(){var n,r,i;function s(o,h){if(!n)n=h;else if(!r)r=h;else{var p="var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk);",b={};n(b),i=h(b),typeof window<"u"&&(i.workerUrl=window.URL.createObjectURL(new Blob([p],{type:"text/javascript"})))}}s(["exports"],function(o){var h=p;function p(u,a,d,m){this.cx=3*u,this.bx=3*(d-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(m-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=a,this.p2x=d,this.p2y=m}function b(u,a,d,m){const v=new h(u,a,d,m);return function(T){return v.solve(T)}}p.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,a){if(a===void 0&&(a=1e-6),u<0)return 0;if(u>1)return 1;for(var d=u,m=0;m<8;m++){var v=this.sampleCurveX(d)-u;if(Math.abs(v)<a)return d;var T=this.sampleCurveDerivativeX(d);if(Math.abs(T)<1e-6)break;d-=v/T}var S=0,C=1;for(d=u,m=0;m<20&&(v=this.sampleCurveX(d),!(Math.abs(v-u)<a));m++)u>v?S=d:C=d,d=.5*(C-S)+S;return d},solve:function(u,a){return this.sampleCurveY(this.solveCurveX(u,a))}};const x=b(.25,.1,.25,1);function w(u,a,d){return Math.min(d,Math.max(a,u))}function A(u,a,d){const m=d-a,v=((u-a)%m+m)%m+a;return v===a?d:v}function L(u,...a){for(const d of a)for(const m in d)u[m]=d[m];return u}let M=1;function U(u,a){u.forEach(d=>{a[d]&&(a[d]=a[d].bind(a))})}function D(u,a,d){const m={};for(const v in u)m[v]=a.call(d||this,u[v],v,u);return m}function $(u,a,d){const m={};for(const v in u)a.call(d||this,u[v],v,u)&&(m[v]=u[v]);return m}function N(u){return Array.isArray(u)?u.map(N):typeof u=="object"&&u?D(u,N):u}const B={};function Z(u){B[u]||(typeof console<"u"&&console.warn(u),B[u]=!0)}function ie(u,a,d){return(d.y-u.y)*(a.x-u.x)>(a.y-u.y)*(d.x-u.x)}function re(u){let a=0;for(let d,m,v=0,T=u.length,S=T-1;v<T;S=v++)d=u[v],m=u[S],a+=(m.x-d.x)*(d.y+m.y);return a}function ve(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Te(u){const a={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(d,m,v,T)=>{const S=v||T;return a[m]=!S||S.toLowerCase(),""}),a["max-age"]){const d=parseInt(a["max-age"],10);isNaN(d)?delete a["max-age"]:a["max-age"]=d}return a}let Ae,fe,Pe=null;function _e(u){if(Pe==null){const a=u.navigator?u.navigator.userAgent:null;Pe=!!u.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return Pe}function ke(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}const Vt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(u){const a=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(a)}},getImageData(u,a=0){const d=window.document.createElement("canvas"),m=d.getContext("2d");if(!m)throw new Error("failed to create canvas 2d context");return d.width=u.width,d.height=u.height,m.drawImage(u,0,0,u.width,u.height),m.getImageData(-a,-a,u.width+2*a,u.height+2*a)},resolveURL:u=>(Ae||(Ae=document.createElement("a")),Ae.href=u,Ae.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(fe==null&&(fe=matchMedia("(prefers-reduced-motion: reduce)")),fe.matches)}};var ut=rn;function rn(u,a){this.x=u,this.y=a}rn.prototype={clone:function(){return new rn(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,a){return this.clone()._rotateAround(u,a)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var a=u.x-this.x,d=u.y-this.y;return a*a+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,a){return Math.atan2(this.x*a-this.y*u,this.x*u+this.y*a)},_matMult:function(u){var a=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=a,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var a=Math.cos(u),d=Math.sin(u),m=d*this.x+a*this.y;return this.x=a*this.x-d*this.y,this.y=m,this},_rotateAround:function(u,a){var d=Math.cos(u),m=Math.sin(u),v=a.y+m*(this.x-a.x)+d*(this.y-a.y);return this.x=a.x+d*(this.x-a.x)-m*(this.y-a.y),this.y=v,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},rn.convert=function(u){return u instanceof rn?u:Array.isArray(u)?new rn(u[0],u[1]):u};const ot={MAX_PARALLEL_IMAGE_REQUESTS:16,REGISTERED_PROTOCOLS:{}},yt="mapbox-tiles";let at,Mt,Re=500,Ke=50;function Je(){typeof caches>"u"||at||(at=caches.open(yt))}let kt=1/0;const ft={supported:!1,testSupport:function(u){!lt&&qt&&(tn?Fn(u):Pt=u)}};let Pt,qt,lt=!1,tn=!1;function Fn(u){const a=u.createTexture();u.bindTexture(u.TEXTURE_2D,a);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,qt),u.isContextLost())return;ft.supported=!0}catch{}u.deleteTexture(a),lt=!0}typeof document<"u"&&(qt=document.createElement("img"),qt.onload=function(){Pt&&Fn(Pt),Pt=null,tn=!0},qt.onerror=function(){lt=!0,Pt=null},qt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const St={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(St);class bt extends Error{constructor(a,d,m,v){super(`AJAXError: ${d} (${a}): ${m}`),this.status=a,this.statusText=d,this.url=m,this.body=v}}const hn=ve()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href;function ur(u,a){const d=new AbortController,m=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:hn(),signal:d.signal});let v=!1,T=!1;return u.type==="json"&&m.headers.set("Accept","application/json"),((S,C,I)=>{if(T)return;const F=Date.now();fetch(m).then(j=>j.ok?((W,X,Q)=>{(u.type==="arrayBuffer"?W.arrayBuffer():u.type==="json"?W.json():W.text()).then(ee=>{T||(X&&Q&&function(me,pe,$e){if(Je(),!at)return;const Be={status:pe.status,statusText:pe.statusText,headers:new Headers};pe.headers.forEach((Ne,Ze)=>Be.headers.set(Ze,Ne));const Le=Te(pe.headers.get("Cache-Control")||"");Le["no-store"]||(Le["max-age"]&&Be.headers.set("Expires",new Date($e+1e3*Le["max-age"]).toUTCString()),new Date(Be.headers.get("Expires")).getTime()-$e<42e4||function(Ne,Ze){if(Mt===void 0)try{new Response(new ReadableStream),Mt=!0}catch{Mt=!1}Mt?Ze(Ne.body):Ne.blob().then(Ze)}(pe,Ne=>{const Ze=new Response(Ne,Be);Je(),at&&at.then(Xe=>Xe.put(function(Lt){const Dt=Lt.indexOf("?");return Dt<0?Lt:Lt.slice(0,Dt)}(me.url),Ze)).catch(Xe=>Z(Xe.message))}))}(m,X,Q),v=!0,a(null,ee,W.headers.get("Cache-Control"),W.headers.get("Expires")))}).catch(ee=>{T||a(new Error(ee.message))})})(j,null,F):j.blob().then(W=>a(new bt(j.status,j.statusText,u.url,W)))).catch(j=>{j.code!==20&&a(new Error(j.message))})})(),{cancel:()=>{T=!0,v||d.abort()}}}const On=function(u,a){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){if(ve()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,a);if(!ve()){const m=u.url.substring(0,u.url.indexOf("://"));return(ot.REGISTERED_PROTOCOLS[m]||ur)(u,a)}}if(!(/^file:/.test(d=u.url)||/^file:/.test(hn())&&!/^\w+:/.test(d))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return ur(u,a);if(ve()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,a,void 0,!0)}var d;return function(m,v){const T=new XMLHttpRequest;T.open(m.method||"GET",m.url,!0),m.type==="arrayBuffer"&&(T.responseType="arraybuffer");for(const S in m.headers)T.setRequestHeader(S,m.headers[S]);return m.type==="json"&&(T.responseType="text",T.setRequestHeader("Accept","application/json")),T.withCredentials=m.credentials==="include",T.onerror=()=>{v(new Error(T.statusText))},T.onload=()=>{if((T.status>=200&&T.status<300||T.status===0)&&T.response!==null){let S=T.response;if(m.type==="json")try{S=JSON.parse(T.response)}catch(C){return v(C)}v(null,S,T.getResponseHeader("Cache-Control"),T.getResponseHeader("Expires"))}else{const S=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});v(new bt(T.status,T.statusText,m.url,S))}},T.send(m.body),{cancel:()=>T.abort()}}(u,a)},Ln=function(u,a){return On(L(u,{type:"arrayBuffer"}),a)};function is(u){const a=window.document.createElement("a");return a.href=u,a.protocol===window.document.location.protocol&&a.host===window.document.location.host}const dn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let mr,vn;mr=[],vn=0;const Nr=function(u,a){if(ft.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),vn>=ot.MAX_PARALLEL_IMAGE_REQUESTS){const T={requestParameters:u,callback:a,cancelled:!1,cancel(){this.cancelled=!0}};return mr.push(T),T}vn++;let d=!1;const m=()=>{if(!d)for(d=!0,vn--;mr.length&&vn<ot.MAX_PARALLEL_IMAGE_REQUESTS;){const T=mr.shift(),{requestParameters:S,callback:C,cancelled:I}=T;I||(T.cancel=Nr(S,C).cancel)}},v=Ln(u,(T,S,C,I)=>{m(),T?a(T):S&&function(F,j){typeof createImageBitmap=="function"?function(W,X){const Q=new Blob([new Uint8Array(W)],{type:"image/png"});createImageBitmap(Q).then(ee=>{X(null,ee)}).catch(ee=>{X(new Error(`Could not load image because of ${ee.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(F,j):function(W,X){const Q=new Image;Q.onload=()=>{X(null,Q),URL.revokeObjectURL(Q.src),Q.onload=null,window.requestAnimationFrame(()=>{Q.src=dn})},Q.onerror=()=>X(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const ee=new Blob([new Uint8Array(W)],{type:"image/png"});Q.src=W.byteLength?URL.createObjectURL(ee):dn}(F,j)}(S,(F,j)=>{F!=null?a(F):j!=null&&a(null,j,{cacheControl:C,expires:I})})});return{cancel:()=>{v.cancel(),m()}}};function bs(u,a,d){d[u]&&d[u].indexOf(a)!==-1||(d[u]=d[u]||[],d[u].push(a))}function Cr(u,a,d){if(d&&d[u]){const m=d[u].indexOf(a);m!==-1&&d[u].splice(m,1)}}class ai{constructor(a,d={}){L(this,d),this.type=a}}class ko extends ai{constructor(a,d={}){super("error",L({error:a},d))}}class ss{on(a,d){return this._listeners=this._listeners||{},bs(a,d,this._listeners),this}off(a,d){return Cr(a,d,this._listeners),Cr(a,d,this._oneTimeListeners),this}once(a,d){return this._oneTimeListeners=this._oneTimeListeners||{},bs(a,d,this._oneTimeListeners),this}fire(a,d){typeof a=="string"&&(a=new ai(a,d||{}));const m=a.type;if(this.listens(m)){a.target=this;const v=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const C of v)C.call(this,a);const T=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const C of T)Cr(m,C,this._oneTimeListeners),C.call(this,a);const S=this._eventedParent;S&&(L(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),S.fire(a))}else a instanceof ko&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,d){return this._eventedParent=a,this._eventedParentData=d,this}}var We={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1},elevationOffset:{type:"number",default:450}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class pt{constructor(a,d,m,v){this.message=(a?`${a}: `:"")+m,v&&(this.identifier=v),d!=null&&d.__line__&&(this.line=d.__line__)}}function Vs(u){const a=u.value;return a?[new pt(u.key,a,"constants have been deprecated as of v8")]:[]}function yi(u,...a){for(const d of a)for(const m in d)u[m]=d[m];return u}function fn(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Di(u){if(Array.isArray(u))return u.map(Di);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const a={};for(const d in u)a[d]=Di(u[d]);return a}return fn(u)}class Ai extends Error{constructor(a,d){super(d),this.message=d,this.key=a}}class De{constructor(a,d=[]){this.parent=a,this.bindings={};for(const[m,v]of d)this.bindings[m]=v}concat(a){return new De(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}const Ie={kind:"null"},Me={kind:"number"},Qe={kind:"string"},Ye={kind:"boolean"},vt={kind:"color"},Kt={kind:"object"},st={kind:"value"},jt={kind:"collator"},Xt={kind:"formatted"},Gn={kind:"padding"},Mn={kind:"resolvedImage"};function $n(u,a){return{kind:"array",itemType:u,N:a}}function un(u){if(u.kind==="array"){const a=un(u.itemType);return typeof u.N=="number"?`array<${a}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${a}>`}return u.kind}const Qr=[Ie,Me,Qe,Ye,vt,Xt,Kt,$n(st),Gn,Mn];function li(u,a){if(a.kind==="error")return null;if(u.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!li(u.itemType,a.itemType))&&(typeof u.N!="number"||u.N===a.N))return null}else{if(u.kind===a.kind)return null;if(u.kind==="value"){for(const d of Qr)if(!li(d,a))return null}}return`Expected ${un(u)} but found ${un(a)} instead.`}function Pi(u,a){return a.some(d=>d.kind===u.kind)}function Ki(u,a){return a.some(d=>d==="null"?u===null:d==="array"?Array.isArray(u):d==="object"?u&&!Array.isArray(u)&&typeof u=="object":d===typeof u)}var os,Oo={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ae(u){return(u=Math.round(u))<0?0:u>255?255:u}function V(u){return ae(u[u.length-1]==="%"?parseFloat(u)/100*255:parseInt(u))}function H(u){return(a=u[u.length-1]==="%"?parseFloat(u)/100:parseFloat(u))<0?0:a>1?1:a;var a}function ne(u,a,d){return d<0?d+=1:d>1&&(d-=1),6*d<1?u+(a-u)*d*6:2*d<1?a:3*d<2?u+(a-u)*(2/3-d)*6:u}try{os={}.parseCSSColor=function(u){var a,d=u.replace(/ /g,"").toLowerCase();if(d in Oo)return Oo[d].slice();if(d[0]==="#")return d.length===4?(a=parseInt(d.substr(1),16))>=0&&a<=4095?[(3840&a)>>4|(3840&a)>>8,240&a|(240&a)>>4,15&a|(15&a)<<4,1]:null:d.length===7&&(a=parseInt(d.substr(1),16))>=0&&a<=16777215?[(16711680&a)>>16,(65280&a)>>8,255&a,1]:null;var m=d.indexOf("("),v=d.indexOf(")");if(m!==-1&&v+1===d.length){var T=d.substr(0,m),S=d.substr(m+1,v-(m+1)).split(","),C=1;switch(T){case"rgba":if(S.length!==4)return null;C=H(S.pop());case"rgb":return S.length!==3?null:[V(S[0]),V(S[1]),V(S[2]),C];case"hsla":if(S.length!==4)return null;C=H(S.pop());case"hsl":if(S.length!==3)return null;var I=(parseFloat(S[0])%360+360)%360/360,F=H(S[1]),j=H(S[2]),W=j<=.5?j*(F+1):j+F-j*F,X=2*j-W;return[ae(255*ne(X,W,I+1/3)),ae(255*ne(X,W,I)),ae(255*ne(X,W,I-1/3)),C];default:return null}}return null}}catch{}class se{constructor(a,d,m,v=1){this.r=a,this.g=d,this.b=m,this.a=v}static parse(a){if(!a)return;if(a instanceof se)return a;if(typeof a!="string")return;const d=os(a);return d?new se(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3]):void 0}toString(){const[a,d,m,v]=this.toArray();return`rgba(${Math.round(a)},${Math.round(d)},${Math.round(m)},${v})`}toArray(){const{r:a,g:d,b:m,a:v}=this;return v===0?[0,0,0,0]:[255*a/v,255*d/v,255*m/v,v]}}se.black=new se(0,0,0,1),se.white=new se(1,1,1,1),se.transparent=new se(0,0,0,0),se.red=new se(1,0,0,1);class ye{constructor(a,d,m){this.sensitivity=a?d?"variant":"case":d?"accent":"base",this.locale=m,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,d){return this.collator.compare(a,d)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ee{constructor(a,d,m,v,T){this.text=a,this.image=d,this.scale=m,this.fontStack=v,this.textColor=T}}class xe{constructor(a){this.sections=a}static fromString(a){return new xe([new Ee(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof xe?a:xe.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class ge{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof ge)return a;if(typeof a=="number")return new ge([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(const d of a)if(typeof d!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new ge(a)}}toString(){return JSON.stringify(this.values)}}class Se{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Se({name:a,available:!1}):null}}function je(u,a,d,m){return typeof u=="number"&&u>=0&&u<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof d=="number"&&d>=0&&d<=255?m===void 0||typeof m=="number"&&m>=0&&m<=1?null:`Invalid rgba value [${[u,a,d,m].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof m=="number"?[u,a,d,m]:[u,a,d]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function et(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof se||u instanceof ye||u instanceof xe||u instanceof ge||u instanceof Se)return!0;if(Array.isArray(u)){for(const a of u)if(!et(a))return!1;return!0}if(typeof u=="object"){for(const a in u)if(!et(u[a]))return!1;return!0}return!1}function Ve(u){if(u===null)return Ie;if(typeof u=="string")return Qe;if(typeof u=="boolean")return Ye;if(typeof u=="number")return Me;if(u instanceof se)return vt;if(u instanceof ye)return jt;if(u instanceof xe)return Xt;if(u instanceof ge)return Gn;if(u instanceof Se)return Mn;if(Array.isArray(u)){const a=u.length;let d;for(const m of u){const v=Ve(m);if(d){if(d===v)continue;d=st;break}d=v}return $n(d||st,a)}return Kt}function It(u){const a=typeof u;return u===null?"":a==="string"||a==="number"||a==="boolean"?String(u):u instanceof se||u instanceof xe||u instanceof ge||u instanceof Se?u.toString():JSON.stringify(u)}class Ot{constructor(a,d){this.type=a,this.value=d}static parse(a,d){if(a.length!==2)return d.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!et(a[1]))return d.error("invalid value");const m=a[1];let v=Ve(m);const T=d.expectedType;return v.kind!=="array"||v.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(v=T),new Ot(v,m)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class xt{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}}const Gt={string:Qe,number:Me,boolean:Ye,object:Kt};class zt{constructor(a,d){this.type=a,this.args=d}static parse(a,d){if(a.length<2)return d.error("Expected at least one argument.");let m,v=1;const T=a[0];if(T==="array"){let C,I;if(a.length>2){const F=a[1];if(typeof F!="string"||!(F in Gt)||F==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);C=Gt[F],v++}else C=st;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return d.error('The length argument to "array" must be a positive integer literal',2);I=a[2],v++}m=$n(C,I)}else{if(!Gt[T])throw new Error(`Types doesn't contain name = ${T}`);m=Gt[T]}const S=[];for(;v<a.length;v++){const C=d.parse(a[v],v,st);if(!C)return null;S.push(C)}return new zt(m,S)}evaluate(a){for(let d=0;d<this.args.length;d++){const m=this.args[d].evaluate(a);if(!li(this.type,Ve(m)))return m;if(d===this.args.length-1)throw new xt(`Expected value to be of type ${un(this.type)}, but found ${un(Ve(m))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const pn={"to-boolean":Ye,"to-color":vt,"to-number":Me,"to-string":Qe};class Zt{constructor(a,d){this.type=a,this.args=d}static parse(a,d){if(a.length<2)return d.error("Expected at least one argument.");const m=a[0];if(!pn[m])throw new Error(`Can't parse ${m} as it is not part of the known types`);if((m==="to-boolean"||m==="to-string")&&a.length!==2)return d.error("Expected one argument.");const v=pn[m],T=[];for(let S=1;S<a.length;S++){const C=d.parse(a[S],S,st);if(!C)return null;T.push(C)}return new Zt(v,T)}evaluate(a){if(this.type.kind==="boolean")return!!this.args[0].evaluate(a);if(this.type.kind==="color"){let d,m;for(const v of this.args){if(d=v.evaluate(a),m=null,d instanceof se)return d;if(typeof d=="string"){const T=a.parseColor(d);if(T)return T}else if(Array.isArray(d)&&(m=d.length<3||d.length>4?`Invalid rbga value ${JSON.stringify(d)}: expected an array containing either three or four numeric values.`:je(d[0],d[1],d[2],d[3]),!m))return new se(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new xt(m||`Could not parse color from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}if(this.type.kind==="padding"){let d;for(const m of this.args){d=m.evaluate(a);const v=ge.parse(d);if(v)return v}throw new xt(`Could not parse padding from value '${typeof d=="string"?d:JSON.stringify(d)}'`)}if(this.type.kind==="number"){let d=null;for(const m of this.args){if(d=m.evaluate(a),d===null)return 0;const v=Number(d);if(!isNaN(v))return v}throw new xt(`Could not convert ${JSON.stringify(d)} to number.`)}return this.type.kind==="formatted"?xe.fromString(It(this.args[0].evaluate(a))):this.type.kind==="resolvedImage"?Se.fromString(It(this.args[0].evaluate(a))):It(this.args[0].evaluate(a))}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}const nn=["Unknown","Point","LineString","Polygon"];class _n{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?nn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let d=this._parseColorCache[a];return d||(d=this._parseColorCache[a]=se.parse(a)),d}}class En{constructor(a,d,m,v){this.name=a,this.type=d,this._evaluate=m,this.args=v}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,d){const m=a[0],v=En.definitions[m];if(!v)return d.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0);const T=Array.isArray(v)?v[0]:v.type,S=Array.isArray(v)?[[v[1],v[2]]]:v.overloads,C=S.filter(([F])=>!Array.isArray(F)||F.length===a.length-1);let I=null;for(const[F,j]of C){I=new rt(d.registry,d.path,null,d.scope);const W=[];let X=!1;for(let Q=1;Q<a.length;Q++){const ee=a[Q],me=Array.isArray(F)?F[Q-1]:F.type,pe=I.parse(ee,1+W.length,me);if(!pe){X=!0;break}W.push(pe)}if(!X)if(Array.isArray(F)&&F.length!==W.length)I.error(`Expected ${F.length} arguments, but found ${W.length} instead.`);else{for(let Q=0;Q<W.length;Q++){const ee=Array.isArray(F)?F[Q]:F.type,me=W[Q];I.concat(Q+1).checkSubtype(ee,me.type)}if(I.errors.length===0)return new En(m,T,j,W)}}if(C.length===1)d.errors.push(...I.errors);else{const F=(C.length?C:S).map(([W])=>{return X=W,Array.isArray(X)?`(${X.map(un).join(", ")})`:`(${un(X.type)}...)`;var X}).join(" | "),j=[];for(let W=1;W<a.length;W++){const X=d.parse(a[W],1+j.length);if(!X)return null;j.push(un(X.type))}d.error(`Expected arguments of type ${F}, but found (${j.join(", ")}) instead.`)}return null}static register(a,d){En.definitions=d;for(const m in d)a[m]=En}}class ir{constructor(a,d,m){this.type=jt,this.locale=m,this.caseSensitive=a,this.diacriticSensitive=d}static parse(a,d){if(a.length!==2)return d.error("Expected one argument.");const m=a[1];if(typeof m!="object"||Array.isArray(m))return d.error("Collator options argument must be an object.");const v=d.parse(m["case-sensitive"]!==void 0&&m["case-sensitive"],1,Ye);if(!v)return null;const T=d.parse(m["diacritic-sensitive"]!==void 0&&m["diacritic-sensitive"],1,Ye);if(!T)return null;let S=null;return m.locale&&(S=d.parse(m.locale,1,Qe),!S)?null:new ir(v,T,S)}evaluate(a){return new ye(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}const sr=8192;function ci(u,a){u[0]=Math.min(u[0],a[0]),u[1]=Math.min(u[1],a[1]),u[2]=Math.max(u[2],a[0]),u[3]=Math.max(u[3],a[1])}function oo(u,a){return!(u[0]<=a[0]||u[2]>=a[2]||u[1]<=a[1]||u[3]>=a[3])}function Ci(u,a){const d=(180+u[0])/360,m=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,v=Math.pow(2,a.z);return[Math.round(d*v*sr),Math.round(m*v*sr)]}function zn(u,a,d){const m=u[0]-a[0],v=u[1]-a[1],T=u[0]-d[0],S=u[1]-d[1];return m*S-T*v==0&&m*T<=0&&v*S<=0}function pl(u,a){let d=!1;for(let S=0,C=a.length;S<C;S++){const I=a[S];for(let F=0,j=I.length;F<j-1;F++){if(zn(u,I[F],I[F+1]))return!1;(v=I[F])[1]>(m=u)[1]!=(T=I[F+1])[1]>m[1]&&m[0]<(T[0]-v[0])*(m[1]-v[1])/(T[1]-v[1])+v[0]&&(d=!d)}}var m,v,T;return d}function ml(u,a){for(let d=0;d<a.length;d++)if(pl(u,a[d]))return!0;return!1}function fc(u,a,d,m){const v=m[0]-d[0],T=m[1]-d[1],S=(u[0]-d[0])*T-v*(u[1]-d[1]),C=(a[0]-d[0])*T-v*(a[1]-d[1]);return S>0&&C<0||S<0&&C>0}function pc(u,a,d){for(const F of d)for(let j=0;j<F.length-1;++j)if((C=[(S=F[j+1])[0]-(T=F[j])[0],S[1]-T[1]])[0]*(I=[(v=a)[0]-(m=u)[0],v[1]-m[1]])[1]-C[1]*I[0]!=0&&fc(m,v,T,S)&&fc(T,S,m,v))return!0;var m,v,T,S,C,I;return!1}function ka(u,a){for(let d=0;d<u.length;++d)if(!pl(u[d],a))return!1;for(let d=0;d<u.length-1;++d)if(pc(u[d],u[d+1],a))return!1;return!0}function ao(u,a){for(let d=0;d<a.length;d++)if(ka(u,a[d]))return!0;return!1}function mc(u,a,d){const m=[];for(let v=0;v<u.length;v++){const T=[];for(let S=0;S<u[v].length;S++){const C=Ci(u[v][S],d);ci(a,C),T.push(C)}m.push(T)}return m}function gc(u,a,d){const m=[];for(let v=0;v<u.length;v++){const T=mc(u[v],a,d);m.push(T)}return m}function yc(u,a,d,m){if(u[0]<d[0]||u[0]>d[2]){const v=.5*m;let T=u[0]-d[0]>v?-m:d[0]-u[0]>v?m:0;T===0&&(T=u[0]-d[2]>v?-m:d[2]-u[0]>v?m:0),u[0]+=T}ci(a,u)}function Lu(u,a,d,m){const v=Math.pow(2,m.z)*sr,T=[m.x*sr,m.y*sr],S=[];for(const C of u)for(const I of C){const F=[I.x+T[0],I.y+T[1]];yc(F,a,d,v),S.push(F)}return S}function sh(u,a,d,m){const v=Math.pow(2,m.z)*sr,T=[m.x*sr,m.y*sr],S=[];for(const I of u){const F=[];for(const j of I){const W=[j.x+T[0],j.y+T[1]];ci(a,W),F.push(W)}S.push(F)}if(a[2]-a[0]<=v/2){(C=a)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const I of S)for(const F of I)yc(F,a,d,v)}var C;return S}class na{constructor(a,d){this.type=Ye,this.geojson=a,this.geometries=d}static parse(a,d){if(a.length!==2)return d.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(et(a[1])){const m=a[1];if(m.type==="FeatureCollection")for(let v=0;v<m.features.length;++v){const T=m.features[v].geometry.type;if(T==="Polygon"||T==="MultiPolygon")return new na(m,m.features[v].geometry)}else if(m.type==="Feature"){const v=m.geometry.type;if(v==="Polygon"||v==="MultiPolygon")return new na(m,m.geometry)}else if(m.type==="Polygon"||m.type==="MultiPolygon")return new na(m,m)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(d,m){const v=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=d.canonicalID();if(m.type==="Polygon"){const C=mc(m.coordinates,T,S),I=Lu(d.geometry(),v,T,S);if(!oo(v,T))return!1;for(const F of I)if(!pl(F,C))return!1}if(m.type==="MultiPolygon"){const C=gc(m.coordinates,T,S),I=Lu(d.geometry(),v,T,S);if(!oo(v,T))return!1;for(const F of I)if(!ml(F,C))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(d,m){const v=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],S=d.canonicalID();if(m.type==="Polygon"){const C=mc(m.coordinates,T,S),I=sh(d.geometry(),v,T,S);if(!oo(v,T))return!1;for(const F of I)if(!ka(F,C))return!1}if(m.type==="MultiPolygon"){const C=gc(m.coordinates,T,S),I=sh(d.geometry(),v,T,S);if(!oo(v,T))return!1;for(const F of I)if(!ao(F,C))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}function J(u){if(u instanceof En&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof na)return!1;let a=!0;return u.eachChild(d=>{a&&!J(d)&&(a=!1)}),a}function oe(u){if(u instanceof En&&u.name==="feature-state")return!1;let a=!0;return u.eachChild(d=>{a&&!oe(d)&&(a=!1)}),a}function be(u,a){if(u instanceof En&&a.indexOf(u.name)>=0)return!1;let d=!0;return u.eachChild(m=>{d&&!be(m,a)&&(d=!1)}),d}class Ue{constructor(a,d){this.type=d.type,this.name=a,this.boundExpression=d}static parse(a,d){if(a.length!==2||typeof a[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");const m=a[1];return d.scope.has(m)?new Ue(m,d.scope.get(m)):d.error(`Unknown variable "${m}". Make sure "${m}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class rt{constructor(a,d=[],m,v=new De,T=[]){this.registry=a,this.path=d,this.key=d.map(S=>`[${S}]`).join(""),this.scope=v,this.errors=T,this.expectedType=m}parse(a,d,m,v,T={}){return d?this.concat(d,m,v)._parse(a,T):this._parse(a,T)}_parse(a,d){function m(v,T,S){return S==="assert"?new zt(T,[v]):S==="coerce"?new Zt(T,[v]):v}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const v=a[0];if(typeof v!="string")return this.error(`Expression name must be a string, but found ${typeof v} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const T=this.registry[v];if(T){let S=T.parse(a,this);if(!S)return null;if(this.expectedType){const C=this.expectedType,I=S.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||I.kind!=="value")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string")if(C.kind!=="padding"||I.kind!=="value"&&I.kind!=="number"&&I.kind!=="array"){if(this.checkSubtype(C,I))return null}else S=m(S,C,d.typeAnnotation||"coerce");else S=m(S,C,d.typeAnnotation||"coerce");else S=m(S,C,d.typeAnnotation||"assert")}if(!(S instanceof Ot)&&S.type.kind!=="resolvedImage"&&$t(S)){const C=new _n;try{S=new Ot(S.type,S.evaluate(C))}catch(I){return this.error(I.message),null}}return S}return this.error(`Unknown expression "${v}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,d,m){const v=typeof a=="number"?this.path.concat(a):this.path,T=m?this.scope.concat(m):this.scope;return new rt(this.registry,v,d||null,T,this.errors)}error(a,...d){const m=`${this.key}${d.map(v=>`[${v}]`).join("")}`;this.errors.push(new Ai(m,a))}checkSubtype(a,d){const m=li(a,d);return m&&this.error(m),m}}function $t(u){if(u instanceof Ue)return $t(u.boundExpression);if(u instanceof En&&u.name==="error"||u instanceof ir||u instanceof na)return!1;const a=u instanceof Zt||u instanceof zt;let d=!0;return u.eachChild(m=>{d=a?d&&$t(m):d&&m instanceof Ot}),!!d&&J(u)&&be(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function bn(u,a){const d=u.length-1;let m,v,T=0,S=d,C=0;for(;T<=S;)if(C=Math.floor((T+S)/2),m=u[C],v=u[C+1],m<=a){if(C===d||a<v)return C;T=C+1}else{if(!(m>a))throw new xt("Input is not a number.");S=C-1}return 0}class xr{constructor(a,d,m){this.type=a,this.input=d,this.labels=[],this.outputs=[];for(const[v,T]of m)this.labels.push(v),this.outputs.push(T)}static parse(a,d){if(a.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return d.error("Expected an even number of arguments.");const m=d.parse(a[1],1,Me);if(!m)return null;const v=[];let T=null;d.expectedType&&d.expectedType.kind!=="value"&&(T=d.expectedType);for(let S=1;S<a.length;S+=2){const C=S===1?-1/0:a[S],I=a[S+1],F=S,j=S+1;if(typeof C!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(v.length&&v[v.length-1][0]>=C)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',F);const W=d.parse(I,j,T);if(!W)return null;T=T||W.type,v.push([C,W])}return new xr(T,m,v)}evaluate(a){const d=this.labels,m=this.outputs;if(d.length===1)return m[0].evaluate(a);const v=this.input.evaluate(a);if(v<=d[0])return m[0].evaluate(a);const T=d.length;return v>=d[T-1]?m[T-1].evaluate(a):m[bn(d,v)].evaluate(a)}eachChild(a){a(this.input);for(const d of this.outputs)a(d)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function mn(u,a,d){return u*(1-d)+a*d}var Gr=Object.freeze({__proto__:null,number:mn,color:function(u,a,d){return new se(mn(u.r,a.r,d),mn(u.g,a.g,d),mn(u.b,a.b,d),mn(u.a,a.a,d))},array:function(u,a,d){return u.map((m,v)=>mn(m,a[v],d))},padding:function(u,a,d){const m=u.values,v=a.values;return new ge([mn(m[0],v[0],d),mn(m[1],v[1],d),mn(m[2],v[2],d),mn(m[3],v[3],d)])}});const xs=.95047,c0=1.08883,Op=4/29,oh=6/29,u0=3*oh*oh,Bx=Math.PI/180,Ux=180/Math.PI;function Dp(u){return u>.008856451679035631?Math.pow(u,1/3):u/u0+Op}function Fp(u){return u>oh?u*u*u:u0*(u-Op)}function Np(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function zp(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Wn(u){const a=zp(u.r),d=zp(u.g),m=zp(u.b),v=Dp((.4124564*a+.3575761*d+.1804375*m)/xs),T=Dp((.2126729*a+.7151522*d+.072175*m)/1);return{l:116*T-16,a:500*(v-T),b:200*(T-Dp((.0193339*a+.119192*d+.9503041*m)/c0)),alpha:u.a}}function d0(u){let a=(u.l+16)/116,d=isNaN(u.a)?a:a+u.a/500,m=isNaN(u.b)?a:a-u.b/200;return a=1*Fp(a),d=xs*Fp(d),m=c0*Fp(m),new se(Np(3.2404542*d-1.5371385*a-.4985314*m),Np(-.969266*d+1.8760108*a+.041556*m),Np(.0556434*d-.2040259*a+1.0572252*m),u.alpha)}function Vx(u,a,d){const m=a-u;return u+d*(m>180||m<-180?m-360*Math.round(m/360):m)}const Iu={forward:Wn,reverse:d0,interpolate:function(u,a,d){return{l:mn(u.l,a.l,d),a:mn(u.a,a.a,d),b:mn(u.b,a.b,d),alpha:mn(u.alpha,a.alpha,d)}}},Ru={forward:function(u){const{l:a,a:d,b:m}=Wn(u),v=Math.atan2(m,d)*Ux;return{h:v<0?v+360:v,c:Math.sqrt(d*d+m*m),l:a,alpha:u.a}},reverse:function(u){const a=u.h*Bx,d=u.c;return d0({l:u.l,a:Math.cos(a)*d,b:Math.sin(a)*d,alpha:u.alpha})},interpolate:function(u,a,d){return{h:Vx(u.h,a.h,d),c:mn(u.c,a.c,d),l:mn(u.l,a.l,d),alpha:mn(u.alpha,a.alpha,d)}}};var h0=Object.freeze({__proto__:null,lab:Iu,hcl:Ru});class ws{constructor(a,d,m,v,T){this.type=a,this.operator=d,this.interpolation=m,this.input=v,this.labels=[],this.outputs=[];for(const[S,C]of T)this.labels.push(S),this.outputs.push(C)}static interpolationFactor(a,d,m,v){let T=0;if(a.name==="exponential")T=Bp(d,a.base,m,v);else if(a.name==="linear")T=Bp(d,1,m,v);else if(a.name==="cubic-bezier"){const S=a.controlPoints;T=new h(S[0],S[1],S[2],S[3]).solve(Bp(d,1,m,v))}return T}static parse(a,d){let[m,v,T,...S]=a;if(!Array.isArray(v)||v.length===0)return d.error("Expected an interpolation type expression.",1);if(v[0]==="linear")v={name:"linear"};else if(v[0]==="exponential"){const F=v[1];if(typeof F!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);v={name:"exponential",base:F}}else{if(v[0]!=="cubic-bezier")return d.error(`Unknown interpolation type ${String(v[0])}`,1,0);{const F=v.slice(1);if(F.length!==4||F.some(j=>typeof j!="number"||j<0||j>1))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);v={name:"cubic-bezier",controlPoints:F}}}if(a.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(T=d.parse(T,2,Me),!T)return null;const C=[];let I=null;m==="interpolate-hcl"||m==="interpolate-lab"?I=vt:d.expectedType&&d.expectedType.kind!=="value"&&(I=d.expectedType);for(let F=0;F<S.length;F+=2){const j=S[F],W=S[F+1],X=F+3,Q=F+4;if(typeof j!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',X);if(C.length&&C[C.length-1][0]>=j)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',X);const ee=d.parse(W,Q,I);if(!ee)return null;I=I||ee.type,C.push([j,ee])}return I.kind==="number"||I.kind==="color"||I.kind==="padding"||I.kind==="array"&&I.itemType.kind==="number"&&typeof I.N=="number"?new ws(I,m,v,T,C):d.error(`Type ${un(I)} is not interpolatable.`)}evaluate(a){const d=this.labels,m=this.outputs;if(d.length===1)return m[0].evaluate(a);const v=this.input.evaluate(a);if(v<=d[0])return m[0].evaluate(a);const T=d.length;if(v>=d[T-1])return m[T-1].evaluate(a);const S=bn(d,v),C=ws.interpolationFactor(this.interpolation,v,d[S],d[S+1]),I=m[S].evaluate(a),F=m[S+1].evaluate(a);return this.operator==="interpolate"?Gr[this.type.kind.toLowerCase()](I,F,C):this.operator==="interpolate-hcl"?Ru.reverse(Ru.interpolate(Ru.forward(I),Ru.forward(F),C)):Iu.reverse(Iu.interpolate(Iu.forward(I),Iu.forward(F),C))}eachChild(a){a(this.input);for(const d of this.outputs)a(d)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function Bp(u,a,d,m){const v=m-d,T=u-d;return v===0?0:a===1?T/v:(Math.pow(a,T)-1)/(Math.pow(a,v)-1)}class ah{constructor(a,d){this.type=a,this.args=d}static parse(a,d){if(a.length<2)return d.error("Expectected at least one argument.");let m=null;const v=d.expectedType;v&&v.kind!=="value"&&(m=v);const T=[];for(const C of a.slice(1)){const I=d.parse(C,1+T.length,m,void 0,{typeAnnotation:"omit"});if(!I)return null;m=m||I.type,T.push(I)}if(!m)throw new Error("No output type");const S=v&&T.some(C=>li(v,C.type));return new ah(S?st:m,T)}evaluate(a){let d,m=null,v=0;for(const T of this.args)if(v++,m=T.evaluate(a),m&&m instanceof Se&&!m.available&&(d||(d=m.name),m=null,v===this.args.length&&(m=d)),m!==null)break;return m}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}class lh{constructor(a,d){this.type=d.type,this.bindings=[].concat(a),this.result=d}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(const d of this.bindings)a(d[1]);a(this.result)}static parse(a,d){if(a.length<4)return d.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);const m=[];for(let T=1;T<a.length-1;T+=2){const S=a[T];if(typeof S!="string")return d.error(`Expected string, but found ${typeof S} instead.`,T);if(/[^a-zA-Z0-9_]/.test(S))return d.error("Variable names must contain only alphanumeric characters or '_'.",T);const C=d.parse(a[T+1],T+1);if(!C)return null;m.push([S,C])}const v=d.parse(a[a.length-1],a.length-1,d.expectedType,m);return v?new lh(m,v):null}outputDefined(){return this.result.outputDefined()}}class Up{constructor(a,d,m){this.type=a,this.index=d,this.input=m}static parse(a,d){if(a.length!==3)return d.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const m=d.parse(a[1],1,Me),v=d.parse(a[2],2,$n(d.expectedType||st));return m&&v?new Up(v.type.itemType,m,v):null}evaluate(a){const d=this.index.evaluate(a),m=this.input.evaluate(a);if(d<0)throw new xt(`Array index out of bounds: ${d} < 0.`);if(d>=m.length)throw new xt(`Array index out of bounds: ${d} > ${m.length-1}.`);if(d!==Math.floor(d))throw new xt(`Array index must be an integer, but found ${d} instead.`);return m[d]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class Vp{constructor(a,d){this.type=Ye,this.needle=a,this.haystack=d}static parse(a,d){if(a.length!==3)return d.error(`Expected 2 arguments, but found ${a.length-1} instead.`);const m=d.parse(a[1],1,st),v=d.parse(a[2],2,st);return m&&v?Pi(m.type,[Ye,Qe,Me,Ie,st])?new Vp(m,v):d.error(`Expected first argument to be of type boolean, string, number or null, but found ${un(m.type)} instead`):null}evaluate(a){const d=this.needle.evaluate(a),m=this.haystack.evaluate(a);if(!m)return!1;if(!Ki(d,["boolean","string","number","null"]))throw new xt(`Expected first argument to be of type boolean, string, number or null, but found ${un(Ve(d))} instead.`);if(!Ki(m,["string","array"]))throw new xt(`Expected second argument to be of type array or string, but found ${un(Ve(m))} instead.`);return m.indexOf(d)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class ch{constructor(a,d,m){this.type=Me,this.needle=a,this.haystack=d,this.fromIndex=m}static parse(a,d){if(a.length<=2||a.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const m=d.parse(a[1],1,st),v=d.parse(a[2],2,st);if(!m||!v)return null;if(!Pi(m.type,[Ye,Qe,Me,Ie,st]))return d.error(`Expected first argument to be of type boolean, string, number or null, but found ${un(m.type)} instead`);if(a.length===4){const T=d.parse(a[3],3,Me);return T?new ch(m,v,T):null}return new ch(m,v)}evaluate(a){const d=this.needle.evaluate(a),m=this.haystack.evaluate(a);if(!Ki(d,["boolean","string","number","null"]))throw new xt(`Expected first argument to be of type boolean, string, number or null, but found ${un(Ve(d))} instead.`);if(!Ki(m,["string","array"]))throw new xt(`Expected second argument to be of type array or string, but found ${un(Ve(m))} instead.`);if(this.fromIndex){const v=this.fromIndex.evaluate(a);return m.indexOf(d,v)}return m.indexOf(d)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class jp{constructor(a,d,m,v,T,S){this.inputType=a,this.type=d,this.input=m,this.cases=v,this.outputs=T,this.otherwise=S}static parse(a,d){if(a.length<5)return d.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return d.error("Expected an even number of arguments.");let m,v;d.expectedType&&d.expectedType.kind!=="value"&&(v=d.expectedType);const T={},S=[];for(let F=2;F<a.length-1;F+=2){let j=a[F];const W=a[F+1];Array.isArray(j)||(j=[j]);const X=d.concat(F);if(j.length===0)return X.error("Expected at least one branch label.");for(const ee of j){if(typeof ee!="number"&&typeof ee!="string")return X.error("Branch labels must be numbers or strings.");if(typeof ee=="number"&&Math.abs(ee)>Number.MAX_SAFE_INTEGER)return X.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ee=="number"&&Math.floor(ee)!==ee)return X.error("Numeric branch labels must be integer values.");if(m){if(X.checkSubtype(m,Ve(ee)))return null}else m=Ve(ee);if(T[String(ee)]!==void 0)return X.error("Branch labels must be unique.");T[String(ee)]=S.length}const Q=d.parse(W,F,v);if(!Q)return null;v=v||Q.type,S.push(Q)}const C=d.parse(a[1],1,st);if(!C)return null;const I=d.parse(a[a.length-1],a.length-1,v);return I?C.type.kind!=="value"&&d.concat(1).checkSubtype(m,C.type)?null:new jp(m,v,C,T,S,I):null}evaluate(a){const d=this.input.evaluate(a);return(Ve(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class Gp{constructor(a,d,m){this.type=a,this.branches=d,this.otherwise=m}static parse(a,d){if(a.length<4)return d.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return d.error("Expected an odd number of arguments.");let m;d.expectedType&&d.expectedType.kind!=="value"&&(m=d.expectedType);const v=[];for(let S=1;S<a.length-1;S+=2){const C=d.parse(a[S],S,Ye);if(!C)return null;const I=d.parse(a[S+1],S+1,m);if(!I)return null;v.push([C,I]),m=m||I.type}const T=d.parse(a[a.length-1],a.length-1,m);if(!T)return null;if(!m)throw new Error("Can't infer output type");return new Gp(m,v,T)}evaluate(a){for(const[d,m]of this.branches)if(d.evaluate(a))return m.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(const[d,m]of this.branches)a(d),a(m);a(this.otherwise)}outputDefined(){return this.branches.every(([a,d])=>d.outputDefined())&&this.otherwise.outputDefined()}}class uh{constructor(a,d,m,v){this.type=a,this.input=d,this.beginIndex=m,this.endIndex=v}static parse(a,d){if(a.length<=2||a.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);const m=d.parse(a[1],1,st),v=d.parse(a[2],2,Me);if(!m||!v)return null;if(!Pi(m.type,[$n(st),Qe,st]))return d.error(`Expected first argument to be of type array or string, but found ${un(m.type)} instead`);if(a.length===4){const T=d.parse(a[3],3,Me);return T?new uh(m.type,m,v,T):null}return new uh(m.type,m,v)}evaluate(a){const d=this.input.evaluate(a),m=this.beginIndex.evaluate(a);if(!Ki(d,["string","array"]))throw new xt(`Expected first argument to be of type array or string, but found ${un(Ve(d))} instead.`);if(this.endIndex){const v=this.endIndex.evaluate(a);return d.slice(m,v)}return d.slice(m)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function f0(u,a){return u==="=="||u==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function p0(u,a,d,m){return m.compare(a,d)===0}function vc(u,a,d){const m=u!=="=="&&u!=="!=";return class xj{constructor(T,S,C){this.type=Ye,this.lhs=T,this.rhs=S,this.collator=C,this.hasUntypedArgument=T.type.kind==="value"||S.type.kind==="value"}static parse(T,S){if(T.length!==3&&T.length!==4)return S.error("Expected two or three arguments.");const C=T[0];let I=S.parse(T[1],1,st);if(!I)return null;if(!f0(C,I.type))return S.concat(1).error(`"${C}" comparisons are not supported for type '${un(I.type)}'.`);let F=S.parse(T[2],2,st);if(!F)return null;if(!f0(C,F.type))return S.concat(2).error(`"${C}" comparisons are not supported for type '${un(F.type)}'.`);if(I.type.kind!==F.type.kind&&I.type.kind!=="value"&&F.type.kind!=="value")return S.error(`Cannot compare types '${un(I.type)}' and '${un(F.type)}'.`);m&&(I.type.kind==="value"&&F.type.kind!=="value"?I=new zt(F.type,[I]):I.type.kind!=="value"&&F.type.kind==="value"&&(F=new zt(I.type,[F])));let j=null;if(T.length===4){if(I.type.kind!=="string"&&F.type.kind!=="string"&&I.type.kind!=="value"&&F.type.kind!=="value")return S.error("Cannot use collator to compare non-string types.");if(j=S.parse(T[3],3,jt),!j)return null}return new xj(I,F,j)}evaluate(T){const S=this.lhs.evaluate(T),C=this.rhs.evaluate(T);if(m&&this.hasUntypedArgument){const I=Ve(S),F=Ve(C);if(I.kind!==F.kind||I.kind!=="string"&&I.kind!=="number")throw new xt(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${I.kind}, ${F.kind}) instead.`)}if(this.collator&&!m&&this.hasUntypedArgument){const I=Ve(S),F=Ve(C);if(I.kind!=="string"||F.kind!=="string")return a(T,S,C)}return this.collator?d(T,S,C,this.collator.evaluate(T)):a(T,S,C)}eachChild(T){T(this.lhs),T(this.rhs),this.collator&&T(this.collator)}outputDefined(){return!0}}}const jx=vc("==",function(u,a,d){return a===d},p0),Gx=vc("!=",function(u,a,d){return a!==d},function(u,a,d,m){return!p0(0,a,d,m)}),Wx=vc("<",function(u,a,d){return a<d},function(u,a,d,m){return m.compare(a,d)<0}),Hx=vc(">",function(u,a,d){return a>d},function(u,a,d,m){return m.compare(a,d)>0}),qx=vc("<=",function(u,a,d){return a<=d},function(u,a,d,m){return m.compare(a,d)<=0}),Kx=vc(">=",function(u,a,d){return a>=d},function(u,a,d,m){return m.compare(a,d)>=0});class Wp{constructor(a,d,m,v,T){this.type=Qe,this.number=a,this.locale=d,this.currency=m,this.minFractionDigits=v,this.maxFractionDigits=T}static parse(a,d){if(a.length!==3)return d.error("Expected two arguments.");const m=d.parse(a[1],1,Me);if(!m)return null;const v=a[2];if(typeof v!="object"||Array.isArray(v))return d.error("NumberFormat options argument must be an object.");let T=null;if(v.locale&&(T=d.parse(v.locale,1,Qe),!T))return null;let S=null;if(v.currency&&(S=d.parse(v.currency,1,Qe),!S))return null;let C=null;if(v["min-fraction-digits"]&&(C=d.parse(v["min-fraction-digits"],1,Me),!C))return null;let I=null;return v["max-fraction-digits"]&&(I=d.parse(v["max-fraction-digits"],1,Me),!I)?null:new Wp(m,T,S,C,I)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class dh{constructor(a){this.type=Xt,this.sections=a}static parse(a,d){if(a.length<2)return d.error("Expected at least one argument.");const m=a[1];if(!Array.isArray(m)&&typeof m=="object")return d.error("First argument must be an image or text section.");const v=[];let T=!1;for(let S=1;S<=a.length-1;++S){const C=a[S];if(T&&typeof C=="object"&&!Array.isArray(C)){T=!1;let I=null;if(C["font-scale"]&&(I=d.parse(C["font-scale"],1,Me),!I))return null;let F=null;if(C["text-font"]&&(F=d.parse(C["text-font"],1,$n(Qe)),!F))return null;let j=null;if(C["text-color"]&&(j=d.parse(C["text-color"],1,vt),!j))return null;const W=v[v.length-1];W.scale=I,W.font=F,W.textColor=j}else{const I=d.parse(a[S],1,st);if(!I)return null;const F=I.type.kind;if(F!=="string"&&F!=="value"&&F!=="null"&&F!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,v.push({content:I,scale:null,font:null,textColor:null})}}return new dh(v)}evaluate(a){return new xe(this.sections.map(d=>{const m=d.content.evaluate(a);return Ve(m)===Mn?new Ee("",m,null,null,null):new Ee(It(m),null,d.scale?d.scale.evaluate(a):null,d.font?d.font.evaluate(a).join(","):null,d.textColor?d.textColor.evaluate(a):null)}))}eachChild(a){for(const d of this.sections)a(d.content),d.scale&&a(d.scale),d.font&&a(d.font),d.textColor&&a(d.textColor)}outputDefined(){return!1}}class Hp{constructor(a){this.type=Mn,this.input=a}static parse(a,d){if(a.length!==2)return d.error("Expected two arguments.");const m=d.parse(a[1],1,Qe);return m?new Hp(m):d.error("No image name provided.")}evaluate(a){const d=this.input.evaluate(a),m=Se.fromString(d);return m&&a.availableImages&&(m.available=a.availableImages.indexOf(d)>-1),m}eachChild(a){a(this.input)}outputDefined(){return!1}}class qp{constructor(a){this.type=Me,this.input=a}static parse(a,d){if(a.length!==2)return d.error(`Expected 1 argument, but found ${a.length-1} instead.`);const m=d.parse(a[1],1);return m?m.type.kind!=="array"&&m.type.kind!=="string"&&m.type.kind!=="value"?d.error(`Expected argument of type string or array, but found ${un(m.type)} instead.`):new qp(m):null}evaluate(a){const d=this.input.evaluate(a);if(typeof d=="string"||Array.isArray(d))return d.length;throw new xt(`Expected value to be of type string or array, but found ${un(Ve(d))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}const _c={"==":jx,"!=":Gx,">":Hx,"<":Wx,">=":Kx,"<=":qx,array:zt,at:Up,boolean:zt,case:Gp,coalesce:ah,collator:ir,format:dh,image:Hp,in:Vp,"index-of":ch,interpolate:ws,"interpolate-hcl":ws,"interpolate-lab":ws,length:qp,let:lh,literal:Ot,match:jp,number:zt,"number-format":Wp,object:zt,slice:uh,step:xr,string:zt,"to-boolean":Zt,"to-color":Zt,"to-number":Zt,"to-string":Zt,var:Ue,within:na};function m0(u,[a,d,m,v]){a=a.evaluate(u),d=d.evaluate(u),m=m.evaluate(u);const T=v?v.evaluate(u):1,S=je(a,d,m,T);if(S)throw new xt(S);return new se(a/255*T,d/255*T,m/255*T,T)}function g0(u,a){return u in a}function hh(u,a){const d=a[u];return d===void 0?null:d}function gl(u){return{type:u}}function y0(u){return{result:"success",value:u}}function bc(u){return{result:"error",value:u}}function dr(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function v0(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function Pn(u){return!!u.expression&&u.expression.interpolated}function Hn(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function lr(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function gr(u){return u}function Mu(u,a){const d=a.type==="color",m=u.stops&&typeof u.stops[0][0]=="object",v=m||!(m||u.property!==void 0),T=u.type||(Pn(a)?"exponential":"interval");if(d||a.type==="padding"){const F=d?se.parse:ge.parse;(u=yi({},u)).stops&&(u.stops=u.stops.map(j=>[j[0],F(j[1])])),u.default=F(u.default?u.default:a.default)}if(u.colorSpace&&u.colorSpace!=="rgb"&&!h0[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let S,C,I;if(T==="exponential")S=_0;else if(T==="interval")S=Zx;else if(T==="categorical"){S=Xx,C=Object.create(null);for(const F of u.stops)C[F[0]]=F[1];I=typeof u.stops[0][0]}else{if(T!=="identity")throw new Error(`Unknown function type "${T}"`);S=Yx}if(m){const F={},j=[];for(let Q=0;Q<u.stops.length;Q++){const ee=u.stops[Q],me=ee[0].zoom;F[me]===void 0&&(F[me]={zoom:me,type:u.type,property:u.property,default:u.default,stops:[]},j.push(me)),F[me].stops.push([ee[0].value,ee[1]])}const W=[];for(const Q of j)W.push([F[Q].zoom,Mu(F[Q],a)]);const X={name:"linear"};return{kind:"composite",interpolationType:X,interpolationFactor:ws.interpolationFactor.bind(void 0,X),zoomStops:W.map(Q=>Q[0]),evaluate:({zoom:Q},ee)=>_0({stops:W,base:u.base},a,Q).evaluate(Q,ee)}}if(v){const F=T==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:F,interpolationFactor:ws.interpolationFactor.bind(void 0,F),zoomStops:u.stops.map(j=>j[0]),evaluate:({zoom:j})=>S(u,a,j,C,I)}}return{kind:"source",evaluate(F,j){const W=j&&j.properties?j.properties[u.property]:void 0;return W===void 0?xc(u.default,a.default):S(u,a,W,C,I)}}}function xc(u,a,d){return u!==void 0?u:a!==void 0?a:d!==void 0?d:void 0}function Xx(u,a,d,m,v){return xc(typeof d===v?m[d]:void 0,u.default,a.default)}function Zx(u,a,d){if(Hn(d)!=="number")return xc(u.default,a.default);const m=u.stops.length;if(m===1||d<=u.stops[0][0])return u.stops[0][1];if(d>=u.stops[m-1][0])return u.stops[m-1][1];const v=bn(u.stops.map(T=>T[0]),d);return u.stops[v][1]}function _0(u,a,d){const m=u.base!==void 0?u.base:1;if(Hn(d)!=="number")return xc(u.default,a.default);const v=u.stops.length;if(v===1||d<=u.stops[0][0])return u.stops[0][1];if(d>=u.stops[v-1][0])return u.stops[v-1][1];const T=bn(u.stops.map(j=>j[0]),d),S=function(j,W,X,Q){const ee=Q-X,me=j-X;return ee===0?0:W===1?me/ee:(Math.pow(W,me)-1)/(Math.pow(W,ee)-1)}(d,m,u.stops[T][0],u.stops[T+1][0]),C=u.stops[T][1],I=u.stops[T+1][1];let F=Gr[a.type]||gr;if(u.colorSpace&&u.colorSpace!=="rgb"){const j=h0[u.colorSpace];F=(W,X)=>j.reverse(j.interpolate(j.forward(W),j.forward(X),S))}return typeof C.evaluate=="function"?{evaluate(...j){const W=C.evaluate.apply(void 0,j),X=I.evaluate.apply(void 0,j);if(W!==void 0&&X!==void 0)return F(W,X,S)}}:F(C,I,S)}function Yx(u,a,d){switch(a.type){case"color":d=se.parse(d);break;case"formatted":d=xe.fromString(d.toString());break;case"resolvedImage":d=Se.fromString(d.toString());break;case"padding":d=ge.parse(d);break;default:Hn(d)===a.type||a.type==="enum"&&a.values[d]||(d=void 0)}return xc(d,u.default,a.default)}En.register(_c,{error:[{kind:"error"},[Qe],(u,[a])=>{throw new xt(a.evaluate(u))}],typeof:[Qe,[st],(u,[a])=>un(Ve(a.evaluate(u)))],"to-rgba":[$n(Me,4),[vt],(u,[a])=>a.evaluate(u).toArray()],rgb:[vt,[Me,Me,Me],m0],rgba:[vt,[Me,Me,Me,Me],m0],has:{type:Ye,overloads:[[[Qe],(u,[a])=>g0(a.evaluate(u),u.properties())],[[Qe,Kt],(u,[a,d])=>g0(a.evaluate(u),d.evaluate(u))]]},get:{type:st,overloads:[[[Qe],(u,[a])=>hh(a.evaluate(u),u.properties())],[[Qe,Kt],(u,[a,d])=>hh(a.evaluate(u),d.evaluate(u))]]},"feature-state":[st,[Qe],(u,[a])=>hh(a.evaluate(u),u.featureState||{})],properties:[Kt,[],u=>u.properties()],"geometry-type":[Qe,[],u=>u.geometryType()],id:[st,[],u=>u.id()],zoom:[Me,[],u=>u.globals.zoom],"heatmap-density":[Me,[],u=>u.globals.heatmapDensity||0],"line-progress":[Me,[],u=>u.globals.lineProgress||0],accumulated:[st,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Me,gl(Me),(u,a)=>{let d=0;for(const m of a)d+=m.evaluate(u);return d}],"*":[Me,gl(Me),(u,a)=>{let d=1;for(const m of a)d*=m.evaluate(u);return d}],"-":{type:Me,overloads:[[[Me,Me],(u,[a,d])=>a.evaluate(u)-d.evaluate(u)],[[Me],(u,[a])=>-a.evaluate(u)]]},"/":[Me,[Me,Me],(u,[a,d])=>a.evaluate(u)/d.evaluate(u)],"%":[Me,[Me,Me],(u,[a,d])=>a.evaluate(u)%d.evaluate(u)],ln2:[Me,[],()=>Math.LN2],pi:[Me,[],()=>Math.PI],e:[Me,[],()=>Math.E],"^":[Me,[Me,Me],(u,[a,d])=>Math.pow(a.evaluate(u),d.evaluate(u))],sqrt:[Me,[Me],(u,[a])=>Math.sqrt(a.evaluate(u))],log10:[Me,[Me],(u,[a])=>Math.log(a.evaluate(u))/Math.LN10],ln:[Me,[Me],(u,[a])=>Math.log(a.evaluate(u))],log2:[Me,[Me],(u,[a])=>Math.log(a.evaluate(u))/Math.LN2],sin:[Me,[Me],(u,[a])=>Math.sin(a.evaluate(u))],cos:[Me,[Me],(u,[a])=>Math.cos(a.evaluate(u))],tan:[Me,[Me],(u,[a])=>Math.tan(a.evaluate(u))],asin:[Me,[Me],(u,[a])=>Math.asin(a.evaluate(u))],acos:[Me,[Me],(u,[a])=>Math.acos(a.evaluate(u))],atan:[Me,[Me],(u,[a])=>Math.atan(a.evaluate(u))],min:[Me,gl(Me),(u,a)=>Math.min(...a.map(d=>d.evaluate(u)))],max:[Me,gl(Me),(u,a)=>Math.max(...a.map(d=>d.evaluate(u)))],abs:[Me,[Me],(u,[a])=>Math.abs(a.evaluate(u))],round:[Me,[Me],(u,[a])=>{const d=a.evaluate(u);return d<0?-Math.round(-d):Math.round(d)}],floor:[Me,[Me],(u,[a])=>Math.floor(a.evaluate(u))],ceil:[Me,[Me],(u,[a])=>Math.ceil(a.evaluate(u))],"filter-==":[Ye,[Qe,st],(u,[a,d])=>u.properties()[a.value]===d.value],"filter-id-==":[Ye,[st],(u,[a])=>u.id()===a.value],"filter-type-==":[Ye,[Qe],(u,[a])=>u.geometryType()===a.value],"filter-<":[Ye,[Qe,st],(u,[a,d])=>{const m=u.properties()[a.value],v=d.value;return typeof m==typeof v&&m<v}],"filter-id-<":[Ye,[st],(u,[a])=>{const d=u.id(),m=a.value;return typeof d==typeof m&&d<m}],"filter->":[Ye,[Qe,st],(u,[a,d])=>{const m=u.properties()[a.value],v=d.value;return typeof m==typeof v&&m>v}],"filter-id->":[Ye,[st],(u,[a])=>{const d=u.id(),m=a.value;return typeof d==typeof m&&d>m}],"filter-<=":[Ye,[Qe,st],(u,[a,d])=>{const m=u.properties()[a.value],v=d.value;return typeof m==typeof v&&m<=v}],"filter-id-<=":[Ye,[st],(u,[a])=>{const d=u.id(),m=a.value;return typeof d==typeof m&&d<=m}],"filter->=":[Ye,[Qe,st],(u,[a,d])=>{const m=u.properties()[a.value],v=d.value;return typeof m==typeof v&&m>=v}],"filter-id->=":[Ye,[st],(u,[a])=>{const d=u.id(),m=a.value;return typeof d==typeof m&&d>=m}],"filter-has":[Ye,[st],(u,[a])=>a.value in u.properties()],"filter-has-id":[Ye,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Ye,[$n(Qe)],(u,[a])=>a.value.indexOf(u.geometryType())>=0],"filter-id-in":[Ye,[$n(st)],(u,[a])=>a.value.indexOf(u.id())>=0],"filter-in-small":[Ye,[Qe,$n(st)],(u,[a,d])=>d.value.indexOf(u.properties()[a.value])>=0],"filter-in-large":[Ye,[Qe,$n(st)],(u,[a,d])=>function(m,v,T,S){for(;T<=S;){const C=T+S>>1;if(v[C]===m)return!0;v[C]>m?S=C-1:T=C+1}return!1}(u.properties()[a.value],d.value,0,d.value.length-1)],all:{type:Ye,overloads:[[[Ye,Ye],(u,[a,d])=>a.evaluate(u)&&d.evaluate(u)],[gl(Ye),(u,a)=>{for(const d of a)if(!d.evaluate(u))return!1;return!0}]]},any:{type:Ye,overloads:[[[Ye,Ye],(u,[a,d])=>a.evaluate(u)||d.evaluate(u)],[gl(Ye),(u,a)=>{for(const d of a)if(d.evaluate(u))return!0;return!1}]]},"!":[Ye,[Ye],(u,[a])=>!a.evaluate(u)],"is-supported-script":[Ye,[Qe],(u,[a])=>{const d=u.globals&&u.globals.isSupportedScript;return!d||d(a.evaluate(u))}],upcase:[Qe,[Qe],(u,[a])=>a.evaluate(u).toUpperCase()],downcase:[Qe,[Qe],(u,[a])=>a.evaluate(u).toLowerCase()],concat:[Qe,gl(st),(u,a)=>a.map(d=>It(d.evaluate(u))).join("")],"resolved-locale":[Qe,[jt],(u,[a])=>a.evaluate(u).resolvedLocale()]});class fh{constructor(a,d){this.expression=a,this._warningHistory={},this._evaluator=new _n,this._defaultValue=d?function(m){return m.type==="color"&&lr(m.default)?new se(0,0,0,0):m.type==="color"?se.parse(m.default)||null:m.type==="padding"?ge.parse(m.default)||null:m.default===void 0?null:m.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null}evaluateWithoutErrorHandling(a,d,m,v,T,S){return this._evaluator.globals=a,this._evaluator.feature=d,this._evaluator.featureState=m,this._evaluator.canonical=v,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S,this.expression.evaluate(this._evaluator)}evaluate(a,d,m,v,T,S){this._evaluator.globals=a,this._evaluator.feature=d||null,this._evaluator.featureState=m||null,this._evaluator.canonical=v,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=S||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new xt(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function $u(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in _c}function ku(u,a){const d=new rt(_c,[],a?function(v){const T={color:vt,string:Qe,number:Me,enum:Qe,boolean:Ye,formatted:Xt,padding:Gn,resolvedImage:Mn};return v.type==="array"?$n(T[v.value]||st,v.length):T[v.type]}(a):void 0),m=d.parse(u,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return m?y0(new fh(m,a)):bc(d.errors)}class Ou{constructor(a,d){this.kind=a,this._styleExpression=d,this.isStateDependent=a!=="constant"&&!oe(d.expression)}evaluateWithoutErrorHandling(a,d,m,v,T,S){return this._styleExpression.evaluateWithoutErrorHandling(a,d,m,v,T,S)}evaluate(a,d,m,v,T,S){return this._styleExpression.evaluate(a,d,m,v,T,S)}}class Kp{constructor(a,d,m,v){this.kind=a,this.zoomStops=m,this._styleExpression=d,this.isStateDependent=a!=="camera"&&!oe(d.expression),this.interpolationType=v}evaluateWithoutErrorHandling(a,d,m,v,T,S){return this._styleExpression.evaluateWithoutErrorHandling(a,d,m,v,T,S)}evaluate(a,d,m,v,T,S){return this._styleExpression.evaluate(a,d,m,v,T,S)}interpolationFactor(a,d,m){return this.interpolationType?ws.interpolationFactor(this.interpolationType,a,d,m):0}}function b0(u,a){const d=ku(u,a);if(d.result==="error")return d;const m=d.value.expression,v=J(m);if(!v&&!dr(a))return bc([new Ai("","data expressions not supported")]);const T=be(m,["zoom"]);if(!T&&!v0(a))return bc([new Ai("","zoom expressions not supported")]);const S=mh(m);return S||T?S instanceof Ai?bc([S]):S instanceof ws&&!Pn(a)?bc([new Ai("",'"interpolate" expressions cannot be used with this property')]):y0(S?new Kp(v?"camera":"composite",d.value,S.labels,S instanceof ws?S.interpolation:void 0):new Ou(v?"constant":"source",d.value)):bc([new Ai("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ph{constructor(a,d){this._parameters=a,this._specification=d,yi(this,Mu(this._parameters,this._specification))}static deserialize(a){return new ph(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function mh(u){let a=null;if(u instanceof lh)a=mh(u.result);else if(u instanceof ah){for(const d of u.args)if(a=mh(d),a)break}else(u instanceof xr||u instanceof ws)&&u.input instanceof En&&u.input.name==="zoom"&&(a=u);return a instanceof Ai||u.eachChild(d=>{const m=mh(d);m instanceof Ai?a=m:!a&&m?a=new Ai("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&m&&a!==m&&(a=new Ai("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function lo(u){const a=u.key,d=u.value,m=u.valueSpec||{},v=u.objectElementValidators||{},T=u.style,S=u.styleSpec;let C=[];const I=Hn(d);if(I!=="object")return[new pt(a,d,`object expected, ${I} found`)];for(const F in d){const j=F.split(".")[0],W=m[j]||m["*"];let X;if(v[j])X=v[j];else if(m[j])X=Es;else if(v["*"])X=v["*"];else{if(!m["*"]){C.push(new pt(a,d[F],`unknown property "${F}"`));continue}X=Es}C=C.concat(X({key:(a&&`${a}.`)+F,value:d[F],valueSpec:W,style:T,styleSpec:S,object:d,objectKey:F},d))}for(const F in m)v[F]||m[F].required&&m[F].default===void 0&&d[F]===void 0&&C.push(new pt(a,d,`missing required property "${F}"`));return C}function x0(u){const a=u.value,d=u.valueSpec,m=u.style,v=u.styleSpec,T=u.key,S=u.arrayElementValidator||Es;if(Hn(a)!=="array")return[new pt(T,a,`array expected, ${Hn(a)} found`)];if(d.length&&a.length!==d.length)return[new pt(T,a,`array length ${d.length} expected, length ${a.length} found`)];if(d["min-length"]&&a.length<d["min-length"])return[new pt(T,a,`array length at least ${d["min-length"]} expected, length ${a.length} found`)];let C={type:d.value,values:d.values};v.$version<7&&(C.function=d.function),Hn(d.value)==="object"&&(C=d.value);let I=[];for(let F=0;F<a.length;F++)I=I.concat(S({array:a,arrayIndex:F,value:a[F],valueSpec:C,style:m,styleSpec:v,key:`${T}[${F}]`}));return I}function Xp(u){const a=u.key,d=u.value,m=u.valueSpec;let v=Hn(d);return v==="number"&&d!=d&&(v="NaN"),v!=="number"?[new pt(a,d,`number expected, ${v} found`)]:"minimum"in m&&d<m.minimum?[new pt(a,d,`${d} is less than the minimum value ${m.minimum}`)]:"maximum"in m&&d>m.maximum?[new pt(a,d,`${d} is greater than the maximum value ${m.maximum}`)]:[]}function w0(u){const a=u.valueSpec,d=fn(u.value.type);let m,v,T,S={};const C=d!=="categorical"&&u.value.property===void 0,I=!C,F=Hn(u.value.stops)==="array"&&Hn(u.value.stops[0])==="array"&&Hn(u.value.stops[0][0])==="object",j=lo({key:u.key,value:u.value,valueSpec:u.styleSpec.function,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(Q){if(d==="identity")return[new pt(Q.key,Q.value,'identity function may not have a "stops" property')];let ee=[];const me=Q.value;return ee=ee.concat(x0({key:Q.key,value:me,valueSpec:Q.valueSpec,style:Q.style,styleSpec:Q.styleSpec,arrayElementValidator:W})),Hn(me)==="array"&&me.length===0&&ee.push(new pt(Q.key,me,"array must have at least one stop")),ee},default:function(Q){return Es({key:Q.key,value:Q.value,valueSpec:a,style:Q.style,styleSpec:Q.styleSpec})}}});return d==="identity"&&C&&j.push(new pt(u.key,u.value,'missing required property "property"')),d==="identity"||u.value.stops||j.push(new pt(u.key,u.value,'missing required property "stops"')),d==="exponential"&&u.valueSpec.expression&&!Pn(u.valueSpec)&&j.push(new pt(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(I&&!dr(u.valueSpec)?j.push(new pt(u.key,u.value,"property functions not supported")):C&&!v0(u.valueSpec)&&j.push(new pt(u.key,u.value,"zoom functions not supported"))),d!=="categorical"&&!F||u.value.property!==void 0||j.push(new pt(u.key,u.value,'"property" property is required')),j;function W(Q){let ee=[];const me=Q.value,pe=Q.key;if(Hn(me)!=="array")return[new pt(pe,me,`array expected, ${Hn(me)} found`)];if(me.length!==2)return[new pt(pe,me,`array length 2 expected, length ${me.length} found`)];if(F){if(Hn(me[0])!=="object")return[new pt(pe,me,`object expected, ${Hn(me[0])} found`)];if(me[0].zoom===void 0)return[new pt(pe,me,"object stop key must have zoom")];if(me[0].value===void 0)return[new pt(pe,me,"object stop key must have value")];if(T&&T>fn(me[0].zoom))return[new pt(pe,me[0].zoom,"stop zoom values must appear in ascending order")];fn(me[0].zoom)!==T&&(T=fn(me[0].zoom),v=void 0,S={}),ee=ee.concat(lo({key:`${pe}[0]`,value:me[0],valueSpec:{zoom:{}},style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{zoom:Xp,value:X}}))}else ee=ee.concat(X({key:`${pe}[0]`,value:me[0],valueSpec:{},style:Q.style,styleSpec:Q.styleSpec},me));return $u(Di(me[1]))?ee.concat([new pt(`${pe}[1]`,me[1],"expressions are not allowed in function stops.")]):ee.concat(Es({key:`${pe}[1]`,value:me[1],valueSpec:a,style:Q.style,styleSpec:Q.styleSpec}))}function X(Q,ee){const me=Hn(Q.value),pe=fn(Q.value),$e=Q.value!==null?Q.value:ee;if(m){if(me!==m)return[new pt(Q.key,$e,`${me} stop domain type must match previous stop domain type ${m}`)]}else m=me;if(me!=="number"&&me!=="string"&&me!=="boolean")return[new pt(Q.key,$e,"stop domain value must be a number, string, or boolean")];if(me!=="number"&&d!=="categorical"){let Be=`number expected, ${me} found`;return dr(a)&&d===void 0&&(Be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new pt(Q.key,$e,Be)]}return d!=="categorical"||me!=="number"||isFinite(pe)&&Math.floor(pe)===pe?d!=="categorical"&&me==="number"&&v!==void 0&&pe<v?[new pt(Q.key,$e,"stop domain values must appear in ascending order")]:(v=pe,d==="categorical"&&pe in S?[new pt(Q.key,$e,"stop domain values must be unique")]:(S[pe]=!0,[])):[new pt(Q.key,$e,`integer expected, found ${pe}`)]}}function yl(u){const a=(u.expressionContext==="property"?b0:ku)(Di(u.value),u.valueSpec);if(a.result==="error")return a.value.map(m=>new pt(`${u.key}${m.key}`,u.value,m.message));const d=a.value.expression||a.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!d.outputDefined())return[new pt(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!oe(d))return[new pt(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!oe(d))return[new pt(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!be(d,["zoom","feature-state"]))return[new pt(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!J(d))return[new pt(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Du(u){const a=u.key,d=u.value,m=u.valueSpec,v=[];return Array.isArray(m.values)?m.values.indexOf(fn(d))===-1&&v.push(new pt(a,d,`expected one of [${m.values.join(", ")}], ${JSON.stringify(d)} found`)):Object.keys(m.values).indexOf(fn(d))===-1&&v.push(new pt(a,d,`expected one of [${Object.keys(m.values).join(", ")}], ${JSON.stringify(d)} found`)),v}function wc(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const a of u.slice(1))if(!wc(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}const Jx={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function gh(u){if(u==null)return{filter:()=>!0,needGeometry:!1};wc(u)||(u=Fu(u));const a=ku(u,Jx);if(a.result==="error")throw new Error(a.value.map(d=>`${d.key}: ${d.message}`).join(", "));return{filter:(d,m,v)=>a.value.evaluate(d,m,{},v),needGeometry:E0(u)}}function T0(u,a){return u<a?-1:u>a?1:0}function E0(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let a=1;a<u.length;a++)if(E0(u[a]))return!0;return!1}function Fu(u){if(!u)return!0;const a=u[0];return u.length<=1?a!=="any":a==="=="?Zp(u[1],u[2],"=="):a==="!="?Tc(Zp(u[1],u[2],"==")):a==="<"||a===">"||a==="<="||a===">="?Zp(u[1],u[2],a):a==="any"?(d=u.slice(1),["any"].concat(d.map(Fu))):a==="all"?["all"].concat(u.slice(1).map(Fu)):a==="none"?["all"].concat(u.slice(1).map(Fu).map(Tc)):a==="in"?yh(u[1],u.slice(2)):a==="!in"?Tc(yh(u[1],u.slice(2))):a==="has"?Nu(u[1]):a==="!has"?Tc(Nu(u[1])):a!=="within"||u;var d}function Zp(u,a,d){switch(u){case"$type":return[`filter-type-${d}`,a];case"$id":return[`filter-id-${d}`,a];default:return[`filter-${d}`,u,a]}}function yh(u,a){if(a.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(d=>typeof d!=typeof a[0])?["filter-in-large",u,["literal",a.sort(T0)]]:["filter-in-small",u,["literal",a]]}}function Nu(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function Tc(u){return["!",u]}function zu(u){return wc(Di(u.value))?yl(yi({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):S0(u)}function S0(u){const a=u.value,d=u.key;if(Hn(a)!=="array")return[new pt(d,a,`array expected, ${Hn(a)} found`)];const m=u.styleSpec;let v,T=[];if(a.length<1)return[new pt(d,a,"filter array must have at least 1 element")];switch(T=T.concat(Du({key:`${d}[0]`,value:a[0],valueSpec:m.filter_operator,style:u.style,styleSpec:u.styleSpec})),fn(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&fn(a[1])==="$type"&&T.push(new pt(d,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&T.push(new pt(d,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(v=Hn(a[1]),v!=="string"&&T.push(new pt(`${d}[1]`,a[1],`string expected, ${v} found`)));for(let S=2;S<a.length;S++)v=Hn(a[S]),fn(a[1])==="$type"?T=T.concat(Du({key:`${d}[${S}]`,value:a[S],valueSpec:m.geometry_type,style:u.style,styleSpec:u.styleSpec})):v!=="string"&&v!=="number"&&v!=="boolean"&&T.push(new pt(`${d}[${S}]`,a[S],`string, number, or boolean expected, ${v} found`));break;case"any":case"all":case"none":for(let S=1;S<a.length;S++)T=T.concat(S0({key:`${d}[${S}]`,value:a[S],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":v=Hn(a[1]),a.length!==2?T.push(new pt(d,a,`filter array for "${a[0]}" operator must have 2 elements`)):v!=="string"&&T.push(new pt(`${d}[1]`,a[1],`string expected, ${v} found`));break;case"within":v=Hn(a[1]),a.length!==2?T.push(new pt(d,a,`filter array for "${a[0]}" operator must have 2 elements`)):v!=="object"&&T.push(new pt(`${d}[1]`,a[1],`object expected, ${v} found`))}return T}function Bu(u,a){const d=u.key,m=u.style,v=u.styleSpec,T=u.value,S=u.objectKey,C=v[`${a}_${u.layerType}`];if(!C)return[];const I=S.match(/^(.*)-transition$/);if(a==="paint"&&I&&C[I[1]]&&C[I[1]].transition)return Es({key:d,value:T,valueSpec:v.transition,style:m,styleSpec:v});const F=u.valueSpec||C[S];if(!F)return[new pt(d,T,`unknown property "${S}"`)];let j;if(Hn(T)==="string"&&dr(F)&&!F.tokens&&(j=/^{([^}]+)}$/.exec(T)))return[new pt(d,T,`"${S}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(j[1])} }\`.`)];const W=[];return u.layerType==="symbol"&&(S==="text-field"&&m&&!m.glyphs&&W.push(new pt(d,T,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&lr(Di(T))&&fn(T.type)==="identity"&&W.push(new pt(d,T,'"text-font" does not support identity functions'))),W.concat(Es({key:u.key,value:T,valueSpec:F,style:m,styleSpec:v,expressionContext:"property",propertyType:a,propertyKey:S}))}function A0(u){return Bu(u,"paint")}function P0(u){return Bu(u,"layout")}function C0(u){let a=[];const d=u.value,m=u.key,v=u.style,T=u.styleSpec;d.type||d.ref||a.push(new pt(m,d,'either "type" or "ref" is required'));let S=fn(d.type);const C=fn(d.ref);if(d.id){const I=fn(d.id);for(let F=0;F<u.arrayIndex;F++){const j=v.layers[F];fn(j.id)===I&&a.push(new pt(m,d.id,`duplicate layer id "${d.id}", previously used at line ${j.id.__line__}`))}}if("ref"in d){let I;["type","source","source-layer","filter","layout"].forEach(F=>{F in d&&a.push(new pt(m,d[F],`"${F}" is prohibited for ref layers`))}),v.layers.forEach(F=>{fn(F.id)===C&&(I=F)}),I?I.ref?a.push(new pt(m,d.ref,"ref cannot reference another ref layer")):S=fn(I.type):a.push(new pt(m,d.ref,`ref layer "${C}" not found`))}else if(S!=="background")if(d.source){const I=v.sources&&v.sources[d.source],F=I&&fn(I.type);I?F==="vector"&&S==="raster"?a.push(new pt(m,d.source,`layer "${d.id}" requires a raster source`)):F==="raster"&&S!=="raster"?a.push(new pt(m,d.source,`layer "${d.id}" requires a vector source`)):F!=="vector"||d["source-layer"]?F==="raster-dem"&&S!=="hillshade"?a.push(new pt(m,d.source,"raster-dem source can only be used with layer type 'hillshade'.")):S!=="line"||!d.paint||!d.paint["line-gradient"]||F==="geojson"&&I.lineMetrics||a.push(new pt(m,d,`layer "${d.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new pt(m,d,`layer "${d.id}" must specify a "source-layer"`)):a.push(new pt(m,d.source,`source "${d.source}" not found`))}else a.push(new pt(m,d,'missing required property "source"'));return a=a.concat(lo({key:m,value:d,valueSpec:T.layer,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Es({key:`${m}.type`,value:d.type,valueSpec:T.layer.type,style:u.style,styleSpec:u.styleSpec,object:d,objectKey:"type"}),filter:zu,layout:I=>lo({layer:d,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":F=>P0(yi({layerType:S},F))}}),paint:I=>lo({layer:d,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":F=>A0(yi({layerType:S},F))}})}})),a}function Ec(u){const a=u.value,d=u.key,m=Hn(a);return m!=="string"?[new pt(d,a,`string expected, ${m} found`)]:[]}const L0={promoteId:function({key:u,value:a}){if(Hn(a)==="string")return Ec({key:u,value:a});{const d=[];for(const m in a)d.push(...Ec({key:`${u}.${m}`,value:a[m]}));return d}}};function Uu(u){const a=u.value,d=u.key,m=u.styleSpec,v=u.style;if(!a.type)return[new pt(d,a,'"type" is required')];const T=fn(a.type);let S;switch(T){case"vector":case"raster":case"raster-dem":return S=lo({key:d,value:a,valueSpec:m[`source_${T.replace("-","_")}`],style:u.style,styleSpec:m,objectElementValidators:L0}),S;case"geojson":if(S=lo({key:d,value:a,valueSpec:m.source_geojson,style:v,styleSpec:m,objectElementValidators:L0}),a.cluster)for(const C in a.clusterProperties){const[I,F]=a.clusterProperties[C],j=typeof I=="string"?[I,["accumulated"],["get",C]]:I;S.push(...yl({key:`${d}.${C}.map`,value:F,expressionContext:"cluster-map"})),S.push(...yl({key:`${d}.${C}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return S;case"video":return lo({key:d,value:a,valueSpec:m.source_video,style:v,styleSpec:m});case"image":return lo({key:d,value:a,valueSpec:m.source_image,style:v,styleSpec:m});case"canvas":return[new pt(d,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Du({key:`${d}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:v,styleSpec:m})}}function Vu(u){const a=u.value,d=u.styleSpec,m=d.light,v=u.style;let T=[];const S=Hn(a);if(a===void 0)return T;if(S!=="object")return T=T.concat([new pt("light",a,`object expected, ${S} found`)]),T;for(const C in a){const I=C.match(/^(.*)-transition$/);T=T.concat(I&&m[I[1]]&&m[I[1]].transition?Es({key:C,value:a[C],valueSpec:d.transition,style:v,styleSpec:d}):m[C]?Es({key:C,value:a[C],valueSpec:m[C],style:v,styleSpec:d}):[new pt(C,a[C],`unknown property "${C}"`)])}return T}function Ts(u){const a=u.value,d=u.styleSpec,m=d.terrain,v=u.style;let T=[];const S=Hn(a);if(a===void 0)return T;if(S!=="object")return T=T.concat([new pt("terrain",a,`object expected, ${S} found`)]),T;for(const C in a)T=T.concat(m[C]?Es({key:C,value:a[C],valueSpec:m[C],style:v,styleSpec:d}):[new pt(C,a[C],`unknown property "${C}"`)]);return T}const ju={"*":()=>[],array:x0,boolean:function(u){const a=u.value,d=u.key,m=Hn(a);return m!=="boolean"?[new pt(d,a,`boolean expected, ${m} found`)]:[]},number:Xp,color:function(u){const a=u.key,d=u.value,m=Hn(d);return m!=="string"?[new pt(a,d,`color expected, ${m} found`)]:os(d)===null?[new pt(a,d,`color expected, "${d}" found`)]:[]},constants:Vs,enum:Du,filter:zu,function:w0,layer:C0,object:lo,source:Uu,light:Vu,terrain:Ts,string:Ec,formatted:function(u){return Ec(u).length===0?[]:yl(u)},resolvedImage:function(u){return Ec(u).length===0?[]:yl(u)},padding:function(u){const a=u.key,d=u.value;if(Hn(d)==="array"){if(d.length<1||d.length>4)return[new pt(a,d,`padding requires 1 to 4 values; ${d.length} values found`)];const m={type:"number"};let v=[];for(let T=0;T<d.length;T++)v=v.concat(Es({key:`${a}[${T}]`,value:d[T],valueSpec:m}));return v}return Xp({key:a,value:d,valueSpec:{}})}};function Es(u){const a=u.value,d=u.valueSpec,m=u.styleSpec;return d.expression&&lr(fn(a))?w0(u):d.expression&&$u(Di(a))?yl(u):d.type&&ju[d.type]?ju[d.type](u):lo(yi({},u,{valueSpec:d.type?m[d.type]:d}))}function Qx(u){const a=u.value,d=u.key,m=Ec(u);return m.length||(a.indexOf("{fontstack}")===-1&&m.push(new pt(d,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&m.push(new pt(d,a,'"glyphs" url must include a "{range}" token'))),m}function Oa(u,a=We){let d=[];return d=d.concat(Es({key:"",value:u,valueSpec:a.$root,styleSpec:a,style:u,objectElementValidators:{glyphs:Qx,"*":()=>[]}})),u.constants&&(d=d.concat(Vs({key:"constants",value:u.constants,style:u,styleSpec:a}))),I0(d)}function I0(u){return[].concat(u).sort((a,d)=>a.line-d.line)}function ra(u){return function(...a){return I0(u.apply(this,a))}}Oa.source=ra(Uu),Oa.light=ra(Vu),Oa.terrain=ra(Ts),Oa.layer=ra(C0),Oa.filter=ra(zu),Oa.paintProperty=ra(A0),Oa.layoutProperty=ra(P0);const Gu=Oa,Yp=Gu.light,ew=Gu.paintProperty,tw=Gu.layoutProperty;function vh(u,a){let d=!1;if(a&&a.length)for(const m of a)u.fire(new ko(new Error(m.message))),d=!0;return d}class Wu{constructor(a,d,m){const v=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;const S=new Int32Array(this.arrayBuffer);a=S[0],this.d=(d=S[1])+2*(m=S[2]);for(let I=0;I<this.d*this.d;I++){const F=S[3+I],j=S[3+I+1];v.push(F===j?null:S.subarray(F,j))}const C=S[3+v.length+1];this.keys=S.subarray(S[3+v.length],C),this.bboxes=S.subarray(C),this.insert=this._insertReadonly}else{this.d=d+2*m;for(let S=0;S<this.d*this.d;S++)v.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=a,this.padding=m,this.scale=d/a,this.uid=0;const T=m/d*a;this.min=-T,this.max=a+T}insert(a,d,m,v,T){this._forEachCell(d,m,v,T,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(d),this.bboxes.push(m),this.bboxes.push(v),this.bboxes.push(T)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(a,d,m,v,T,S){this.cells[T].push(S)}query(a,d,m,v,T){const S=this.min,C=this.max;if(a<=S&&d<=S&&C<=m&&C<=v&&!T)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(a,d,m,v,this._queryCell,I,{},T),I}}_queryCell(a,d,m,v,T,S,C,I){const F=this.cells[T];if(F!==null){const j=this.keys,W=this.bboxes;for(let X=0;X<F.length;X++){const Q=F[X];if(C[Q]===void 0){const ee=4*Q;(I?I(W[ee+0],W[ee+1],W[ee+2],W[ee+3]):a<=W[ee+2]&&d<=W[ee+3]&&m>=W[ee+0]&&v>=W[ee+1])?(C[Q]=!0,S.push(j[Q])):C[Q]=!1}}}}_forEachCell(a,d,m,v,T,S,C,I){const F=this._convertToCellCoord(a),j=this._convertToCellCoord(d),W=this._convertToCellCoord(m),X=this._convertToCellCoord(v);for(let Q=F;Q<=W;Q++)for(let ee=j;ee<=X;ee++){const me=this.d*ee+Q;if((!I||I(this._convertFromCellCoord(Q),this._convertFromCellCoord(ee),this._convertFromCellCoord(Q+1),this._convertFromCellCoord(ee+1)))&&T.call(this,a,d,m,v,me,S,C,I))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const a=this.cells,d=3+this.cells.length+1+1;let m=0;for(let S=0;S<this.cells.length;S++)m+=this.cells[S].length;const v=new Int32Array(d+m+this.keys.length+this.bboxes.length);v[0]=this.extent,v[1]=this.n,v[2]=this.padding;let T=d;for(let S=0;S<a.length;S++){const C=a[S];v[3+S]=T,v.set(C,T),T+=C.length}return v[3+a.length]=T,v.set(this.keys,T),T+=this.keys.length,v[3+a.length+1]=T,v.set(this.bboxes,T),T+=this.bboxes.length,v.buffer}static serialize(a,d){const m=a.toArrayBuffer();return d&&d.push(m),{buffer:m}}static deserialize(a){return new Wu(a.buffer)}}const ia={};function Rt(u,a,d={}){if(ia[u])throw new Error(`${u} is already registered.`);Object.defineProperty(a,"_classRegistryKey",{value:u,writeable:!1}),ia[u]={klass:a,omit:d.omit||[],shallow:d.shallow||[]}}Rt("Object",Object),Rt("TransferableGridIndex",Wu),Rt("Color",se),Rt("Error",Error),Rt("AJAXError",bt),Rt("ResolvedImage",Se),Rt("StylePropertyFunction",ph),Rt("StyleExpression",fh,{omit:["_evaluator"]}),Rt("ZoomDependentExpression",Kp),Rt("ZoomConstantExpression",Ou),Rt("CompoundExpression",En,{omit:["_evaluate"]});for(const u in _c)_c[u]._classRegistryKey||Rt(`Expression_${u}`,_c[u]);function R0(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function vl(u,a){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob)return u;if(R0(u)||ke(u))return a&&a.push(u),u;if(ArrayBuffer.isView(u)){const d=u;return a&&a.push(d.buffer),d}if(u instanceof ImageData)return a&&a.push(u.data.buffer),u;if(Array.isArray(u)){const d=[];for(const m of u)d.push(vl(m,a));return d}if(typeof u=="object"){const d=u.constructor,m=d._classRegistryKey;if(!m)throw new Error("can't serialize object of unregistered class");if(!ia[m])throw new Error(`${m} is not registered.`);const v=d.serialize?d.serialize(u,a):{};if(d.serialize){if(a&&v===a[a.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const T in u){if(!u.hasOwnProperty(T)||ia[m].omit.indexOf(T)>=0)continue;const S=u[T];v[T]=ia[m].shallow.indexOf(T)>=0?S:vl(S,a)}u instanceof Error&&(v.message=u.message)}if(v.$name)throw new Error("$name property is reserved for worker serialization logic.");return m!=="Object"&&(v.$name=m),v}throw new Error("can't serialize object of type "+typeof u)}function Da(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||R0(u)||ke(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(Da);if(typeof u=="object"){const a=u.$name||"Object";if(!ia[a])throw new Error(`can't deserialize unregistered class ${a}`);const{klass:d}=ia[a];if(!d)throw new Error(`can't deserialize unregistered class ${a}`);if(d.deserialize)return d.deserialize(u);const m=Object.create(d.prototype);for(const v of Object.keys(u)){if(v==="$name")continue;const T=u[v];m[v]=ia[a].shallow.indexOf(v)>=0?T:Da(T)}return m}throw new Error("can't deserialize object of type "+typeof u)}class Jp{constructor(){this.first=!0}update(a,d){const m=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=m,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=m,!0):(this.lastFloorZoom>m?(this.lastIntegerZoom=m+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<m&&(this.lastIntegerZoom=m,this.lastIntegerZoomTime=d),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=m,!0))}}const wt={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function _h(u){for(const a of u)if(em(a.charCodeAt(0)))return!0;return!1}function nw(u){for(const a of u)if(!Qp(a.charCodeAt(0)))return!1;return!0}function Qp(u){return!(wt.Arabic(u)||wt["Arabic Supplement"](u)||wt["Arabic Extended-A"](u)||wt["Arabic Presentation Forms-A"](u)||wt["Arabic Presentation Forms-B"](u))}function em(u){return!(u!==746&&u!==747&&(u<4352||!(wt["Bopomofo Extended"](u)||wt.Bopomofo(u)||wt["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||wt["CJK Compatibility Ideographs"](u)||wt["CJK Compatibility"](u)||wt["CJK Radicals Supplement"](u)||wt["CJK Strokes"](u)||!(!wt["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||wt["CJK Unified Ideographs Extension A"](u)||wt["CJK Unified Ideographs"](u)||wt["Enclosed CJK Letters and Months"](u)||wt["Hangul Compatibility Jamo"](u)||wt["Hangul Jamo Extended-A"](u)||wt["Hangul Jamo Extended-B"](u)||wt["Hangul Jamo"](u)||wt["Hangul Syllables"](u)||wt.Hiragana(u)||wt["Ideographic Description Characters"](u)||wt.Kanbun(u)||wt["Kangxi Radicals"](u)||wt["Katakana Phonetic Extensions"](u)||wt.Katakana(u)&&u!==12540||!(!wt["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!wt["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||wt["Unified Canadian Aboriginal Syllabics"](u)||wt["Unified Canadian Aboriginal Syllabics Extended"](u)||wt["Vertical Forms"](u)||wt["Yijing Hexagram Symbols"](u)||wt["Yi Syllables"](u)||wt["Yi Radicals"](u))))}function M0(u){return!(em(u)||function(a){return!!(wt["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||wt["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||wt["Letterlike Symbols"](a)||wt["Number Forms"](a)||wt["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||wt["Control Pictures"](a)&&a!==9251||wt["Optical Character Recognition"](a)||wt["Enclosed Alphanumerics"](a)||wt["Geometric Shapes"](a)||wt["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||wt["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||wt["CJK Symbols and Punctuation"](a)||wt.Katakana(a)||wt["Private Use Area"](a)||wt["CJK Compatibility Forms"](a)||wt["Small Form Variants"](a)||wt["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(u))}function $0(u){return u>=1424&&u<=2303||wt["Arabic Presentation Forms-A"](u)||wt["Arabic Presentation Forms-B"](u)}function rw(u,a){return!(!a&&$0(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||wt.Khmer(u))}function k0(u){for(const a of u)if($0(a.charCodeAt(0)))return!0;return!1}const tm="deferred",nm="loading",rm="loaded";let im=null,as="unavailable",Fa=null;const O0=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(as="error"),im&&im(u)};function Sc(){sm.fire(new ai("pluginStateChange",{pluginStatus:as,pluginURL:Fa}))}const sm=new ss,Hu=function(){return as},D0=function(){if(as!==tm||!Fa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");as=nm,Sc(),Fa&&Ln({url:Fa},u=>{u?O0(u):(as=rm,Sc())})},js={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>as===rm||js.applyArabicShaping!=null,isLoading:()=>as===nm,setState(u){if(!ve())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");as=u.pluginStatus,Fa=u.pluginURL},isParsed(){if(!ve())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return js.applyArabicShaping!=null&&js.processBidirectionalText!=null&&js.processStyledBidirectionalText!=null},getPluginURL(){if(!ve())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Fa}};class yr{constructor(a,d){this.zoom=a,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Jp,this.transition={})}isSupportedScript(a){return function(d,m){for(const v of d)if(!rw(v.charCodeAt(0),m))return!1;return!0}(a,js.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const a=this.zoom,d=a-Math.floor(a),m=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*m}:{fromScale:.5,toScale:1,t:1-(1-m)*d}}}class qu{constructor(a,d){this.property=a,this.value=d,this.expression=function(m,v){if(lr(m))return new ph(m,v);if($u(m)){const T=b0(m,v);if(T.result==="error")throw new Error(T.value.map(S=>`${S.key}: ${S.message}`).join(", "));return T.value}{let T=m;return v.type==="color"&&typeof m=="string"?T=se.parse(m):v.type!=="padding"||typeof m!="number"&&!Array.isArray(m)||(T=ge.parse(m)),{kind:"constant",evaluate:()=>T}}}(d===void 0?a.specification.default:d,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,d,m){return this.property.possiblyEvaluate(this,a,d,m)}}class bh{constructor(a){this.property=a,this.value=new qu(a,void 0)}transitioned(a,d){return new N0(this.property,this.value,d,L({},a.transition,this.transition),a.now)}untransitioned(){return new N0(this.property,this.value,null,{},0)}}class F0{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return N(this._values[a].value.value)}setValue(a,d){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new bh(this._values[a].property)),this._values[a].value=new qu(this._values[a].property,d===null?void 0:N(d))}getTransition(a){return N(this._values[a].transition)}setTransition(a,d){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new bh(this._values[a].property)),this._values[a].transition=N(d)||void 0}serialize(){const a={};for(const d of Object.keys(this._values)){const m=this.getValue(d);m!==void 0&&(a[d]=m);const v=this.getTransition(d);v!==void 0&&(a[`${d}-transition`]=v)}return a}transitioned(a,d){const m=new z0(this._properties);for(const v of Object.keys(this._values))m._values[v]=this._values[v].transitioned(a,d._values[v]);return m}untransitioned(){const a=new z0(this._properties);for(const d of Object.keys(this._values))a._values[d]=this._values[d].untransitioned();return a}}class N0{constructor(a,d,m,v,T){this.property=a,this.value=d,this.begin=T+v.delay||0,this.end=this.begin+v.duration||0,a.specification.transition&&(v.delay||v.duration)&&(this.prior=m)}possiblyEvaluate(a,d,m){const v=a.now||0,T=this.value.possiblyEvaluate(a,d,m),S=this.prior;if(S){if(v>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(v<this.begin)return S.possiblyEvaluate(a,d,m);{const C=(v-this.begin)/(this.end-this.begin);return this.property.interpolate(S.possiblyEvaluate(a,d,m),T,function(I){if(I<=0)return 0;if(I>=1)return 1;const F=I*I,j=F*I;return 4*(I<.5?j:3*(I-F)+j-.75)}(C))}}return T}}class z0{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,d,m){const v=new Ku(this._properties);for(const T of Object.keys(this._values))v._values[T]=this._values[T].possiblyEvaluate(a,d,m);return v}hasTransition(){for(const a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class iw{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}getValue(a){return N(this._values[a].value)}setValue(a,d){this._values[a]=new qu(this._values[a].property,d===null?void 0:N(d))}serialize(){const a={};for(const d of Object.keys(this._values)){const m=this.getValue(d);m!==void 0&&(a[d]=m)}return a}possiblyEvaluate(a,d,m){const v=new Ku(this._properties);for(const T of Object.keys(this._values))v._values[T]=this._values[T].possiblyEvaluate(a,d,m);return v}}class Do{constructor(a,d,m){this.property=a,this.value=d,this.parameters=m}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,d,m,v){return this.property.evaluate(this.value,this.parameters,a,d,m,v)}}class Ku{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class Nt{constructor(a){this.specification=a}possiblyEvaluate(a,d){if(a.isDataDriven())throw new Error("Value should not be data driven");return a.expression.evaluate(d)}interpolate(a,d,m){const v=Gr[this.specification.type];return v?v(a,d,m):a}}class Jt{constructor(a,d){this.specification=a,this.overrides=d}possiblyEvaluate(a,d,m,v){return new Do(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(d,null,{},m,v)}:a.expression,d)}interpolate(a,d,m){if(a.value.kind!=="constant"||d.value.kind!=="constant")return a;if(a.value.value===void 0||d.value.value===void 0)return new Do(this,{kind:"constant",value:void 0},a.parameters);const v=Gr[this.specification.type];return v?new Do(this,{kind:"constant",value:v(a.value.value,d.value.value,m)},a.parameters):a}evaluate(a,d,m,v,T,S){return a.kind==="constant"?a.value:a.evaluate(d,m,v,T,S)}}class Ac extends Jt{possiblyEvaluate(a,d,m,v){if(a.value===void 0)return new Do(this,{kind:"constant",value:void 0},d);if(a.expression.kind==="constant"){const T=a.expression.evaluate(d,null,{},m,v),S=a.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,C=this._calculate(S,S,S,d);return new Do(this,{kind:"constant",value:C},d)}if(a.expression.kind==="camera"){const T=this._calculate(a.expression.evaluate({zoom:d.zoom-1}),a.expression.evaluate({zoom:d.zoom}),a.expression.evaluate({zoom:d.zoom+1}),d);return new Do(this,{kind:"constant",value:T},d)}return new Do(this,a.expression,d)}evaluate(a,d,m,v,T,S){if(a.kind==="source"){const C=a.evaluate(d,m,v,T,S);return this._calculate(C,C,C,d)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(d.zoom)-1},m,v),a.evaluate({zoom:Math.floor(d.zoom)},m,v),a.evaluate({zoom:Math.floor(d.zoom)+1},m,v),d):a.value}_calculate(a,d,m,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:a,to:d}:{from:m,to:d}}interpolate(a){return a}}class om{constructor(a){this.specification=a}possiblyEvaluate(a,d,m,v){if(a.value!==void 0){if(a.expression.kind==="constant"){const T=a.expression.evaluate(d,null,{},m,v);return this._calculate(T,T,T,d)}return this._calculate(a.expression.evaluate(new yr(Math.floor(d.zoom-1),d)),a.expression.evaluate(new yr(Math.floor(d.zoom),d)),a.expression.evaluate(new yr(Math.floor(d.zoom+1),d)),d)}}_calculate(a,d,m,v){return v.zoom>v.zoomHistory.lastIntegerZoom?{from:a,to:d}:{from:m,to:d}}interpolate(a){return a}}class Na{constructor(a){this.specification=a}possiblyEvaluate(a,d,m,v){return!!a.expression.evaluate(d,null,{},m,v)}interpolate(){return!1}}class Li{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const d in a){const m=a[d];m.specification.overridable&&this.overridableProperties.push(d);const v=this.defaultPropertyValues[d]=new qu(m,void 0),T=this.defaultTransitionablePropertyValues[d]=new bh(m);this.defaultTransitioningPropertyValues[d]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=v.possiblyEvaluate({})}}}Rt("DataDrivenProperty",Jt),Rt("DataConstantProperty",Nt),Rt("CrossFadedDataDrivenProperty",Ac),Rt("CrossFadedProperty",om),Rt("ColorRampProperty",Na);const za="-transition";class Fo extends ss{constructor(a,d){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1},a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),d.layout&&(this._unevaluatedLayout=new iw(d.layout)),d.paint)){this._transitionablePaint=new F0(d.paint);for(const m in a.paint)this.setPaintProperty(m,a.paint[m],{validate:!1});for(const m in a.layout)this.setLayoutProperty(m,a.layout[m],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ku(d.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,d,m={}){d!=null&&this._validate(tw,`layers.${this.id}.layout.${a}`,a,d,m)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,d):this.visibility=d)}getPaintProperty(a){return a.endsWith(za)?this._transitionablePaint.getTransition(a.slice(0,-za.length)):this._transitionablePaint.getValue(a)}setPaintProperty(a,d,m={}){if(d!=null&&this._validate(ew,`layers.${this.id}.paint.${a}`,a,d,m))return!1;if(a.endsWith(za))return this._transitionablePaint.setTransition(a.slice(0,-za.length),d||void 0),!1;{const v=this._transitionablePaint._values[a],T=v.property.specification["property-type"]==="cross-faded-data-driven",S=v.value.isDataDriven(),C=v.value;this._transitionablePaint.setValue(a,d),this._handleSpecialPaintPropertyUpdate(a);const I=this._transitionablePaint._values[a].value;return I.isDataDriven()||S||T||this._handleOverridablePaintPropertyUpdate(a,C,I)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,d,m){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,d){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,d)}serialize(){const a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),$(a,(d,m)=>!(d===void 0||m==="layout"&&!Object.keys(d).length||m==="paint"&&!Object.keys(d).length))}_validate(a,d,m,v,T={}){return(!T||T.validate!==!1)&&vh(this,a.call(Gu,{key:d,layerType:this.type,objectKey:m,value:v,styleSpec:We,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const a in this.paint._values){const d=this.paint.get(a);if(d instanceof Do&&dr(d.property.specification)&&(d.value.kind==="source"||d.value.kind==="composite")&&d.value.isStateDependent)return!0}return!1}}const B0={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ba{constructor(a,d){this._structArray=a,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class zr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,d){return a._trim(),d&&(a.isTransferred=!0,d.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){const d=Object.create(this.prototype);return d.arrayBuffer=a.arrayBuffer,d.length=a.length,d.capacity=a.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ei(u,a=1){let d=0,m=0;return{members:u.map(v=>{const T=B0[v.type].BYTES_PER_ELEMENT,S=d=am(d,Math.max(a,T)),C=v.components||1;return m=Math.max(m,T),d+=T*C,{name:v.name,type:v.type,components:C,offset:S}}),size:am(d,Math.max(m,a)),alignment:a}}function am(u,a){return Math.ceil(u/a)*a}class _l extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d){const m=this.length;return this.resize(m+1),this.emplace(m,a,d)}emplace(a,d,m){const v=2*a;return this.int16[v+0]=d,this.int16[v+1]=m,a}}_l.prototype.bytesPerElement=4,Rt("StructArrayLayout2i4",_l);class y extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,m,v){const T=this.length;return this.resize(T+1),this.emplace(T,a,d,m,v)}emplace(a,d,m,v,T){const S=4*a;return this.int16[S+0]=d,this.int16[S+1]=m,this.int16[S+2]=v,this.int16[S+3]=T,a}}y.prototype.bytesPerElement=8,Rt("StructArrayLayout4i8",y);class c extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,m,v,T,S){const C=this.length;return this.resize(C+1),this.emplace(C,a,d,m,v,T,S)}emplace(a,d,m,v,T,S,C){const I=6*a;return this.int16[I+0]=d,this.int16[I+1]=m,this.int16[I+2]=v,this.int16[I+3]=T,this.int16[I+4]=S,this.int16[I+5]=C,a}}c.prototype.bytesPerElement=12,Rt("StructArrayLayout2i4i12",c);class f extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,m,v,T,S){const C=this.length;return this.resize(C+1),this.emplace(C,a,d,m,v,T,S)}emplace(a,d,m,v,T,S,C){const I=4*a,F=8*a;return this.int16[I+0]=d,this.int16[I+1]=m,this.uint8[F+4]=v,this.uint8[F+5]=T,this.uint8[F+6]=S,this.uint8[F+7]=C,a}}f.prototype.bytesPerElement=8,Rt("StructArrayLayout2i4ub8",f);class g extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d){const m=this.length;return this.resize(m+1),this.emplace(m,a,d)}emplace(a,d,m){const v=2*a;return this.float32[v+0]=d,this.float32[v+1]=m,a}}g.prototype.bytesPerElement=8,Rt("StructArrayLayout2f8",g);class _ extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d,m,v,T,S,C,I,F,j){const W=this.length;return this.resize(W+1),this.emplace(W,a,d,m,v,T,S,C,I,F,j)}emplace(a,d,m,v,T,S,C,I,F,j,W){const X=10*a;return this.uint16[X+0]=d,this.uint16[X+1]=m,this.uint16[X+2]=v,this.uint16[X+3]=T,this.uint16[X+4]=S,this.uint16[X+5]=C,this.uint16[X+6]=I,this.uint16[X+7]=F,this.uint16[X+8]=j,this.uint16[X+9]=W,a}}_.prototype.bytesPerElement=20,Rt("StructArrayLayout10ui20",_);class E extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d,m,v,T,S,C,I,F,j,W,X){const Q=this.length;return this.resize(Q+1),this.emplace(Q,a,d,m,v,T,S,C,I,F,j,W,X)}emplace(a,d,m,v,T,S,C,I,F,j,W,X,Q){const ee=12*a;return this.int16[ee+0]=d,this.int16[ee+1]=m,this.int16[ee+2]=v,this.int16[ee+3]=T,this.uint16[ee+4]=S,this.uint16[ee+5]=C,this.uint16[ee+6]=I,this.uint16[ee+7]=F,this.int16[ee+8]=j,this.int16[ee+9]=W,this.int16[ee+10]=X,this.int16[ee+11]=Q,a}}E.prototype.bytesPerElement=24,Rt("StructArrayLayout4i4ui4i24",E);class P extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,a,d,m)}emplace(a,d,m,v){const T=3*a;return this.float32[T+0]=d,this.float32[T+1]=m,this.float32[T+2]=v,a}}P.prototype.bytesPerElement=12,Rt("StructArrayLayout3f12",P);class R extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){const d=this.length;return this.resize(d+1),this.emplace(d,a)}emplace(a,d){return this.uint32[1*a+0]=d,a}}R.prototype.bytesPerElement=4,Rt("StructArrayLayout1ul4",R);class k extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d,m,v,T,S,C,I,F){const j=this.length;return this.resize(j+1),this.emplace(j,a,d,m,v,T,S,C,I,F)}emplace(a,d,m,v,T,S,C,I,F,j){const W=10*a,X=5*a;return this.int16[W+0]=d,this.int16[W+1]=m,this.int16[W+2]=v,this.int16[W+3]=T,this.int16[W+4]=S,this.int16[W+5]=C,this.uint32[X+3]=I,this.uint16[W+8]=F,this.uint16[W+9]=j,a}}k.prototype.bytesPerElement=20,Rt("StructArrayLayout6i1ul2ui20",k);class z extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,m,v,T,S){const C=this.length;return this.resize(C+1),this.emplace(C,a,d,m,v,T,S)}emplace(a,d,m,v,T,S,C){const I=6*a;return this.int16[I+0]=d,this.int16[I+1]=m,this.int16[I+2]=v,this.int16[I+3]=T,this.int16[I+4]=S,this.int16[I+5]=C,a}}z.prototype.bytesPerElement=12,Rt("StructArrayLayout2i2i2i12",z);class G extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,m,v,T){const S=this.length;return this.resize(S+1),this.emplace(S,a,d,m,v,T)}emplace(a,d,m,v,T,S){const C=4*a,I=8*a;return this.float32[C+0]=d,this.float32[C+1]=m,this.float32[C+2]=v,this.int16[I+6]=T,this.int16[I+7]=S,a}}G.prototype.bytesPerElement=16,Rt("StructArrayLayout2f1f2i16",G);class q extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d,m,v){const T=this.length;return this.resize(T+1),this.emplace(T,a,d,m,v)}emplace(a,d,m,v,T){const S=12*a,C=3*a;return this.uint8[S+0]=d,this.uint8[S+1]=m,this.float32[C+1]=v,this.float32[C+2]=T,a}}q.prototype.bytesPerElement=12,Rt("StructArrayLayout2ub2f12",q);class Y extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,a,d,m)}emplace(a,d,m,v){const T=3*a;return this.uint16[T+0]=d,this.uint16[T+1]=m,this.uint16[T+2]=v,a}}Y.prototype.bytesPerElement=6,Rt("StructArrayLayout3ui6",Y);class de extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d,m,v,T,S,C,I,F,j,W,X,Q,ee,me,pe,$e){const Be=this.length;return this.resize(Be+1),this.emplace(Be,a,d,m,v,T,S,C,I,F,j,W,X,Q,ee,me,pe,$e)}emplace(a,d,m,v,T,S,C,I,F,j,W,X,Q,ee,me,pe,$e,Be){const Le=24*a,Ne=12*a,Ze=48*a;return this.int16[Le+0]=d,this.int16[Le+1]=m,this.uint16[Le+2]=v,this.uint16[Le+3]=T,this.uint32[Ne+2]=S,this.uint32[Ne+3]=C,this.uint32[Ne+4]=I,this.uint16[Le+10]=F,this.uint16[Le+11]=j,this.uint16[Le+12]=W,this.float32[Ne+7]=X,this.float32[Ne+8]=Q,this.uint8[Ze+36]=ee,this.uint8[Ze+37]=me,this.uint8[Ze+38]=pe,this.uint32[Ne+10]=$e,this.int16[Le+22]=Be,a}}de.prototype.bytesPerElement=48,Rt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",de);class ce extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d,m,v,T,S,C,I,F,j,W,X,Q,ee,me,pe,$e,Be,Le,Ne,Ze,Xe,Lt,Dt,Tt,gt,ht,Et){const _t=this.length;return this.resize(_t+1),this.emplace(_t,a,d,m,v,T,S,C,I,F,j,W,X,Q,ee,me,pe,$e,Be,Le,Ne,Ze,Xe,Lt,Dt,Tt,gt,ht,Et)}emplace(a,d,m,v,T,S,C,I,F,j,W,X,Q,ee,me,pe,$e,Be,Le,Ne,Ze,Xe,Lt,Dt,Tt,gt,ht,Et,_t){const it=34*a,Ht=17*a;return this.int16[it+0]=d,this.int16[it+1]=m,this.int16[it+2]=v,this.int16[it+3]=T,this.int16[it+4]=S,this.int16[it+5]=C,this.int16[it+6]=I,this.int16[it+7]=F,this.uint16[it+8]=j,this.uint16[it+9]=W,this.uint16[it+10]=X,this.uint16[it+11]=Q,this.uint16[it+12]=ee,this.uint16[it+13]=me,this.uint16[it+14]=pe,this.uint16[it+15]=$e,this.uint16[it+16]=Be,this.uint16[it+17]=Le,this.uint16[it+18]=Ne,this.uint16[it+19]=Ze,this.uint16[it+20]=Xe,this.uint16[it+21]=Lt,this.uint16[it+22]=Dt,this.uint32[Ht+12]=Tt,this.float32[Ht+13]=gt,this.float32[Ht+14]=ht,this.float32[Ht+15]=Et,this.float32[Ht+16]=_t,a}}ce.prototype.bytesPerElement=68,Rt("StructArrayLayout8i15ui1ul4f68",ce);class ue extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){const d=this.length;return this.resize(d+1),this.emplace(d,a)}emplace(a,d){return this.float32[1*a+0]=d,a}}ue.prototype.bytesPerElement=4,Rt("StructArrayLayout1f4",ue);class we extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,a,d,m)}emplace(a,d,m,v){const T=3*a;return this.int16[T+0]=d,this.int16[T+1]=m,this.int16[T+2]=v,a}}we.prototype.bytesPerElement=6,Rt("StructArrayLayout3i6",we);class Ce extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d,m){const v=this.length;return this.resize(v+1),this.emplace(v,a,d,m)}emplace(a,d,m,v){const T=4*a;return this.uint32[2*a+0]=d,this.uint16[T+2]=m,this.uint16[T+3]=v,a}}Ce.prototype.bytesPerElement=8,Rt("StructArrayLayout1ul2ui8",Ce);class Oe extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,d){const m=this.length;return this.resize(m+1),this.emplace(m,a,d)}emplace(a,d,m){const v=2*a;return this.uint16[v+0]=d,this.uint16[v+1]=m,a}}Oe.prototype.bytesPerElement=4,Rt("StructArrayLayout2ui4",Oe);class he extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){const d=this.length;return this.resize(d+1),this.emplace(d,a)}emplace(a,d){return this.uint16[1*a+0]=d,a}}he.prototype.bytesPerElement=2,Rt("StructArrayLayout1ui2",he);class ze extends zr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,d,m,v){const T=this.length;return this.resize(T+1),this.emplace(T,a,d,m,v)}emplace(a,d,m,v,T){const S=4*a;return this.float32[S+0]=d,this.float32[S+1]=m,this.float32[S+2]=v,this.float32[S+3]=T,a}}ze.prototype.bytesPerElement=16,Rt("StructArrayLayout4f16",ze);class Fe extends Ba{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ut(this.anchorPointX,this.anchorPointY)}}Fe.prototype.size=20;class He extends k{get(a){return new Fe(this,a)}}Rt("CollisionBoxArray",He);class qe extends Ba{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}qe.prototype.size=48;class tt extends de{get(a){return new qe(this,a)}}Rt("PlacedSymbolArray",tt);class Ge extends Ba{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Ge.prototype.size=68;class At extends ce{get(a){return new Ge(this,a)}}Rt("SymbolInstanceArray",At);class mt extends ue{getoffsetX(a){return this.float32[1*a+0]}}Rt("GlyphOffsetArray",mt);class Ct extends we{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}Rt("SymbolLineVertexArray",Ct);class sn extends Ba{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}sn.prototype.size=8;class gn extends Ce{get(a){return new sn(this,a)}}Rt("FeatureIndexArray",gn);class Wt extends _l{}class Kn extends _l{}class Xn extends _l{}class kn extends c{}class Dn extends f{}class Jn extends g{}class vi extends _{}class No extends E{}class co extends P{}class zo extends R{}class Ua extends z{}class Gs extends q{}class ls extends Y{}class sa extends Oe{}const xh=ei([{name:"a_pos",components:2,type:"Int16"}],4),{members:ui}=xh;class xn{constructor(a=[]){this.segments=a}prepareSegment(a,d,m,v){let T=this.segments[this.segments.length-1];return a>xn.MAX_VERTEX_ARRAY_LENGTH&&Z(`Max vertices per segment is ${xn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!T||T.vertexLength+a>xn.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==v)&&(T={vertexOffset:d.length,primitiveOffset:m.length,vertexLength:0,primitiveLength:0},v!==void 0&&(T.sortKey=v),this.segments.push(T)),T}get(){return this.segments}destroy(){for(const a of this.segments)for(const d in a.vaos)a.vaos[d].destroy()}static simpleSegment(a,d,m,v){return new xn([{vertexOffset:a,primitiveOffset:d,vertexLength:m,primitiveLength:v,vaos:{},sortKey:0}])}}function qn(u,a){return 256*(u=w(Math.floor(u),0,255))+w(Math.floor(a),0,255)}xn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Rt("SegmentVector",xn);const _i=ei([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var bi={exports:{}},vr={exports:{}};vr.exports=function(u,a){var d,m,v,T,S,C,I,F;for(m=u.length-(d=3&u.length),v=a,S=3432918353,C=461845907,F=0;F<m;)I=255&u.charCodeAt(F)|(255&u.charCodeAt(++F))<<8|(255&u.charCodeAt(++F))<<16|(255&u.charCodeAt(++F))<<24,++F,v=27492+(65535&(T=5*(65535&(v=(v^=I=(65535&(I=(I=(65535&I)*S+(((I>>>16)*S&65535)<<16)&4294967295)<<15|I>>>17))*C+(((I>>>16)*C&65535)<<16)&4294967295)<<13|v>>>19))+((5*(v>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(I=0,d){case 3:I^=(255&u.charCodeAt(F+2))<<16;case 2:I^=(255&u.charCodeAt(F+1))<<8;case 1:v^=I=(65535&(I=(I=(65535&(I^=255&u.charCodeAt(F)))*S+(((I>>>16)*S&65535)<<16)&4294967295)<<15|I>>>17))*C+(((I>>>16)*C&65535)<<16)&4294967295}return v^=u.length,v=2246822507*(65535&(v^=v>>>16))+((2246822507*(v>>>16)&65535)<<16)&4294967295,v=3266489909*(65535&(v^=v>>>13))+((3266489909*(v>>>16)&65535)<<16)&4294967295,(v^=v>>>16)>>>0};var Ws={exports:{}};Ws.exports=function(u,a){for(var d,m=u.length,v=a^m,T=0;m>=4;)d=1540483477*(65535&(d=255&u.charCodeAt(T)|(255&u.charCodeAt(++T))<<8|(255&u.charCodeAt(++T))<<16|(255&u.charCodeAt(++T))<<24))+((1540483477*(d>>>16)&65535)<<16),v=1540483477*(65535&v)+((1540483477*(v>>>16)&65535)<<16)^(d=1540483477*(65535&(d^=d>>>24))+((1540483477*(d>>>16)&65535)<<16)),m-=4,++T;switch(m){case 3:v^=(255&u.charCodeAt(T+2))<<16;case 2:v^=(255&u.charCodeAt(T+1))<<8;case 1:v=1540483477*(65535&(v^=255&u.charCodeAt(T)))+((1540483477*(v>>>16)&65535)<<16)}return v=1540483477*(65535&(v^=v>>>13))+((1540483477*(v>>>16)&65535)<<16),(v^=v>>>15)>>>0};var bl=vr.exports,lm=Ws.exports;bi.exports=bl,bi.exports.murmur3=bl,bi.exports.murmur2=lm;class Pc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,d,m,v){this.ids.push(U0(a)),this.positions.push(d,m,v)}getPositions(a){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const d=U0(a);let m=0,v=this.ids.length-1;for(;m<v;){const S=m+v>>1;this.ids[S]>=d?v=S:m=S+1}const T=[];for(;this.ids[m]===d;)T.push({index:this.positions[3*m],start:this.positions[3*m+1],end:this.positions[3*m+2]}),m++;return T}static serialize(a,d){const m=new Float64Array(a.ids),v=new Uint32Array(a.positions);return cm(m,v,0,m.length-1),d&&d.push(m.buffer,v.buffer),{ids:m,positions:v}}static deserialize(a){const d=new Pc;return d.ids=a.ids,d.positions=a.positions,d.indexed=!0,d}}function U0(u){const a=+u;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:bi.exports(String(u))}function cm(u,a,d,m){for(;d<m;){const v=u[d+m>>1];let T=d-1,S=m+1;for(;;){do T++;while(u[T]<v);do S--;while(u[S]>v);if(T>=S)break;Va(u,T,S),Va(a,3*T,3*S),Va(a,3*T+1,3*S+1),Va(a,3*T+2,3*S+2)}S-d<m-S?(cm(u,a,d,S),d=S+1):(cm(u,a,S+1,m),m=S)}}function Va(u,a,d){const m=u[a];u[a]=u[d],u[d]=m}Rt("FeaturePositionMap",Pc);class xl{constructor(a,d){this.gl=a.gl,this.location=d}}class wl extends xl{constructor(a,d){super(a,d),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class wh extends xl{constructor(a,d){super(a,d),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class mk extends xl{constructor(a,d){super(a,d),this.current=se.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}const jX=new Float32Array(16);function sw(u){return[qn(255*u.r,255*u.g),qn(255*u.b,255*u.a)]}class um{constructor(a,d,m){this.value=a,this.uniformNames=d.map(v=>`u_${v}`),this.type=m}setUniform(a,d,m){a.set(m.constantOr(this.value))}getBinding(a,d,m){return this.type==="color"?new mk(a,d):new wl(a,d)}}class Th{constructor(a,d){this.uniformNames=d.map(m=>`u_${m}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=a.tlbr}setUniform(a,d,m,v){const T=v==="u_pattern_to"?this.patternTo:v==="u_pattern_from"?this.patternFrom:v==="u_pixel_ratio_to"?this.pixelRatioTo:v==="u_pixel_ratio_from"?this.pixelRatioFrom:null;T&&a.set(T)}getBinding(a,d,m){return m.substr(0,9)==="u_pattern"?new wh(a,d):new wl(a,d)}}class Tl{constructor(a,d,m,v){this.expression=a,this.type=m,this.maxValue=0,this.paintVertexAttributes=d.map(T=>({name:`a_${T}`,type:"Float32",components:m==="color"?2:1,offset:0})),this.paintVertexArray=new v}populatePaintArray(a,d,m,v,T){const S=this.paintVertexArray.length,C=this.expression.evaluate(new yr(0),d,{},v,[],T);this.paintVertexArray.resize(a),this._setPaintValue(S,a,C)}updatePaintArray(a,d,m,v){const T=this.expression.evaluate({zoom:0},m,v);this._setPaintValue(a,d,T)}_setPaintValue(a,d,m){if(this.type==="color"){const v=sw(m);for(let T=a;T<d;T++)this.paintVertexArray.emplace(T,v[0],v[1])}else{for(let v=a;v<d;v++)this.paintVertexArray.emplace(v,m);this.maxValue=Math.max(this.maxValue,Math.abs(m))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class oa{constructor(a,d,m,v,T,S){this.expression=a,this.uniformNames=d.map(C=>`u_${C}_t`),this.type=m,this.useIntegerZoom=v,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=d.map(C=>({name:`a_${C}`,type:"Float32",components:m==="color"?4:2,offset:0})),this.paintVertexArray=new S}populatePaintArray(a,d,m,v,T){const S=this.expression.evaluate(new yr(this.zoom),d,{},v,[],T),C=this.expression.evaluate(new yr(this.zoom+1),d,{},v,[],T),I=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(I,a,S,C)}updatePaintArray(a,d,m,v){const T=this.expression.evaluate({zoom:this.zoom},m,v),S=this.expression.evaluate({zoom:this.zoom+1},m,v);this._setPaintValue(a,d,T,S)}_setPaintValue(a,d,m,v){if(this.type==="color"){const T=sw(m),S=sw(v);for(let C=a;C<d;C++)this.paintVertexArray.emplace(C,T[0],T[1],S[0],S[1])}else{for(let T=a;T<d;T++)this.paintVertexArray.emplace(T,m,v);this.maxValue=Math.max(this.maxValue,Math.abs(m),Math.abs(v))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,d){const m=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,v=w(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);a.set(v)}getBinding(a,d,m){return new wl(a,d)}}class Cc{constructor(a,d,m,v,T,S){this.expression=a,this.type=d,this.useIntegerZoom=m,this.zoom=v,this.layerId=S,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T}populatePaintArray(a,d,m){const v=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(v,a,d.patterns&&d.patterns[this.layerId],m)}updatePaintArray(a,d,m,v,T){this._setPaintValues(a,d,m.patterns&&m.patterns[this.layerId],T)}_setPaintValues(a,d,m,v){if(!v||!m)return;const{min:T,mid:S,max:C}=m,I=v[T],F=v[S],j=v[C];if(I&&F&&j)for(let W=a;W<d;W++)this.zoomInPaintVertexArray.emplace(W,F.tl[0],F.tl[1],F.br[0],F.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],F.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(W,F.tl[0],F.tl[1],F.br[0],F.br[1],j.tl[0],j.tl[1],j.br[0],j.br[1],F.pixelRatio,j.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,_i.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,_i.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class gk{constructor(a,d,m){this.binders={},this._buffers=[];const v=[];for(const T in a.paint._values){if(!m(T))continue;const S=a.paint.get(T);if(!(S instanceof Do&&dr(S.property.specification)))continue;const C=GX(T,a.type),I=S.value,F=S.property.specification.type,j=S.property.useIntegerZoom,W=S.property.specification["property-type"],X=W==="cross-faded"||W==="cross-faded-data-driven";if(I.kind==="constant")this.binders[T]=X?new Th(I.value,C):new um(I.value,C,F),v.push(`/u_${T}`);else if(I.kind==="source"||X){const Q=yk(T,F,"source");this.binders[T]=X?new Cc(I,F,j,d,Q,a.id):new Tl(I,C,F,Q),v.push(`/a_${T}`)}else{const Q=yk(T,F,"composite");this.binders[T]=new oa(I,C,F,j,d,Q),v.push(`/z_${T}`)}}this.cacheKey=v.sort().join("")}getMaxValue(a){const d=this.binders[a];return d instanceof Tl||d instanceof oa?d.maxValue:0}populatePaintArrays(a,d,m,v,T){for(const S in this.binders){const C=this.binders[S];(C instanceof Tl||C instanceof oa||C instanceof Cc)&&C.populatePaintArray(a,d,m,v,T)}}setConstantPatternPositions(a,d){for(const m in this.binders){const v=this.binders[m];v instanceof Th&&v.setConstantPatternPositions(a,d)}}updatePaintArrays(a,d,m,v,T){let S=!1;for(const C in a){const I=d.getPositions(C);for(const F of I){const j=m.feature(F.index);for(const W in this.binders){const X=this.binders[W];if((X instanceof Tl||X instanceof oa||X instanceof Cc)&&X.expression.isStateDependent===!0){const Q=v.paint.get(W);X.expression=Q.value,X.updatePaintArray(F.start,F.end,j,a[C],T),S=!0}}}}return S}defines(){const a=[];for(const d in this.binders){const m=this.binders[d];(m instanceof um||m instanceof Th)&&a.push(...m.uniformNames.map(v=>`#define HAS_UNIFORM_${v}`))}return a}getBinderAttributes(){const a=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof Tl||m instanceof oa)for(let v=0;v<m.paintVertexAttributes.length;v++)a.push(m.paintVertexAttributes[v].name);else if(m instanceof Cc)for(let v=0;v<_i.members.length;v++)a.push(_i.members[v].name)}return a}getBinderUniforms(){const a=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof um||m instanceof Th||m instanceof oa)for(const v of m.uniformNames)a.push(v)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,d){const m=[];for(const v in this.binders){const T=this.binders[v];if(T instanceof um||T instanceof Th||T instanceof oa){for(const S of T.uniformNames)if(d[S]){const C=T.getBinding(a,d[S],S);m.push({name:S,property:v,binding:C})}}}return m}setUniforms(a,d,m,v){for(const{name:T,property:S,binding:C}of d)this.binders[S].setUniform(C,v,m.get(S),T)}updatePaintBuffers(a){this._buffers=[];for(const d in this.binders){const m=this.binders[d];if(a&&m instanceof Cc){const v=a.fromScale===2?m.zoomInPaintVertexBuffer:m.zoomOutPaintVertexBuffer;v&&this._buffers.push(v)}else(m instanceof Tl||m instanceof oa)&&m.paintVertexBuffer&&this._buffers.push(m.paintVertexBuffer)}}upload(a){for(const d in this.binders){const m=this.binders[d];(m instanceof Tl||m instanceof oa||m instanceof Cc)&&m.upload(a)}this.updatePaintBuffers()}destroy(){for(const a in this.binders){const d=this.binders[a];(d instanceof Tl||d instanceof oa||d instanceof Cc)&&d.destroy()}}}class Xu{constructor(a,d,m=()=>!0){this.programConfigurations={};for(const v of a)this.programConfigurations[v.id]=new gk(v,d,m);this.needsUpload=!1,this._featureMap=new Pc,this._bufferOffset=0}populatePaintArrays(a,d,m,v,T,S){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(a,d,v,T,S);d.id!==void 0&&this._featureMap.add(d.id,m,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,d,m,v){for(const T of m)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(a,this._featureMap,d,T,v)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(const d in this.programConfigurations)this.programConfigurations[d].upload(a);this.needsUpload=!1}}destroy(){for(const a in this.programConfigurations)this.programConfigurations[a].destroy()}}function GX(u,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${a}-`,"").replace(/-/g,"_")]}function yk(u,a,d){const m={color:{source:g,composite:ze},number:{source:ue,composite:g}},v=function(T){return{"line-pattern":{source:vi,composite:vi},"fill-pattern":{source:vi,composite:vi},"fill-extrusion-pattern":{source:vi,composite:vi}}[T]}(u);return v&&v[d]||m[a][d]}Rt("ConstantBinder",um),Rt("CrossFadedConstantBinder",Th),Rt("SourceExpressionBinder",Tl),Rt("CrossFadedCompositeBinder",Cc),Rt("CompositeExpressionBinder",oa),Rt("ProgramConfiguration",gk,{omit:["_buffers"]}),Rt("ProgramConfigurationSet",Xu);var di=8192;const ow=Math.pow(2,14)-1,vk=-ow-1;function Zu(u){const a=di/u.extent,d=u.loadGeometry();for(let m=0;m<d.length;m++){const v=d[m];for(let T=0;T<v.length;T++){const S=v[T],C=Math.round(S.x*a),I=Math.round(S.y*a);S.x=w(C,vk,ow),S.y=w(I,vk,ow),(C<S.x||C>S.x+1||I<S.y||I>S.y+1)&&Z("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return d}function Yu(u,a){return{type:u.type,id:u.id,properties:u.properties,geometry:a?Zu(u):[]}}function V0(u,a,d,m,v){u.emplaceBack(2*a+(m+1)/2,2*d+(v+1)/2)}class aw{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(d=>d.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new Kn,this.indexArray=new ls,this.segments=new xn,this.programConfigurations=new Xu(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(a,d,m){const v=this.layers[0],T=[];let S=null,C=!1;v.type==="circle"&&(S=v.layout.get("circle-sort-key"),C=!S.isConstant());for(const{feature:I,id:F,index:j,sourceLayerIndex:W}of a){const X=this.layers[0]._featureFilter.needGeometry,Q=Yu(I,X);if(!this.layers[0]._featureFilter.filter(new yr(this.zoom),Q,m))continue;const ee=C?S.evaluate(Q,{},m):void 0,me={id:F,properties:I.properties,type:I.type,sourceLayerIndex:W,index:j,geometry:X?Q.geometry:Zu(I),patterns:{},sortKey:ee};T.push(me)}C&&T.sort((I,F)=>I.sortKey-F.sortKey);for(const I of T){const{geometry:F,index:j,sourceLayerIndex:W}=I,X=a[j].feature;this.addFeature(I,F,j,m),d.featureIndex.insert(X,F,j,W,this.index)}}update(a,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,d,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,ui),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,d,m,v){for(const T of d)for(const S of T){const C=S.x,I=S.y;if(C<0||C>=di||I<0||I>=di)continue;const F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),j=F.vertexLength;V0(this.layoutVertexArray,C,I,-1,-1),V0(this.layoutVertexArray,C,I,1,-1),V0(this.layoutVertexArray,C,I,1,1),V0(this.layoutVertexArray,C,I,-1,1),this.indexArray.emplaceBack(j,j+1,j+2),this.indexArray.emplaceBack(j,j+3,j+2),F.vertexLength+=4,F.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,{},v)}}function _k(u,a){for(let d=0;d<u.length;d++)if(Eh(a,u[d]))return!0;for(let d=0;d<a.length;d++)if(Eh(u,a[d]))return!0;return!!lw(u,a)}function WX(u,a,d){return!!Eh(u,a)||!!cw(a,u,d)}function bk(u,a){if(u.length===1)return wk(a,u[0]);for(let d=0;d<a.length;d++){const m=a[d];for(let v=0;v<m.length;v++)if(Eh(u,m[v]))return!0}for(let d=0;d<u.length;d++)if(wk(a,u[d]))return!0;for(let d=0;d<a.length;d++)if(lw(u,a[d]))return!0;return!1}function HX(u,a,d){if(u.length>1){if(lw(u,a))return!0;for(let m=0;m<a.length;m++)if(cw(a[m],u,d))return!0}for(let m=0;m<u.length;m++)if(cw(u[m],a,d))return!0;return!1}function lw(u,a){if(u.length===0||a.length===0)return!1;for(let d=0;d<u.length-1;d++){const m=u[d],v=u[d+1];for(let T=0;T<a.length-1;T++)if(qX(m,v,a[T],a[T+1]))return!0}return!1}function qX(u,a,d,m){return ie(u,d,m)!==ie(a,d,m)&&ie(u,a,d)!==ie(u,a,m)}function cw(u,a,d){const m=d*d;if(a.length===1)return u.distSqr(a[0])<m;for(let v=1;v<a.length;v++)if(xk(u,a[v-1],a[v])<m)return!0;return!1}function xk(u,a,d){const m=a.distSqr(d);if(m===0)return u.distSqr(a);const v=((u.x-a.x)*(d.x-a.x)+(u.y-a.y)*(d.y-a.y))/m;return u.distSqr(v<0?a:v>1?d:d.sub(a)._mult(v)._add(a))}function wk(u,a){let d,m,v,T=!1;for(let S=0;S<u.length;S++){d=u[S];for(let C=0,I=d.length-1;C<d.length;I=C++)m=d[C],v=d[I],m.y>a.y!=v.y>a.y&&a.x<(v.x-m.x)*(a.y-m.y)/(v.y-m.y)+m.x&&(T=!T)}return T}function Eh(u,a){let d=!1;for(let m=0,v=u.length-1;m<u.length;v=m++){const T=u[m],S=u[v];T.y>a.y!=S.y>a.y&&a.x<(S.x-T.x)*(a.y-T.y)/(S.y-T.y)+T.x&&(d=!d)}return d}function KX(u,a,d){const m=d[0],v=d[2];if(u.x<m.x&&a.x<m.x||u.x>v.x&&a.x>v.x||u.y<m.y&&a.y<m.y||u.y>v.y&&a.y>v.y)return!1;const T=ie(u,a,d[0]);return T!==ie(u,a,d[1])||T!==ie(u,a,d[2])||T!==ie(u,a,d[3])}function dm(u,a,d){const m=a.paint.get(u).value;return m.kind==="constant"?m.value:d.programConfigurations.get(a.id).getMaxValue(u)}function j0(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function G0(u,a,d,m,v){if(!a[0]&&!a[1])return u;const T=ut.convert(a)._mult(v);d==="viewport"&&T._rotate(-m);const S=[];for(let C=0;C<u.length;C++)S.push(u[C].sub(T));return S}Rt("CircleBucket",aw,{omit:["layers"]});const XX=new Li({"circle-sort-key":new Jt(We.layout_circle["circle-sort-key"])});var ZX={paint:new Li({"circle-radius":new Jt(We.paint_circle["circle-radius"]),"circle-color":new Jt(We.paint_circle["circle-color"]),"circle-blur":new Jt(We.paint_circle["circle-blur"]),"circle-opacity":new Jt(We.paint_circle["circle-opacity"]),"circle-translate":new Nt(We.paint_circle["circle-translate"]),"circle-translate-anchor":new Nt(We.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Nt(We.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Nt(We.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Jt(We.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Jt(We.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Jt(We.paint_circle["circle-stroke-opacity"])}),layout:XX},cs=1e-6,us=typeof Float32Array<"u"?Float32Array:Array;function Tk(){var u=new us(9);return us!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function uw(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Ek(u,a,d){var m=a[0],v=a[1],T=a[2],S=a[3],C=a[4],I=a[5],F=a[6],j=a[7],W=a[8],X=a[9],Q=a[10],ee=a[11],me=a[12],pe=a[13],$e=a[14],Be=a[15],Le=d[0],Ne=d[1],Ze=d[2],Xe=d[3];return u[0]=Le*m+Ne*C+Ze*W+Xe*me,u[1]=Le*v+Ne*I+Ze*X+Xe*pe,u[2]=Le*T+Ne*F+Ze*Q+Xe*$e,u[3]=Le*S+Ne*j+Ze*ee+Xe*Be,u[4]=(Le=d[4])*m+(Ne=d[5])*C+(Ze=d[6])*W+(Xe=d[7])*me,u[5]=Le*v+Ne*I+Ze*X+Xe*pe,u[6]=Le*T+Ne*F+Ze*Q+Xe*$e,u[7]=Le*S+Ne*j+Ze*ee+Xe*Be,u[8]=(Le=d[8])*m+(Ne=d[9])*C+(Ze=d[10])*W+(Xe=d[11])*me,u[9]=Le*v+Ne*I+Ze*X+Xe*pe,u[10]=Le*T+Ne*F+Ze*Q+Xe*$e,u[11]=Le*S+Ne*j+Ze*ee+Xe*Be,u[12]=(Le=d[12])*m+(Ne=d[13])*C+(Ze=d[14])*W+(Xe=d[15])*me,u[13]=Le*v+Ne*I+Ze*X+Xe*pe,u[14]=Le*T+Ne*F+Ze*Q+Xe*$e,u[15]=Le*S+Ne*j+Ze*ee+Xe*Be,u}Math.hypot||(Math.hypot=function(){for(var u=0,a=arguments.length;a--;)u+=arguments[a]*arguments[a];return Math.sqrt(u)});var hm,YX=Ek;function Sk(){var u=new us(3);return us!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function Ak(u,a,d){var m=new us(3);return m[0]=u,m[1]=a,m[2]=d,m}function W0(u,a,d){var m=a[0],v=a[1],T=a[2],S=a[3];return u[0]=d[0]*m+d[4]*v+d[8]*T+d[12]*S,u[1]=d[1]*m+d[5]*v+d[9]*T+d[13]*S,u[2]=d[2]*m+d[6]*v+d[10]*T+d[14]*S,u[3]=d[3]*m+d[7]*v+d[11]*T+d[15]*S,u}function Pk(){var u=new us(4);return us!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function Ck(u,a){const d=W0([],[u.x,u.y,0,1],a);return new ut(d[0]/d[3],d[1]/d[3])}Sk(),hm=new us(4),us!=Float32Array&&(hm[0]=0,hm[1]=0,hm[2]=0,hm[3]=0),Sk(),Ak(1,0,0),Ak(0,1,0),Pk(),Pk(),Tk(),function(){var u;u=new us(2),us!=Float32Array&&(u[0]=0,u[1]=0)}();class Lk extends aw{}Rt("HeatmapBucket",Lk,{omit:["layers"]});var JX={paint:new Li({"heatmap-radius":new Jt(We.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Jt(We.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Nt(We.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Na(We.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Nt(We.paint_heatmap["heatmap-opacity"])})};function dw(u,{width:a,height:d},m,v){if(v){if(v instanceof Uint8ClampedArray)v=new Uint8Array(v.buffer);else if(v.length!==a*d*m)throw new RangeError(`mismatched image size. expected: ${v.length} but got: ${a*d*m}`)}else v=new Uint8Array(a*d*m);return u.width=a,u.height=d,u.data=v,u}function Ik(u,{width:a,height:d},m){if(a===u.width&&d===u.height)return;const v=dw({},{width:a,height:d},m);hw(u,v,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,a),height:Math.min(u.height,d)},m),u.width=a,u.height=d,u.data=v.data}function hw(u,a,d,m,v,T){if(v.width===0||v.height===0)return a;if(v.width>u.width||v.height>u.height||d.x>u.width-v.width||d.y>u.height-v.height)throw new RangeError("out of range source coordinates for image copy");if(v.width>a.width||v.height>a.height||m.x>a.width-v.width||m.y>a.height-v.height)throw new RangeError("out of range destination coordinates for image copy");const S=u.data,C=a.data;if(S===C)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<v.height;I++){const F=((d.y+I)*u.width+d.x)*T,j=((m.y+I)*a.width+m.x)*T;for(let W=0;W<v.width*T;W++)C[j+W]=S[F+W]}return a}class fm{constructor(a,d){dw(this,a,1,d)}resize(a){Ik(this,a,1)}clone(){return new fm({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,d,m,v,T){hw(a,d,m,v,T,1)}}class uo{constructor(a,d){dw(this,a,4,d)}resize(a){Ik(this,a,4)}replace(a,d){d?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new uo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,d,m,v,T){hw(a,d,m,v,T,4)}}function Rk(u){const a={},d=u.resolution||256,m=u.clips?u.clips.length:1,v=u.image||new uo({width:d,height:m});if(Math.log(d)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${d}`);const T=(S,C,I)=>{a[u.evaluationKey]=I;const F=u.expression.evaluate(a);v.data[S+C+0]=Math.floor(255*F.r/F.a),v.data[S+C+1]=Math.floor(255*F.g/F.a),v.data[S+C+2]=Math.floor(255*F.b/F.a),v.data[S+C+3]=Math.floor(255*F.a)};if(u.clips)for(let S=0,C=0;S<m;++S,C+=4*d)for(let I=0,F=0;I<d;I++,F+=4){const j=I/(d-1),{start:W,end:X}=u.clips[S];T(C,F,W*(1-j)+X*j)}else for(let S=0,C=0;S<d;S++,C+=4)T(0,C,S/(d-1));return v}Rt("AlphaImage",fm),Rt("RGBAImage",uo);var QX={paint:new Li({"hillshade-illumination-direction":new Nt(We.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Nt(We.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Nt(We.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Nt(We.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Nt(We.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Nt(We.paint_hillshade["hillshade-accent-color"])})};const eZ=ei([{name:"a_pos",components:2,type:"Int16"}],4),{members:tZ}=eZ;var H0={exports:{}};function q0(u,a,d){d=d||2;var m,v,T,S,C,I,F,j=a&&a.length,W=j?a[0]*d:u.length,X=Mk(u,0,W,d,!0),Q=[];if(!X||X.next===X.prev)return Q;if(j&&(X=function(me,pe,$e,Be){var Le,Ne,Ze,Xe=[];for(Le=0,Ne=pe.length;Le<Ne;Le++)(Ze=Mk(me,pe[Le]*Be,Le<Ne-1?pe[Le+1]*Be:me.length,Be,!1))===Ze.next&&(Ze.steiner=!0),Xe.push(cZ(Ze));for(Xe.sort(oZ),Le=0;Le<Xe.length;Le++)$e=aZ(Xe[Le],$e);return $e}(u,a,X,d)),u.length>80*d){m=T=u[0],v=S=u[1];for(var ee=d;ee<W;ee+=d)(C=u[ee])<m&&(m=C),(I=u[ee+1])<v&&(v=I),C>T&&(T=C),I>S&&(S=I);F=(F=Math.max(T-m,S-v))!==0?32767/F:0}return pm(X,Q,d,m,v,F,0),Q}function Mk(u,a,d,m,v){var T,S;if(v===mw(u,a,d,m)>0)for(T=a;T<d;T+=m)S=Ok(T,u[T],u[T+1],S);else for(T=d-m;T>=a;T-=m)S=Ok(T,u[T],u[T+1],S);return S&&K0(S,S.next)&&(gm(S),S=S.next),S}function Ju(u,a){if(!u)return u;a||(a=u);var d,m=u;do if(d=!1,m.steiner||!K0(m,m.next)&&Wr(m.prev,m,m.next)!==0)m=m.next;else{if(gm(m),(m=a=m.prev)===m.next)break;d=!0}while(d||m!==a);return a}function pm(u,a,d,m,v,T,S){if(u){!S&&T&&function(j,W,X,Q){var ee=j;do ee.z===0&&(ee.z=fw(ee.x,ee.y,W,X,Q)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next;while(ee!==j);ee.prevZ.nextZ=null,ee.prevZ=null,function(me){var pe,$e,Be,Le,Ne,Ze,Xe,Lt,Dt=1;do{for($e=me,me=null,Ne=null,Ze=0;$e;){for(Ze++,Be=$e,Xe=0,pe=0;pe<Dt&&(Xe++,Be=Be.nextZ);pe++);for(Lt=Dt;Xe>0||Lt>0&&Be;)Xe!==0&&(Lt===0||!Be||$e.z<=Be.z)?(Le=$e,$e=$e.nextZ,Xe--):(Le=Be,Be=Be.nextZ,Lt--),Ne?Ne.nextZ=Le:me=Le,Le.prevZ=Ne,Ne=Le;$e=Be}Ne.nextZ=null,Dt*=2}while(Ze>1)}(ee)}(u,m,v,T);for(var C,I,F=u;u.prev!==u.next;)if(C=u.prev,I=u.next,T?rZ(u,m,v,T):nZ(u))a.push(C.i/d|0),a.push(u.i/d|0),a.push(I.i/d|0),gm(u),u=I.next,F=I.next;else if((u=I)===F){S?S===1?pm(u=iZ(Ju(u),a,d),a,d,m,v,T,2):S===2&&sZ(u,a,d,m,v,T):pm(Ju(u),a,d,m,v,T,1);break}}}function nZ(u){var a=u.prev,d=u,m=u.next;if(Wr(a,d,m)>=0)return!1;for(var v=a.x,T=d.x,S=m.x,C=a.y,I=d.y,F=m.y,j=v<T?v<S?v:S:T<S?T:S,W=C<I?C<F?C:F:I<F?I:F,X=v>T?v>S?v:S:T>S?T:S,Q=C>I?C>F?C:F:I>F?I:F,ee=m.next;ee!==a;){if(ee.x>=j&&ee.x<=X&&ee.y>=W&&ee.y<=Q&&Sh(v,C,T,I,S,F,ee.x,ee.y)&&Wr(ee.prev,ee,ee.next)>=0)return!1;ee=ee.next}return!0}function rZ(u,a,d,m){var v=u.prev,T=u,S=u.next;if(Wr(v,T,S)>=0)return!1;for(var C=v.x,I=T.x,F=S.x,j=v.y,W=T.y,X=S.y,Q=C<I?C<F?C:F:I<F?I:F,ee=j<W?j<X?j:X:W<X?W:X,me=C>I?C>F?C:F:I>F?I:F,pe=j>W?j>X?j:X:W>X?W:X,$e=fw(Q,ee,a,d,m),Be=fw(me,pe,a,d,m),Le=u.prevZ,Ne=u.nextZ;Le&&Le.z>=$e&&Ne&&Ne.z<=Be;){if(Le.x>=Q&&Le.x<=me&&Le.y>=ee&&Le.y<=pe&&Le!==v&&Le!==S&&Sh(C,j,I,W,F,X,Le.x,Le.y)&&Wr(Le.prev,Le,Le.next)>=0||(Le=Le.prevZ,Ne.x>=Q&&Ne.x<=me&&Ne.y>=ee&&Ne.y<=pe&&Ne!==v&&Ne!==S&&Sh(C,j,I,W,F,X,Ne.x,Ne.y)&&Wr(Ne.prev,Ne,Ne.next)>=0))return!1;Ne=Ne.nextZ}for(;Le&&Le.z>=$e;){if(Le.x>=Q&&Le.x<=me&&Le.y>=ee&&Le.y<=pe&&Le!==v&&Le!==S&&Sh(C,j,I,W,F,X,Le.x,Le.y)&&Wr(Le.prev,Le,Le.next)>=0)return!1;Le=Le.prevZ}for(;Ne&&Ne.z<=Be;){if(Ne.x>=Q&&Ne.x<=me&&Ne.y>=ee&&Ne.y<=pe&&Ne!==v&&Ne!==S&&Sh(C,j,I,W,F,X,Ne.x,Ne.y)&&Wr(Ne.prev,Ne,Ne.next)>=0)return!1;Ne=Ne.nextZ}return!0}function iZ(u,a,d){var m=u;do{var v=m.prev,T=m.next.next;!K0(v,T)&&$k(v,m,m.next,T)&&mm(v,T)&&mm(T,v)&&(a.push(v.i/d|0),a.push(m.i/d|0),a.push(T.i/d|0),gm(m),gm(m.next),m=u=T),m=m.next}while(m!==u);return Ju(m)}function sZ(u,a,d,m,v,T){var S=u;do{for(var C=S.next.next;C!==S.prev;){if(S.i!==C.i&&uZ(S,C)){var I=kk(S,C);return S=Ju(S,S.next),I=Ju(I,I.next),pm(S,a,d,m,v,T,0),void pm(I,a,d,m,v,T,0)}C=C.next}S=S.next}while(S!==u)}function oZ(u,a){return u.x-a.x}function aZ(u,a){var d=function(v,T){var S,C=T,I=v.x,F=v.y,j=-1/0;do{if(F<=C.y&&F>=C.next.y&&C.next.y!==C.y){var W=C.x+(F-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(W<=I&&W>j&&(j=W,S=C.x<C.next.x?C:C.next,W===I))return S}C=C.next}while(C!==T);if(!S)return null;var X,Q=S,ee=S.x,me=S.y,pe=1/0;C=S;do I>=C.x&&C.x>=ee&&I!==C.x&&Sh(F<me?I:j,F,ee,me,F<me?j:I,F,C.x,C.y)&&(X=Math.abs(F-C.y)/(I-C.x),mm(C,v)&&(X<pe||X===pe&&(C.x>S.x||C.x===S.x&&lZ(S,C)))&&(S=C,pe=X)),C=C.next;while(C!==Q);return S}(u,a);if(!d)return a;var m=kk(d,u);return Ju(m,m.next),Ju(d,d.next)}function lZ(u,a){return Wr(u.prev,u,a.prev)<0&&Wr(a.next,u,u.next)<0}function fw(u,a,d,m,v){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-d)*v|0)|u<<8))|u<<4))|u<<2))|u<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-m)*v|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function cZ(u){var a=u,d=u;do(a.x<d.x||a.x===d.x&&a.y<d.y)&&(d=a),a=a.next;while(a!==u);return d}function Sh(u,a,d,m,v,T,S,C){return(v-S)*(a-C)>=(u-S)*(T-C)&&(u-S)*(m-C)>=(d-S)*(a-C)&&(d-S)*(T-C)>=(v-S)*(m-C)}function uZ(u,a){return u.next.i!==a.i&&u.prev.i!==a.i&&!function(d,m){var v=d;do{if(v.i!==d.i&&v.next.i!==d.i&&v.i!==m.i&&v.next.i!==m.i&&$k(v,v.next,d,m))return!0;v=v.next}while(v!==d);return!1}(u,a)&&(mm(u,a)&&mm(a,u)&&function(d,m){var v=d,T=!1,S=(d.x+m.x)/2,C=(d.y+m.y)/2;do v.y>C!=v.next.y>C&&v.next.y!==v.y&&S<(v.next.x-v.x)*(C-v.y)/(v.next.y-v.y)+v.x&&(T=!T),v=v.next;while(v!==d);return T}(u,a)&&(Wr(u.prev,u,a.prev)||Wr(u,a.prev,a))||K0(u,a)&&Wr(u.prev,u,u.next)>0&&Wr(a.prev,a,a.next)>0)}function Wr(u,a,d){return(a.y-u.y)*(d.x-a.x)-(a.x-u.x)*(d.y-a.y)}function K0(u,a){return u.x===a.x&&u.y===a.y}function $k(u,a,d,m){var v=Z0(Wr(u,a,d)),T=Z0(Wr(u,a,m)),S=Z0(Wr(d,m,u)),C=Z0(Wr(d,m,a));return v!==T&&S!==C||!(v!==0||!X0(u,d,a))||!(T!==0||!X0(u,m,a))||!(S!==0||!X0(d,u,m))||!(C!==0||!X0(d,a,m))}function X0(u,a,d){return a.x<=Math.max(u.x,d.x)&&a.x>=Math.min(u.x,d.x)&&a.y<=Math.max(u.y,d.y)&&a.y>=Math.min(u.y,d.y)}function Z0(u){return u>0?1:u<0?-1:0}function mm(u,a){return Wr(u.prev,u,u.next)<0?Wr(u,a,u.next)>=0&&Wr(u,u.prev,a)>=0:Wr(u,a,u.prev)<0||Wr(u,u.next,a)<0}function kk(u,a){var d=new pw(u.i,u.x,u.y),m=new pw(a.i,a.x,a.y),v=u.next,T=a.prev;return u.next=a,a.prev=u,d.next=v,v.prev=d,m.next=d,d.prev=m,T.next=m,m.prev=T,m}function Ok(u,a,d,m){var v=new pw(u,a,d);return m?(v.next=m.next,v.prev=m,m.next.prev=v,m.next=v):(v.prev=v,v.next=v),v}function gm(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function pw(u,a,d){this.i=u,this.x=a,this.y=d,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function mw(u,a,d,m){for(var v=0,T=a,S=d-m;T<d;T+=m)v+=(u[S]-u[T])*(u[T+1]+u[S+1]),S=T;return v}function dZ(u,a,d,m,v){Dk(u,a,d||0,m||u.length-1,v||hZ)}function Dk(u,a,d,m,v){for(;m>d;){if(m-d>600){var T=m-d+1,S=a-d+1,C=Math.log(T),I=.5*Math.exp(2*C/3),F=.5*Math.sqrt(C*I*(T-I)/T)*(S-T/2<0?-1:1);Dk(u,a,Math.max(d,Math.floor(a-S*I/T+F)),Math.min(m,Math.floor(a+(T-S)*I/T+F)),v)}var j=u[a],W=d,X=m;for(ym(u,d,a),v(u[m],j)>0&&ym(u,d,m);W<X;){for(ym(u,W,X),W++,X--;v(u[W],j)<0;)W++;for(;v(u[X],j)>0;)X--}v(u[d],j)===0?ym(u,d,X):ym(u,++X,m),X<=a&&(d=X+1),a<=X&&(m=X-1)}}function ym(u,a,d){var m=u[a];u[a]=u[d],u[d]=m}function hZ(u,a){return u<a?-1:u>a?1:0}function gw(u,a){const d=u.length;if(d<=1)return[u];const m=[];let v,T;for(let S=0;S<d;S++){const C=re(u[S]);C!==0&&(u[S].area=Math.abs(C),T===void 0&&(T=C<0),T===C<0?(v&&m.push(v),v=[u[S]]):v.push(u[S]))}if(v&&m.push(v),a>1)for(let S=0;S<m.length;S++)m[S].length<=a||(dZ(m[S],a,1,m[S].length-1,fZ),m[S]=m[S].slice(0,a));return m}function fZ(u,a){return a.area-u.area}function yw(u,a,d){const m=d.patternDependencies;let v=!1;for(const T of a){const S=T.paint.get(`${u}-pattern`);S.isConstant()||(v=!0);const C=S.constantOr(null);C&&(v=!0,m[C.to]=!0,m[C.from]=!0)}return v}function vw(u,a,d,m,v){const T=v.patternDependencies;for(const S of a){const C=S.paint.get(`${u}-pattern`).value;if(C.kind!=="constant"){let I=C.evaluate({zoom:m-1},d,{},v.availableImages),F=C.evaluate({zoom:m},d,{},v.availableImages),j=C.evaluate({zoom:m+1},d,{},v.availableImages);I=I&&I.name?I.name:I,F=F&&F.name?F.name:F,j=j&&j.name?j.name:j,T[I]=!0,T[F]=!0,T[j]=!0,d.patterns[S.id]={min:I,mid:F,max:j}}}return d}H0.exports=q0,H0.exports.default=q0,q0.deviation=function(u,a,d,m){var v=a&&a.length,T=Math.abs(mw(u,0,v?a[0]*d:u.length,d));if(v)for(var S=0,C=a.length;S<C;S++)T-=Math.abs(mw(u,a[S]*d,S<C-1?a[S+1]*d:u.length,d));var I=0;for(S=0;S<m.length;S+=3){var F=m[S]*d,j=m[S+1]*d,W=m[S+2]*d;I+=Math.abs((u[F]-u[W])*(u[j+1]-u[F+1])-(u[F]-u[j])*(u[W+1]-u[F+1]))}return T===0&&I===0?0:Math.abs((I-T)/T)},q0.flatten=function(u){for(var a=u[0][0].length,d={vertices:[],holes:[],dimensions:a},m=0,v=0;v<u.length;v++){for(var T=0;T<u[v].length;T++)for(var S=0;S<a;S++)d.vertices.push(u[v][T][S]);v>0&&d.holes.push(m+=u[v-1].length)}return d};class _w{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(d=>d.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Xn,this.indexArray=new ls,this.indexArray2=new sa,this.programConfigurations=new Xu(a.layers,a.zoom),this.segments=new xn,this.segments2=new xn,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(a,d,m){this.hasPattern=yw("fill",this.layers,d);const v=this.layers[0].layout.get("fill-sort-key"),T=!v.isConstant(),S=[];for(const{feature:C,id:I,index:F,sourceLayerIndex:j}of a){const W=this.layers[0]._featureFilter.needGeometry,X=Yu(C,W);if(!this.layers[0]._featureFilter.filter(new yr(this.zoom),X,m))continue;const Q=T?v.evaluate(X,{},m,d.availableImages):void 0,ee={id:I,properties:C.properties,type:C.type,sourceLayerIndex:j,index:F,geometry:W?X.geometry:Zu(C),patterns:{},sortKey:Q};S.push(ee)}T&&S.sort((C,I)=>C.sortKey-I.sortKey);for(const C of S){const{geometry:I,index:F,sourceLayerIndex:j}=C;if(this.hasPattern){const W=vw("fill",this.layers,C,this.zoom,d);this.patternFeatures.push(W)}else this.addFeature(C,I,F,m,{});d.featureIndex.insert(a[F].feature,I,F,j,this.index)}}update(a,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,d,this.stateDependentLayers,m)}addFeatures(a,d,m){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,tZ),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,d,m,v,T){for(const S of gw(d,500)){let C=0;for(const Q of S)C+=Q.length;const I=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),F=I.vertexLength,j=[],W=[];for(const Q of S){if(Q.length===0)continue;Q!==S[0]&&W.push(j.length/2);const ee=this.segments2.prepareSegment(Q.length,this.layoutVertexArray,this.indexArray2),me=ee.vertexLength;this.layoutVertexArray.emplaceBack(Q[0].x,Q[0].y),this.indexArray2.emplaceBack(me+Q.length-1,me),j.push(Q[0].x),j.push(Q[0].y);for(let pe=1;pe<Q.length;pe++)this.layoutVertexArray.emplaceBack(Q[pe].x,Q[pe].y),this.indexArray2.emplaceBack(me+pe-1,me+pe),j.push(Q[pe].x),j.push(Q[pe].y);ee.vertexLength+=Q.length,ee.primitiveLength+=Q.length}const X=H0.exports(j,W);for(let Q=0;Q<X.length;Q+=3)this.indexArray.emplaceBack(F+X[Q],F+X[Q+1],F+X[Q+2]);I.vertexLength+=C,I.primitiveLength+=X.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,T,v)}}Rt("FillBucket",_w,{omit:["layers","patternFeatures"]});const pZ=new Li({"fill-sort-key":new Jt(We.layout_fill["fill-sort-key"])});var mZ={paint:new Li({"fill-antialias":new Nt(We.paint_fill["fill-antialias"]),"fill-opacity":new Jt(We.paint_fill["fill-opacity"]),"fill-color":new Jt(We.paint_fill["fill-color"]),"fill-outline-color":new Jt(We.paint_fill["fill-outline-color"]),"fill-translate":new Nt(We.paint_fill["fill-translate"]),"fill-translate-anchor":new Nt(We.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ac(We.paint_fill["fill-pattern"])}),layout:pZ};const gZ=ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),yZ=ei([{name:"a_centroid",components:2,type:"Int16"}],4),{members:vZ}=gZ;var Lc={},_Z=ut,Fk=Ah;function Ah(u,a,d,m,v){this.properties={},this.extent=d,this.type=0,this._pbf=u,this._geometry=-1,this._keys=m,this._values=v,u.readFields(bZ,this,a)}function bZ(u,a,d){u==1?a.id=d.readVarint():u==2?function(m,v){for(var T=m.readVarint()+m.pos;m.pos<T;){var S=v._keys[m.readVarint()],C=v._values[m.readVarint()];v.properties[S]=C}}(d,a):u==3?a.type=d.readVarint():u==4&&(a._geometry=d.pos)}function xZ(u){for(var a,d,m=0,v=0,T=u.length,S=T-1;v<T;S=v++)m+=((d=u[S]).x-(a=u[v]).x)*(a.y+d.y);return m}Ah.types=["Unknown","Point","LineString","Polygon"],Ah.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var a,d=u.readVarint()+u.pos,m=1,v=0,T=0,S=0,C=[];u.pos<d;){if(v<=0){var I=u.readVarint();m=7&I,v=I>>3}if(v--,m===1||m===2)T+=u.readSVarint(),S+=u.readSVarint(),m===1&&(a&&C.push(a),a=[]),a.push(new _Z(T,S));else{if(m!==7)throw new Error("unknown command "+m);a&&a.push(a[0].clone())}}return a&&C.push(a),C},Ah.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var a=u.readVarint()+u.pos,d=1,m=0,v=0,T=0,S=1/0,C=-1/0,I=1/0,F=-1/0;u.pos<a;){if(m<=0){var j=u.readVarint();d=7&j,m=j>>3}if(m--,d===1||d===2)(v+=u.readSVarint())<S&&(S=v),v>C&&(C=v),(T+=u.readSVarint())<I&&(I=T),T>F&&(F=T);else if(d!==7)throw new Error("unknown command "+d)}return[S,I,C,F]},Ah.prototype.toGeoJSON=function(u,a,d){var m,v,T=this.extent*Math.pow(2,d),S=this.extent*u,C=this.extent*a,I=this.loadGeometry(),F=Ah.types[this.type];function j(Q){for(var ee=0;ee<Q.length;ee++){var me=Q[ee];Q[ee]=[360*(me.x+S)/T-180,360/Math.PI*Math.atan(Math.exp((180-360*(me.y+C)/T)*Math.PI/180))-90]}}switch(this.type){case 1:var W=[];for(m=0;m<I.length;m++)W[m]=I[m][0];j(I=W);break;case 2:for(m=0;m<I.length;m++)j(I[m]);break;case 3:for(I=function(Q){var ee=Q.length;if(ee<=1)return[Q];for(var me,pe,$e=[],Be=0;Be<ee;Be++){var Le=xZ(Q[Be]);Le!==0&&(pe===void 0&&(pe=Le<0),pe===Le<0?(me&&$e.push(me),me=[Q[Be]]):me.push(Q[Be]))}return me&&$e.push(me),$e}(I),m=0;m<I.length;m++)for(v=0;v<I[m].length;v++)j(I[m][v])}I.length===1?I=I[0]:F="Multi"+F;var X={type:"Feature",geometry:{type:F,coordinates:I},properties:this.properties};return"id"in this&&(X.id=this.id),X};var wZ=Fk,Nk=zk;function zk(u,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(TZ,this,a),this.length=this._features.length}function TZ(u,a,d){u===15?a.version=d.readVarint():u===1?a.name=d.readString():u===5?a.extent=d.readVarint():u===2?a._features.push(d.pos):u===3?a._keys.push(d.readString()):u===4&&a._values.push(function(m){for(var v=null,T=m.readVarint()+m.pos;m.pos<T;){var S=m.readVarint()>>3;v=S===1?m.readString():S===2?m.readFloat():S===3?m.readDouble():S===4?m.readVarint64():S===5?m.readVarint():S===6?m.readSVarint():S===7?m.readBoolean():null}return v}(d))}zk.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var a=this._pbf.readVarint()+this._pbf.pos;return new wZ(this._pbf,a,this.extent,this._keys,this._values)};var EZ=Nk;function SZ(u,a,d){if(u===3){var m=new EZ(d,d.readVarint()+d.pos);m.length&&(a[m.name]=m)}}Lc.VectorTile=function(u,a){this.layers=u.readFields(SZ,{},a)},Lc.VectorTileFeature=Fk,Lc.VectorTileLayer=Nk;const AZ=Lc.VectorTileFeature.types,bw=Math.pow(2,13);function vm(u,a,d,m,v,T,S,C){u.emplaceBack(a,d,2*Math.floor(m*bw)+S,v*bw*2,T*bw*2,Math.round(C))}class xw{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(d=>d.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new kn,this.centroidVertexArray=new Wt,this.indexArray=new ls,this.programConfigurations=new Xu(a.layers,a.zoom),this.segments=new xn,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(a,d,m){this.features=[],this.hasPattern=yw("fill-extrusion",this.layers,d);for(const{feature:v,id:T,index:S,sourceLayerIndex:C}of a){const I=this.layers[0]._featureFilter.needGeometry,F=Yu(v,I);if(!this.layers[0]._featureFilter.filter(new yr(this.zoom),F,m))continue;const j={id:T,sourceLayerIndex:C,index:S,geometry:I?F.geometry:Zu(v),properties:v.properties,type:v.type,patterns:{}};this.hasPattern?this.features.push(vw("fill-extrusion",this.layers,j,this.zoom,d)):this.addFeature(j,j.geometry,S,m,{}),d.featureIndex.insert(v,j.geometry,S,C,this.index,!0)}}addFeatures(a,d,m){for(const v of this.features){const{geometry:T}=v;this.addFeature(v,T,v.index,d,m)}}update(a,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,d,this.stateDependentLayers,m)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,vZ),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,yZ.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,d,m,v,T){const S={x:0,y:0,vertexCount:0};for(const C of gw(d,500)){let I=0;for(const ee of C)I+=ee.length;let F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const ee of C){if(ee.length===0||CZ(ee))continue;let me=0;for(let pe=0;pe<ee.length;pe++){const $e=ee[pe];if(pe>=1){const Be=ee[pe-1];if(!PZ($e,Be)){F.vertexLength+4>xn.MAX_VERTEX_ARRAY_LENGTH&&(F=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Le=$e.sub(Be)._perp()._unit(),Ne=Be.dist($e);me+Ne>32768&&(me=0),vm(this.layoutVertexArray,$e.x,$e.y,Le.x,Le.y,0,0,me),vm(this.layoutVertexArray,$e.x,$e.y,Le.x,Le.y,0,1,me),S.x+=2*$e.x,S.y+=2*$e.y,S.vertexCount+=2,me+=Ne,vm(this.layoutVertexArray,Be.x,Be.y,Le.x,Le.y,0,0,me),vm(this.layoutVertexArray,Be.x,Be.y,Le.x,Le.y,0,1,me),S.x+=2*Be.x,S.y+=2*Be.y,S.vertexCount+=2;const Ze=F.vertexLength;this.indexArray.emplaceBack(Ze,Ze+2,Ze+1),this.indexArray.emplaceBack(Ze+1,Ze+2,Ze+3),F.vertexLength+=4,F.primitiveLength+=2}}}}if(F.vertexLength+I>xn.MAX_VERTEX_ARRAY_LENGTH&&(F=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray)),AZ[a.type]!=="Polygon")continue;const j=[],W=[],X=F.vertexLength;for(const ee of C)if(ee.length!==0){ee!==C[0]&&W.push(j.length/2);for(let me=0;me<ee.length;me++){const pe=ee[me];vm(this.layoutVertexArray,pe.x,pe.y,0,0,1,1,0),S.x+=pe.x,S.y+=pe.y,S.vertexCount+=1,j.push(pe.x),j.push(pe.y)}}const Q=H0.exports(j,W);for(let ee=0;ee<Q.length;ee+=3)this.indexArray.emplaceBack(X+Q[ee],X+Q[ee+2],X+Q[ee+1]);F.primitiveLength+=Q.length/3,F.vertexLength+=I}for(let C=0;C<S.vertexCount;C++)this.centroidVertexArray.emplaceBack(Math.floor(S.x/S.vertexCount),Math.floor(S.y/S.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,T,v)}}function PZ(u,a){return u.x===a.x&&(u.x<0||u.x>di)||u.y===a.y&&(u.y<0||u.y>di)}function CZ(u){return u.every(a=>a.x<0)||u.every(a=>a.x>di)||u.every(a=>a.y<0)||u.every(a=>a.y>di)}Rt("FillExtrusionBucket",xw,{omit:["layers","features"]});var LZ={paint:new Li({"fill-extrusion-opacity":new Nt(We["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Jt(We["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Nt(We["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Nt(We["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ac(We["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Jt(We["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Jt(We["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Nt(We["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function _m(u,a){return u.x*a.x+u.y*a.y}function Bk(u,a){if(u.length===1){let d=0;const m=a[d++];let v;for(;!v||m.equals(v);)if(v=a[d++],!v)return 1/0;for(;d<a.length;d++){const T=a[d],S=u[0],C=v.sub(m),I=T.sub(m),F=S.sub(m),j=_m(C,C),W=_m(C,I),X=_m(I,I),Q=_m(F,C),ee=_m(F,I),me=j*X-W*W,pe=(X*Q-W*ee)/me,$e=(j*ee-W*Q)/me,Be=m.z*(1-pe-$e)+v.z*pe+T.z*$e;if(isFinite(Be))return Be}return 1/0}{let d=1/0;for(const m of a)d=Math.min(d,m.z);return d}}const IZ=ei([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:RZ}=IZ,MZ=ei([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:$Z}=MZ,kZ=Lc.VectorTileFeature.types,OZ=Math.cos(Math.PI/180*37.5),Uk=Math.pow(2,14)/.5;class ww{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(d=>d.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(d=>{this.gradients[d.id]={}}),this.layoutVertexArray=new Dn,this.layoutVertexArray2=new Jn,this.indexArray=new ls,this.programConfigurations=new Xu(a.layers,a.zoom),this.segments=new xn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}populate(a,d,m){this.hasPattern=yw("line",this.layers,d);const v=this.layers[0].layout.get("line-sort-key"),T=!v.isConstant(),S=[];for(const{feature:C,id:I,index:F,sourceLayerIndex:j}of a){const W=this.layers[0]._featureFilter.needGeometry,X=Yu(C,W);if(!this.layers[0]._featureFilter.filter(new yr(this.zoom),X,m))continue;const Q=T?v.evaluate(X,{},m):void 0,ee={id:I,properties:C.properties,type:C.type,sourceLayerIndex:j,index:F,geometry:W?X.geometry:Zu(C),patterns:{},sortKey:Q};S.push(ee)}T&&S.sort((C,I)=>C.sortKey-I.sortKey);for(const C of S){const{geometry:I,index:F,sourceLayerIndex:j}=C;if(this.hasPattern){const W=vw("line",this.layers,C,this.zoom,d);this.patternFeatures.push(W)}else this.addFeature(C,I,F,m,{});d.featureIndex.insert(a[F].feature,I,F,j,this.index)}}update(a,d,m){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,d,this.stateDependentLayers,m)}addFeatures(a,d,m){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,d,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,$Z)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,RZ),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,d,m,v,T){const S=this.layers[0].layout,C=S.get("line-join").evaluate(a,{}),I=S.get("line-cap"),F=S.get("line-miter-limit"),j=S.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(const W of d)this.addLine(W,a,C,I,F,j);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,m,T,v)}addLine(a,d,m,v,T,S){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let $e=0;$e<a.length-1;$e++)this.totalDistance+=a[$e].dist(a[$e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=kZ[d.type]==="Polygon";let I=a.length;for(;I>=2&&a[I-1].equals(a[I-2]);)I--;let F=0;for(;F<I-1&&a[F].equals(a[F+1]);)F++;if(I<(C?3:2))return;m==="bevel"&&(T=1.05);const j=this.overscaling<=16?122880/(512*this.overscaling):0,W=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let X,Q,ee,me,pe;this.e1=this.e2=-1,C&&(X=a[I-2],pe=a[F].sub(X)._unit()._perp());for(let $e=F;$e<I;$e++){if(ee=$e===I-1?C?a[F+1]:void 0:a[$e+1],ee&&a[$e].equals(ee))continue;pe&&(me=pe),X&&(Q=X),X=a[$e],pe=ee?ee.sub(X)._unit()._perp():me,me=me||pe;let Be=me.add(pe);Be.x===0&&Be.y===0||Be._unit();const Le=me.x*pe.x+me.y*pe.y,Ne=Be.x*pe.x+Be.y*pe.y,Ze=Ne!==0?1/Ne:1/0,Xe=2*Math.sqrt(2-2*Ne),Lt=Ne<OZ&&Q&&ee,Dt=me.x*pe.y-me.y*pe.x>0;if(Lt&&$e>F){const ht=X.dist(Q);if(ht>2*j){const Et=X.sub(X.sub(Q)._mult(j/ht)._round());this.updateDistance(Q,Et),this.addCurrentVertex(Et,me,0,0,W),Q=Et}}const Tt=Q&&ee;let gt=Tt?m:C?"butt":v;if(Tt&&gt==="round"&&(Ze<S?gt="miter":Ze<=2&&(gt="fakeround")),gt==="miter"&&Ze>T&&(gt="bevel"),gt==="bevel"&&(Ze>2&&(gt="flipbevel"),Ze<T&&(gt="miter")),Q&&this.updateDistance(Q,X),gt==="miter")Be._mult(Ze),this.addCurrentVertex(X,Be,0,0,W);else if(gt==="flipbevel"){if(Ze>100)Be=pe.mult(-1);else{const ht=Ze*me.add(pe).mag()/me.sub(pe).mag();Be._perp()._mult(ht*(Dt?-1:1))}this.addCurrentVertex(X,Be,0,0,W),this.addCurrentVertex(X,Be.mult(-1),0,0,W)}else if(gt==="bevel"||gt==="fakeround"){const ht=-Math.sqrt(Ze*Ze-1),Et=Dt?ht:0,_t=Dt?0:ht;if(Q&&this.addCurrentVertex(X,me,Et,_t,W),gt==="fakeround"){const it=Math.round(180*Xe/Math.PI/20);for(let Ht=1;Ht<it;Ht++){let Bt=Ht/it;if(Bt!==.5){const hr=Bt-.5;Bt+=Bt*hr*(Bt-1)*((1.0904+Le*(Le*(3.55645-1.43519*Le)-3.2452))*hr*hr+(.848013+Le*(.215638*Le-1.06021)))}const yn=pe.sub(me)._mult(Bt)._add(me)._unit()._mult(Dt?-1:1);this.addHalfVertex(X,yn.x,yn.y,!1,Dt,0,W)}}ee&&this.addCurrentVertex(X,pe,-Et,-_t,W)}else if(gt==="butt")this.addCurrentVertex(X,Be,0,0,W);else if(gt==="square"){const ht=Q?1:-1;this.addCurrentVertex(X,Be,ht,ht,W)}else gt==="round"&&(Q&&(this.addCurrentVertex(X,me,0,0,W),this.addCurrentVertex(X,me,1,1,W,!0)),ee&&(this.addCurrentVertex(X,pe,-1,-1,W,!0),this.addCurrentVertex(X,pe,0,0,W)));if(Lt&&$e<I-1){const ht=X.dist(ee);if(ht>2*j){const Et=X.add(ee.sub(X)._mult(j/ht)._round());this.updateDistance(X,Et),this.addCurrentVertex(Et,pe,0,0,W),X=Et}}}}addCurrentVertex(a,d,m,v,T,S=!1){const C=d.y*v-d.x,I=-d.y-d.x*v;this.addHalfVertex(a,d.x+d.y*m,d.y-d.x*m,S,!1,m,T),this.addHalfVertex(a,C,I,S,!0,-v,T),this.distance>Uk/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(a,d,m,v,T,S))}addHalfVertex({x:a,y:d},m,v,T,S,C,I){const F=.5*(this.lineClips?this.scaledDistance*(Uk-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(T?1:0),(d<<1)+(S?1:0),Math.round(63*m)+128,Math.round(63*v)+128,1+(C===0?0:C<0?-1:1)|(63&F)<<2,F>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const j=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,j),I.primitiveLength++),S?this.e2=j:this.e1=j}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,d){this.distance+=a.dist(d),this.updateScaledDistance()}}Rt("LineBucket",ww,{omit:["layers","patternFeatures"]});const DZ=new Li({"line-cap":new Nt(We.layout_line["line-cap"]),"line-join":new Jt(We.layout_line["line-join"]),"line-miter-limit":new Nt(We.layout_line["line-miter-limit"]),"line-round-limit":new Nt(We.layout_line["line-round-limit"]),"line-sort-key":new Jt(We.layout_line["line-sort-key"])});var Vk={paint:new Li({"line-opacity":new Jt(We.paint_line["line-opacity"]),"line-color":new Jt(We.paint_line["line-color"]),"line-translate":new Nt(We.paint_line["line-translate"]),"line-translate-anchor":new Nt(We.paint_line["line-translate-anchor"]),"line-width":new Jt(We.paint_line["line-width"]),"line-gap-width":new Jt(We.paint_line["line-gap-width"]),"line-offset":new Jt(We.paint_line["line-offset"]),"line-blur":new Jt(We.paint_line["line-blur"]),"line-dasharray":new om(We.paint_line["line-dasharray"]),"line-pattern":new Ac(We.paint_line["line-pattern"]),"line-gradient":new Na(We.paint_line["line-gradient"])}),layout:DZ};const jk=new class extends Jt{possiblyEvaluate(u,a){return a=new yr(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(u,a)}evaluate(u,a,d,m){return a=L({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(u,a,d,m)}}(Vk.paint.properties["line-width"].specification);function Gk(u,a){return a>0?a+2*u:u}jk.useIntegerZoom=!0;const FZ=ei([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),NZ=ei([{name:"a_projected_pos",components:3,type:"Float32"}],4);ei([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const zZ=ei([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ei([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Wk=ei([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),BZ=ei([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function UZ(u,a,d){return u.sections.forEach(m=>{m.text=function(v,T,S){const C=T.layout.get("text-transform").evaluate(S,{});return C==="uppercase"?v=v.toLocaleUpperCase():C==="lowercase"&&(v=v.toLocaleLowerCase()),js.applyArabicShaping&&(v=js.applyArabicShaping(v)),v}(m.text,a,d)}),u}ei([{name:"triangle",components:3,type:"Uint16"}]),ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ei([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ei([{type:"Float32",name:"offsetX"}]),ei([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const bm={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Ii=24,Tw=tr,Hk=function(u,a,d,m,v){var T,S,C=8*v-m-1,I=(1<<C)-1,F=I>>1,j=-7,W=d?v-1:0,X=d?-1:1,Q=u[a+W];for(W+=X,T=Q&(1<<-j)-1,Q>>=-j,j+=C;j>0;T=256*T+u[a+W],W+=X,j-=8);for(S=T&(1<<-j)-1,T>>=-j,j+=m;j>0;S=256*S+u[a+W],W+=X,j-=8);if(T===0)T=1-F;else{if(T===I)return S?NaN:1/0*(Q?-1:1);S+=Math.pow(2,m),T-=F}return(Q?-1:1)*S*Math.pow(2,T-m)},qk=function(u,a,d,m,v,T){var S,C,I,F=8*T-v-1,j=(1<<F)-1,W=j>>1,X=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,Q=m?0:T-1,ee=m?1:-1,me=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(C=isNaN(a)?1:0,S=j):(S=Math.floor(Math.log(a)/Math.LN2),a*(I=Math.pow(2,-S))<1&&(S--,I*=2),(a+=S+W>=1?X/I:X*Math.pow(2,1-W))*I>=2&&(S++,I/=2),S+W>=j?(C=0,S=j):S+W>=1?(C=(a*I-1)*Math.pow(2,v),S+=W):(C=a*Math.pow(2,W-1)*Math.pow(2,v),S=0));v>=8;u[d+Q]=255&C,Q+=ee,C/=256,v-=8);for(S=S<<v|C,F+=v;F>0;u[d+Q]=255&S,Q+=ee,S/=256,F-=8);u[d+Q-ee]|=128*me};function tr(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}tr.Varint=0,tr.Fixed64=1,tr.Bytes=2,tr.Fixed32=5;var Ic,Ew=4294967296,Kk=1/Ew,Xk=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function El(u){return u.type===tr.Bytes?u.readVarint()+u.pos:u.pos+1}function Ph(u,a,d){return d?4294967296*a+(u>>>0):4294967296*(a>>>0)+(u>>>0)}function Zk(u,a,d){var m=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));d.realloc(m);for(var v=d.pos-1;v>=u;v--)d.buf[v+m]=d.buf[v]}function VZ(u,a){for(var d=0;d<u.length;d++)a.writeVarint(u[d])}function jZ(u,a){for(var d=0;d<u.length;d++)a.writeSVarint(u[d])}function GZ(u,a){for(var d=0;d<u.length;d++)a.writeFloat(u[d])}function WZ(u,a){for(var d=0;d<u.length;d++)a.writeDouble(u[d])}function HZ(u,a){for(var d=0;d<u.length;d++)a.writeBoolean(u[d])}function qZ(u,a){for(var d=0;d<u.length;d++)a.writeFixed32(u[d])}function KZ(u,a){for(var d=0;d<u.length;d++)a.writeSFixed32(u[d])}function XZ(u,a){for(var d=0;d<u.length;d++)a.writeFixed64(u[d])}function ZZ(u,a){for(var d=0;d<u.length;d++)a.writeSFixed64(u[d])}function Y0(u,a){return(u[a]|u[a+1]<<8|u[a+2]<<16)+16777216*u[a+3]}function Ch(u,a,d){u[d]=a,u[d+1]=a>>>8,u[d+2]=a>>>16,u[d+3]=a>>>24}function Yk(u,a){return(u[a]|u[a+1]<<8|u[a+2]<<16)+(u[a+3]<<24)}function YZ(u,a,d){u===1&&d.readMessage(JZ,a)}function JZ(u,a,d){if(u===3){const{id:m,bitmap:v,width:T,height:S,left:C,top:I,advance:F}=d.readMessage(QZ,{});a.push({id:m,bitmap:new fm({width:T+6,height:S+6},v),metrics:{width:T,height:S,left:C,top:I,advance:F}})}}function QZ(u,a,d){u===1?a.id=d.readVarint():u===2?a.bitmap=d.readBytes():u===3?a.width=d.readVarint():u===4?a.height=d.readVarint():u===5?a.left=d.readSVarint():u===6?a.top=d.readSVarint():u===7&&(a.advance=d.readVarint())}function Jk(u){let a=0,d=0;for(const S of u)a+=S.w*S.h,d=Math.max(d,S.w);u.sort((S,C)=>C.h-S.h);const m=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),d),h:1/0}];let v=0,T=0;for(const S of u)for(let C=m.length-1;C>=0;C--){const I=m[C];if(!(S.w>I.w||S.h>I.h)){if(S.x=I.x,S.y=I.y,T=Math.max(T,S.y+S.h),v=Math.max(v,S.x+S.w),S.w===I.w&&S.h===I.h){const F=m.pop();C<m.length&&(m[C]=F)}else S.h===I.h?(I.x+=S.w,I.w-=S.w):S.w===I.w?(I.y+=S.h,I.h-=S.h):(m.push({x:I.x+S.w,y:I.y,w:I.w-S.w,h:S.h}),I.y+=S.h,I.h-=S.h);break}}return{w:v,h:T,fill:a/(v*T)||0}}tr.prototype={destroy:function(){this.buf=null},readFields:function(u,a,d){for(d=d||this.length;this.pos<d;){var m=this.readVarint(),v=m>>3,T=this.pos;this.type=7&m,u(v,a,this),this.pos===T&&this.skip(m)}return a},readMessage:function(u,a){return this.readFields(u,a,this.readVarint()+this.pos)},readFixed32:function(){var u=Y0(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=Yk(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=Y0(this.buf,this.pos)+Y0(this.buf,this.pos+4)*Ew;return this.pos+=8,u},readSFixed64:function(){var u=Y0(this.buf,this.pos)+Yk(this.buf,this.pos+4)*Ew;return this.pos+=8,u},readFloat:function(){var u=Hk(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=Hk(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var a,d,m=this.buf;return a=127&(d=m[this.pos++]),d<128?a:(a|=(127&(d=m[this.pos++]))<<7,d<128?a:(a|=(127&(d=m[this.pos++]))<<14,d<128?a:(a|=(127&(d=m[this.pos++]))<<21,d<128?a:function(v,T,S){var C,I,F=S.buf;if(C=(112&(I=F[S.pos++]))>>4,I<128||(C|=(127&(I=F[S.pos++]))<<3,I<128)||(C|=(127&(I=F[S.pos++]))<<10,I<128)||(C|=(127&(I=F[S.pos++]))<<17,I<128)||(C|=(127&(I=F[S.pos++]))<<24,I<128)||(C|=(1&(I=F[S.pos++]))<<31,I<128))return Ph(v,C,T);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(d=m[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,a=this.pos;return this.pos=u,u-a>=12&&Xk?function(d,m,v){return Xk.decode(d.subarray(m,v))}(this.buf,a,u):function(d,m,v){for(var T="",S=m;S<v;){var C,I,F,j=d[S],W=null,X=j>239?4:j>223?3:j>191?2:1;if(S+X>v)break;X===1?j<128&&(W=j):X===2?(192&(C=d[S+1]))==128&&(W=(31&j)<<6|63&C)<=127&&(W=null):X===3?(I=d[S+2],(192&(C=d[S+1]))==128&&(192&I)==128&&((W=(15&j)<<12|(63&C)<<6|63&I)<=2047||W>=55296&&W<=57343)&&(W=null)):X===4&&(I=d[S+2],F=d[S+3],(192&(C=d[S+1]))==128&&(192&I)==128&&(192&F)==128&&((W=(15&j)<<18|(63&C)<<12|(63&I)<<6|63&F)<=65535||W>=1114112)&&(W=null)),W===null?(W=65533,X=1):W>65535&&(W-=65536,T+=String.fromCharCode(W>>>10&1023|55296),W=56320|1023&W),T+=String.fromCharCode(W),S+=X}return T}(this.buf,a,u)},readBytes:function(){var u=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,u);return this.pos=u,a},readPackedVarint:function(u,a){if(this.type!==tr.Bytes)return u.push(this.readVarint(a));var d=El(this);for(u=u||[];this.pos<d;)u.push(this.readVarint(a));return u},readPackedSVarint:function(u){if(this.type!==tr.Bytes)return u.push(this.readSVarint());var a=El(this);for(u=u||[];this.pos<a;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==tr.Bytes)return u.push(this.readBoolean());var a=El(this);for(u=u||[];this.pos<a;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==tr.Bytes)return u.push(this.readFloat());var a=El(this);for(u=u||[];this.pos<a;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==tr.Bytes)return u.push(this.readDouble());var a=El(this);for(u=u||[];this.pos<a;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==tr.Bytes)return u.push(this.readFixed32());var a=El(this);for(u=u||[];this.pos<a;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==tr.Bytes)return u.push(this.readSFixed32());var a=El(this);for(u=u||[];this.pos<a;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==tr.Bytes)return u.push(this.readFixed64());var a=El(this);for(u=u||[];this.pos<a;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==tr.Bytes)return u.push(this.readSFixed64());var a=El(this);for(u=u||[];this.pos<a;)u.push(this.readSFixed64());return u},skip:function(u){var a=7&u;if(a===tr.Varint)for(;this.buf[this.pos++]>127;);else if(a===tr.Bytes)this.pos=this.readVarint()+this.pos;else if(a===tr.Fixed32)this.pos+=4;else{if(a!==tr.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(u,a){this.writeVarint(u<<3|a)},realloc:function(u){for(var a=this.length||16;a<this.pos+u;)a*=2;if(a!==this.length){var d=new Uint8Array(a);d.set(this.buf),this.buf=d,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),Ch(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),Ch(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),Ch(this.buf,-1&u,this.pos),Ch(this.buf,Math.floor(u*Kk),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),Ch(this.buf,-1&u,this.pos),Ch(this.buf,Math.floor(u*Kk),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(a,d){var m,v;if(a>=0?(m=a%4294967296|0,v=a/4294967296|0):(v=~(-a/4294967296),4294967295^(m=~(-a%4294967296))?m=m+1|0:(m=0,v=v+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");d.realloc(10),function(T,S,C){C.buf[C.pos++]=127&T|128,T>>>=7,C.buf[C.pos++]=127&T|128,T>>>=7,C.buf[C.pos++]=127&T|128,T>>>=7,C.buf[C.pos++]=127&T|128,C.buf[C.pos]=127&(T>>>=7)}(m,0,d),function(T,S){var C=(7&T)<<4;S.buf[S.pos++]|=C|((T>>>=3)?128:0),T&&(S.buf[S.pos++]=127&T|((T>>>=7)?128:0),T&&(S.buf[S.pos++]=127&T|((T>>>=7)?128:0),T&&(S.buf[S.pos++]=127&T|((T>>>=7)?128:0),T&&(S.buf[S.pos++]=127&T|((T>>>=7)?128:0),T&&(S.buf[S.pos++]=127&T)))))}(v,d)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var a=this.pos;this.pos=function(m,v,T){for(var S,C,I=0;I<v.length;I++){if((S=v.charCodeAt(I))>55295&&S<57344){if(!C){S>56319||I+1===v.length?(m[T++]=239,m[T++]=191,m[T++]=189):C=S;continue}if(S<56320){m[T++]=239,m[T++]=191,m[T++]=189,C=S;continue}S=C-55296<<10|S-56320|65536,C=null}else C&&(m[T++]=239,m[T++]=191,m[T++]=189,C=null);S<128?m[T++]=S:(S<2048?m[T++]=S>>6|192:(S<65536?m[T++]=S>>12|224:(m[T++]=S>>18|240,m[T++]=S>>12&63|128),m[T++]=S>>6&63|128),m[T++]=63&S|128)}return T}(this.buf,u,this.pos);var d=this.pos-a;d>=128&&Zk(a,d,this),this.pos=a-1,this.writeVarint(d),this.pos+=d},writeFloat:function(u){this.realloc(4),qk(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),qk(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var a=u.length;this.writeVarint(a),this.realloc(a);for(var d=0;d<a;d++)this.buf[this.pos++]=u[d]},writeRawMessage:function(u,a){this.pos++;var d=this.pos;u(a,this);var m=this.pos-d;m>=128&&Zk(d,m,this),this.pos=d-1,this.writeVarint(m),this.pos+=m},writeMessage:function(u,a,d){this.writeTag(u,tr.Bytes),this.writeRawMessage(a,d)},writePackedVarint:function(u,a){a.length&&this.writeMessage(u,VZ,a)},writePackedSVarint:function(u,a){a.length&&this.writeMessage(u,jZ,a)},writePackedBoolean:function(u,a){a.length&&this.writeMessage(u,HZ,a)},writePackedFloat:function(u,a){a.length&&this.writeMessage(u,GZ,a)},writePackedDouble:function(u,a){a.length&&this.writeMessage(u,WZ,a)},writePackedFixed32:function(u,a){a.length&&this.writeMessage(u,qZ,a)},writePackedSFixed32:function(u,a){a.length&&this.writeMessage(u,KZ,a)},writePackedFixed64:function(u,a){a.length&&this.writeMessage(u,XZ,a)},writePackedSFixed64:function(u,a){a.length&&this.writeMessage(u,ZZ,a)},writeBytesField:function(u,a){this.writeTag(u,tr.Bytes),this.writeBytes(a)},writeFixed32Field:function(u,a){this.writeTag(u,tr.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(u,a){this.writeTag(u,tr.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(u,a){this.writeTag(u,tr.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(u,a){this.writeTag(u,tr.Fixed64),this.writeSFixed64(a)},writeVarintField:function(u,a){this.writeTag(u,tr.Varint),this.writeVarint(a)},writeSVarintField:function(u,a){this.writeTag(u,tr.Varint),this.writeSVarint(a)},writeStringField:function(u,a){this.writeTag(u,tr.Bytes),this.writeString(a)},writeFloatField:function(u,a){this.writeTag(u,tr.Fixed32),this.writeFloat(a)},writeDoubleField:function(u,a){this.writeTag(u,tr.Fixed64),this.writeDouble(a)},writeBooleanField:function(u,a){this.writeVarintField(u,!!a)}};class Sw{constructor(a,{pixelRatio:d,version:m,stretchX:v,stretchY:T,content:S}){this.paddedRect=a,this.pixelRatio=d,this.stretchX=v,this.stretchY=T,this.content=S,this.version=m}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Qk{constructor(a,d){const m={},v={};this.haveRenderCallbacks=[];const T=[];this.addImages(a,m,T),this.addImages(d,v,T);const{w:S,h:C}=Jk(T),I=new uo({width:S||1,height:C||1});for(const F in a){const j=a[F],W=m[F].paddedRect;uo.copy(j.data,I,{x:0,y:0},{x:W.x+1,y:W.y+1},j.data)}for(const F in d){const j=d[F],W=v[F].paddedRect,X=W.x+1,Q=W.y+1,ee=j.data.width,me=j.data.height;uo.copy(j.data,I,{x:0,y:0},{x:X,y:Q},j.data),uo.copy(j.data,I,{x:0,y:me-1},{x:X,y:Q-1},{width:ee,height:1}),uo.copy(j.data,I,{x:0,y:0},{x:X,y:Q+me},{width:ee,height:1}),uo.copy(j.data,I,{x:ee-1,y:0},{x:X-1,y:Q},{width:1,height:me}),uo.copy(j.data,I,{x:0,y:0},{x:X+ee,y:Q},{width:1,height:me})}this.image=I,this.iconPositions=m,this.patternPositions=v}addImages(a,d,m){for(const v in a){const T=a[v],S={x:0,y:0,w:T.data.width+2,h:T.data.height+2};m.push(S),d[v]=new Sw(S,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(v)}}patchUpdatedImages(a,d){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const m in a.updatedImages)this.patchUpdatedImage(this.iconPositions[m],a.getImage(m),d),this.patchUpdatedImage(this.patternPositions[m],a.getImage(m),d)}patchUpdatedImage(a,d,m){if(!a||!d||a.version===d.version)return;a.version=d.version;const[v,T]=a.tl;m.update(d.data,void 0,{x:v,y:T})}}Rt("ImagePosition",Sw),Rt("ImageAtlas",Qk),o.WritingMode=void 0,(Ic=o.WritingMode||(o.WritingMode={}))[Ic.none=0]="none",Ic[Ic.horizontal=1]="horizontal",Ic[Ic.vertical=2]="vertical",Ic[Ic.horizontalOnly=3]="horizontalOnly";const J0=-17;class xm{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,d){const m=new xm;return m.scale=a||1,m.fontStack=d,m}static forImage(a){const d=new xm;return d.imageName=a,d}}class Lh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,d){const m=new Lh;for(let v=0;v<a.sections.length;v++){const T=a.sections[v];T.image?m.addImageSection(T):m.addTextSection(T,d)}return m}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(){this.text=function(a){let d="";for(let m=0;m<a.length;m++){const v=a.charCodeAt(m+1)||null,T=a.charCodeAt(m-1)||null;d+=v&&M0(v)&&!bm[a[m+1]]||T&&M0(T)&&!bm[a[m-1]]||!bm[a[m]]?a[m]:bm[a[m]]}return d}(this.text)}trim(){let a=0;for(let m=0;m<this.text.length&&ev[this.text.charCodeAt(m)];m++)a++;let d=this.text.length;for(let m=this.text.length-1;m>=0&&m>=a&&ev[this.text.charCodeAt(m)];m--)d--;this.text=this.text.substring(a,d),this.sectionIndex=this.sectionIndex.slice(a,d)}substring(a,d){const m=new Lh;return m.text=this.text.substring(a,d),m.sectionIndex=this.sectionIndex.slice(a,d),m.sections=this.sections,m}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,d)=>Math.max(a,this.sections[d].scale),0)}addTextSection(a,d){this.text+=a.text,this.sections.push(xm.forText(a.scale,a.fontStack||d));const m=this.sections.length-1;for(let v=0;v<a.text.length;++v)this.sectionIndex.push(m)}addImageSection(a){const d=a.image?a.image.name:"";if(d.length===0)return void Z("Can't add FormattedSection with an empty image.");const m=this.getNextImageSectionCharCode();m?(this.text+=String.fromCharCode(m),this.sections.push(xm.forImage(d)),this.sectionIndex.push(this.sections.length-1)):Z("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Q0(u,a,d,m,v,T,S,C,I,F,j,W,X,Q,ee,me){const pe=Lh.fromFeature(u,v);let $e;W===o.WritingMode.vertical&&pe.verticalizePunctuation();const{processBidirectionalText:Be,processStyledBidirectionalText:Le}=js;if(Be&&pe.sections.length===1){$e=[];const Xe=Be(pe.toString(),Aw(pe,F,T,a,m,Q,ee));for(const Lt of Xe){const Dt=new Lh;Dt.text=Lt,Dt.sections=pe.sections;for(let Tt=0;Tt<Lt.length;Tt++)Dt.sectionIndex.push(0);$e.push(Dt)}}else if(Le){$e=[];const Xe=Le(pe.text,pe.sectionIndex,Aw(pe,F,T,a,m,Q,ee));for(const Lt of Xe){const Dt=new Lh;Dt.text=Lt[0],Dt.sectionIndex=Lt[1],Dt.sections=pe.sections,$e.push(Dt)}}else $e=function(Xe,Lt){const Dt=[],Tt=Xe.text;let gt=0;for(const ht of Lt)Dt.push(Xe.substring(gt,ht)),gt=ht;return gt<Tt.length&&Dt.push(Xe.substring(gt,Tt.length)),Dt}(pe,Aw(pe,F,T,a,m,Q,ee));const Ne=[],Ze={positionedLines:Ne,text:pe.toString(),top:j[1],bottom:j[1],left:j[0],right:j[0],writingMode:W,iconsInText:!1,verticalizable:!1};return function(Xe,Lt,Dt,Tt,gt,ht,Et,_t,it,Ht,Bt,yn){let hr=0,_r=J0,hi=0,fo=0;const Fi=_t==="right"?1:_t==="left"?0:.5;let ti=0;for(const ni of gt){ni.trim();const zi=ni.getMaxScale(),Zi=(zi-1)*Ii,ds={positionedGlyphs:[],lineOffset:0};Xe.positionedLines[ti]=ds;const As=ds.positionedGlyphs;let Ps=0;if(!ni.length()){_r+=ht,++ti;continue}for(let wi=0;wi<ni.length();wi++){const Sn=ni.getSection(wi),Hs=ni.getSectionIndex(wi),Bi=ni.getCharCode(wi);let Yi=0,Bo=null,aa=null,la=null,Al=Ii;const Uo=!(it===o.WritingMode.horizontal||!Bt&&!em(Bi)||Bt&&(ev[Bi]||(xi=Bi,wt.Arabic(xi)||wt["Arabic Supplement"](xi)||wt["Arabic Extended-A"](xi)||wt["Arabic Presentation Forms-A"](xi)||wt["Arabic Presentation Forms-B"](xi))));if(Sn.imageName){const po=Tt[Sn.imageName];if(!po)continue;la=Sn.imageName,Xe.iconsInText=Xe.iconsInText||!0,aa=po.paddedRect;const Cs=po.displaySize;Sn.scale=Sn.scale*Ii/yn,Bo={width:Cs[0],height:Cs[1],left:1,top:-3,advance:Uo?Cs[1]:Cs[0]},Yi=Zi+(Ii-Cs[1]*Sn.scale),Al=Bo.advance;const Pl=Uo?Cs[0]*Sn.scale-Ii*zi:Cs[1]*Sn.scale-Ii*zi;Pl>0&&Pl>Ps&&(Ps=Pl)}else{const po=Dt[Sn.fontStack],Cs=po&&po[Bi];if(Cs&&Cs.rect)aa=Cs.rect,Bo=Cs.metrics;else{const Pl=Lt[Sn.fontStack],Em=Pl&&Pl[Bi];if(!Em)continue;Bo=Em.metrics}Yi=(zi-Sn.scale)*Ii}Uo?(Xe.verticalizable=!0,As.push({glyph:Bi,imageName:la,x:hr,y:_r+Yi,vertical:Uo,scale:Sn.scale,fontStack:Sn.fontStack,sectionIndex:Hs,metrics:Bo,rect:aa}),hr+=Al*Sn.scale+Ht):(As.push({glyph:Bi,imageName:la,x:hr,y:_r+Yi,vertical:Uo,scale:Sn.scale,fontStack:Sn.fontStack,sectionIndex:Hs,metrics:Bo,rect:aa}),hr+=Bo.advance*Sn.scale+Ht)}As.length!==0&&(hi=Math.max(hr-Ht,hi),nY(As,0,As.length-1,Fi,Ps)),hr=0;const wr=ht*zi+Ps;ds.lineOffset=Math.max(Ps,Zi),_r+=wr,fo=Math.max(wr,fo),++ti}var xi;const Ni=_r-J0,{horizontalAlign:Xi,verticalAlign:Ss}=Pw(Et);(function(ni,zi,Zi,ds,As,Ps,wr,wi,Sn){const Hs=(zi-Zi)*As;let Bi=0;Bi=Ps!==wr?-wi*ds-J0:(-ds*Sn+.5)*wr;for(const Yi of ni)for(const Bo of Yi.positionedGlyphs)Bo.x+=Hs,Bo.y+=Bi})(Xe.positionedLines,Fi,Xi,Ss,hi,fo,ht,Ni,gt.length),Xe.top+=-Ss*Ni,Xe.bottom=Xe.top+Ni,Xe.left+=-Xi*hi,Xe.right=Xe.left+hi}(Ze,a,d,m,$e,S,C,I,W,F,X,me),!function(Xe){for(const Lt of Xe)if(Lt.positionedGlyphs.length!==0)return!1;return!0}(Ne)&&Ze}const ev={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},eY={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function e6(u,a,d,m,v,T){if(a.imageName){const S=m[a.imageName];return S?S.displaySize[0]*a.scale*Ii/T+v:0}{const S=d[a.fontStack],C=S&&S[u];return C?C.metrics.advance*a.scale+v:0}}function t6(u,a,d,m){const v=Math.pow(u-a,2);return m?u<a?v/2:2*v:v+Math.abs(d)*d}function tY(u,a,d){let m=0;return u===10&&(m-=1e4),d&&(m+=150),u!==40&&u!==65288||(m+=50),a!==41&&a!==65289||(m+=50),m}function n6(u,a,d,m,v,T){let S=null,C=t6(a,d,v,T);for(const I of m){const F=t6(a-I.x,d,v,T)+I.badness;F<=C&&(S=I,C=F)}return{index:u,x:a,priorBreak:S,badness:C}}function r6(u){return u?r6(u.priorBreak).concat(u.index):[]}function Aw(u,a,d,m,v,T,S){if(T!=="point")return[];if(!u)return[];const C=[],I=function(X,Q,ee,me,pe,$e){let Be=0;for(let Le=0;Le<X.length();Le++){const Ne=X.getSection(Le);Be+=e6(X.getCharCode(Le),Ne,me,pe,Q,$e)}return Be/Math.max(1,Math.ceil(Be/ee))}(u,a,d,m,v,S),F=u.text.indexOf("")>=0;let j=0;for(let X=0;X<u.length();X++){const Q=u.getSection(X),ee=u.getCharCode(X);if(ev[ee]||(j+=e6(ee,Q,m,v,a,S)),X<u.length()-1){const me=!((W=ee)<11904||!(wt["Bopomofo Extended"](W)||wt.Bopomofo(W)||wt["CJK Compatibility Forms"](W)||wt["CJK Compatibility Ideographs"](W)||wt["CJK Compatibility"](W)||wt["CJK Radicals Supplement"](W)||wt["CJK Strokes"](W)||wt["CJK Symbols and Punctuation"](W)||wt["CJK Unified Ideographs Extension A"](W)||wt["CJK Unified Ideographs"](W)||wt["Enclosed CJK Letters and Months"](W)||wt["Halfwidth and Fullwidth Forms"](W)||wt.Hiragana(W)||wt["Ideographic Description Characters"](W)||wt["Kangxi Radicals"](W)||wt["Katakana Phonetic Extensions"](W)||wt.Katakana(W)||wt["Vertical Forms"](W)||wt["Yi Radicals"](W)||wt["Yi Syllables"](W)));(eY[ee]||me||Q.imageName)&&C.push(n6(X+1,j,I,C,tY(ee,u.getCharCode(X+1),me&&F),!1))}}var W;return r6(n6(u.length(),j,I,C,0,!0))}function Pw(u){let a=.5,d=.5;switch(u){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":d=1;break;case"top":case"top-right":case"top-left":d=0}return{horizontalAlign:a,verticalAlign:d}}function nY(u,a,d,m,v){if(!m&&!v)return;const T=u[d],S=(u[d].x+T.metrics.advance*T.scale)*m;for(let C=a;C<=d;C++)u[C].x-=S,u[C].y+=v}function rY(u,a,d){const{horizontalAlign:m,verticalAlign:v}=Pw(d),T=a[0]-u.displaySize[0]*m,S=a[1]-u.displaySize[1]*v;return{image:u,top:S,bottom:S+u.displaySize[1],left:T,right:T+u.displaySize[0]}}function i6(u,a,d,m,v,T){const S=u.image;let C;if(S.content){const pe=S.content,$e=S.pixelRatio||1;C=[pe[0]/$e,pe[1]/$e,S.displaySize[0]-pe[2]/$e,S.displaySize[1]-pe[3]/$e]}const I=a.left*T,F=a.right*T;let j,W,X,Q;d==="width"||d==="both"?(Q=v[0]+I-m[3],W=v[0]+F+m[1]):(Q=v[0]+(I+F-S.displaySize[0])/2,W=Q+S.displaySize[0]);const ee=a.top*T,me=a.bottom*T;return d==="height"||d==="both"?(j=v[1]+ee-m[0],X=v[1]+me+m[2]):(j=v[1]+(ee+me-S.displaySize[1])/2,X=j+S.displaySize[1]),{image:S,top:j,right:W,bottom:X,left:Q,collisionPadding:C}}const Sl=128;function s6(u,a){const{expression:d}=a;if(d.kind==="constant")return{kind:"constant",layoutSize:d.evaluate(new yr(u+1))};if(d.kind==="source")return{kind:"source"};{const{zoomStops:m,interpolationType:v}=d;let T=0;for(;T<m.length&&m[T]<=u;)T++;T=Math.max(0,T-1);let S=T;for(;S<m.length&&m[S]<u+1;)S++;S=Math.min(m.length-1,S);const C=m[T],I=m[S];return d.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:I,interpolationType:v}:{kind:"camera",minZoom:C,maxZoom:I,minSize:d.evaluate(new yr(C)),maxSize:d.evaluate(new yr(I)),interpolationType:v}}}class Rc extends ut{constructor(a,d,m,v){super(a,d),this.angle=m,v!==void 0&&(this.segment=v)}clone(){return new Rc(this.x,this.y,this.angle,this.segment)}}function o6(u,a,d,m,v){if(a.segment===void 0)return!0;let T=a,S=a.segment+1,C=0;for(;C>-d/2;){if(S--,S<0)return!1;C-=u[S].dist(T),T=u[S]}C+=u[S].dist(u[S+1]),S++;const I=[];let F=0;for(;C<d/2;){const j=u[S],W=u[S+1];if(!W)return!1;let X=u[S-1].angleTo(j)-j.angleTo(W);for(X=Math.abs((X+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:C,angleDelta:X}),F+=X;C-I[0].distance>m;)F-=I.shift().angleDelta;if(F>v)return!1;S++,C+=j.dist(W)}return!0}function a6(u){let a=0;for(let d=0;d<u.length-1;d++)a+=u[d].dist(u[d+1]);return a}function l6(u,a,d){return u?.6*a*d:0}function c6(u,a){return Math.max(u?u.right-u.left:0,a?a.right-a.left:0)}function iY(u,a,d,m,v,T){const S=l6(d,v,T),C=c6(d,m)*T;let I=0;const F=a6(u)/2;for(let j=0;j<u.length-1;j++){const W=u[j],X=u[j+1],Q=W.dist(X);if(I+Q>F){const ee=(F-I)/Q,me=mn(W.x,X.x,ee),pe=mn(W.y,X.y,ee),$e=new Rc(me,pe,X.angleTo(W),j);return $e._round(),!S||o6(u,$e,C,S,a)?$e:void 0}I+=Q}}function sY(u,a,d,m,v,T,S,C,I){const F=l6(m,T,S),j=c6(m,v),W=j*S,X=u[0].x===0||u[0].x===I||u[0].y===0||u[0].y===I;return a-W<a/4&&(a=W+a/4),u6(u,X?a/2*C%a:(j/2+2*T)*S*C%a,a,F,d,W,X,!1,I)}function u6(u,a,d,m,v,T,S,C,I){const F=T/2,j=a6(u);let W=0,X=a-d,Q=[];for(let ee=0;ee<u.length-1;ee++){const me=u[ee],pe=u[ee+1],$e=me.dist(pe),Be=pe.angleTo(me);for(;X+d<W+$e;){X+=d;const Le=(X-W)/$e,Ne=mn(me.x,pe.x,Le),Ze=mn(me.y,pe.y,Le);if(Ne>=0&&Ne<I&&Ze>=0&&Ze<I&&X-F>=0&&X+F<=j){const Xe=new Rc(Ne,Ze,Be,ee);Xe._round(),m&&!o6(u,Xe,T,m,v)||Q.push(Xe)}}W+=$e}return C||Q.length||S||(Q=u6(u,W/2,d,m,v,T,S,!0,I)),Q}function d6(u,a,d,m,v){const T=[];for(let S=0;S<u.length;S++){const C=u[S];let I;for(let F=0;F<C.length-1;F++){let j=C[F],W=C[F+1];j.x<a&&W.x<a||(j.x<a?j=new ut(a,j.y+(a-j.x)/(W.x-j.x)*(W.y-j.y))._round():W.x<a&&(W=new ut(a,j.y+(a-j.x)/(W.x-j.x)*(W.y-j.y))._round()),j.y<d&&W.y<d||(j.y<d?j=new ut(j.x+(d-j.y)/(W.y-j.y)*(W.x-j.x),d)._round():W.y<d&&(W=new ut(j.x+(d-j.y)/(W.y-j.y)*(W.x-j.x),d)._round()),j.x>=m&&W.x>=m||(j.x>=m?j=new ut(m,j.y+(m-j.x)/(W.x-j.x)*(W.y-j.y))._round():W.x>=m&&(W=new ut(m,j.y+(m-j.x)/(W.x-j.x)*(W.y-j.y))._round()),j.y>=v&&W.y>=v||(j.y>=v?j=new ut(j.x+(v-j.y)/(W.y-j.y)*(W.x-j.x),v)._round():W.y>=v&&(W=new ut(j.x+(v-j.y)/(W.y-j.y)*(W.x-j.x),v)._round()),I&&j.equals(I[I.length-1])||(I=[j],T.push(I)),I.push(W)))))}}return T}function h6(u,a,d,m){const v=[],T=u.image,S=T.pixelRatio,C=T.paddedRect.w-2,I=T.paddedRect.h-2,F=u.right-u.left,j=u.bottom-u.top,W=T.stretchX||[[0,C]],X=T.stretchY||[[0,I]],Q=(ht,Et)=>ht+Et[1]-Et[0],ee=W.reduce(Q,0),me=X.reduce(Q,0),pe=C-ee,$e=I-me;let Be=0,Le=ee,Ne=0,Ze=me,Xe=0,Lt=pe,Dt=0,Tt=$e;if(T.content&&m){const ht=T.content;Be=tv(W,0,ht[0]),Ne=tv(X,0,ht[1]),Le=tv(W,ht[0],ht[2]),Ze=tv(X,ht[1],ht[3]),Xe=ht[0]-Be,Dt=ht[1]-Ne,Lt=ht[2]-ht[0]-Le,Tt=ht[3]-ht[1]-Ze}const gt=(ht,Et,_t,it)=>{const Ht=nv(ht.stretch-Be,Le,F,u.left),Bt=rv(ht.fixed-Xe,Lt,ht.stretch,ee),yn=nv(Et.stretch-Ne,Ze,j,u.top),hr=rv(Et.fixed-Dt,Tt,Et.stretch,me),_r=nv(_t.stretch-Be,Le,F,u.left),hi=rv(_t.fixed-Xe,Lt,_t.stretch,ee),fo=nv(it.stretch-Ne,Ze,j,u.top),Fi=rv(it.fixed-Dt,Tt,it.stretch,me),ti=new ut(Ht,yn),xi=new ut(_r,yn),Ni=new ut(_r,fo),Xi=new ut(Ht,fo),Ss=new ut(Bt/S,hr/S),ni=new ut(hi/S,Fi/S),zi=a*Math.PI/180;if(zi){const As=Math.sin(zi),Ps=Math.cos(zi),wr=[Ps,-As,As,Ps];ti._matMult(wr),xi._matMult(wr),Xi._matMult(wr),Ni._matMult(wr)}const Zi=ht.stretch+ht.fixed,ds=Et.stretch+Et.fixed;return{tl:ti,tr:xi,bl:Xi,br:Ni,tex:{x:T.paddedRect.x+1+Zi,y:T.paddedRect.y+1+ds,w:_t.stretch+_t.fixed-Zi,h:it.stretch+it.fixed-ds},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ss,pixelOffsetBR:ni,minFontScaleX:Lt/S/F,minFontScaleY:Tt/S/j,isSDF:d}};if(m&&(T.stretchX||T.stretchY)){const ht=f6(W,pe,ee),Et=f6(X,$e,me);for(let _t=0;_t<ht.length-1;_t++){const it=ht[_t],Ht=ht[_t+1];for(let Bt=0;Bt<Et.length-1;Bt++)v.push(gt(it,Et[Bt],Ht,Et[Bt+1]))}}else v.push(gt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:I+1}));return v}function tv(u,a,d){let m=0;for(const v of u)m+=Math.max(a,Math.min(d,v[1]))-Math.max(a,Math.min(d,v[0]));return m}function f6(u,a,d){const m=[{fixed:-1,stretch:0}];for(const[v,T]of u){const S=m[m.length-1];m.push({fixed:v-S.stretch,stretch:S.stretch}),m.push({fixed:v-S.stretch,stretch:S.stretch+(T-v)})}return m.push({fixed:a+1,stretch:d}),m}function nv(u,a,d,m){return u/a*d+m}function rv(u,a,d,m){return u-a*d/m}Rt("Anchor",Rc);class iv{constructor(a,d,m,v,T,S,C,I,F,j){if(this.boxStartIndex=a.length,F){let W=S.top,X=S.bottom;const Q=S.collisionPadding;Q&&(W-=Q[1],X+=Q[3]);let ee=X-W;ee>0&&(ee=Math.max(10,ee),this.circleDiameter=ee)}else{let W=S.top*C-I[0],X=S.bottom*C+I[2],Q=S.left*C-I[3],ee=S.right*C+I[1];const me=S.collisionPadding;if(me&&(Q-=me[0]*C,W-=me[1]*C,ee+=me[2]*C,X+=me[3]*C),j){const pe=new ut(Q,W),$e=new ut(ee,W),Be=new ut(Q,X),Le=new ut(ee,X),Ne=j*Math.PI/180;pe._rotate(Ne),$e._rotate(Ne),Be._rotate(Ne),Le._rotate(Ne),Q=Math.min(pe.x,$e.x,Be.x,Le.x),ee=Math.max(pe.x,$e.x,Be.x,Le.x),W=Math.min(pe.y,$e.y,Be.y,Le.y),X=Math.max(pe.y,$e.y,Be.y,Le.y)}a.emplaceBack(d.x,d.y,Q,W,ee,X,m,v,T)}this.boxEndIndex=a.length}}class oY{constructor(a=[],d=aY){if(this.data=a,this.length=this.data.length,this.compare=d,this.length>0)for(let m=(this.length>>1)-1;m>=0;m--)this._down(m)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const a=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:d,compare:m}=this,v=d[a];for(;a>0;){const T=a-1>>1,S=d[T];if(m(v,S)>=0)break;d[a]=S,a=T}d[a]=v}_down(a){const{data:d,compare:m}=this,v=this.length>>1,T=d[a];for(;a<v;){let S=1+(a<<1),C=d[S];const I=S+1;if(I<this.length&&m(d[I],C)<0&&(S=I,C=d[I]),m(C,T)>=0)break;d[a]=C,a=S}d[a]=T}}function aY(u,a){return u<a?-1:u>a?1:0}function lY(u,a=1,d=!1){let m=1/0,v=1/0,T=-1/0,S=-1/0;const C=u[0];for(let Q=0;Q<C.length;Q++){const ee=C[Q];(!Q||ee.x<m)&&(m=ee.x),(!Q||ee.y<v)&&(v=ee.y),(!Q||ee.x>T)&&(T=ee.x),(!Q||ee.y>S)&&(S=ee.y)}const I=Math.min(T-m,S-v);let F=I/2;const j=new oY([],cY);if(I===0)return new ut(m,v);for(let Q=m;Q<T;Q+=I)for(let ee=v;ee<S;ee+=I)j.push(new Ih(Q+F,ee+F,F,u));let W=function(Q){let ee=0,me=0,pe=0;const $e=Q[0];for(let Be=0,Le=$e.length,Ne=Le-1;Be<Le;Ne=Be++){const Ze=$e[Be],Xe=$e[Ne],Lt=Ze.x*Xe.y-Xe.x*Ze.y;me+=(Ze.x+Xe.x)*Lt,pe+=(Ze.y+Xe.y)*Lt,ee+=3*Lt}return new Ih(me/ee,pe/ee,0,Q)}(u),X=j.length;for(;j.length;){const Q=j.pop();(Q.d>W.d||!W.d)&&(W=Q,d&&console.log("found best %d after %d probes",Math.round(1e4*Q.d)/1e4,X)),Q.max-W.d<=a||(F=Q.h/2,j.push(new Ih(Q.p.x-F,Q.p.y-F,F,u)),j.push(new Ih(Q.p.x+F,Q.p.y-F,F,u)),j.push(new Ih(Q.p.x-F,Q.p.y+F,F,u)),j.push(new Ih(Q.p.x+F,Q.p.y+F,F,u)),X+=4)}return d&&(console.log(`num probes: ${X}`),console.log(`best distance: ${W.d}`)),W.p}function cY(u,a){return a.max-u.max}function Ih(u,a,d,m){this.p=new ut(u,a),this.h=d,this.d=function(v,T){let S=!1,C=1/0;for(let I=0;I<T.length;I++){const F=T[I];for(let j=0,W=F.length,X=W-1;j<W;X=j++){const Q=F[j],ee=F[X];Q.y>v.y!=ee.y>v.y&&v.x<(ee.x-Q.x)*(v.y-Q.y)/(ee.y-Q.y)+Q.x&&(S=!S),C=Math.min(C,xk(v,Q,ee))}}return(S?1:-1)*Math.sqrt(C)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}const Cw=Number.POSITIVE_INFINITY;function p6(u,a){return a[1]!==Cw?function(d,m,v){let T=0,S=0;switch(m=Math.abs(m),v=Math.abs(v),d){case"top-right":case"top-left":case"top":S=v-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-v}switch(d){case"top-right":case"bottom-right":case"right":T=-m;break;case"top-left":case"bottom-left":case"left":T=m}return[T,S]}(u,a[0],a[1]):function(d,m){let v=0,T=0;m<0&&(m=0);const S=m/Math.sqrt(2);switch(d){case"top-right":case"top-left":T=S-7;break;case"bottom-right":case"bottom-left":T=7-S;break;case"bottom":T=7-m;break;case"top":T=m-7}switch(d){case"top-right":case"bottom-right":v=-S;break;case"top-left":case"bottom-left":v=S;break;case"left":v=m;break;case"right":v=-m}return[v,T]}(u,a[0])}function Lw(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function uY(u,a,d,m,v,T,S,C,I,F,j){let W=T.textMaxSize.evaluate(a,{});W===void 0&&(W=S);const X=u.layers[0].layout,Q=X.get("icon-offset").evaluate(a,{},j),ee=g6(d.horizontal),me=S/24,pe=u.tilePixelRatio*me,$e=u.tilePixelRatio*W/24,Be=u.tilePixelRatio*C,Le=u.tilePixelRatio*X.get("symbol-spacing"),Ne=X.get("text-padding")*u.tilePixelRatio,Ze=function(it,Ht,Bt,yn=1){const hr=it.get("icon-padding").evaluate(Ht,{},Bt),_r=hr&&hr.values;return[_r[0]*yn,_r[1]*yn,_r[2]*yn,_r[3]*yn]}(X,a,j,u.tilePixelRatio),Xe=X.get("text-max-angle")/180*Math.PI,Lt=X.get("text-rotation-alignment")!=="viewport"&&X.get("symbol-placement")!=="point",Dt=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",Tt=X.get("symbol-placement"),gt=Le/2,ht=X.get("icon-text-fit");let Et;m&&ht!=="none"&&(u.allowVerticalPlacement&&d.vertical&&(Et=i6(m,d.vertical,ht,X.get("icon-text-fit-padding"),Q,me)),ee&&(m=i6(m,ee,ht,X.get("icon-text-fit-padding"),Q,me)));const _t=(it,Ht)=>{Ht.x<0||Ht.x>=di||Ht.y<0||Ht.y>=di||function(Bt,yn,hr,_r,hi,fo,Fi,ti,xi,Ni,Xi,Ss,ni,zi,Zi,ds,As,Ps,wr,wi,Sn,Hs,Bi,Yi,Bo){const aa=Bt.addToLineVertexArray(yn,hr);let la,Al,Uo,po,Cs=0,Pl=0,Em=0,M6=0,zw=-1,Bw=-1;const Cl={};let $6=bi.exports(""),Uw=0,Vw=0;if(ti._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Uw,Vw]=ti.layout.get("text-offset").evaluate(Sn,{},Yi).map(Ls=>Ls*Ii):(Uw=ti.layout.get("text-radial-offset").evaluate(Sn,{},Yi)*Ii,Vw=Cw),Bt.allowVerticalPlacement&&_r.vertical){const Ls=ti.layout.get("text-rotate").evaluate(Sn,{},Yi)+90;Uo=new iv(xi,yn,Ni,Xi,Ss,_r.vertical,ni,zi,Zi,Ls),Fi&&(po=new iv(xi,yn,Ni,Xi,Ss,Fi,As,Ps,Zi,Ls))}if(hi){const Ls=ti.layout.get("icon-rotate").evaluate(Sn,{}),ja=ti.layout.get("icon-text-fit")!=="none",Sm=h6(hi,Ls,Bi,ja),Am=Fi?h6(Fi,Ls,Bi,ja):void 0;Al=new iv(xi,yn,Ni,Xi,Ss,hi,As,Ps,!1,Ls),Cs=4*Sm.length;const D6=Bt.iconSizeData;let ed=null;D6.kind==="source"?(ed=[Sl*ti.layout.get("icon-size").evaluate(Sn,{})],ed[0]>Mc&&Z(`${Bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):D6.kind==="composite"&&(ed=[Sl*Hs.compositeIconSizes[0].evaluate(Sn,{},Yi),Sl*Hs.compositeIconSizes[1].evaluate(Sn,{},Yi)],(ed[0]>Mc||ed[1]>Mc)&&Z(`${Bt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Bt.addSymbols(Bt.icon,Sm,ed,wi,wr,Sn,o.WritingMode.none,yn,aa.lineStartIndex,aa.lineLength,-1,Yi),zw=Bt.icon.placedSymbolArray.length-1,Am&&(Pl=4*Am.length,Bt.addSymbols(Bt.icon,Am,ed,wi,wr,Sn,o.WritingMode.vertical,yn,aa.lineStartIndex,aa.lineLength,-1,Yi),Bw=Bt.icon.placedSymbolArray.length-1)}const k6=Object.keys(_r.horizontal);for(const Ls of k6){const ja=_r.horizontal[Ls];if(!la){$6=bi.exports(ja.text);const Am=ti.layout.get("text-rotate").evaluate(Sn,{},Yi);la=new iv(xi,yn,Ni,Xi,Ss,ja,ni,zi,Zi,Am)}const Sm=ja.positionedLines.length===1;if(Em+=m6(Bt,yn,ja,fo,ti,Zi,Sn,ds,aa,_r.vertical?o.WritingMode.horizontal:o.WritingMode.horizontalOnly,Sm?k6:[Ls],Cl,zw,Hs,Yi),Sm)break}_r.vertical&&(M6+=m6(Bt,yn,_r.vertical,fo,ti,Zi,Sn,ds,aa,o.WritingMode.vertical,["vertical"],Cl,Bw,Hs,Yi));const TY=la?la.boxStartIndex:Bt.collisionBoxArray.length,EY=la?la.boxEndIndex:Bt.collisionBoxArray.length,SY=Uo?Uo.boxStartIndex:Bt.collisionBoxArray.length,AY=Uo?Uo.boxEndIndex:Bt.collisionBoxArray.length,PY=Al?Al.boxStartIndex:Bt.collisionBoxArray.length,CY=Al?Al.boxEndIndex:Bt.collisionBoxArray.length,LY=po?po.boxStartIndex:Bt.collisionBoxArray.length,IY=po?po.boxEndIndex:Bt.collisionBoxArray.length;let ca=-1;const cv=(Ls,ja)=>Ls&&Ls.circleDiameter?Math.max(Ls.circleDiameter,ja):ja;ca=cv(la,ca),ca=cv(Uo,ca),ca=cv(Al,ca),ca=cv(po,ca);const O6=ca>-1?1:0;O6&&(ca*=Bo/Ii),Bt.glyphOffsetArray.length>=Rh.MAX_GLYPHS&&Z("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Sn.sortKey!==void 0&&Bt.addToSortKeyRanges(Bt.symbolInstances.length,Sn.sortKey),Bt.symbolInstances.emplaceBack(yn.x,yn.y,Cl.right>=0?Cl.right:-1,Cl.center>=0?Cl.center:-1,Cl.left>=0?Cl.left:-1,Cl.vertical||-1,zw,Bw,$6,TY,EY,SY,AY,PY,CY,LY,IY,Ni,Em,M6,Cs,Pl,O6,0,ni,Uw,Vw,ca)}(u,Ht,it,d,m,v,Et,u.layers[0],u.collisionBoxArray,a.index,a.sourceLayerIndex,u.index,pe,[Ne,Ne,Ne,Ne],Lt,I,Be,Ze,Dt,Q,a,T,F,j,S)};if(Tt==="line")for(const it of d6(a.geometry,0,0,di,di)){const Ht=sY(it,Le,Xe,d.vertical||ee,m,24,$e,u.overscaling,di);for(const Bt of Ht){const yn=ee;yn&&dY(u,yn.text,gt,Bt)||_t(it,Bt)}}else if(Tt==="line-center"){for(const it of a.geometry)if(it.length>1){const Ht=iY(it,Xe,d.vertical||ee,m,24,$e);Ht&&_t(it,Ht)}}else if(a.type==="Polygon")for(const it of gw(a.geometry,0)){const Ht=lY(it,16);_t(it[0],new Rc(Ht.x,Ht.y,0))}else if(a.type==="LineString")for(const it of a.geometry)_t(it,new Rc(it[0].x,it[0].y,0));else if(a.type==="Point")for(const it of a.geometry)for(const Ht of it)_t([Ht],new Rc(Ht.x,Ht.y,0))}const Mc=32640;function m6(u,a,d,m,v,T,S,C,I,F,j,W,X,Q,ee){const me=function(Be,Le,Ne,Ze,Xe,Lt,Dt,Tt){const gt=Ze.layout.get("text-rotate").evaluate(Lt,{})*Math.PI/180,ht=[];for(const Et of Le.positionedLines)for(const _t of Et.positionedGlyphs){if(!_t.rect)continue;const it=_t.rect||{};let Ht=4,Bt=!0,yn=1,hr=0;const _r=(Xe||Tt)&&_t.vertical,hi=_t.metrics.advance*_t.scale/2;if(Tt&&Le.verticalizable){const wr=(_t.scale-1)*Ii,wi=(Ii-_t.metrics.width*_t.scale)/2;hr=Et.lineOffset/2-(_t.imageName?-wi:wr)}if(_t.imageName){const wr=Dt[_t.imageName];Bt=wr.sdf,yn=wr.pixelRatio,Ht=1/yn}const fo=Xe?[_t.x+hi,_t.y]:[0,0];let Fi=Xe?[0,0]:[_t.x+hi+Ne[0],_t.y+Ne[1]-hr],ti=[0,0];_r&&(ti=Fi,Fi=[0,0]);const xi=(_t.metrics.left-Ht)*_t.scale-hi+Fi[0],Ni=(-_t.metrics.top-Ht)*_t.scale+Fi[1],Xi=xi+it.w*_t.scale/yn,Ss=Ni+it.h*_t.scale/yn,ni=new ut(xi,Ni),zi=new ut(Xi,Ni),Zi=new ut(xi,Ss),ds=new ut(Xi,Ss);if(_r){const wr=new ut(-hi,hi-J0),wi=-Math.PI/2,Sn=12-hi,Hs=new ut(22-Sn,-(_t.imageName?Sn:0)),Bi=new ut(...ti);ni._rotateAround(wi,wr)._add(Hs)._add(Bi),zi._rotateAround(wi,wr)._add(Hs)._add(Bi),Zi._rotateAround(wi,wr)._add(Hs)._add(Bi),ds._rotateAround(wi,wr)._add(Hs)._add(Bi)}if(gt){const wr=Math.sin(gt),wi=Math.cos(gt),Sn=[wi,-wr,wr,wi];ni._matMult(Sn),zi._matMult(Sn),Zi._matMult(Sn),ds._matMult(Sn)}const As=new ut(0,0),Ps=new ut(0,0);ht.push({tl:ni,tr:zi,bl:Zi,br:ds,tex:it,writingMode:Le.writingMode,glyphOffset:fo,sectionIndex:_t.sectionIndex,isSDF:Bt,pixelOffsetTL:As,pixelOffsetBR:Ps,minFontScaleX:0,minFontScaleY:0})}return ht}(0,d,C,v,T,S,m,u.allowVerticalPlacement),pe=u.textSizeData;let $e=null;pe.kind==="source"?($e=[Sl*v.layout.get("text-size").evaluate(S,{})],$e[0]>Mc&&Z(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):pe.kind==="composite"&&($e=[Sl*Q.compositeTextSizes[0].evaluate(S,{},ee),Sl*Q.compositeTextSizes[1].evaluate(S,{},ee)],($e[0]>Mc||$e[1]>Mc)&&Z(`${u.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),u.addSymbols(u.text,me,$e,C,T,S,F,a,I.lineStartIndex,I.lineLength,X,ee);for(const Be of j)W[Be]=u.text.placedSymbolArray.length-1;return 4*me.length}function g6(u){for(const a in u)return u[a];return null}function dY(u,a,d,m){const v=u.compareText;if(a in v){const T=v[a];for(let S=T.length-1;S>=0;S--)if(m.dist(T[S])<d)return!0}else v[a]=[];return v[a].push(m),!1}const hY=Lc.VectorTileFeature.types,fY=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sv(u,a,d,m,v,T,S,C,I,F,j,W,X){const Q=C?Math.min(Mc,Math.round(C[0])):0,ee=C?Math.min(Mc,Math.round(C[1])):0;u.emplaceBack(a,d,Math.round(32*m),Math.round(32*v),T,S,(Q<<1)+(I?1:0),ee,16*F,16*j,256*W,256*X)}function Iw(u,a,d){u.emplaceBack(a.x,a.y,d),u.emplaceBack(a.x,a.y,d),u.emplaceBack(a.x,a.y,d),u.emplaceBack(a.x,a.y,d)}function pY(u){for(const a of u.sections)if(k0(a.text))return!0;return!1}class Rw{constructor(a){this.layoutVertexArray=new No,this.indexArray=new ls,this.programConfigurations=a,this.segments=new xn,this.dynamicLayoutVertexArray=new co,this.opacityVertexArray=new zo,this.placedSymbolArray=new tt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,d,m,v){this.isEmpty()||(m&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,FZ.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,NZ.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,fY,!0),this.opacityVertexBuffer.itemSize=1),(m||v)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Rt("SymbolBuffers",Rw);class Mw{constructor(a,d,m){this.layoutVertexArray=new a,this.layoutAttributes=d,this.indexArray=new m,this.segments=new xn,this.collisionVertexArray=new Gs}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,zZ.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Rt("CollisionBuffers",Mw);class Rh{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(S=>S.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=uw([]),this.placementViewportMatrix=uw([]);const d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=s6(this.zoom,d["text-size"]),this.iconSizeData=s6(this.zoom,d["icon-size"]);const m=this.layers[0].layout,v=m.get("symbol-sort-key"),T=m.get("symbol-z-order");this.canOverlap=kw(m,"text-overlap","text-allow-overlap")!=="never"||kw(m,"icon-overlap","icon-allow-overlap")!=="never"||m.get("text-ignore-placement")||m.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&!v.isConstant(),this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,m.get("symbol-placement")==="point"&&(this.writingModes=m.get("text-writing-mode").map(S=>o.WritingMode[S])),this.stateDependentLayerIds=this.layers.filter(S=>S.isStateDependent()).map(S=>S.id),this.sourceID=a.sourceID}createArrays(){this.text=new Rw(new Xu(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new Rw(new Xu(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new mt,this.lineVertexArray=new Ct,this.symbolInstances=new At}calculateGlyphDependencies(a,d,m,v,T){for(let S=0;S<a.length;S++)if(d[a.charCodeAt(S)]=!0,(m||v)&&T){const C=bm[a.charAt(S)];C&&(d[C.charCodeAt(0)]=!0)}}populate(a,d,m){const v=this.layers[0],T=v.layout,S=T.get("text-font"),C=T.get("text-field"),I=T.get("icon-image"),F=(C.value.kind!=="constant"||C.value.value instanceof xe&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(S.value.kind!=="constant"||S.value.value.length>0),j=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,W=T.get("symbol-sort-key");if(this.features=[],!F&&!j)return;const X=d.iconDependencies,Q=d.glyphDependencies,ee=d.availableImages,me=new yr(this.zoom);for(const{feature:pe,id:$e,index:Be,sourceLayerIndex:Le}of a){const Ne=v._featureFilter.needGeometry,Ze=Yu(pe,Ne);if(!v._featureFilter.filter(me,Ze,m))continue;let Xe,Lt;if(Ne||(Ze.geometry=Zu(pe)),F){const Tt=v.getValueAndResolveTokens("text-field",Ze,m,ee),gt=xe.factory(Tt);pY(gt)&&(this.hasRTLText=!0),(!this.hasRTLText||Hu()==="unavailable"||this.hasRTLText&&js.isParsed())&&(Xe=UZ(gt,v,Ze))}if(j){const Tt=v.getValueAndResolveTokens("icon-image",Ze,m,ee);Lt=Tt instanceof Se?Tt:Se.fromString(Tt)}if(!Xe&&!Lt)continue;const Dt=this.sortFeaturesByKey?W.evaluate(Ze,{},m):void 0;if(this.features.push({id:$e,text:Xe,icon:Lt,index:Be,sourceLayerIndex:Le,geometry:Ze.geometry,properties:pe.properties,type:hY[pe.type],sortKey:Dt}),Lt&&(X[Lt.name]=!0),Xe){const Tt=S.evaluate(Ze,{},m).join(","),gt=T.get("text-rotation-alignment")!=="viewport"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(o.WritingMode.vertical)>=0;for(const ht of Xe.sections)if(ht.image)X[ht.image.name]=!0;else{const Et=_h(Xe.toString()),_t=ht.fontStack||Tt,it=Q[_t]=Q[_t]||{};this.calculateGlyphDependencies(ht.text,it,gt,this.allowVerticalPlacement,Et)}}}T.get("symbol-placement")==="line"&&(this.features=function(pe){const $e={},Be={},Le=[];let Ne=0;function Ze(Tt){Le.push(pe[Tt]),Ne++}function Xe(Tt,gt,ht){const Et=Be[Tt];return delete Be[Tt],Be[gt]=Et,Le[Et].geometry[0].pop(),Le[Et].geometry[0]=Le[Et].geometry[0].concat(ht[0]),Et}function Lt(Tt,gt,ht){const Et=$e[gt];return delete $e[gt],$e[Tt]=Et,Le[Et].geometry[0].shift(),Le[Et].geometry[0]=ht[0].concat(Le[Et].geometry[0]),Et}function Dt(Tt,gt,ht){const Et=ht?gt[0][gt[0].length-1]:gt[0][0];return`${Tt}:${Et.x}:${Et.y}`}for(let Tt=0;Tt<pe.length;Tt++){const gt=pe[Tt],ht=gt.geometry,Et=gt.text?gt.text.toString():null;if(!Et){Ze(Tt);continue}const _t=Dt(Et,ht),it=Dt(Et,ht,!0);if(_t in Be&&it in $e&&Be[_t]!==$e[it]){const Ht=Lt(_t,it,ht),Bt=Xe(_t,it,Le[Ht].geometry);delete $e[_t],delete Be[it],Be[Dt(Et,Le[Bt].geometry,!0)]=Bt,Le[Ht].geometry=null}else _t in Be?Xe(_t,it,ht):it in $e?Lt(_t,it,ht):(Ze(Tt),$e[_t]=Ne-1,Be[it]=Ne-1)}return Le.filter(Tt=>Tt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((pe,$e)=>pe.sortKey-$e.sortKey)}update(a,d,m){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,d,this.layers,m),this.icon.programConfigurations.updatePaintArrays(a,d,this.layers,m))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,d){const m=this.lineVertexArray.length;if(a.segment!==void 0){let v=a.dist(d[a.segment+1]),T=a.dist(d[a.segment]);const S={};for(let C=a.segment+1;C<d.length;C++)S[C]={x:d[C].x,y:d[C].y,tileUnitDistanceFromAnchor:v},C<d.length-1&&(v+=d[C+1].dist(d[C]));for(let C=a.segment||0;C>=0;C--)S[C]={x:d[C].x,y:d[C].y,tileUnitDistanceFromAnchor:T},C>0&&(T+=d[C-1].dist(d[C]));for(let C=0;C<d.length;C++){const I=S[C];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:m,lineLength:this.lineVertexArray.length-m}}addSymbols(a,d,m,v,T,S,C,I,F,j,W,X){const Q=a.indexArray,ee=a.layoutVertexArray,me=a.segments.prepareSegment(4*d.length,ee,Q,this.canOverlap?S.sortKey:void 0),pe=this.glyphOffsetArray.length,$e=me.vertexLength,Be=this.allowVerticalPlacement&&C===o.WritingMode.vertical?Math.PI/2:0,Le=S.text&&S.text.sections;for(let Ne=0;Ne<d.length;Ne++){const{tl:Ze,tr:Xe,bl:Lt,br:Dt,tex:Tt,pixelOffsetTL:gt,pixelOffsetBR:ht,minFontScaleX:Et,minFontScaleY:_t,glyphOffset:it,isSDF:Ht,sectionIndex:Bt}=d[Ne],yn=me.vertexLength,hr=it[1];sv(ee,I.x,I.y,Ze.x,hr+Ze.y,Tt.x,Tt.y,m,Ht,gt.x,gt.y,Et,_t),sv(ee,I.x,I.y,Xe.x,hr+Xe.y,Tt.x+Tt.w,Tt.y,m,Ht,ht.x,gt.y,Et,_t),sv(ee,I.x,I.y,Lt.x,hr+Lt.y,Tt.x,Tt.y+Tt.h,m,Ht,gt.x,ht.y,Et,_t),sv(ee,I.x,I.y,Dt.x,hr+Dt.y,Tt.x+Tt.w,Tt.y+Tt.h,m,Ht,ht.x,ht.y,Et,_t),Iw(a.dynamicLayoutVertexArray,I,Be),Q.emplaceBack(yn,yn+1,yn+2),Q.emplaceBack(yn+1,yn+2,yn+3),me.vertexLength+=4,me.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(it[0]),Ne!==d.length-1&&Bt===d[Ne+1].sectionIndex||a.programConfigurations.populatePaintArrays(ee.length,S,S.index,{},X,Le&&Le[Bt])}a.placedSymbolArray.emplaceBack(I.x,I.y,pe,this.glyphOffsetArray.length-pe,$e,F,j,I.segment,m?m[0]:0,m?m[1]:0,v[0],v[1],C,0,!1,0,W)}_addCollisionDebugVertex(a,d,m,v,T,S){return d.emplaceBack(0,0),a.emplaceBack(m.x,m.y,v,T,Math.round(S.x),Math.round(S.y))}addCollisionDebugVertices(a,d,m,v,T,S,C){const I=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),F=I.vertexLength,j=T.layoutVertexArray,W=T.collisionVertexArray,X=C.anchorX,Q=C.anchorY;this._addCollisionDebugVertex(j,W,S,X,Q,new ut(a,d)),this._addCollisionDebugVertex(j,W,S,X,Q,new ut(m,d)),this._addCollisionDebugVertex(j,W,S,X,Q,new ut(m,v)),this._addCollisionDebugVertex(j,W,S,X,Q,new ut(a,v)),I.vertexLength+=4;const ee=T.indexArray;ee.emplaceBack(F,F+1),ee.emplaceBack(F+1,F+2),ee.emplaceBack(F+2,F+3),ee.emplaceBack(F+3,F),I.primitiveLength+=4}addDebugCollisionBoxes(a,d,m,v){for(let T=a;T<d;T++){const S=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(S.x1,S.y1,S.x2,S.y2,v?this.textCollisionBox:this.iconCollisionBox,S.anchorPoint,m)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Mw(Ua,Wk.members,sa),this.iconCollisionBox=new Mw(Ua,Wk.members,sa);for(let a=0;a<this.symbolInstances.length;a++){const d=this.symbolInstances.get(a);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}}_deserializeCollisionBoxesForSymbol(a,d,m,v,T,S,C,I,F){const j={};for(let W=d;W<m;W++){const X=a.get(W);j.textBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},j.textFeatureIndex=X.featureIndex;break}for(let W=v;W<T;W++){const X=a.get(W);j.verticalTextBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},j.verticalTextFeatureIndex=X.featureIndex;break}for(let W=S;W<C;W++){const X=a.get(W);j.iconBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},j.iconFeatureIndex=X.featureIndex;break}for(let W=I;W<F;W++){const X=a.get(W);j.verticalIconBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},j.verticalIconFeatureIndex=X.featureIndex;break}return j}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let d=0;d<this.symbolInstances.length;d++){const m=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,m.textBoxStartIndex,m.textBoxEndIndex,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,d){const m=a.placedSymbolArray.get(d),v=m.vertexStartIndex+4*m.numGlyphs;for(let T=m.vertexStartIndex;T<v;T+=4)a.indexArray.emplaceBack(T,T+1,T+2),a.indexArray.emplaceBack(T+1,T+2,T+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const d=Math.sin(a),m=Math.cos(a),v=[],T=[],S=[];for(let C=0;C<this.symbolInstances.length;++C){S.push(C);const I=this.symbolInstances.get(C);v.push(0|Math.round(d*I.anchorX+m*I.anchorY)),T.push(I.featureIndex)}return S.sort((C,I)=>v[C]-v[I]||T[I]-T[C]),S}addToSortKeyRanges(a,d){const m=this.sortKeyRanges[this.sortKeyRanges.length-1];m&&m.sortKey===d?m.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const d of this.symbolInstanceIndexes){const m=this.symbolInstances.get(d);this.featureSortOrder.push(m.featureIndex),[m.rightJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.leftJustifiedTextSymbolIndex].forEach((v,T,S)=>{v>=0&&S.indexOf(v)===T&&this.addIndicesForPlacedSymbol(this.text,v)}),m.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,m.verticalPlacedTextSymbolIndex),m.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.placedIconSymbolIndex),m.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,m.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Rt("SymbolBucket",Rh,{omit:["layers","collisionBoxArray","features","compareText"]}),Rh.MAX_GLYPHS=65535,Rh.addDynamicAttributes=Iw;const mY=new Li({"symbol-placement":new Nt(We.layout_symbol["symbol-placement"]),"symbol-spacing":new Nt(We.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Nt(We.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Jt(We.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Nt(We.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Nt(We.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Nt(We.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Nt(We.layout_symbol["icon-ignore-placement"]),"icon-optional":new Nt(We.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Nt(We.layout_symbol["icon-rotation-alignment"]),"icon-size":new Jt(We.layout_symbol["icon-size"]),"icon-text-fit":new Nt(We.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Nt(We.layout_symbol["icon-text-fit-padding"]),"icon-image":new Jt(We.layout_symbol["icon-image"]),"icon-rotate":new Jt(We.layout_symbol["icon-rotate"]),"icon-padding":new Jt(We.layout_symbol["icon-padding"]),"icon-keep-upright":new Nt(We.layout_symbol["icon-keep-upright"]),"icon-offset":new Jt(We.layout_symbol["icon-offset"]),"icon-anchor":new Jt(We.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Nt(We.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Nt(We.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Nt(We.layout_symbol["text-rotation-alignment"]),"text-field":new Jt(We.layout_symbol["text-field"]),"text-font":new Jt(We.layout_symbol["text-font"]),"text-size":new Jt(We.layout_symbol["text-size"]),"text-max-width":new Jt(We.layout_symbol["text-max-width"]),"text-line-height":new Nt(We.layout_symbol["text-line-height"]),"text-letter-spacing":new Jt(We.layout_symbol["text-letter-spacing"]),"text-justify":new Jt(We.layout_symbol["text-justify"]),"text-radial-offset":new Jt(We.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Nt(We.layout_symbol["text-variable-anchor"]),"text-anchor":new Jt(We.layout_symbol["text-anchor"]),"text-max-angle":new Nt(We.layout_symbol["text-max-angle"]),"text-writing-mode":new Nt(We.layout_symbol["text-writing-mode"]),"text-rotate":new Jt(We.layout_symbol["text-rotate"]),"text-padding":new Nt(We.layout_symbol["text-padding"]),"text-keep-upright":new Nt(We.layout_symbol["text-keep-upright"]),"text-transform":new Jt(We.layout_symbol["text-transform"]),"text-offset":new Jt(We.layout_symbol["text-offset"]),"text-allow-overlap":new Nt(We.layout_symbol["text-allow-overlap"]),"text-overlap":new Nt(We.layout_symbol["text-overlap"]),"text-ignore-placement":new Nt(We.layout_symbol["text-ignore-placement"]),"text-optional":new Nt(We.layout_symbol["text-optional"])});var $w={paint:new Li({"icon-opacity":new Jt(We.paint_symbol["icon-opacity"]),"icon-color":new Jt(We.paint_symbol["icon-color"]),"icon-halo-color":new Jt(We.paint_symbol["icon-halo-color"]),"icon-halo-width":new Jt(We.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Jt(We.paint_symbol["icon-halo-blur"]),"icon-translate":new Nt(We.paint_symbol["icon-translate"]),"icon-translate-anchor":new Nt(We.paint_symbol["icon-translate-anchor"]),"text-opacity":new Jt(We.paint_symbol["text-opacity"]),"text-color":new Jt(We.paint_symbol["text-color"],{runtimeType:vt,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Jt(We.paint_symbol["text-halo-color"]),"text-halo-width":new Jt(We.paint_symbol["text-halo-width"]),"text-halo-blur":new Jt(We.paint_symbol["text-halo-blur"]),"text-translate":new Nt(We.paint_symbol["text-translate"]),"text-translate-anchor":new Nt(We.paint_symbol["text-translate-anchor"])}),layout:mY};class y6{constructor(a){if(a.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=a.property.overrides?a.property.overrides.runtimeType:Ie,this.defaultValue=a}evaluate(a){if(a.formattedSection){const d=this.defaultValue.property.overrides;if(d&&d.hasOverride(a.formattedSection))return d.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Rt("FormatSectionOverride",y6,{omit:["defaultValue"]});class ov extends Fo{constructor(a){super(a,$w)}recalculate(a,d){if(super.recalculate(a,d),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const m=this.layout.get("text-writing-mode");if(m){const v=[];for(const T of m)v.indexOf(T)<0&&v.push(T);this.layout._values["text-writing-mode"]=v}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(a,d,m,v){const T=this.layout.get(a).evaluate(d,{},m,v),S=this._unevaluatedLayout._values[a];return S.isDataDriven()||$u(S.value)||!T?T:function(C,I){return I.replace(/{([^{}]+)}/g,(F,j)=>j in C?String(C[j]):"")}(d.properties,T)}createBucket(a){return new Rh(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const a of $w.paint.overridableProperties){if(!ov.hasPaintOverride(this.layout,a))continue;const d=this.paint.get(a),m=new y6(d),v=new fh(m,d.property.specification);let T=null;T=d.value.kind==="constant"||d.value.kind==="source"?new Ou("source",v):new Kp("composite",v,d.value.zoomStops),this.paint._values[a]=new Do(d.property,T,d.parameters)}}_handleOverridablePaintPropertyUpdate(a,d,m){return!(!this.layout||d.isDataDriven()||m.isDataDriven())&&ov.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,d){const m=a.get("text-field"),v=$w.paint.properties[d];let T=!1;const S=C=>{for(const I of C)if(v.overrides&&v.overrides.hasOverride(I))return void(T=!0)};if(m.value.kind==="constant"&&m.value.value instanceof xe)S(m.value.value.sections);else if(m.value.kind==="source"){const C=F=>{T||(F instanceof Ot&&Ve(F.value)===Xt?S(F.value.sections):F instanceof dh?S(F.sections):F.eachChild(C))},I=m.value;I._styleExpression&&C(I._styleExpression.expression)}return T}}function kw(u,a,d){let m="never";const v=u.get(a);return v?m=v:u.get(d)&&(m="always"),m}var gY={paint:new Li({"background-color":new Nt(We.paint_background["background-color"]),"background-pattern":new om(We.paint_background["background-pattern"]),"background-opacity":new Nt(We.paint_background["background-opacity"])})},yY={paint:new Li({"raster-opacity":new Nt(We.paint_raster["raster-opacity"]),"raster-hue-rotate":new Nt(We.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Nt(We.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Nt(We.paint_raster["raster-brightness-max"]),"raster-saturation":new Nt(We.paint_raster["raster-saturation"]),"raster-contrast":new Nt(We.paint_raster["raster-contrast"]),"raster-resampling":new Nt(We.paint_raster["raster-resampling"]),"raster-fade-duration":new Nt(We.paint_raster["raster-fade-duration"])})};class vY extends Fo{constructor(a){super(a,{}),this.onAdd=d=>{this.implementation.onAdd&&this.implementation.onAdd(d,d.painter.context.gl)},this.onRemove=d=>{this.implementation.onRemove&&this.implementation.onRemove(d,d.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const _Y={circle:class extends Fo{constructor(u){super(u,ZX)}createBucket(u){return new aw(u)}queryRadius(u){const a=u;return dm("circle-radius",this,a)+dm("circle-stroke-width",this,a)+j0(this.paint.get("circle-translate"))}queryIntersectsFeature(u,a,d,m,v,T,S,C){const I=G0(u,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),T.angle,S),F=this.paint.get("circle-radius").evaluate(a,d)+this.paint.get("circle-stroke-width").evaluate(a,d),j=this.paint.get("circle-pitch-alignment")==="map",W=j?I:function(Q,ee){return Q.map(me=>Ck(me,ee))}(I,C),X=j?F*S:F;for(const Q of m)for(const ee of Q){const me=j?ee:Ck(ee,C);let pe=X;const $e=W0([],[ee.x,ee.y,0,1],C);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?pe*=$e[3]/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(pe*=T.cameraToCenterDistance/$e[3]),WX(W,me,pe))return!0}return!1}},heatmap:class extends Fo{constructor(u){super(u,JX),this._updateColorRamp()}createBucket(u){return new Lk(u)}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Rk({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Fo{constructor(u){super(u,QX)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Fo{constructor(u){super(u,mZ)}recalculate(u,a){super.recalculate(u,a);const d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new _w(u)}queryRadius(){return j0(this.paint.get("fill-translate"))}queryIntersectsFeature(u,a,d,m,v,T,S){return bk(G0(u,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),T.angle,S),m)}isTileClipped(){return!0}},"fill-extrusion":class extends Fo{constructor(u){super(u,LZ)}createBucket(u){return new xw(u)}queryRadius(){return j0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(u,a,d,m,v,T,S,C){const I=G0(u,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),T.angle,S),F=this.paint.get("fill-extrusion-height").evaluate(a,d),j=this.paint.get("fill-extrusion-base").evaluate(a,d),W=function(Q,ee,me,pe){const $e=[];for(const Be of Q){const Le=[Be.x,Be.y,0,1];W0(Le,Le,ee),$e.push(new ut(Le[0]/Le[3],Le[1]/Le[3]))}return $e}(I,C),X=function(Q,ee,me,pe){const $e=[],Be=[],Le=pe[8]*ee,Ne=pe[9]*ee,Ze=pe[10]*ee,Xe=pe[11]*ee,Lt=pe[8]*me,Dt=pe[9]*me,Tt=pe[10]*me,gt=pe[11]*me;for(const ht of Q){const Et=[],_t=[];for(const it of ht){const Ht=it.x,Bt=it.y,yn=pe[0]*Ht+pe[4]*Bt+pe[12],hr=pe[1]*Ht+pe[5]*Bt+pe[13],_r=pe[2]*Ht+pe[6]*Bt+pe[14],hi=pe[3]*Ht+pe[7]*Bt+pe[15],fo=_r+Ze,Fi=hi+Xe,ti=yn+Lt,xi=hr+Dt,Ni=_r+Tt,Xi=hi+gt,Ss=new ut((yn+Le)/Fi,(hr+Ne)/Fi);Ss.z=fo/Fi,Et.push(Ss);const ni=new ut(ti/Xi,xi/Xi);ni.z=Ni/Xi,_t.push(ni)}$e.push(Et),Be.push(_t)}return[$e,Be]}(m,j,F,C);return function(Q,ee,me){let pe=1/0;bk(me,ee)&&(pe=Bk(me,ee[0]));for(let $e=0;$e<ee.length;$e++){const Be=ee[$e],Le=Q[$e];for(let Ne=0;Ne<Be.length-1;Ne++){const Ze=Be[Ne],Xe=[Ze,Be[Ne+1],Le[Ne+1],Le[Ne],Ze];_k(me,Xe)&&(pe=Math.min(pe,Bk(me,Xe)))}}return pe!==1/0&&pe}(X[0],X[1],W)}},line:class extends Fo{constructor(u){super(u,Vk),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(u){u==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof xr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(u,a){super.recalculate(u,a),this.paint._values["line-floorwidth"]=jk.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new ww(u)}queryRadius(u){const a=u,d=Gk(dm("line-width",this,a),dm("line-gap-width",this,a)),m=dm("line-offset",this,a);return d/2+Math.abs(m)+j0(this.paint.get("line-translate"))}queryIntersectsFeature(u,a,d,m,v,T,S){const C=G0(u,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),T.angle,S),I=S/2*Gk(this.paint.get("line-width").evaluate(a,d),this.paint.get("line-gap-width").evaluate(a,d)),F=this.paint.get("line-offset").evaluate(a,d);return F&&(m=function(j,W){const X=[];for(let Q=0;Q<j.length;Q++){const ee=j[Q],me=[];for(let pe=0;pe<ee.length;pe++){const $e=ee[pe-1],Be=ee[pe],Le=ee[pe+1],Ne=pe===0?new ut(0,0):Be.sub($e)._unit()._perp(),Ze=pe===ee.length-1?new ut(0,0):Le.sub(Be)._unit()._perp(),Xe=Ne._add(Ze)._unit(),Lt=Xe.x*Ze.x+Xe.y*Ze.y;Lt!==0&&Xe._mult(1/Lt),me.push(Xe._mult(W)._add(Be))}X.push(me)}return X}(m,F*S)),function(j,W,X){for(let Q=0;Q<W.length;Q++){const ee=W[Q];if(j.length>=3){for(let me=0;me<ee.length;me++)if(Eh(j,ee[me]))return!0}if(HX(j,ee,X))return!0}return!1}(C,m,I)}isTileClipped(){return!0}},symbol:ov,background:class extends Fo{constructor(u){super(u,gY)}},raster:class extends Fo{constructor(u){super(u,yY)}}};class bY{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const v6=63710088e-1;class Br{constructor(a,d){if(isNaN(a)||isNaN(d))throw new Error(`Invalid LngLat object: (${a}, ${d})`);if(this.lng=+a,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Br(A(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){const d=Math.PI/180,m=this.lat*d,v=a.lat*d,T=Math.sin(m)*Math.sin(v)+Math.cos(m)*Math.cos(v)*Math.cos((a.lng-this.lng)*d);return v6*Math.acos(Math.min(T,1))}toBounds(a=0){const d=360*a/40075017,m=d/Math.cos(Math.PI/180*this.lat);return new Qu(new Br(this.lng-m,this.lat-d),new Br(this.lng+m,this.lat+d))}static convert(a){if(a instanceof Br)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new Br(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new Br(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Qu{constructor(a,d){a&&(d?this.setSouthWest(a).setNorthEast(d):a.length===4?this.setSouthWest([a[0],a[1]]).setNorthEast([a[2],a[3]]):this.setSouthWest(a[0]).setNorthEast(a[1]))}setNorthEast(a){return this._ne=a instanceof Br?new Br(a.lng,a.lat):Br.convert(a),this}setSouthWest(a){return this._sw=a instanceof Br?new Br(a.lng,a.lat):Br.convert(a),this}extend(a){const d=this._sw,m=this._ne;let v,T;if(a instanceof Br)v=a,T=a;else{if(!(a instanceof Qu))return Array.isArray(a)?a.length===4||a.every(Array.isArray)?this.extend(Qu.convert(a)):this.extend(Br.convert(a)):this;if(v=a._sw,T=a._ne,!v||!T)return this}return d||m?(d.lng=Math.min(v.lng,d.lng),d.lat=Math.min(v.lat,d.lat),m.lng=Math.max(T.lng,m.lng),m.lat=Math.max(T.lat,m.lat)):(this._sw=new Br(v.lng,v.lat),this._ne=new Br(T.lng,T.lat)),this}getCenter(){return new Br((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Br(this.getWest(),this.getNorth())}getSouthEast(){return new Br(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(a){const{lng:d,lat:m}=Br.convert(a);let v=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(v=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=m&&m<=this._ne.lat&&v}static convert(a){return a instanceof Qu?a:a&&new Qu(a)}}const _6=2*Math.PI*v6;function b6(u){return _6*Math.cos(u*Math.PI/180)}function x6(u){return(180+u)/360}function w6(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function T6(u,a){return u/b6(a)}function Ow(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class av{constructor(a,d,m=0){this.x=+a,this.y=+d,this.z=+m}static fromLngLat(a,d=0){const m=Br.convert(a);return new av(x6(m.lng),w6(m.lat),T6(d,m.lat))}toLngLat(){return new Br(360*this.x-180,Ow(this.y))}toAltitude(){return this.z*b6(Ow(this.y))}meterInMercatorCoordinateUnits(){return 1/_6*(a=Ow(this.y),1/Math.cos(a*Math.PI/180));var a}}function E6(u,a,d){var m=2*Math.PI*6378137/256/Math.pow(2,d);return[u*m-2*Math.PI*6378137/2,a*m-2*Math.PI*6378137/2]}class Dw{constructor(a,d,m){if(a<0||a>25||m<0||m>=Math.pow(2,a)||d<0||d>=Math.pow(2,a))throw new Error(`x=${d}, y=${m}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=d,this.y=m,this.key=wm(0,a,a,d,m)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,d,m){const v=(S=this.y,C=this.z,I=E6(256*(T=this.x),256*(S=Math.pow(2,C)-S-1),C),F=E6(256*(T+1),256*(S+1),C),I[0]+","+I[1]+","+F[0]+","+F[1]);var T,S,C,I,F;const j=function(W,X,Q){let ee,me="";for(let pe=W;pe>0;pe--)ee=1<<pe-1,me+=(X&ee?1:0)+(Q&ee?2:0);return me}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(m==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,d>1?"@2x":"").replace(/{quadkey}/g,j).replace(/{bbox-epsg-3857}/g,v)}isChildOf(a){const d=this.z-a.z;return d>0&&a.x===this.x>>d&&a.y===this.y>>d}getTilePoint(a){const d=Math.pow(2,this.z);return new ut((a.x*d-this.x)*di,(a.y*d-this.y)*di)}toString(){return`${this.z}/${this.x}/${this.y}`}}class S6{constructor(a,d){this.wrap=a,this.canonical=d,this.key=wm(a,d.z,d.z,d.x,d.y)}}class ho{constructor(a,d,m,v,T){if(a<m)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${m}`);this.overscaledZ=a,this.wrap=d,this.canonical=new Dw(m,+v,+T),this.key=wm(d,a,m,v,T)}clone(){return new ho(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-a;return a>this.canonical.z?new ho(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ho(a,this.wrap,a,this.canonical.x>>d,this.canonical.y>>d)}calculateScaledKey(a,d){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);const m=this.canonical.z-a;return a>this.canonical.z?wm(this.wrap*+d,a,this.canonical.z,this.canonical.x,this.canonical.y):wm(this.wrap*+d,a,a,this.canonical.x>>m,this.canonical.y>>m)}isChildOf(a){if(a.wrap!==this.wrap)return!1;const d=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>d&&a.canonical.y===this.canonical.y>>d}children(a){if(this.overscaledZ>=a)return[new ho(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const d=this.canonical.z+1,m=2*this.canonical.x,v=2*this.canonical.y;return[new ho(d,this.wrap,d,m,v),new ho(d,this.wrap,d,m+1,v),new ho(d,this.wrap,d,m,v+1),new ho(d,this.wrap,d,m+1,v+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new ho(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new ho(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new S6(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new av(a.x-this.wrap,a.y))}}function wm(u,a,d,m,v){(u*=2)<0&&(u=-1*u-1);const T=1<<d;return(T*T*u+T*v+m).toString(36)+d.toString(36)+a.toString(36)}Rt("CanonicalTileID",Dw),Rt("OverscaledTileID",ho,{omit:["posMatrix"]});class A6{constructor(a,d,m){if(this.uid=a,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(m&&m!=="mapbox"&&m!=="terrarium")return void Z(`"${m}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=d.height;const v=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=m||"mapbox";for(let T=0;T<v;T++)this.data[this._idx(-1,T)]=this.data[this._idx(0,T)],this.data[this._idx(v,T)]=this.data[this._idx(v-1,T)],this.data[this._idx(T,-1)]=this.data[this._idx(T,0)],this.data[this._idx(T,v)]=this.data[this._idx(T,v-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(v,-1)]=this.data[this._idx(v-1,0)],this.data[this._idx(-1,v)]=this.data[this._idx(0,v-1)],this.data[this._idx(v,v)]=this.data[this._idx(v-1,v-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let T=0;T<v;T++)for(let S=0;S<v;S++){const C=this.get(T,S);C>this.max&&(this.max=C),C<this.min&&(this.min=C)}}get(a,d){const m=new Uint8Array(this.data.buffer),v=4*this._idx(a,d);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(m[v],m[v+1],m[v+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(a,d){if(a<-1||a>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(a+1)}_unpackMapbox(a,d,m){return(256*a*256+256*d+m)/10-1e4}_unpackTerrarium(a,d,m){return 256*a+d+m/256-32768}getPixels(){return new uo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,d,m){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let v=d*this.dim,T=d*this.dim+this.dim,S=m*this.dim,C=m*this.dim+this.dim;switch(d){case-1:v=T-1;break;case 1:T=v+1}switch(m){case-1:S=C-1;break;case 1:C=S+1}const I=-d*this.dim,F=-m*this.dim;for(let j=S;j<C;j++)for(let W=v;W<T;W++)this.data[this._idx(W,j)]=a.data[this._idx(W+I,j+F)]}}Rt("DEMData",A6);class P6{constructor(a){this._stringToNumber={},this._numberToString=[];for(let d=0;d<a.length;d++){const m=a[d];this._stringToNumber[m]=d,this._numberToString[d]=m}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class C6{constructor(a,d,m,v,T){this.type="Feature",this._vectorTileFeature=a,a._z=d,a._x=m,a._y=v,this.properties=a.properties,this.id=T}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){const a={geometry:this.geometry};for(const d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(a[d]=this[d]);return a}}class L6{constructor(a,d){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Wu(di,16,0),this.grid3D=new Wu(di,16,0),this.featureIndexArray=new gn,this.promoteId=d}insert(a,d,m,v,T,S){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(m,v,T);const I=S?this.grid3D:this.grid;for(let F=0;F<d.length;F++){const j=d[F],W=[1/0,1/0,-1/0,-1/0];for(let X=0;X<j.length;X++){const Q=j[X];W[0]=Math.min(W[0],Q.x),W[1]=Math.min(W[1],Q.y),W[2]=Math.max(W[2],Q.x),W[3]=Math.max(W[3],Q.y)}W[0]<di&&W[1]<di&&W[2]>=0&&W[3]>=0&&I.insert(C,W[0],W[1],W[2],W[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Lc.VectorTile(new Tw(this.rawTileData)).layers,this.sourceLayerCoder=new P6(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,d,m,v){this.loadVTLayers();const T=a.params||{},S=di/a.tileSize/a.scale,C=gh(T.filter),I=a.queryGeometry,F=a.queryPadding*S,j=R6(I),W=this.grid.query(j.minX-F,j.minY-F,j.maxX+F,j.maxY+F),X=R6(a.cameraQueryGeometry),Q=this.grid3D.query(X.minX-F,X.minY-F,X.maxX+F,X.maxY+F,(pe,$e,Be,Le)=>function(Ne,Ze,Xe,Lt,Dt){for(const gt of Ne)if(Ze<=gt.x&&Xe<=gt.y&&Lt>=gt.x&&Dt>=gt.y)return!0;const Tt=[new ut(Ze,Xe),new ut(Ze,Dt),new ut(Lt,Dt),new ut(Lt,Xe)];if(Ne.length>2){for(const gt of Tt)if(Eh(Ne,gt))return!0}for(let gt=0;gt<Ne.length-1;gt++)if(KX(Ne[gt],Ne[gt+1],Tt))return!0;return!1}(a.cameraQueryGeometry,pe-F,$e-F,Be+F,Le+F));for(const pe of Q)W.push(pe);W.sort(xY);const ee={};let me;for(let pe=0;pe<W.length;pe++){const $e=W[pe];if($e===me)continue;me=$e;const Be=this.featureIndexArray.get($e);let Le=null;this.loadMatchingFeature(ee,Be.bucketIndex,Be.sourceLayerIndex,Be.featureIndex,C,T.layers,T.availableImages,d,m,v,(Ne,Ze,Xe)=>(Le||(Le=Zu(Ne)),Ze.queryIntersectsFeature(I,Ne,Xe,Le,this.z,a.transform,S,a.pixelPosMatrix)))}return ee}loadMatchingFeature(a,d,m,v,T,S,C,I,F,j,W){const X=this.bucketLayerIDs[d];if(S&&!function(pe,$e){for(let Be=0;Be<pe.length;Be++)if($e.indexOf(pe[Be])>=0)return!0;return!1}(S,X))return;const Q=this.sourceLayerCoder.decode(m),ee=this.vtLayers[Q].feature(v);if(T.needGeometry){const pe=Yu(ee,!0);if(!T.filter(new yr(this.tileID.overscaledZ),pe,this.tileID.canonical))return}else if(!T.filter(new yr(this.tileID.overscaledZ),ee))return;const me=this.getId(ee,Q);for(let pe=0;pe<X.length;pe++){const $e=X[pe];if(S&&S.indexOf($e)<0)continue;const Be=I[$e];if(!Be)continue;let Le={};me&&j&&(Le=j.getState(Be.sourceLayer||"_geojsonTileLayer",me));const Ne=L({},F[$e]);Ne.paint=I6(Ne.paint,Be.paint,ee,Le,C),Ne.layout=I6(Ne.layout,Be.layout,ee,Le,C);const Ze=!W||W(ee,Be,Le);if(!Ze)continue;const Xe=new C6(ee,this.z,this.x,this.y,me);Xe.layer=Ne;let Lt=a[$e];Lt===void 0&&(Lt=a[$e]=[]),Lt.push({featureIndex:v,feature:Xe,intersectionZ:Ze})}}lookupSymbolFeatures(a,d,m,v,T,S,C,I){const F={};this.loadVTLayers();const j=gh(T);for(const W of a)this.loadMatchingFeature(F,m,v,W,j,S,C,I,d);return F}hasLayer(a){for(const d of this.bucketLayerIDs)for(const m of d)if(a===m)return!0;return!1}getId(a,d){let m=a.id;return this.promoteId&&(m=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]],typeof m=="boolean"&&(m=Number(m))),m}}function I6(u,a,d,m,v){return D(u,(T,S)=>{const C=a instanceof Ku?a.get(S):null;return C&&C.evaluate?C.evaluate(d,m,v):C})}function R6(u){let a=1/0,d=1/0,m=-1/0,v=-1/0;for(const T of u)a=Math.min(a,T.x),d=Math.min(d,T.y),m=Math.max(m,T.x),v=Math.max(v,T.y);return{minX:a,minY:d,maxX:m,maxY:v}}function xY(u,a){return a-u}var Fw;Rt("FeatureIndex",L6,{omit:["rawTileData","sourceLayerCoder"]}),o.PerformanceMarkers=void 0,(Fw=o.PerformanceMarkers||(o.PerformanceMarkers={})).create="create",Fw.load="load",Fw.fullLoad="fullLoad";let lv=null,Tm=[];const Nw=1e3/30,wY={mark(u){performance.mark(u)},frame(u){const a=u;lv!=null&&Tm.push(a-lv),lv=a},clearMetrics(){lv=null,Tm=[],performance.clearMeasures("loadTime"),performance.clearMeasures("fullLoadTime");for(const u in o.PerformanceMarkers)performance.clearMarks(o.PerformanceMarkers[u])},getPerformanceMetrics(){performance.measure("loadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.load),performance.measure("fullLoadTime",o.PerformanceMarkers.create,o.PerformanceMarkers.fullLoad);const u=performance.getEntriesByName("loadTime")[0].duration,a=performance.getEntriesByName("fullLoadTime")[0].duration,d=Tm.length,m=1/(Tm.reduce((T,S)=>T+S,0)/d/1e3),v=Tm.filter(T=>T>Nw).reduce((T,S)=>T+(S-Nw)/Nw,0);return{loadTime:u,fullLoadTime:a,fps:m,percentDroppedFrames:v/(d+v)*100}}};o.AJAXError=bt,o.ARRAY_TYPE=us,o.Actor=class{constructor(u,a,d){this.target=u,this.parent=a,this.mapId=d,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},U(["receive","process"],this),this.invoker=new bY(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ve()?u:window}send(u,a,d,m,v=!1){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);d&&(this.callbacks[T]=d);const S=_e(this.globalScope)?void 0:[];return this.target.postMessage({id:T,type:u,hasCallback:!!d,targetMapId:m,mustQueue:v,sourceMapId:this.mapId,data:vl(a,S)},S),{cancel:()=>{d&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(u){const a=u.data,d=a.id;if(d&&(!a.targetMapId||this.mapId===a.targetMapId))if(a.type==="<cancel>"){delete this.tasks[d];const m=this.cancelCallbacks[d];delete this.cancelCallbacks[d],m&&m()}else ve()||a.mustQueue?(this.tasks[d]=a,this.taskQueue.push(d),this.invoker.trigger()):this.processTask(d,a)}process(){if(!this.taskQueue.length)return;const u=this.taskQueue.shift(),a=this.tasks[u];delete this.tasks[u],this.taskQueue.length&&this.invoker.trigger(),a&&this.processTask(u,a)}processTask(u,a){if(a.type==="<response>"){const d=this.callbacks[u];delete this.callbacks[u],d&&(a.error?d(Da(a.error)):d(null,Da(a.data)))}else{let d=!1;const m=_e(this.globalScope)?void 0:[],v=a.hasCallback?(C,I)=>{d=!0,delete this.cancelCallbacks[u],this.target.postMessage({id:u,type:"<response>",sourceMapId:this.mapId,error:C?vl(C):null,data:vl(I,m)},m)}:C=>{d=!0};let T=null;const S=Da(a.data);if(this.parent[a.type])T=this.parent[a.type](a.sourceMapId,S,v);else if(this.parent.getWorkerSource){const C=a.type.split(".");T=this.parent.getWorkerSource(a.sourceMapId,C[0],S.source)[C[1]](S,v)}else v(new Error(`Could not find function ${a.type}`));!d&&T&&T.cancel&&(this.cancelCallbacks[u]=T.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.AlphaImage=fm,o.CanonicalTileID=Dw,o.CollisionBoxArray=He,o.CollisionCircleLayoutArray=class extends G{},o.Color=se,o.DEMData=A6,o.DataConstantProperty=Nt,o.DictionaryCoder=P6,o.EXTENT=di,o.ErrorEvent=ko,o.EvaluationParameters=yr,o.Event=ai,o.Evented=ss,o.FeatureIndex=L6,o.FillBucket=_w,o.FillExtrusionBucket=xw,o.GeoJSONFeature=C6,o.ImageAtlas=Qk,o.ImagePosition=Sw,o.LineBucket=ww,o.LineStripIndexArray=class extends he{},o.LngLat=Br,o.LngLatBounds=Qu,o.MercatorCoordinate=av,o.ONE_EM=Ii,o.OverscaledTileID=ho,o.PerformanceUtils=wY,o.PosArray=Wt,o.Properties=Li,o.QuadTriangleArray=class extends Y{},o.RGBAImage=uo,o.RasterBoundsArray=class extends y{},o.RequestPerformance=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},o.ResourceType=St,o.SegmentVector=xn,o.SymbolBucket=Rh,o.Transitionable=F0,o.TriangleIndexArray=ls,o.Uniform1f=wl,o.Uniform1i=class extends xl{constructor(u,a){super(u,a),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},o.Uniform2f=class extends xl{constructor(u,a){super(u,a),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},o.Uniform3f=class extends xl{constructor(u,a){super(u,a),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},o.Uniform4f=wh,o.UniformColor=mk,o.UniformMatrix4f=class extends xl{constructor(u,a){super(u,a),this.current=jX}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let a=1;a<16;a++)if(u[a]!==this.current[a]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},o.UnwrappedTileID=S6,o.ValidationError=pt,o.ZoomHistory=Jp,o.add=function(u,a,d){return u[0]=a[0]+d[0],u[1]=a[1]+d[1],u[2]=a[2]+d[2],u},o.addDynamicAttributes=Iw,o.asyncAll=function(u,a,d){if(!u.length)return d(null,[]);let m=u.length;const v=new Array(u.length);let T=null;u.forEach((S,C)=>{a(S,(I,F)=>{I&&(T=I),v[C]=F,--m==0&&d(T,v)})})},o.bezier=b,o.bindAll=U,o.cacheEntryPossiblyAdded=function(u){kt++,kt>Ke&&(u.getActor().send("enforceCacheSizeLimit",Re),kt=0)},o.clamp=w,o.clearTileCache=function(u){const a=caches.delete(yt);u&&a.catch(u).then(()=>u())},o.clipLine=d6,o.clone=function(u){var a=new us(16);return a[0]=u[0],a[1]=u[1],a[2]=u[2],a[3]=u[3],a[4]=u[4],a[5]=u[5],a[6]=u[6],a[7]=u[7],a[8]=u[8],a[9]=u[9],a[10]=u[10],a[11]=u[11],a[12]=u[12],a[13]=u[13],a[14]=u[14],a[15]=u[15],a},o.clone$1=N,o.clone$2=function(u){var a=new us(3);return a[0]=u[0],a[1]=u[1],a[2]=u[2],a},o.collisionCircleLayout=BZ,o.config=ot,o.copy=function(u,a){return u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[4]=a[4],u[5]=a[5],u[6]=a[6],u[7]=a[7],u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},o.create=function(){var u=new us(16);return us!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},o.create$1=Tk,o.createExpression=ku,o.createFilter=gh,o.createLayout=ei,o.createStyleLayer=function(u){return u.type==="custom"?new vY(u):new _Y[u.type](u)},o.cross=function(u,a,d){var m=a[0],v=a[1],T=a[2],S=d[0],C=d[1],I=d[2];return u[0]=v*I-T*C,u[1]=T*S-m*I,u[2]=m*C-v*S,u},o.dot=function(u,a){return u[0]*a[0]+u[1]*a[1]+u[2]*a[2]},o.dot$1=function(u,a){return u[0]*a[0]+u[1]*a[1]+u[2]*a[2]+u[3]*a[3]},o.ease=x,o.emitValidationErrors=vh,o.enforceCacheSizeLimit=function(u){Je(),at&&at.then(a=>{a.keys().then(d=>{for(let m=0;m<d.length-u;m++)a.delete(d[m])})})},o.equals=function(u,a){var d=u[0],m=u[1],v=u[2],T=u[3],S=u[4],C=u[5],I=u[6],F=u[7],j=u[8],W=u[9],X=u[10],Q=u[11],ee=u[12],me=u[13],pe=u[14],$e=u[15],Be=a[0],Le=a[1],Ne=a[2],Ze=a[3],Xe=a[4],Lt=a[5],Dt=a[6],Tt=a[7],gt=a[8],ht=a[9],Et=a[10],_t=a[11],it=a[12],Ht=a[13],Bt=a[14],yn=a[15];return Math.abs(d-Be)<=cs*Math.max(1,Math.abs(d),Math.abs(Be))&&Math.abs(m-Le)<=cs*Math.max(1,Math.abs(m),Math.abs(Le))&&Math.abs(v-Ne)<=cs*Math.max(1,Math.abs(v),Math.abs(Ne))&&Math.abs(T-Ze)<=cs*Math.max(1,Math.abs(T),Math.abs(Ze))&&Math.abs(S-Xe)<=cs*Math.max(1,Math.abs(S),Math.abs(Xe))&&Math.abs(C-Lt)<=cs*Math.max(1,Math.abs(C),Math.abs(Lt))&&Math.abs(I-Dt)<=cs*Math.max(1,Math.abs(I),Math.abs(Dt))&&Math.abs(F-Tt)<=cs*Math.max(1,Math.abs(F),Math.abs(Tt))&&Math.abs(j-gt)<=cs*Math.max(1,Math.abs(j),Math.abs(gt))&&Math.abs(W-ht)<=cs*Math.max(1,Math.abs(W),Math.abs(ht))&&Math.abs(X-Et)<=cs*Math.max(1,Math.abs(X),Math.abs(Et))&&Math.abs(Q-_t)<=cs*Math.max(1,Math.abs(Q),Math.abs(_t))&&Math.abs(ee-it)<=cs*Math.max(1,Math.abs(ee),Math.abs(it))&&Math.abs(me-Ht)<=cs*Math.max(1,Math.abs(me),Math.abs(Ht))&&Math.abs(pe-Bt)<=cs*Math.max(1,Math.abs(pe),Math.abs(Bt))&&Math.abs($e-yn)<=cs*Math.max(1,Math.abs($e),Math.abs(yn))},o.evaluateSizeForFeature=function(u,{uSize:a,uSizeT:d},{lowerSize:m,upperSize:v}){return u.kind==="source"?m/Sl:u.kind==="composite"?mn(m/Sl,v/Sl,d):a},o.evaluateSizeForZoom=function(u,a){let d=0,m=0;if(u.kind==="constant")m=u.layoutSize;else if(u.kind!=="source"){const{interpolationType:v,minZoom:T,maxZoom:S}=u,C=v?w(ws.interpolationFactor(v,a,T,S),0,1):0;u.kind==="camera"?m=mn(u.minSize,u.maxSize,C):d=C}return{uSizeT:d,uSize:m}},o.evaluateVariableOffset=p6,o.evented=sm,o.exported=Vt,o.exported$1=ft,o.extend=L,o.filterObject=$,o.fromRotation=function(u,a){var d=Math.sin(a),m=Math.cos(a);return u[0]=m,u[1]=d,u[2]=0,u[3]=-d,u[4]=m,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},o.fromScaling=function(u,a){return u[0]=a[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=a[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=a[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},o.getAnchorAlignment=Pw,o.getAnchorJustification=Lw,o.getArrayBuffer=Ln,o.getImage=Nr,o.getJSON=function(u,a){return On(L(u,{type:"json"}),a)},o.getOverlapMode=kw,o.getRTLTextPluginStatus=Hu,o.getReferrer=hn,o.getVideo=function(u,a){const d=window.document.createElement("video");d.muted=!0,d.onloadstart=function(){a(null,d)};for(let m=0;m<u.length;m++){const v=window.document.createElement("source");is(u[m])||(d.crossOrigin="Anonymous"),v.src=u[m],d.appendChild(v)}return{cancel:()=>{}}},o.identity=uw,o.invert=function(u,a){var d=a[0],m=a[1],v=a[2],T=a[3],S=a[4],C=a[5],I=a[6],F=a[7],j=a[8],W=a[9],X=a[10],Q=a[11],ee=a[12],me=a[13],pe=a[14],$e=a[15],Be=d*C-m*S,Le=d*I-v*S,Ne=d*F-T*S,Ze=m*I-v*C,Xe=m*F-T*C,Lt=v*F-T*I,Dt=j*me-W*ee,Tt=j*pe-X*ee,gt=j*$e-Q*ee,ht=W*pe-X*me,Et=W*$e-Q*me,_t=X*$e-Q*pe,it=Be*_t-Le*Et+Ne*ht+Ze*gt-Xe*Tt+Lt*Dt;return it?(u[0]=(C*_t-I*Et+F*ht)*(it=1/it),u[1]=(v*Et-m*_t-T*ht)*it,u[2]=(me*Lt-pe*Xe+$e*Ze)*it,u[3]=(X*Xe-W*Lt-Q*Ze)*it,u[4]=(I*gt-S*_t-F*Tt)*it,u[5]=(d*_t-v*gt+T*Tt)*it,u[6]=(pe*Ne-ee*Lt-$e*Le)*it,u[7]=(j*Lt-X*Ne+Q*Le)*it,u[8]=(S*Et-C*gt+F*Dt)*it,u[9]=(m*gt-d*Et-T*Dt)*it,u[10]=(ee*Xe-me*Ne+$e*Be)*it,u[11]=(W*Ne-j*Xe-Q*Be)*it,u[12]=(C*Tt-S*ht-I*Dt)*it,u[13]=(d*ht-m*Tt+v*Dt)*it,u[14]=(me*Le-ee*Ze-pe*Be)*it,u[15]=(j*Ze-W*Le+X*Be)*it,u):null},o.isImageBitmap=ke,o.isSafari=_e,o.isWorker=ve,o.keysDifference=function(u,a){const d=[];for(const m in u)m in a||d.push(m);return d},o.lazyLoadRTLTextPlugin=function(){js.isLoading()||js.isLoaded()||Hu()!=="deferred"||D0()},o.makeRequest=On,o.mapObject=D,o.mercatorXfromLng=x6,o.mercatorYfromLat=w6,o.mercatorZfromAltitude=T6,o.mul=YX,o.mul$1=function(u,a,d){return u[0]=a[0]*d[0],u[1]=a[1]*d[1],u[2]=a[2]*d[2],u[3]=a[3]*d[3],u},o.multiply=Ek,o.nextPowerOfTwo=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},o.normalize=function(u,a){var d=a[0],m=a[1],v=a[2],T=d*d+m*m+v*v;return T>0&&(T=1/Math.sqrt(T)),u[0]=a[0]*T,u[1]=a[1]*T,u[2]=a[2]*T,u},o.number=mn,o.ortho=function(u,a,d,m,v,T,S){var C=1/(a-d),I=1/(m-v),F=1/(T-S);return u[0]=-2*C,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*I,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*F,u[11]=0,u[12]=(a+d)*C,u[13]=(v+m)*I,u[14]=(S+T)*F,u[15]=1,u},o.parseCacheControl=Te,o.parseGlyphPbf=function(u){return new Tw(u).readFields(YZ,[])},o.pbf=Tw,o.performSymbolLayout=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=di/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;const a=u.bucket.layers[0].layout,d=u.bucket.layers[0]._unevaluatedLayout._values,m={layoutIconSize:d["icon-size"].possiblyEvaluate(new yr(u.bucket.zoom+1),u.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new yr(u.bucket.zoom+1),u.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new yr(18))};if(u.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:F}=u.bucket.textSizeData;m.compositeTextSizes=[d["text-size"].possiblyEvaluate(new yr(I),u.canonical),d["text-size"].possiblyEvaluate(new yr(F),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:F}=u.bucket.iconSizeData;m.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new yr(I),u.canonical),d["icon-size"].possiblyEvaluate(new yr(F),u.canonical)]}const v=a.get("text-line-height")*Ii,T=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point",S=a.get("text-keep-upright"),C=a.get("text-size");for(const I of u.bucket.features){const F=a.get("text-font").evaluate(I,{},u.canonical).join(","),j=C.evaluate(I,{},u.canonical),W=m.layoutTextSize.evaluate(I,{},u.canonical),X=m.layoutIconSize.evaluate(I,{},u.canonical),Q={horizontal:{},vertical:void 0},ee=I.text;let me,pe=[0,0];if(ee){const Le=ee.toString(),Ne=a.get("text-letter-spacing").evaluate(I,{},u.canonical)*Ii,Ze=nw(Le)?Ne:0,Xe=a.get("text-anchor").evaluate(I,{},u.canonical),Lt=a.get("text-variable-anchor");if(!Lt){const Et=a.get("text-radial-offset").evaluate(I,{},u.canonical);pe=Et?p6(Xe,[Et*Ii,Cw]):a.get("text-offset").evaluate(I,{},u.canonical).map(_t=>_t*Ii)}let Dt=T?"center":a.get("text-justify").evaluate(I,{},u.canonical);const Tt=a.get("symbol-placement"),gt=Tt==="point"?a.get("text-max-width").evaluate(I,{},u.canonical)*Ii:0,ht=()=>{u.bucket.allowVerticalPlacement&&_h(Le)&&(Q.vertical=Q0(ee,u.glyphMap,u.glyphPositions,u.imagePositions,F,gt,v,Xe,"left",Ze,pe,o.WritingMode.vertical,!0,Tt,W,j))};if(!T&&Lt){const Et=Dt==="auto"?Lt.map(it=>Lw(it)):[Dt];let _t=!1;for(let it=0;it<Et.length;it++){const Ht=Et[it];if(!Q.horizontal[Ht])if(_t)Q.horizontal[Ht]=Q.horizontal[0];else{const Bt=Q0(ee,u.glyphMap,u.glyphPositions,u.imagePositions,F,gt,v,"center",Ht,Ze,pe,o.WritingMode.horizontal,!1,Tt,W,j);Bt&&(Q.horizontal[Ht]=Bt,_t=Bt.positionedLines.length===1)}}ht()}else{Dt==="auto"&&(Dt=Lw(Xe));const Et=Q0(ee,u.glyphMap,u.glyphPositions,u.imagePositions,F,gt,v,Xe,Dt,Ze,pe,o.WritingMode.horizontal,!1,Tt,W,j);Et&&(Q.horizontal[Dt]=Et),ht(),_h(Le)&&T&&S&&(Q.vertical=Q0(ee,u.glyphMap,u.glyphPositions,u.imagePositions,F,gt,v,Xe,Dt,Ze,pe,o.WritingMode.vertical,!1,Tt,W,j))}}let $e=!1;if(I.icon&&I.icon.name){const Le=u.imageMap[I.icon.name];Le&&(me=rY(u.imagePositions[I.icon.name],a.get("icon-offset").evaluate(I,{},u.canonical),a.get("icon-anchor").evaluate(I,{},u.canonical)),$e=!!Le.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=$e:u.bucket.sdfIcons!==$e&&Z("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Le.pixelRatio!==u.bucket.pixelRatio||a.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}const Be=g6(Q.horizontal)||Q.vertical;u.bucket.iconsInText=!!Be&&Be.iconsInText,(Be||me)&&uY(u.bucket,I,Q,me,u.imageMap,m,W,X,pe,$e,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},o.perspective=function(u,a,d,m,v){var T,S=1/Math.tan(a/2);return u[0]=S/d,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=S,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,v!=null&&v!==1/0?(u[10]=(v+m)*(T=1/(m-v)),u[14]=2*v*m*T):(u[10]=-1,u[14]=-2*m),u},o.pick=function(u,a){const d={};for(let m=0;m<a.length;m++){const v=a[m];v in u&&(d[v]=u[v])}return d},o.plugin=js,o.pointGeometry=ut,o.polygonIntersectsPolygon=_k,o.potpack=Jk,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.register=Rt,o.registerForPluginStateChange=function(u){return u({pluginStatus:as,pluginURL:Fa}),sm.on("pluginStateChange",u),u},o.renderColorRamp=Rk,o.rotateX=function(u,a,d){var m=Math.sin(d),v=Math.cos(d),T=a[4],S=a[5],C=a[6],I=a[7],F=a[8],j=a[9],W=a[10],X=a[11];return a!==u&&(u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[4]=T*v+F*m,u[5]=S*v+j*m,u[6]=C*v+W*m,u[7]=I*v+X*m,u[8]=F*v-T*m,u[9]=j*v-S*m,u[10]=W*v-C*m,u[11]=X*v-I*m,u},o.rotateZ=function(u,a,d){var m=Math.sin(d),v=Math.cos(d),T=a[0],S=a[1],C=a[2],I=a[3],F=a[4],j=a[5],W=a[6],X=a[7];return a!==u&&(u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[0]=T*v+F*m,u[1]=S*v+j*m,u[2]=C*v+W*m,u[3]=I*v+X*m,u[4]=F*v-T*m,u[5]=j*v-S*m,u[6]=W*v-C*m,u[7]=X*v-I*m,u},o.scale=function(u,a,d){var m=d[0],v=d[1],T=d[2];return u[0]=a[0]*m,u[1]=a[1]*m,u[2]=a[2]*m,u[3]=a[3]*m,u[4]=a[4]*v,u[5]=a[5]*v,u[6]=a[6]*v,u[7]=a[7]*v,u[8]=a[8]*T,u[9]=a[9]*T,u[10]=a[10]*T,u[11]=a[11]*T,u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},o.scale$1=function(u,a,d){return u[0]=a[0]*d,u[1]=a[1]*d,u[2]=a[2]*d,u},o.setCacheLimits=function(u,a){Re=u,Ke=a},o.setRTLTextPlugin=function(u,a,d=!1){if(as===tm||as===nm||as===rm)throw new Error("setRTLTextPlugin cannot be called multiple times.");Fa=Vt.resolveURL(u),as=tm,im=a,Sc(),d||D0()},o.spec=We,o.sphericalToCartesian=function([u,a,d]){return a+=90,a*=Math.PI/180,d*=Math.PI/180,{x:u*Math.cos(a)*Math.sin(d),y:u*Math.sin(a)*Math.sin(d),z:u*Math.cos(d)}},o.sqrLen=function(u){var a=u[0],d=u[1];return a*a+d*d},o.sub=function(u,a,d){return u[0]=a[0]-d[0],u[1]=a[1]-d[1],u[2]=a[2]-d[2],u},o.toEvaluationFeature=Yu,o.transformMat3=function(u,a,d){var m=a[0],v=a[1],T=a[2];return u[0]=m*d[0]+v*d[3]+T*d[6],u[1]=m*d[1]+v*d[4]+T*d[7],u[2]=m*d[2]+v*d[5]+T*d[8],u},o.transformMat4=W0,o.transformMat4$1=function(u,a,d){var m=a[0],v=a[1];return u[0]=d[0]*m+d[4]*v+d[12],u[1]=d[1]*m+d[5]*v+d[13],u},o.translate=function(u,a,d){var m,v,T,S,C,I,F,j,W,X,Q,ee,me=d[0],pe=d[1],$e=d[2];return a===u?(u[12]=a[0]*me+a[4]*pe+a[8]*$e+a[12],u[13]=a[1]*me+a[5]*pe+a[9]*$e+a[13],u[14]=a[2]*me+a[6]*pe+a[10]*$e+a[14],u[15]=a[3]*me+a[7]*pe+a[11]*$e+a[15]):(v=a[1],T=a[2],S=a[3],C=a[4],I=a[5],F=a[6],j=a[7],W=a[8],X=a[9],Q=a[10],ee=a[11],u[0]=m=a[0],u[1]=v,u[2]=T,u[3]=S,u[4]=C,u[5]=I,u[6]=F,u[7]=j,u[8]=W,u[9]=X,u[10]=Q,u[11]=ee,u[12]=m*me+C*pe+W*$e+a[12],u[13]=v*me+I*pe+X*$e+a[13],u[14]=T*me+F*pe+Q*$e+a[14],u[15]=S*me+j*pe+ee*$e+a[15]),u},o.triggerPluginCompletionEvent=O0,o.unicodeBlockLookup=wt,o.uniqueId=function(){return M++},o.validateCustomStyleLayer=function(u){const a=[],d=u.id;return d===void 0&&a.push({message:`layers.${d}: missing required property "id"`}),u.render===void 0&&a.push({message:`layers.${d}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&a.push({message:`layers.${d}: property "renderingMode" must be either "2d" or "3d"`}),a},o.validateLight=Yp,o.validateStyle=Gu,o.vectorTile=Lc,o.warnOnce=Z,o.wrap=A}),s(["./shared"],function(o){function h(ae){const V=typeof ae;if(V==="number"||V==="boolean"||V==="string"||ae==null)return JSON.stringify(ae);if(Array.isArray(ae)){let se="[";for(const ye of ae)se+=`${h(ye)},`;return`${se}]`}const H=Object.keys(ae).sort();let ne="{";for(let se=0;se<H.length;se++)ne+=`${JSON.stringify(H[se])}:${h(ae[H[se]])},`;return`${ne}}`}function p(ae){let V="";for(const H of o.refProperties)V+=`/${h(ae[H])}`;return V}class b{constructor(V){this.keyCache={},V&&this.replace(V)}replace(V){this._layerConfigs={},this._layers={},this.update(V,[])}update(V,H){for(const se of V){this._layerConfigs[se.id]=se;const ye=this._layers[se.id]=o.createStyleLayer(se);ye._featureFilter=o.createFilter(ye.filter),this.keyCache[se.id]&&delete this.keyCache[se.id]}for(const se of H)delete this.keyCache[se],delete this._layerConfigs[se],delete this._layers[se];this.familiesBySource={};const ne=function(se,ye){const Ee={};for(let ge=0;ge<se.length;ge++){const Se=ye&&ye[se[ge].id]||p(se[ge]);ye&&(ye[se[ge].id]=Se);let je=Ee[Se];je||(je=Ee[Se]=[]),je.push(se[ge])}const xe=[];for(const ge in Ee)xe.push(Ee[ge]);return xe}(Object.values(this._layerConfigs),this.keyCache);for(const se of ne){const ye=se.map(et=>this._layers[et.id]),Ee=ye[0];if(Ee.visibility==="none")continue;const xe=Ee.source||"";let ge=this.familiesBySource[xe];ge||(ge=this.familiesBySource[xe]={});const Se=Ee.sourceLayer||"_geojsonTileLayer";let je=ge[Se];je||(je=ge[Se]=[]),je.push(ye)}}}class x{constructor(V){const H={},ne=[];for(const xe in V){const ge=V[xe],Se=H[xe]={};for(const je in ge){const et=ge[+je];if(!et||et.bitmap.width===0||et.bitmap.height===0)continue;const Ve={x:0,y:0,w:et.bitmap.width+2,h:et.bitmap.height+2};ne.push(Ve),Se[je]={rect:Ve,metrics:et.metrics}}}const{w:se,h:ye}=o.potpack(ne),Ee=new o.AlphaImage({width:se||1,height:ye||1});for(const xe in V){const ge=V[xe];for(const Se in ge){const je=ge[+Se];if(!je||je.bitmap.width===0||je.bitmap.height===0)continue;const et=H[xe][Se].rect;o.AlphaImage.copy(je.bitmap,Ee,{x:0,y:0},{x:et.x+1,y:et.y+1},je.bitmap)}}this.image=Ee,this.positions=H}}o.register("GlyphAtlas",x);class w{constructor(V){this.tileID=new o.OverscaledTileID(V.tileID.overscaledZ,V.tileID.wrap,V.tileID.canonical.z,V.tileID.canonical.x,V.tileID.canonical.y),this.uid=V.uid,this.zoom=V.zoom,this.pixelRatio=V.pixelRatio,this.tileSize=V.tileSize,this.source=V.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=V.showCollisionBoxes,this.collectResourceTiming=!!V.collectResourceTiming,this.returnDependencies=!!V.returnDependencies,this.promoteId=V.promoteId}parse(V,H,ne,se,ye){this.status="parsing",this.data=V,this.collisionBoxArray=new o.CollisionBoxArray;const Ee=new o.DictionaryCoder(Object.keys(V.layers).sort()),xe=new o.FeatureIndex(this.tileID,this.promoteId);xe.bucketLayerIDs=[];const ge={},Se={featureIndex:xe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ne},je=H.familiesBySource[this.source];for(const Zt in je){const nn=V.layers[Zt];if(!nn)continue;nn.version===1&&o.warnOnce(`Vector tile source "${this.source}" layer "${Zt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const _n=Ee.encode(Zt),En=[];for(let ir=0;ir<nn.length;ir++){const sr=nn.feature(ir),ci=xe.getId(sr,Zt);En.push({feature:sr,id:ci,index:ir,sourceLayerIndex:_n})}for(const ir of je[Zt]){const sr=ir[0];sr.source!==this.source&&o.warnOnce(`layer.source = ${sr.source} does not equal this.source = ${this.source}`),sr.minzoom&&this.zoom<Math.floor(sr.minzoom)||sr.maxzoom&&this.zoom>=sr.maxzoom||sr.visibility!=="none"&&(A(ir,this.zoom,ne),(ge[sr.id]=sr.createBucket({index:xe.bucketLayerIDs.length,layers:ir,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:_n,sourceID:this.source})).populate(En,Se,this.tileID.canonical),xe.bucketLayerIDs.push(ir.map(ci=>ci.id)))}}let et,Ve,It,Ot;const xt=o.mapObject(Se.glyphDependencies,Zt=>Object.keys(Zt).map(Number));Object.keys(xt).length?se.send("getGlyphs",{uid:this.uid,stacks:xt},(Zt,nn)=>{et||(et=Zt,Ve=nn,pn.call(this))}):Ve={};const Gt=Object.keys(Se.iconDependencies);Gt.length?se.send("getImages",{icons:Gt,source:this.source,tileID:this.tileID,type:"icons"},(Zt,nn)=>{et||(et=Zt,It=nn,pn.call(this))}):It={};const zt=Object.keys(Se.patternDependencies);function pn(){if(et)return ye(et);if(Ve&&It&&Ot){const Zt=new x(Ve),nn=new o.ImageAtlas(It,Ot);for(const _n in ge){const En=ge[_n];En instanceof o.SymbolBucket?(A(En.layers,this.zoom,ne),o.performSymbolLayout({bucket:En,glyphMap:Ve,glyphPositions:Zt.positions,imageMap:It,imagePositions:nn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):En.hasPattern&&(En instanceof o.LineBucket||En instanceof o.FillBucket||En instanceof o.FillExtrusionBucket)&&(A(En.layers,this.zoom,ne),En.addFeatures(Se,this.tileID.canonical,nn.patternPositions))}this.status="done",ye(null,{buckets:Object.values(ge).filter(_n=>!_n.isEmpty()),featureIndex:xe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Zt.image,imageAtlas:nn,glyphMap:this.returnDependencies?Ve:null,iconMap:this.returnDependencies?It:null,glyphPositions:this.returnDependencies?Zt.positions:null})}}zt.length?se.send("getImages",{icons:zt,source:this.source,tileID:this.tileID,type:"patterns"},(Zt,nn)=>{et||(et=Zt,Ot=nn,pn.call(this))}):Ot={},pn.call(this)}}function A(ae,V,H){const ne=new o.EvaluationParameters(V);for(const se of ae)se.recalculate(ne,H)}function L(ae,V){const H=o.getArrayBuffer(ae.request,(ne,se,ye,Ee)=>{ne?V(ne):se&&V(null,{vectorTile:new o.vectorTile.VectorTile(new o.pbf(se)),rawData:se,cacheControl:ye,expires:Ee})});return()=>{H.cancel(),V()}}class M{constructor(V,H,ne,se){this.actor=V,this.layerIndex=H,this.availableImages=ne,this.loadVectorData=se||L,this.loading={},this.loaded={}}loadTile(V,H){const ne=V.uid;this.loading||(this.loading={});const se=!!(V&&V.request&&V.request.collectResourceTiming)&&new o.RequestPerformance(V.request),ye=this.loading[ne]=new w(V);ye.abort=this.loadVectorData(V,(Ee,xe)=>{if(delete this.loading[ne],Ee||!xe)return ye.status="done",this.loaded[ne]=ye,H(Ee);const ge=xe.rawData,Se={};xe.expires&&(Se.expires=xe.expires),xe.cacheControl&&(Se.cacheControl=xe.cacheControl);const je={};if(se){const et=se.finish();et&&(je.resourceTiming=JSON.parse(JSON.stringify(et)))}ye.vectorTile=xe.vectorTile,ye.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor,(et,Ve)=>{if(et||!Ve)return H(et);H(null,o.extend({rawTileData:ge.slice(0)},Ve,Se,je))}),this.loaded=this.loaded||{},this.loaded[ne]=ye})}reloadTile(V,H){const ne=this.loaded,se=V.uid,ye=this;if(ne&&ne[se]){const Ee=ne[se];Ee.showCollisionBoxes=V.showCollisionBoxes;const xe=(ge,Se)=>{const je=Ee.reloadCallback;je&&(delete Ee.reloadCallback,Ee.parse(Ee.vectorTile,ye.layerIndex,this.availableImages,ye.actor,je)),H(ge,Se)};Ee.status==="parsing"?Ee.reloadCallback=xe:Ee.status==="done"&&(Ee.vectorTile?Ee.parse(Ee.vectorTile,this.layerIndex,this.availableImages,this.actor,xe):xe())}}abortTile(V,H){const ne=this.loading,se=V.uid;ne&&ne[se]&&ne[se].abort&&(ne[se].abort(),delete ne[se]),H()}removeTile(V,H){const ne=this.loaded,se=V.uid;ne&&ne[se]&&delete ne[se],H()}}class U{constructor(){this.loaded={}}loadTile(V,H){const{uid:ne,encoding:se,rawImageData:ye}=V,Ee=o.isImageBitmap(ye)?this.getImageData(ye):ye,xe=new o.DEMData(ne,Ee,se);this.loaded=this.loaded||{},this.loaded[ne]=xe,H(null,xe)}getImageData(V){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(V.width,V.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=V.width,this.offscreenCanvas.height=V.height,this.offscreenCanvasContext.drawImage(V,0,0,V.width,V.height);const H=this.offscreenCanvasContext.getImageData(-1,-1,V.width+2,V.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new o.RGBAImage({width:H.width,height:H.height},H.data)}removeTile(V){const H=this.loaded,ne=V.uid;H&&H[ne]&&delete H[ne]}}var D=function ae(V,H){var ne,se=V&&V.type;if(se==="FeatureCollection")for(ne=0;ne<V.features.length;ne++)ae(V.features[ne],H);else if(se==="GeometryCollection")for(ne=0;ne<V.geometries.length;ne++)ae(V.geometries[ne],H);else if(se==="Feature")ae(V.geometry,H);else if(se==="Polygon")$(V.coordinates,H);else if(se==="MultiPolygon")for(ne=0;ne<V.coordinates.length;ne++)$(V.coordinates[ne],H);return V};function $(ae,V){if(ae.length!==0){N(ae[0],V);for(var H=1;H<ae.length;H++)N(ae[H],!V)}}function N(ae,V){for(var H=0,ne=0,se=0,ye=ae.length,Ee=ye-1;se<ye;Ee=se++){var xe=(ae[se][0]-ae[Ee][0])*(ae[Ee][1]+ae[se][1]),ge=H+xe;ne+=Math.abs(H)>=Math.abs(xe)?H-ge+xe:xe-ge+H,H=ge}H+ne>=0!=!!V&&ae.reverse()}const B=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Z{constructor(V){this._feature=V,this.extent=o.EXTENT,this.type=V.type,this.properties=V.tags,"id"in V&&!isNaN(V.id)&&(this.id=parseInt(V.id,10))}loadGeometry(){if(this._feature.type===1){const V=[];for(const H of this._feature.geometry)V.push([new o.pointGeometry(H[0],H[1])]);return V}{const V=[];for(const H of this._feature.geometry){const ne=[];for(const se of H)ne.push(new o.pointGeometry(se[0],se[1]));V.push(ne)}return V}}toGeoJSON(V,H,ne){return B.call(this,V,H,ne)}}class ie{constructor(V){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=V.length,this._features=V}feature(V){return new Z(this._features[V])}}var re={exports:{}},ve=o.pointGeometry,Te=o.vectorTile.VectorTileFeature,Ae=fe;function fe(ae,V){this.options=V||{},this.features=ae,this.length=ae.length}function Pe(ae,V){this.id=typeof ae.id=="number"?ae.id:void 0,this.type=ae.type,this.rawGeometry=ae.type===1?[ae.geometry]:ae.geometry,this.properties=ae.tags,this.extent=V||4096}fe.prototype.feature=function(ae){return new Pe(this.features[ae],this.options.extent)},Pe.prototype.loadGeometry=function(){var ae=this.rawGeometry;this.geometry=[];for(var V=0;V<ae.length;V++){for(var H=ae[V],ne=[],se=0;se<H.length;se++)ne.push(new ve(H[se][0],H[se][1]));this.geometry.push(ne)}return this.geometry},Pe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ae=this.geometry,V=1/0,H=-1/0,ne=1/0,se=-1/0,ye=0;ye<ae.length;ye++)for(var Ee=ae[ye],xe=0;xe<Ee.length;xe++){var ge=Ee[xe];V=Math.min(V,ge.x),H=Math.max(H,ge.x),ne=Math.min(ne,ge.y),se=Math.max(se,ge.y)}return[V,ne,H,se]},Pe.prototype.toGeoJSON=Te.prototype.toGeoJSON;var _e=o.pbf,ke=Ae;function Vt(ae){var V=new _e;return function(H,ne){for(var se in H.layers)ne.writeMessage(3,ut,H.layers[se])}(ae,V),V.finish()}function ut(ae,V){var H;V.writeVarintField(15,ae.version||1),V.writeStringField(1,ae.name||""),V.writeVarintField(5,ae.extent||4096);var ne={keys:[],values:[],keycache:{},valuecache:{}};for(H=0;H<ae.length;H++)ne.feature=ae.feature(H),V.writeMessage(2,rn,ne);var se=ne.keys;for(H=0;H<se.length;H++)V.writeStringField(3,se[H]);var ye=ne.values;for(H=0;H<ye.length;H++)V.writeMessage(4,Re,ye[H])}function rn(ae,V){var H=ae.feature;H.id!==void 0&&V.writeVarintField(1,H.id),V.writeMessage(2,ot,ae),V.writeVarintField(3,H.type),V.writeMessage(4,Mt,H)}function ot(ae,V){var H=ae.feature,ne=ae.keys,se=ae.values,ye=ae.keycache,Ee=ae.valuecache;for(var xe in H.properties){var ge=H.properties[xe],Se=ye[xe];if(ge!==null){Se===void 0&&(ne.push(xe),ye[xe]=Se=ne.length-1),V.writeVarint(Se);var je=typeof ge;je!=="string"&&je!=="boolean"&&je!=="number"&&(ge=JSON.stringify(ge));var et=je+":"+ge,Ve=Ee[et];Ve===void 0&&(se.push(ge),Ee[et]=Ve=se.length-1),V.writeVarint(Ve)}}}function yt(ae,V){return(V<<3)+(7&ae)}function at(ae){return ae<<1^ae>>31}function Mt(ae,V){for(var H=ae.loadGeometry(),ne=ae.type,se=0,ye=0,Ee=H.length,xe=0;xe<Ee;xe++){var ge=H[xe],Se=1;ne===1&&(Se=ge.length),V.writeVarint(yt(1,Se));for(var je=ne===3?ge.length-1:ge.length,et=0;et<je;et++){et===1&&ne!==1&&V.writeVarint(yt(2,je-1));var Ve=ge[et].x-se,It=ge[et].y-ye;V.writeVarint(at(Ve)),V.writeVarint(at(It)),se+=Ve,ye+=It}ne===3&&V.writeVarint(yt(7,1))}}function Re(ae,V){var H=typeof ae;H==="string"?V.writeStringField(1,ae):H==="boolean"?V.writeBooleanField(7,ae):H==="number"&&(ae%1!=0?V.writeDoubleField(3,ae):ae<0?V.writeSVarintField(6,ae):V.writeVarintField(5,ae))}function Ke(ae,V,H,ne,se,ye){if(se-ne<=H)return;const Ee=ne+se>>1;Je(ae,V,Ee,ne,se,ye%2),Ke(ae,V,H,ne,Ee-1,ye+1),Ke(ae,V,H,Ee+1,se,ye+1)}function Je(ae,V,H,ne,se,ye){for(;se>ne;){if(se-ne>600){const Se=se-ne+1,je=H-ne+1,et=Math.log(Se),Ve=.5*Math.exp(2*et/3),It=.5*Math.sqrt(et*Ve*(Se-Ve)/Se)*(je-Se/2<0?-1:1);Je(ae,V,H,Math.max(ne,Math.floor(H-je*Ve/Se+It)),Math.min(se,Math.floor(H+(Se-je)*Ve/Se+It)),ye)}const Ee=V[2*H+ye];let xe=ne,ge=se;for(kt(ae,V,ne,H),V[2*se+ye]>Ee&&kt(ae,V,ne,se);xe<ge;){for(kt(ae,V,xe,ge),xe++,ge--;V[2*xe+ye]<Ee;)xe++;for(;V[2*ge+ye]>Ee;)ge--}V[2*ne+ye]===Ee?kt(ae,V,ne,ge):(ge++,kt(ae,V,ge,se)),ge<=H&&(ne=ge+1),H<=ge&&(se=ge-1)}}function kt(ae,V,H,ne){ft(ae,H,ne),ft(V,2*H,2*ne),ft(V,2*H+1,2*ne+1)}function ft(ae,V,H){const ne=ae[V];ae[V]=ae[H],ae[H]=ne}function Pt(ae,V,H,ne){const se=ae-H,ye=V-ne;return se*se+ye*ye}re.exports=Vt,re.exports.fromVectorTileJs=Vt,re.exports.fromGeojsonVt=function(ae,V){V=V||{};var H={};for(var ne in ae)H[ne]=new ke(ae[ne].features,V),H[ne].name=ne,H[ne].version=V.version,H[ne].extent=V.extent;return Vt({layers:H})},re.exports.GeoJSONWrapper=ke;const qt=ae=>ae[0],lt=ae=>ae[1];class tn{constructor(V,H=qt,ne=lt,se=64,ye=Float64Array){this.nodeSize=se,this.points=V;const Ee=V.length<65536?Uint16Array:Uint32Array,xe=this.ids=new Ee(V.length),ge=this.coords=new ye(2*V.length);for(let Se=0;Se<V.length;Se++)xe[Se]=Se,ge[2*Se]=H(V[Se]),ge[2*Se+1]=ne(V[Se]);Ke(xe,ge,se,0,xe.length-1,0)}range(V,H,ne,se){return function(ye,Ee,xe,ge,Se,je,et){const Ve=[0,ye.length-1,0],It=[];let Ot,xt;for(;Ve.length;){const Gt=Ve.pop(),zt=Ve.pop(),pn=Ve.pop();if(zt-pn<=et){for(let _n=pn;_n<=zt;_n++)Ot=Ee[2*_n],xt=Ee[2*_n+1],Ot>=xe&&Ot<=Se&&xt>=ge&&xt<=je&&It.push(ye[_n]);continue}const Zt=Math.floor((pn+zt)/2);Ot=Ee[2*Zt],xt=Ee[2*Zt+1],Ot>=xe&&Ot<=Se&&xt>=ge&&xt<=je&&It.push(ye[Zt]);const nn=(Gt+1)%2;(Gt===0?xe<=Ot:ge<=xt)&&(Ve.push(pn),Ve.push(Zt-1),Ve.push(nn)),(Gt===0?Se>=Ot:je>=xt)&&(Ve.push(Zt+1),Ve.push(zt),Ve.push(nn))}return It}(this.ids,this.coords,V,H,ne,se,this.nodeSize)}within(V,H,ne){return function(se,ye,Ee,xe,ge,Se){const je=[0,se.length-1,0],et=[],Ve=ge*ge;for(;je.length;){const It=je.pop(),Ot=je.pop(),xt=je.pop();if(Ot-xt<=Se){for(let nn=xt;nn<=Ot;nn++)Pt(ye[2*nn],ye[2*nn+1],Ee,xe)<=Ve&&et.push(se[nn]);continue}const Gt=Math.floor((xt+Ot)/2),zt=ye[2*Gt],pn=ye[2*Gt+1];Pt(zt,pn,Ee,xe)<=Ve&&et.push(se[Gt]);const Zt=(It+1)%2;(It===0?Ee-ge<=zt:xe-ge<=pn)&&(je.push(xt),je.push(Gt-1),je.push(Zt)),(It===0?Ee+ge>=zt:xe+ge>=pn)&&(je.push(Gt+1),je.push(Ot),je.push(Zt))}return et}(this.ids,this.coords,V,H,ne,this.nodeSize)}}const Fn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ae=>ae},St=Math.fround||(bt=new Float32Array(1),ae=>(bt[0]=+ae,bt[0]));var bt;class hn{constructor(V){this.options=Nr(Object.create(Fn),V),this.trees=new Array(this.options.maxZoom+1)}load(V){const{log:H,minZoom:ne,maxZoom:se,nodeSize:ye}=this.options;H&&console.time("total time");const Ee=`prepare ${V.length} points`;H&&console.time(Ee),this.points=V;let xe=[];for(let ge=0;ge<V.length;ge++)V[ge].geometry&&xe.push(On(V[ge],ge));this.trees[se+1]=new tn(xe,bs,Cr,ye,Float32Array),H&&console.timeEnd(Ee);for(let ge=se;ge>=ne;ge--){const Se=+Date.now();xe=this._cluster(xe,ge),this.trees[ge]=new tn(xe,bs,Cr,ye,Float32Array),H&&console.log("z%d: %d clusters in %dms",ge,xe.length,+Date.now()-Se)}return H&&console.timeEnd("total time"),this}getClusters(V,H){let ne=((V[0]+180)%360+360)%360-180;const se=Math.max(-90,Math.min(90,V[1]));let ye=V[2]===180?180:((V[2]+180)%360+360)%360-180;const Ee=Math.max(-90,Math.min(90,V[3]));if(V[2]-V[0]>=360)ne=-180,ye=180;else if(ne>ye){const je=this.getClusters([ne,se,180,Ee],H),et=this.getClusters([-180,se,ye,Ee],H);return je.concat(et)}const xe=this.trees[this._limitZoom(H)],ge=xe.range(dn(ne),mr(Ee),dn(ye),mr(se)),Se=[];for(const je of ge){const et=xe.points[je];Se.push(et.numPoints?Ln(et):this.points[et.index])}return Se}getChildren(V){const H=this._getOriginId(V),ne=this._getOriginZoom(V),se="No cluster with the specified id.",ye=this.trees[ne];if(!ye)throw new Error(se);const Ee=ye.points[H];if(!Ee)throw new Error(se);const xe=this.options.radius/(this.options.extent*Math.pow(2,ne-1)),ge=ye.within(Ee.x,Ee.y,xe),Se=[];for(const je of ge){const et=ye.points[je];et.parentId===V&&Se.push(et.numPoints?Ln(et):this.points[et.index])}if(Se.length===0)throw new Error(se);return Se}getLeaves(V,H,ne){const se=[];return this._appendLeaves(se,V,H=H||10,ne=ne||0,0),se}getTile(V,H,ne){const se=this.trees[this._limitZoom(V)],ye=Math.pow(2,V),{extent:Ee,radius:xe}=this.options,ge=xe/Ee,Se=(ne-ge)/ye,je=(ne+1+ge)/ye,et={features:[]};return this._addTileFeatures(se.range((H-ge)/ye,Se,(H+1+ge)/ye,je),se.points,H,ne,ye,et),H===0&&this._addTileFeatures(se.range(1-ge/ye,Se,1,je),se.points,ye,ne,ye,et),H===ye-1&&this._addTileFeatures(se.range(0,Se,ge/ye,je),se.points,-1,ne,ye,et),et.features.length?et:null}getClusterExpansionZoom(V){let H=this._getOriginZoom(V)-1;for(;H<=this.options.maxZoom;){const ne=this.getChildren(V);if(H++,ne.length!==1)break;V=ne[0].properties.cluster_id}return H}_appendLeaves(V,H,ne,se,ye){const Ee=this.getChildren(H);for(const xe of Ee){const ge=xe.properties;if(ge&&ge.cluster?ye+ge.point_count<=se?ye+=ge.point_count:ye=this._appendLeaves(V,ge.cluster_id,ne,se,ye):ye<se?ye++:V.push(xe),V.length===ne)break}return ye}_addTileFeatures(V,H,ne,se,ye,Ee){for(const xe of V){const ge=H[xe],Se=ge.numPoints;let je,et,Ve;if(Se)je=is(ge),et=ge.x,Ve=ge.y;else{const xt=this.points[ge.index];je=xt.properties,et=dn(xt.geometry.coordinates[0]),Ve=mr(xt.geometry.coordinates[1])}const It={type:1,geometry:[[Math.round(this.options.extent*(et*ye-ne)),Math.round(this.options.extent*(Ve*ye-se))]],tags:je};let Ot;Se?Ot=ge.id:this.options.generateId?Ot=ge.index:this.points[ge.index].id&&(Ot=this.points[ge.index].id),Ot!==void 0&&(It.id=Ot),Ee.features.push(It)}}_limitZoom(V){return Math.max(this.options.minZoom,Math.min(Math.floor(+V),this.options.maxZoom+1))}_cluster(V,H){const ne=[],{radius:se,extent:ye,reduce:Ee,minPoints:xe}=this.options,ge=se/(ye*Math.pow(2,H));for(let Se=0;Se<V.length;Se++){const je=V[Se];if(je.zoom<=H)continue;je.zoom=H;const et=this.trees[H+1],Ve=et.within(je.x,je.y,ge),It=je.numPoints||1;let Ot=It;for(const xt of Ve){const Gt=et.points[xt];Gt.zoom>H&&(Ot+=Gt.numPoints||1)}if(Ot>It&&Ot>=xe){let xt=je.x*It,Gt=je.y*It,zt=Ee&&It>1?this._map(je,!0):null;const pn=(Se<<5)+(H+1)+this.points.length;for(const Zt of Ve){const nn=et.points[Zt];if(nn.zoom<=H)continue;nn.zoom=H;const _n=nn.numPoints||1;xt+=nn.x*_n,Gt+=nn.y*_n,nn.parentId=pn,Ee&&(zt||(zt=this._map(je,!0)),Ee(zt,this._map(nn)))}je.parentId=pn,ne.push(ur(xt/Ot,Gt/Ot,pn,Ot,zt))}else if(ne.push(je),Ot>1)for(const xt of Ve){const Gt=et.points[xt];Gt.zoom<=H||(Gt.zoom=H,ne.push(Gt))}}return ne}_getOriginId(V){return V-this.points.length>>5}_getOriginZoom(V){return(V-this.points.length)%32}_map(V,H){if(V.numPoints)return H?Nr({},V.properties):V.properties;const ne=this.points[V.index].properties,se=this.options.map(ne);return H&&se===ne?Nr({},se):se}}function ur(ae,V,H,ne,se){return{x:St(ae),y:St(V),zoom:1/0,id:H,parentId:-1,numPoints:ne,properties:se}}function On(ae,V){const[H,ne]=ae.geometry.coordinates;return{x:St(dn(H)),y:St(mr(ne)),zoom:1/0,index:V,parentId:-1}}function Ln(ae){return{type:"Feature",id:ae.id,properties:is(ae),geometry:{type:"Point",coordinates:[(V=ae.x,360*(V-.5)),vn(ae.y)]}};var V}function is(ae){const V=ae.numPoints,H=V>=1e4?`${Math.round(V/1e3)}k`:V>=1e3?Math.round(V/100)/10+"k":V;return Nr(Nr({},ae.properties),{cluster:!0,cluster_id:ae.id,point_count:V,point_count_abbreviated:H})}function dn(ae){return ae/360+.5}function mr(ae){const V=Math.sin(ae*Math.PI/180),H=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return H<0?0:H>1?1:H}function vn(ae){const V=(180-360*ae)*Math.PI/180;return 360*Math.atan(Math.exp(V))/Math.PI-90}function Nr(ae,V){for(const H in V)ae[H]=V[H];return ae}function bs(ae){return ae.x}function Cr(ae){return ae.y}function ai(ae,V,H,ne){for(var se,ye=ne,Ee=H-V>>1,xe=H-V,ge=ae[V],Se=ae[V+1],je=ae[H],et=ae[H+1],Ve=V+3;Ve<H;Ve+=3){var It=ko(ae[Ve],ae[Ve+1],ge,Se,je,et);if(It>ye)se=Ve,ye=It;else if(It===ye){var Ot=Math.abs(Ve-Ee);Ot<xe&&(se=Ve,xe=Ot)}}ye>ne&&(se-V>3&&ai(ae,V,se,ne),ae[se+2]=ye,H-se>3&&ai(ae,se,H,ne))}function ko(ae,V,H,ne,se,ye){var Ee=se-H,xe=ye-ne;if(Ee!==0||xe!==0){var ge=((ae-H)*Ee+(V-ne)*xe)/(Ee*Ee+xe*xe);ge>1?(H=se,ne=ye):ge>0&&(H+=Ee*ge,ne+=xe*ge)}return(Ee=ae-H)*Ee+(xe=V-ne)*xe}function ss(ae,V,H,ne){var se={id:ae===void 0?null:ae,type:V,geometry:H,tags:ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ye){var Ee=ye.geometry,xe=ye.type;if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")We(ye,Ee);else if(xe==="Polygon"||xe==="MultiLineString")for(var ge=0;ge<Ee.length;ge++)We(ye,Ee[ge]);else if(xe==="MultiPolygon")for(ge=0;ge<Ee.length;ge++)for(var Se=0;Se<Ee[ge].length;Se++)We(ye,Ee[ge][Se])}(se),se}function We(ae,V){for(var H=0;H<V.length;H+=3)ae.minX=Math.min(ae.minX,V[H]),ae.minY=Math.min(ae.minY,V[H+1]),ae.maxX=Math.max(ae.maxX,V[H]),ae.maxY=Math.max(ae.maxY,V[H+1])}function pt(ae,V,H,ne){if(V.geometry){var se=V.geometry.coordinates,ye=V.geometry.type,Ee=Math.pow(H.tolerance/((1<<H.maxZoom)*H.extent),2),xe=[],ge=V.id;if(H.promoteId?ge=V.properties[H.promoteId]:H.generateId&&(ge=ne||0),ye==="Point")Vs(se,xe);else if(ye==="MultiPoint")for(var Se=0;Se<se.length;Se++)Vs(se[Se],xe);else if(ye==="LineString")yi(se,xe,Ee,!1);else if(ye==="MultiLineString"){if(H.lineMetrics){for(Se=0;Se<se.length;Se++)yi(se[Se],xe=[],Ee,!1),ae.push(ss(ge,"LineString",xe,V.properties));return}fn(se,xe,Ee,!1)}else if(ye==="Polygon")fn(se,xe,Ee,!0);else{if(ye!=="MultiPolygon"){if(ye==="GeometryCollection"){for(Se=0;Se<V.geometry.geometries.length;Se++)pt(ae,{id:ge,geometry:V.geometry.geometries[Se],properties:V.properties},H,ne);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Se=0;Se<se.length;Se++){var je=[];fn(se[Se],je,Ee,!0),xe.push(je)}}ae.push(ss(ge,ye,xe,V.properties))}}function Vs(ae,V){V.push(Di(ae[0])),V.push(Ai(ae[1])),V.push(0)}function yi(ae,V,H,ne){for(var se,ye,Ee=0,xe=0;xe<ae.length;xe++){var ge=Di(ae[xe][0]),Se=Ai(ae[xe][1]);V.push(ge),V.push(Se),V.push(0),xe>0&&(Ee+=ne?(se*Se-ge*ye)/2:Math.sqrt(Math.pow(ge-se,2)+Math.pow(Se-ye,2))),se=ge,ye=Se}var je=V.length-3;V[2]=1,ai(V,0,je,H),V[je+2]=1,V.size=Math.abs(Ee),V.start=0,V.end=V.size}function fn(ae,V,H,ne){for(var se=0;se<ae.length;se++){var ye=[];yi(ae[se],ye,H,ne),V.push(ye)}}function Di(ae){return ae/360+.5}function Ai(ae){var V=Math.sin(ae*Math.PI/180),H=.5-.25*Math.log((1+V)/(1-V))/Math.PI;return H<0?0:H>1?1:H}function De(ae,V,H,ne,se,ye,Ee,xe){if(ne/=V,ye>=(H/=V)&&Ee<ne)return ae;if(Ee<H||ye>=ne)return null;for(var ge=[],Se=0;Se<ae.length;Se++){var je=ae[Se],et=je.geometry,Ve=je.type,It=se===0?je.minX:je.minY,Ot=se===0?je.maxX:je.maxY;if(It>=H&&Ot<ne)ge.push(je);else if(!(Ot<H||It>=ne)){var xt=[];if(Ve==="Point"||Ve==="MultiPoint")Ie(et,xt,H,ne,se);else if(Ve==="LineString")Me(et,xt,H,ne,se,!1,xe.lineMetrics);else if(Ve==="MultiLineString")Ye(et,xt,H,ne,se,!1);else if(Ve==="Polygon")Ye(et,xt,H,ne,se,!0);else if(Ve==="MultiPolygon")for(var Gt=0;Gt<et.length;Gt++){var zt=[];Ye(et[Gt],zt,H,ne,se,!0),zt.length&&xt.push(zt)}if(xt.length){if(xe.lineMetrics&&Ve==="LineString"){for(Gt=0;Gt<xt.length;Gt++)ge.push(ss(je.id,Ve,xt[Gt],je.tags));continue}Ve!=="LineString"&&Ve!=="MultiLineString"||(xt.length===1?(Ve="LineString",xt=xt[0]):Ve="MultiLineString"),Ve!=="Point"&&Ve!=="MultiPoint"||(Ve=xt.length===3?"Point":"MultiPoint"),ge.push(ss(je.id,Ve,xt,je.tags))}}}return ge.length?ge:null}function Ie(ae,V,H,ne,se){for(var ye=0;ye<ae.length;ye+=3){var Ee=ae[ye+se];Ee>=H&&Ee<=ne&&(V.push(ae[ye]),V.push(ae[ye+1]),V.push(ae[ye+2]))}}function Me(ae,V,H,ne,se,ye,Ee){for(var xe,ge,Se=Qe(ae),je=se===0?Kt:st,et=ae.start,Ve=0;Ve<ae.length-3;Ve+=3){var It=ae[Ve],Ot=ae[Ve+1],xt=ae[Ve+2],Gt=ae[Ve+3],zt=ae[Ve+4],pn=se===0?It:Ot,Zt=se===0?Gt:zt,nn=!1;Ee&&(xe=Math.sqrt(Math.pow(It-Gt,2)+Math.pow(Ot-zt,2))),pn<H?Zt>H&&(ge=je(Se,It,Ot,Gt,zt,H),Ee&&(Se.start=et+xe*ge)):pn>ne?Zt<ne&&(ge=je(Se,It,Ot,Gt,zt,ne),Ee&&(Se.start=et+xe*ge)):vt(Se,It,Ot,xt),Zt<H&&pn>=H&&(ge=je(Se,It,Ot,Gt,zt,H),nn=!0),Zt>ne&&pn<=ne&&(ge=je(Se,It,Ot,Gt,zt,ne),nn=!0),!ye&&nn&&(Ee&&(Se.end=et+xe*ge),V.push(Se),Se=Qe(ae)),Ee&&(et+=xe)}var _n=ae.length-3;It=ae[_n],Ot=ae[_n+1],xt=ae[_n+2],(pn=se===0?It:Ot)>=H&&pn<=ne&&vt(Se,It,Ot,xt),_n=Se.length-3,ye&&_n>=3&&(Se[_n]!==Se[0]||Se[_n+1]!==Se[1])&&vt(Se,Se[0],Se[1],Se[2]),Se.length&&V.push(Se)}function Qe(ae){var V=[];return V.size=ae.size,V.start=ae.start,V.end=ae.end,V}function Ye(ae,V,H,ne,se,ye){for(var Ee=0;Ee<ae.length;Ee++)Me(ae[Ee],V,H,ne,se,ye,!1)}function vt(ae,V,H,ne){ae.push(V),ae.push(H),ae.push(ne)}function Kt(ae,V,H,ne,se,ye){var Ee=(ye-V)/(ne-V);return ae.push(ye),ae.push(H+(se-H)*Ee),ae.push(1),Ee}function st(ae,V,H,ne,se,ye){var Ee=(ye-H)/(se-H);return ae.push(V+(ne-V)*Ee),ae.push(ye),ae.push(1),Ee}function jt(ae,V){for(var H=[],ne=0;ne<ae.length;ne++){var se,ye=ae[ne],Ee=ye.type;if(Ee==="Point"||Ee==="MultiPoint"||Ee==="LineString")se=Xt(ye.geometry,V);else if(Ee==="MultiLineString"||Ee==="Polygon"){se=[];for(var xe=0;xe<ye.geometry.length;xe++)se.push(Xt(ye.geometry[xe],V))}else if(Ee==="MultiPolygon")for(se=[],xe=0;xe<ye.geometry.length;xe++){for(var ge=[],Se=0;Se<ye.geometry[xe].length;Se++)ge.push(Xt(ye.geometry[xe][Se],V));se.push(ge)}H.push(ss(ye.id,Ee,se,ye.tags))}return H}function Xt(ae,V){var H=[];H.size=ae.size,ae.start!==void 0&&(H.start=ae.start,H.end=ae.end);for(var ne=0;ne<ae.length;ne+=3)H.push(ae[ne]+V,ae[ne+1],ae[ne+2]);return H}function Gn(ae,V){if(ae.transformed)return ae;var H,ne,se,ye=1<<ae.z,Ee=ae.x,xe=ae.y;for(H=0;H<ae.features.length;H++){var ge=ae.features[H],Se=ge.geometry,je=ge.type;if(ge.geometry=[],je===1)for(ne=0;ne<Se.length;ne+=2)ge.geometry.push(Mn(Se[ne],Se[ne+1],V,ye,Ee,xe));else for(ne=0;ne<Se.length;ne++){var et=[];for(se=0;se<Se[ne].length;se+=2)et.push(Mn(Se[ne][se],Se[ne][se+1],V,ye,Ee,xe));ge.geometry.push(et)}}return ae.transformed=!0,ae}function Mn(ae,V,H,ne,se,ye){return[Math.round(H*(ae*ne-se)),Math.round(H*(V*ne-ye))]}function $n(ae,V,H,ne,se){for(var ye=V===se.maxZoom?0:se.tolerance/((1<<V)*se.extent),Ee={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:H,y:ne,z:V,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},xe=0;xe<ae.length;xe++){Ee.numFeatures++,un(Ee,ae[xe],ye,se);var ge=ae[xe].minX,Se=ae[xe].minY,je=ae[xe].maxX,et=ae[xe].maxY;ge<Ee.minX&&(Ee.minX=ge),Se<Ee.minY&&(Ee.minY=Se),je>Ee.maxX&&(Ee.maxX=je),et>Ee.maxY&&(Ee.maxY=et)}return Ee}function un(ae,V,H,ne){var se=V.geometry,ye=V.type,Ee=[];if(ye==="Point"||ye==="MultiPoint")for(var xe=0;xe<se.length;xe+=3)Ee.push(se[xe]),Ee.push(se[xe+1]),ae.numPoints++,ae.numSimplified++;else if(ye==="LineString")Qr(Ee,se,ae,H,!1,!1);else if(ye==="MultiLineString"||ye==="Polygon")for(xe=0;xe<se.length;xe++)Qr(Ee,se[xe],ae,H,ye==="Polygon",xe===0);else if(ye==="MultiPolygon")for(var ge=0;ge<se.length;ge++){var Se=se[ge];for(xe=0;xe<Se.length;xe++)Qr(Ee,Se[xe],ae,H,!0,xe===0)}if(Ee.length){var je=V.tags||null;if(ye==="LineString"&&ne.lineMetrics){for(var et in je={},V.tags)je[et]=V.tags[et];je.mapbox_clip_start=se.start/se.size,je.mapbox_clip_end=se.end/se.size}var Ve={geometry:Ee,type:ye==="Polygon"||ye==="MultiPolygon"?3:ye==="LineString"||ye==="MultiLineString"?2:1,tags:je};V.id!==null&&(Ve.id=V.id),ae.features.push(Ve)}}function Qr(ae,V,H,ne,se,ye){var Ee=ne*ne;if(ne>0&&V.size<(se?Ee:ne))H.numPoints+=V.length/3;else{for(var xe=[],ge=0;ge<V.length;ge+=3)(ne===0||V[ge+2]>Ee)&&(H.numSimplified++,xe.push(V[ge]),xe.push(V[ge+1])),H.numPoints++;se&&function(Se,je){for(var et=0,Ve=0,It=Se.length,Ot=It-2;Ve<It;Ot=Ve,Ve+=2)et+=(Se[Ve]-Se[Ot])*(Se[Ve+1]+Se[Ot+1]);if(et>0===je)for(Ve=0,It=Se.length;Ve<It/2;Ve+=2){var xt=Se[Ve],Gt=Se[Ve+1];Se[Ve]=Se[It-2-Ve],Se[Ve+1]=Se[It-1-Ve],Se[It-2-Ve]=xt,Se[It-1-Ve]=Gt}}(xe,ye),ae.push(xe)}}function li(ae,V){var H=(V=this.options=function(se,ye){for(var Ee in ye)se[Ee]=ye[Ee];return se}(Object.create(this.options),V)).debug;if(H&&console.time("preprocess data"),V.maxZoom<0||V.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(V.promoteId&&V.generateId)throw new Error("promoteId and generateId cannot be used together.");var ne=function(se,ye){var Ee=[];if(se.type==="FeatureCollection")for(var xe=0;xe<se.features.length;xe++)pt(Ee,se.features[xe],ye,xe);else pt(Ee,se.type==="Feature"?se:{geometry:se},ye);return Ee}(ae,V);this.tiles={},this.tileCoords=[],H&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",V.indexMaxZoom,V.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ne=function(se,ye){var Ee=ye.buffer/ye.extent,xe=se,ge=De(se,1,-1-Ee,Ee,0,-1,2,ye),Se=De(se,1,1-Ee,2+Ee,0,-1,2,ye);return(ge||Se)&&(xe=De(se,1,-Ee,1+Ee,0,-1,2,ye)||[],ge&&(xe=jt(ge,1).concat(xe)),Se&&(xe=xe.concat(jt(Se,-1)))),xe}(ne,V),ne.length&&this.splitTile(ne,0,0,0),H&&(ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Pi(ae,V,H){return 32*((1<<ae)*H+V)+ae}function Ki(ae,V){const H=ae.tileID.canonical;if(!this._geoJSONIndex)return V(null,null);const ne=this._geoJSONIndex.getTile(H.z,H.x,H.y);if(!ne)return V(null,null);const se=new ie(ne.features);let ye=re.exports(se);ye.byteOffset===0&&ye.byteLength===ye.buffer.byteLength||(ye=new Uint8Array(ye)),V(null,{vectorTile:se,rawData:ye.buffer})}li.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},li.prototype.splitTile=function(ae,V,H,ne,se,ye,Ee){for(var xe=[ae,V,H,ne],ge=this.options,Se=ge.debug;xe.length;){ne=xe.pop(),H=xe.pop(),V=xe.pop(),ae=xe.pop();var je=1<<V,et=Pi(V,H,ne),Ve=this.tiles[et];if(!Ve&&(Se>1&&console.time("creation"),Ve=this.tiles[et]=$n(ae,V,H,ne,ge),this.tileCoords.push({z:V,x:H,y:ne}),Se)){Se>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",V,H,ne,Ve.numFeatures,Ve.numPoints,Ve.numSimplified),console.timeEnd("creation"));var It="z"+V;this.stats[It]=(this.stats[It]||0)+1,this.total++}if(Ve.source=ae,se){if(V===ge.maxZoom||V===se)continue;var Ot=1<<se-V;if(H!==Math.floor(ye/Ot)||ne!==Math.floor(Ee/Ot))continue}else if(V===ge.indexMaxZoom||Ve.numPoints<=ge.indexMaxPoints)continue;if(Ve.source=null,ae.length!==0){Se>1&&console.time("clipping");var xt,Gt,zt,pn,Zt,nn,_n=.5*ge.buffer/ge.extent,En=.5-_n,ir=.5+_n,sr=1+_n;xt=Gt=zt=pn=null,Zt=De(ae,je,H-_n,H+ir,0,Ve.minX,Ve.maxX,ge),nn=De(ae,je,H+En,H+sr,0,Ve.minX,Ve.maxX,ge),ae=null,Zt&&(xt=De(Zt,je,ne-_n,ne+ir,1,Ve.minY,Ve.maxY,ge),Gt=De(Zt,je,ne+En,ne+sr,1,Ve.minY,Ve.maxY,ge),Zt=null),nn&&(zt=De(nn,je,ne-_n,ne+ir,1,Ve.minY,Ve.maxY,ge),pn=De(nn,je,ne+En,ne+sr,1,Ve.minY,Ve.maxY,ge),nn=null),Se>1&&console.timeEnd("clipping"),xe.push(xt||[],V+1,2*H,2*ne),xe.push(Gt||[],V+1,2*H,2*ne+1),xe.push(zt||[],V+1,2*H+1,2*ne),xe.push(pn||[],V+1,2*H+1,2*ne+1)}}},li.prototype.getTile=function(ae,V,H){var ne=this.options,se=ne.extent,ye=ne.debug;if(ae<0||ae>24)return null;var Ee=1<<ae,xe=Pi(ae,V=(V%Ee+Ee)%Ee,H);if(this.tiles[xe])return Gn(this.tiles[xe],se);ye>1&&console.log("drilling down to z%d-%d-%d",ae,V,H);for(var ge,Se=ae,je=V,et=H;!ge&&Se>0;)Se--,je=Math.floor(je/2),et=Math.floor(et/2),ge=this.tiles[Pi(Se,je,et)];return ge&&ge.source?(ye>1&&console.log("found parent tile z%d-%d-%d",Se,je,et),ye>1&&console.time("drilling down"),this.splitTile(ge.source,Se,je,et,ae,V,H),ye>1&&console.timeEnd("drilling down"),this.tiles[xe]?Gn(this.tiles[xe],se):null):null};class os extends M{constructor(V,H,ne,se){super(V,H,ne,Ki),se&&(this.loadGeoJSON=se)}loadData(V,H){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const se=!!(V&&V.request&&V.request.collectResourceTiming)&&new o.RequestPerformance(V.request);this._pendingCallback=H,this._pendingRequest=this.loadGeoJSON(V,(ye,Ee)=>{if(delete this._pendingCallback,delete this._pendingRequest,ye||!Ee)return H(ye);if(typeof Ee!="object")return H(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`));{D(Ee,!0);try{if(V.filter){const ge=o.createExpression(V.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ge.result==="error")throw new Error(ge.value.map(je=>`${je.key}: ${je.message}`).join(", "));Ee={type:"FeatureCollection",features:Ee.features.filter(je=>ge.value.evaluate({zoom:0},je))}}this._geoJSONIndex=V.cluster?new hn(function({superclusterOptions:ge,clusterProperties:Se}){if(!Se||!ge)return ge;const je={},et={},Ve={accumulated:null,zoom:0},It={properties:null},Ot=Object.keys(Se);for(const xt of Ot){const[Gt,zt]=Se[xt],pn=o.createExpression(zt),Zt=o.createExpression(typeof Gt=="string"?[Gt,["accumulated"],["get",xt]]:Gt);je[xt]=pn.value,et[xt]=Zt.value}return ge.map=xt=>{It.properties=xt;const Gt={};for(const zt of Ot)Gt[zt]=je[zt].evaluate(Ve,It);return Gt},ge.reduce=(xt,Gt)=>{It.properties=Gt;for(const zt of Ot)Ve.accumulated=xt[zt],xt[zt]=et[zt].evaluate(Ve,It)},ge}(V)).load(Ee.features):function(ge,Se){return new li(ge,Se)}(Ee,V.geojsonVtOptions)}catch(ge){return H(ge)}this.loaded={};const xe={};if(se){const ge=se.finish();ge&&(xe.resourceTiming={},xe.resourceTiming[V.source]=JSON.parse(JSON.stringify(ge)))}H(null,xe)}})}reloadTile(V,H){const ne=this.loaded;return ne&&ne[V.uid]?super.reloadTile(V,H):this.loadTile(V,H)}loadGeoJSON(V,H){if(V.request)return o.getJSON(V.request,H);if(typeof V.data=="string")try{H(null,JSON.parse(V.data))}catch{H(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`))}else H(new Error(`Input data given to '${V.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}}removeSource(V,H){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),H()}getClusterExpansionZoom(V,H){try{H(null,this._geoJSONIndex.getClusterExpansionZoom(V.clusterId))}catch(ne){H(ne)}}getClusterChildren(V,H){try{H(null,this._geoJSONIndex.getChildren(V.clusterId))}catch(ne){H(ne)}}getClusterLeaves(V,H){try{H(null,this._geoJSONIndex.getLeaves(V.clusterId,V.limit,V.offset))}catch(ne){H(ne)}}}class Oo{constructor(V){this.self=V,this.actor=new o.Actor(V,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:M,geojson:os},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(H,ne)=>{if(this.workerSourceTypes[H])throw new Error(`Worker source with name "${H}" already registered.`);this.workerSourceTypes[H]=ne},this.self.registerRTLTextPlugin=H=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=H.applyArabicShaping,o.plugin.processBidirectionalText=H.processBidirectionalText,o.plugin.processStyledBidirectionalText=H.processStyledBidirectionalText}}setReferrer(V,H){this.referrer=H}setImages(V,H,ne){this.availableImages[V]=H;for(const se in this.workerSources[V]){const ye=this.workerSources[V][se];for(const Ee in ye)ye[Ee].availableImages=H}ne()}setLayers(V,H,ne){this.getLayerIndex(V).replace(H),ne()}updateLayers(V,H,ne){this.getLayerIndex(V).update(H.layers,H.removedIds),ne()}loadTile(V,H,ne){this.getWorkerSource(V,H.type,H.source).loadTile(H,ne)}loadDEMTile(V,H,ne){this.getDEMWorkerSource(V,H.source).loadTile(H,ne)}reloadTile(V,H,ne){this.getWorkerSource(V,H.type,H.source).reloadTile(H,ne)}abortTile(V,H,ne){this.getWorkerSource(V,H.type,H.source).abortTile(H,ne)}removeTile(V,H,ne){this.getWorkerSource(V,H.type,H.source).removeTile(H,ne)}removeDEMTile(V,H){this.getDEMWorkerSource(V,H.source).removeTile(H)}removeSource(V,H,ne){if(!this.workerSources[V]||!this.workerSources[V][H.type]||!this.workerSources[V][H.type][H.source])return;const se=this.workerSources[V][H.type][H.source];delete this.workerSources[V][H.type][H.source],se.removeSource!==void 0?se.removeSource(H,ne):ne()}loadWorkerSource(V,H,ne){try{this.self.importScripts(H.url),ne()}catch(se){ne(se.toString())}}syncRTLPluginState(V,H,ne){try{o.plugin.setState(H);const se=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&se!=null){this.self.importScripts(se);const ye=o.plugin.isParsed();ne(ye?void 0:new Error(`RTL Text Plugin failed to import scripts from ${se}`),ye)}}catch(se){ne(se.toString())}}getAvailableImages(V){let H=this.availableImages[V];return H||(H=[]),H}getLayerIndex(V){let H=this.layerIndexes[V];return H||(H=this.layerIndexes[V]=new b),H}getWorkerSource(V,H,ne){if(this.workerSources[V]||(this.workerSources[V]={}),this.workerSources[V][H]||(this.workerSources[V][H]={}),!this.workerSources[V][H][ne]){const se={send:(ye,Ee,xe)=>{this.actor.send(ye,Ee,xe,V)}};this.workerSources[V][H][ne]=new this.workerSourceTypes[H](se,this.getLayerIndex(V),this.getAvailableImages(V))}return this.workerSources[V][H][ne]}getDEMWorkerSource(V,H){return this.demWorkerSources[V]||(this.demWorkerSources[V]={}),this.demWorkerSources[V][H]||(this.demWorkerSources[V][H]=new U),this.demWorkerSources[V][H]}enforceCacheSizeLimit(V,H){o.enforceCacheSizeLimit(H)}}return o.isWorker()&&(self.worker=new Oo(self)),Oo}),s(["./shared"],function(o){var h=p;function p(y){return!function(c){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,_,E=new Blob([""],{type:"text/javascript"}),P=URL.createObjectURL(E);try{_=new Worker(P),g=!0}catch{g=!1}return _&&_.terminate(),URL.revokeObjectURL(P),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var _=g.getContext("2d");if(!_)return!1;var E=_.getImageData(0,0,1,1);return E&&E.width===g.width}()?(b[f=c&&c.failIfMajorPerformanceCaveat]===void 0&&(b[f]=function(g){var _,E=function(P){var R=document.createElement("canvas"),k=Object.create(p.webGLContextAttributes);return k.failIfMajorPerformanceCaveat=P,R.getContext("webgl",k)||R.getContext("experimental-webgl",k)}(g);if(!E)return!1;try{_=E.createShader(E.VERTEX_SHADER)}catch{return!1}return!(!_||E.isContextLost())&&(E.shaderSource(_,"void main() {}"),E.compileShader(_),E.getShaderParameter(_,E.COMPILE_STATUS)===!0)}(f)),b[f]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var f}(y)}var b={};function x(y,c){if(Array.isArray(y)){if(!Array.isArray(c)||y.length!==c.length)return!1;for(let f=0;f<y.length;f++)if(!x(y[f],c[f]))return!1;return!0}if(typeof y=="object"&&y!==null&&c!==null){if(typeof c!="object"||Object.keys(y).length!==Object.keys(c).length)return!1;for(const f in y)if(!x(y[f],c[f]))return!1;return!0}return y===c}p.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};class w{static testProp(c){if(!w.docStyle)return c[0];for(let f=0;f<c.length;f++)if(c[f]in w.docStyle)return c[f];return c[0]}static create(c,f,g){const _=window.document.createElement(c);return f!==void 0&&(_.className=f),g&&g.appendChild(_),_}static createNS(c,f){return window.document.createElementNS(c,f)}static disableDrag(){w.docStyle&&w.selectProp&&(w.userSelect=w.docStyle[w.selectProp],w.docStyle[w.selectProp]="none")}static enableDrag(){w.docStyle&&w.selectProp&&(w.docStyle[w.selectProp]=w.userSelect)}static setTransform(c,f){c.style[w.transformProp]=f}static addEventListener(c,f,g,_={}){c.addEventListener(f,g,"passive"in _?_:_.capture)}static removeEventListener(c,f,g,_={}){c.removeEventListener(f,g,"passive"in _?_:_.capture)}static suppressClickInternal(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",w.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",w.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",w.suppressClickInternal,!0)},0)}static mousePos(c,f){const g=c.getBoundingClientRect();return new o.pointGeometry(f.clientX-g.left-c.clientLeft,f.clientY-g.top-c.clientTop)}static touchPos(c,f){const g=c.getBoundingClientRect(),_=[];for(let E=0;E<f.length;E++)_.push(new o.pointGeometry(f[E].clientX-g.left-c.clientLeft,f[E].clientY-g.top-c.clientTop));return _}static mouseButton(c){return c.button}static remove(c){c.parentNode&&c.parentNode.removeChild(c)}}w.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,w.selectProp=w.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),w.transformProp=w.testProp(["transform","WebkitTransform"]);class A{constructor(c){this._transformRequestFn=c}transformRequest(c,f){return this._transformRequestFn&&this._transformRequestFn(c,f)||{url:c}}normalizeSpriteURL(c,f,g){const _=function(E){const P=E.match(L);if(!P)throw new Error(`Unable to parse URL "${E}"`);return{protocol:P[1],authority:P[2],path:P[3]||"/",params:P[4]?P[4].split("&"):[]}}(c);return _.path+=`${f}${g}`,function(E){const P=E.params.length?`?${E.params.join("&")}`:"";return`${E.protocol}://${E.authority}${E.path}${P}`}(_)}setTransformRequest(c){this._transformRequestFn=c}}const L=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;class M{constructor(c,f,g,_){this.context=c,this.format=g,this.texture=c.gl.createTexture(),this.update(f,_)}update(c,f,g){const{width:_,height:E}=c,P=!(this.size&&this.size[0]===_&&this.size[1]===E||g),{context:R}=this,{gl:k}=R;if(this.useMipmap=!!(f&&f.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),R.pixelStoreUnpackFlipY.set(!1),R.pixelStoreUnpack.set(1),R.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!f||f.premultiply!==!1)),P)this.size=[_,E],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.isImageBitmap(c)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,c):k.texImage2D(k.TEXTURE_2D,0,this.format,_,E,0,this.format,k.UNSIGNED_BYTE,c.data);else{const{x:z,y:G}=g||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||o.isImageBitmap(c)?k.texSubImage2D(k.TEXTURE_2D,0,z,G,k.RGBA,k.UNSIGNED_BYTE,c):k.texSubImage2D(k.TEXTURE_2D,0,z,G,_,E,k.RGBA,k.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(c,f,g){const{context:_}=this,{gl:E}=_;E.bindTexture(E.TEXTURE_2D,this.texture),g!==E.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(g=E.LINEAR),c!==this.filter&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,c),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,g||c),this.filter=c),f!==this.wrap&&(E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,f),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,f),this.wrap=f)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}function U(y){const{userImage:c}=y;return!!(c&&c.render&&c.render())&&(y.data.replace(new Uint8Array(c.data.buffer)),!0)}class D extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:f,callback:g}of this.requestors)this._notify(f,g);this.requestors=[]}}getImage(c){return this.images[c]}addImage(c,f){if(this.images[c])throw new Error(`Image id ${c} already exist, use updateImage instead`);this._validate(c,f)&&(this.images[c]=f)}_validate(c,f){let g=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),g=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),g=!1),this._validateContent(f.content,f)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),g=!1),g}_validateStretch(c,f){if(!c)return!0;let g=0;for(const _ of c){if(_[0]<g||_[1]<_[0]||f<_[1])return!1;g=_[1]}return!0}_validateContent(c,f){return!(c&&(c.length!==4||c[0]<0||f.data.width<c[0]||c[1]<0||f.data.height<c[1]||c[2]<0||f.data.width<c[2]||c[3]<0||f.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,f){const g=this.images[c];if(g.data.width!==f.data.width||g.data.height!==f.data.height)throw new Error(`size mismatch between old image (${g.data.width}x${g.data.height}) and new image (${f.data.width}x${f.data.height}).`);f.version=g.version+1,this.images[c]=f,this.updatedImages[c]=!0}removeImage(c){const f=this.images[c];delete this.images[c],delete this.patterns[c],f.userImage&&f.userImage.onRemove&&f.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,f){let g=!0;if(!this.isLoaded())for(const _ of c)this.images[_]||(g=!1);this.isLoaded()||g?this._notify(c,f):this.requestors.push({ids:c,callback:f})}_notify(c,f){const g={};for(const _ of c){this.images[_]||this.fire(new o.Event("styleimagemissing",{id:_}));const E=this.images[_];E?g[_]={data:E.data.clone(),pixelRatio:E.pixelRatio,sdf:E.sdf,version:E.version,stretchX:E.stretchX,stretchY:E.stretchY,content:E.content,hasRenderCallback:!!(E.userImage&&E.userImage.render)}:o.warnOnce(`Image "${_}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}f(null,g)}getPixelSize(){const{width:c,height:f}=this.atlasImage;return{width:c,height:f}}getPattern(c){const f=this.patterns[c],g=this.getImage(c);if(!g)return null;if(f&&f.position.version===g.version)return f.position;if(f)f.position.version=g.version;else{const _={w:g.data.width+2,h:g.data.height+2,x:0,y:0},E=new o.ImagePosition(_,g);this.patterns[c]={bin:_,position:E}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const f=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new M(c,this.atlasImage,f.RGBA),this.atlasTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const E in this.patterns)c.push(this.patterns[E].bin);const{w:f,h:g}=o.potpack(c),_=this.atlasImage;_.resize({width:f||1,height:g||1});for(const E in this.patterns){const{bin:P}=this.patterns[E],R=P.x+1,k=P.y+1,z=this.images[E].data,G=z.width,q=z.height;o.RGBAImage.copy(z,_,{x:0,y:0},{x:R,y:k},{width:G,height:q}),o.RGBAImage.copy(z,_,{x:0,y:q-1},{x:R,y:k-1},{width:G,height:1}),o.RGBAImage.copy(z,_,{x:0,y:0},{x:R,y:k+q},{width:G,height:1}),o.RGBAImage.copy(z,_,{x:G-1,y:0},{x:R-1,y:k},{width:1,height:q}),o.RGBAImage.copy(z,_,{x:0,y:0},{x:R+G,y:k},{width:1,height:q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const f of c){if(this.callbackDispatchedThisFrame[f])continue;this.callbackDispatchedThisFrame[f]=!0;const g=this.images[f];g||o.warnOnce(`Image with ID: "${f}" was not found`),U(g)&&this.updateImage(f,g)}}}const $=1e20;function N(y,c,f,g,_,E,P,R,k){for(let z=c;z<c+g;z++)B(y,f*E+z,E,_,P,R,k);for(let z=f;z<f+_;z++)B(y,z*E+c,1,g,P,R,k)}function B(y,c,f,g,_,E,P){E[0]=0,P[0]=-$,P[1]=$,_[0]=y[c];for(let R=1,k=0,z=0;R<g;R++){_[R]=y[c+R*f];const G=R*R;do{const q=E[k];z=(_[R]-_[q]+G-q*q)/(R-q)/2}while(z<=P[k]&&--k>-1);k++,E[k]=R,P[k]=z,P[k+1]=$}for(let R=0,k=0;R<g;R++){for(;P[k+1]<R;)k++;const z=E[k],G=R-z;y[c+R*f]=_[z]+G*G}}class Z{constructor(c,f){this.requestManager=c,this.localIdeographFontFamily=f,this.entries={}}setURL(c){this.url=c}getGlyphs(c,f){const g=[];for(const _ in c)for(const E of c[_])g.push({stack:_,id:E});o.asyncAll(g,({stack:_,id:E},P)=>{let R=this.entries[_];R||(R=this.entries[_]={glyphs:{},requests:{},ranges:{}});let k=R.glyphs[E];if(k!==void 0)return void P(null,{stack:_,id:E,glyph:k});if(k=this._tinySDF(R,_,E),k)return R.glyphs[E]=k,void P(null,{stack:_,id:E,glyph:k});const z=Math.floor(E/256);if(256*z>65535)return void P(new Error("glyphs > 65535 not supported"));if(R.ranges[z])return void P(null,{stack:_,id:E,glyph:k});let G=R.requests[z];G||(G=R.requests[z]=[],Z.loadGlyphRange(_,z,this.url,this.requestManager,(q,Y)=>{if(Y){for(const de in Y)this._doesCharSupportLocalGlyph(+de)||(R.glyphs[+de]=Y[+de]);R.ranges[z]=!0}for(const de of G)de(q,Y);delete R.requests[z]})),G.push((q,Y)=>{q?P(q):Y&&P(null,{stack:_,id:E,glyph:Y[E]||null})})},(_,E)=>{if(_)f(_);else if(E){const P={};for(const{stack:R,id:k,glyph:z}of E)(P[R]||(P[R]={}))[k]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};f(null,P)}})}_doesCharSupportLocalGlyph(c){return!!this.localIdeographFontFamily&&(o.unicodeBlockLookup["CJK Unified Ideographs"](c)||o.unicodeBlockLookup["Hangul Syllables"](c)||o.unicodeBlockLookup.Hiragana(c)||o.unicodeBlockLookup.Katakana(c))}_tinySDF(c,f,g){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(g))return;let E=c.tinySDF;if(!E){let R="400";/bold/i.test(f)?R="900":/medium/i.test(f)?R="500":/light/i.test(f)&&(R="200"),E=c.tinySDF=new Z.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:_,fontWeight:R})}const P=E.draw(String.fromCharCode(g));return{id:g,bitmap:new o.AlphaImage({width:P.width||30,height:P.height||30},P.data),metrics:{width:P.glyphWidth||24,height:P.glyphHeight||24,left:P.glyphLeft||0,top:P.glyphTop-27||-8,advance:P.glyphAdvance||24}}}}Z.loadGlyphRange=function(y,c,f,g,_){const E=256*c,P=E+255,R=g.transformRequest(f.replace("{fontstack}",y).replace("{range}",`${E}-${P}`),o.ResourceType.Glyphs);o.getArrayBuffer(R,(k,z)=>{if(k)_(k);else if(z){const G={};for(const q of o.parseGlyphPbf(z))G[q.id]=q;_(null,G)}})},Z.TinySDF=class{constructor({fontSize:y=24,buffer:c=3,radius:f=8,cutoff:g=.25,fontFamily:_="sans-serif",fontWeight:E="normal",fontStyle:P="normal"}={}){this.buffer=c,this.cutoff=g,this.radius=f;const R=this.size=y+4*c,k=this._createCanvas(R),z=this.ctx=k.getContext("2d",{willReadFrequently:!0});z.font=`${P} ${E} ${y}px ${_}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(R*R),this.gridInner=new Float64Array(R*R),this.f=new Float64Array(R),this.z=new Float64Array(R+1),this.v=new Uint16Array(R)}_createCanvas(y){const c=document.createElement("canvas");return c.width=c.height=y,c}draw(y){const{width:c,actualBoundingBoxAscent:f,actualBoundingBoxDescent:g,actualBoundingBoxLeft:_,actualBoundingBoxRight:E}=this.ctx.measureText(y),P=Math.ceil(f),R=Math.min(this.size-this.buffer,Math.ceil(E-_)),k=Math.min(this.size-this.buffer,P+Math.ceil(g)),z=R+2*this.buffer,G=k+2*this.buffer,q=Math.max(z*G,0),Y=new Uint8ClampedArray(q),de={data:Y,width:z,height:G,glyphWidth:R,glyphHeight:k,glyphTop:P,glyphLeft:0,glyphAdvance:c};if(R===0||k===0)return de;const{ctx:ce,buffer:ue,gridInner:we,gridOuter:Ce}=this;ce.clearRect(ue,ue,R,k),ce.fillText(y,ue,ue+P);const Oe=ce.getImageData(ue,ue,R,k);Ce.fill($,0,q),we.fill(0,0,q);for(let he=0;he<k;he++)for(let ze=0;ze<R;ze++){const Fe=Oe.data[4*(he*R+ze)+3]/255;if(Fe===0)continue;const He=(he+ue)*z+ze+ue;if(Fe===1)Ce[He]=0,we[He]=$;else{const qe=.5-Fe;Ce[He]=qe>0?qe*qe:0,we[He]=qe<0?qe*qe:0}}N(Ce,0,0,z,G,z,this.f,this.v,this.z),N(we,ue,ue,R,k,z,this.f,this.v,this.z);for(let he=0;he<q;he++){const ze=Math.sqrt(Ce[he])-Math.sqrt(we[he]);Y[he]=Math.round(255-255*(ze/this.radius+this.cutoff))}return de}};const ie=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(y,c){return o.sphericalToCartesian(y.expression.evaluate(c))}interpolate(y,c,f){return{x:o.number(y.x,c.x,f),y:o.number(y.y,c.y,f),z:o.number(y.z,c.z,f)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),re="-transition";class ve extends o.Evented{constructor(c){super(),this._transitionable=new o.Transitionable(ie),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,f={}){if(!this._validate(o.validateLight,c,f))for(const g in c){const _=c[g];g.endsWith(re)?this._transitionable.setTransition(g.slice(0,-re.length),_):this._transitionable.setValue(g,_)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,f,g){return(!g||g.validate!==!1)&&o.emitValidationErrors(this,c.call(o.validateStyle,o.extend({value:f,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Te{constructor(c,f){this.width=c,this.height=f,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(c,f){const g=c.join(",")+String(f);return this.dashEntry[g]||(this.dashEntry[g]=this.addDash(c,f)),this.dashEntry[g]}getDashRanges(c,f,g){const _=[];let E=c.length%2==1?-c[c.length-1]*g:0,P=c[0]*g,R=!0;_.push({left:E,right:P,isDash:R,zeroLength:c[0]===0});let k=c[0];for(let z=1;z<c.length;z++){R=!R;const G=c[z];E=k*g,k+=G,P=k*g,_.push({left:E,right:P,isDash:R,zeroLength:G===0})}return _}addRoundDash(c,f,g){const _=f/2;for(let E=-g;E<=g;E++){const P=this.width*(this.nextRow+g+E);let R=0,k=c[R];for(let z=0;z<this.width;z++){z/k.right>1&&(k=c[++R]);const G=Math.abs(z-k.left),q=Math.abs(z-k.right),Y=Math.min(G,q);let de;const ce=E/g*(_+1);if(k.isDash){const ue=_-Math.abs(ce);de=Math.sqrt(Y*Y+ue*ue)}else de=_-Math.sqrt(Y*Y+ce*ce);this.data[P+z]=Math.max(0,Math.min(255,de+128))}}}addRegularDash(c){for(let R=c.length-1;R>=0;--R){const k=c[R],z=c[R+1];k.zeroLength?c.splice(R,1):z&&z.isDash===k.isDash&&(z.left=k.left,c.splice(R,1))}const f=c[0],g=c[c.length-1];f.isDash===g.isDash&&(f.left=g.left-this.width,g.right=f.right+this.width);const _=this.width*this.nextRow;let E=0,P=c[E];for(let R=0;R<this.width;R++){R/P.right>1&&(P=c[++E]);const k=Math.abs(R-P.left),z=Math.abs(R-P.right),G=Math.min(k,z);this.data[_+R]=Math.max(0,Math.min(255,(P.isDash?G:-G)+128))}}addDash(c,f){const g=f?7:0,_=2*g+1;if(this.nextRow+_>this.height)return o.warnOnce("LineAtlas out of space"),null;let E=0;for(let R=0;R<c.length;R++)E+=c[R];if(E!==0){const R=this.width/E,k=this.getDashRanges(c,this.width,R);f?this.addRoundDash(k,R,g):this.addRegularDash(k)}const P={y:(this.nextRow+g+.5)/this.height,height:2*g/this.height,width:E};return this.nextRow+=_,this.dirty=!0,P}bind(c){const f=c.gl;this.texture?(f.bindTexture(f.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,f.texSubImage2D(f.TEXTURE_2D,0,0,0,this.width,this.height,f.ALPHA,f.UNSIGNED_BYTE,this.data))):(this.texture=f.createTexture(),f.bindTexture(f.TEXTURE_2D,this.texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.REPEAT),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.ALPHA,this.width,this.height,0,f.ALPHA,f.UNSIGNED_BYTE,this.data))}}class Ae{constructor(c,f){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const g=this.workerPool.acquire(this.id);for(let _=0;_<g.length;_++){const E=new Ae.Actor(g[_],f,this.id);E.name=`Worker ${_}`,this.actors.push(E)}if(!this.actors.length)throw new Error("No actors found")}broadcast(c,f,g){o.asyncAll(this.actors,(_,E)=>{_.send(c,f,E)},g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function fe(y,c,f){const g=function(_,E){if(_)return f(_);if(E){const P=o.pick(o.extend(E,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);E.vector_layers&&(P.vectorLayers=E.vector_layers,P.vectorLayerIds=P.vectorLayers.map(R=>R.id)),f(null,P)}};return y.url?o.getJSON(c.transformRequest(y.url,o.ResourceType.Source),g):o.exported.frame(()=>g(null,y))}Ae.Actor=o.Actor;class Pe{constructor(c,f,g){this.bounds=o.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=f||0,this.maxzoom=g||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const f=Math.pow(2,c.z),g=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*f),_=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*f),E=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*f),P=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*f);return c.x>=g&&c.x<E&&c.y>=_&&c.y<P}}class _e extends o.Evented{constructor(c,f,g,_){if(super(),this.id=c,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(f,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},f),this._collectResourceTiming=f.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=fe(this._options,this.map._requestManager,(c,f)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),c?this.fire(new o.ErrorEvent(c)):f&&(o.extend(this,f),f.bounds&&(this.tileBounds=new Pe(f.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(c,f){const g=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),_={request:this.map._requestManager.transformRequest(g,o.ResourceType.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function E(P,R){return delete c.request,c.aborted?f(null):P&&P.status!==404?f(P):(R&&R.resourceTiming&&(c.resourceTiming=R.resourceTiming),this.map._refreshExpiredTiles&&R&&c.setExpiryData(R),c.loadVectorData(R,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),f(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}_.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired"?c.state==="loading"?c.reloadCallback=f:c.request=c.actor.send("reloadTile",_,E.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",_,E.bind(this)))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class ke extends o.Evented{constructor(c,f,g,_){super(),this.id=c,this.dispatcher=g,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},f),o.extend(this,o.pick(f,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=fe(this._options,this.map._requestManager,(c,f)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new o.ErrorEvent(c)):f&&(o.extend(this,f),f.bounds&&(this.tileBounds=new Pe(f.bounds,this.minzoom,this.maxzoom)),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,f){const g=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);c.request=o.getImage(this.map._requestManager.transformRequest(g,o.ResourceType.Tile),(_,E,P)=>{if(delete c.request,c.aborted)c.state="unloaded",f(null);else if(_)c.state="errored",f(_);else if(E){this.map._refreshExpiredTiles&&c.setExpiryData(P);const R=this.map.painter.context,k=R.gl;c.texture=this.map.painter.getTileTexture(E.width),c.texture?c.texture.update(E,{useMipmap:!0}):(c.texture=new M(R,E,k.RGBA,{useMipmap:!0}),c.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),R.extTextureFilterAnisotropic&&k.texParameterf(k.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax)),c.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),f(null)}})}abortTile(c,f){c.request&&(c.request.cancel(),delete c.request),f()}unloadTile(c,f){c.texture&&this.map.painter.saveTileTexture(c.texture),f()}hasTransition(){return!1}}let Vt;class ut extends ke{constructor(c,f,g,_){super(c,f,g,_),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},f),this.encoding=f.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(c,f){const g=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function _(E,P){E&&(c.state="errored",f(E)),P&&(c.dem=P,c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0,c.state="loaded",f(null))}c.request=o.getImage(this.map._requestManager.transformRequest(g,o.ResourceType.Tile),function(E,P){if(delete c.request,c.aborted)c.state="unloaded",f(null);else if(E)c.state="errored",f(E);else if(P){this.map._refreshExpiredTiles&&c.setExpiryData(P),delete P.cacheControl,delete P.expires;const R=o.isImageBitmap(P)&&(Vt==null&&(Vt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Vt)?P:o.exported.getImageData(P,1),k={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:R,encoding:this.encoding};c.actor&&c.state!=="expired"||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",k,_.bind(this)))}}.bind(this)),c.neighboringTiles=this._getNeighboringTiles(c.tileID)}_getNeighboringTiles(c){const f=c.canonical,g=Math.pow(2,f.z),_=(f.x-1+g)%g,E=f.x===0?c.wrap-1:c.wrap,P=(f.x+1+g)%g,R=f.x+1===g?c.wrap+1:c.wrap,k={};return k[new o.OverscaledTileID(c.overscaledZ,E,f.z,_,f.y).key]={backfilled:!1},k[new o.OverscaledTileID(c.overscaledZ,R,f.z,P,f.y).key]={backfilled:!1},f.y>0&&(k[new o.OverscaledTileID(c.overscaledZ,E,f.z,_,f.y-1).key]={backfilled:!1},k[new o.OverscaledTileID(c.overscaledZ,c.wrap,f.z,f.x,f.y-1).key]={backfilled:!1},k[new o.OverscaledTileID(c.overscaledZ,R,f.z,P,f.y-1).key]={backfilled:!1}),f.y+1<g&&(k[new o.OverscaledTileID(c.overscaledZ,E,f.z,_,f.y+1).key]={backfilled:!1},k[new o.OverscaledTileID(c.overscaledZ,c.wrap,f.z,f.x,f.y+1).key]={backfilled:!1},k[new o.OverscaledTileID(c.overscaledZ,R,f.z,P,f.y+1).key]={backfilled:!1}),k}unloadTile(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})}}class rn extends o.Evented{constructor(c,f,g,_){super(),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=g.getActor(),this.setEventedParent(_),this._data=f.data,this._options=o.extend({},f),this._collectResourceTiming=f.collectResourceTiming,f.maxzoom!==void 0&&(this.maxzoom=f.maxzoom),f.type&&(this.type=f.type),f.attribution&&(this.attribution=f.attribution),this.promoteId=f.promoteId;const E=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:f.cluster||!1,geojsonVtOptions:{buffer:(f.buffer!==void 0?f.buffer:128)*E,tolerance:(f.tolerance!==void 0?f.tolerance:.375)*E,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:f.lineMetrics||!1,generateId:f.generateId||!1},superclusterOptions:{maxZoom:f.clusterMaxZoom!==void 0?f.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,f.clusterMinPoints||2),extent:o.EXTENT,radius:(f.clusterRadius||50)*E,log:!1,generateId:f.generateId||!1},clusterProperties:f.clusterProperties,filter:f.filter},f.workerOptions)}load(){this._updateWorkerData("metadata")}onAdd(c){this.map=c,this.load()}setData(c){return this._data=c,this._updateWorkerData("content"),this}getClusterExpansionZoom(c,f){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},f),this}getClusterChildren(c,f){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},f),this}getClusterLeaves(c,f,g,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:f,offset:g},_),this}_updateWorkerData(c){const f=o.extend({},this.workerOptions),g=this._data;typeof g=="string"?(f.request=this.map._requestManager.transformRequest(o.exported.resolveURL(g),o.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(g),this._pendingLoads++,this.fire(new o.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,f,(_,E)=>{if(this._pendingLoads--,this._removed||E&&E.abandoned)return void this.fire(new o.Event("dataabort",{dataType:"source",sourceDataType:c}));let P=null;if(E&&E.resourceTiming&&E.resourceTiming[this.id]&&(P=E.resourceTiming[this.id].slice(0)),_)return void this.fire(new o.ErrorEvent(_));const R={dataType:"source",sourceDataType:c};this._collectResourceTiming&&P&&P.length>0&&o.extend(R,{resourceTiming:P}),this.fire(new o.Event("data",R))})}loaded(){return this._pendingLoads===0}loadTile(c,f){const g=c.actor?"reloadTile":"loadTile";c.actor=this.actor;const _={type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request=this.actor.send(g,_,(E,P)=>(delete c.request,c.unloadVectorData(),c.aborted?f(null):E?f(E):(c.loadVectorData(P,this.map.painter,g==="reloadTile"),f(null))))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0}unloadTile(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var ot=o.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class yt extends o.Evented{constructor(c,f,g,_){super(),this.id=c,this.dispatcher=g,this.coordinates=f.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=f}load(c,f){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(g,_)=>{this._loaded=!0,g?this.fire(new o.ErrorEvent(g)):_&&(this.image=_,c&&(this.coordinates=c),f&&f(),this._finishLoading())})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this.options.url=c.url,this.load(c.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}setCoordinates(c){this.coordinates=c;const f=c.map(o.MercatorCoordinate.fromLngLat);this.tileID=function(_){let E=1/0,P=1/0,R=-1/0,k=-1/0;for(const Y of _)E=Math.min(E,Y.x),P=Math.min(P,Y.y),R=Math.max(R,Y.x),k=Math.max(k,Y.y);const z=Math.max(R-E,k-P),G=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),q=Math.pow(2,G);return new o.CanonicalTileID(G,Math.floor((E+R)/2*q),Math.floor((P+k)/2*q))}(f),this.minzoom=this.maxzoom=this.tileID.z;const g=f.map(_=>this.tileID.getTilePoint(_)._round());return this._boundsArray=new o.RasterBoundsArray,this._boundsArray.emplaceBack(g[0].x,g[0].y,0,0),this._boundsArray.emplaceBack(g[1].x,g[1].y,o.EXTENT,0),this._boundsArray.emplaceBack(g[3].x,g[3].y,0,o.EXTENT),this._boundsArray.emplaceBack(g[2].x,g[2].y,o.EXTENT,o.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,f=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,ot.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new M(c,this.image,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));for(const g in this.tiles){const _=this.tiles[g];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}loadTile(c,f){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},f(null)):(c.state="errored",f(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class at extends yt{constructor(c,f,g,_){super(c,f,g,_),this.roundZoom=!0,this.type="video",this.options=f}load(){this._loaded=!1;const c=this.options;this.urls=[];for(const f of c.urls)this.urls.push(this.map._requestManager.transformRequest(f,o.ResourceType.Source).url);o.getVideo(this.urls,(f,g)=>{this._loaded=!0,f?this.fire(new o.ErrorEvent(f)):g&&(this.video=g,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){const f=this.video.seekable;c<f.start(0)||c>f.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${f.start(0)} and ${f.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const c=this.map.painter.context,f=c.gl;this.boundsBuffer||(this.boundsBuffer=c.createVertexBuffer(this._boundsArray,ot.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),f.texSubImage2D(f.TEXTURE_2D,0,0,0,f.RGBA,f.UNSIGNED_BYTE,this.video)):(this.texture=new M(c,this.video,f.RGBA),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE));for(const g in this.tiles){const _=this.tiles[g];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Mt extends yt{constructor(c,f,g,_){super(c,f,g,_),f.coordinates?Array.isArray(f.coordinates)&&f.coordinates.length===4&&!f.coordinates.some(E=>!Array.isArray(E)||E.length!==2||E.some(P=>typeof P!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'missing required property "coordinates"'))),f.animate&&typeof f.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),f.canvas?typeof f.canvas=="string"||f.canvas instanceof HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${c}`,null,'missing required property "canvas"'))),this.options=f,this.animate=f.animate===void 0||f.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let c=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,c=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,c=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const f=this.map.painter.context,g=f.gl;this.boundsBuffer||(this.boundsBuffer=f.createVertexBuffer(this._boundsArray,ot.members)),this.boundsSegments||(this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(c||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new M(f,this.canvas,g.RGBA,{premultiply:!0});for(const _ in this.tiles){const E=this.tiles[_];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}}const Re={vector:_e,raster:ke,"raster-dem":ut,geojson:rn,video:at,image:yt,canvas:Mt};function Ke(y,c){const f=o.create();return o.translate(f,f,[1,1,0]),o.scale(f,f,[.5*y.width,.5*y.height,1]),o.multiply(f,f,y.calculatePosMatrix(c.toUnwrapped()))}function Je(y,c,f,g,_,E){const P=function(q,Y,de){if(q)for(const ce of q){const ue=Y[ce];if(ue&&ue.source===de&&ue.type==="fill-extrusion")return!0}else for(const ce in Y){const ue=Y[ce];if(ue.source===de&&ue.type==="fill-extrusion")return!0}return!1}(_&&_.layers,c,y.id),R=E.maxPitchScaleFactor(),k=y.tilesIn(g,R,P);k.sort(kt);const z=[];for(const q of k)z.push({wrappedTileID:q.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(c,f,y._state,q.queryGeometry,q.cameraQueryGeometry,q.scale,_,E,R,Ke(y.transform,q.tileID))});const G=function(q){const Y={},de={};for(const ce of q){const ue=ce.queryResults,we=ce.wrappedTileID,Ce=de[we]=de[we]||{};for(const Oe in ue){const he=ue[Oe],ze=Ce[Oe]=Ce[Oe]||{},Fe=Y[Oe]=Y[Oe]||[];for(const He of he)ze[He.featureIndex]||(ze[He.featureIndex]=!0,Fe.push(He))}}return Y}(z);for(const q in G)G[q].forEach(Y=>{const de=Y.feature,ce=y.getFeatureState(de.layer["source-layer"],de.id);de.source=de.layer.source,de.layer["source-layer"]&&(de.sourceLayer=de.layer["source-layer"]),de.state=ce});return G}function kt(y,c){const f=y.tileID,g=c.tileID;return f.overscaledZ-g.overscaledZ||f.canonical.y-g.canonical.y||f.wrap-g.wrap||f.canonical.x-g.canonical.x}class ft{constructor(c,f){this.tileID=c,this.uid=o.uniqueId(),this.uses=0,this.tileSize=f,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.textures=[],this.textureCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(c){const f=c+this.timeAdded;f<o.exported.now()||this.fadeEndTime&&f<this.fadeEndTime||(this.fadeEndTime=f)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(c){this.demTexture&&c.saveTileTexture(this.demTexture),this.textures.forEach(f=>c.saveTileTexture(f)),this.demTexture=null,this.textures=[],this.textureCoords={}}loadVectorData(c,f,g){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(_,E){const P={};if(!E)return P;for(const R of _){const k=R.layerIds.map(z=>E.getLayer(z)).filter(Boolean);if(k.length!==0){R.layers=k,R.stateDependentLayerIds&&(R.stateDependentLayers=R.stateDependentLayerIds.map(z=>k.filter(G=>G.id===z)[0]));for(const z of k)P[z.id]=R}}return P}(c.buckets,f.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const E=this.buckets[_];if(E instanceof o.SymbolBucket){if(this.hasSymbolBuckets=!0,!g)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const E=this.buckets[_];if(E instanceof o.SymbolBucket&&E.hasRTLText){this.hasRTLText=!0,o.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const _ in this.buckets){const E=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,f.style.getLayer(_).queryRadius(E))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new o.CollisionBoxArray}unloadVectorData(){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(c){return this.buckets[c.id]}upload(c){for(const g in this.buckets){const _=this.buckets[g];_.uploadPending()&&_.upload(c)}const f=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new M(c,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new M(c,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,f,g,_,E,P,R,k,z,G){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:E,scale:P,tileSize:this.tileSize,pixelPosMatrix:G,transform:k,params:R,queryPadding:this.queryPadding*z},c,f,g):{}}querySourceFeatures(c,f){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const _=g.loadVTLayers(),E=f?f.sourceLayer:"",P=_._geojsonTileLayer||_[E];if(!P)return;const R=o.createFilter(f&&f.filter),{z:k,x:z,y:G}=this.tileID.canonical,q={z:k,x:z,y:G};for(let Y=0;Y<P.length;Y++){const de=P.feature(Y);if(R.needGeometry){const we=o.toEvaluationFeature(de,!0);if(!R.filter(new o.EvaluationParameters(this.tileID.overscaledZ),we,this.tileID.canonical))continue}else if(!R.filter(new o.EvaluationParameters(this.tileID.overscaledZ),de))continue;const ce=g.getId(de,E),ue=new o.GeoJSONFeature(de,k,z,G,ce);ue.tile=q,c.push(ue)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){const f=this.expirationTime;if(c.cacheControl){const g=o.parseCacheControl(c.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){const g=Date.now();let _=!1;if(this.expirationTime>g)_=!1;else if(f)if(this.expirationTime<f)_=!0;else{const E=this.expirationTime-f;E?this.expirationTime=g+Math.max(E,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,f){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0)return;const g=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!f.style.hasLayer(_))continue;const E=this.buckets[_],P=E.layers[0].sourceLayer||"_geojsonTileLayer",R=g[P],k=c[P];if(!R||!k||Object.keys(k).length===0)continue;E.update(k,R,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=f&&f.style&&f.style.getLayer(_);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(E)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<o.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=o.exported.now()+c}setDependencies(c,f){const g={};for(const _ of f)g[_]=!0;this.dependencies[c]=g}hasDependency(c,f){for(const g of c){const _=this.dependencies[g];if(_){for(const E of f)if(_[E])return!0}}return!1}}class Pt{constructor(c,f){this.max=c,this.onRemove=f,this.reset()}reset(){for(const c in this.data)for(const f of this.data[c])f.timeout&&clearTimeout(f.timeout),this.onRemove(f.value);return this.data={},this.order=[],this}add(c,f,g){const _=c.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const E={value:f,timeout:void 0};if(g!==void 0&&(E.timeout=setTimeout(()=>{this.remove(c,E)},g)),this.data[_].push(E),this.order.push(_),this.order.length>this.max){const P=this._getAndRemoveByKey(this.order[0]);P&&this.onRemove(P)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){const f=this.data[c].shift();return f.timeout&&clearTimeout(f.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),f.value}getByKey(c){const f=this.data[c];return f?f[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,f){if(!this.has(c))return this;const g=c.wrapped().key,_=f===void 0?0:this.data[g].indexOf(f),E=this.data[g][_];return this.data[g].splice(_,1),E.timeout&&clearTimeout(E.timeout),this.data[g].length===0&&delete this.data[g],this.onRemove(E.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}filter(c){const f=[];for(const g in this.data)for(const _ of this.data[g])c(_.value)||f.push(_);for(const g of f)this.remove(g.value.tileID,g)}}class qt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,f,g){const _=String(f);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][_]=this.stateChanges[c][_]||{},o.extend(this.stateChanges[c][_],g),this.deletedStates[c]===null){this.deletedStates[c]={};for(const E in this.state[c])E!==_&&(this.deletedStates[c][E]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][_]===null){this.deletedStates[c][_]={};for(const E in this.state[c][_])g[E]||(this.deletedStates[c][_][E]=null)}else for(const E in g)this.deletedStates[c]&&this.deletedStates[c][_]&&this.deletedStates[c][_][E]===null&&delete this.deletedStates[c][_][E]}removeFeatureState(c,f,g){if(this.deletedStates[c]===null)return;const _=String(f);if(this.deletedStates[c]=this.deletedStates[c]||{},g&&f!==void 0)this.deletedStates[c][_]!==null&&(this.deletedStates[c][_]=this.deletedStates[c][_]||{},this.deletedStates[c][_][g]=null);else if(f!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][_])for(g in this.deletedStates[c][_]={},this.stateChanges[c][_])this.deletedStates[c][_][g]=null;else this.deletedStates[c][_]=null;else this.deletedStates[c]=null}getState(c,f){const g=String(f),_=o.extend({},(this.state[c]||{})[g],(this.stateChanges[c]||{})[g]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){const E=this.deletedStates[c][f];if(E===null)return{};for(const P in E)delete _[P]}return _}initializeTileState(c,f){c.setFeatureState(this.state,f)}coalesceChanges(c,f){const g={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const E={};for(const P in this.stateChanges[_])this.state[_][P]||(this.state[_][P]={}),o.extend(this.state[_][P],this.stateChanges[_][P]),E[P]=this.state[_][P];g[_]=E}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const E={};if(this.deletedStates[_]===null)for(const P in this.state[_])E[P]={},this.state[_][P]={};else for(const P in this.deletedStates[_]){if(this.deletedStates[_][P]===null)this.state[_][P]={};else for(const R of Object.keys(this.deletedStates[_][P]))delete this.state[_][P][R];E[P]=this.state[_][P]}g[_]=g[_]||{},o.extend(g[_],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(g).length!==0)for(const _ in c)c[_].setFeatureState(g,f)}}class lt extends o.Evented{constructor(c,f,g){super(),this.id=c,this.dispatcher=g,this.on("data",_=>{_.dataType==="source"&&_.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&_.dataType==="source"&&_.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain))}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(_,E,P,R){const k=new Re[E.type](_,E,P,R);if(k.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${k.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],k),k}(c,f,g,this),this._tiles={},this._cache=new Pt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new qt}onAdd(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(c)}onRemove(c){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(c)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const c in this._tiles){const f=this._tiles[c];if(f.state!=="loaded"&&f.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(c,f){return this._source.loadTile(c,f)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c,()=>{})}_abortTile(c){this._source.abortTile&&this._source.abortTile(c,()=>{}),this._source.fire(new o.Event("dataabort",{tile:c,coord:c.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const f in this._tiles){const g=this._tiles[f];g.upload(c),g.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(c=>c.tileID).sort(tn).map(c=>c.key)}getRenderableIds(c){const f=[];for(const g in this._tiles)this._isIdRenderable(g,c)&&f.push(this._tiles[g]);return c?f.sort((g,_)=>{const E=g.tileID,P=_.tileID,R=new o.pointGeometry(E.canonical.x,E.canonical.y)._rotate(this.transform.angle),k=new o.pointGeometry(P.canonical.x,P.canonical.y)._rotate(this.transform.angle);return E.overscaledZ-P.overscaledZ||k.y-R.y||k.x-R.x}).map(g=>g.tileID.key):f.map(g=>g.tileID).sort(tn).map(g=>g.key)}hasRenderableParent(c){const f=this.findLoadedParent(c,0);return!!f&&this._isIdRenderable(f.tileID.key)}_isIdRenderable(c,f){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(f||!this._tiles[c].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(c,f){const g=this._tiles[c];g&&(g.state!=="loading"&&(g.state=f),this._loadTile(g,this._tileLoaded.bind(this,g,c,f)))}_tileLoaded(c,f,g,_){if(_)return c.state="errored",void(_.status!==404?this._source.fire(new o.ErrorEvent(_,{tile:c})):this.update(this.transform,this.terrain));c.timeAdded=o.exported.now(),g==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(f,c),this.getSource().type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),c.aborted||this._source.fire(new o.Event("data",{dataType:"source",tile:c,coord:c.tileID}))}_backfillDEM(c){const f=this.getRenderableIds();for(let _=0;_<f.length;_++){const E=f[_];if(c.neighboringTiles&&c.neighboringTiles[E]){const P=this.getTileByID(E);g(c,P),g(P,c)}}function g(_,E){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let P=E.tileID.canonical.x-_.tileID.canonical.x;const R=E.tileID.canonical.y-_.tileID.canonical.y,k=Math.pow(2,_.tileID.canonical.z),z=E.tileID.key;P===0&&R===0||Math.abs(R)>1||(Math.abs(P)>1&&(Math.abs(P+k)===1?P+=k:Math.abs(P-k)===1&&(P-=k)),E.dem&&_.dem&&(_.dem.backfillBorder(E.dem,P,R),_.neighboringTiles&&_.neighboringTiles[z]&&(_.neighboringTiles[z].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,f,g,_){for(const E in this._tiles){let P=this._tiles[E];if(_[E]||!P.hasData()||P.tileID.overscaledZ<=f||P.tileID.overscaledZ>g)continue;let R=P.tileID;for(;P&&P.tileID.overscaledZ>f+1;){const z=P.tileID.scaledTo(P.tileID.overscaledZ-1);P=this._tiles[z.key],P&&P.hasData()&&(R=z)}let k=R;for(;k.overscaledZ>f;)if(k=k.scaledTo(k.overscaledZ-1),c[k.key]){_[R.key]=R;break}}}findLoadedParent(c,f){if(c.key in this._loadedParentTiles){const g=this._loadedParentTiles[c.key];return g&&g.tileID.overscaledZ>=f?g:null}for(let g=c.overscaledZ-1;g>=f;g--){const _=c.scaledTo(g),E=this._getLoadedTile(_);if(E)return E}}_getLoadedTile(c){const f=this._tiles[c.key];return f&&f.hasData()?f:this._cache.getByKey(c.wrapped().key)}updateCacheSize(c){const f=Math.ceil(c.width/this._source.tileSize)+1,g=Math.ceil(c.height/this._source.tileSize)+1,_=Math.floor(f*g*5),E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(E)}handleWrapJump(c){const f=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,f){const g={};for(const _ in this._tiles){const E=this._tiles[_];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+f),g[E.tileID.key]=E}this._tiles=g;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}update(c,f){if(this.transform=c,this.terrain=f,!this._sourceLoaded||this._paused)return;let g;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?g=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(z=>new o.OverscaledTileID(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)):(g=c.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:f}),this._source.hasTile&&(g=g.filter(z=>this._source.hasTile(z)))):g=[];const _=c.coveringZoomLevel(this._source),E=Math.max(_-lt.maxOverzooming,this._source.minzoom),P=Math.max(_+lt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const z={};for(const G of g)if(G.canonical.z>this._source.minzoom){const q=G.scaledTo(G.canonical.z-1);z[q.key]=q;const Y=G.scaledTo(Math.max(this._source.minzoom,Math.min(G.canonical.z,5)));z[Y.key]=Y}g=g.concat(Object.values(z))}const R=this._updateRetainedTiles(g,_);if(Fn(this._source.type)){const z={},G={},q=Object.keys(R);for(const Y of q){const de=R[Y],ce=this._tiles[Y];if(!ce||ce.fadeEndTime&&ce.fadeEndTime<=o.exported.now())continue;const ue=this.findLoadedParent(de,E);ue&&(this._addTile(ue.tileID),z[ue.tileID.key]=ue.tileID),G[Y]=de}this._retainLoadedChildren(G,_,P,R);for(const Y in z)R[Y]||(this._coveredTiles[Y]=!0,R[Y]=z[Y]);if(f){const Y={},de={};for(const ce of g)this._tiles[ce.key].hasData()?Y[ce.key]=ce:de[ce.key]=ce;for(const ce in de){const ue=de[ce].children(this._source.maxzoom);this._tiles[ue[0].key]&&this._tiles[ue[1].key]&&this._tiles[ue[2].key]&&this._tiles[ue[3].key]&&(Y[ue[0].key]=R[ue[0].key]=ue[0],Y[ue[1].key]=R[ue[1].key]=ue[1],Y[ue[2].key]=R[ue[2].key]=ue[2],Y[ue[3].key]=R[ue[3].key]=ue[3],delete de[ce])}for(const ce in de){const ue=this.findLoadedParent(de[ce],this._source.minzoom);if(ue){Y[ue.tileID.key]=R[ue.tileID.key]=ue.tileID;for(const we in Y)Y[we].isChildOf(ue.tileID)&&delete Y[we]}}for(const ce in this._tiles)Y[ce]||(this._coveredTiles[ce]=!0)}}for(const z in R)this._tiles[z].clearFadeHold();const k=o.keysDifference(this._tiles,R);for(const z of k){const G=this._tiles[z];G.hasSymbolBuckets&&!G.holdingForFade()?G.setHoldDuration(this.map._fadeDuration):G.hasSymbolBuckets&&!G.symbolFadeFinished()||this._removeTile(z)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)}_updateRetainedTiles(c,f){const g={},_={},E=Math.max(f-lt.maxOverzooming,this._source.minzoom),P=Math.max(f+lt.maxUnderzooming,this._source.minzoom),R={};for(const k of c){const z=this._addTile(k);g[k.key]=k,z.hasData()||f<this._source.maxzoom&&(R[k.key]=k)}this._retainLoadedChildren(R,f,P,g);for(const k of c){let z=this._tiles[k.key];if(z.hasData())continue;if(f+1>this._source.maxzoom){const q=k.children(this._source.maxzoom)[0],Y=this.getTile(q);if(Y&&Y.hasData()){g[q.key]=q;continue}}else{const q=k.children(this._source.maxzoom);if(g[q[0].key]&&g[q[1].key]&&g[q[2].key]&&g[q[3].key])continue}let G=z.wasRequested();for(let q=k.overscaledZ-1;q>=E;--q){const Y=k.scaledTo(q);if(_[Y.key]||(_[Y.key]=!0,z=this.getTile(Y),!z&&G&&(z=this._addTile(Y)),z&&(g[Y.key]=Y,G=z.wasRequested(),z.hasData())))break}}return g}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const c in this._tiles){const f=[];let g,_=this._tiles[c].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){g=this._loadedParentTiles[_.key];break}f.push(_.key);const E=_.scaledTo(_.overscaledZ-1);if(g=this._getLoadedTile(E),g)break;_=E}for(const E of f)this._loadedParentTiles[E]=g}}_addTile(c){let f=this._tiles[c.key];if(f)return f;f=this._cache.getAndRemove(c),f&&(this._setTileReloadTimer(c.key,f),f.tileID=c,this._state.initializeTileState(f,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,f)));const g=f;return f||(f=new ft(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(f,this._tileLoaded.bind(this,f,c.key,f.state))),f.uses++,this._tiles[c.key]=f,g||this._source.fire(new o.Event("dataloading",{tile:f,coord:f.tileID,dataType:"source"})),f}_setTileReloadTimer(c,f){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);const g=f.getExpiryTimeout();g&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},g))}_removeTile(c){const f=this._tiles[c];f&&(f.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),f.uses>0||(f.hasData()&&f.state!=="reloading"?this._cache.add(f.tileID,f,f.getExpiryTimeout()):(f.aborted=!0,this._abortTile(f),this._unloadTile(f))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const c in this._tiles)this._removeTile(c);this._cache.reset()}tilesIn(c,f,g){const _=[],E=this.transform;if(!E)return _;const P=g?E.getCameraQueryGeometry(c):c,R=c.map(ce=>E.pointCoordinate(ce,this.terrain)),k=P.map(ce=>E.pointCoordinate(ce,this.terrain)),z=this.getIds();let G=1/0,q=1/0,Y=-1/0,de=-1/0;for(const ce of k)G=Math.min(G,ce.x),q=Math.min(q,ce.y),Y=Math.max(Y,ce.x),de=Math.max(de,ce.y);for(let ce=0;ce<z.length;ce++){const ue=this._tiles[z[ce]];if(ue.holdingForFade())continue;const we=ue.tileID,Ce=Math.pow(2,E.zoom-ue.tileID.overscaledZ),Oe=f*ue.queryPadding*o.EXTENT/ue.tileSize/Ce,he=[we.getTilePoint(new o.MercatorCoordinate(G,q)),we.getTilePoint(new o.MercatorCoordinate(Y,de))];if(he[0].x-Oe<o.EXTENT&&he[0].y-Oe<o.EXTENT&&he[1].x+Oe>=0&&he[1].y+Oe>=0){const ze=R.map(He=>we.getTilePoint(He)),Fe=k.map(He=>we.getTilePoint(He));_.push({tile:ue,tileID:we,queryGeometry:ze,cameraQueryGeometry:Fe,scale:Ce})}}return _}getVisibleCoordinates(c){const f=this.getRenderableIds(c).map(g=>this._tiles[g].tileID);for(const g of f)g.posMatrix=this.transform.calculatePosMatrix(g.toUnwrapped());return f}hasTransition(){if(this._source.hasTransition())return!0;if(Fn(this._source.type))for(const c in this._tiles){const f=this._tiles[c];if(f.fadeEndTime!==void 0&&f.fadeEndTime>=o.exported.now())return!0}return!1}setFeatureState(c,f,g){this._state.updateState(c=c||"_geojsonTileLayer",f,g)}removeFeatureState(c,f,g){this._state.removeFeatureState(c=c||"_geojsonTileLayer",f,g)}getFeatureState(c,f){return this._state.getState(c=c||"_geojsonTileLayer",f)}setDependencies(c,f,g){const _=this._tiles[c];_&&_.setDependencies(f,g)}reloadTilesForDependencies(c,f){for(const g in this._tiles)this._tiles[g].hasDependency(c,f)&&this._reloadTile(g,"reloading");this._cache.filter(g=>!g.hasDependency(c,f))}}function tn(y,c){const f=Math.abs(2*y.wrap)-+(y.wrap<0),g=Math.abs(2*c.wrap)-+(c.wrap<0);return y.overscaledZ-c.overscaledZ||g-f||c.canonical.y-y.canonical.y||c.canonical.x-y.canonical.x}function Fn(y){return y==="raster"||y==="image"||y==="video"}lt.maxOverzooming=10,lt.maxUnderzooming=3;const St="mapboxgl_preloaded_worker_pool";class bt{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<bt.workerCount;)this.workers.push(new Worker(_l.workerUrl));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(f=>{f.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[St]}numActive(){return Object.keys(this.active).length}}const hn=Math.floor(o.exported.hardwareConcurrency/2);let ur;function On(){return ur||(ur=new bt),ur}function Ln(y,c){const f={};for(const g in y)g!=="ref"&&(f[g]=y[g]);return o.refProperties.forEach(g=>{g in c&&(f[g]=c[g])}),f}function is(y){y=y.slice();const c=Object.create(null);for(let f=0;f<y.length;f++)c[y[f].id]=y[f];for(let f=0;f<y.length;f++)"ref"in y[f]&&(y[f]=Ln(y[f],c[y[f].ref]));return y}bt.workerCount=Math.max(Math.min(hn,6),1);const dn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function mr(y,c,f){f.push({command:dn.addSource,args:[y,c[y]]})}function vn(y,c,f){c.push({command:dn.removeSource,args:[y]}),f[y]=!0}function Nr(y,c,f,g){vn(y,f,g),mr(y,c,f)}function bs(y,c,f){let g;for(g in y[f])if(Object.prototype.hasOwnProperty.call(y[f],g)&&g!=="data"&&!x(y[f][g],c[f][g]))return!1;for(g in c[f])if(Object.prototype.hasOwnProperty.call(c[f],g)&&g!=="data"&&!x(y[f][g],c[f][g]))return!1;return!0}function Cr(y,c,f,g,_,E){let P;for(P in c=c||{},y=y||{})Object.prototype.hasOwnProperty.call(y,P)&&(x(y[P],c[P])||f.push({command:E,args:[g,P,c[P],_]}));for(P in c)Object.prototype.hasOwnProperty.call(c,P)&&!Object.prototype.hasOwnProperty.call(y,P)&&(x(y[P],c[P])||f.push({command:E,args:[g,P,c[P],_]}))}function ai(y){return y.id}function ko(y,c){return y[c.id]=c,y}class ss{constructor(c,f){this.reset(c,f)}reset(c,f){this.points=c||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=o.clamp(c,0,1);let f=1,g=this._distances[f];const _=c*this.paddedLength+this.padding;for(;g<_&&f<this._distances.length;)g=this._distances[++f];const E=f-1,P=this._distances[E],R=g-P,k=R>0?(_-P)/R:0;return this.points[E].mult(1-k).add(this.points[f].mult(k))}}function We(y,c){let f=!0;return y==="always"||y!=="never"&&c!=="never"||(f=!1),f}class pt{constructor(c,f,g){const _=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(c/g),this.yCellCount=Math.ceil(f/g);for(let P=0;P<this.xCellCount*this.yCellCount;P++)_.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=f,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,f,g,_,E){this._forEachCell(f,g,_,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(f),this.bboxes.push(g),this.bboxes.push(_),this.bboxes.push(E)}insertCircle(c,f,g,_){this._forEachCell(f-_,g-_,f+_,g+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(f),this.circles.push(g),this.circles.push(_)}_insertBoxCell(c,f,g,_,E,P){this.boxCells[E].push(P)}_insertCircleCell(c,f,g,_,E,P){this.circleCells[E].push(P)}_query(c,f,g,_,E,P,R){if(g<0||c>this.width||_<0||f>this.height)return[];const k=[];if(c<=0&&f<=0&&this.width<=g&&this.height<=_){if(E)return[{key:null,x1:c,y1:f,x2:g,y2:_}];for(let z=0;z<this.boxKeys.length;z++)k.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const G=this.circles[3*z],q=this.circles[3*z+1],Y=this.circles[3*z+2];k.push({key:this.circleKeys[z],x1:G-Y,y1:q-Y,x2:G+Y,y2:q+Y})}}else this._forEachCell(c,f,g,_,this._queryCell,k,{hitTest:E,overlapMode:P,seenUids:{box:{},circle:{}}},R);return k}query(c,f,g,_){return this._query(c,f,g,_,!1,null)}hitTest(c,f,g,_,E,P){return this._query(c,f,g,_,!0,E,P).length>0}hitTestCircle(c,f,g,_,E){const P=c-g,R=c+g,k=f-g,z=f+g;if(R<0||P>this.width||z<0||k>this.height)return!1;const G=[];return this._forEachCell(P,k,R,z,this._queryCellCircle,G,{hitTest:!0,overlapMode:_,circle:{x:c,y:f,radius:g},seenUids:{box:{},circle:{}}},E),G.length>0}_queryCell(c,f,g,_,E,P,R,k){const{seenUids:z,hitTest:G,overlapMode:q}=R,Y=this.boxCells[E];if(Y!==null){const ce=this.bboxes;for(const ue of Y)if(!z.box[ue]){z.box[ue]=!0;const we=4*ue,Ce=this.boxKeys[ue];if(c<=ce[we+2]&&f<=ce[we+3]&&g>=ce[we+0]&&_>=ce[we+1]&&(!k||k(Ce))&&(!G||!We(q,Ce.overlapMode))&&(P.push({key:Ce,x1:ce[we],y1:ce[we+1],x2:ce[we+2],y2:ce[we+3]}),G))return!0}}const de=this.circleCells[E];if(de!==null){const ce=this.circles;for(const ue of de)if(!z.circle[ue]){z.circle[ue]=!0;const we=3*ue,Ce=this.circleKeys[ue];if(this._circleAndRectCollide(ce[we],ce[we+1],ce[we+2],c,f,g,_)&&(!k||k(Ce))&&(!G||!We(q,Ce.overlapMode))){const Oe=ce[we],he=ce[we+1],ze=ce[we+2];if(P.push({key:Ce,x1:Oe-ze,y1:he-ze,x2:Oe+ze,y2:he+ze}),G)return!0}}}return!1}_queryCellCircle(c,f,g,_,E,P,R,k){const{circle:z,seenUids:G,overlapMode:q}=R,Y=this.boxCells[E];if(Y!==null){const ce=this.bboxes;for(const ue of Y)if(!G.box[ue]){G.box[ue]=!0;const we=4*ue,Ce=this.boxKeys[ue];if(this._circleAndRectCollide(z.x,z.y,z.radius,ce[we+0],ce[we+1],ce[we+2],ce[we+3])&&(!k||k(Ce))&&!We(q,Ce.overlapMode))return P.push(!0),!0}}const de=this.circleCells[E];if(de!==null){const ce=this.circles;for(const ue of de)if(!G.circle[ue]){G.circle[ue]=!0;const we=3*ue,Ce=this.circleKeys[ue];if(this._circlesCollide(ce[we],ce[we+1],ce[we+2],z.x,z.y,z.radius)&&(!k||k(Ce))&&!We(q,Ce.overlapMode))return P.push(!0),!0}}}_forEachCell(c,f,g,_,E,P,R,k){const z=this._convertToXCellCoord(c),G=this._convertToYCellCoord(f),q=this._convertToXCellCoord(g),Y=this._convertToYCellCoord(_);for(let de=z;de<=q;de++)for(let ce=G;ce<=Y;ce++)if(E.call(this,c,f,g,_,this.xCellCount*ce+de,P,R,k))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,f,g,_,E,P){const R=_-c,k=E-f,z=g+P;return z*z>R*R+k*k}_circleAndRectCollide(c,f,g,_,E,P,R){const k=(P-_)/2,z=Math.abs(c-(_+k));if(z>k+g)return!1;const G=(R-E)/2,q=Math.abs(f-(E+G));if(q>G+g)return!1;if(z<=k||q<=G)return!0;const Y=z-k,de=q-G;return Y*Y+de*de<=g*g}}function Vs(y,c,f,g,_){const E=o.create();return c?(o.scale(E,E,[1/_,1/_,1]),f||o.rotateZ(E,E,g.angle)):o.multiply(E,g.labelPlaneMatrix,y),E}function yi(y,c,f,g,_){if(c){const E=o.clone(y);return o.scale(E,E,[_,_,1]),f||o.rotateZ(E,E,-g.angle),E}return g.glCoordMatrix}function fn(y,c,f){let g;f?(g=[y.x,y.y,f(y.x,y.y),1],o.transformMat4(g,g,c)):(g=[y.x,y.y,0,1],jt(g,g,c));const _=g[3];return{point:new o.pointGeometry(g[0]/_,g[1]/_),signedDistanceFromCamera:_}}function Di(y,c){return .5+y/c*.5}function Ai(y,c){const f=y[0]/y[3],g=y[1]/y[3];return f>=-c[0]&&f<=c[0]&&g>=-c[1]&&g<=c[1]}function De(y,c,f,g,_,E,P,R,k,z){const G=g?y.textSizeData:y.iconSizeData,q=o.evaluateSizeForZoom(G,f.transform.zoom),Y=[256/f.width*2+1,256/f.height*2+1],de=g?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;de.clear();const ce=y.lineVertexArray,ue=g?y.text.placedSymbolArray:y.icon.placedSymbolArray,we=f.transform.width/f.transform.height;let Ce=!1;for(let Oe=0;Oe<ue.length;Oe++){const he=ue.get(Oe);if(he.hidden||he.writingMode===o.WritingMode.vertical&&!Ce){st(he.numGlyphs,de);continue}let ze;if(Ce=!1,z?(ze=[he.anchorX,he.anchorY,z(he.anchorX,he.anchorY),1],o.transformMat4(ze,ze,c)):(ze=[he.anchorX,he.anchorY,0,1],jt(ze,ze,c)),!Ai(ze,Y)){st(he.numGlyphs,de);continue}const Fe=Di(f.transform.cameraToCenterDistance,ze[3]),He=o.evaluateSizeForFeature(G,q,he),qe=P?He/Fe:He*Fe,tt=new o.pointGeometry(he.anchorX,he.anchorY),Ge=fn(tt,_,z).point,At={},mt=Qe(he,qe,!1,R,c,_,E,y.glyphOffsetArray,ce,de,Ge,tt,At,we,k,z);Ce=mt.useVertical,(mt.notEnoughRoom||Ce||mt.needsFlipping&&Qe(he,qe,!0,R,c,_,E,y.glyphOffsetArray,ce,de,Ge,tt,At,we,k,z).notEnoughRoom)&&st(he.numGlyphs,de)}g?y.text.dynamicLayoutVertexBuffer.updateData(de):y.icon.dynamicLayoutVertexBuffer.updateData(de)}function Ie(y,c,f,g,_,E,P,R,k,z,G,q,Y){const de=R.glyphStartIndex+R.numGlyphs,ce=R.lineStartIndex,ue=R.lineStartIndex+R.lineLength,we=c.getoffsetX(R.glyphStartIndex),Ce=c.getoffsetX(de-1),Oe=vt(y*we,f,g,_,E,P,R.segment,ce,ue,k,z,G,q,Y);if(!Oe)return null;const he=vt(y*Ce,f,g,_,E,P,R.segment,ce,ue,k,z,G,q,Y);return he?{first:Oe,last:he}:null}function Me(y,c,f,g){return y===o.WritingMode.horizontal&&Math.abs(f.y-c.y)>Math.abs(f.x-c.x)*g?{useVertical:!0}:(y===o.WritingMode.vertical?c.y<f.y:c.x>f.x)?{needsFlipping:!0}:null}function Qe(y,c,f,g,_,E,P,R,k,z,G,q,Y,de,ce,ue){const we=c/24,Ce=y.lineOffsetX*we,Oe=y.lineOffsetY*we;let he;if(y.numGlyphs>1){const ze=y.glyphStartIndex+y.numGlyphs,Fe=y.lineStartIndex,He=y.lineStartIndex+y.lineLength,qe=Ie(we,R,Ce,Oe,f,G,q,y,k,E,Y,ce,ue);if(!qe)return{notEnoughRoom:!0};const tt=fn(qe.first.point,P,ue).point,Ge=fn(qe.last.point,P,ue).point;if(g&&!f){const At=Me(y.writingMode,tt,Ge,de);if(At)return At}he=[qe.first];for(let At=y.glyphStartIndex+1;At<ze-1;At++)he.push(vt(we*R.getoffsetX(At),Ce,Oe,f,G,q,y.segment,Fe,He,k,E,Y,ce,ue));he.push(qe.last)}else{if(g&&!f){const Fe=fn(q,_,ue).point,He=y.lineStartIndex+y.segment+1,qe=new o.pointGeometry(k.getx(He),k.gety(He)),tt=fn(qe,_,ue),Ge=tt.signedDistanceFromCamera>0?tt.point:Ye(q,qe,Fe,1,_,ue),At=Me(y.writingMode,Fe,Ge,de);if(At)return At}const ze=vt(we*R.getoffsetX(y.glyphStartIndex),Ce,Oe,f,G,q,y.segment,y.lineStartIndex,y.lineStartIndex+y.lineLength,k,E,Y,ce,ue);if(!ze)return{notEnoughRoom:!0};he=[ze]}for(const ze of he)o.addDynamicAttributes(z,ze.point,ze.angle);return{}}function Ye(y,c,f,g,_,E){const P=fn(y.add(y.sub(c)._unit()),_,E).point,R=f.sub(P);return f.add(R._mult(g/R.mag()))}function vt(y,c,f,g,_,E,P,R,k,z,G,q,Y,de){const ce=g?y-c:y+c;let ue=ce>0?1:-1,we=0;g&&(ue*=-1,we=Math.PI),ue<0&&(we+=Math.PI);let Ce=ue>0?R+P:R+P+1,Oe=_,he=_,ze=0,Fe=0;const He=Math.abs(ce),qe=[];for(;ze+Fe<=He;){if(Ce+=ue,Ce<R||Ce>=k)return null;if(he=Oe,qe.push(Oe),Oe=q[Ce],Oe===void 0){const Ct=new o.pointGeometry(z.getx(Ce),z.gety(Ce)),sn=fn(Ct,G,de);if(sn.signedDistanceFromCamera>0)Oe=q[Ce]=sn.point;else{const gn=Ce-ue;Oe=Ye(ze===0?E:new o.pointGeometry(z.getx(gn),z.gety(gn)),Ct,he,He-ze+1,G,de)}}ze+=Fe,Fe=he.dist(Oe)}const tt=(He-ze)/Fe,Ge=Oe.sub(he),At=Ge.mult(tt)._add(he);At._add(Ge._unit()._perp()._mult(f*ue));const mt=we+Math.atan2(Oe.y-he.y,Oe.x-he.x);return qe.push(At),{point:At,angle:Y?mt:0,path:qe}}const Kt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function st(y,c){for(let f=0;f<y;f++){const g=c.length;c.resize(g+4),c.float32.set(Kt,3*g)}}function jt(y,c,f){const g=c[0],_=c[1];return y[0]=f[0]*g+f[4]*_+f[12],y[1]=f[1]*g+f[5]*_+f[13],y[3]=f[3]*g+f[7]*_+f[15],y}const Xt=100;class Gn{constructor(c,f=new pt(c.width+200,c.height+200,25),g=new pt(c.width+200,c.height+200,25)){this.transform=c,this.grid=f,this.ignoredGrid=g,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Xt,this.screenBottomBoundary=c.height+Xt,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(c,f,g,_,E,P){const R=this.projectAndGetPerspectiveRatio(_,c.anchorPointX,c.anchorPointY,P),k=g*R.perspectiveRatio,z=c.x1*k+R.point.x,G=c.y1*k+R.point.y,q=c.x2*k+R.point.x,Y=c.y2*k+R.point.y;return!this.isInsideGrid(z,G,q,Y)||f!=="always"&&this.grid.hitTest(z,G,q,Y,f,E)||R.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[z,G,q,Y],offscreen:this.isOffscreen(z,G,q,Y)}}placeCollisionCircles(c,f,g,_,E,P,R,k,z,G,q,Y,de,ce){const ue=[],we=new o.pointGeometry(f.anchorX,f.anchorY),Ce=fn(we,P,ce),Oe=Di(this.transform.cameraToCenterDistance,Ce.signedDistanceFromCamera),he=(G?E/Oe:E*Oe)/o.ONE_EM,ze=fn(we,R,ce).point,Fe=Ie(he,_,f.lineOffsetX*he,f.lineOffsetY*he,!1,ze,we,f,g,R,{},!1,ce);let He=!1,qe=!1,tt=!0;if(Fe){const Ge=.5*Y*Oe+de,At=new o.pointGeometry(-100,-100),mt=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Ct=new ss,sn=Fe.first,gn=Fe.last;let Wt=[];for(let kn=sn.path.length-1;kn>=1;kn--)Wt.push(sn.path[kn]);for(let kn=1;kn<gn.path.length;kn++)Wt.push(gn.path[kn]);const Kn=2.5*Ge;if(k){const kn=Wt.map(Dn=>fn(Dn,k,ce));Wt=kn.some(Dn=>Dn.signedDistanceFromCamera<=0)?[]:kn.map(Dn=>Dn.point)}let Xn=[];if(Wt.length>0){const kn=Wt[0].clone(),Dn=Wt[0].clone();for(let Jn=1;Jn<Wt.length;Jn++)kn.x=Math.min(kn.x,Wt[Jn].x),kn.y=Math.min(kn.y,Wt[Jn].y),Dn.x=Math.max(Dn.x,Wt[Jn].x),Dn.y=Math.max(Dn.y,Wt[Jn].y);Xn=kn.x>=At.x&&Dn.x<=mt.x&&kn.y>=At.y&&Dn.y<=mt.y?[Wt]:Dn.x<At.x||kn.x>mt.x||Dn.y<At.y||kn.y>mt.y?[]:o.clipLine([Wt],At.x,At.y,mt.x,mt.y)}for(const kn of Xn){Ct.reset(kn,.25*Ge);let Dn=0;Dn=Ct.length<=.5*Ge?1:Math.ceil(Ct.paddedLength/Kn)+1;for(let Jn=0;Jn<Dn;Jn++){const vi=Jn/Math.max(Dn-1,1),No=Ct.lerp(vi),co=No.x+Xt,zo=No.y+Xt;ue.push(co,zo,Ge,0);const Ua=co-Ge,Gs=zo-Ge,ls=co+Ge,sa=zo+Ge;if(tt=tt&&this.isOffscreen(Ua,Gs,ls,sa),qe=qe||this.isInsideGrid(Ua,Gs,ls,sa),c!=="always"&&this.grid.hitTestCircle(co,zo,Ge,c,q)&&(He=!0,!z))return{circles:[],offscreen:!1,collisionDetected:He}}}}return{circles:!z&&He||!qe||Oe<this.perspectiveRatioCutoff?[]:ue,offscreen:tt,collisionDetected:He}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let g=1/0,_=1/0,E=-1/0,P=-1/0;for(const G of c){const q=new o.pointGeometry(G.x+Xt,G.y+Xt);g=Math.min(g,q.x),_=Math.min(_,q.y),E=Math.max(E,q.x),P=Math.max(P,q.y),f.push(q)}const R=this.grid.query(g,_,E,P).concat(this.ignoredGrid.query(g,_,E,P)),k={},z={};for(const G of R){const q=G.key;if(k[q.bucketInstanceId]===void 0&&(k[q.bucketInstanceId]={}),k[q.bucketInstanceId][q.featureIndex])continue;const Y=[new o.pointGeometry(G.x1,G.y1),new o.pointGeometry(G.x2,G.y1),new o.pointGeometry(G.x2,G.y2),new o.pointGeometry(G.x1,G.y2)];o.polygonIntersectsPolygon(f,Y)&&(k[q.bucketInstanceId][q.featureIndex]=!0,z[q.bucketInstanceId]===void 0&&(z[q.bucketInstanceId]=[]),z[q.bucketInstanceId].push(q.featureIndex))}return z}insertCollisionBox(c,f,g,_,E,P){(g?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:E,collisionGroupID:P,overlapMode:f},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,f,g,_,E,P){const R=g?this.ignoredGrid:this.grid,k={bucketInstanceId:_,featureIndex:E,collisionGroupID:P,overlapMode:f};for(let z=0;z<c.length;z+=4)R.insertCircle(k,c[z],c[z+1],c[z+2])}projectAndGetPerspectiveRatio(c,f,g,_){let E;return _?(E=[f,g,_(f,g),1],o.transformMat4(E,E,c)):(E=[f,g,0,1],jt(E,E,c)),{point:new o.pointGeometry((E[0]/E[3]+1)/2*this.transform.width+Xt,(-E[1]/E[3]+1)/2*this.transform.height+Xt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/E[3]*.5}}isOffscreen(c,f,g,_){return g<Xt||c>=this.screenRightBoundary||_<Xt||f>this.screenBottomBoundary}isInsideGrid(c,f,g,_){return g>=0&&c<this.gridRightBoundary&&_>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const c=o.identity([]);return o.translate(c,c,[-100,-100,0]),c}}function Mn(y,c,f){return c*(o.EXTENT/(y.tileSize*Math.pow(2,f-y.tileID.overscaledZ)))}class $n{constructor(c,f,g,_){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?f:-f))):_&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class un{constructor(c,f,g,_,E){this.text=new $n(c?c.text:null,f,g,E),this.icon=new $n(c?c.icon:null,f,_,E)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Qr{constructor(c,f,g){this.text=c,this.icon=f,this.skipFade=g}}class li{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Pi{constructor(c,f,g,_,E){this.bucketInstanceId=c,this.featureIndex=f,this.sourceLayerIndex=g,this.bucketIndex=_,this.tileID=E}}class Ki{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const f=++this.maxGroupID;this.collisionGroups[c]={ID:f,predicate:g=>g.collisionGroupID===f}}return this.collisionGroups[c]}}function os(y,c,f,g,_){const{horizontalAlign:E,verticalAlign:P}=o.getAnchorAlignment(y),R=-(E-.5)*c,k=-(P-.5)*f,z=o.evaluateVariableOffset(y,g);return new o.pointGeometry(R+z[0]*_,k+z[1]*_)}function Oo(y,c,f,g,_,E){const{x1:P,x2:R,y1:k,y2:z,anchorPointX:G,anchorPointY:q}=y,Y=new o.pointGeometry(c,f);return g&&Y._rotate(_?E:-E),{x1:P+Y.x,y1:k+Y.y,x2:R+Y.x,y2:z+Y.y,anchorPointX:G,anchorPointY:q}}class ae{constructor(c,f,g,_,E){this.transform=c.clone(),this.terrain=f,this.collisionIndex=new Gn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=g,this.retainedQueryData={},this.collisionGroups=new Ki(_),this.collisionCircleArrays={},this.prevPlacement=E,E&&(E.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,f,g,_){const E=g.getBucket(f),P=g.latestFeatureIndex;if(!E||!P||f.id!==E.layerIds[0])return;const R=g.collisionBoxArray,k=E.layers[0].layout,z=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),G=g.tileSize/o.EXTENT,q=this.transform.calculatePosMatrix(g.tileID.toUnwrapped()),Y=k.get("text-pitch-alignment")==="map",de=k.get("text-rotation-alignment")==="map",ce=Mn(g,1,this.transform.zoom),ue=Vs(q,Y,de,this.transform,ce);let we=null;if(Y){const Oe=yi(q,Y,de,this.transform,ce);we=o.multiply([],this.transform.labelPlaneMatrix,Oe)}this.retainedQueryData[E.bucketInstanceId]=new Pi(E.bucketInstanceId,P,E.sourceLayerIndex,E.index,g.tileID);const Ce={bucket:E,layout:k,posMatrix:q,textLabelPlaneMatrix:ue,labelToScreenMatrix:we,scale:z,textPixelRatio:G,holdingForFade:g.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(E.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(E.sourceID)};if(_)for(const Oe of E.sortKeyRanges){const{sortKey:he,symbolInstanceStart:ze,symbolInstanceEnd:Fe}=Oe;c.push({sortKey:he,symbolInstanceStart:ze,symbolInstanceEnd:Fe,parameters:Ce})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:E.symbolInstances.length,parameters:Ce})}attemptAnchorPlacement(c,f,g,_,E,P,R,k,z,G,q,Y,de,ce,ue,we){const Ce=[Y.textOffset0,Y.textOffset1],Oe=os(c,g,_,Ce,E),he=this.collisionIndex.placeCollisionBox(Oo(f,Oe.x,Oe.y,P,R,this.transform.angle),q,k,z,G.predicate,we);if((!ue||this.collisionIndex.placeCollisionBox(Oo(ue,Oe.x,Oe.y,P,R,this.transform.angle),q,k,z,G.predicate,we).box.length!==0)&&he.box.length>0){let ze;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID]&&this.prevPlacement.placements[Y.crossTileID].text&&(ze=this.prevPlacement.variableOffsets[Y.crossTileID].anchor),Y.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Y.crossTileID]={textOffset:Ce,width:g,height:_,anchor:c,textBoxScale:E,prevAnchor:ze},this.markUsedJustification(de,c,Y,ce),de.allowVerticalPlacement&&(this.markUsedOrientation(de,ce,Y),this.placedOrientations[Y.crossTileID]=ce),{shift:Oe,placedGlyphBoxes:he}}}placeLayerBucketPart(c,f,g){const{bucket:_,layout:E,posMatrix:P,textLabelPlaneMatrix:R,labelToScreenMatrix:k,textPixelRatio:z,holdingForFade:G,collisionBoxArray:q,partiallyEvaluatedTextSize:Y,collisionGroup:de}=c.parameters,ce=E.get("text-optional"),ue=E.get("icon-optional"),we=o.getOverlapMode(E,"text-overlap","text-allow-overlap"),Ce=we==="always",Oe=o.getOverlapMode(E,"icon-overlap","icon-allow-overlap"),he=Oe==="always",ze=E.get("text-rotation-alignment")==="map",Fe=E.get("text-pitch-alignment")==="map",He=E.get("icon-text-fit")!=="none",qe=E.get("symbol-z-order")==="viewport-y",tt=Ce&&(he||!_.hasIconData()||ue),Ge=he&&(Ce||!_.hasTextData()||ce);!_.collisionArrays&&q&&_.deserializeCollisionBoxes(q);const At=(mt,Ct)=>{if(f[mt.crossTileID])return;if(G)return void(this.placements[mt.crossTileID]=new Qr(!1,!1,!1));let sn=!1,gn=!1,Wt=!0,Kn=null,Xn={box:null,offscreen:null},kn={box:null,offscreen:null},Dn=null,Jn=null,vi=null,No=0,co=0,zo=0;Ct.textFeatureIndex?No=Ct.textFeatureIndex:mt.useRuntimeCollisionCircles&&(No=mt.featureIndex),Ct.verticalTextFeatureIndex&&(co=Ct.verticalTextFeatureIndex);const Ua=this.retainedQueryData[_.bucketInstanceId].tileID,Gs=this.terrain?(ui,xn)=>this.terrain.getElevation(Ua,ui,xn):null;for(const ui of["textBox","verticalTextBox","iconBox","verticalIconBox"]){const xn=Ct[ui];xn&&(xn.elevation=Gs?Gs(xn.anchorPointX,xn.anchorPointY):0)}const ls=Ct.textBox;if(ls){const ui=qn=>{let _i=o.WritingMode.horizontal;if(_.allowVerticalPlacement&&!qn&&this.prevPlacement){const bi=this.prevPlacement.placedOrientations[mt.crossTileID];bi&&(this.placedOrientations[mt.crossTileID]=bi,_i=bi,this.markUsedOrientation(_,_i,mt))}return _i},xn=(qn,_i)=>{if(_.allowVerticalPlacement&&mt.numVerticalGlyphVertices>0&&Ct.verticalTextBox){for(const bi of _.writingModes)if(bi===o.WritingMode.vertical?(Xn=_i(),kn=Xn):Xn=qn(),Xn&&Xn.box&&Xn.box.length)break}else Xn=qn()};if(E.get("text-variable-anchor")){let qn=E.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[mt.crossTileID]){const vr=this.prevPlacement.variableOffsets[mt.crossTileID];qn.indexOf(vr.anchor)>0&&(qn=qn.filter(Ws=>Ws!==vr.anchor),qn.unshift(vr.anchor))}const _i=(vr,Ws,bl)=>{const lm=vr.x2-vr.x1,Pc=vr.y2-vr.y1,U0=mt.textBoxScale,cm=He&&Oe==="never"?Ws:null;let Va={box:[],offscreen:!1};const xl=we!=="never"?2*qn.length:qn.length;for(let wl=0;wl<xl;++wl){const wh=this.attemptAnchorPlacement(qn[wl%qn.length],vr,lm,Pc,U0,ze,Fe,z,P,de,wl>=qn.length?we:"never",mt,_,bl,cm,Gs);if(wh&&(Va=wh.placedGlyphBoxes,Va&&Va.box&&Va.box.length)){sn=!0,Kn=wh.shift;break}}return Va};xn(()=>_i(ls,Ct.iconBox,o.WritingMode.horizontal),()=>{const vr=Ct.verticalTextBox;return _.allowVerticalPlacement&&!(Xn&&Xn.box&&Xn.box.length)&&mt.numVerticalGlyphVertices>0&&vr?_i(vr,Ct.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null}}),Xn&&(sn=Xn.box,Wt=Xn.offscreen);const bi=ui(Xn&&Xn.box);if(!sn&&this.prevPlacement){const vr=this.prevPlacement.variableOffsets[mt.crossTileID];vr&&(this.variableOffsets[mt.crossTileID]=vr,this.markUsedJustification(_,vr.anchor,mt,bi))}}else{const qn=(_i,bi)=>{const vr=this.collisionIndex.placeCollisionBox(_i,we,z,P,de.predicate,Gs);return vr&&vr.box&&vr.box.length&&(this.markUsedOrientation(_,bi,mt),this.placedOrientations[mt.crossTileID]=bi),vr};xn(()=>qn(ls,o.WritingMode.horizontal),()=>{const _i=Ct.verticalTextBox;return _.allowVerticalPlacement&&mt.numVerticalGlyphVertices>0&&_i?qn(_i,o.WritingMode.vertical):{box:null,offscreen:null}}),ui(Xn&&Xn.box&&Xn.box.length)}}if(Dn=Xn,sn=Dn&&Dn.box&&Dn.box.length>0,Wt=Dn&&Dn.offscreen,mt.useRuntimeCollisionCircles){const ui=_.text.placedSymbolArray.get(mt.centerJustifiedTextSymbolIndex),xn=o.evaluateSizeForFeature(_.textSizeData,Y,ui),qn=E.get("text-padding");Jn=this.collisionIndex.placeCollisionCircles(we,ui,_.lineVertexArray,_.glyphOffsetArray,xn,P,R,k,g,Fe,de.predicate,mt.collisionCircleDiameter,qn,Gs),Jn.circles.length&&Jn.collisionDetected&&!g&&o.warnOnce("Collisions detected, but collision boxes are not shown"),sn=Ce||Jn.circles.length>0&&!Jn.collisionDetected,Wt=Wt&&Jn.offscreen}if(Ct.iconFeatureIndex&&(zo=Ct.iconFeatureIndex),Ct.iconBox){const ui=xn=>{const qn=He&&Kn?Oo(xn,Kn.x,Kn.y,ze,Fe,this.transform.angle):xn;return this.collisionIndex.placeCollisionBox(qn,Oe,z,P,de.predicate,Gs)};kn&&kn.box&&kn.box.length&&Ct.verticalIconBox?(vi=ui(Ct.verticalIconBox),gn=vi.box.length>0):(vi=ui(Ct.iconBox),gn=vi.box.length>0),Wt=Wt&&vi.offscreen}const sa=ce||mt.numHorizontalGlyphVertices===0&&mt.numVerticalGlyphVertices===0,xh=ue||mt.numIconVertices===0;if(sa||xh?xh?sa||(gn=gn&&sn):sn=gn&&sn:gn=sn=gn&&sn,sn&&Dn&&Dn.box&&this.collisionIndex.insertCollisionBox(Dn.box,we,E.get("text-ignore-placement"),_.bucketInstanceId,kn&&kn.box&&co?co:No,de.ID),gn&&vi&&this.collisionIndex.insertCollisionBox(vi.box,Oe,E.get("icon-ignore-placement"),_.bucketInstanceId,zo,de.ID),Jn&&(sn&&this.collisionIndex.insertCollisionCircles(Jn.circles,we,E.get("text-ignore-placement"),_.bucketInstanceId,No,de.ID),g)){const ui=_.bucketInstanceId;let xn=this.collisionCircleArrays[ui];xn===void 0&&(xn=this.collisionCircleArrays[ui]=new li);for(let qn=0;qn<Jn.circles.length;qn+=4)xn.circles.push(Jn.circles[qn+0]),xn.circles.push(Jn.circles[qn+1]),xn.circles.push(Jn.circles[qn+2]),xn.circles.push(Jn.collisionDetected?1:0)}if(mt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(_.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[mt.crossTileID]=new Qr(sn||tt,gn||Ge,Wt||_.justReloaded),f[mt.crossTileID]=!0};if(qe){if(c.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const mt=_.getSortedSymbolIndexes(this.transform.angle);for(let Ct=mt.length-1;Ct>=0;--Ct){const sn=mt[Ct];At(_.symbolInstances.get(sn),_.collisionArrays[sn])}}else for(let mt=c.symbolInstanceStart;mt<c.symbolInstanceEnd;mt++)At(_.symbolInstances.get(mt),_.collisionArrays[mt]);if(g&&_.bucketInstanceId in this.collisionCircleArrays){const mt=this.collisionCircleArrays[_.bucketInstanceId];o.invert(mt.invProjMatrix,P),mt.viewportMatrix=this.collisionIndex.getViewportMatrix()}_.justReloaded=!1}markUsedJustification(c,f,g,_){let E;E=_===o.WritingMode.vertical?g.verticalPlacedTextSymbolIndex:{left:g.leftJustifiedTextSymbolIndex,center:g.centerJustifiedTextSymbolIndex,right:g.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(f)];const P=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex,g.verticalPlacedTextSymbolIndex];for(const R of P)R>=0&&(c.text.placedSymbolArray.get(R).crossTileID=E>=0&&R!==E?0:g.crossTileID)}markUsedOrientation(c,f,g){const _=f===o.WritingMode.horizontal||f===o.WritingMode.horizontalOnly?f:0,E=f===o.WritingMode.vertical?f:0,P=[g.leftJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.rightJustifiedTextSymbolIndex];for(const R of P)c.text.placedSymbolArray.get(R).placedOrientation=_;g.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(g.verticalPlacedTextSymbolIndex).placedOrientation=E)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let g=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const _=f?f.symbolFadeChange(c):1,E=f?f.opacities:{},P=f?f.variableOffsets:{},R=f?f.placedOrientations:{};for(const k in this.placements){const z=this.placements[k],G=E[k];G?(this.opacities[k]=new un(G,_,z.text,z.icon),g=g||z.text!==G.text.placed||z.icon!==G.icon.placed):(this.opacities[k]=new un(null,_,z.text,z.icon,z.skipFade),g=g||z.text||z.icon)}for(const k in E){const z=E[k];if(!this.opacities[k]){const G=new un(z,_,!1,!1);G.isHidden()||(this.opacities[k]=G,g=g||z.text.placed||z.icon.placed)}}for(const k in P)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=P[k]);for(const k in R)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=R[k]);if(f&&f.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");g?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:c)}updateLayerOpacities(c,f){const g={};for(const _ of f){const E=_.getBucket(c);E&&_.latestFeatureIndex&&c.id===E.layerIds[0]&&this.updateBucketOpacities(E,g,_.collisionBoxArray)}}updateBucketOpacities(c,f,g){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const _=c.layers[0].layout,E=new un(null,0,!1,!1,!0),P=_.get("text-allow-overlap"),R=_.get("icon-allow-overlap"),k=_.get("text-variable-anchor"),z=_.get("text-rotation-alignment")==="map",G=_.get("text-pitch-alignment")==="map",q=_.get("icon-text-fit")!=="none",Y=new un(null,0,P&&(R||!c.hasIconData()||_.get("icon-optional")),R&&(P||!c.hasTextData()||_.get("text-optional")),!0);!c.collisionArrays&&g&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(g);const de=(ce,ue,we)=>{for(let Ce=0;Ce<ue/4;Ce++)ce.opacityVertexArray.emplaceBack(we)};for(let ce=0;ce<c.symbolInstances.length;ce++){const ue=c.symbolInstances.get(ce),{numHorizontalGlyphVertices:we,numVerticalGlyphVertices:Ce,crossTileID:Oe}=ue;let he=this.opacities[Oe];f[Oe]?he=E:he||(he=Y,this.opacities[Oe]=he),f[Oe]=!0;const ze=ue.numIconVertices>0,Fe=this.placedOrientations[ue.crossTileID],He=Fe===o.WritingMode.vertical,qe=Fe===o.WritingMode.horizontal||Fe===o.WritingMode.horizontalOnly;if(we>0||Ce>0){const tt=Se(he.text);de(c.text,we,He?je:tt),de(c.text,Ce,qe?je:tt);const Ge=he.text.isHidden();[ue.rightJustifiedTextSymbolIndex,ue.centerJustifiedTextSymbolIndex,ue.leftJustifiedTextSymbolIndex].forEach(Ct=>{Ct>=0&&(c.text.placedSymbolArray.get(Ct).hidden=Ge||He?1:0)}),ue.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(ue.verticalPlacedTextSymbolIndex).hidden=Ge||qe?1:0);const At=this.variableOffsets[ue.crossTileID];At&&this.markUsedJustification(c,At.anchor,ue,Fe);const mt=this.placedOrientations[ue.crossTileID];mt&&(this.markUsedJustification(c,"left",ue,mt),this.markUsedOrientation(c,mt,ue))}if(ze){const tt=Se(he.icon),Ge=!(q&&ue.verticalPlacedIconSymbolIndex&&He);ue.placedIconSymbolIndex>=0&&(de(c.icon,ue.numIconVertices,Ge?tt:je),c.icon.placedSymbolArray.get(ue.placedIconSymbolIndex).hidden=he.icon.isHidden()),ue.verticalPlacedIconSymbolIndex>=0&&(de(c.icon,ue.numVerticalIconVertices,Ge?je:tt),c.icon.placedSymbolArray.get(ue.verticalPlacedIconSymbolIndex).hidden=he.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const tt=c.collisionArrays[ce];if(tt){let Ge=new o.pointGeometry(0,0);if(tt.textBox||tt.verticalTextBox){let mt=!0;if(k){const Ct=this.variableOffsets[Oe];Ct?(Ge=os(Ct.anchor,Ct.width,Ct.height,Ct.textOffset,Ct.textBoxScale),z&&Ge._rotate(G?this.transform.angle:-this.transform.angle)):mt=!1}tt.textBox&&V(c.textCollisionBox.collisionVertexArray,he.text.placed,!mt||He,Ge.x,Ge.y),tt.verticalTextBox&&V(c.textCollisionBox.collisionVertexArray,he.text.placed,!mt||qe,Ge.x,Ge.y)}const At=!!(!qe&&tt.verticalIconBox);tt.iconBox&&V(c.iconCollisionBox.collisionVertexArray,he.icon.placed,At,q?Ge.x:0,q?Ge.y:0),tt.verticalIconBox&&V(c.iconCollisionBox.collisionVertexArray,he.icon.placed,!At,q?Ge.x:0,q?Ge.y:0)}}}if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.text.opacityVertexArray.length!==c.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${c.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${c.text.layoutVertexArray.length}) / 4`);if(c.icon.opacityVertexArray.length!==c.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${c.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${c.icon.layoutVertexArray.length}) / 4`);if(c.bucketInstanceId in this.collisionCircleArrays){const ce=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=ce.invProjMatrix,c.placementViewportMatrix=ce.viewportMatrix,c.collisionCircleArray=ce.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,f){const g=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*g>c}setStale(){this.stale=!0}}function V(y,c,f,g,_){y.emplaceBack(c?1:0,f?1:0,g||0,_||0),y.emplaceBack(c?1:0,f?1:0,g||0,_||0),y.emplaceBack(c?1:0,f?1:0,g||0,_||0),y.emplaceBack(c?1:0,f?1:0,g||0,_||0)}const H=Math.pow(2,25),ne=Math.pow(2,24),se=Math.pow(2,17),ye=Math.pow(2,16),Ee=Math.pow(2,9),xe=Math.pow(2,8),ge=Math.pow(2,1);function Se(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const c=y.placed?1:0,f=Math.floor(127*y.opacity);return f*H+c*ne+f*se+c*ye+f*Ee+c*xe+f*ge+c}const je=0;class et{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&!c.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,f,g,_,E){const P=this._bucketParts;for(;this._currentTileIndex<c.length;)if(f.getBucketParts(P,_,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((R,k)=>R.sortKey-k.sortKey));this._currentPartIndex<P.length;)if(f.placeLayerBucketPart(P[this._currentPartIndex],this._seenCrossTileIDs,g),this._currentPartIndex++,E())return!0;return!1}}class Ve{constructor(c,f,g,_,E,P,R,k){this.placement=new ae(c,f,P,R,k),this._currentPlacementIndex=g.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=E,this._done=!1}isDone(){return this._done}continuePlacement(c,f,g){const _=o.exported.now(),E=()=>{const P=o.exported.now()-_;return!this._forceFullPlacement&&P>2};for(;this._currentPlacementIndex>=0;){const P=f[c[this._currentPlacementIndex]],R=this.placement.collisionIndex.transform.zoom;if(P.type==="symbol"&&(!P.minzoom||P.minzoom<=R)&&(!P.maxzoom||P.maxzoom>R)){if(this._inProgressLayer||(this._inProgressLayer=new et(P)),this._inProgressLayer.continuePlacement(g[P.source],this.placement,this._showCollisionBoxes,P,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const It=512/o.EXTENT/2;class Ot{constructor(c,f,g){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=g;for(let _=0;_<f.length;_++){const E=f.get(_),P=E.key;this.indexedSymbolInstances[P]||(this.indexedSymbolInstances[P]=[]),this.indexedSymbolInstances[P].push({crossTileID:E.crossTileID,coord:this.getScaledCoordinates(E,c)})}}getScaledCoordinates(c,f){const g=It/Math.pow(2,f.canonical.z-this.tileID.canonical.z);return{x:Math.floor((f.canonical.x*o.EXTENT+c.anchorX)*g),y:Math.floor((f.canonical.y*o.EXTENT+c.anchorY)*g)}}findMatches(c,f,g){const _=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z);for(let E=0;E<c.length;E++){const P=c.get(E);if(P.crossTileID)continue;const R=this.indexedSymbolInstances[P.key];if(!R)continue;const k=this.getScaledCoordinates(P,f);for(const z of R)if(Math.abs(z.coord.x-k.x)<=_&&Math.abs(z.coord.y-k.y)<=_&&!g[z.crossTileID]){g[z.crossTileID]=!0,P.crossTileID=z.crossTileID;break}}}}class xt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Gt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const f=Math.round((c-this.lng)/360);if(f!==0)for(const g in this.indexes){const _=this.indexes[g],E={};for(const P in _){const R=_[P];R.tileID=R.tileID.unwrapTo(R.tileID.wrap+f),E[R.tileID.key]=R}this.indexes[g]=E}this.lng=c}addBucket(c,f,g){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let E=0;E<f.symbolInstances.length;E++)f.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const _=this.usedCrossTileIDs[c.overscaledZ];for(const E in this.indexes){const P=this.indexes[E];if(Number(E)>c.overscaledZ)for(const R in P){const k=P[R];k.tileID.isChildOf(c)&&k.findMatches(f.symbolInstances,c,_)}else{const R=P[c.scaledTo(Number(E)).key];R&&R.findMatches(f.symbolInstances,c,_)}}for(let E=0;E<f.symbolInstances.length;E++){const P=f.symbolInstances.get(E);P.crossTileID||(P.crossTileID=g.generate(),_[P.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Ot(c,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(c,f){for(const g in f.indexedSymbolInstances)for(const _ of f.indexedSymbolInstances[g])delete this.usedCrossTileIDs[c][_.crossTileID]}removeStaleBuckets(c){let f=!1;for(const g in this.indexes){const _=this.indexes[g];for(const E in _)c[_[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,_[E]),delete _[E],f=!0)}return f}}class zt{constructor(){this.layerIndexes={},this.crossTileIDs=new xt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,f,g){let _=this.layerIndexes[c.id];_===void 0&&(_=this.layerIndexes[c.id]=new Gt);let E=!1;const P={};_.handleWrapJump(g);for(const R of f){const k=R.getBucket(c);k&&c.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(R.tileID,k,this.crossTileIDs)&&(E=!0),P[k.bucketInstanceId]=!0)}return _.removeStaleBuckets(P)&&(E=!0),E}pruneUnusedLayers(c){const f={};c.forEach(g=>{f[g]=!0});for(const g in this.layerIndexes)f[g]||delete this.layerIndexes[g]}}var pn=o.createLayout([{name:"a_pos",type:"Int16",components:2}]);class Zt extends o.Evented{constructor(c){super(),this.sourceCache=c,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.renderHistory=[],this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,this.renderHistorySize=c._cache.max,c.usedForTerrain=!0,c.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null;for(const c in this._tiles){const f=this._tiles[c];f.textures.forEach(g=>g.destroy()),f.textures=[]}}update(c,f){this.sourceCache.update(c,f),this._renderableTilesKeys=[];for(const g of c.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:f}))this._renderableTilesKeys.push(g.key),this._tiles[g.key]||(g.posMatrix=new Float64Array(16),o.ortho(g.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),this._tiles[g.key]=new ft(g,this.tileSize))}removeOutdated(c){const f={};this.renderHistory=this.renderHistory.filter((g,_)=>this.renderHistory.indexOf(g)===_).slice(0,this.renderHistorySize);for(const g of this._renderableTilesKeys)f[g]=!0;for(const g of this.renderHistory)f[g]=!0;for(const g in this._tiles)f[g]||(this._tiles[g].clearTextures(c),delete this._tiles[g])}getRenderableTiles(){return this._renderableTilesKeys.map(c=>this.getTileByID(c))}getTileByID(c){return this._tiles[c]}getTerrainCoords(c){const f={};for(const g of this._renderableTilesKeys){const _=this._tiles[g].tileID;if(_.canonical.equals(c.canonical)){const E=c.clone();E.posMatrix=new Float64Array(16),o.ortho(E.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),f[g]=E}else if(_.canonical.isChildOf(c.canonical)){const E=c.clone();E.posMatrix=new Float64Array(16);const P=_.canonical.z-c.canonical.z,R=_.canonical.x-(_.canonical.x>>P<<P),k=_.canonical.y-(_.canonical.y>>P<<P),z=o.EXTENT>>P;o.ortho(E.posMatrix,0,z,0,z,0,1),o.translate(E.posMatrix,E.posMatrix,[-R*z,-k*z,0]),f[g]=E}else if(c.canonical.isChildOf(_.canonical)){const E=c.clone();E.posMatrix=new Float64Array(16);const P=c.canonical.z-_.canonical.z,R=c.canonical.x-(c.canonical.x>>P<<P),k=c.canonical.y-(c.canonical.y>>P<<P),z=o.EXTENT>>P;o.ortho(E.posMatrix,0,o.EXTENT,0,o.EXTENT,0,1),o.translate(E.posMatrix,E.posMatrix,[R*z,k*z,0]),o.scale(E.posMatrix,E.posMatrix,[1/2**P,1/2**P,0]),f[g]=E}}return f}getSourceTile(c,f){const g=this.sourceCache._source;let _=c.overscaledZ-this.deltaZoom;if(_>g.maxzoom&&(_=g.maxzoom),_<g.minzoom)return null;this._sourceTileCache[c.key]||(this._sourceTileCache[c.key]=c.scaledTo(_).key);let E=this.sourceCache.getTileByID(this._sourceTileCache[c.key]);if((!E||!E.dem)&&f)for(;_>=g.minzoom&&(!E||!E.dem);)E=this.sourceCache.getTileByID(c.scaledTo(_--).key);return E}tilesAfterTime(c=Date.now()){return Object.values(this._tiles).filter(f=>f.timeLoaded>=c)}}class nn{constructor(c,f,g){this.style=c,this.sourceCache=new Zt(f),this.options=g,this.exaggeration=typeof g.exaggeration=="number"?g.exaggeration:1,this.elevationOffset=typeof g.elevationOffset=="number"?g.elevationOffset:450,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024,this.clearRerenderCache()}getDEMElevation(c,f,g,_=o.EXTENT){if(!(f>=0&&f<_&&g>=0&&g<_))return this.elevationOffset;let E=0;const P=this.getTerrainData(c);if(P.tile&&P.tile.dem){const R=o.transformMat4$1([],[f/_*o.EXTENT,g/_*o.EXTENT],P.u_terrain_matrix),k=[R[0]*P.tile.dem.dim,R[1]*P.tile.dem.dim],z=[Math.floor(k[0]),Math.floor(k[1])],G=P.tile.dem.get(z[0],z[1]),q=P.tile.dem.get(z[0],z[1]+1),Y=P.tile.dem.get(z[0]+1,z[1]),de=P.tile.dem.get(z[0]+1,z[1]+1);E=o.number(o.number(G,q,k[0]-z[0]),o.number(Y,de,k[0]-z[0]),k[1]-z[1])}return E}rememberForRerender(c,f){for(const g in this.sourceCache._tiles){const _=this.sourceCache._tiles[g];(_.tileID.equals(f)||_.tileID.isChildOf(f))&&(c===this.sourceCache.sourceCache.id&&(_.timeLoaded=Date.now()),this._rerender[c]=this._rerender[c]||{},this._rerender[c][_.tileID.key]=!0)}}needsRerender(c,f){return this._rerender[c]&&this._rerender[c][f.key]}clearRerenderCache(){this._rerender={}}getElevation(c,f,g,_=o.EXTENT){return(this.getDEMElevation(c,f,g,_)+this.elevationOffset)*this.exaggeration}getTerrainData(c){if(!this._emptyDemTexture){const _=this.style.map.painter.context,E=new o.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new M(_,E,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new M(_,new o.RGBAImage({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=o.identity([])}const f=this.sourceCache.getSourceTile(c,!0);if(f&&f.dem&&(!f.demTexture||f.needsTerrainPrepare)){const _=this.style.map.painter.context;f.demTexture=this.style.map.painter.getTileTexture(f.dem.stride),f.demTexture?f.demTexture.update(f.dem.getPixels(),{premultiply:!1}):f.demTexture=new M(_,f.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),f.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),f.needsTerrainPrepare=!1}const g=f&&f+f.tileID.key+c.key;if(g&&!this._demMatrixCache[g]){const _=this.sourceCache.sourceCache._source.maxzoom;let E=c.canonical.z-f.tileID.canonical.z;c.overscaledZ>c.canonical.z&&(c.canonical.z>=_?E=c.canonical.z-_:o.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const P=c.canonical.x-(c.canonical.x>>E<<E),R=c.canonical.y-(c.canonical.y>>E<<E),k=o.fromScaling(new Float64Array(16),[1/(o.EXTENT<<E),1/(o.EXTENT<<E),0]);o.translate(k,k,[P*o.EXTENT,R*o.EXTENT,0]),this._demMatrixCache[c.key]={matrix:k,coord:c}}return{u_depth:2,u_terrain:3,u_terrain_dim:f&&f.dem&&f.dem.dim||1,u_terrain_matrix:g?this._demMatrixCache[c.key].matrix:this._emptyDemMatrix,u_terrain_unpack:f&&f.dem&&f.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_offset:this.elevationOffset,u_terrain_exaggeration:this.exaggeration,texture:(f&&f.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:f}}getRTTFramebuffer(){const c=this.style.map.painter;if(!this._rttFramebuffer){const f=this.sourceCache.tileSize*this.qualityFactor;this._rttFramebuffer=c.context.createFramebuffer(f,f,!0),this._rttFramebuffer.depthAttachment.set(c.context.createRenderbuffer(c.context.gl.DEPTH_COMPONENT16,f,f))}return this._rttFramebuffer}getFramebuffer(c){const f=this.style.map.painter,g=f.width/devicePixelRatio,_=f.height/devicePixelRatio;return!this._fbo||this._fbo.width===g&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new M(f.context,{width:g,height:_,data:null},f.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(f.context.gl.NEAREST,f.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new M(f.context,{width:g,height:_,data:null},f.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(f.context.gl.NEAREST,f.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=f.context.createFramebuffer(g,_,!0),this._fbo.depthAttachment.set(f.context.createRenderbuffer(f.context.gl.DEPTH_COMPONENT16,g,_))),this._fbo.colorAttachment.set(c==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const c=this.style.map.painter.context;if(this._coordsTexture)return this._coordsTexture;const f=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let E=0,P=0;E<this._coordsTextureSize;E++)for(let R=0;R<this._coordsTextureSize;R++,P+=4)f[P+0]=255&R,f[P+1]=255&E,f[P+2]=R>>8<<4|E>>8,f[P+3]=0;const g=new o.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(f.buffer)),_=new M(c,g,c.gl.RGBA,{premultiply:!1});return _.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(c){const f=new Uint8Array(4),g=this.style.map.painter,_=g.context,E=_.gl;_.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),E.readPixels(c.x,g.height/devicePixelRatio-c.y-1,1,1,E.RGBA,E.UNSIGNED_BYTE,f),_.bindFramebuffer.set(null);const P=f[0]+(f[2]>>4<<8),R=f[1]+((15&f[2])<<8),k=this.coordsIndex[255-f[3]],z=k&&this.sourceCache.getTileByID(k);if(!z)return null;const G=this._coordsTextureSize,q=(1<<z.tileID.canonical.z)*G;return new o.MercatorCoordinate((z.tileID.canonical.x*G+P)/q,(z.tileID.canonical.y*G+R)/q,this.getElevation(z.tileID,P,R,G))}getTerrainMesh(){if(this._mesh)return this._mesh;const c=this.style.map.painter.context,f=new o.PosArray,g=new o.TriangleIndexArray,_=this.meshSize,E=o.EXTENT/_,P=_*_;for(let R=0;R<=_;R++)for(let k=0;k<=_;k++)f.emplaceBack(k*E,R*E);for(let R=0;R<P;R+=_+1)for(let k=0;k<_;k++)g.emplaceBack(k+R,_+k+R+1,_+k+R+2),g.emplaceBack(k+R,_+k+R+2,k+R+1);return this._mesh={indexBuffer:c.createIndexBuffer(g),vertexBuffer:c.createVertexBuffer(f,pn.members),segments:o.SegmentVector.simpleSegment(0,0,f.length,g.length)},this._mesh}getMinMaxElevation(c){const f=this.getTerrainData(c).tile,g={minElevation:null,maxElevation:null};return f&&f.dem&&(g.minElevation=(f.dem.min+this.elevationOffset)*this.exaggeration,g.maxElevation=(f.dem.max+this.elevationOffset)*this.exaggeration),g}}const _n=(y,c)=>o.emitValidationErrors(y,c&&c.filter(f=>f.identifier!=="source.canvas")),En=o.pick(dn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ir=o.pick(dn,["setCenter","setZoom","setBearing","setPitch"]),sr=function(){const y={},c=o.spec.$version;for(const f in o.spec.$root){const g=o.spec.$root[f];if(g.required){let _=null;_=f==="version"?c:g.type==="array"?[]:{},_!=null&&(y[f]=_)}}return y}();class ci extends o.Evented{constructor(c,f={}){super(),this.map=c,this.dispatcher=new Ae(On(),this),this.imageManager=new D,this.imageManager.setEventedParent(this),this.glyphManager=new Z(c._requestManager,f.localIdeographFontFamily),this.lineAtlas=new Te(256,512),this.crossTileSymbolIndex=new zt,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const g=this;this._rtlTextPluginCallback=ci.registerForPluginStateChange(_=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(E,P)=>{if(o.triggerPluginCompletionEvent(E),P&&P.every(R=>R))for(const R in g.sourceCaches)g.sourceCaches[R].reload()})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const E=this.sourceCaches[_.sourceId];if(!E)return;const P=E.getSource();if(P&&P.vectorLayerIds)for(const R in this._layers){const k=this._layers[R];k.source===P.id&&this._validateLayer(k)}})}loadURL(c,f={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const g=typeof f.validate!="boolean"||f.validate,_=this.map._requestManager.transformRequest(c,o.ResourceType.Style);this._request=o.getJSON(_,(E,P)=>{this._request=null,E?this.fire(new o.ErrorEvent(E)):P&&this._load(P,g)})}loadJSON(c,f={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(c,f.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(sr,!1)}_load(c,f){if(f&&_n(this,o.validateStyle(c)))return;this._loaded=!0,this.stylesheet=c;for(const _ in c.sources)this.addSource(_,c.sources[_],{validate:!1});c.sprite?this._loadSprite(c.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(c.glyphs);const g=is(this.stylesheet.layers);this._order=g.map(_=>_.id),this._layers={},this._serializedLayers={};for(let _ of g)_=o.createStyleLayer(_),_.setEventedParent(this,{layer:{id:_.id}}),this._layers[_.id]=_,this._serializedLayers[_.id]=_.serialize();this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ve(this.stylesheet.light),this.setTerrain(this.stylesheet.terrain),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}_loadSprite(c){this._spriteRequest=function(f,g,_,E){let P,R,k;const z=_>1?"@2x":"";let G=o.getJSON(g.transformRequest(g.normalizeSpriteURL(f,z,".json"),o.ResourceType.SpriteJSON),(de,ce)=>{G=null,k||(k=de,P=ce,Y())}),q=o.getImage(g.transformRequest(g.normalizeSpriteURL(f,z,".png"),o.ResourceType.SpriteImage),(de,ce)=>{q=null,k||(k=de,R=ce,Y())});function Y(){if(k)E(k);else if(P&&R){const de=o.exported.getImageData(R),ce={};for(const ue in P){const{width:we,height:Ce,x:Oe,y:he,sdf:ze,pixelRatio:Fe,stretchX:He,stretchY:qe,content:tt}=P[ue],Ge=new o.RGBAImage({width:we,height:Ce});o.RGBAImage.copy(de,Ge,{x:Oe,y:he},{x:0,y:0},{width:we,height:Ce}),ce[ue]={data:Ge,pixelRatio:Fe,sdf:ze,stretchX:He,stretchY:qe,content:tt}}E(null,ce)}}return{cancel(){G&&(G.cancel(),G=null),q&&(q.cancel(),q=null)}}}(c,this.map._requestManager,this.map.getPixelRatio(),(f,g)=>{if(this._spriteRequest=null,f)this.fire(new o.ErrorEvent(f));else if(g)for(const _ in g)this.imageManager.addImage(_,g[_]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(c){const f=this.sourceCaches[c.source];if(!f)return;const g=c.sourceLayer;if(!g)return;const _=f.getSource();(_.type==="geojson"||_.vectorLayerIds&&_.vectorLayerIds.indexOf(g)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${_.id}" as specified by style layer "${c.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const f=[];for(const g of c){const _=this._layers[g];_.type!=="custom"&&f.push(_.serialize())}return f}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(c){if(!this._loaded)return;const f=this._changed;if(this._changed){const _=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);(_.length||E.length)&&this._updateWorkerLayers(_,E);for(const P in this._updatedSources){const R=this._updatedSources[P];if(R==="reload")this._reloadSource(P);else{if(R!=="clear")throw new Error(`Invalid action ${R}`);this._clearSource(P)}}this._updateTilesForChangedImages();for(const P in this._updatedPaintProps)this._layers[P].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}const g={};for(const _ in this.sourceCaches){const E=this.sourceCaches[_];g[_]=E.used,E.used=!1}for(const _ of this._order){const E=this._layers[_];E.recalculate(c,this._availableImages),!E.isHidden(c.zoom)&&E.source&&(this.sourceCaches[E.source].used=!0)}for(const _ in g){const E=this.sourceCaches[_];g[_]!==E.used&&E.fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(c),this.z=c.zoom,f&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const f in this.sourceCaches)this.sourceCaches[f].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,f){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:f})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setTerrain(c){if(this._checkLoaded(),this._terrainDataCallback&&this.off("data",this._terrainDataCallback),this._terrainfreezeElevationCallback&&this.map.off("freezeElevation",this._terrainfreezeElevationCallback),c){const f=this.sourceCaches[c.source];if(!f)throw new Error(`cannot load terrain, because there exists no source with ID: ${c.source}`);this.terrain=new nn(this,f,c),this.map.transform.updateElevation(this.terrain),this._terrainfreezeElevationCallback=g=>{g.freeze?this.map.transform.freezeElevation=!0:(this.map.transform.freezeElevation=!1,this.map.transform.recalculateZoom(this.terrain))},this._terrainDataCallback=g=>{g.tile&&(g.sourceId===c.source?(this.map.transform.updateElevation(this.terrain),this.terrain.rememberForRerender(g.sourceId,g.tile.tileID)):g.source.type==="geojson"&&this.terrain.rememberForRerender(g.sourceId,g.tile.tileID))},this.on("data",this._terrainDataCallback),this.map.on("freezeElevation",this._terrainfreezeElevationCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.map.transform.updateElevation(this.terrain);this.map.fire(new o.Event("terrain",{terrain:c}))}setState(c){if(this._checkLoaded(),_n(this,o.validateStyle(c)))return!1;(c=o.clone$1(c)).layers=is(c.layers);const f=function(_,E){if(!_)return[{command:dn.setStyle,args:[E]}];let P=[];try{if(!x(_.version,E.version))return[{command:dn.setStyle,args:[E]}];x(_.center,E.center)||P.push({command:dn.setCenter,args:[E.center]}),x(_.zoom,E.zoom)||P.push({command:dn.setZoom,args:[E.zoom]}),x(_.bearing,E.bearing)||P.push({command:dn.setBearing,args:[E.bearing]}),x(_.pitch,E.pitch)||P.push({command:dn.setPitch,args:[E.pitch]}),x(_.sprite,E.sprite)||P.push({command:dn.setSprite,args:[E.sprite]}),x(_.glyphs,E.glyphs)||P.push({command:dn.setGlyphs,args:[E.glyphs]}),x(_.transition,E.transition)||P.push({command:dn.setTransition,args:[E.transition]}),x(_.light,E.light)||P.push({command:dn.setLight,args:[E.light]});const R={},k=[];(function(G,q,Y,de){let ce;for(ce in q=q||{},G=G||{})Object.prototype.hasOwnProperty.call(G,ce)&&(Object.prototype.hasOwnProperty.call(q,ce)||vn(ce,Y,de));for(ce in q)Object.prototype.hasOwnProperty.call(q,ce)&&(Object.prototype.hasOwnProperty.call(G,ce)?x(G[ce],q[ce])||(G[ce].type==="geojson"&&q[ce].type==="geojson"&&bs(G,q,ce)?Y.push({command:dn.setGeoJSONSourceData,args:[ce,q[ce].data]}):Nr(ce,q,Y,de)):mr(ce,q,Y))})(_.sources,E.sources,k,R);const z=[];_.layers&&_.layers.forEach(G=>{R[G.source]?P.push({command:dn.removeLayer,args:[G.id]}):z.push(G)}),P=P.concat(k),function(G,q,Y){q=q||[];const de=(G=G||[]).map(ai),ce=q.map(ai),ue=G.reduce(ko,{}),we=q.reduce(ko,{}),Ce=de.slice(),Oe=Object.create(null);let he,ze,Fe,He,qe,tt,Ge;for(he=0,ze=0;he<de.length;he++)Fe=de[he],Object.prototype.hasOwnProperty.call(we,Fe)?ze++:(Y.push({command:dn.removeLayer,args:[Fe]}),Ce.splice(Ce.indexOf(Fe,ze),1));for(he=0,ze=0;he<ce.length;he++)Fe=ce[ce.length-1-he],Ce[Ce.length-1-he]!==Fe&&(Object.prototype.hasOwnProperty.call(ue,Fe)?(Y.push({command:dn.removeLayer,args:[Fe]}),Ce.splice(Ce.lastIndexOf(Fe,Ce.length-ze),1)):ze++,tt=Ce[Ce.length-he],Y.push({command:dn.addLayer,args:[we[Fe],tt]}),Ce.splice(Ce.length-he,0,Fe),Oe[Fe]=!0);for(he=0;he<ce.length;he++)if(Fe=ce[he],He=ue[Fe],qe=we[Fe],!Oe[Fe]&&!x(He,qe))if(x(He.source,qe.source)&&x(He["source-layer"],qe["source-layer"])&&x(He.type,qe.type)){for(Ge in Cr(He.layout,qe.layout,Y,Fe,null,dn.setLayoutProperty),Cr(He.paint,qe.paint,Y,Fe,null,dn.setPaintProperty),x(He.filter,qe.filter)||Y.push({command:dn.setFilter,args:[Fe,qe.filter]}),x(He.minzoom,qe.minzoom)&&x(He.maxzoom,qe.maxzoom)||Y.push({command:dn.setLayerZoomRange,args:[Fe,qe.minzoom,qe.maxzoom]}),He)Object.prototype.hasOwnProperty.call(He,Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?Cr(He[Ge],qe[Ge],Y,Fe,Ge.slice(6),dn.setPaintProperty):x(He[Ge],qe[Ge])||Y.push({command:dn.setLayerProperty,args:[Fe,Ge,qe[Ge]]}));for(Ge in qe)Object.prototype.hasOwnProperty.call(qe,Ge)&&!Object.prototype.hasOwnProperty.call(He,Ge)&&Ge!=="layout"&&Ge!=="paint"&&Ge!=="filter"&&Ge!=="metadata"&&Ge!=="minzoom"&&Ge!=="maxzoom"&&(Ge.indexOf("paint.")===0?Cr(He[Ge],qe[Ge],Y,Fe,Ge.slice(6),dn.setPaintProperty):x(He[Ge],qe[Ge])||Y.push({command:dn.setLayerProperty,args:[Fe,Ge,qe[Ge]]}))}else Y.push({command:dn.removeLayer,args:[Fe]}),tt=Ce[Ce.lastIndexOf(Fe)+1],Y.push({command:dn.addLayer,args:[qe,tt]})}(z,E.layers,P)}catch(R){console.warn("Unable to compute style diff:",R),P=[{command:dn.setStyle,args:[E]}]}return P}(this.serialize(),c).filter(_=>!(_.command in ir));if(f.length===0)return!1;const g=f.filter(_=>!(_.command in En));if(g.length>0)throw new Error(`Unimplemented: ${g.map(_=>_.command).join(", ")}.`);return f.forEach(_=>{_.command!=="setTransition"&&this[_.command].apply(this,_.args)}),this.stylesheet=c,!0}addImage(c,f){if(this.getImage(c))return this.fire(new o.ErrorEvent(new Error(`An image named "${c}" already exists.`)));this.imageManager.addImage(c,f),this._afterImageUpdated(c)}updateImage(c,f){this.imageManager.updateImage(c,f)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new o.ErrorEvent(new Error(`An image named "${c}" does not exist.`)));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,f,g={}){if(this._checkLoaded(),this.sourceCaches[c]!==void 0)throw new Error(`Source "${c}" already exists.`);if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(o.validateStyle.source,`sources.${c}`,f,null,g))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const _=this.sourceCaches[c]=new lt(c,f,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:_.serialize(),sourceId:c})),_.onAdd(this.map),this._changed=!0}removeSource(c){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error("There is no source with this ID");for(const g in this._layers)if(this._layers[g].source===c)return this.fire(new o.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${g}" is using it.`)));const f=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],f.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),f.setEventedParent(null),f.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,f){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error(`There is no source with this ID=${c}`);const g=this.sourceCaches[c].getSource();if(g.type!=="geojson")throw new Error(`geojsonSource.type is ${g.type}, which is !== 'geojson`);g.setData(f),this._changed=!0}getSource(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()}addLayer(c,f,g={}){this._checkLoaded();const _=c.id;if(this.getLayer(_))return void this.fire(new o.ErrorEvent(new Error(`Layer "${_}" already exists on this map.`)));let E;if(c.type==="custom"){if(_n(this,o.validateCustomStyleLayer(c)))return;E=o.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(_,c.source),c=o.clone$1(c),c=o.extend(c,{source:_})),this._validate(o.validateStyle.layer,`layers.${_}`,c,{arrayIndex:-1},g))return;E=o.createStyleLayer(c),this._validateLayer(E),E.setEventedParent(this,{layer:{id:_}}),this._serializedLayers[E.id]=E.serialize()}const P=f?this._order.indexOf(f):this._order.length;if(f&&P===-1)this.fire(new o.ErrorEvent(new Error(`Cannot add layer "${_}" before non-existing layer "${f}".`)));else{if(this._order.splice(P,0,_),this._layerOrderChanged=!0,this._layers[_]=E,this._removedLayers[_]&&E.source&&E.type!=="custom"){const R=this._removedLayers[_];delete this._removedLayers[_],R.type!==E.type?this._updatedSources[E.source]="clear":(this._updatedSources[E.source]="reload",this.sourceCaches[E.source].pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map)}}moveLayer(c,f){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===f)return;const g=this._order.indexOf(c);this._order.splice(g,1);const _=f?this._order.indexOf(f):this._order.length;f&&_===-1?this.fire(new o.ErrorEvent(new Error(`Cannot move layer "${c}" before non-existing layer "${f}".`))):(this._order.splice(_,0,c),this._layerOrderChanged=!0)}removeLayer(c){this._checkLoaded();const f=this._layers[c];if(!f)return void this.fire(new o.ErrorEvent(new Error(`Cannot remove non-existing layer "${c}".`)));f.setEventedParent(null);const g=this._order.indexOf(c);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=f,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],f.onRemove&&f.onRemove(this.map)}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}setLayerZoomRange(c,f,g){this._checkLoaded();const _=this.getLayer(c);_?_.minzoom===f&&_.maxzoom===g||(f!=null&&(_.minzoom=f),g!=null&&(_.maxzoom=g),this._updateLayer(_)):this.fire(new o.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${c}".`)))}setFilter(c,f,g={}){this._checkLoaded();const _=this.getLayer(c);if(_){if(!x(_.filter,f))return f==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(o.validateStyle.filter,`layers.${_.id}.filter`,f,null,g)||(_.filter=o.clone$1(f),this._updateLayer(_)))}else this.fire(new o.ErrorEvent(new Error(`Cannot filter non-existing layer "${c}".`)))}getFilter(c){return o.clone$1(this.getLayer(c).filter)}setLayoutProperty(c,f,g,_={}){this._checkLoaded();const E=this.getLayer(c);E?x(E.getLayoutProperty(f),g)||(E.setLayoutProperty(f,g,_),this._updateLayer(E)):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getLayoutProperty(c,f){const g=this.getLayer(c);if(g)return g.getLayoutProperty(f);this.fire(new o.ErrorEvent(new Error(`Cannot get style of non-existing layer "${c}".`)))}setPaintProperty(c,f,g,_={}){this._checkLoaded();const E=this.getLayer(c);E?x(E.getPaintProperty(f),g)||(E.setPaintProperty(f,g,_)&&this._updateLayer(E),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new o.ErrorEvent(new Error(`Cannot style non-existing layer "${c}".`)))}getPaintProperty(c,f){return this.getLayer(c).getPaintProperty(f)}setFeatureState(c,f){this._checkLoaded();const g=c.source,_=c.sourceLayer,E=this.sourceCaches[g];if(E===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const P=E.getSource().type;P==="geojson"&&_?this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):P!=="vector"||_?(c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),E.setFeatureState(_,c.id,f)):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(c,f){this._checkLoaded();const g=c.source,_=this.sourceCaches[g];if(_===void 0)return void this.fire(new o.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const E=_.getSource().type,P=E==="vector"?c.sourceLayer:void 0;E!=="vector"||P?f&&typeof c.id!="string"&&typeof c.id!="number"?this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(P,c.id,f):this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(c){this._checkLoaded();const f=c.source,g=c.sourceLayer,_=this.sourceCaches[f];if(_!==void 0)return _.getSource().type!=="vector"||g?(c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),_.getFeatureState(g,c.id)):void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new o.ErrorEvent(new Error(`The source '${f}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:o.mapObject(this.sourceCaches,c=>c.serialize()),layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&this.sourceCaches[c.source].getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._changed=!0}_flattenAndSortRenderedFeatures(c){const f=P=>this._layers[P].type==="fill-extrusion",g={},_=[];for(let P=this._order.length-1;P>=0;P--){const R=this._order[P];if(f(R)){g[R]=P;for(const k of c){const z=k[R];if(z)for(const G of z)_.push(G)}}}_.sort((P,R)=>R.intersectionZ-P.intersectionZ);const E=[];for(let P=this._order.length-1;P>=0;P--){const R=this._order[P];if(f(R))for(let k=_.length-1;k>=0;k--){const z=_[k].feature;if(g[z.layer.id]<P)break;E.push(z),_.pop()}else for(const k of c){const z=k[R];if(z)for(const G of z)E.push(G.feature)}}return E}queryRenderedFeatures(c,f,g){f&&f.filter&&this._validate(o.validateStyle.filter,"queryRenderedFeatures.filter",f.filter,null,f);const _={};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const P of f.layers){const R=this._layers[P];if(!R)return this.fire(new o.ErrorEvent(new Error(`The layer '${P}' does not exist in the map's style and cannot be queried for features.`))),[];_[R.source]=!0}}const E=[];f.availableImages=this._availableImages;for(const P in this.sourceCaches)f.layers&&!_[P]||E.push(Je(this.sourceCaches[P],this._layers,this._serializedLayers,c,f,g));return this.placement&&E.push(function(P,R,k,z,G,q,Y){const de={},ce=q.queryRenderedSymbols(z),ue=[];for(const we of Object.keys(ce).map(Number))ue.push(Y[we]);ue.sort(kt);for(const we of ue){const Ce=we.featureIndex.lookupSymbolFeatures(ce[we.bucketInstanceId],R,we.bucketIndex,we.sourceLayerIndex,G.filter,G.layers,G.availableImages,P);for(const Oe in Ce){const he=de[Oe]=de[Oe]||[],ze=Ce[Oe];ze.sort((Fe,He)=>{const qe=we.featureSortOrder;if(qe){const tt=qe.indexOf(Fe.featureIndex);return qe.indexOf(He.featureIndex)-tt}return He.featureIndex-Fe.featureIndex});for(const Fe of ze)he.push(Fe)}}for(const we in de)de[we].forEach(Ce=>{const Oe=Ce.feature,he=k[P[we].source].getFeatureState(Oe.layer["source-layer"],Oe.id);Oe.source=Oe.layer.source,Oe.layer["source-layer"]&&(Oe.sourceLayer=Oe.layer["source-layer"]),Oe.state=he});return de}(this._layers,this._serializedLayers,this.sourceCaches,c,f,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(E)}querySourceFeatures(c,f){f&&f.filter&&this._validate(o.validateStyle.filter,"querySourceFeatures.filter",f.filter,null,f);const g=this.sourceCaches[c];return g?function(_,E){const P=_.getRenderableIds().map(z=>_.getTileByID(z)),R=[],k={};for(let z=0;z<P.length;z++){const G=P[z],q=G.tileID.canonical.key;k[q]||(k[q]=!0,G.querySourceFeatures(R,E))}return R}(g,f):[]}addSourceType(c,f,g){return ci.getSourceType(c)?g(new Error(`A source type called "${c}" already exists.`)):(ci.setSourceType(c,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:f.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(c,f={}){this._checkLoaded();const g=this.light.getLight();let _=!1;for(const P in c)if(!x(c[P],g[P])){_=!0;break}if(!_)return;const E={now:o.exported.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,f),this.light.updateTransitions(E)}_validate(c,f,g,_,E={}){return(!E||E.validate!==!1)&&_n(this,c.call(o.validateStyle,o.extend({key:f,style:this.serialize(),value:g,styleSpec:o.spec},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this.sourceCaches){const f=this.sourceCaches[c];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){this.sourceCaches[c].clearTiles()}_reloadSource(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()}_updateSources(c){for(const f in this.sourceCaches)this.sourceCaches[f].update(c,this.terrain)}_generateCollisionBoxes(){for(const c in this.sourceCaches)this._reloadSource(c)}_updatePlacement(c,f,g,_,E=!1){let P=!1,R=!1;const k={};for(const z of this._order){const G=this._layers[z];if(G.type!=="symbol")continue;if(!k[G.source]){const Y=this.sourceCaches[G.source];k[G.source]=Y.getRenderableIds(!0).map(de=>Y.getTileByID(de)).sort((de,ce)=>ce.tileID.overscaledZ-de.tileID.overscaledZ||(de.tileID.isLessThan(ce.tileID)?-1:1))}const q=this.crossTileSymbolIndex.addLayer(G,k[G.source],c.center.lng);P=P||q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((E=E||this._layerOrderChanged||g===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),c.zoom))&&(this.pauseablePlacement=new Ve(c,this.terrain,this._order,E,f,g,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),R=!0),P&&this.pauseablePlacement.placement.setStale()),R||P)for(const z of this._order){const G=this._layers[z];G.type==="symbol"&&this.placement.updateLayerOpacities(G,k[G.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,f,g){this.imageManager.getImages(f.icons,g),this._updateTilesForChangedImages();const _=this.sourceCaches[f.source];_&&_.setDependencies(f.tileID.key,f.type,f.icons)}getGlyphs(c,f,g){this.glyphManager.getGlyphs(f.stacks,g)}getResource(c,f,g){return o.makeRequest(f,g)}}ci.getSourceType=function(y){return Re[y]},ci.setSourceType=function(y,c){Re[y]=c},ci.registerForPluginStateChange=o.registerForPluginStateChange;var oo="attribute vec2 a_pos;uniform mat4 u_matrix;varying vec2 v_texture_pos;varying float v_depth;void main() {v_texture_pos=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);v_depth=gl_Position.z/gl_Position.w;}";const Ci={prelude:zn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_offset;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return (elevation+u_terrain_offset)*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:zn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:zn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:zn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:zn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:zn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:zn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:zn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:zn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:zn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:zn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:zn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:zn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:zn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:zn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float baseDelta=10.0;float ele=get_elevation(a_centroid);
#else
float baseDelta=0.0;float ele=0.0;
#endif
base=max(0.0,ele+base-baseDelta);height=max(0.0,ele+height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:zn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:zn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:zn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:zn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:zn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:zn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:zn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:zn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:zn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:zn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",oo),terrainDepth:zn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",oo),terrainCoords:zn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",oo)};function zn(y,c){const f=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=c.match(/attribute ([\w]+) ([\w]+)/g),_=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=E?E.concat(_):_,R={};return{fragmentSource:y=y.replace(f,(k,z,G,q,Y)=>(R[Y]=!0,z==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
varying ${G} ${q} ${Y};
#else
uniform ${G} ${q} u_${Y};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Y}
    ${G} ${q} ${Y} = u_${Y};
#endif
`)),vertexSource:c=c.replace(f,(k,z,G,q,Y)=>{const de=q==="float"?"vec2":"vec4",ce=Y.match(/color/)?"color":de;return R[Y]?z==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${G} ${de} a_${Y};
varying ${G} ${q} ${Y};
#else
uniform ${G} ${q} u_${Y};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = a_${Y};
#else
    ${G} ${q} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${Y} = unpack_mix_${ce}(a_${Y}, u_${Y}_t);
#else
    ${G} ${q} ${Y} = u_${Y};
#endif
`:z==="define"?`
#ifndef HAS_UNIFORM_u_${Y}
uniform lowp float u_${Y}_t;
attribute ${G} ${de} a_${Y};
#else
uniform ${G} ${q} u_${Y};
#endif
`:ce==="vec4"?`
#ifndef HAS_UNIFORM_u_${Y}
    ${G} ${q} ${Y} = a_${Y};
#else
    ${G} ${q} ${Y} = u_${Y};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Y}
    ${G} ${q} ${Y} = unpack_mix_${ce}(a_${Y}, u_${Y}_t);
#else
    ${G} ${q} ${Y} = u_${Y};
#endif
`}),staticAttributes:g,staticUniforms:P}}class pl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,f,g,_,E,P,R,k,z){this.context=c;let G=this.boundPaintVertexBuffers.length!==_.length;for(let q=0;!G&&q<_.length;q++)this.boundPaintVertexBuffers[q]!==_[q]&&(G=!0);c.extVertexArrayObject&&this.vao&&this.boundProgram===f&&this.boundLayoutVertexBuffer===g&&!G&&this.boundIndexBuffer===E&&this.boundVertexOffset===P&&this.boundDynamicVertexBuffer===R&&this.boundDynamicVertexBuffer2===k&&this.boundDynamicVertexBuffer3===z?(c.bindVertexArrayOES.set(this.vao),R&&R.bind(),E&&E.dynamicDraw&&E.bind(),k&&k.bind(),z&&z.bind()):this.freshBind(f,g,_,E,P,R,k,z)}freshBind(c,f,g,_,E,P,R,k){let z;const G=c.numAttributes,q=this.context,Y=q.gl;if(q.extVertexArrayObject)this.vao&&this.destroy(),this.vao=q.extVertexArrayObject.createVertexArrayOES(),q.bindVertexArrayOES.set(this.vao),z=0,this.boundProgram=c,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=_,this.boundVertexOffset=E,this.boundDynamicVertexBuffer=P,this.boundDynamicVertexBuffer2=R,this.boundDynamicVertexBuffer3=k;else{z=q.currentNumAttributes||0;for(let de=G;de<z;de++)Y.disableVertexAttribArray(de)}f.enableAttributes(Y,c);for(const de of g)de.enableAttributes(Y,c);P&&P.enableAttributes(Y,c),R&&R.enableAttributes(Y,c),k&&k.enableAttributes(Y,c),f.bind(),f.setVertexAttribPointers(Y,c,E);for(const de of g)de.bind(),de.setVertexAttribPointers(Y,c,E);P&&(P.bind(),P.setVertexAttribPointers(Y,c,E)),_&&_.bind(),R&&(R.bind(),R.setVertexAttribPointers(Y,c,E)),k&&(k.bind(),k.setVertexAttribPointers(Y,c,E)),q.currentNumAttributes=G}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function ml(y){const c=[];for(let f=0;f<y.length;f++){if(y[f]===null)continue;const g=y[f].split(" ");c.push(g.pop())}return c}class fc{constructor(c,f,g,_,E,P,R){const k=c.gl;this.program=k.createProgram();const z=ml(g.staticAttributes),G=_?_.getBinderAttributes():[],q=z.concat(G),Y=Ci.prelude.staticUniforms?ml(Ci.prelude.staticUniforms):[],de=g.staticUniforms?ml(g.staticUniforms):[],ce=_?_.getBinderUniforms():[],ue=Y.concat(de).concat(ce),we=[];for(const qe of ue)we.indexOf(qe)<0&&we.push(qe);const Ce=_?_.defines():[];P&&Ce.push("#define OVERDRAW_INSPECTOR;"),R&&Ce.push("#define TERRAIN3D;");const Oe=Ce.concat(Ci.prelude.fragmentSource,g.fragmentSource).join(`
`),he=Ce.concat(Ci.prelude.vertexSource,g.vertexSource).join(`
`),ze=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(ze,Oe),k.compileShader(ze),k.attachShader(this.program,ze);const Fe=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(Fe,he),k.compileShader(Fe),k.attachShader(this.program,Fe),this.attributes={};const He={};this.numAttributes=q.length;for(let qe=0;qe<this.numAttributes;qe++)q[qe]&&(k.bindAttribLocation(this.program,qe,q[qe]),this.attributes[q[qe]]=qe);k.linkProgram(this.program),k.deleteShader(Fe),k.deleteShader(ze);for(let qe=0;qe<we.length;qe++){const tt=we[qe];if(tt&&!He[tt]){const Ge=k.getUniformLocation(this.program,tt);Ge&&(He[tt]=Ge)}}this.fixedUniforms=E(c,He),this.terrainUniforms=((qe,tt)=>({u_depth:new o.Uniform1i(qe,tt.u_depth),u_terrain:new o.Uniform1i(qe,tt.u_terrain),u_terrain_dim:new o.Uniform1f(qe,tt.u_terrain_dim),u_terrain_matrix:new o.UniformMatrix4f(qe,tt.u_terrain_matrix),u_terrain_unpack:new o.Uniform4f(qe,tt.u_terrain_unpack),u_terrain_offset:new o.Uniform1f(qe,tt.u_terrain_offset),u_terrain_exaggeration:new o.Uniform1f(qe,tt.u_terrain_exaggeration)}))(c,He),this.binderUniforms=_?_.getUniforms(c,He):[]}draw(c,f,g,_,E,P,R,k,z,G,q,Y,de,ce,ue,we,Ce,Oe){const he=c.gl;if(this.failedToCreate)return;if(c.program.set(this.program),c.setDepthMode(g),c.setStencilMode(_),c.setColorMode(E),c.setCullFace(P),k){c.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,k.depthTexture),c.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,k.texture);for(const Fe in this.terrainUniforms)this.terrainUniforms[Fe].set(k[Fe])}for(const Fe in this.fixedUniforms)this.fixedUniforms[Fe].set(R[Fe]);ue&&ue.setUniforms(c,this.binderUniforms,de,{zoom:ce});let ze=0;switch(f){case he.LINES:ze=2;break;case he.TRIANGLES:ze=3;break;case he.LINE_STRIP:ze=1}for(const Fe of Y.get()){const He=Fe.vaos||(Fe.vaos={});(He[z]||(He[z]=new pl)).bind(c,this,G,ue?ue.getPaintVertexBuffers():[],q,Fe.vertexOffset,we,Ce,Oe),he.drawElements(f,Fe.primitiveLength*ze,he.UNSIGNED_SHORT,Fe.primitiveOffset*ze*2)}}}function pc(y,c,f){const g=1/Mn(f,1,c.transform.tileZoom),_=Math.pow(2,f.tileID.overscaledZ),E=f.tileSize*Math.pow(2,c.transform.tileZoom)/_,P=E*(f.tileID.canonical.x+f.tileID.wrap*_),R=E*f.tileID.canonical.y;return{u_image:0,u_texsize:f.imageAtlasTexture.size,u_scale:[g,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[P>>16,R>>16],u_pixel_coord_lower:[65535&P,65535&R]}}const ka=(y,c,f,g)=>{const _=c.style.light,E=_.properties.get("position"),P=[E.x,E.y,E.z],R=o.create$1();_.properties.get("anchor")==="viewport"&&o.fromRotation(R,-c.transform.angle),o.transformMat3(P,P,R);const k=_.properties.get("color");return{u_matrix:y,u_lightpos:P,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+f,u_opacity:g}},ao=(y,c,f,g,_,E,P)=>o.extend(ka(y,c,f,g),pc(E,c,P),{u_height_factor:-Math.pow(2,_.overscaledZ)/P.tileSize/8}),mc=y=>({u_matrix:y}),gc=(y,c,f,g)=>o.extend(mc(y),pc(f,c,g)),yc=(y,c)=>({u_matrix:y,u_world:c}),Lu=(y,c,f,g,_)=>o.extend(gc(y,c,f,g),{u_world:_}),sh=(y,c,f,g)=>{const _=y.transform;let E,P;if(g.paint.get("circle-pitch-alignment")==="map"){const R=Mn(f,1,_.zoom);E=!0,P=[R,R]}else E=!1,P=_.pixelsToGLUnits;return{u_camera_to_center_distance:_.cameraToCenterDistance,u_scale_with_map:+(g.paint.get("circle-pitch-scale")==="map"),u_matrix:y.translatePosMatrix(c.posMatrix,f,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_pitch_with_map:+E,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:P}},na=(y,c,f)=>{const g=Mn(f,1,c.zoom),_=Math.pow(2,c.zoom-f.tileID.overscaledZ),E=f.tileID.overscaleFactor();return{u_matrix:y,u_camera_to_center_distance:c.cameraToCenterDistance,u_pixels_to_tile_units:g,u_extrude_scale:[c.pixelsToGLUnits[0]/(g*_),c.pixelsToGLUnits[1]/(g*_)],u_overscale_factor:E}},J=(y,c,f=1)=>({u_matrix:y,u_color:c,u_overlay:0,u_overlay_scale:f}),oe=y=>({u_matrix:y}),be=(y,c,f,g)=>({u_matrix:y,u_extrude_scale:Mn(c,1,f),u_intensity:g});function Ue(y,c){const f=Math.pow(2,c.canonical.z),g=c.canonical.y;return[new o.MercatorCoordinate(0,g/f).toLngLat().lat,new o.MercatorCoordinate(0,(g+1)/f).toLngLat().lat]}const rt=(y,c,f,g)=>{const _=y.transform;return{u_matrix:Gr(y,c,f,g),u_ratio:1/Mn(c,1,_.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},$t=(y,c,f,g,_)=>o.extend(rt(y,c,f,_),{u_image:0,u_image_height:g}),bn=(y,c,f,g,_)=>{const E=y.transform,P=mn(c,E);return{u_matrix:Gr(y,c,f,_),u_texsize:c.imageAtlasTexture.size,u_ratio:1/Mn(c,1,E.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[P,g.fromScale,g.toScale],u_fade:g.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},xr=(y,c,f,g,_,E)=>{const P=y.lineAtlas,R=mn(c,y.transform),k=f.layout.get("line-cap")==="round",z=P.getDash(g.from,k),G=P.getDash(g.to,k),q=z.width*_.fromScale,Y=G.width*_.toScale;return o.extend(rt(y,c,f,E),{u_patternscale_a:[R/q,-z.height/2],u_patternscale_b:[R/Y,-G.height/2],u_sdfgamma:P.width/(256*Math.min(q,Y)*y.pixelRatio)/2,u_image:0,u_tex_y_a:z.y,u_tex_y_b:G.y,u_mix:_.t})};function mn(y,c){return 1/Mn(y,1,c.tileZoom)}function Gr(y,c,f,g){return y.translatePosMatrix(g?g.posMatrix:c.tileID.posMatrix,c,f.paint.get("line-translate"),f.paint.get("line-translate-anchor"))}const xs=(y,c,f,g,_)=>{return{u_matrix:y,u_tl_parent:c,u_scale_parent:f,u_buffer_scale:1,u_fade_t:g.mix,u_opacity:g.opacity*_.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:_.paint.get("raster-brightness-min"),u_brightness_high:_.paint.get("raster-brightness-max"),u_saturation_factor:(P=_.paint.get("raster-saturation"),P>0?1-1/(1.001-P):-P),u_contrast_factor:(E=_.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:c0(_.paint.get("raster-hue-rotate"))};var E,P};function c0(y){y*=Math.PI/180;const c=Math.sin(y),f=Math.cos(y);return[(2*f+1)/3,(-Math.sqrt(3)*c-f+1)/3,(Math.sqrt(3)*c-f+1)/3]}const Op=(y,c,f,g,_,E,P,R,k,z)=>{const G=_.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+f,u_aspect_ratio:G.width/G.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:P,u_coord_matrix:R,u_is_text:+k,u_pitch_with_map:+g,u_texsize:z,u_texture:0}},oh=(y,c,f,g,_,E,P,R,k,z,G)=>{const q=_.transform;return o.extend(Op(y,c,f,g,_,E,P,R,k,z),{u_gamma_scale:g?Math.cos(q._pitch)*q.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:+G})},u0=(y,c,f,g,_,E,P,R,k,z)=>o.extend(oh(y,c,f,g,_,E,P,R,!0,k,!0),{u_texsize_icon:z,u_texture_icon:1}),Bx=(y,c,f)=>({u_matrix:y,u_opacity:c,u_color:f}),Ux=(y,c,f,g,_,E)=>o.extend(function(P,R,k,z){const G=k.imageManager.getPattern(P.from.toString()),q=k.imageManager.getPattern(P.to.toString()),{width:Y,height:de}=k.imageManager.getPixelSize(),ce=Math.pow(2,z.tileID.overscaledZ),ue=z.tileSize*Math.pow(2,k.transform.tileZoom)/ce,we=ue*(z.tileID.canonical.x+z.tileID.wrap*ce),Ce=ue*z.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:G.tl,u_pattern_br_a:G.br,u_pattern_tl_b:q.tl,u_pattern_br_b:q.br,u_texsize:[Y,de],u_mix:R.t,u_pattern_size_a:G.displaySize,u_pattern_size_b:q.displaySize,u_scale_a:R.fromScale,u_scale_b:R.toScale,u_tile_units_to_pixels:1/Mn(z,1,k.transform.tileZoom),u_pixel_coord_upper:[we>>16,Ce>>16],u_pixel_coord_lower:[65535&we,65535&Ce]}}(g,E,f,_),{u_matrix:y,u_opacity:c}),Dp={fillExtrusion:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_lightpos:new o.Uniform3f(y,c.u_lightpos),u_lightintensity:new o.Uniform1f(y,c.u_lightintensity),u_lightcolor:new o.Uniform3f(y,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(y,c.u_vertical_gradient),u_opacity:new o.Uniform1f(y,c.u_opacity)}),fillExtrusionPattern:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_lightpos:new o.Uniform3f(y,c.u_lightpos),u_lightintensity:new o.Uniform1f(y,c.u_lightintensity),u_lightcolor:new o.Uniform3f(y,c.u_lightcolor),u_vertical_gradient:new o.Uniform1f(y,c.u_vertical_gradient),u_height_factor:new o.Uniform1f(y,c.u_height_factor),u_image:new o.Uniform1i(y,c.u_image),u_texsize:new o.Uniform2f(y,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,c.u_scale),u_fade:new o.Uniform1f(y,c.u_fade),u_opacity:new o.Uniform1f(y,c.u_opacity)}),fill:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix)}),fillPattern:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_image:new o.Uniform1i(y,c.u_image),u_texsize:new o.Uniform2f(y,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,c.u_scale),u_fade:new o.Uniform1f(y,c.u_fade)}),fillOutline:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_world:new o.Uniform2f(y,c.u_world)}),fillOutlinePattern:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_world:new o.Uniform2f(y,c.u_world),u_image:new o.Uniform1i(y,c.u_image),u_texsize:new o.Uniform2f(y,c.u_texsize),u_pixel_coord_upper:new o.Uniform2f(y,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,c.u_pixel_coord_lower),u_scale:new o.Uniform3f(y,c.u_scale),u_fade:new o.Uniform1f(y,c.u_fade)}),circle:(y,c)=>({u_camera_to_center_distance:new o.Uniform1f(y,c.u_camera_to_center_distance),u_scale_with_map:new o.Uniform1i(y,c.u_scale_with_map),u_pitch_with_map:new o.Uniform1i(y,c.u_pitch_with_map),u_extrude_scale:new o.Uniform2f(y,c.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(y,c.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(y,c.u_matrix)}),collisionBox:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_camera_to_center_distance:new o.Uniform1f(y,c.u_camera_to_center_distance),u_pixels_to_tile_units:new o.Uniform1f(y,c.u_pixels_to_tile_units),u_extrude_scale:new o.Uniform2f(y,c.u_extrude_scale),u_overscale_factor:new o.Uniform1f(y,c.u_overscale_factor)}),collisionCircle:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_inv_matrix:new o.UniformMatrix4f(y,c.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(y,c.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(y,c.u_viewport_size)}),debug:(y,c)=>({u_color:new o.UniformColor(y,c.u_color),u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_overlay:new o.Uniform1i(y,c.u_overlay),u_overlay_scale:new o.Uniform1f(y,c.u_overlay_scale)}),clippingMask:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix)}),heatmap:(y,c)=>({u_extrude_scale:new o.Uniform1f(y,c.u_extrude_scale),u_intensity:new o.Uniform1f(y,c.u_intensity),u_matrix:new o.UniformMatrix4f(y,c.u_matrix)}),heatmapTexture:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_world:new o.Uniform2f(y,c.u_world),u_image:new o.Uniform1i(y,c.u_image),u_color_ramp:new o.Uniform1i(y,c.u_color_ramp),u_opacity:new o.Uniform1f(y,c.u_opacity)}),hillshade:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_image:new o.Uniform1i(y,c.u_image),u_latrange:new o.Uniform2f(y,c.u_latrange),u_light:new o.Uniform2f(y,c.u_light),u_shadow:new o.UniformColor(y,c.u_shadow),u_highlight:new o.UniformColor(y,c.u_highlight),u_accent:new o.UniformColor(y,c.u_accent)}),hillshadePrepare:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_image:new o.Uniform1i(y,c.u_image),u_dimension:new o.Uniform2f(y,c.u_dimension),u_zoom:new o.Uniform1f(y,c.u_zoom),u_unpack:new o.Uniform4f(y,c.u_unpack)}),line:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_ratio:new o.Uniform1f(y,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,c.u_units_to_pixels)}),lineGradient:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_ratio:new o.Uniform1f(y,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,c.u_units_to_pixels),u_image:new o.Uniform1i(y,c.u_image),u_image_height:new o.Uniform1f(y,c.u_image_height)}),linePattern:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_texsize:new o.Uniform2f(y,c.u_texsize),u_ratio:new o.Uniform1f(y,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,c.u_device_pixel_ratio),u_image:new o.Uniform1i(y,c.u_image),u_units_to_pixels:new o.Uniform2f(y,c.u_units_to_pixels),u_scale:new o.Uniform3f(y,c.u_scale),u_fade:new o.Uniform1f(y,c.u_fade)}),lineSDF:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_ratio:new o.Uniform1f(y,c.u_ratio),u_device_pixel_ratio:new o.Uniform1f(y,c.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(y,c.u_units_to_pixels),u_patternscale_a:new o.Uniform2f(y,c.u_patternscale_a),u_patternscale_b:new o.Uniform2f(y,c.u_patternscale_b),u_sdfgamma:new o.Uniform1f(y,c.u_sdfgamma),u_image:new o.Uniform1i(y,c.u_image),u_tex_y_a:new o.Uniform1f(y,c.u_tex_y_a),u_tex_y_b:new o.Uniform1f(y,c.u_tex_y_b),u_mix:new o.Uniform1f(y,c.u_mix)}),raster:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_tl_parent:new o.Uniform2f(y,c.u_tl_parent),u_scale_parent:new o.Uniform1f(y,c.u_scale_parent),u_buffer_scale:new o.Uniform1f(y,c.u_buffer_scale),u_fade_t:new o.Uniform1f(y,c.u_fade_t),u_opacity:new o.Uniform1f(y,c.u_opacity),u_image0:new o.Uniform1i(y,c.u_image0),u_image1:new o.Uniform1i(y,c.u_image1),u_brightness_low:new o.Uniform1f(y,c.u_brightness_low),u_brightness_high:new o.Uniform1f(y,c.u_brightness_high),u_saturation_factor:new o.Uniform1f(y,c.u_saturation_factor),u_contrast_factor:new o.Uniform1f(y,c.u_contrast_factor),u_spin_weights:new o.Uniform3f(y,c.u_spin_weights)}),symbolIcon:(y,c)=>({u_is_size_zoom_constant:new o.Uniform1i(y,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,c.u_size_t),u_size:new o.Uniform1f(y,c.u_size),u_camera_to_center_distance:new o.Uniform1f(y,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,c.u_pitch),u_rotate_symbol:new o.Uniform1i(y,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,c.u_fade_change),u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,c.u_coord_matrix),u_is_text:new o.Uniform1i(y,c.u_is_text),u_pitch_with_map:new o.Uniform1i(y,c.u_pitch_with_map),u_texsize:new o.Uniform2f(y,c.u_texsize),u_texture:new o.Uniform1i(y,c.u_texture)}),symbolSDF:(y,c)=>({u_is_size_zoom_constant:new o.Uniform1i(y,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,c.u_size_t),u_size:new o.Uniform1f(y,c.u_size),u_camera_to_center_distance:new o.Uniform1f(y,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,c.u_pitch),u_rotate_symbol:new o.Uniform1i(y,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,c.u_fade_change),u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,c.u_coord_matrix),u_is_text:new o.Uniform1i(y,c.u_is_text),u_pitch_with_map:new o.Uniform1i(y,c.u_pitch_with_map),u_texsize:new o.Uniform2f(y,c.u_texsize),u_texture:new o.Uniform1i(y,c.u_texture),u_gamma_scale:new o.Uniform1f(y,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(y,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(y,c.u_is_halo)}),symbolTextAndIcon:(y,c)=>({u_is_size_zoom_constant:new o.Uniform1i(y,c.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(y,c.u_is_size_feature_constant),u_size_t:new o.Uniform1f(y,c.u_size_t),u_size:new o.Uniform1f(y,c.u_size),u_camera_to_center_distance:new o.Uniform1f(y,c.u_camera_to_center_distance),u_pitch:new o.Uniform1f(y,c.u_pitch),u_rotate_symbol:new o.Uniform1i(y,c.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(y,c.u_aspect_ratio),u_fade_change:new o.Uniform1f(y,c.u_fade_change),u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(y,c.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(y,c.u_coord_matrix),u_is_text:new o.Uniform1i(y,c.u_is_text),u_pitch_with_map:new o.Uniform1i(y,c.u_pitch_with_map),u_texsize:new o.Uniform2f(y,c.u_texsize),u_texsize_icon:new o.Uniform2f(y,c.u_texsize_icon),u_texture:new o.Uniform1i(y,c.u_texture),u_texture_icon:new o.Uniform1i(y,c.u_texture_icon),u_gamma_scale:new o.Uniform1f(y,c.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(y,c.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(y,c.u_is_halo)}),background:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_opacity:new o.Uniform1f(y,c.u_opacity),u_color:new o.UniformColor(y,c.u_color)}),backgroundPattern:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_opacity:new o.Uniform1f(y,c.u_opacity),u_image:new o.Uniform1i(y,c.u_image),u_pattern_tl_a:new o.Uniform2f(y,c.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(y,c.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(y,c.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(y,c.u_pattern_br_b),u_texsize:new o.Uniform2f(y,c.u_texsize),u_mix:new o.Uniform1f(y,c.u_mix),u_pattern_size_a:new o.Uniform2f(y,c.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(y,c.u_pattern_size_b),u_scale_a:new o.Uniform1f(y,c.u_scale_a),u_scale_b:new o.Uniform1f(y,c.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(y,c.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(y,c.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(y,c.u_tile_units_to_pixels)}),terrain:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_texture:new o.Uniform1i(y,c.u_texture)}),terrainDepth:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix)}),terrainCoords:(y,c)=>({u_matrix:new o.UniformMatrix4f(y,c.u_matrix),u_texture:new o.Uniform1i(y,c.u_texture),u_terrain_coords_id:new o.Uniform1f(y,c.u_terrain_coords_id)})};class Fp{constructor(c,f,g){this.context=c;const _=c.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const f=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Np={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class zp{constructor(c,f,g,_){this.length=f.length,this.attributes=g,this.itemSize=f.bytesPerElement,this.dynamicDraw=_,this.context=c;const E=c.gl;this.buffer=E.createBuffer(),c.bindVertexBuffer.set(this.buffer),E.bufferData(E.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete f.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){if(c.length!==this.length)throw new Error(`Length of new data is ${c.length}, which doesn't match current length of ${this.length}`);const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,f){for(let g=0;g<this.attributes.length;g++){const _=f.attributes[this.attributes[g].name];_!==void 0&&c.enableVertexAttribArray(_)}}setVertexAttribPointers(c,f,g){for(let _=0;_<this.attributes.length;_++){const E=this.attributes[_],P=f.attributes[E.name];P!==void 0&&c.vertexAttribPointer(P,E.components,c[Np[E.type]],!1,this.itemSize,E.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Wn{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class d0 extends Wn{getDefault(){return o.Color.transparent}set(c){const f=this.current;(c.r!==f.r||c.g!==f.g||c.b!==f.b||c.a!==f.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class Vx extends Wn{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class Iu extends Wn{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Ru extends Wn{getDefault(){return[!0,!0,!0,!0]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class h0 extends Wn{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class ws extends Wn{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Bp extends Wn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const f=this.current;(c.func!==f.func||c.ref!==f.ref||c.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class ah extends Wn{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class lh extends Wn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=c,this.dirty=!1}}class Up extends Wn{getDefault(){return[0,1]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class Vp extends Wn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=c,this.dirty=!1}}class ch extends Wn{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class jp extends Wn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.BLEND):f.disable(f.BLEND),this.current=c,this.dirty=!1}}class Gp extends Wn{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class uh extends Wn{getDefault(){return o.Color.transparent}set(c){const f=this.current;(c.r!==f.r||c.g!==f.g||c.b!==f.b||c.a!==f.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class f0 extends Wn{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class p0 extends Wn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;c?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=c,this.dirty=!1}}class vc extends Wn{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class jx extends Wn{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class Gx extends Wn{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class Wx extends Wn{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class Hx extends Wn{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const f=this.current;(c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class qx extends Wn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class Kx extends Wn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Wp extends Wn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class dh extends Wn{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Hp extends Wn{getDefault(){return null}set(c){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class qp extends Wn{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class _c extends Wn{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class m0 extends Wn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class g0 extends Wn{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class hh extends Wn{constructor(c,f){super(c),this.context=c,this.parent=f}getDefault(){return null}}class gl extends hh{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class y0 extends hh{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,f.DEPTH_ATTACHMENT,f.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class bc{constructor(c,f,g,_){this.context=c,this.width=f,this.height=g;const E=c.gl,P=this.framebuffer=E.createFramebuffer();if(this.colorAttachment=new gl(c,P),_&&(this.depthAttachment=new y0(c,P)),E.checkFramebufferStatus(E.FRAMEBUFFER)!==E.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const c=this.context.gl,f=this.colorAttachment.get();if(f&&c.deleteTexture(f),this.depthAttachment){const g=this.depthAttachment.get();g&&c.deleteRenderbuffer(g)}c.deleteFramebuffer(this.framebuffer)}}class dr{constructor(c,f,g){this.blendFunction=c,this.blendColor=f,this.mask=g}}dr.Replace=[1,0],dr.disabled=new dr(dr.Replace,o.Color.transparent,[!1,!1,!1,!1]),dr.unblended=new dr(dr.Replace,o.Color.transparent,[!0,!0,!0,!0]),dr.alphaBlended=new dr([1,771],o.Color.transparent,[!0,!0,!0,!0]);class v0{constructor(c){this.gl=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new d0(this),this.clearDepth=new Vx(this),this.clearStencil=new Iu(this),this.colorMask=new Ru(this),this.depthMask=new h0(this),this.stencilMask=new ws(this),this.stencilFunc=new Bp(this),this.stencilOp=new ah(this),this.stencilTest=new lh(this),this.depthRange=new Up(this),this.depthTest=new Vp(this),this.depthFunc=new ch(this),this.blend=new jp(this),this.blendFunc=new Gp(this),this.blendColor=new uh(this),this.blendEquation=new f0(this),this.cullFace=new p0(this),this.cullFaceSide=new vc(this),this.frontFace=new jx(this),this.program=new Gx(this),this.activeTexture=new Wx(this),this.viewport=new Hx(this),this.bindFramebuffer=new qx(this),this.bindRenderbuffer=new Kx(this),this.bindTexture=new Wp(this),this.bindVertexBuffer=new dh(this),this.bindElementBuffer=new Hp(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new qp(this),this.pixelStoreUnpack=new _c(this),this.pixelStoreUnpackPremultiplyAlpha=new m0(this),this.pixelStoreUnpackFlipY=new g0(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=c.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(c.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,f){return new Fp(this,c,f)}createVertexBuffer(c,f,g){return new zp(this,c,f,g)}createRenderbuffer(c,f,g){const _=this.gl,E=_.createRenderbuffer();return this.bindRenderbuffer.set(E),_.renderbufferStorage(_.RENDERBUFFER,c,f,g),this.bindRenderbuffer.set(null),E}createFramebuffer(c,f,g){return new bc(this,c,f,g)}clear({color:c,depth:f}){const g=this.gl;let _=0;c&&(_|=g.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),f!==void 0&&(_|=g.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),g.clear(_)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){x(c.blendFunction,dr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Pn{constructor(c,f,g){this.func=c,this.mask=f,this.range=g}}Pn.ReadOnly=!1,Pn.ReadWrite=!0,Pn.disabled=new Pn(519,Pn.ReadOnly,[0,1]);const Hn=7680;class lr{constructor(c,f,g,_,E,P){this.test=c,this.ref=f,this.mask=g,this.fail=_,this.depthFail=E,this.pass=P}}lr.disabled=new lr({func:519,mask:0},0,0,Hn,Hn,Hn);class gr{constructor(c,f,g){this.enable=c,this.mode=f,this.frontFace=g}}let Mu;function xc(y,c,f,g,_,E,P){const R=y.context,k=R.gl,z=y.useProgram("collisionBox"),G=[];let q=0,Y=0;for(let he=0;he<g.length;he++){const ze=g[he],Fe=c.getTile(ze),He=Fe.getBucket(f);if(!He)continue;let qe=ze.posMatrix;_[0]===0&&_[1]===0||(qe=y.translatePosMatrix(ze.posMatrix,Fe,_,E));const tt=P?He.textCollisionBox:He.iconCollisionBox,Ge=He.collisionCircleArray;if(Ge.length>0){const At=o.create(),mt=qe;o.mul(At,He.placementInvProjMatrix,y.transform.glCoordMatrix),o.mul(At,At,He.placementViewportMatrix),G.push({circleArray:Ge,circleOffset:Y,transform:mt,invTransform:At,coord:ze}),q+=Ge.length/4,Y=q}tt&&z.draw(R,k.LINES,Pn.disabled,lr.disabled,y.colorModeForRenderPass(),gr.disabled,na(qe,y.transform,Fe),y.style.terrain&&y.style.terrain.getTerrainData(ze),f.id,tt.layoutVertexBuffer,tt.indexBuffer,tt.segments,null,y.transform.zoom,null,null,tt.collisionVertexBuffer)}if(!P||!G.length)return;const de=y.useProgram("collisionCircle"),ce=new o.CollisionCircleLayoutArray;ce.resize(4*q),ce._trim();let ue=0;for(const he of G)for(let ze=0;ze<he.circleArray.length/4;ze++){const Fe=4*ze,He=he.circleArray[Fe+0],qe=he.circleArray[Fe+1],tt=he.circleArray[Fe+2],Ge=he.circleArray[Fe+3];ce.emplace(ue++,He,qe,tt,Ge,0),ce.emplace(ue++,He,qe,tt,Ge,1),ce.emplace(ue++,He,qe,tt,Ge,2),ce.emplace(ue++,He,qe,tt,Ge,3)}(!Mu||Mu.length<2*q)&&(Mu=function(he){const ze=2*he,Fe=new o.QuadTriangleArray;Fe.resize(ze),Fe._trim();for(let He=0;He<ze;He++){const qe=6*He;Fe.uint16[qe+0]=4*He+0,Fe.uint16[qe+1]=4*He+1,Fe.uint16[qe+2]=4*He+2,Fe.uint16[qe+3]=4*He+2,Fe.uint16[qe+4]=4*He+3,Fe.uint16[qe+5]=4*He+0}return Fe}(q));const we=R.createIndexBuffer(Mu,!0),Ce=R.createVertexBuffer(ce,o.collisionCircleLayout.members,!0);for(const he of G){const ze={u_matrix:he.transform,u_inv_matrix:he.invTransform,u_camera_to_center_distance:(Oe=y.transform).cameraToCenterDistance,u_viewport_size:[Oe.width,Oe.height]};de.draw(R,k.TRIANGLES,Pn.disabled,lr.disabled,y.colorModeForRenderPass(),gr.disabled,ze,y.style.terrain&&y.style.terrain.getTerrainData(he.coord),f.id,Ce,we,o.SegmentVector.simpleSegment(0,2*he.circleOffset,he.circleArray.length,he.circleArray.length/2),null,y.transform.zoom,null,null,null)}var Oe;Ce.destroy(),we.destroy()}gr.disabled=new gr(!1,1029,2305),gr.backCCW=new gr(!0,1029,2305);const Xx=o.identity(new Float32Array(16));function Zx(y,c,f,g,_,E){const{horizontalAlign:P,verticalAlign:R}=o.getAnchorAlignment(y),k=-(P-.5)*c,z=-(R-.5)*f,G=o.evaluateVariableOffset(y,g);return new o.pointGeometry((k/_+G[0])*E,(z/_+G[1])*E)}function _0(y,c,f,g,_,E,P,R,k,z,G){const q=y.text.placedSymbolArray,Y=y.text.dynamicLayoutVertexArray,de=y.icon.dynamicLayoutVertexArray,ce={};Y.clear();for(let ue=0;ue<q.length;ue++){const we=q.get(ue),Ce=y.allowVerticalPlacement&&!we.placedOrientation,Oe=we.hidden||!we.crossTileID||Ce?null:g[we.crossTileID];if(Oe){const he=new o.pointGeometry(we.anchorX,we.anchorY),ze=fn(he,f?P:E,G),Fe=Di(_.cameraToCenterDistance,ze.signedDistanceFromCamera);let He=o.evaluateSizeForFeature(y.textSizeData,k,we)*Fe/o.ONE_EM;f&&(He*=y.tilePixelRatio/R);const{width:qe,height:tt,anchor:Ge,textOffset:At,textBoxScale:mt}=Oe,Ct=Zx(Ge,qe,tt,At,mt,He),sn=f?fn(he.add(Ct),E,G).point:ze.point.add(c?Ct.rotate(-_.angle):Ct),gn=y.allowVerticalPlacement&&we.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let Wt=0;Wt<we.numGlyphs;Wt++)o.addDynamicAttributes(Y,sn,gn);z&&we.associatedIconIndex>=0&&(ce[we.associatedIconIndex]={shiftedAnchor:sn,angle:gn})}else st(we.numGlyphs,Y)}if(z){de.clear();const ue=y.icon.placedSymbolArray;for(let we=0;we<ue.length;we++){const Ce=ue.get(we);if(Ce.hidden)st(Ce.numGlyphs,de);else{const Oe=ce[we];if(Oe)for(let he=0;he<Ce.numGlyphs;he++)o.addDynamicAttributes(de,Oe.shiftedAnchor,Oe.angle);else st(Ce.numGlyphs,de)}}y.icon.dynamicLayoutVertexBuffer.updateData(de)}y.text.dynamicLayoutVertexBuffer.updateData(Y)}function Yx(y,c,f){return f.iconsInText&&c?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function fh(y,c,f,g,_,E,P,R,k,z,G,q){const Y=y.context,de=Y.gl,ce=y.transform,ue=R==="map",we=k==="map",Ce=R!=="viewport"&&f.layout.get("symbol-placement")!=="point",Oe=ue&&!we&&!Ce,he=!f.layout.get("symbol-sort-key").isConstant();let ze=!1;const Fe=y.depthModeForSublayer(0,Pn.ReadOnly),He=f.layout.get("text-variable-anchor"),qe=[];for(const tt of g){const Ge=c.getTile(tt),At=Ge.getBucket(f);if(!At)continue;const mt=_?At.text:At.icon;if(!mt||!mt.segments.get().length)continue;const Ct=mt.programConfigurations.get(f.id),sn=_||At.sdfIcons,gn=_?At.textSizeData:At.iconSizeData,Wt=we||ce.pitch!==0,Kn=y.useProgram(Yx(sn,_,At),Ct),Xn=o.evaluateSizeForZoom(gn,ce.zoom),kn=y.style.terrain&&y.style.terrain.getTerrainData(tt);let Dn,Jn,vi,No,co=[0,0],zo=null;if(_){if(Jn=Ge.glyphAtlasTexture,vi=de.LINEAR,Dn=Ge.glyphAtlasTexture.size,At.iconsInText){co=Ge.imageAtlasTexture.size,zo=Ge.imageAtlasTexture;const Ws=gn.kind==="composite"||gn.kind==="camera";No=Wt||y.options.rotating||y.options.zooming||Ws?de.LINEAR:de.NEAREST}}else{const Ws=f.layout.get("icon-size").constantOr(0)!==1||At.iconsNeedLinear;Jn=Ge.imageAtlasTexture,vi=sn||y.options.rotating||y.options.zooming||Ws||Wt?de.LINEAR:de.NEAREST,Dn=Ge.imageAtlasTexture.size}const Ua=Mn(Ge,1,y.transform.zoom),Gs=Vs(tt.posMatrix,we,ue,y.transform,Ua),ls=yi(tt.posMatrix,we,ue,y.transform,Ua),sa=He&&At.hasTextData(),xh=f.layout.get("icon-text-fit")!=="none"&&sa&&At.hasIconData();if(Ce){const Ws=y.style.terrain?(lm,Pc)=>y.style.terrain.getElevation(tt,lm,Pc):null,bl=f.layout.get("text-rotation-alignment")==="map";De(At,tt.posMatrix,y,_,Gs,ls,we,z,bl,Ws)}const ui=y.translatePosMatrix(tt.posMatrix,Ge,E,P),xn=Ce||_&&He||xh?Xx:Gs,qn=y.translatePosMatrix(ls,Ge,E,P,!0),_i=sn&&f.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let bi;bi=sn?At.iconsInText?u0(gn.kind,Xn,Oe,we,y,ui,xn,qn,Dn,co):oh(gn.kind,Xn,Oe,we,y,ui,xn,qn,_,Dn,!0):Op(gn.kind,Xn,Oe,we,y,ui,xn,qn,_,Dn);const vr={program:Kn,buffers:mt,uniformValues:bi,atlasTexture:Jn,atlasTextureIcon:zo,atlasInterpolation:vi,atlasInterpolationIcon:No,isSDF:sn,hasHalo:_i};if(he&&At.canOverlap){ze=!0;const Ws=mt.segments.get();for(const bl of Ws)qe.push({segments:new o.SegmentVector([bl]),sortKey:bl.sortKey,state:vr,terrainData:kn})}else qe.push({segments:mt.segments,sortKey:0,state:vr,terrainData:kn})}ze&&qe.sort((tt,Ge)=>tt.sortKey-Ge.sortKey);for(const tt of qe){const Ge=tt.state;if(Y.activeTexture.set(de.TEXTURE0),Ge.atlasTexture.bind(Ge.atlasInterpolation,de.CLAMP_TO_EDGE),Ge.atlasTextureIcon&&(Y.activeTexture.set(de.TEXTURE1),Ge.atlasTextureIcon&&Ge.atlasTextureIcon.bind(Ge.atlasInterpolationIcon,de.CLAMP_TO_EDGE)),Ge.isSDF){const At=Ge.uniformValues;Ge.hasHalo&&(At.u_is_halo=1,$u(Ge.buffers,tt.segments,f,y,Ge.program,Fe,G,q,At,tt.terrainData)),At.u_is_halo=0}$u(Ge.buffers,tt.segments,f,y,Ge.program,Fe,G,q,Ge.uniformValues,tt.terrainData)}}function $u(y,c,f,g,_,E,P,R,k,z){const G=g.context;_.draw(G,G.gl.TRIANGLES,E,P,R,gr.disabled,k,z,f.id,y.layoutVertexBuffer,y.indexBuffer,c,f.paint,g.transform.zoom,y.programConfigurations.get(f.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function ku(y,c,f,g,_,E,P){const R=y.context.gl,k=f.paint.get("fill-pattern"),z=k&&k.constantOr(1),G=f.getCrossfadeParameters();let q,Y,de,ce,ue;P?(Y=z&&!f.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",q=R.LINES):(Y=z?"fillPattern":"fill",q=R.TRIANGLES);for(const we of g){const Ce=c.getTile(we);if(z&&!Ce.patternsLoaded())continue;const Oe=Ce.getBucket(f);if(!Oe)continue;const he=Oe.programConfigurations.get(f.id),ze=y.useProgram(Y,he),Fe=y.style.terrain&&y.style.terrain.getTerrainData(we);z&&(y.context.activeTexture.set(R.TEXTURE0),Ce.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),he.updatePaintBuffers(G));const He=k.constantOr(null);if(He&&Ce.imageAtlas){const Ge=Ce.imageAtlas,At=Ge.patternPositions[He.to.toString()],mt=Ge.patternPositions[He.from.toString()];At&&mt&&he.setConstantPatternPositions(At,mt)}const qe=Fe?we:null,tt=y.translatePosMatrix(qe?qe.posMatrix:we.posMatrix,Ce,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));if(P){ce=Oe.indexBuffer2,ue=Oe.segments2;const Ge=[R.drawingBufferWidth,R.drawingBufferHeight];de=Y==="fillOutlinePattern"&&z?Lu(tt,y,G,Ce,Ge):yc(tt,Ge)}else ce=Oe.indexBuffer,ue=Oe.segments,de=z?gc(tt,y,G,Ce):mc(tt);ze.draw(y.context,q,_,y.stencilModeForClipping(we),E,gr.disabled,de,Fe,f.id,Oe.layoutVertexBuffer,ce,ue,f.paint,y.transform.zoom,he)}}function Ou(y,c,f,g,_,E,P){const R=y.context,k=R.gl,z=f.paint.get("fill-extrusion-pattern"),G=z.constantOr(1),q=f.getCrossfadeParameters(),Y=f.paint.get("fill-extrusion-opacity");for(const de of g){const ce=c.getTile(de),ue=ce.getBucket(f);if(!ue)continue;const we=y.style.terrain&&y.style.terrain.getTerrainData(de),Ce=ue.programConfigurations.get(f.id),Oe=y.useProgram(G?"fillExtrusionPattern":"fillExtrusion",Ce);G&&(y.context.activeTexture.set(k.TEXTURE0),ce.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Ce.updatePaintBuffers(q));const he=z.constantOr(null);if(he&&ce.imageAtlas){const qe=ce.imageAtlas,tt=qe.patternPositions[he.to.toString()],Ge=qe.patternPositions[he.from.toString()];tt&&Ge&&Ce.setConstantPatternPositions(tt,Ge)}const ze=y.translatePosMatrix(de.posMatrix,ce,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),Fe=f.paint.get("fill-extrusion-vertical-gradient"),He=G?ao(ze,y,Fe,Y,de,q,ce):ka(ze,y,Fe,Y);Oe.draw(R,R.gl.TRIANGLES,_,E,P,gr.backCCW,He,we,f.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,f.paint,y.transform.zoom,Ce,y.style.terrain&&ue.centroidVertexBuffer)}}function Kp(y,c,f,g,_,E,P){const R=y.context,k=R.gl,z=f.fbo;if(!z)return;const G=y.useProgram("hillshade"),q=y.style.terrain&&y.style.terrain.getTerrainData(c);R.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,z.colorAttachment.get()),G.draw(R,k.TRIANGLES,_,E,P,gr.disabled,((Y,de,ce,ue)=>{const we=ce.paint.get("hillshade-shadow-color"),Ce=ce.paint.get("hillshade-highlight-color"),Oe=ce.paint.get("hillshade-accent-color");let he=ce.paint.get("hillshade-illumination-direction")*(Math.PI/180);ce.paint.get("hillshade-illumination-anchor")==="viewport"&&(he-=Y.transform.angle);const ze=!Y.options.moving;return{u_matrix:ue?ue.posMatrix:Y.transform.calculatePosMatrix(de.tileID.toUnwrapped(),ze),u_image:0,u_latrange:Ue(0,de.tileID),u_light:[ce.paint.get("hillshade-exaggeration"),he],u_shadow:we,u_highlight:Ce,u_accent:Oe}})(y,f,g,q?c:null),q,g.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}function b0(y,c,f,g,_,E){const P=y.context,R=P.gl,k=c.dem;if(k&&k.data){const z=k.dim,G=k.stride,q=k.getPixels();if(P.activeTexture.set(R.TEXTURE1),P.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||y.getTileTexture(G),c.demTexture){const de=c.demTexture;de.update(q,{premultiply:!1}),de.bind(R.NEAREST,R.CLAMP_TO_EDGE)}else c.demTexture=new M(P,q,R.RGBA,{premultiply:!1}),c.demTexture.bind(R.NEAREST,R.CLAMP_TO_EDGE);P.activeTexture.set(R.TEXTURE0);let Y=c.fbo;if(!Y){const de=new M(P,{width:z,height:z,data:null},R.RGBA);de.bind(R.LINEAR,R.CLAMP_TO_EDGE),Y=c.fbo=P.createFramebuffer(z,z,!0),Y.colorAttachment.set(de.texture)}P.bindFramebuffer.set(Y.framebuffer),P.viewport.set([0,0,z,z]),y.useProgram("hillshadePrepare").draw(P,R.TRIANGLES,g,_,E,gr.disabled,((de,ce)=>{const ue=ce.stride,we=o.create();return o.ortho(we,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(we,we,[0,-o.EXTENT,0]),{u_matrix:we,u_image:1,u_dimension:[ue,ue],u_zoom:de.overscaledZ,u_unpack:ce.getUnpackVector()}})(c.tileID,k),null,f.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function ph(y,c,f,g,_,E){const P=g.paint.get("raster-fade-duration");if(!E&&P>0){const R=o.exported.now(),k=(R-y.timeAdded)/P,z=c?(R-c.timeAdded)/P:-1,G=f.getSource(),q=_.coveringZoomLevel({tileSize:G.tileSize,roundZoom:G.roundZoom}),Y=!c||Math.abs(c.tileID.overscaledZ-q)>Math.abs(y.tileID.overscaledZ-q),de=Y&&y.refreshedUponExpiration?1:o.clamp(Y?k:1-z,0,1);return y.refreshedUponExpiration&&k>=1&&(y.refreshedUponExpiration=!1),c?{opacity:1,mix:1-de}:{opacity:de,mix:0}}return{opacity:1,mix:0}}const mh=new o.Color(1,0,0,1),lo=new o.Color(0,1,0,1),x0=new o.Color(0,0,1,1),Xp=new o.Color(1,0,1,1),w0=new o.Color(0,1,1,1);function yl(y,c,f,g){wc(y,0,c+f/2,y.transform.width,f,g)}function Du(y,c,f,g){wc(y,c-f/2,0,f,y.transform.height,g)}function wc(y,c,f,g,_,E){const P=y.context,R=P.gl;R.enable(R.SCISSOR_TEST),R.scissor(c*y.pixelRatio,f*y.pixelRatio,g*y.pixelRatio,_*y.pixelRatio),P.clear({color:E}),R.disable(R.SCISSOR_TEST)}function Jx(y,c,f){const g=y.context,_=g.gl,E=f.posMatrix,P=y.useProgram("debug"),R=Pn.disabled,k=lr.disabled,z=y.colorModeForRenderPass(),G="$debug",q=y.style.terrain&&y.style.terrain.getTerrainData(f);g.activeTexture.set(_.TEXTURE0),y.emptyTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE);const Y=c.getTileByID(f.key).latestRawTileData,de=Math.floor((Y&&Y.byteLength||0)/1024),ce=c.getTile(f).tileSize,ue=512/Math.min(ce,512)*(f.overscaledZ/y.transform.zoom)*.5;let we=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(we+=` => ${f.overscaledZ}`),function(Ce,Oe){Ce.initDebugOverlayCanvas();const he=Ce.debugOverlayCanvas,ze=Ce.context.gl,Fe=Ce.debugOverlayCanvas.getContext("2d");Fe.clearRect(0,0,he.width,he.height),Fe.shadowColor="white",Fe.shadowBlur=2,Fe.lineWidth=1.5,Fe.strokeStyle="white",Fe.textBaseline="top",Fe.font="bold 36px Open Sans, sans-serif",Fe.fillText(Oe,5,5),Fe.strokeText(Oe,5,5),Ce.debugOverlayTexture.update(he),Ce.debugOverlayTexture.bind(ze.LINEAR,ze.CLAMP_TO_EDGE)}(y,`${we} ${de}kB`),P.draw(g,_.TRIANGLES,R,k,dr.alphaBlended,gr.disabled,J(E,o.Color.transparent,ue),null,G,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),P.draw(g,_.LINE_STRIP,R,k,z,gr.disabled,J(E,o.Color.red),q,G,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function gh(y,c,f){const g=y.context,_=g.gl,E=y.colorModeForRenderPass(),P=new Pn(_.LEQUAL,Pn.ReadWrite,y.depthRangeFor3D),R=y.useProgram("terrain"),k=c.getTerrainMesh(),z=c.getTerrainData(f.tileID);g.bindFramebuffer.set(null),g.viewport.set([0,0,y.width,y.height]),g.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,c.getRTTFramebuffer().colorAttachment.get());const G=y.transform.calculatePosMatrix(f.tileID.toUnwrapped());R.draw(g,_.TRIANGLES,P,lr.disabled,E,gr.backCCW,{u_matrix:G,u_texture:0},z,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}function T0(y,c,f,g){const _=y.context,E=f.tileSize*c.qualityFactor;f.textures[g]||(f.textures[g]=y.getTileTexture(E)||new M(_,{width:E,height:E,data:null},_.gl.RGBA),f.textures[g].bind(_.gl.LINEAR,_.gl.CLAMP_TO_EDGE),g===0&&c.sourceCache.renderHistory.unshift(f.tileID.key));const P=c.getRTTFramebuffer();P.colorAttachment.set(f.textures[g].texture),_.bindFramebuffer.set(P.framebuffer),_.viewport.set([0,0,E,E])}class E0{constructor(c){this._coordsDescendingInv={},this._coordsDescendingInvStr={},this.painter=c,this._renderToTexture={background:!0,fill:!0,line:!0,raster:!0},this._coordsDescendingInv={},this._coordsDescendingInvStr={},this._stacks=[],this._prevType=null,this._rerender={},this._renderableTiles=c.style.terrain.sourceCache.getRenderableTiles(),this._init()}_init(){const c=this.painter.style,f=c.terrain;for(const g in c.sourceCaches){this._coordsDescendingInv[g]={};const _=c.sourceCaches[g].getVisibleCoordinates();for(const E of _){const P=f.sourceCache.getTerrainCoords(E);for(const R in P)this._coordsDescendingInv[g][R]||(this._coordsDescendingInv[g][R]=[]),this._coordsDescendingInv[g][R].push(P[R])}}for(const g of c._order){const _=c._layers[g],E=_.source;if(this._renderToTexture[_.type]&&!this._coordsDescendingInvStr[E]){this._coordsDescendingInvStr[E]={};for(const P in this._coordsDescendingInv[E])this._coordsDescendingInvStr[E][P]=this._coordsDescendingInv[E][P].map(R=>R.key).sort().join()}}return this._renderableTiles.forEach(g=>{for(const _ in this._coordsDescendingInvStr){const E=this._coordsDescendingInvStr[_][g.tileID.key];E&&E!==g.textureCoords[_]&&g.clearTextures(this.painter),f.needsRerender(_,g.tileID)&&g.clearTextures(this.painter)}this._rerender[g.tileID.key]=!g.textures.length}),f.clearRerenderCache(),f.sourceCache.removeOutdated(this.painter),this}renderLayer(c){const f=c.type,g=this.painter,_=g.style._order,E=g.currentLayer,P=E+1===_.length;if(this._renderToTexture[f]&&(this._prevType&&this._renderToTexture[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(_[E]),!P))return!0;if(this._renderToTexture[this._prevType]||f==="hillshade"||this._renderToTexture[f]&&P){this._prevType=f;const R=this._stacks.length-1,k=this._stacks[R]||[];for(const z of this._renderableTiles){if(T0(g,g.style.terrain,z,R),this._rerender[z.tileID.key]){g.context.clear({color:o.Color.transparent});for(let G=0;G<k.length;G++){const q=g.style._layers[k[G]],Y=q.source?this._coordsDescendingInv[q.source][z.tileID.key]:[z.tileID];g._renderTileClippingMasks(q,Y),g.renderLayer(g,g.style.sourceCaches[q.source],q,Y),q.source&&(z.textureCoords[q.source]=this._coordsDescendingInvStr[q.source][z.tileID.key])}}gh(g,g.style.terrain,z)}if(f==="hillshade"){this._stacks.push([_[E]]);for(const z of this._renderableTiles){const G=this._coordsDescendingInv[c.source][z.tileID.key];T0(g,g.style.terrain,z,this._stacks.length-1),g.context.clear({color:o.Color.transparent}),g._renderTileClippingMasks(c,G),g.renderLayer(g,g.style.sourceCaches[c.source],c,G),gh(g,g.style.terrain,z)}return!0}return this._renderToTexture[f]}return!1}}const Fu={symbol:function(y,c,f,g,_){if(y.renderPass!=="translucent")return;const E=lr.disabled,P=y.colorModeForRenderPass();f.layout.get("text-variable-anchor")&&function(R,k,z,G,q,Y,de){const ce=k.transform,ue=q==="map",we=Y==="map";for(const Ce of R){const Oe=G.getTile(Ce),he=Oe.getBucket(z);if(!he||!he.text||!he.text.segments.get().length)continue;const ze=o.evaluateSizeForZoom(he.textSizeData,ce.zoom),Fe=Mn(Oe,1,k.transform.zoom),He=Vs(Ce.posMatrix,we,ue,k.transform,Fe),qe=z.layout.get("icon-text-fit")!=="none"&&he.hasIconData();if(ze){const tt=Math.pow(2,ce.zoom-Oe.tileID.overscaledZ);_0(he,ue,we,de,ce,He,Ce.posMatrix,tt,ze,qe,k.style.terrain?(Ge,At)=>k.style.terrain.getElevation(Ce,Ge,At):null)}}}(g,y,f,c,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),_),f.paint.get("icon-opacity").constantOr(1)!==0&&fh(y,c,f,g,!1,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),f.layout.get("icon-rotation-alignment"),f.layout.get("icon-pitch-alignment"),f.layout.get("icon-keep-upright"),E,P),f.paint.get("text-opacity").constantOr(1)!==0&&fh(y,c,f,g,!0,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),f.layout.get("text-keep-upright"),E,P),c.map.showCollisionBoxes&&(xc(y,c,f,g,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),xc(y,c,f,g,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(y,c,f,g){if(y.renderPass!=="translucent")return;const _=f.paint.get("circle-opacity"),E=f.paint.get("circle-stroke-width"),P=f.paint.get("circle-stroke-opacity"),R=!f.layout.get("circle-sort-key").isConstant();if(_.constantOr(1)===0&&(E.constantOr(1)===0||P.constantOr(1)===0))return;const k=y.context,z=k.gl,G=y.depthModeForSublayer(0,Pn.ReadOnly),q=lr.disabled,Y=y.colorModeForRenderPass(),de=[];for(let ce=0;ce<g.length;ce++){const ue=g[ce],we=c.getTile(ue),Ce=we.getBucket(f);if(!Ce)continue;const Oe=Ce.programConfigurations.get(f.id),he=y.useProgram("circle",Oe),ze=Ce.layoutVertexBuffer,Fe=Ce.indexBuffer,He=y.style.terrain&&y.style.terrain.getTerrainData(ue),qe={programConfiguration:Oe,program:he,layoutVertexBuffer:ze,indexBuffer:Fe,uniformValues:sh(y,ue,we,f),terrainData:He};if(R){const tt=Ce.segments.get();for(const Ge of tt)de.push({segments:new o.SegmentVector([Ge]),sortKey:Ge.sortKey,state:qe})}else de.push({segments:Ce.segments,sortKey:0,state:qe})}R&&de.sort((ce,ue)=>ce.sortKey-ue.sortKey);for(const ce of de){const{programConfiguration:ue,program:we,layoutVertexBuffer:Ce,indexBuffer:Oe,uniformValues:he,terrainData:ze}=ce.state;we.draw(k,z.TRIANGLES,G,q,Y,gr.disabled,he,ze,f.id,Ce,Oe,ce.segments,f.paint,y.transform.zoom,ue)}},heatmap:function(y,c,f,g){if(f.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const _=y.context,E=_.gl,P=lr.disabled,R=new dr([E.ONE,E.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(k,z,G){const q=k.gl;k.activeTexture.set(q.TEXTURE1),k.viewport.set([0,0,z.width/4,z.height/4]);let Y=G.heatmapFbo;if(Y)q.bindTexture(q.TEXTURE_2D,Y.colorAttachment.get()),k.bindFramebuffer.set(Y.framebuffer);else{const de=q.createTexture();q.bindTexture(q.TEXTURE_2D,de),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.LINEAR),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.LINEAR),Y=G.heatmapFbo=k.createFramebuffer(z.width/4,z.height/4,!1),function(ce,ue,we,Ce){const Oe=ce.gl;Oe.texImage2D(Oe.TEXTURE_2D,0,Oe.RGBA,ue.width/4,ue.height/4,0,Oe.RGBA,ce.extRenderToTextureHalfFloat?ce.extTextureHalfFloat.HALF_FLOAT_OES:Oe.UNSIGNED_BYTE,null),Ce.colorAttachment.set(we)}(k,z,de,Y)}})(_,y,f),_.clear({color:o.Color.transparent});for(let k=0;k<g.length;k++){const z=g[k];if(c.hasRenderableParent(z))continue;const G=c.getTile(z),q=G.getBucket(f);if(!q)continue;const Y=q.programConfigurations.get(f.id),de=y.useProgram("heatmap",Y),{zoom:ce}=y.transform;de.draw(_,E.TRIANGLES,Pn.disabled,P,R,gr.disabled,be(z.posMatrix,G,ce,f.paint.get("heatmap-intensity")),null,f.id,q.layoutVertexBuffer,q.indexBuffer,q.segments,f.paint,y.transform.zoom,Y)}_.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(_,E){const P=_.context,R=P.gl,k=E.heatmapFbo;if(!k)return;P.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,k.colorAttachment.get()),P.activeTexture.set(R.TEXTURE1);let z=E.colorRampTexture;z||(z=E.colorRampTexture=new M(P,E.colorRamp,R.RGBA)),z.bind(R.LINEAR,R.CLAMP_TO_EDGE),_.useProgram("heatmapTexture").draw(P,R.TRIANGLES,Pn.disabled,lr.disabled,_.colorModeForRenderPass(),gr.disabled,((G,q,Y,de)=>{const ce=o.create();o.ortho(ce,0,G.width,G.height,0,0,1);const ue=G.context.gl;return{u_matrix:ce,u_world:[ue.drawingBufferWidth,ue.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:q.paint.get("heatmap-opacity")}})(_,E),null,E.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,E.paint,_.transform.zoom)}(y,f))},line:function(y,c,f,g){if(y.renderPass!=="translucent")return;const _=f.paint.get("line-opacity"),E=f.paint.get("line-width");if(_.constantOr(1)===0||E.constantOr(1)===0)return;const P=y.depthModeForSublayer(0,Pn.ReadOnly),R=y.colorModeForRenderPass(),k=f.paint.get("line-dasharray"),z=f.paint.get("line-pattern"),G=z.constantOr(1),q=f.paint.get("line-gradient"),Y=f.getCrossfadeParameters(),de=G?"linePattern":k?"lineSDF":q?"lineGradient":"line",ce=y.context,ue=ce.gl;let we=!0;for(const Ce of g){const Oe=c.getTile(Ce);if(G&&!Oe.patternsLoaded())continue;const he=Oe.getBucket(f);if(!he)continue;const ze=he.programConfigurations.get(f.id),Fe=y.context.program.get(),He=y.useProgram(de,ze),qe=we||He.program!==Fe,tt=y.style.terrain&&y.style.terrain.getTerrainData(Ce),Ge=z.constantOr(null);if(Ge&&Oe.imageAtlas){const Ct=Oe.imageAtlas,sn=Ct.patternPositions[Ge.to.toString()],gn=Ct.patternPositions[Ge.from.toString()];sn&&gn&&ze.setConstantPatternPositions(sn,gn)}const At=tt?Ce:null,mt=G?bn(y,Oe,f,Y,At):k?xr(y,Oe,f,k,Y,At):q?$t(y,Oe,f,he.lineClipsArray.length,At):rt(y,Oe,f,At);if(G)ce.activeTexture.set(ue.TEXTURE0),Oe.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),ze.updatePaintBuffers(Y);else if(k&&(qe||y.lineAtlas.dirty))ce.activeTexture.set(ue.TEXTURE0),y.lineAtlas.bind(ce);else if(q){const Ct=he.gradients[f.id];let sn=Ct.texture;if(f.gradientVersion!==Ct.version){let gn=256;if(f.stepInterpolant){const Wt=c.getSource().maxzoom,Kn=Ce.canonical.z===Wt?Math.ceil(1<<y.transform.maxZoom-Ce.canonical.z):1;gn=o.clamp(o.nextPowerOfTwo(he.maxLineLength/o.EXTENT*1024*Kn),256,ce.maxTextureSize)}Ct.gradient=o.renderColorRamp({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:gn,image:Ct.gradient||void 0,clips:he.lineClipsArray}),Ct.texture?Ct.texture.update(Ct.gradient):Ct.texture=new M(ce,Ct.gradient,ue.RGBA),Ct.version=f.gradientVersion,sn=Ct.texture}ce.activeTexture.set(ue.TEXTURE0),sn.bind(f.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}He.draw(ce,ue.TRIANGLES,P,y.stencilModeForClipping(Ce),R,gr.disabled,mt,tt,f.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,f.paint,y.transform.zoom,ze,he.layoutVertexBuffer2),we=!1}},fill:function(y,c,f,g){const _=f.paint.get("fill-color"),E=f.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const P=y.colorModeForRenderPass(),R=f.paint.get("fill-pattern"),k=y.opaquePassEnabledForLayer()&&!R.constantOr(1)&&_.constantOr(o.Color.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===k){const z=y.depthModeForSublayer(1,y.renderPass==="opaque"?Pn.ReadWrite:Pn.ReadOnly);ku(y,c,f,g,z,P,!1)}if(y.renderPass==="translucent"&&f.paint.get("fill-antialias")){const z=y.depthModeForSublayer(f.getPaintProperty("fill-outline-color")?2:0,Pn.ReadOnly);ku(y,c,f,g,z,P,!0)}},"fill-extrusion":function(y,c,f,g){const _=f.paint.get("fill-extrusion-opacity");if(_!==0&&y.renderPass==="translucent"){const E=new Pn(y.context.gl.LEQUAL,Pn.ReadWrite,y.depthRangeFor3D);if(_!==1||f.paint.get("fill-extrusion-pattern").constantOr(1))Ou(y,c,f,g,E,lr.disabled,dr.disabled),Ou(y,c,f,g,E,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const P=y.colorModeForRenderPass();Ou(y,c,f,g,E,lr.disabled,P)}}},hillshade:function(y,c,f,g){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const _=y.context,E=y.depthModeForSublayer(0,Pn.ReadOnly),P=y.colorModeForRenderPass(),[R,k]=y.renderPass==="translucent"?y.stencilConfigForOverlap(g):[{},g];for(const z of k){const G=c.getTile(z);G.needsHillshadePrepare!==void 0&&G.needsHillshadePrepare&&y.renderPass==="offscreen"?b0(y,G,f,E,lr.disabled,P):y.renderPass==="translucent"&&Kp(y,z,G,f,E,R[z.overscaledZ],P)}_.viewport.set([0,0,y.width,y.height])},raster:function(y,c,f,g){if(y.renderPass!=="translucent"||f.paint.get("raster-opacity")===0||!g.length)return;const _=y.context,E=_.gl,P=c.getSource(),R=y.useProgram("raster"),k=y.colorModeForRenderPass(),[z,G]=P instanceof yt?[{},g]:y.stencilConfigForOverlap(g),q=G[G.length-1].overscaledZ,Y=!y.options.moving;for(const de of G){const ce=y.depthModeForSublayer(de.overscaledZ-q,f.paint.get("raster-opacity")===1?Pn.ReadWrite:Pn.ReadOnly,E.LESS),ue=c.getTile(de);ue.registerFadeDuration(f.paint.get("raster-fade-duration"));const we=c.findLoadedParent(de,0),Ce=ph(ue,we,c,f,y.transform,y.style.terrain);let Oe,he;const ze=f.paint.get("raster-resampling")==="nearest"?E.NEAREST:E.LINEAR;_.activeTexture.set(E.TEXTURE0),ue.texture.bind(ze,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),_.activeTexture.set(E.TEXTURE1),we?(we.texture.bind(ze,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),Oe=Math.pow(2,we.tileID.overscaledZ-ue.tileID.overscaledZ),he=[ue.tileID.canonical.x*Oe%1,ue.tileID.canonical.y*Oe%1]):ue.texture.bind(ze,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST);const Fe=y.style.terrain&&y.style.terrain.getTerrainData(de),He=Fe?de:null,qe=He?He.posMatrix:y.transform.calculatePosMatrix(de.toUnwrapped(),Y),tt=xs(qe,he||[0,0],Oe||1,Ce,f);P instanceof yt?R.draw(_,E.TRIANGLES,ce,lr.disabled,k,gr.disabled,tt,Fe,f.id,P.boundsBuffer,y.quadTriangleIndexBuffer,P.boundsSegments):R.draw(_,E.TRIANGLES,ce,z[de.overscaledZ],k,gr.disabled,tt,Fe,f.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}},background:function(y,c,f,g){const _=f.paint.get("background-color"),E=f.paint.get("background-opacity");if(E===0)return;const P=y.context,R=P.gl,k=y.transform,z=k.tileSize,G=f.paint.get("background-pattern");if(y.isPatternMissing(G))return;const q=!G&&_.a===1&&E===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==q)return;const Y=lr.disabled,de=y.depthModeForSublayer(0,q==="opaque"?Pn.ReadWrite:Pn.ReadOnly),ce=y.colorModeForRenderPass(),ue=y.useProgram(G?"backgroundPattern":"background"),we=g||k.coveringTiles({tileSize:z,terrain:y.style.terrain});G&&(P.activeTexture.set(R.TEXTURE0),y.imageManager.bind(y.context));const Ce=f.getCrossfadeParameters();for(const Oe of we){const he=g?Oe.posMatrix:y.transform.calculatePosMatrix(Oe.toUnwrapped()),ze=G?Ux(he,E,y,G,{tileID:Oe,tileSize:z},Ce):Bx(he,E,_),Fe=y.style.terrain&&y.style.terrain.getTerrainData(Oe);ue.draw(P,R.TRIANGLES,de,Y,ce,gr.disabled,ze,Fe,f.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}},debug:function(y,c,f){for(let g=0;g<f.length;g++)Jx(y,c,f[g])},custom:function(y,c,f){const g=y.context,_=f.implementation;if(y.renderPass==="offscreen"){const E=_.prerender;E&&(y.setCustomLayerDefaults(),g.setColorMode(y.colorModeForRenderPass()),E.call(_,g.gl,y.transform.customLayerMatrix()),g.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),g.setColorMode(y.colorModeForRenderPass()),g.setStencilMode(lr.disabled);const E=_.renderingMode==="3d"?new Pn(y.context.gl.LEQUAL,Pn.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,Pn.ReadOnly);g.setDepthMode(E),_.render(g.gl,y.transform.customLayerMatrix()),g.setDirty(),y.setBaseState(),g.bindFramebuffer.set(null)}}};class Zp{constructor(c,f){this.context=new v0(c),this.transform=f,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:o.create(),renderTime:0},this.setup(),this.numSublayers=lt.maxUnderzooming+lt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new zt,this.gpuTimers={}}resize(c,f,g){if(this.width=c*g,this.height=f*g,this.pixelRatio=g,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const c=this.context,f=new o.PosArray;f.emplaceBack(0,0),f.emplaceBack(o.EXTENT,0),f.emplaceBack(0,o.EXTENT),f.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(f,pn.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const g=new o.PosArray;g.emplaceBack(0,0),g.emplaceBack(o.EXTENT,0),g.emplaceBack(0,o.EXTENT),g.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=c.createVertexBuffer(g,pn.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const _=new o.RasterBoundsArray;_.emplaceBack(0,0,0,0),_.emplaceBack(o.EXTENT,0,o.EXTENT,0),_.emplaceBack(0,o.EXTENT,0,o.EXTENT),_.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.rasterBoundsBuffer=c.createVertexBuffer(_,ot.members),this.rasterBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const E=new o.PosArray;E.emplaceBack(0,0),E.emplaceBack(1,0),E.emplaceBack(0,1),E.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(E,pn.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const P=new o.LineStripIndexArray;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(P);const R=new o.TriangleIndexArray;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(R),this.emptyTexture=new M(c,{width:1,height:1,data:new Uint8Array([0,0,0,0])},c.gl.RGBA);const k=this.context.gl;this.stencilClearMode=new lr({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){const c=this.context,f=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const g=o.create();o.ortho(g,0,this.width,this.height,0,0,1),o.scale(g,g,[f.drawingBufferWidth,f.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,f.TRIANGLES,Pn.disabled,this.stencilClearMode,dr.disabled,gr.disabled,oe(g),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,f){if(this.currentStencilSource===c.source||!c.isTileClipped()||!f||!f.length)return;this.currentStencilSource=c.source;const g=this.context,_=g.gl;this.nextStencilID+f.length>256&&this.clearStencil(),g.setColorMode(dr.disabled),g.setDepthMode(Pn.disabled);const E=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of f){const R=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,k=this.style.terrain&&this.style.terrain.getTerrainData(P);E.draw(g,_.TRIANGLES,Pn.disabled,new lr({func:_.ALWAYS,mask:0},R,255,_.KEEP,_.KEEP,_.REPLACE),dr.disabled,gr.disabled,oe(P.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,f=this.context.gl;return new lr({func:f.NOTEQUAL,mask:255},c,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(c){const f=this.context.gl;return new lr({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(c){const f=this.context.gl,g=c.sort((P,R)=>R.overscaledZ-P.overscaledZ),_=g[g.length-1].overscaledZ,E=g[0].overscaledZ-_+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const P={};for(let R=0;R<E;R++)P[R+_]=new lr({func:f.GEQUAL,mask:255},R+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=E,[P,g]}return[{[_]:lr.disabled},g]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new dr([c.CONSTANT_COLOR,c.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?dr.unblended:dr.alphaBlended}depthModeForSublayer(c,f,g){if(!this.opaquePassEnabledForLayer())return Pn.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new Pn(g||this.context.gl.LEQUAL,f,[_,_])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,f){this.style=c,this.options=f,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const g=this.style._order,_=this.style.sourceCaches,E=this.style.terrain&&new E0(this);for(const z in _){const G=_[z];G.used&&G.prepare(this.context)}const P={},R={},k={};for(const z in _){const G=_[z];P[z]=G.getVisibleCoordinates(),R[z]=P[z].slice().reverse(),k[z]=G.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<g.length;z++)if(this.style._layers[g[z]].is3D()){this.opaquePassCutoff=z;break}if(E){this.opaquePassCutoff=0;const z=this.style.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!o.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||z.length)&&(o.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(G,q){const Y=G.context,de=Y.gl,ce=dr.unblended,ue=new Pn(de.LEQUAL,Pn.ReadWrite,[0,1]),we=q.getTerrainMesh(),Ce=q.sourceCache.getRenderableTiles(),Oe=G.useProgram("terrainDepth");Y.bindFramebuffer.set(q.getFramebuffer("depth").framebuffer),Y.viewport.set([0,0,G.width/devicePixelRatio,G.height/devicePixelRatio]),Y.clear({color:o.Color.transparent,depth:1});for(const he of Ce){const ze=q.getTerrainData(he.tileID),Fe=G.transform.calculatePosMatrix(he.tileID.toUnwrapped());Oe.draw(Y,de.TRIANGLES,ue,lr.disabled,ce,gr.backCCW,{u_matrix:Fe},ze,"terrain",we.vertexBuffer,we.indexBuffer,we.segments)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,G.width,G.height])}(this,this.style.terrain),function(G,q){const Y=G.context,de=Y.gl,ce=dr.unblended,ue=new Pn(de.LEQUAL,Pn.ReadWrite,[0,1]),we=q.getTerrainMesh(),Ce=q.getCoordsTexture(),Oe=q.sourceCache.getRenderableTiles(),he=G.useProgram("terrainCoords");Y.bindFramebuffer.set(q.getFramebuffer("coords").framebuffer),Y.viewport.set([0,0,G.width/devicePixelRatio,G.height/devicePixelRatio]),Y.clear({color:o.Color.transparent,depth:1}),q.coordsIndex=[];for(const ze of Oe){const Fe=q.getTerrainData(ze.tileID);Y.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,Ce.texture);const He=G.transform.calculatePosMatrix(ze.tileID.toUnwrapped());he.draw(Y,de.TRIANGLES,ue,lr.disabled,ce,gr.backCCW,{u_matrix:He,u_terrain_coords_id:(255-q.coordsIndex.length)/255,u_texture:0},Fe,"terrain",we.vertexBuffer,we.indexBuffer,we.segments),q.coordsIndex.push(ze.tileID.key)}Y.bindFramebuffer.set(null),Y.viewport.set([0,0,G.width,G.height])}(this,this.style.terrain))}this.renderPass="offscreen";for(const z of g){const G=this.style._layers[z];if(!G.hasOffscreenPass()||G.isHidden(this.transform.zoom))continue;const q=R[G.source];(G.type==="custom"||q.length)&&this.renderLayer(this,_[G.source],G,q)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:f.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],!E)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[g[this.currentLayer]],G=_[z.source],q=P[z.source];this._renderTileClippingMasks(z,q),this.renderLayer(this,G,z,q)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const z=this.style._layers[g[this.currentLayer]],G=_[z.source];if(E&&E.renderLayer(z))continue;const q=(z.type==="symbol"?k:R)[z.source];this._renderTileClippingMasks(z,P[z.source]),this.renderLayer(this,G,z,q)}if(this.options.showTileBoundaries){let z,G;Object.values(this.style._layers).forEach(q=>{q.source&&!q.isHidden(this.transform.zoom)&&(q.source!==(G&&G.id)&&(G=this.style.sourceCaches[q.source]),(!z||z.getSource().maxzoom<G.getSource().maxzoom)&&(z=G))}),z&&Fu.debug(this,z,z.getVisibleCoordinates())}this.options.showPadding&&function(z){const G=z.transform.padding;yl(z,z.transform.height-(G.top||0),3,mh),yl(z,G.bottom||0,3,lo),Du(z,G.left||0,3,x0),Du(z,z.transform.width-(G.right||0),3,Xp);const q=z.transform.centerPoint;(function(Y,de,ce,ue){wc(Y,de-1,ce-10,2,20,ue),wc(Y,de-10,ce-1,20,2,ue)})(z,q.x,z.transform.height-q.y,w0)}(this),this.context.setDefault()}renderLayer(c,f,g,_){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="custom"||(_||[]).length)&&(this.id=g.id,this.gpuTimingStart(g),Fu[g.type](c,f,g,_,this.style.placement.variableOffsets),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery;let g=this.gpuTimers[c.id];g||(g=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:f.createQueryEXT()}),g.calls++,f.beginQueryEXT(f.TIME_ELAPSED_EXT,g.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}queryGpuTimers(c){const f={};for(const g in c){const _=c[g],E=this.context.extTimerQuery,P=E.getQueryObjectEXT(_.query,E.QUERY_RESULT_EXT)/1e6;E.deleteQueryEXT(_.query),f[g]=P}return f}translatePosMatrix(c,f,g,_,E){if(!g[0]&&!g[1])return c;const P=E?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(P){const z=Math.sin(P),G=Math.cos(P);g=[g[0]*G-g[1]*z,g[0]*z+g[1]*G]}const R=[E?g[0]:Mn(f,g[0],this.transform.zoom),E?g[1]:Mn(f,g[1],this.transform.zoom),0],k=new Float32Array(16);return o.translate(k,c,R),k}saveTileTexture(c){const f=this._tileTextures[c.size[0]];f?f.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const f=this._tileTextures[c];return f&&f.length>0?f.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;const f=this.imageManager.getPattern(c.from.toString()),g=this.imageManager.getPattern(c.to.toString());return!f||!g}useProgram(c,f){this.cache=this.cache||{};const g=c+(f?f.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.terrain?"/terrain":"");return this.cache[g]||(this.cache[g]=new fc(this.context,c,Ci[c],f,Dp[c],this._showOverdrawInspector,this.style.terrain)),this.cache[g]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new M(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class yh{constructor(c,f){this.points=c,this.planes=f}static fromInvProjectionMatrix(c,f,g){const _=Math.pow(2,g),E=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(R=>{const k=1/(R=o.transformMat4([],R,c))[3]/f*_;return o.mul$1(R,R,[k,k,1/R[3],k])}),P=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(R=>{const k=o.sub([],E[R[0]],E[R[1]]),z=o.sub([],E[R[2]],E[R[1]]),G=o.normalize([],o.cross([],k,z)),q=-o.dot(G,E[R[1]]);return G.concat(q)});return new yh(E,P)}}class Nu{constructor(c,f){this.min=c,this.max=f,this.center=o.scale$1([],o.add([],this.min,this.max),.5)}quadrant(c){const f=[c%2==0,c<2],g=o.clone$2(this.min),_=o.clone$2(this.max);for(let E=0;E<f.length;E++)g[E]=f[E]?this.min[E]:this.center[E],_[E]=f[E]?this.center[E]:this.max[E];return _[2]=this.max[2],new Nu(g,_)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}intersects(c){const f=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let g=!0;for(let _=0;_<c.planes.length;_++){const E=c.planes[_];let P=0;for(let R=0;R<f.length;R++)o.dot$1(E,f[R])>=0&&P++;if(P===0)return 0;P!==f.length&&(g=!1)}if(g)return 2;for(let _=0;_<3;_++){let E=Number.MAX_VALUE,P=-Number.MAX_VALUE;for(let R=0;R<c.points.length;R++){const k=c.points[R][_]-this.min[_];E=Math.min(E,k),P=Math.max(P,k)}if(P<0||E>this.max[_]-this.min[_])return 0}return 1}}class Tc{constructor(c=0,f=0,g=0,_=0){if(isNaN(c)||c<0||isNaN(f)||f<0||isNaN(g)||g<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=f,this.left=g,this.right=_}interpolate(c,f,g){return f.top!=null&&c.top!=null&&(this.top=o.number(c.top,f.top,g)),f.bottom!=null&&c.bottom!=null&&(this.bottom=o.number(c.bottom,f.bottom,g)),f.left!=null&&c.left!=null&&(this.left=o.number(c.left,f.left,g)),f.right!=null&&c.right!=null&&(this.right=o.number(c.right,f.right,g)),this}getCenter(c,f){const g=o.clamp((this.left+c-this.right)/2,0,c),_=o.clamp((this.top+f-this.bottom)/2,0,f);return new o.pointGeometry(g,_)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Tc(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class zu{constructor(c,f,g,_,E){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=E===void 0||!!E,this._minZoom=c||0,this._maxZoom=f||22,this._minPitch=g??0,this._maxPitch=_??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Tc,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const c=new zu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.tileSize=this.tileSize,c.latRange=this.latRange,c.width=this.width,c.height=this.height,c._center=this._center,c._elevation=this._elevation,c.zoom=this.zoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(c){const f=-o.wrap(c,-180,180)*Math.PI/180;var g;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=(g=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),function(_,E,P){var R=E[0],k=E[1],z=E[2],G=E[3],q=Math.sin(P),Y=Math.cos(P);_[0]=R*Y+z*q,_[1]=k*Y+G*q,_[2]=R*-q+z*Y,_[3]=k*-q+G*Y}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const f=o.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(c){const f=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._zoom=f,this.scale=this.zoomScale(f),this.tileZoom=Math.floor(f),this.zoomFraction=f-this.tileZoom,this._constrain(),this._calcMatrices())}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(c){c!==this._elevation&&(this._elevation=c,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,f,g){this._unmodified=!1,this._edgeInsets.interpolate(c,f,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const f=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(c){const f=[new o.UnwrappedTileID(0,c)];if(this._renderWorldCopies){const g=this.pointCoordinate(new o.pointGeometry(0,0)),_=this.pointCoordinate(new o.pointGeometry(this.width,0)),E=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),P=this.pointCoordinate(new o.pointGeometry(0,this.height)),R=Math.floor(Math.min(g.x,_.x,E.x,P.x)),k=Math.floor(Math.max(g.x,_.x,E.x,P.x)),z=1;for(let G=R-z;G<=k+z;G++)G!==0&&f.push(new o.UnwrappedTileID(G,c))}return f}coveringTiles(c){var f,g;let _=this.coveringZoomLevel(c);const E=_;if(c.minzoom!==void 0&&_<c.minzoom)return[];c.maxzoom!==void 0&&_>c.maxzoom&&(_=c.maxzoom);const P=this.pointCoordinate(this.getCameraPoint()),R=o.MercatorCoordinate.fromLngLat(this.center),k=Math.pow(2,_),z=[k*P.x,k*P.y,0],G=[k*R.x,k*R.y,0],q=yh.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,_);let Y=c.minzoom||0;!c.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(Y=_);const de=c.terrain?2/Math.min(this.tileSize,c.tileSize)*this.tileSize:3,ce=he=>({aabb:new Nu([he*k,0,0],[(he+1)*k,k,0]),zoom:0,x:0,y:0,wrap:he,fullyVisible:!1}),ue=[],we=[],Ce=_,Oe=c.reparseOverscaled?E:_;if(this._renderWorldCopies)for(let he=1;he<=3;he++)ue.push(ce(-he)),ue.push(ce(he));for(ue.push(ce(0));ue.length>0;){const he=ue.pop(),ze=he.x,Fe=he.y;let He=he.fullyVisible;if(!He){const Ct=he.aabb.intersects(q);if(Ct===0)continue;He=Ct===2}const qe=c.terrain?z:G,tt=he.aabb.distanceX(qe),Ge=he.aabb.distanceY(qe),At=Math.max(Math.abs(tt),Math.abs(Ge)),mt=de+(1<<Ce-he.zoom)-2;if(he.zoom===Ce||At>mt&&he.zoom>=Y){const Ct=Ce-he.zoom,sn=z[0]-.5-(ze<<Ct),gn=z[1]-.5-(Fe<<Ct);we.push({tileID:new o.OverscaledTileID(he.zoom===Ce?Oe:he.zoom,he.wrap,he.zoom,ze,Fe),distanceSq:o.sqrLen([G[0]-.5-ze,G[1]-.5-Fe]),tileDistanceToCamera:Math.sqrt(sn*sn+gn*gn)})}else for(let Ct=0;Ct<4;Ct++){const sn=(ze<<1)+Ct%2,gn=(Fe<<1)+(Ct>>1),Wt=he.zoom+1;let Kn=he.aabb.quadrant(Ct);if(c.terrain){const Xn=new o.OverscaledTileID(Wt,he.wrap,Wt,sn,gn),kn=c.terrain.getMinMaxElevation(Xn),Dn=(f=kn.minElevation)!==null&&f!==void 0?f:this.elevation,Jn=(g=kn.maxElevation)!==null&&g!==void 0?g:this.elevation;Kn=new Nu([Kn.min[0],Kn.min[1],Dn],[Kn.max[0],Kn.max[1],Jn])}ue.push({aabb:Kn,zoom:Wt,x:sn,y:gn,wrap:he.wrap,fullyVisible:He})}}return we.sort((he,ze)=>he.distanceSq-ze.distanceSq).map(he=>he.tileID)}resize(c,f){this.width=c,this.height=f,this.pixelsToGLUnits=[2/c,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const f=o.clamp(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new o.pointGeometry(o.mercatorXfromLng(c.lng)*this.worldSize,o.mercatorYfromLat(f)*this.worldSize)}unproject(c){return new o.MercatorCoordinate(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(c){this.freezeElevation||(this.elevation=c?this.getElevation(this._center,c):0)}getElevation(c,f){const g=o.MercatorCoordinate.fromLngLat(c),_=(1<<this.tileZoom)*o.EXTENT,E=g.x*_,P=g.y*_,R=Math.floor(E/o.EXTENT),k=Math.floor(P/o.EXTENT),z=new o.OverscaledTileID(this.tileZoom,0,this.tileZoom,R,k);return f.getElevation(z,E%o.EXTENT,P%o.EXTENT,o.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(c){const f=this.pointLocation(this.centerPoint,c),g=this.getElevation(f,c);if(!(this.elevation-g))return;const _=this.getCameraPosition(),E=o.MercatorCoordinate.fromLngLat(_.lngLat,_.altitude),P=o.MercatorCoordinate.fromLngLat(f,g),R=E.x-P.x,k=E.y-P.y,z=E.z-P.z,G=Math.sqrt(R*R+k*k+z*z),q=this.scaleZoom(this.cameraToCenterDistance/G/this.tileSize);this._elevation=g,this._center=f,this.zoom=q}setLocationAtPoint(c,f){const g=this.pointCoordinate(f),_=this.pointCoordinate(this.centerPoint),E=this.locationCoordinate(c),P=new o.MercatorCoordinate(E.x-(g.x-_.x),E.y-(g.y-_.y));this.center=this.coordinateLocation(P),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(c,f){return f?this.coordinatePoint(this.locationCoordinate(c),this.getElevation(c,f),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(c))}pointLocation(c,f){return this.coordinateLocation(this.pointCoordinate(c,f))}locationCoordinate(c){return o.MercatorCoordinate.fromLngLat(c)}coordinateLocation(c){return c&&c.toLngLat()}pointCoordinate(c,f){if(f){const Y=f.pointCoordinate(c);if(Y!=null)return Y}const g=[c.x,c.y,0,1],_=[c.x,c.y,1,1];o.transformMat4(g,g,this.pixelMatrixInverse),o.transformMat4(_,_,this.pixelMatrixInverse);const E=g[3],P=_[3],R=g[1]/E,k=_[1]/P,z=g[2]/E,G=_[2]/P,q=z===G?0:(0-z)/(G-z);return new o.MercatorCoordinate(o.number(g[0]/E,_[0]/P,q)/this.worldSize,o.number(R,k,q)/this.worldSize)}coordinatePoint(c,f=0,g=this.pixelMatrix){const _=[c.x*this.worldSize,c.y*this.worldSize,f,1];return o.transformMat4(_,_,g),new o.pointGeometry(_[0]/_[3],_[1]/_[3])}getBounds(){const c=Math.max(0,this.height/2-this.getHorizon());return new o.LngLatBounds().extend(this.pointLocation(new o.pointGeometry(0,c))).extend(this.pointLocation(new o.pointGeometry(this.width,c))).extend(this.pointLocation(new o.pointGeometry(this.width,this.height))).extend(this.pointLocation(new o.pointGeometry(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new o.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(c,f=!1){const g=c.key,_=f?this._alignedPosMatrixCache:this._posMatrixCache;if(_[g])return _[g];const E=c.canonical,P=this.worldSize/this.zoomScale(E.z),R=E.x+Math.pow(2,E.z)*c.wrap,k=o.identity(new Float64Array(16));return o.translate(k,k,[R*P,E.y*P,0]),o.scale(k,k,[P/o.EXTENT,P/o.EXTENT,1]),o.multiply(k,f?this.alignedProjMatrix:this.projMatrix,k),_[g]=new Float32Array(k),_[g]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let c,f,g,_,E=-90,P=90,R=-180,k=180;const z=this.size,G=this._unmodified;if(this.latRange){const de=this.latRange;E=o.mercatorYfromLat(de[1])*this.worldSize,P=o.mercatorYfromLat(de[0])*this.worldSize,c=P-E<z.y?z.y/(P-E):0}if(this.lngRange){const de=this.lngRange;R=o.wrap(o.mercatorXfromLng(de[0])*this.worldSize,0,this.worldSize),k=o.wrap(o.mercatorXfromLng(de[1])*this.worldSize,0,this.worldSize),k<R&&(k+=this.worldSize),f=k-R<z.x?z.x/(k-R):0}const q=this.point,Y=Math.max(f||0,c||0);if(Y)return this.center=this.unproject(new o.pointGeometry(f?(k+R)/2:q.x,c?(P+E)/2:q.y)),this.zoom+=this.scaleZoom(Y),this._unmodified=G,void(this._constraining=!1);if(this.latRange){const de=q.y,ce=z.y/2;de-ce<E&&(_=E+ce),de+ce>P&&(_=P-ce)}if(this.lngRange){const de=(R+k)/2,ce=o.wrap(q.x,de-this.worldSize/2,de+this.worldSize/2),ue=z.x/2;ce-ue<R&&(g=R+ue),ce+ue>k&&(g=k-ue)}g===void 0&&_===void 0||(this.center=this.unproject(new o.pointGeometry(g!==void 0?g:q.x,_!==void 0?_:q.y)).wrap()),this._unmodified=G,this._constraining=!1}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,f=this.point.x,g=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let _=o.identity(new Float64Array(16));o.scale(_,_,[this.width/2,-this.height/2,1]),o.translate(_,_,[1,-1,0]),this.labelPlaneMatrix=_,_=o.identity(new Float64Array(16)),o.scale(_,_,[1,-1,1]),o.translate(_,_,[-1,-1,0]),o.scale(_,_,[2/this.width,2/this.height,1]),this.glCoordMatrix=_,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const E=Math.PI/2+this._pitch,P=this._fov*(.5+c.y/this.height),R=Math.sin(P)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-E-P,.01,Math.PI-.01)),k=this.getHorizon(),z=2*Math.atan(k/this.cameraToCenterDistance)*(.5+c.y/(2*k)),G=Math.sin(z)*this.cameraToSeaLevelDistance/Math.sin(o.clamp(Math.PI-E-z,.01,Math.PI-.01)),q=Math.cos(Math.PI/2-this._pitch)*R+this.cameraToSeaLevelDistance,Y=Math.cos(Math.PI/2-this._pitch)*G+this.cameraToSeaLevelDistance,de=1.01*Math.min(q,Y),ce=this.height/50;_=new Float64Array(16),o.perspective(_,this._fov,this.width/this.height,ce,de),_[8]=2*-c.x/this.width,_[9]=2*c.y/this.height,o.scale(_,_,[1,-1,1]),o.translate(_,_,[0,0,-this.cameraToCenterDistance]),o.rotateX(_,_,this._pitch),o.rotateZ(_,_,this.angle),o.translate(_,_,[-f,-g,0]),this.mercatorMatrix=o.scale([],_,[this.worldSize,this.worldSize,this.worldSize]),o.scale(_,_,[1,1,this._pixelPerMeter]),this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,_),o.translate(_,_,[0,0,-this.elevation]),this.projMatrix=_,this.invProjMatrix=o.invert([],_),this.pixelMatrix3D=o.multiply(new Float64Array(16),this.labelPlaneMatrix,_);const ue=this.width%2/2,we=this.height%2/2,Ce=Math.cos(this.angle),Oe=Math.sin(this.angle),he=f-Math.round(f)+Ce*ue+Oe*we,ze=g-Math.round(g)+Ce*we+Oe*ue,Fe=new Float64Array(_);if(o.translate(Fe,Fe,[he>.5?he-1:he,ze>.5?ze-1:ze,0]),this.alignedProjMatrix=Fe,_=o.invert(new Float64Array(16),this.pixelMatrix),!_)throw new Error("failed to invert matrix");this.pixelMatrixInverse=_,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const c=this.pointCoordinate(new o.pointGeometry(0,0)),f=[c.x*this.worldSize,c.y*this.worldSize,0,1];return o.transformMat4(f,f,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,c))}getCameraQueryGeometry(c){const f=this.getCameraPoint();if(c.length===1)return[c[0],f];{let g=f.x,_=f.y,E=f.x,P=f.y;for(const R of c)g=Math.min(g,R.x),_=Math.min(_,R.y),E=Math.max(E,R.x),P=Math.max(P,R.y);return[new o.pointGeometry(g,_),new o.pointGeometry(E,_),new o.pointGeometry(E,P),new o.pointGeometry(g,P),new o.pointGeometry(g,_)]}}}class S0{constructor(c){this._hashName=c&&encodeURIComponent(c),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(f,g){let _=!1,E=null;const P=()=>{E=null,_&&(f(),E=setTimeout(P,300),_=!1)};return()=>(_=!0,E||P(),E)}(this._updateHashUnthrottled.bind(this))}addTo(c){return this._map=c,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(c){const f=this._map.getCenter(),g=Math.round(100*this._map.getZoom())/100,_=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,_),P=Math.round(f.lng*E)/E,R=Math.round(f.lat*E)/E,k=this._map.getBearing(),z=this._map.getPitch();let G="";if(G+=c?`/${P}/${R}/${g}`:`${g}/${R}/${P}`,(k||z)&&(G+="/"+Math.round(10*k)/10),z&&(G+=`/${Math.round(z)}`),this._hashName){const q=this._hashName;let Y=!1;const de=window.location.hash.slice(1).split("&").map(ce=>{const ue=ce.split("=")[0];return ue===q?(Y=!0,`${ue}=${G}`):ce}).filter(ce=>ce);return Y||de.push(`${q}=${G}`),`#${de.join("&")}`}return`#${G}`}_getCurrentHash(){const c=window.location.hash.replace("#","");if(this._hashName){let f;return c.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(f=g)}),(f&&f[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._getCurrentHash();if(c.length>=3&&!c.some(f=>isNaN(f))){const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(c[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:f,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,c)}catch{}}}const Bu={linearity:.3,easing:o.bezier(0,0,.3,1)},A0=o.extend({deceleration:2500,maxSpeed:1400},Bu),P0=o.extend({deceleration:20,maxSpeed:1400},Bu),C0=o.extend({deceleration:1e3,maxSpeed:360},Bu),Ec=o.extend({deceleration:1e3,maxSpeed:90},Bu);class L0{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,f=o.exported.now();for(;c.length>0&&f-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const f={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)f.zoom+=E.zoomDelta||0,f.bearing+=E.bearingDelta||0,f.pitch+=E.pitchDelta||0,E.panDelta&&f.pan._add(E.panDelta),E.around&&(f.around=E.around),E.pinchAround&&(f.pinchAround=E.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(f.pan.mag()){const E=Vu(f.pan.mag(),g,o.extend({},A0,c||{}));_.offset=f.pan.mult(E.amount/f.pan.mag()),_.center=this._map.transform.center,Uu(_,E)}if(f.zoom){const E=Vu(f.zoom,g,P0);_.zoom=this._map.transform.zoom+E.amount,Uu(_,E)}if(f.bearing){const E=Vu(f.bearing,g,C0);_.bearing=this._map.transform.bearing+o.clamp(E.amount,-179,179),Uu(_,E)}if(f.pitch){const E=Vu(f.pitch,g,Ec);_.pitch=this._map.transform.pitch+E.amount,Uu(_,E)}if(_.zoom||_.bearing){const E=f.pinchAround===void 0?f.around:f.pinchAround;_.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),o.extend(_,{noMoveStart:!0})}}function Uu(y,c){(!y.duration||y.duration<c.duration)&&(y.duration=c.duration,y.easing=c.easing)}function Vu(y,c,f){const{maxSpeed:g,linearity:_,deceleration:E}=f,P=o.clamp(y*_/(c/1e3),-g,g),R=Math.abs(P)/(E*_);return{easing:f.easing,duration:1e3*R,amount:P*(R/2)}}class Ts extends o.Event{constructor(c,f,g,_={}){const E=w.mousePos(f.getCanvasContainer(),g),P=f.unproject(E);super(c,o.extend({point:E,lngLat:P,originalEvent:g},_)),this._defaultPrevented=!1,this.target=f}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class ju extends o.Event{constructor(c,f,g){const _=c==="touchend"?g.changedTouches:g.touches,E=w.touchPos(f.getCanvasContainer(),_),P=E.map(k=>f.unproject(k)),R=E.reduce((k,z,G,q)=>k.add(z.div(q.length)),new o.pointGeometry(0,0));super(c,{points:E,point:R,lngLats:P,lngLat:f.unproject(R),originalEvent:g}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Es extends o.Event{constructor(c,f,g){super(c,{originalEvent:g}),this._defaultPrevented=!1}preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}}class Qx{constructor(c,f){this._map=c,this._clickTolerance=f.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new Es(c.type,this._map,c))}mousedown(c,f){return this._mousedownPos=f,this._firePreventable(new Ts(c.type,this._map,c))}mouseup(c){this._map.fire(new Ts(c.type,this._map,c))}click(c,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||this._map.fire(new Ts(c.type,this._map,c))}dblclick(c){return this._firePreventable(new Ts(c.type,this._map,c))}mouseover(c){this._map.fire(new Ts(c.type,this._map,c))}mouseout(c){this._map.fire(new Ts(c.type,this._map,c))}touchstart(c){return this._firePreventable(new ju(c.type,this._map,c))}touchmove(c){this._map.fire(new ju(c.type,this._map,c))}touchend(c){this._map.fire(new ju(c.type,this._map,c))}touchcancel(c){this._map.fire(new ju(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Oa{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(c){this._map.fire(new Ts(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ts("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._ignoreContextMenu||this._map.fire(new Ts(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class I0{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,f){this.isEnabled()&&c.shiftKey&&c.button===0&&(w.disableDrag(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(c,f){if(!this._active)return;const g=f;if(this._lastPos.equals(g)||!this._box&&g.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=g,this._box||(this._box=w.create("div","maplibregl-boxzoom mapboxgl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair","mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const E=Math.min(_.x,g.x),P=Math.max(_.x,g.x),R=Math.min(_.y,g.y),k=Math.max(_.y,g.y);w.setTransform(this._box,`translate(${E}px,${R}px)`),this._box.style.width=P-E+"px",this._box.style.height=k-R+"px"}mouseupWindow(c,f){if(!this._active||c.button!==0)return;const g=this._startPos,_=f;if(this.reset(),w.suppressClick(),g.x!==_.x||g.y!==_.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:E=>E.fitScreenCoordinates(g,_,this._map.getBearing(),{linear:!0})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair","mapboxgl-crosshair"),this._box&&(w.remove(this._box),this._box=null),w.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,f){return this._map.fire(new o.Event(c,{originalEvent:f}))}}function ra(y,c){if(y.length!==c.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${c.length}`);const f={};for(let g=0;g<y.length;g++)f[y[g].identifier]=c[g];return f}class Gu{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,f,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),g.length===this.numTouches&&(this.centroid=function(_){const E=new o.pointGeometry(0,0);for(const P of _)E._add(P);return E.div(_.length)}(f),this.touches=ra(g,f)))}touchmove(c,f,g){if(this.aborted||!this.centroid)return;const _=ra(g,f);for(const E in this.touches){const P=this.touches[E],R=_[E];(!R||R.dist(P)>30)&&(this.aborted=!0)}}touchend(c,f,g){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Yp{constructor(c){this.singleTap=new Gu(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,f,g){this.singleTap.touchstart(c,f,g)}touchmove(c,f,g){this.singleTap.touchmove(c,f,g)}touchend(c,f,g){const _=this.singleTap.touchend(c,f,g);if(_){const E=c.timeStamp-this.lastTime<500,P=!this.lastTap||this.lastTap.dist(_)<30;if(E&&P||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class ew{constructor(){this._zoomIn=new Yp({numTouches:1,numTaps:2}),this._zoomOut=new Yp({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,f,g){this._zoomIn.touchstart(c,f,g),this._zoomOut.touchstart(c,f,g)}touchmove(c,f,g){this._zoomIn.touchmove(c,f,g),this._zoomOut.touchmove(c,f,g)}touchend(c,f,g){const _=this._zoomIn.touchend(c,f,g),E=this._zoomOut.touchend(c,f,g);return _?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()+1,around:P.unproject(_)},{originalEvent:c})}):E?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:P.getZoom()-1,around:P.unproject(E)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const tw={0:1,2:2};class vh{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(c,f){return!1}_move(c,f){return{}}mousedown(c,f){if(this._lastPoint)return;const g=w.mouseButton(c);this._correctButton(c,g)&&(this._lastPoint=f,this._eventButton=g)}mousemoveWindow(c,f){const g=this._lastPoint;if(g){if(c.preventDefault(),function(_,E){const P=tw[E];return _.buttons===void 0||(_.buttons&P)!==P}(c,this._eventButton))this.reset();else if(this._moved||!(f.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(g,f)}}mouseupWindow(c){this._lastPoint&&w.mouseButton(c)===this._eventButton&&(this._moved&&w.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wu extends vh{mousedown(c,f){super.mousedown(c,f),this._lastPoint&&(this._active=!0)}_correctButton(c,f){return f===0&&!c.ctrlKey}_move(c,f){return{around:f,panDelta:f.sub(c)}}}class ia extends vh{_correctButton(c,f){return f===0&&c.ctrlKey||f===2}_move(c,f){const g=.8*(f.x-c.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(c){c.preventDefault()}}class Rt extends vh{_correctButton(c,f){return f===0&&c.ctrlKey||f===2}_move(c,f){const g=-.5*(f.y-c.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(c){c.preventDefault()}}class R0{constructor(c,f){this._minTouches=c.cooperativeGestures?2:1,this._clickTolerance=c.clickTolerance||1,this._map=f,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(c,f,g){return this._calculateTransform(c,f,g)}touchmove(c,f,g){if(this._map._cooperativeGestures&&(this._minTouches===2&&g.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(c,!1,g.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(g.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,f,g)}touchend(c,f,g){this._calculateTransform(c,f,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,f,g){g.length>0&&(this._active=!0);const _=ra(g,f),E=new o.pointGeometry(0,0),P=new o.pointGeometry(0,0);let R=0;for(const z in _){const G=_[z],q=this._touches[z];q&&(E._add(G),P._add(G.sub(q)),R++,_[z]=G)}if(this._touches=_,R<this._minTouches||!P.mag())return;const k=P.div(R);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(R),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class vl{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(c){}_move(c,f,g){return{}}touchstart(c,f,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([f[0],f[1]]))}touchmove(c,f,g){if(!this._firstTwoTouches)return;c.preventDefault();const[_,E]=this._firstTwoTouches,P=Da(g,f,_),R=Da(g,f,E);if(!P||!R)return;const k=this._aroundCenter?null:P.add(R).div(2);return this._move([P,R],k,c)}touchend(c,f,g){if(!this._firstTwoTouches)return;const[_,E]=this._firstTwoTouches,P=Da(g,f,_),R=Da(g,f,E);P&&R||(this._active&&w.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Da(y,c,f){for(let g=0;g<y.length;g++)if(y[g].identifier===f)return c[g]}function Jp(y,c){return Math.log(y/c)/Math.LN2}class wt extends vl{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,f){const g=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(Jp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Jp(this._distance,g),pinchAround:f}}}function _h(y,c){return 180*y.angleWith(c)/Math.PI}class nw extends vl{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,f){const g=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:_h(this._vector,g),pinchAround:f}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const f=25/(Math.PI*this._minDiameter)*360,g=_h(c,this._startVector);return Math.abs(g)<f}}function Qp(y){return Math.abs(y.y)>Math.abs(y.x)}class em extends vl{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(c,f,g){super.touchstart(c,f,g),this._currentTouchCount=g.length}_start(c){this._lastPoints=c,Qp(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,f,g){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const _=c[0].sub(this._lastPoints[0]),E=c[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,E,g.timeStamp),this._valid?(this._lastPoints=c,this._active=!0,{pitchDelta:(_.y+E.y)/2*-.5}):void 0}gestureBeginsVertically(c,f,g){if(this._valid!==void 0)return this._valid;const _=c.mag()>=2,E=f.mag()>=2;if(!_&&!E)return;if(!_||!E)return this._firstMove===void 0&&(this._firstMove=g),g-this._firstMove<100&&void 0;const P=c.y>0==f.y>0;return Qp(c)&&Qp(f)&&P}}const M0={panStep:100,bearingStep:15,pitchStep:10};class $0{constructor(){const c=M0;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let f=0,g=0,_=0,E=0,P=0;switch(c.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:c.shiftKey?g=-1:(c.preventDefault(),E=-1);break;case 39:c.shiftKey?g=1:(c.preventDefault(),E=1);break;case 38:c.shiftKey?_=1:(c.preventDefault(),P=-1);break;case 40:c.shiftKey?_=-1:(c.preventDefault(),P=1);break;default:return}return this._rotationDisabled&&(g=0,_=0),{cameraAnimation:R=>{const k=R.getZoom();R.easeTo({duration:300,easeId:"keyboardHandler",easing:rw,zoom:f?Math.round(k)+f*(c.shiftKey?2:1):k,bearing:R.getBearing()+g*this._bearingStep,pitch:R.getPitch()+_*this._pitchStep,offset:[-E*this._panStep,-P*this._panStep],center:R.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function rw(y){return y*(2-y)}const k0=4.000244140625;class tm{constructor(c,f){this._map=c,this._el=c.getCanvasContainer(),this._handler=f,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=c&&c.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!this._map._metaPress)return;c.preventDefault()}let f=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const g=o.exported.now(),_=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,f!==0&&f%k0==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=f,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(_*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),c.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=c,this._delta-=f,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=w.mousePos(this._el,c);this._around=o.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(f)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;if(this._delta!==0){const R=this._type==="wheel"&&Math.abs(this._delta)>k0?this._wheelZoomRate:this._defaultZoomRate;let k=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&k!==0&&(k=1/k);const z=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(z*k))),this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const f=typeof this._targetZoom=="number"?this._targetZoom:c.zoom,g=this._startZoom,_=this._easing;let E,P=!1;if(this._type==="wheel"&&g&&_){const R=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),k=_(R);E=o.number(g,f,k),R<1?this._frameId||(this._frameId=!0):P=!0}else E=f,P=!0;return this._active=!0,P&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!P,zoomDelta:E-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let f=o.ease;if(this._prevEase){const g=this._prevEase,_=(o.exported.now()-g.start)/g.duration,E=g.easing(_+.01)-g.easing(_),P=.27/Math.sqrt(E*E+1e-4)*.01,R=Math.sqrt(.0729-P*P);f=o.bezier(P,R,.25,1)}return this._prevEase={start:o.exported.now(),duration:c,easing:f},f}reset(){this._active=!1}}class nm{constructor(c,f){this._clickZoom=c,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class rm{constructor(){this.reset()}reset(){this._active=!1}dblclick(c,f){return c.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(c.shiftKey?-1:1),around:g.unproject(f)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class im{constructor(){this._tap=new Yp({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(c,f,g){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=f[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(c,f,g))}touchmove(c,f,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const _=f[0],E=_.y-this._swipePoint.y;return this._swipePoint=_,c.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(c,f,g)}touchend(c,f,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(c,f,g)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class as{constructor(c,f,g){this._el=c,this._mousePan=f,this._touchPan=g}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan","mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Fa{constructor(c,f,g){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=f,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class O0{constructor(c,f,g,_){this._el=c,this._touchZoom=f,this._touchRotate=g,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate","mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Sc=y=>y.zoom||y.drag||y.pitch||y.rotate;class sm extends o.Event{}function Hu(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta}class D0{constructor(c,f){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new L0(c),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(f),o.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,E,P]of this._listeners)w.addEventListener(_,E,_===document?this.handleWindowEvent:this.handleEvent,P)}destroy(){for(const[c,f,g]of this._listeners)w.removeEventListener(c,f,c===document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(c){const f=this._map,g=f.getCanvasContainer();this._add("mapEvent",new Qx(f,c));const _=f.boxZoom=new I0(f,c);this._add("boxZoom",_);const E=new ew,P=new rm;f.doubleClickZoom=new nm(P,E),this._add("tapZoom",E),this._add("clickZoom",P);const R=new im;this._add("tapDragZoom",R);const k=f.touchPitch=new em(f);this._add("touchPitch",k);const z=new ia(c),G=new Rt(c);f.dragRotate=new Fa(c,z,G),this._add("mouseRotate",z,["mousePitch"]),this._add("mousePitch",G,["mouseRotate"]);const q=new Wu(c),Y=new R0(c,f);f.dragPan=new as(g,q,Y),this._add("mousePan",q),this._add("touchPan",Y,["touchZoom","touchRotate"]);const de=new nw,ce=new wt;f.touchZoomRotate=new O0(g,ce,de,R),this._add("touchRotate",de,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]);const ue=f.scrollZoom=new tm(f,this);this._add("scrollZoom",ue,["mousePan"]);const we=f.keyboard=new $0;this._add("keyboard",we),this._add("blockableMapEvent",new Oa(f));for(const Ce of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[Ce]&&f[Ce].enable(c[Ce])}_add(c,f,g){this._handlers.push({handlerName:c,handler:f,allowed:g}),this._handlersById[c]=f}stop(c){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Sc(this._eventsInProgress)||this.isZooming()}_blockedByActive(c,f,g){for(const _ in c)if(_!==g&&(!f||f.indexOf(_)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const f=[];for(const g of c)this._el.contains(g.target)&&f.push(g);return f}handleEvent(c,f){if(c.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const g=c.type==="renderFrame"?void 0:c,_={needsRenderFrame:!1},E={},P={},R=c.touches,k=R?this._getMapTouches(R):void 0,z=k?w.touchPos(this._el,k):w.mousePos(this._el,c);for(const{handlerName:Y,handler:de,allowed:ce}of this._handlers){if(!de.isEnabled())continue;let ue;this._blockedByActive(P,ce,Y)?de.reset():de[f||c.type]&&(ue=de[f||c.type](c,z,k),this.mergeHandlerResult(_,E,ue,Y,g),ue&&ue.needsRenderFrame&&this._triggerRenderFrame()),(ue||de.isActive())&&(P[Y]=de)}const G={};for(const Y in this._previousActiveHandlers)P[Y]||(G[Y]=g);this._previousActiveHandlers=P,(Object.keys(G).length||Hu(_))&&(this._changes.push([_,E,G]),this._triggerRenderFrame()),(Object.keys(P).length||Hu(_))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=_;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))}mergeHandlerResult(c,f,g,_,E){if(!g)return;o.extend(c,g);const P={handlerName:_,originalEvent:g.originalEvent||E};g.zoomDelta!==void 0&&(f.zoom=P),g.panDelta!==void 0&&(f.drag=P),g.pitchDelta!==void 0&&(f.pitch=P),g.bearingDelta!==void 0&&(f.rotate=P)}_applyChanges(){const c={},f={},g={};for(const[_,E,P]of this._changes)_.panDelta&&(c.panDelta=(c.panDelta||new o.pointGeometry(0,0))._add(_.panDelta)),_.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(c.around=_.around),_.pinchAround!==void 0&&(c.pinchAround=_.pinchAround),_.noInertia&&(c.noInertia=_.noInertia),o.extend(f,E),o.extend(g,P);this._updateMapTransform(c,f,g),this._changes=[]}_updateMapTransform(c,f,g){const _=this._map,E=_.transform,P=_.style&&_.style.terrain;if(!(Hu(c)||P&&this._drag))return this._fireEvents(f,g,!0);let{panDelta:R,zoomDelta:k,bearingDelta:z,pitchDelta:G,around:q,pinchAround:Y}=c;Y!==void 0&&(q=Y),_._stop(!0),q=q||_.transform.centerPoint;const de=E.pointLocation(R?q.sub(R):q);z&&(E.bearing+=z),G&&(E.pitch+=G),k&&(E.zoom+=k),P?f.drag&&!this._drag?(this._drag={center:E.centerPoint,lngLat:E.pointLocation(q),point:q,handlerName:f.drag.handlerName},_.fire(new o.Event("freezeElevation",{freeze:!0}))):this._drag&&g[this._drag.handlerName]?(_.fire(new o.Event("freezeElevation",{freeze:!1})),this._drag=null):f.drag&&this._drag&&(E.center=E.pointLocation(E.centerPoint.sub(R))):E.setLocationAtPoint(de,q),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(f,g,!0)}_fireEvents(c,f,g){const _=Sc(this._eventsInProgress),E=Sc(c),P={};for(const G in c){const{originalEvent:q}=c[G];this._eventsInProgress[G]||(P[`${G}start`]=q),this._eventsInProgress[G]=c[G]}!_&&E&&this._fireEvent("movestart",E.originalEvent);for(const G in P)this._fireEvent(G,P[G]);E&&this._fireEvent("move",E.originalEvent);for(const G in c){const{originalEvent:q}=c[G];this._fireEvent(G,q)}const R={};let k;for(const G in this._eventsInProgress){const{handlerName:q,originalEvent:Y}=this._eventsInProgress[G];this._handlersById[q].isActive()||(delete this._eventsInProgress[G],k=f[q]||Y,R[`${G}end`]=k)}for(const G in R)this._fireEvent(G,R[G]);const z=Sc(this._eventsInProgress);if(g&&(_||E)&&!z){this._updatingCamera=!0;const G=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=Y=>Y!==0&&-this._bearingSnap<Y&&Y<this._bearingSnap;G?(q(G.bearing||this._map.getBearing())&&(G.bearing=0),this._map.easeTo(G,{originalEvent:k})):(this._map.fire(new o.Event("moveend",{originalEvent:k})),q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,f){this._map.fire(new o.Event(c,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new sm("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const js={extend:(y,...c)=>o.extend(y,...c),run(y){y()},logToElement(y,c=!1,f="log"){const g=window.document.getElementById(f);g&&(c&&(g.innerHTML=""),g.innerHTML+=`<br>${y}`)}};class yr extends o.Evented{constructor(c,f){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=f.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,f){return this.jumpTo({center:c},f)}panBy(c,f,g){return c=o.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,o.extend({offset:c},f),g)}panTo(c,f,g){return this.easeTo(o.extend({center:c},f),g)}getZoom(){return this.transform.zoom}setZoom(c,f){return this.jumpTo({zoom:c},f),this}zoomTo(c,f,g){return this.easeTo(o.extend({zoom:c},f),g)}zoomIn(c,f){return this.zoomTo(this.getZoom()+1,c,f),this}zoomOut(c,f){return this.zoomTo(this.getZoom()-1,c,f),this}getBearing(){return this.transform.bearing}setBearing(c,f){return this.jumpTo({bearing:c},f),this}getPadding(){return this.transform.padding}setPadding(c,f){return this.jumpTo({padding:c},f),this}rotateTo(c,f,g){return this.easeTo(o.extend({bearing:c},f),g)}resetNorth(c,f){return this.rotateTo(0,o.extend({duration:1e3},c),f),this}resetNorthPitch(c,f){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},c),f),this}snapToNorth(c,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,f):this}getPitch(){return this.transform.pitch}setPitch(c,f){return this.jumpTo({pitch:c},f),this}cameraForBounds(c,f){c=o.LngLatBounds.convert(c);const g=f&&f.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),g,f)}_cameraForBoxAndBearing(c,f,g,_){const E={top:0,bottom:0,right:0,left:0};if(typeof(_=o.extend({padding:E,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding=="number"){const Fe=_.padding;_.padding={top:Fe,bottom:Fe,right:Fe,left:Fe}}_.padding=o.extend(E,_.padding);const P=this.transform,R=P.padding,k=P.project(o.LngLat.convert(c)),z=P.project(o.LngLat.convert(f)),G=k.rotate(-g*Math.PI/180),q=z.rotate(-g*Math.PI/180),Y=new o.pointGeometry(Math.max(G.x,q.x),Math.max(G.y,q.y)),de=new o.pointGeometry(Math.min(G.x,q.x),Math.min(G.y,q.y)),ce=Y.sub(de),ue=(P.width-(R.left+R.right+_.padding.left+_.padding.right))/ce.x,we=(P.height-(R.top+R.bottom+_.padding.top+_.padding.bottom))/ce.y;if(we<0||ue<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ce=Math.min(P.scaleZoom(P.scale*Math.min(ue,we)),_.maxZoom),Oe=o.pointGeometry.convert(_.offset),he=new o.pointGeometry((_.padding.left-_.padding.right)/2,(_.padding.top-_.padding.bottom)/2).rotate(g*Math.PI/180),ze=Oe.add(he).mult(P.scale/P.zoomScale(Ce));return{center:P.unproject(k.add(z).div(2).sub(ze)),zoom:Ce,bearing:g}}fitBounds(c,f,g){return this._fitInternal(this.cameraForBounds(c,f),f,g)}fitScreenCoordinates(c,f,g,_,E){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(c)),this.transform.pointLocation(o.pointGeometry.convert(f)),g,_),_,E)}_fitInternal(c,f,g){return c?(delete(f=o.extend(c,f)).padding,f.linear?this.easeTo(f,g):this.flyTo(f,g)):this}jumpTo(c,f){this.stop();const g=this.transform;let _=!1,E=!1,P=!1;return"zoom"in c&&g.zoom!==+c.zoom&&(_=!0,g.zoom=+c.zoom),c.center!==void 0&&(g.center=o.LngLat.convert(c.center)),"bearing"in c&&g.bearing!==+c.bearing&&(E=!0,g.bearing=+c.bearing),"pitch"in c&&g.pitch!==+c.pitch&&(P=!0,g.pitch=+c.pitch),c.padding==null||g.isPaddingEqual(c.padding)||(g.padding=c.padding),this.fire(new o.Event("movestart",f)).fire(new o.Event("move",f)),_&&this.fire(new o.Event("zoomstart",f)).fire(new o.Event("zoom",f)).fire(new o.Event("zoomend",f)),E&&this.fire(new o.Event("rotatestart",f)).fire(new o.Event("rotate",f)).fire(new o.Event("rotateend",f)),P&&this.fire(new o.Event("pitchstart",f)).fire(new o.Event("pitch",f)).fire(new o.Event("pitchend",f)),this.fire(new o.Event("moveend",f))}calculateCameraOptionsFromTo(c,f,g,_=0){const E=o.MercatorCoordinate.fromLngLat(c,f),P=o.MercatorCoordinate.fromLngLat(g,_),R=P.x-E.x,k=P.y-E.y,z=P.z-E.z,G=Math.hypot(R,k,z);if(G===0)throw new Error("Can't calculate camera options with same From and To");const q=Math.hypot(R,k),Y=this.transform.scaleZoom(this.transform.cameraToCenterDistance/G/this.transform.tileSize),de=180*Math.atan2(R,-k)/Math.PI;let ce=180*Math.acos(q/G)/Math.PI;return ce=z<0?90-ce:90+ce,{center:P.toLngLat(),zoom:Y,pitch:ce,bearing:de}}easeTo(c,f){this._stop(!1,c.easeId),((c=o.extend({offset:[0,0],duration:500,easing:o.ease},c)).animate===!1||!c.essential&&o.exported.prefersReducedMotion)&&(c.duration=0);const g=this.transform,_=this.getZoom(),E=this.getBearing(),P=this.getPitch(),R=this.getPadding(),k="zoom"in c?+c.zoom:_,z="bearing"in c?this._normalizeBearing(c.bearing,E):E,G="pitch"in c?+c.pitch:P,q="padding"in c?c.padding:g.padding,Y=o.pointGeometry.convert(c.offset);let de=g.centerPoint.add(Y);const ce=g.pointLocation(de),ue=o.LngLat.convert(c.center||ce);this._normalizeCenter(ue);const we=g.project(ce),Ce=g.project(ue).sub(we),Oe=g.zoomScale(k-_);let he,ze;c.around&&(he=o.LngLat.convert(c.around),ze=g.locationPoint(he));const Fe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||k!==_,this._rotating=this._rotating||E!==z,this._pitching=this._pitching||G!==P,this._padding=!g.isPaddingEqual(q),this._easeId=c.easeId,this._prepareEase(f,c.noMoveStart,Fe),this._ease(He=>{if(this._zooming&&(g.zoom=o.number(_,k,He)),this._rotating&&(g.bearing=o.number(E,z,He)),this._pitching&&(g.pitch=o.number(P,G,He)),this._padding&&(g.interpolatePadding(R,q,He),de=g.centerPoint.add(Y)),he)g.setLocationAtPoint(he,ze);else{const qe=g.zoomScale(g.zoom-_),tt=k>_?Math.min(2,Oe):Math.max(.5,Oe),Ge=Math.pow(tt,1-He),At=g.unproject(we.add(Ce.mult(He*Ge)).mult(qe));g.setLocationAtPoint(g.renderWorldCopies?At.wrap():At,de)}this._fireMoveEvents(f)},He=>{this._afterEase(f,He)},c),this}_prepareEase(c,f,g={}){this._moving=!0,this.fire(new o.Event("freezeElevation",{freeze:!0})),f||g.moving||this.fire(new o.Event("movestart",c)),this._zooming&&!g.zooming&&this.fire(new o.Event("zoomstart",c)),this._rotating&&!g.rotating&&this.fire(new o.Event("rotatestart",c)),this._pitching&&!g.pitching&&this.fire(new o.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new o.Event("move",c)),this._zooming&&this.fire(new o.Event("zoom",c)),this._rotating&&this.fire(new o.Event("rotate",c)),this._pitching&&this.fire(new o.Event("pitch",c))}_afterEase(c,f){if(this._easeId&&f&&this._easeId===f)return;delete this._easeId,this.fire(new o.Event("freezeElevation",{freeze:!1}));const g=this._zooming,_=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new o.Event("zoomend",c)),_&&this.fire(new o.Event("rotateend",c)),E&&this.fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c))}flyTo(c,f){if(!c.essential&&o.exported.prefersReducedMotion){const Wt=o.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Wt,f)}this.stop(),c=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},c);const g=this.transform,_=this.getZoom(),E=this.getBearing(),P=this.getPitch(),R=this.getPadding(),k="zoom"in c?o.clamp(+c.zoom,g.minZoom,g.maxZoom):_,z="bearing"in c?this._normalizeBearing(c.bearing,E):E,G="pitch"in c?+c.pitch:P,q="padding"in c?c.padding:g.padding,Y=g.zoomScale(k-_),de=o.pointGeometry.convert(c.offset);let ce=g.centerPoint.add(de);const ue=g.pointLocation(ce),we=o.LngLat.convert(c.center||ue);this._normalizeCenter(we);const Ce=g.project(ue),Oe=g.project(we).sub(Ce);let he=c.curve;const ze=Math.max(g.width,g.height),Fe=ze/Y,He=Oe.mag();if("minZoom"in c){const Wt=o.clamp(Math.min(c.minZoom,_,k),g.minZoom,g.maxZoom),Kn=ze/g.zoomScale(Wt-_);he=Math.sqrt(Kn/He*2)}const qe=he*he;function tt(Wt){const Kn=(Fe*Fe-ze*ze+(Wt?-1:1)*qe*qe*He*He)/(2*(Wt?Fe:ze)*qe*He);return Math.log(Math.sqrt(Kn*Kn+1)-Kn)}function Ge(Wt){return(Math.exp(Wt)-Math.exp(-Wt))/2}function At(Wt){return(Math.exp(Wt)+Math.exp(-Wt))/2}const mt=tt(0);let Ct=function(Wt){return At(mt)/At(mt+he*Wt)},sn=function(Wt){return ze*((At(mt)*(Ge(Kn=mt+he*Wt)/At(Kn))-Ge(mt))/qe)/He;var Kn},gn=(tt(1)-mt)/he;if(Math.abs(He)<1e-6||!isFinite(gn)){if(Math.abs(ze-Fe)<1e-6)return this.easeTo(c,f);const Wt=Fe<ze?-1:1;gn=Math.abs(Math.log(Fe/ze))/he,sn=function(){return 0},Ct=function(Kn){return Math.exp(Wt*he*Kn)}}return c.duration="duration"in c?+c.duration:1e3*gn/("screenSpeed"in c?+c.screenSpeed/he:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=E!==z,this._pitching=G!==P,this._padding=!g.isPaddingEqual(q),this._prepareEase(f,!1),this._ease(Wt=>{const Kn=Wt*gn,Xn=1/Ct(Kn);g.zoom=Wt===1?k:_+g.scaleZoom(Xn),this._rotating&&(g.bearing=o.number(E,z,Wt)),this._pitching&&(g.pitch=o.number(P,G,Wt)),this._padding&&(g.interpolatePadding(R,q,Wt),ce=g.centerPoint.add(de));const kn=Wt===1?we:g.unproject(Ce.add(Oe.mult(sn(Kn))).mult(Xn));g.setLocationAtPoint(g.renderWorldCopies?kn.wrap():kn,ce),this._fireMoveEvents(f)},()=>this._afterEase(f),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const g=this._onEaseEnd;delete this._onEaseEnd,g.call(this,f)}if(!c){const g=this.handlers;g&&g.stop(!1)}return this}_ease(c,f,g){g.animate===!1||g.duration===0?(c(1),f()):(this._easeStart=o.exported.now(),this._easeOptions=g,this._onEaseFrame=c,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,f){c=o.wrap(c,-180,180);const g=Math.abs(c-f);return Math.abs(c-360-f)<g&&(c-=360),Math.abs(c+360-f)<g&&(c+=360),c}_normalizeCenter(c){const f=this.transform;if(!f.renderWorldCopies||f.lngRange)return;const g=c.lng-f.center.lng;c.lng+=g>180?-360:g<-180?360:0}}class qu{constructor(c={}){this.options=c,o.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){return this._map=c,this._compact=this.options&&this.options.compact,this._container=w.create("details","maplibregl-ctrl maplibregl-ctrl-attrib mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=w.create("summary","maplibregl-ctrl-attrib-button mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=w.create("div","maplibregl-ctrl-attrib-inner mapboxgl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){w.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(c,f){const g=this._map._getUIString(`AttributionControl.${f}`);c.title=g,c.setAttribute("aria-label",g)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")):(this._container.classList.add("maplibregl-compact-show","mapboxgl-compact-show"),this._container.removeAttribute("open")))}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"&&c.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(_=>typeof _!="string"?"":_)):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const f=this._map.style.sourceCaches;for(const _ in f){const E=f[_];if(E.used||E.usedForTerrain){const P=E.getSource();P.attribution&&c.indexOf(P.attribution)<0&&c.push(P.attribution)}}c=c.filter(_=>String(_).trim()),c.sort((_,E)=>_.length-E.length),c=c.filter((_,E)=>{for(let P=E+1;P<c.length;P++)if(c[P].indexOf(_)>=0)return!1;return!0});const g=c.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,c.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("maplibregl-attrib-empty","mapboxgl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty","mapboxgl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","mapboxgl-compact","maplibregl-compact-show","mapboxgl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show","mapboxgl-compact","mapboxgl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show","mapboxgl-compact-show")}}class bh{constructor(c={}){this.options=c,o.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(c){this._map=c,this._compact=this.options&&this.options.compact,this._container=w.create("div","maplibregl-ctrl mapboxgl-ctrl");const f=w.create("a","maplibregl-ctrl-logo mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://maplibre.org/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){w.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const c=this._container.children;if(c.length){const f=c[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact","mapboxgl-compact"):f.classList.remove("maplibregl-compact","mapboxgl-compact")}}}class F0{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const f=++this._id;return this._queue.push({callback:c,id:f,cancelled:!1}),f}remove(c){const f=this._currentlyRunning,g=f?this._queue.concat(f):this._queue;for(const _ of g)if(_.id===c)return void(_.cancelled=!0)}run(c=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const f=this._currentlyRunning=this._queue;this._queue=[];for(const g of f)if(!g.cancelled&&(g.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const N0={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"},z0={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,fadeDuration:300,crossSourceCollisions:!0},iw={showCompass:!0,showZoom:!0,visualizePitch:!1};class Do{constructor(c,f,g=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new ia({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,g&&(this.mousePitch=new Rt({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),w.addEventListener(f,"mousedown",this.mousedown),w.addEventListener(f,"touchstart",this.touchstart,{passive:!1}),w.addEventListener(f,"touchmove",this.touchmove),w.addEventListener(f,"touchend",this.touchend),w.addEventListener(f,"touchcancel",this.reset)}down(c,f){this.mouseRotate.mousedown(c,f),this.mousePitch&&this.mousePitch.mousedown(c,f),w.disableDrag()}move(c,f){const g=this.map,_=this.mouseRotate.mousemoveWindow(c,f);if(_&&_.bearingDelta&&g.setBearing(g.getBearing()+_.bearingDelta),this.mousePitch){const E=this.mousePitch.mousemoveWindow(c,f);E&&E.pitchDelta&&g.setPitch(g.getPitch()+E.pitchDelta)}}off(){const c=this.element;w.removeEventListener(c,"mousedown",this.mousedown),w.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),w.removeEventListener(c,"touchmove",this.touchmove),w.removeEventListener(c,"touchend",this.touchend),w.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){w.enableDrag(),w.removeEventListener(window,"mousemove",this.mousemove),w.removeEventListener(window,"mouseup",this.mouseup)}mousedown(c){this.down(o.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),w.mousePos(this.element,c)),w.addEventListener(window,"mousemove",this.mousemove),w.addEventListener(window,"mouseup",this.mouseup)}mousemove(c){this.move(c,w.mousePos(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=w.touchPos(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=w.touchPos(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Ku(y,c,f){if(y=new o.LngLat(y.lng,y.lat),c){const g=new o.LngLat(y.lng-360,y.lat),_=new o.LngLat(y.lng+360,y.lat),E=f.locationPoint(y).distSqr(c);f.locationPoint(g).distSqr(c)<E?y=g:f.locationPoint(_).distSqr(c)<E&&(y=_)}for(;Math.abs(y.lng-f.center.lng)>180;){const g=f.locationPoint(y);if(g.x>=0&&g.y>=0&&g.x<=f.width&&g.y<=f.height)break;y.lng>f.center.lng?y.lng-=360:y.lng+=360}return y}const Nt={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Jt(y,c,f){const g=y.classList;for(const _ in Nt)g.remove(`maplibregl-${f}-anchor-${_}`,`mapboxgl-${f}-anchor-${_}`);g.add(`maplibregl-${f}-anchor-${c}`,`mapboxgl-${f}-anchor-${c}`)}class Ac extends o.Evented{constructor(c,f){if(super(),(c instanceof HTMLElement||f)&&(c=o.extend({element:c},f)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment!=="auto"?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=o.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=w.create("div"),this._element.setAttribute("aria-label","Map marker");const g=w.createNS("http://www.w3.org/2000/svg","svg"),_=41,E=27;g.setAttributeNS(null,"display","block"),g.setAttributeNS(null,"height",`${_}px`),g.setAttributeNS(null,"width",`${E}px`),g.setAttributeNS(null,"viewBox",`0 0 ${E} ${_}`);const P=w.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"stroke","none"),P.setAttributeNS(null,"stroke-width","1"),P.setAttributeNS(null,"fill","none"),P.setAttributeNS(null,"fill-rule","evenodd");const R=w.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"fill-rule","nonzero");const k=w.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");const z=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const Oe of z){const he=w.createNS("http://www.w3.org/2000/svg","ellipse");he.setAttributeNS(null,"opacity","0.04"),he.setAttributeNS(null,"cx","10.5"),he.setAttributeNS(null,"cy","5.80029008"),he.setAttributeNS(null,"rx",Oe.rx),he.setAttributeNS(null,"ry",Oe.ry),k.appendChild(he)}const G=w.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"fill",this._color);const q=w.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),G.appendChild(q);const Y=w.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"fill","#000000");const de=w.createNS("http://www.w3.org/2000/svg","path");de.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Y.appendChild(de);const ce=w.createNS("http://www.w3.org/2000/svg","g");ce.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ce.setAttributeNS(null,"fill","#FFFFFF");const ue=w.createNS("http://www.w3.org/2000/svg","g");ue.setAttributeNS(null,"transform","translate(8.0, 8.0)");const we=w.createNS("http://www.w3.org/2000/svg","circle");we.setAttributeNS(null,"fill","#000000"),we.setAttributeNS(null,"opacity","0.25"),we.setAttributeNS(null,"cx","5.5"),we.setAttributeNS(null,"cy","5.5"),we.setAttributeNS(null,"r","5.4999962");const Ce=w.createNS("http://www.w3.org/2000/svg","circle");Ce.setAttributeNS(null,"fill","#FFFFFF"),Ce.setAttributeNS(null,"cx","5.5"),Ce.setAttributeNS(null,"cy","5.5"),Ce.setAttributeNS(null,"r","5.4999962"),ue.appendChild(we),ue.appendChild(Ce),R.appendChild(k),R.appendChild(G),R.appendChild(Y),R.appendChild(ce),R.appendChild(ue),g.appendChild(R),g.setAttributeNS(null,"height",_*this._scale+"px"),g.setAttributeNS(null,"width",E*this._scale+"px"),this._element.appendChild(g),this._offset=o.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.classList.add("maplibregl-marker","mapboxgl-marker"),this._element.addEventListener("dragstart",g=>{g.preventDefault()}),this._element.addEventListener("mousedown",g=>{g.preventDefault()}),Jt(this._element,this._anchor,"marker"),this._popup=null}addTo(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),w.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=o.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(c){const f=c.code,g=c.charCode||c.keyCode;f!=="Space"&&f!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(c){const f=c.originalEvent.target,g=this._element;this._popup&&(f===g||g.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this}_update(c){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Ku(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let f="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?f=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(f=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g=`rotateX(${this._map.getPitch()}deg)`),c&&c.type!=="moveend"||(this._pos=this._pos.round()),w.setTransform(this._element,`${Nt[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${g} ${f}`),this._map.style&&this._map.style.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const _=this._map.unproject(this._pos),E=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=_.distanceTo(this._lngLat)>20*E?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(c){return this._offset=o.pointGeometry.convert(c),this._update(),this}_onMove(c){if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=c.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=c.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(c){this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(this._pos).add(this._offset),this._pointerdownPos=c.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&c!=="auto"?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const om={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Na,Li=0,za=!1;const Fo={maxWidth:100,unit:"metric"};function B0(y,c,f){const g=f&&f.maxWidth||100,_=y._container.clientHeight/2,E=y.unproject([0,_]),P=y.unproject([g,_]),R=E.distanceTo(P);if(f&&f.unit==="imperial"){const k=3.2808*R;k>5280?Ba(c,g,k/5280,y._getUIString("ScaleControl.Miles")):Ba(c,g,k,y._getUIString("ScaleControl.Feet"))}else f&&f.unit==="nautical"?Ba(c,g,R/1852,y._getUIString("ScaleControl.NauticalMiles")):R>=1e3?Ba(c,g,R/1e3,y._getUIString("ScaleControl.Kilometers")):Ba(c,g,R,y._getUIString("ScaleControl.Meters"))}function Ba(y,c,f,g){const _=function(E){const P=Math.pow(10,`${Math.floor(E)}`.length-1);let R=E/P;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(k){const z=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*z)/z}(R),P*R}(f);y.style.width=c*(_/f)+"px",y.innerHTML=`${_}&nbsp;${g}`}const zr={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ei=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function am(y){if(y){if(typeof y=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(y,2)));return{center:new o.pointGeometry(0,0),top:new o.pointGeometry(0,y),"top-left":new o.pointGeometry(c,c),"top-right":new o.pointGeometry(-c,c),bottom:new o.pointGeometry(0,-y),"bottom-left":new o.pointGeometry(c,-c),"bottom-right":new o.pointGeometry(-c,-c),left:new o.pointGeometry(y,0),right:new o.pointGeometry(-y,0)}}if(y instanceof o.pointGeometry||Array.isArray(y)){const c=o.pointGeometry.convert(y);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:o.pointGeometry.convert(y.center||[0,0]),top:o.pointGeometry.convert(y.top||[0,0]),"top-left":o.pointGeometry.convert(y["top-left"]||[0,0]),"top-right":o.pointGeometry.convert(y["top-right"]||[0,0]),bottom:o.pointGeometry.convert(y.bottom||[0,0]),"bottom-left":o.pointGeometry.convert(y["bottom-left"]||[0,0]),"bottom-right":o.pointGeometry.convert(y["bottom-right"]||[0,0]),left:o.pointGeometry.convert(y.left||[0,0]),right:o.pointGeometry.convert(y.right||[0,0])}}return am(new o.pointGeometry(0,0))}const _l={supported:h,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends yr{constructor(y){var c;if(o.PerformanceUtils.mark(o.PerformanceMarkers.create),(y=o.extend({},z0,y)).minZoom!=null&&y.maxZoom!=null&&y.minZoom>y.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(y.minPitch!=null&&y.maxPitch!=null&&y.minPitch>y.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(y.minPitch!=null&&y.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(y.maxPitch!=null&&y.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new zu(y.minZoom,y.maxZoom,y.minPitch,y.maxPitch,y.renderWorldCopies),{bearingSnap:y.bearingSnap}),this._interactive=y.interactive,this._cooperativeGestures=y.cooperativeGestures,this._maxTileCacheSize=y.maxTileCacheSize,this._failIfMajorPerformanceCaveat=y.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=y.preserveDrawingBuffer,this._antialias=y.antialias,this._trackResize=y.trackResize,this._bearingSnap=y.bearingSnap,this._refreshExpiredTiles=y.refreshExpiredTiles,this._fadeDuration=y.fadeDuration,this._crossSourceCollisions=y.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=y.collectResourceTiming,this._renderTaskQueue=new F0,this._controls=[],this._mapId=o.uniqueId(),this._locale=o.extend({},N0,y.locale),this._clickTolerance=y.clickTolerance,this._pixelRatio=(c=y.pixelRatio)!==null&&c!==void 0?c:devicePixelRatio,this._requestManager=new A(y.transformRequest),typeof y.container=="string"){if(this._container=document.getElementById(y.container),!this._container)throw new Error(`Container '${y.container}' not found.`)}else{if(!(y.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=y.container}if(y.maxBounds&&this.setMaxBounds(y.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),typeof window<"u"&&(addEventListener("online",this._onWindowOnline,!1),addEventListener("resize",this._onWindowResize,!1),addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new D0(this,y),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=y.hash&&new S0(typeof y.hash=="string"&&y.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch}),y.bounds&&(this.resize(),this.fitBounds(y.bounds,o.extend({},y.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=y.localIdeographFontFamily,y.style&&this.setStyle(y.style,{localIdeographFontFamily:y.localIdeographFontFamily}),y.attributionControl&&this.addControl(new qu({customAttribution:y.customAttribution})),y.maplibreLogo&&this.addControl(new bh,y.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",f=>{this._update(f.dataType==="style"),this.fire(new o.Event(`${f.dataType}data`,f))}),this.on("dataloading",f=>{this.fire(new o.Event(`${f.dataType}dataloading`,f))}),this.on("dataabort",f=>{this.fire(new o.Event("sourcedataabort",f))})}_getMapId(){return this._mapId}addControl(y,c){if(c===void 0&&(c=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=y.onAdd(this);this._controls.push(y);const g=this._controlPositions[c];return c.indexOf("bottom")!==-1?g.insertBefore(f,g.firstChild):g.appendChild(f),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(y);return c>-1&&this._controls.splice(c,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,c,f,g){return g==null&&this.style.terrain&&(g=this.transform.getElevation(f,this.style.terrain)),super.calculateCameraOptionsFromTo(y,c,f,g)}resize(y){const c=this._containerDimensions(),f=c[0],g=c[1];this._resizeCanvas(f,g,this.getPixelRatio()),this.transform.resize(f,g),this.painter.resize(f,g,this.getPixelRatio());const _=!this._moving;return _&&(this.stop(),this.fire(new o.Event("movestart",y)).fire(new o.Event("move",y))),this.fire(new o.Event("resize",y)),_&&this.fire(new o.Event("moveend",y)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(y){const[c,f]=this._containerDimensions();this._pixelRatio=y,this._resizeCanvas(c,f,y),this.painter.resize(c,f,y)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(o.LngLatBounds.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.minZoom=y,this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.maxZoom=y,this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.minPitch=y,this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(y>=this.transform.minPitch)return this.transform.maxPitch=y,this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.renderWorldCopies=y,this._update()}project(y){return this.transform.locationPoint(o.LngLat.convert(y),this.style&&this.style.terrain)}unproject(y){return this.transform.pointLocation(o.pointGeometry.convert(y),this.style&&this.style.terrain)}isMoving(){return this._moving||this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers.isRotating()}_createDelegatedListener(y,c,f){if(y==="mouseenter"||y==="mouseover"){let g=!1;return{layer:c,listener:f,delegates:{mousemove:E=>{const P=this.getLayer(c)?this.queryRenderedFeatures(E.point,{layers:[c]}):[];P.length?g||(g=!0,f.call(this,new Ts(y,this,E.originalEvent,{features:P}))):g=!1},mouseout:()=>{g=!1}}}}if(y==="mouseleave"||y==="mouseout"){let g=!1;return{layer:c,listener:f,delegates:{mousemove:P=>{(this.getLayer(c)?this.queryRenderedFeatures(P.point,{layers:[c]}):[]).length?g=!0:g&&(g=!1,f.call(this,new Ts(y,this,P.originalEvent)))},mouseout:P=>{g&&(g=!1,f.call(this,new Ts(y,this,P.originalEvent)))}}}}{const g=_=>{const E=this.getLayer(c)?this.queryRenderedFeatures(_.point,{layers:[c]}):[];E.length&&(_.features=E,f.call(this,_),delete _.features)};return{layer:c,listener:f,delegates:{[y]:g}}}}on(y,c,f){if(f===void 0)return super.on(y,c);const g=this._createDelegatedListener(y,c,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(g);for(const _ in g.delegates)this.on(_,g.delegates[_]);return this}once(y,c,f){if(f===void 0)return super.once(y,c);const g=this._createDelegatedListener(y,c,f);for(const _ in g.delegates)this.once(_,g.delegates[_]);return this}off(y,c,f){return f===void 0?super.off(y,c):(this._delegatedListeners&&this._delegatedListeners[y]&&(g=>{const _=this._delegatedListeners[y];for(let E=0;E<_.length;E++){const P=_[E];if(P.layer===c&&P.listener===f){for(const R in P.delegates)this.off(R,P.delegates[R]);return _.splice(E,1),this}}})(),this)}queryRenderedFeatures(y,c){if(!this.style)return[];let f;if(c!==void 0||y===void 0||y instanceof o.pointGeometry||Array.isArray(y)||(c=y,y=void 0),c=c||{},(y=y||[[0,0],[this.transform.width,this.transform.height]])instanceof o.pointGeometry||typeof y[0]=="number")f=[o.pointGeometry.convert(y)];else{const g=o.pointGeometry.convert(y[0]),_=o.pointGeometry.convert(y[1]);f=[g,new o.pointGeometry(_.x,g.y),_,new o.pointGeometry(g.x,_.y),g]}return this.style.queryRenderedFeatures(f,c,this.transform)}querySourceFeatures(y,c){return this.style.querySourceFeatures(y,c)}setStyle(y,c){return(c=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(y,c))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const c=this._locale[y];if(c==null)throw new Error(`Missing UI string '${y}'`);return c}_updateStyle(y,c){return this.style&&(this.style.setEventedParent(null),this.style._remove()),y?(this.style=new ci(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y):this.style.loadJSON(y),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ci(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,c){if(typeof y=="string"){const f=this._requestManager.transformRequest(y,o.ResourceType.Style);o.getJSON(f,(g,_)=>{g?this.fire(new o.ErrorEvent(g)):_&&this._updateDiff(_,c)})}else typeof y=="object"&&this._updateDiff(y,c)}_updateDiff(y,c){try{this.style.setState(y)&&this._update(!0)}catch(f){o.warnOnce(`Unable to perform style diff: ${f.message||f.error||f}.  Rebuilding the style from scratch.`),this._updateStyle(y,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():o.warnOnce("There is no style added to the map.")}addSource(y,c){return this._lazyInitEmptyStyle(),this.style.addSource(y,c),this._update(!0)}isSourceLoaded(y){const c=this.style&&this.style.sourceCaches[y];if(c!==void 0)return c.loaded();this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){return this.style.setTerrain(y),this}getTerrain(){return this.style.terrain&&this.style.terrain.options}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const c in y){const f=y[c]._tiles;for(const g in f){const _=f[g];if(_.state!=="loaded"&&_.state!=="errored")return!1}}return!0}addSourceType(y,c,f){return this._lazyInitEmptyStyle(),this.style.addSourceType(y,c,f)}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,c,{pixelRatio:f=1,sdf:g=!1,stretchX:_,stretchY:E,content:P}={}){if(this._lazyInitEmptyStyle(),c instanceof HTMLImageElement||o.isImageBitmap(c)){const{width:R,height:k,data:z}=o.exported.getImageData(c);this.style.addImage(y,{data:new o.RGBAImage({width:R,height:k},z),pixelRatio:f,stretchX:_,stretchY:E,content:P,sdf:g,version:0})}else{if(c.width===void 0||c.height===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:R,height:k,data:z}=c,G=c;this.style.addImage(y,{data:new o.RGBAImage({width:R,height:k},new Uint8Array(z)),pixelRatio:f,stretchX:_,stretchY:E,content:P,sdf:g,version:0,userImage:G}),G.onAdd&&G.onAdd(this,y)}}}updateImage(y,c){const f=this.style.getImage(y);if(!f)return this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=c instanceof HTMLImageElement||o.isImageBitmap(c)?o.exported.getImageData(c):c,{width:_,height:E,data:P}=g;if(_===void 0||E===void 0)return this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==f.data.width||E!==f.data.height)return this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const R=!(c instanceof HTMLImageElement||o.isImageBitmap(c));f.data.replace(P,R),this.style.updateImage(y,f)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y,c){o.getImage(this._requestManager.transformRequest(y,o.ResourceType.Image),c)}listImages(){return this.style.listImages()}addLayer(y,c){return this._lazyInitEmptyStyle(),this.style.addLayer(y,c),this._update(!0)}moveLayer(y,c){return this.style.moveLayer(y,c),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}setLayerZoomRange(y,c,f){return this.style.setLayerZoomRange(y,c,f),this._update(!0)}setFilter(y,c,f={}){return this.style.setFilter(y,c,f),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,c,f,g={}){return this.style.setPaintProperty(y,c,f,g),this._update(!0)}getPaintProperty(y,c){return this.style.getPaintProperty(y,c)}setLayoutProperty(y,c,f,g={}){return this.style.setLayoutProperty(y,c,f,g),this._update(!0)}getLayoutProperty(y,c){return this.style.getLayoutProperty(y,c)}setLight(y,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,c),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(y,c){return this.style.setFeatureState(y,c),this._update()}removeFeatureState(y,c){return this.style.removeFeatureState(y,c),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,c=0;return this._container&&(y=this._container.clientWidth||400,c=this._container.clientHeight||300),[y,c]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map","mapboxgl-map");const c=this._canvasContainer=w.create("div","maplibregl-canvas-container mapboxgl-canvas-container",y);this._interactive&&c.classList.add("maplibregl-interactive","mapboxgl-interactive"),this._canvas=w.create("canvas","maplibregl-canvas mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const f=this._containerDimensions();this._resizeCanvas(f[0],f[1],this.getPixelRatio());const g=this._controlContainer=w.create("div","maplibregl-control-container mapboxgl-control-container",y),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(E=>{_[E]=w.create("div",`maplibregl-ctrl-${E} mapboxgl-ctrl-${E}`,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){const y=this._container;this._metaPress=!1,this._cooperativeGesturesScreen=w.create("div","maplibregl-cooperative-gesture-screen",y);let c="Control",f=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(f=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map",c="Meta"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${f}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,document.addEventListener("keydown",g=>{g.key===c&&(this._metaPress=!0)}),document.addEventListener("keyup",g=>{g.key===c&&(this._metaPress=!1)}),this._canvasContainer.addEventListener("wheel",g=>{this._onCooperativeGesture(g,this._metaPress,1)},!1),this._canvasContainer.classList.remove("mapboxgl-touch-drag-pan","maplibregl-touch-drag-pan")}_resizeCanvas(y,c,f){this._canvas.width=f*y,this._canvas.height=f*c,this._canvas.style.width=`${y}px`,this._canvas.style.height=`${c}px`}_setupPainter(){const y=o.extend({},h.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._canvas.getContext("webgl",y)||this._canvas.getContext("experimental-webgl",y);c?(this.painter=new Zp(c,this.transform),o.exported$1.testSupport(c)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(y){y.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:y}))}_contextRestored(y){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:y}))}_onMapScroll(y){if(y.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(y,c,f){return!c&&f<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){let c,f=0;const g=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(c=g.createQueryEXT(),g.beginQueryEXT(g.TIME_ELAPSED_EXT,c),f=o.exported.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let _=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const P=this.transform.zoom,R=o.exported.now();this.style.zoomHistory.update(P,R);const k=new o.EvaluationParameters(P,{now:R,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),z=k.crossFadingFactor();z===1&&z===this._crossFadingFactor||(_=!0,this._crossFadingFactor=z),this.style.update(k)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.style.terrain&&this.style.terrain.sourceCache.update(this.transform,this.style.terrain),this.transform.updateElevation(this.style.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.load),this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||_)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const P=o.exported.now()-f;g.endQueryEXT(g.TIME_ELAPSED_EXT,c),setTimeout(()=>{const R=g.getQueryObjectEXT(c,g.QUERY_RESULT_EXT)/1e6;g.deleteQueryEXT(c),this.fire(new o.Event("gpu-timing-frame",{cpuTime:P,gpuTime:R}))},50)}if(this.listens("gpu-timing-layer")){const P=this.painter.collectGpuTimers();setTimeout(()=>{const R=this.painter.queryGpuTimers(P);this.fire(new o.Event("gpu-timing-layer",{layerTimes:R}))},50)}const E=this._sourcesDirty||this._styleDirty||this._placementDirty;return E||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new o.Event("idle")),!this._loaded||this._fullyLoaded||E||(this._fullyLoaded=!0,o.PerformanceUtils.mark(o.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&(removeEventListener("resize",this._onWindowResize,!1),removeEventListener("orientationchange",this._onWindowResize,!1),removeEventListener("online",this._onWindowOnline,!1));const y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),w.remove(this._canvasContainer),w.remove(this._controlContainer),this._cooperativeGestures&&w.remove(this._cooperativeGesturesScreen),this._container.classList.remove("maplibregl-map","mapboxgl-map"),o.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=o.exported.frame(y=>{o.PerformanceUtils.frame(y),this._frame=null,this._render(y)}))}_onWindowOnline(){this._update()}_onWindowResize(y){this._trackResize&&this.resize({originalEvent:y})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}_setCacheLimits(y,c){o.setCacheLimits(y,c)}get version(){return"2.4.0"}},NavigationControl:class{constructor(y){this.options=o.extend({},iw,y),this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in mapboxgl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),w.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out mapboxgl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),w.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass mapboxgl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=w.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const y=this._map.getZoom(),c=y===this._map.getMaxZoom(),f=y===this._map.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())}_rotateCompassArrow(){const y=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=y}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Do(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){w.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,c){const f=w.create("button",y,this._container);return f.type="button",f.addEventListener("click",c),f}_setButtonTitle(y,c){const f=this._map._getUIString(`NavigationControl.${c}`);y.title=f,y.setAttribute("aria-label",f)}},GeolocateControl:class extends o.Evented{constructor(y){super(),this.options=o.extend({},om,y),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(y){var c;return this._map=y,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),c=this._setupUI,Na!==void 0?c(Na):window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(f=>{Na=f.state!=="denied",c(Na)}):(Na=!!window.navigator.geolocation,c(Na)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),w.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Li=0,za=!1}_isOutOfMapMaxBounds(y){const c=this._map.getMaxBounds(),f=y.coords;return c&&(f.longitude<c.getWest()||f.longitude>c.getEast()||f.latitude<c.getSouth()||f.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(y){if(this._map){if(this._isOutOfMapMaxBounds(y))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",y)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=y,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(y),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(y),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",y)),this._finish()}}_updateCamera(y){const c=new o.LngLat(y.coords.longitude,y.coords.latitude),f=y.coords.accuracy,g=this._map.getBearing(),_=o.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(f),_,{geolocateSource:!0})}_updateMarker(y){if(y){const c=new o.LngLat(y.coords.longitude,y.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=y.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const y=this._map._container.clientHeight/2,c=this._map.unproject([0,y]),f=this._map.unproject([1,y]),g=c.distanceTo(f),_=Math.ceil(2*this._accuracy/g);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(y){if(this._map){if(this.options.trackUserLocation)if(y.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(y.code===3&&za)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale","mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",y)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(y){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=w.create("button","maplibregl-ctrl-geolocate mapboxgl-ctrl-geolocate",this._container),w.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",y===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=c,this._geolocateButton.setAttribute("aria-label",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=w.create("div","maplibregl-user-location-dot mapboxgl-user-location-dot"),this._userLocationDotMarker=new Ac(this._dotElement),this._circleElement=w.create("div","maplibregl-user-location-accuracy-circle mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ac({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Li--,za=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error","mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error","mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background","mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active","mapboxgl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Li++,Li>1?(y={maximumAge:6e5,timeout:0},za=!0):(y=this.options.positionOptions,za=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting","mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:qu,LogoControl:bh,ScaleControl:class{constructor(y){this.options=o.extend({},Fo,y),o.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){B0(this._map,this._container,this.options)}onAdd(y){return this._map=y,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-scale mapboxgl-ctrl mapboxgl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){w.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(y){this.options.unit=y,B0(this._map,this._container,this.options)}},FullscreenControl:class{constructor(y){this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=w.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){w.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!!(document.fullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled)}_setupUI(){const y=this._fullscreenButton=w.create("button","maplibregl-ctrl-fullscreen mapboxgl-ctrl-fullscreen",this._controlContainer);w.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen&&window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},TerrainControl:class{constructor(y){this.options=y,o.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(y){return this._map=y,this._container=w.create("div","maplibregl-ctrl maplibregl-ctrl-group mapboxgl-ctrl mapboxgl-ctrl-group"),this._terrainButton=w.create("button","maplibregl-ctrl-terrain mapboxgl-ctrl-terrain",this._container),w.create("span","maplibregl-ctrl-icon mapboxgl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){w.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._map.style.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled","mapboxgl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain","mapboxgl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends o.Evented{constructor(y){super(),this.options=o.extend(Object.create(zr),y),o.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&w.remove(this._content),this._container&&(w.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=o.LngLat.convert(y),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer","mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer","mapboxgl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const c=document.createDocumentFragment(),f=document.createElement("body");let g;for(f.innerHTML=y;g=f.firstChild,g;)c.appendChild(g);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=w.create("div","maplibregl-popup-content mapboxgl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){this._container&&this._container.classList.add(y)}removeClassName(y){this._container&&this._container.classList.remove(y)}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}_createCloseButton(){this.options.closeButton&&(this._closeButton=w.create("button","maplibregl-popup-close-button mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(y){this._update(y.point)}_onMouseMove(y){this._update(y.point)}_onDrag(y){this._update(y.point)}_update(y){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=w.create("div","maplibregl-popup mapboxgl-popup",this._map.getContainer()),this._tip=w.create("div","maplibregl-popup-tip mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(E=>this._container.classList.add(E)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer","mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ku(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!y))return;const c=this._pos=this._trackPointer&&y?y:this._map.project(this._lngLat);let f=this.options.anchor;const g=am(this.options.offset);if(!f){const E=this._container.offsetWidth,P=this._container.offsetHeight;let R;R=c.y+g.bottom.y<P?["top"]:c.y>this._map.transform.height-P?["bottom"]:[],c.x<E/2?R.push("left"):c.x>this._map.transform.width-E/2&&R.push("right"),f=R.length===0?"bottom":R.join("-")}const _=c.add(g[f]).round();w.setTransform(this._container,`${Nt[f]} translate(${_.x}px,${_.y}px)`),Jt(this._container,f,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(ei);y&&y.focus()}_onClose(){this.remove()}},Marker:Ac,Style:ci,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,Evented:o.Evented,AJAXError:o.AJAXError,config:o.config,CanvasSource:Mt,GeoJSONSource:rn,ImageSource:yt,RasterDEMTileSource:ut,RasterTileSource:ke,VectorTileSource:_e,VideoSource:at,prewarm:function(){On().acquire(St)},clearPrewarmedResources:function(){const y=ur;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(St),ur=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"2.4.0"},get workerCount(){return bt.workerCount},set workerCount(y){bt.workerCount=y},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(y){o.config.MAX_PARALLEL_IMAGE_REQUESTS=y},clearStorage(y){o.clearTileCache(y)},workerUrl:"",addProtocol(y,c){o.config.REGISTERED_PROTOCOLS[y]=c},removeProtocol(y){delete o.config.REGISTERED_PROTOCOLS[y]}};return js.extend(_l,{isSafari:o.isSafari,getPerformanceMetrics:o.PerformanceUtils.getPerformanceMetrics}),_l});var l=i;return l})})($we);const kwe=ZS,Owe=OB({key:"mapview",default:{latitude:52.503797177988844,longitude:13.299512588353677,zoom:8.696205280855345},dangerouslyAllowMutability:!0}),E$=OB({key:"selectedGroup",default:null});function wj(t,e,n){if(t!==null)for(var r,i,s,l,o,h,p,b=0,x=0,w,A=t.type,L=A==="FeatureCollection",M=A==="Feature",U=L?t.features.length:1,D=0;D<U;D++){p=L?t.features[D].geometry:M?t.geometry:t,w=p?p.type==="GeometryCollection":!1,o=w?p.geometries.length:1;for(var $=0;$<o;$++){var N=0,B=0;if(l=w?p.geometries[$]:p,l!==null){h=l.coordinates;var Z=l.type;switch(b=n&&(Z==="Polygon"||Z==="MultiPolygon")?1:0,Z){case null:break;case"Point":if(e(h,x,D,N,B)===!1)return!1;x++,N++;break;case"LineString":case"MultiPoint":for(r=0;r<h.length;r++){if(e(h[r],x,D,N,B)===!1)return!1;x++,Z==="MultiPoint"&&N++}Z==="LineString"&&N++;break;case"Polygon":case"MultiLineString":for(r=0;r<h.length;r++){for(i=0;i<h[r].length-b;i++){if(e(h[r][i],x,D,N,B)===!1)return!1;x++}Z==="MultiLineString"&&N++,Z==="Polygon"&&B++}Z==="Polygon"&&N++;break;case"MultiPolygon":for(r=0;r<h.length;r++){for(B=0,i=0;i<h[r].length;i++){for(s=0;s<h[r][i].length-b;s++){if(e(h[r][i][s],x,D,N,B)===!1)return!1;x++}B++}N++}break;case"GeometryCollection":for(r=0;r<l.geometries.length;r++)if(wj(l.geometries[r],e,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Hb(t){var e=[1/0,1/0,-1/0,-1/0];return wj(t,function(n){e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),e[2]<n[0]&&(e[2]=n[0]),e[3]<n[1]&&(e[3]=n[1])}),e}Hb.default=Hb;const Tj=ac({key:"convexHulls",get:async()=>await fetch("/data/groupRegions.geojson").then(t=>t.json())}),hx=ac({key:"users",get:async()=>await fetch("/data/usersAssignments.geojson").then(t=>t.json())}),S$=ac({key:"meetinPoints",get:async()=>await fetch("/data/groupMeetingPoints.geojson").then(t=>t.json())}),Dwe=ac({key:"clusterSizesSelector",get:({get:t})=>t(hx).features.reduce((n,r)=>{let i=r.properties.label;return n[i]=i in n?n[i]+1:1,n},{})}),Fwe=ac({key:"runDetails",get:async()=>await fetch("/data/run_details.json").then(t=>t.json())}),Nwe=ac({key:"bounds",get:async({get:t})=>{let e=t(hx);return Hb(e)}}),Ej=ac({key:"groupIds",get:({get:t})=>t(S$).features.map(n=>n.properties.label)}),zwe=ac({key:"maxMinLabels",get:({get:t})=>{const e=t(Ej);return[Math.min(...e),Math.max(...e)]}}),Sj=ac({key:"selectedGroupDetails",get:({get:t})=>{const e=t(E$),n=t(Tj),r=t(hx),i=t(S$);if(e===null)return null;const s=n.features.find(h=>h.properties.label===e),l=r.features.filter(h=>h.properties.label===e),o=i.features.find(h=>h.properties.label===e);return{users:l.map(h=>h.properties),selectedGroup:s.properties,selectedMeetingPoint:o.properties,bounds:Hb(s)}}}),Of={user:[204,80,62],meetingPoint:[29,105,150],groupBoundary:[95,70,144]},Bwe=()=>{const t=Ja(Tj),e=Ja(hx),n=Ja(S$),[r,i]=oS(E$),s=Ja(Sj),l=Ja(Nwe),[o,h]=oS(Owe),p=Ja(zwe),b=new Ng({id:"hulls",data:t,getFillColor:[0,0,0,0],getLineColor:Of.groupBoundary,getLineWidth:4,lineWidthUnits:"pixels",getFilterValue:L=>L.properties.label,filterRange:r?[r-.1,r+.1]:p,extensions:[new Bg({filterSize:1})],pickable:!0,onClick:L=>{console.log("Click info is",L),i(L.object.properties.label)}}),x=new Ng({id:"users",data:e,getRadius:50,getFillColor:Of.user,pointRadiusUnits:"meters",getFilterValue:L=>L.properties.label,filterRange:r?[r-.1,r+.1]:p,extensions:[new Bg({filterSize:1})]}),w=new Ng({id:"users",data:n,getRadius:50,getFillColor:Of.meetingPoint,pointRadiusUnits:"meters",getFilterValue:L=>L.properties.label,filterRange:r?[r-.1,r+.1]:p,extensions:[new Bg({filterSize:1})]});te.useEffect(()=>{setTimeout(()=>{if(o.width&&o.height){let L=s!==null?s.bounds:l,U=new Nd(o).fitBounds([[L[0],L[1]],[L[2],L[3]]],{padding:200});h({...U,transitionDuration:1e3,transitionInterpolator:new j0e})}},10)},[s,l]);let A={...o};return Yt.jsx(U_e,{layers:[b,x,w],initialViewState:A,onViewStateChange:({viewState:L})=>{h(L)},style:{width:"100%",height:"100%"},controller:!0,children:Yt.jsx(MM,{mapLib:kwe,mapStyle:"https://api.maptiler.com/maps/topo-v2/style.json?key=32rtUQVfWVrA5316PfSR",children:Yt.jsx(bae,{position:"top-left"})})})};function $r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Aj(t){return null}Aj.getCollectionNode=function*(e,n){let{childItems:r,title:i,children:s}=e,l=e.title||e.children,o=e.textValue||(typeof l=="string"?l:"")||e["aria-label"]||"";!o&&!(n!=null&&n.suppressTextValueWarning)&&console.warn("<Item> with non-plain text contents is unsupported by type to select for accessibility. Please add a `textValue` prop."),yield{type:"item",props:e,rendered:l,textValue:o,"aria-label":e["aria-label"],hasChildNodes:Uwe(e),*childNodes(){if(r)for(let h of r)yield{type:"item",value:h};else if(i){let h=[];le.Children.forEach(s,p=>{h.push({type:"item",element:p})}),yield*h}}}};function Uwe(t){return t.hasChildItems!=null?t.hasChildItems:!!(t.childItems||t.title&&le.Children.count(t.children)>0)}let Pj=Aj;class Vwe{build(e,n){return this.context=n,TF(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:n,items:r}=e;if(typeof n=="function"){if(!r)throw new Error("props.children was a function but props.items is missing");for(let i of e.items)yield*this.getFullNode({value:i},{renderer:n})}else{let i=[];le.Children.forEach(n,l=>{i.push(l)});let s=0;for(let l of i){let o=this.getFullNode({element:l,index:s},{});for(let h of o)s++,yield h}}}getKey(e,n,r,i){if(e.key!=null)return e.key;if(n.type==="cell"&&n.key!=null)return`${i}${n.key}`;let s=n.value;if(s!=null){var l;let o=(l=s.key)!==null&&l!==void 0?l:s.id;if(o==null)throw new Error("No key found for item");return o}return i?`${i}.${n.index}`:`$.${n.index}`}getChildState(e,n){return{renderer:n.renderer||e.renderer}}*getFullNode(e,n,r,i){let s=e.element;if(!s&&e.value&&n&&n.renderer){let h=this.cache.get(e.value);if(h&&(!h.shouldInvalidate||!h.shouldInvalidate(this.context))){h.index=e.index,h.parentKey=i?i.key:null,yield h;return}s=n.renderer(e.value)}if(le.isValidElement(s)){let h=s.type;if(typeof h!="function"&&typeof h.getCollectionNode!="function"){let w=typeof s.type=="function"?s.type.name:s.type;throw new Error(`Unknown element <${w}> in collection.`)}let p=h.getCollectionNode(s.props,this.context),b=e.index,x=p.next();for(;!x.done&&x.value;){let w=x.value;e.index=b;let A=w.key;A||(A=w.element?null:this.getKey(s,e,n,r));let M=[...this.getFullNode({...w,key:A,index:b,wrapper:jwe(e.wrapper,w.wrapper)},this.getChildState(n,w),r?`${r}${s.key}`:s.key,i)];for(let U of M){if(U.value=w.value||e.value,U.value&&this.cache.set(U.value,U),e.type&&U.type!==e.type)throw new Error(`Unsupported type <${vT(U.type)}> in <${vT(i.type)}>. Only <${vT(e.type)}> is supported.`);b++,yield U}x=p.next(M)}return}if(e.key==null)return;let l=this,o={type:e.type,props:e.props,key:e.key,parentKey:i?i.key:null,value:e.value,level:i?i.level+1:0,index:e.index,rendered:e.rendered,textValue:e.textValue,"aria-label":e["aria-label"],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes,childNodes:TF(function*(){if(!e.hasChildNodes)return;let h=0;for(let p of e.childNodes()){p.key!=null&&(p.key=`${o.key}${p.key}`),p.index=h;let b=l.getFullNode(p,l.getChildState(n,p),o.key,o);for(let x of b)h++,yield x}})};yield o}constructor(){$r(this,"cache",new WeakMap)}}function TF(t){let e=[],n=null;return{*[Symbol.iterator](){for(let r of e)yield r;n||(n=t());for(let r of n)e.push(r),yield r}}}function jwe(t,e){if(t&&e)return n=>t(e(n));if(t)return t;if(e)return e}function vT(t){return t[0].toUpperCase()+t.slice(1)}function Gwe(t,e,n,r=[]){let i=te.useMemo(()=>new Vwe,[]),s=te.useRef(null);return te.useMemo(()=>{if(t.collection)return t.collection;let l=i.build(t,n);return s.current=e(l,s.current),s.current},[i,t.children,t.items,t.collection,n,...r])}function dp(t,e){return typeof e.getChildren=="function"?e.getChildren(t.key):t.childNodes}function Wwe(t){return Hwe(t,0)}function Hwe(t,e){if(e<0)return;let n=0;for(let r of t){if(n===e)return r;n++}}function _T(t,e,n){if(e.parentKey===n.parentKey)return e.index-n.index;let r=EF(t,e),i=EF(t,n),s=r.slice(0,i.length).findIndex((l,o)=>l!==i[o]);return s!==-1?(e=r[s],n=i[s],e.index-n.index):-1}function EF(t,e){let n=[];for(;(e==null?void 0:e.parentKey)!=null;)e=t.getItem(e.parentKey),n.unshift(e);return n}const SF=new WeakMap;function Cj(t){let e=SF.get(t);if(e!=null)return e;e=0;let n=r=>{for(let i of r)i.type==="section"?n(dp(i,t)):e++};return n(t),SF.set(t,e),e}function fx(t,e,n){let[r,i]=te.useState(t||e),s=te.useRef(t!==void 0),l=s.current,o=t!==void 0,h=te.useRef(r);l!==o&&console.warn(`WARN: A component changed from ${l?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}.`),s.current=o;let p=te.useCallback((b,...x)=>{let w=(A,...L)=>{n&&(Object.is(h.current,A)||n(A,...L)),o||(h.current=A)};typeof b=="function"?(console.warn("We can not support a function callback. See Github Issues for details https://github.com/adobe/react-spectrum/issues/2320"),i((L,...M)=>{let U=b(o?h.current:L,...M);return w(U,...x),o?L:U})):(o||i(b),w(b,...x))},[o,n]);return o?h.current=t:t=r,[t,p]}function _y(t,e=-1/0,n=1/0){return Math.min(Math.max(t,e),n)}const Lj={prefix:String(Math.round(Math.random()*1e10)),current:0,isSSR:!1},A$=le.createContext(Lj);let qwe=!!(typeof window<"u"&&window.document&&window.document.createElement),bT=new WeakMap;function Kwe(t=!1){let e=te.useContext(A$),n=te.useRef(null);if(n.current===null&&!t){var r,i;let s=(r=le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||r===void 0||(i=r.ReactCurrentOwner)===null||i===void 0?void 0:i.current;if(s){let l=bT.get(s);l==null?bT.set(s,{id:e.current,state:s.memoizedState}):s.memoizedState!==l.state&&(e.current=l.id,bT.delete(s))}n.current=++e.current}return n.current}function Xwe(t){let e=te.useContext(A$);e===Lj&&!qwe&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");let n=Kwe(!!t);return t||`react-aria${e.prefix}-${n}`}function Sp(){return te.useContext(A$).isSSR}function Ij(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=Ij(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function px(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=Ij(t))&&(r&&(r+=" "),r+=e);return r}const Ar=typeof window<"u"?le.useLayoutEffect:()=>{};function Zwe(t){let[e,n]=te.useState(t),r=te.useRef(e),i=te.useRef(null);r.current=e;let s=te.useRef(null);s.current=()=>{let o=i.current.next();if(o.done){i.current=null;return}e===o.value?s.current():n(o.value)},Ar(()=>{i.current&&s.current()});let l=te.useCallback(o=>{i.current=o(r.current),s.current()},[i,s]);return[e,l]}let qb=new Map;function ta(t){let[e,n]=te.useState(t),r=te.useRef(null),i=Xwe(e),s=te.useCallback(l=>{r.current=l},[]);return qb.set(i,s),Ar(()=>{let l=i;return()=>{qb.delete(l)}},[i]),te.useEffect(()=>{let l=r.current;l&&(r.current=null,n(l))}),i}function Ywe(t,e){if(t===e)return t;let n=qb.get(t);if(n)return n(e),e;let r=qb.get(e);return r?(r(t),t):e}function by(t=[]){let e=ta(),[n,r]=Zwe(e),i=te.useCallback(()=>{r(function*(){yield e,yield document.getElementById(e)?e:void 0})},[e,r]);return Ar(i,[e,i,...t]),n}function xy(...t){return(...e)=>{for(let n of t)typeof n=="function"&&n(...e)}}function Vn(...t){let e={...t[0]};for(let n=1;n<t.length;n++){let r=t[n];for(let i in r){let s=e[i],l=r[i];typeof s=="function"&&typeof l=="function"&&i[0]==="o"&&i[1]==="n"&&i.charCodeAt(2)>=65&&i.charCodeAt(2)<=90?e[i]=xy(s,l):(i==="className"||i==="UNSAFE_className")&&typeof s=="string"&&typeof l=="string"?e[i]=px(s,l):i==="id"&&s&&l?e.id=Ywe(s,l):e[i]=l!==void 0?l:s}}return e}const Jwe=new Set(["id"]),Qwe=new Set(["aria-label","aria-labelledby","aria-describedby","aria-details"]),e2e=/^(data-.*)$/;function Hi(t,e={}){let{labelable:n,propNames:r}=e,i={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(Jwe.has(s)||n&&Qwe.has(s)||r!=null&&r.has(s)||e2e.test(s))&&(i[s]=t[s]);return i}function Hl(t){if(t2e())t.focus({preventScroll:!0});else{let e=n2e(t);t.focus(),r2e(e)}}let t_=null;function t2e(){if(t_==null){t_=!1;try{var t=document.createElement("div");t.focus({get preventScroll(){return t_=!0,!0}})}catch{}}return t_}function n2e(t){for(var e=t.parentNode,n=[],r=document.scrollingElement||document.documentElement;e instanceof HTMLElement&&e!==r;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&n.push({element:e,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),e=e.parentNode;return r instanceof HTMLElement&&n.push({element:r,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}),n}function r2e(t){for(let{element:e,scrollTop:n,scrollLeft:r}of t)e.scrollTop=n,e.scrollLeft=r}let Qh=new Map,YS=new Set;function AF(){if(typeof window>"u")return;let t=n=>{let r=Qh.get(n.target);r||(r=new Set,Qh.set(n.target,r),n.target.addEventListener("transitioncancel",e)),r.add(n.propertyName)},e=n=>{let r=Qh.get(n.target);if(r&&(r.delete(n.propertyName),r.size===0&&(n.target.removeEventListener("transitioncancel",e),Qh.delete(n.target)),Qh.size===0)){for(let i of YS)i();YS.clear()}};document.body.addEventListener("transitionrun",t),document.body.addEventListener("transitionend",e)}typeof document<"u"&&(document.readyState!=="loading"?AF():document.addEventListener("DOMContentLoaded",AF));function Rj(t){requestAnimationFrame(()=>{Qh.size===0?t():YS.add(t)})}function Mj(){let t=te.useRef(new Map),e=te.useCallback((i,s,l,o)=>{let h=o!=null&&o.once?(...p)=>{t.current.delete(l),l(...p)}:l;t.current.set(l,{type:s,eventTarget:i,fn:h,options:o}),i.addEventListener(s,l,o)},[]),n=te.useCallback((i,s,l,o)=>{var h;let p=((h=t.current.get(l))===null||h===void 0?void 0:h.fn)||l;i.removeEventListener(s,p,o),t.current.delete(l)},[]),r=te.useCallback(()=>{t.current.forEach((i,s)=>{n(i.eventTarget,i.type,s,i.options)})},[n]);return te.useEffect(()=>r,[r]),{addGlobalListener:e,removeGlobalListener:n,removeAllGlobalListeners:r}}function Kb(t,e){let{id:n,"aria-label":r,"aria-labelledby":i}=t;return n=ta(n),i&&r?i=[...new Set([...i.trim().split(/\s+/),n])].join(" "):i&&(i=i.trim().split(/\s+/).join(" ")),!r&&!i&&e&&(r=e),{id:n,"aria-label":r,"aria-labelledby":i}}function i2e(){return typeof window.ResizeObserver<"u"}function P$(t){const{ref:e,onResize:n}=t;te.useEffect(()=>{let r=e==null?void 0:e.current;if(r)if(i2e()){const i=new window.ResizeObserver(s=>{s.length&&n()});return i.observe(r),()=>{r&&i.unobserve(r)}}else return window.addEventListener("resize",n,!1),()=>{window.removeEventListener("resize",n,!1)}},[n,e])}function C$(t,e){Ar(()=>{if(t&&t.ref&&e)return t.ref.current=e.current,()=>{t.ref.current=null}},[t,e])}function Xb(t){for(PF(t)&&(t=t.parentElement);t&&!PF(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}function PF(t){let e=window.getComputedStyle(t);return/(auto|scroll)/.test(e.overflow+e.overflowX+e.overflowY)}let Qa=typeof window<"u"&&window.visualViewport;function s2e(){let[t,e]=te.useState(()=>CF());return te.useEffect(()=>{let n=()=>{e(r=>{let i=CF();return i.width===r.width&&i.height===r.height?r:i})};return Qa?Qa.addEventListener("resize",n):window.addEventListener("resize",n),()=>{Qa?Qa.removeEventListener("resize",n):window.removeEventListener("resize",n)}},[]),t}function CF(){return{width:(Qa==null?void 0:Qa.width)||window.innerWidth,height:(Qa==null?void 0:Qa.height)||window.innerHeight}}let o2e=0;const xT=new Map;function a2e(t){let[e,n]=te.useState(void 0);return Ar(()=>{if(!t)return;let r=xT.get(t);if(r)n(r.element.id);else{let i=`react-aria-description-${o2e++}`;n(i);let s=document.createElement("div");s.id=i,s.style.display="none",s.textContent=t,document.body.appendChild(s),r={refCount:0,element:s},xT.set(t,r)}return r.refCount++,()=>{--r.refCount===0&&(r.element.remove(),xT.delete(t))}},[t]),{"aria-describedby":t?e:void 0}}function L$(t){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(n=>t.test(n.brand)))||t.test(window.navigator.userAgent)}function I$(t){var e;return typeof window<"u"&&window.navigator!=null?t.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function i0(){return I$(/^Mac/i)}function l2e(){return I$(/^iPhone/i)}function c2e(){return I$(/^iPad/i)||i0()&&navigator.maxTouchPoints>1}function mx(){return l2e()||c2e()}function X_(){return i0()||mx()}function u2e(){return L$(/AppleWebKit/i)&&!d2e()}function d2e(){return L$(/Chrome/i)}function h2e(){return L$(/Android/i)}function f2e(t,e,n,r){let i=te.useRef(n);i.current=n;let s=n==null;te.useEffect(()=>{if(s)return;let l=t.current,o=h=>i.current.call(this,h);return l.addEventListener(e,o,r),()=>{l.removeEventListener(e,o,r)}},[t,e,r,s])}function JS(t,e){let n=LF(t,e,"left"),r=LF(t,e,"top"),i=e.offsetWidth,s=e.offsetHeight,l=t.scrollLeft,o=t.scrollTop,{borderTopWidth:h,borderLeftWidth:p}=getComputedStyle(t),b=t.scrollLeft+parseInt(p,10),x=t.scrollTop+parseInt(h,10),w=b+t.clientWidth,A=x+t.clientHeight;n<=l?l=n-parseInt(p,10):n+i>w&&(l+=n+i-w),r<=x?o=r-parseInt(h,10):r+s>A&&(o+=r+s-A),t.scrollLeft=l,t.scrollTop=o}function LF(t,e,n){const r=n==="left"?"offsetLeft":"offsetTop";let i=0;for(;e.offsetParent&&(i+=e[r],e.offsetParent!==t);){if(e.offsetParent.contains(t)){i-=t[r];break}e=e.offsetParent}return i}function $j(t,e){if(document.contains(t)){let l=document.scrollingElement||document.documentElement;if(window.getComputedStyle(l).overflow==="hidden"){let h=Xb(t);for(;t&&h&&t!==l&&h!==l;)JS(h,t),t=h,h=Xb(t)}else{var n;let{left:h,top:p}=t.getBoundingClientRect();t==null||(n=t.scrollIntoView)===null||n===void 0||n.call(t,{block:"nearest"});let{left:b,top:x}=t.getBoundingClientRect();if(Math.abs(h-b)>1||Math.abs(p-x)>1){var r,i,s;e==null||(r=e.containingElement)===null||r===void 0||(i=r.scrollIntoView)===null||i===void 0||i.call(r,{block:"center",inline:"center"}),(s=t.scrollIntoView)===null||s===void 0||s.call(t,{block:"nearest"})}}}}function QS(t){return t.mozInputSource===0&&t.isTrusted?!0:h2e()&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function p2e(t){return t.width===0&&t.height===0||t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType==="mouse"}class m2e{getStringForLocale(e,n){let r=this.strings[n];r||(r=g2e(n,this.strings,this.defaultLocale),this.strings[n]=r);let i=r[e];if(!i)throw new Error(`Could not find intl message ${e} in ${n} locale`);return i}constructor(e,n="en-US"){this.strings={...e},this.defaultLocale=n}}function g2e(t,e,n="en-US"){if(e[t])return e[t];let r=y2e(t);if(e[r])return e[r];for(let i in e)if(i.startsWith(r+"-"))return e[i];return e[n]}function y2e(t){return Intl.Locale?new Intl.Locale(t).language:t.split("-")[0]}const IF=new Map,RF=new Map;class v2e{format(e,n){let r=this.strings.getStringForLocale(e,this.locale);return typeof r=="function"?r(n,this):r}plural(e,n,r="cardinal"){let i=n["="+e];if(i)return typeof i=="function"?i():i;let s=this.locale+":"+r,l=IF.get(s);l||(l=new Intl.PluralRules(this.locale,{type:r}),IF.set(s,l));let o=l.select(e);return i=n[o]||n.other,typeof i=="function"?i():i}number(e){let n=RF.get(this.locale);return n||(n=new Intl.NumberFormat(this.locale),RF.set(this.locale,n)),n.format(e)}select(e,n){let r=e[n]||e.other;return typeof r=="function"?r():r}constructor(e,n){this.locale=e,this.strings=n}}let wT=new Map,e3=!1;try{e3=new Intl.NumberFormat("de-DE",{signDisplay:"exceptZero"}).resolvedOptions().signDisplay==="exceptZero"}catch{}let Zb=!1;try{Zb=new Intl.NumberFormat("de-DE",{style:"unit",unit:"degree"}).resolvedOptions().style==="unit"}catch{}const kj={degree:{narrow:{default:"","ja-JP":" ","zh-TW":"","sl-SI":" "}}};class _2e{format(e){let n="";if(!e3&&this.options.signDisplay!=null?n=x2e(this.numberFormatter,this.options.signDisplay,e):n=this.numberFormatter.format(e),this.options.style==="unit"&&!Zb){var r;let{unit:i,unitDisplay:s="short",locale:l}=this.resolvedOptions(),o=(r=kj[i])===null||r===void 0?void 0:r[s];n+=o[l]||o.default}return n}formatToParts(e){return this.numberFormatter.formatToParts(e)}formatRange(e,n){if(typeof this.numberFormatter.formatRange=="function")return this.numberFormatter.formatRange(e,n);if(n<e)throw new RangeError("End date must be >= start date");return`${this.format(e)}  ${this.format(n)}`}formatRangeToParts(e,n){if(typeof this.numberFormatter.formatRangeToParts=="function")return this.numberFormatter.formatRangeToParts(e,n);if(n<e)throw new RangeError("End date must be >= start date");let r=this.numberFormatter.formatToParts(e),i=this.numberFormatter.formatToParts(n);return[...r.map(s=>({...s,source:"startRange"})),{type:"literal",value:"  ",source:"shared"},...i.map(s=>({...s,source:"endRange"}))]}resolvedOptions(){let e=this.numberFormatter.resolvedOptions();return!e3&&this.options.signDisplay!=null&&(e={...e,signDisplay:this.options.signDisplay}),!Zb&&this.options.style==="unit"&&(e={...e,style:"unit",unit:this.options.unit,unitDisplay:this.options.unitDisplay}),e}constructor(e,n={}){this.numberFormatter=b2e(e,n),this.options=n}}function b2e(t,e={}){let{numberingSystem:n}=e;if(n&&t.indexOf("-u-nu-")===-1&&(t=`${t}-u-nu-${n}`),e.style==="unit"&&!Zb){var r;let{unit:l,unitDisplay:o="short"}=e;if(!l)throw new Error('unit option must be provided with style: "unit"');if(!(!((r=kj[l])===null||r===void 0)&&r[o]))throw new Error(`Unsupported unit ${l} with unitDisplay = ${o}`);e={...e,style:"decimal"}}let i=t+(e?Object.entries(e).sort((l,o)=>l[0]<o[0]?-1:1).join():"");if(wT.has(i))return wT.get(i);let s=new Intl.NumberFormat(t,e);return wT.set(i,s),s}function x2e(t,e,n){if(e==="auto")return t.format(n);if(e==="never")return t.format(Math.abs(n));{let r=!1;if(e==="always"?r=n>0||Object.is(n,0):e==="exceptZero"&&(Object.is(n,-0)||Object.is(n,0)?n=Math.abs(n):r=n>0),r){let i=t.format(-n),s=t.format(n),l=i.replace(s,"").replace(/\u200e|\u061C/,"");return[...l].length!==1&&console.warn("@react-aria/i18n polyfill for NumberFormat signDisplay: Unsupported case"),i.replace(s,"!!!").replace(l,"+").replace("!!!",s)}else return t.format(n)}}const w2e=new Set(["Arab","Syrc","Samr","Mand","Thaa","Mend","Nkoo","Adlm","Rohg","Hebr"]),T2e=new Set(["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"]);function Oj(t){if(Intl.Locale){let n=new Intl.Locale(t).maximize().script;return w2e.has(n)}let e=t.split("-")[0];return T2e.has(e)}function Dj(){let t=typeof navigator<"u"&&(navigator.language||navigator.userLanguage)||"en-US";try{Intl.DateTimeFormat.supportedLocalesOf([t])}catch{t="en-US"}return{locale:t,direction:Oj(t)?"rtl":"ltr"}}let t3=Dj(),vg=new Set;function MF(){t3=Dj();for(let t of vg)t(t3)}function Fj(){let t=Sp(),[e,n]=te.useState(t3);return te.useEffect(()=>(vg.size===0&&window.addEventListener("languagechange",MF),vg.add(n),()=>{vg.delete(n),vg.size===0&&window.removeEventListener("languagechange",MF)}),[]),t?{locale:"en-US",direction:"ltr"}:e}const Nj=le.createContext(null);function E2e(t){let{locale:e,children:n}=t,r=Fj(),i=e?{locale:e,direction:Oj(e)?"rtl":"ltr"}:r;return le.createElement(Nj.Provider,{value:i},n)}function Ra(){let t=Fj();return te.useContext(Nj)||t}const $F=new WeakMap;function S2e(t){let e=$F.get(t);return e||(e=new m2e(t),$F.set(t,e)),e}function dc(t){let{locale:e}=Ra(),n=te.useMemo(()=>S2e(t),[t]);return te.useMemo(()=>new v2e(e,n),[e,n])}function A2e(t={}){let{locale:e}=Ra();return te.useMemo(()=>new _2e(e,t),[e,t])}let TT=new Map;function R$(t){let{locale:e}=Ra(),n=e+(t?Object.entries(t).sort((i,s)=>i[0]<s[0]?-1:1).join():"");if(TT.has(n))return TT.get(n);let r=new Intl.Collator(e,t);return TT.set(n,r),r}function zj(t){let e=R$({usage:"search",...t}),n=te.useCallback((s,l)=>l.length===0?!0:(s=s.normalize("NFC"),l=l.normalize("NFC"),e.compare(s.slice(0,l.length),l)===0),[e]),r=te.useCallback((s,l)=>l.length===0?!0:(s=s.normalize("NFC"),l=l.normalize("NFC"),e.compare(s.slice(-l.length),l)===0),[e]),i=te.useCallback((s,l)=>{if(l.length===0)return!0;s=s.normalize("NFC"),l=l.normalize("NFC");let o=0,h=l.length;for(;o+h<=s.length;o++){let p=s.slice(o,o+h);if(e.compare(l,p)===0)return!0}return!1},[e]);return te.useMemo(()=>({startsWith:n,endsWith:r,contains:i}),[n,r,i])}let n_=!1;function ct(t,...e){let n=[];for(let r of e)if(typeof r=="object"&&r){let i={};for(let s in r)t[s]&&(i[t[s]]=r[s]),t[s]||(i[s]=r[s]);n.push(i)}else typeof r=="string"?(t[r]&&n.push(t[r]),t[r]||n.push(r)):n.push(r);return px(...n)}function n3(t){let e=typeof window<"u"&&typeof window.matchMedia=="function",[n,r]=te.useState(()=>e?window.matchMedia(t).matches:!1);return te.useEffect(()=>{if(!e)return;let s=window.matchMedia(t),l=o=>{r(o.matches)};return s.addListener(l),()=>{s.removeListener(l)}},[e,t]),Sp()?!1:n}function Bj(t){return{UNSAFE_getDOMNode(){return t.current}}}function Uj(t,e=t){return{...Bj(t),focus(){e.current&&e.current.focus()}}}function io(t){let e=te.useRef(null);return te.useImperativeHandle(t,()=>Bj(e)),e}function s0(t,e){let n=te.useRef(null);return te.useImperativeHandle(t,()=>Uj(n,e)),n}function Vj(t){return{get current(){return t.current&&t.current.UNSAFE_getDOMNode()}}}function kF(t){return te.useMemo(()=>Vj(t),[t])}const M$=le.createContext(null);M$.displayName="BreakpointContext";function P2e(t){let{children:e,matchedBreakpoints:n}=t;return le.createElement(M$.Provider,{value:{matchedBreakpoints:n}},e)}function C2e(t){let e=Object.entries(t).sort(([,h],[,p])=>p-h),n=e.map(([,h])=>`(min-width: ${h}px)`),r=typeof window<"u"&&typeof window.matchMedia=="function",i=()=>{let h=[];for(let p in n){let b=n[p];window.matchMedia(b).matches&&h.push(e[p][0])}return h.push("base"),h},[s,l]=te.useState(()=>r?i():["base"]);return te.useEffect(()=>{if(!r)return;let h=()=>{const p=i();l(b=>b.length!==p.length||b.some((x,w)=>x!==p[w])?[...p]:b)};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[r]),Sp()?["base"]:s}function jj(){return te.useContext(M$)}const gx={margin:["margin",Zn],marginStart:[qs("marginLeft","marginRight"),Zn],marginEnd:[qs("marginRight","marginLeft"),Zn],marginTop:["marginTop",Zn],marginBottom:["marginBottom",Zn],marginX:[["marginLeft","marginRight"],Zn],marginY:[["marginTop","marginBottom"],Zn],width:["width",Zn],height:["height",Zn],minWidth:["minWidth",Zn],minHeight:["minHeight",Zn],maxWidth:["maxWidth",Zn],maxHeight:["maxHeight",Zn],isHidden:["display",k2e],alignSelf:["alignSelf",$i],justifySelf:["justifySelf",$i],position:["position",ET],zIndex:["zIndex",ET],top:["top",Zn],bottom:["bottom",Zn],start:[qs("left","right"),Zn],end:[qs("right","left"),Zn],left:["left",Zn],right:["right",Zn],order:["order",ET],flex:["flex",O2e],flexGrow:["flexGrow",$i],flexShrink:["flexShrink",$i],flexBasis:["flexBasis",$i],gridArea:["gridArea",$i],gridColumn:["gridColumn",$i],gridColumnEnd:["gridColumnEnd",$i],gridColumnStart:["gridColumnStart",$i],gridRow:["gridRow",$i],gridRowEnd:["gridRowEnd",$i],gridRowStart:["gridRowStart",$i]},L2e={...gx,backgroundColor:["backgroundColor",$2e],borderWidth:["borderWidth",Ml],borderStartWidth:[qs("borderLeftWidth","borderRightWidth"),Ml],borderEndWidth:[qs("borderRightWidth","borderLeftWidth"),Ml],borderLeftWidth:["borderLeftWidth",Ml],borderRightWidth:["borderRightWidth",Ml],borderTopWidth:["borderTopWidth",Ml],borderBottomWidth:["borderBottomWidth",Ml],borderXWidth:[["borderLeftWidth","borderRightWidth"],Ml],borderYWidth:[["borderTopWidth","borderBottomWidth"],Ml],borderColor:["borderColor",Rl],borderStartColor:[qs("borderLeftColor","borderRightColor"),Rl],borderEndColor:[qs("borderRightColor","borderLeftColor"),Rl],borderLeftColor:["borderLeftColor",Rl],borderRightColor:["borderRightColor",Rl],borderTopColor:["borderTopColor",Rl],borderBottomColor:["borderBottomColor",Rl],borderXColor:[["borderLeftColor","borderRightColor"],Rl],borderYColor:[["borderTopColor","borderBottomColor"],Rl],borderRadius:["borderRadius",$l],borderTopStartRadius:[qs("borderTopLeftRadius","borderTopRightRadius"),$l],borderTopEndRadius:[qs("borderTopRightRadius","borderTopLeftRadius"),$l],borderBottomStartRadius:[qs("borderBottomLeftRadius","borderBottomRightRadius"),$l],borderBottomEndRadius:[qs("borderBottomRightRadius","borderBottomLeftRadius"),$l],borderTopLeftRadius:["borderTopLeftRadius",$l],borderTopRightRadius:["borderTopRightRadius",$l],borderBottomLeftRadius:["borderBottomLeftRadius",$l],borderBottomRightRadius:["borderBottomRightRadius",$l],padding:["padding",Zn],paddingStart:[qs("paddingLeft","paddingRight"),Zn],paddingEnd:[qs("paddingRight","paddingLeft"),Zn],paddingLeft:["paddingLeft",Zn],paddingRight:["paddingRight",Zn],paddingTop:["paddingTop",Zn],paddingBottom:["paddingBottom",Zn],paddingX:[["paddingLeft","paddingRight"],Zn],paddingY:[["paddingTop","paddingBottom"],Zn],overflow:["overflow",$i]},OF={borderWidth:"borderStyle",borderLeftWidth:"borderLeftStyle",borderRightWidth:"borderRightStyle",borderTopWidth:"borderTopStyle",borderBottomWidth:"borderBottomStyle"};function qs(t,e){return n=>n==="rtl"?e:t}const I2e=/(%|px|em|rem|vw|vh|auto|cm|mm|in|pt|pc|ex|ch|rem|vmin|vmax|fr)$/,R2e=/^\s*\w+\(/,M2e=/(static-)?size-\d+|single-line-(height|width)/g;function Zn(t){return typeof t=="number"?t+"px":I2e.test(t)?t:R2e.test(t)?t.replace(M2e,"var(--spectrum-global-dimension-$&, var(--spectrum-alias-$&))"):`var(--spectrum-global-dimension-${t}, var(--spectrum-alias-${t}))`}function Gh(t,e){return t=$$(t,e),Zn(t)}function Gj(t,e="default",n=5){return n>5?`var(--spectrum-${t}, var(--spectrum-semantic-${t}-color-${e}))`:`var(--spectrum-legacy-color-${t}, var(--spectrum-global-color-${t}, var(--spectrum-semantic-${t}-color-${e})))`}function $2e(t,e=5){return`var(--spectrum-alias-background-color-${t}, ${Gj(t,"background",e)})`}function Rl(t,e=5){return t==="default"?"var(--spectrum-alias-border-color)":`var(--spectrum-alias-border-color-${t}, ${Gj(t,"border",e)})`}function Ml(t){return`var(--spectrum-alias-border-size-${t})`}function $l(t){return`var(--spectrum-alias-border-radius-${t})`}function k2e(t){return t?"none":void 0}function ET(t){return t}function O2e(t){return typeof t=="boolean"?t?"1":void 0:""+t}function D2e(t,e,n,r){let i={};for(let s in t){let l=e[s];if(!l||t[s]==null)continue;let[o,h]=l;typeof o=="function"&&(o=o(n));let p=$$(t[s],r),b=h(p,t.colorVersion);if(Array.isArray(o))for(let x of o)i[x]=b;else i[o]=b}for(let s in OF)i[s]&&(i[OF[s]]="solid",i.boxSizing="border-box");return i}function mi(t,e=gx,n={}){let{UNSAFE_className:r,UNSAFE_style:i,...s}=t,l=jj(),{direction:o}=Ra(),{matchedBreakpoints:h=(l==null?void 0:l.matchedBreakpoints)||["base"]}=n,p=D2e(t,e,o,h),b={...i,...p};s.className&&console.warn("The className prop is unsafe and is unsupported in React Spectrum v3. Please use style props with Spectrum variables, or UNSAFE_className if you absolutely must do something custom. Note that this may break in future versions due to DOM structure changes."),s.style&&console.warn("The style prop is unsafe and is unsupported in React Spectrum v3. Please use style props with Spectrum variables, or UNSAFE_style if you absolutely must do something custom. Note that this may break in future versions due to DOM structure changes.");let x={style:b,className:r};return $$(t.isHidden,h)&&(x.hidden=!0),{styleProps:x}}function $i(t){return t}function $$(t,e){if(t&&typeof t=="object"&&!Array.isArray(t)){for(let n=0;n<e.length;n++){let r=e[n];if(t[r]!=null)return t[r]}return t.base}return t}let Yb=le.createContext(null);function Su(t,e){let n=t.slot||e,{[n]:r={}}=te.useContext(Yb)||{};return Vn(t,Vn(r,{id:t.id}))}function yx(t){let e=te.useContext(Yb)||{},{slots:n={},children:r}=t,i=te.useMemo(()=>Object.keys(e).concat(Object.keys(n)).reduce((s,l)=>({...s,[l]:Vn(e[l]||{},n[l]||{})}),{}),[e,n]);return le.createElement(Yb.Provider,{value:i},r)}function k$(t){let{children:e,...n}=t,r=e;return le.Children.toArray(e).length<=1&&typeof e=="function"&&(r=le.cloneElement(le.Children.only(e),n)),le.createElement(Yb.Provider,{value:{}},r)}const F2e=700;function N2e(){return Sp()||typeof window>"u"?!1:window.screen.width<=F2e}let _f="default",r3="",Z_=new WeakMap;function DF(t){mx()?(_f==="default"&&(r3=document.documentElement.style.webkitUserSelect,document.documentElement.style.webkitUserSelect="none"),_f="disabled"):(t instanceof HTMLElement||t instanceof SVGElement)&&(Z_.set(t,t.style.userSelect),t.style.userSelect="none")}function r_(t){if(mx()){if(_f!=="disabled")return;_f="restoring",setTimeout(()=>{Rj(()=>{_f==="restoring"&&(document.documentElement.style.webkitUserSelect==="none"&&(document.documentElement.style.webkitUserSelect=r3||""),r3="",_f="default")})},300)}else if((t instanceof HTMLElement||t instanceof SVGElement)&&t&&Z_.has(t)){let e=Z_.get(t);t.style.userSelect==="none"&&(t.style.userSelect=e),t.getAttribute("style")===""&&t.removeAttribute("style"),Z_.delete(t)}}const Jb=le.createContext(null);Jb.displayName="PressResponderContext";function z2e(t){let e=te.useContext(Jb);if(e){let{register:n,...r}=e;t=Vn(r,t),n()}return C$(e,t.ref),t}function O$(t){let{onPress:e,onPressChange:n,onPressStart:r,onPressEnd:i,onPressUp:s,isDisabled:l,isPressed:o,preventFocusOnPress:h,shouldCancelOnPointerExit:p,allowTextSelectionOnPress:b,ref:x,...w}=z2e(t),A=te.useRef(null);A.current={onPress:e,onPressChange:n,onPressStart:r,onPressEnd:i,onPressUp:s,isDisabled:l,shouldCancelOnPointerExit:p};let[L,M]=te.useState(!1),U=te.useRef({isPressed:!1,ignoreEmulatedMouseEvents:!1,ignoreClickAfterPress:!1,didFirePressStart:!1,activePointerId:null,target:null,isOverTarget:!1,pointerType:null}),{addGlobalListener:D,removeAllGlobalListeners:$}=Mj(),N=te.useMemo(()=>{let B=U.current,Z=(fe,Pe)=>{let{onPressStart:_e,onPressChange:ke,isDisabled:Vt}=A.current;Vt||B.didFirePressStart||(_e&&_e({type:"pressstart",pointerType:Pe,target:fe.currentTarget,shiftKey:fe.shiftKey,metaKey:fe.metaKey,ctrlKey:fe.ctrlKey,altKey:fe.altKey}),ke&&ke(!0),B.didFirePressStart=!0,M(!0))},ie=(fe,Pe,_e=!0)=>{let{onPressEnd:ke,onPressChange:Vt,onPress:ut,isDisabled:rn}=A.current;B.didFirePressStart&&(B.ignoreClickAfterPress=!0,B.didFirePressStart=!1,ke&&ke({type:"pressend",pointerType:Pe,target:fe.currentTarget,shiftKey:fe.shiftKey,metaKey:fe.metaKey,ctrlKey:fe.ctrlKey,altKey:fe.altKey}),Vt&&Vt(!1),M(!1),ut&&_e&&!rn&&ut({type:"press",pointerType:Pe,target:fe.currentTarget,shiftKey:fe.shiftKey,metaKey:fe.metaKey,ctrlKey:fe.ctrlKey,altKey:fe.altKey}))},re=(fe,Pe)=>{let{onPressUp:_e,isDisabled:ke}=A.current;ke||_e&&_e({type:"pressup",pointerType:Pe,target:fe.currentTarget,shiftKey:fe.shiftKey,metaKey:fe.metaKey,ctrlKey:fe.ctrlKey,altKey:fe.altKey})},ve=fe=>{B.isPressed&&(B.isOverTarget&&ie(kl(B.target,fe),B.pointerType,!1),B.isPressed=!1,B.isOverTarget=!1,B.activePointerId=null,B.pointerType=null,$(),b||r_(B.target))},Te={onKeyDown(fe){ST(fe.nativeEvent,fe.currentTarget)&&fe.currentTarget.contains(fe.target)?(NF(fe.target,fe.key)&&fe.preventDefault(),fe.stopPropagation(),!B.isPressed&&!fe.repeat&&(B.target=fe.currentTarget,B.isPressed=!0,Z(fe,"keyboard"),D(document,"keyup",Ae,!1))):fe.key==="Enter"&&i3(fe.currentTarget)&&fe.stopPropagation()},onKeyUp(fe){ST(fe.nativeEvent,fe.currentTarget)&&!fe.repeat&&fe.currentTarget.contains(fe.target)&&re(kl(B.target,fe),"keyboard")},onClick(fe){fe&&!fe.currentTarget.contains(fe.target)||fe&&fe.button===0&&(fe.stopPropagation(),l&&fe.preventDefault(),!B.ignoreClickAfterPress&&!B.ignoreEmulatedMouseEvents&&(B.pointerType==="virtual"||QS(fe.nativeEvent))&&(!l&&!h&&Hl(fe.currentTarget),Z(fe,"virtual"),re(fe,"virtual"),ie(fe,"virtual")),B.ignoreEmulatedMouseEvents=!1,B.ignoreClickAfterPress=!1)}},Ae=fe=>{if(B.isPressed&&ST(fe,B.target)){NF(fe.target,fe.key)&&fe.preventDefault(),fe.stopPropagation(),B.isPressed=!1;let Pe=fe.target;ie(kl(B.target,fe),"keyboard",B.target.contains(Pe)),$(),B.target instanceof HTMLElement&&B.target.contains(Pe)&&(i3(B.target)||B.target.getAttribute("role")==="link")&&B.target.click()}};if(typeof PointerEvent<"u"){Te.onPointerDown=ke=>{if(!(ke.button!==0||!ke.currentTarget.contains(ke.target))){if(p2e(ke.nativeEvent)){B.pointerType="virtual";return}AT(ke.currentTarget)&&ke.preventDefault(),B.pointerType=ke.pointerType,ke.stopPropagation(),B.isPressed||(B.isPressed=!0,B.isOverTarget=!0,B.activePointerId=ke.pointerId,B.target=ke.currentTarget,!l&&!h&&Hl(ke.currentTarget),b||DF(B.target),Z(ke,B.pointerType),D(document,"pointermove",fe,!1),D(document,"pointerup",Pe,!1),D(document,"pointercancel",_e,!1))}},Te.onMouseDown=ke=>{ke.currentTarget.contains(ke.target)&&ke.button===0&&(AT(ke.currentTarget)&&ke.preventDefault(),ke.stopPropagation())},Te.onPointerUp=ke=>{!ke.currentTarget.contains(ke.target)||B.pointerType==="virtual"||ke.button===0&&Wh(ke,ke.currentTarget)&&re(ke,B.pointerType||ke.pointerType)};let fe=ke=>{ke.pointerId===B.activePointerId&&(Wh(ke,B.target)?B.isOverTarget||(B.isOverTarget=!0,Z(kl(B.target,ke),B.pointerType)):B.isOverTarget&&(B.isOverTarget=!1,ie(kl(B.target,ke),B.pointerType,!1),A.current.shouldCancelOnPointerExit&&ve(ke)))},Pe=ke=>{ke.pointerId===B.activePointerId&&B.isPressed&&ke.button===0&&(Wh(ke,B.target)?ie(kl(B.target,ke),B.pointerType):B.isOverTarget&&ie(kl(B.target,ke),B.pointerType,!1),B.isPressed=!1,B.isOverTarget=!1,B.activePointerId=null,B.pointerType=null,$(),b||r_(B.target))},_e=ke=>{ve(ke)};Te.onDragStart=ke=>{ke.currentTarget.contains(ke.target)&&ve(ke)}}else{Te.onMouseDown=_e=>{_e.button!==0||!_e.currentTarget.contains(_e.target)||(AT(_e.currentTarget)&&_e.preventDefault(),_e.stopPropagation(),!B.ignoreEmulatedMouseEvents&&(B.isPressed=!0,B.isOverTarget=!0,B.target=_e.currentTarget,B.pointerType=QS(_e.nativeEvent)?"virtual":"mouse",!l&&!h&&Hl(_e.currentTarget),Z(_e,B.pointerType),D(document,"mouseup",fe,!1)))},Te.onMouseEnter=_e=>{_e.currentTarget.contains(_e.target)&&(_e.stopPropagation(),B.isPressed&&!B.ignoreEmulatedMouseEvents&&(B.isOverTarget=!0,Z(_e,B.pointerType)))},Te.onMouseLeave=_e=>{_e.currentTarget.contains(_e.target)&&(_e.stopPropagation(),B.isPressed&&!B.ignoreEmulatedMouseEvents&&(B.isOverTarget=!1,ie(_e,B.pointerType,!1),A.current.shouldCancelOnPointerExit&&ve(_e)))},Te.onMouseUp=_e=>{_e.currentTarget.contains(_e.target)&&!B.ignoreEmulatedMouseEvents&&_e.button===0&&re(_e,B.pointerType)};let fe=_e=>{if(_e.button===0){if(B.isPressed=!1,$(),B.ignoreEmulatedMouseEvents){B.ignoreEmulatedMouseEvents=!1;return}Wh(_e,B.target)?ie(kl(B.target,_e),B.pointerType):B.isOverTarget&&ie(kl(B.target,_e),B.pointerType,!1),B.isOverTarget=!1}};Te.onTouchStart=_e=>{if(!_e.currentTarget.contains(_e.target))return;_e.stopPropagation();let ke=B2e(_e.nativeEvent);ke&&(B.activePointerId=ke.identifier,B.ignoreEmulatedMouseEvents=!0,B.isOverTarget=!0,B.isPressed=!0,B.target=_e.currentTarget,B.pointerType="touch",!l&&!h&&Hl(_e.currentTarget),b||DF(B.target),Z(_e,B.pointerType),D(window,"scroll",Pe,!0))},Te.onTouchMove=_e=>{if(!_e.currentTarget.contains(_e.target)||(_e.stopPropagation(),!B.isPressed))return;let ke=FF(_e.nativeEvent,B.activePointerId);ke&&Wh(ke,_e.currentTarget)?B.isOverTarget||(B.isOverTarget=!0,Z(_e,B.pointerType)):B.isOverTarget&&(B.isOverTarget=!1,ie(_e,B.pointerType,!1),A.current.shouldCancelOnPointerExit&&ve(_e))},Te.onTouchEnd=_e=>{if(!_e.currentTarget.contains(_e.target)||(_e.stopPropagation(),!B.isPressed))return;let ke=FF(_e.nativeEvent,B.activePointerId);ke&&Wh(ke,_e.currentTarget)?(re(_e,B.pointerType),ie(_e,B.pointerType)):B.isOverTarget&&ie(_e,B.pointerType,!1),B.isPressed=!1,B.activePointerId=null,B.isOverTarget=!1,B.ignoreEmulatedMouseEvents=!0,b||r_(B.target),$()},Te.onTouchCancel=_e=>{_e.currentTarget.contains(_e.target)&&(_e.stopPropagation(),B.isPressed&&ve(_e))};let Pe=_e=>{B.isPressed&&_e.target.contains(B.target)&&ve({currentTarget:B.target,shiftKey:!1,ctrlKey:!1,metaKey:!1,altKey:!1})};Te.onDragStart=_e=>{_e.currentTarget.contains(_e.target)&&ve(_e)}}return Te},[D,l,h,$,b]);return te.useEffect(()=>()=>{b||r_(U.current.target)},[b]),{isPressed:o||L,pressProps:Vn(w,N)}}function i3(t){return t.tagName==="A"&&t.hasAttribute("href")}function ST(t,e){const{key:n,code:r}=t,i=e,s=i.getAttribute("role");return(n==="Enter"||n===" "||n==="Spacebar"||r==="Space")&&!(i instanceof HTMLInputElement&&!Wj(i,n)||i instanceof HTMLTextAreaElement||i.isContentEditable)&&(!i3(i)||s==="button"&&n!=="Enter")&&!(s==="link"&&n!=="Enter")}function B2e(t){const{targetTouches:e}=t;return e.length>0?e[0]:null}function FF(t,e){const n=t.changedTouches;for(let r=0;r<n.length;r++){const i=n[r];if(i.identifier===e)return i}return null}function kl(t,e){return{currentTarget:t,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey,altKey:e.altKey}}function U2e(t){let e=t.width/2||t.radiusX||0,n=t.height/2||t.radiusY||0;return{top:t.clientY-n,right:t.clientX+e,bottom:t.clientY+n,left:t.clientX-e}}function V2e(t,e){return!(t.left>e.right||e.left>t.right||t.top>e.bottom||e.top>t.bottom)}function Wh(t,e){let n=e.getBoundingClientRect(),r=U2e(t);return V2e(n,r)}function AT(t){return!(t instanceof HTMLElement)||!t.draggable}function NF(t,e){return t instanceof HTMLInputElement?!Wj(t,e):t instanceof HTMLButtonElement?t.type!=="submit":!0}const j2e=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function Wj(t,e){return t.type==="checkbox"||t.type==="radio"?e===" ":j2e.has(t.type)}const G2e=le.forwardRef(({children:t,...e},n)=>{let r=te.useRef(!1),i=te.useContext(Jb),s=Vn(i||{},{...e,ref:n||(i==null?void 0:i.ref),register(){r.current=!0,i&&i.register()}});return C$(i,n),te.useEffect(()=>{r.current||console.warn("A PressResponder was rendered without a pressable child. Either call the usePress hook, or wrap your DOM node with <Pressable> component.")},[]),le.createElement(Jb.Provider,{value:s},t)});class W2e{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,n){this.nativeEvent=n,this.target=n.target,this.currentTarget=n.currentTarget,this.relatedTarget=n.relatedTarget,this.bubbles=n.bubbles,this.cancelable=n.cancelable,this.defaultPrevented=n.defaultPrevented,this.eventPhase=n.eventPhase,this.isTrusted=n.isTrusted,this.timeStamp=n.timeStamp,this.type=e}}function Hj(t){let e=te.useRef({isFocused:!1,onBlur:t,observer:null});return e.current.onBlur=t,Ar(()=>{const n=e.current;return()=>{n.observer&&(n.observer.disconnect(),n.observer=null)}},[]),te.useCallback(n=>{if(n.target instanceof HTMLButtonElement||n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target instanceof HTMLSelectElement){e.current.isFocused=!0;let r=n.target,i=s=>{var l,o;e.current.isFocused=!1,r.disabled&&((o=(l=e.current).onBlur)===null||o===void 0||o.call(l,new W2e("blur",s))),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};r.addEventListener("focusout",i,{once:!0}),e.current.observer=new MutationObserver(()=>{e.current.isFocused&&r.disabled&&(e.current.observer.disconnect(),r.dispatchEvent(new FocusEvent("blur")),r.dispatchEvent(new FocusEvent("focusout",{bubbles:!0})))}),e.current.observer.observe(r,{attributes:!0,attributeFilter:["disabled"]})}},[])}function qj(t){let{isDisabled:e,onFocus:n,onBlur:r,onFocusChange:i}=t;const s=te.useCallback(h=>{if(h.target===h.currentTarget)return r&&r(h),i&&i(!1),!0},[r,i]),l=Hj(s),o=te.useCallback(h=>{h.target===h.currentTarget&&document.activeElement===h.target&&(n&&n(h),i&&i(!0),l(h))},[i,n,l]);return{focusProps:{onFocus:!e&&(n||i||r)?o:void 0,onBlur:!e&&(r||i)?s:void 0}}}let nh=null,s3=new Set,zF=!1,Gd=!1,o3=!1;const H2e={Tab:!0,Escape:!0};function vx(t,e){for(let n of s3)n(t,e)}function q2e(t){return!(t.metaKey||!i0()&&t.altKey||t.ctrlKey||t.key==="Control"||t.key==="Shift"||t.key==="Meta")}function BF(t){Gd=!0,q2e(t)&&(nh="keyboard",vx("keyboard",t))}function Hh(t){nh="pointer",(t.type==="mousedown"||t.type==="pointerdown")&&(Gd=!0,vx("pointer",t))}function K2e(t){QS(t)&&(Gd=!0,nh="virtual")}function X2e(t){t.target===window||t.target===document||(!Gd&&!o3&&(nh="virtual",vx("virtual",t)),Gd=!1,o3=!1)}function Z2e(){Gd=!1,o3=!0}function a3(){if(typeof window>"u"||zF)return;let t=HTMLElement.prototype.focus;HTMLElement.prototype.focus=function(){Gd=!0,t.apply(this,arguments)},document.addEventListener("keydown",BF,!0),document.addEventListener("keyup",BF,!0),document.addEventListener("click",K2e,!0),window.addEventListener("focus",X2e,!0),window.addEventListener("blur",Z2e,!1),typeof PointerEvent<"u"?(document.addEventListener("pointerdown",Hh,!0),document.addEventListener("pointermove",Hh,!0),document.addEventListener("pointerup",Hh,!0)):(document.addEventListener("mousedown",Hh,!0),document.addEventListener("mousemove",Hh,!0),document.addEventListener("mouseup",Hh,!0)),zF=!0}typeof document<"u"&&(document.readyState!=="loading"?a3():document.addEventListener("DOMContentLoaded",a3));function wy(){return nh!=="pointer"}function Qb(){return nh}function Y2e(t){nh=t,vx(t,null)}function J2e(t,e,n){return!(t&&e==="keyboard"&&n instanceof KeyboardEvent&&!H2e[n.key])}function Q2e(t,e,n){a3(),te.useEffect(()=>{let r=(i,s)=>{J2e(n==null?void 0:n.isTextInput,i,s)&&t(wy())};return s3.add(r),()=>{s3.delete(r)}},e)}function _x(t){let{isDisabled:e,onBlurWithin:n,onFocusWithin:r,onFocusWithinChange:i}=t,s=te.useRef({isFocusWithin:!1}),l=te.useCallback(p=>{s.current.isFocusWithin&&!p.currentTarget.contains(p.relatedTarget)&&(s.current.isFocusWithin=!1,n&&n(p),i&&i(!1))},[n,i,s]),o=Hj(l),h=te.useCallback(p=>{!s.current.isFocusWithin&&document.activeElement===p.target&&(r&&r(p),i&&i(!0),s.current.isFocusWithin=!0,o(p))},[r,i,o]);return e?{focusWithinProps:{onFocus:null,onBlur:null}}:{focusWithinProps:{onFocus:h,onBlur:l}}}let e1=!1,PT=0;function l3(){e1=!0,setTimeout(()=>{e1=!1},50)}function UF(t){t.pointerType==="touch"&&l3()}function eTe(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",UF):document.addEventListener("touchend",l3),PT++,()=>{PT--,!(PT>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",UF):document.removeEventListener("touchend",l3))}}function Au(t){let{onHoverStart:e,onHoverChange:n,onHoverEnd:r,isDisabled:i}=t,[s,l]=te.useState(!1),o=te.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;te.useEffect(eTe,[]);let{hoverProps:h,triggerHoverEnd:p}=te.useMemo(()=>{let b=(A,L)=>{if(o.pointerType=L,i||L==="touch"||o.isHovered||!A.currentTarget.contains(A.target))return;o.isHovered=!0;let M=A.currentTarget;o.target=M,e&&e({type:"hoverstart",target:M,pointerType:L}),n&&n(!0),l(!0)},x=(A,L)=>{if(o.pointerType="",o.target=null,L==="touch"||!o.isHovered)return;o.isHovered=!1;let M=A.currentTarget;r&&r({type:"hoverend",target:M,pointerType:L}),n&&n(!1),l(!1)},w={};return typeof PointerEvent<"u"?(w.onPointerEnter=A=>{e1&&A.pointerType==="mouse"||b(A,A.pointerType)},w.onPointerLeave=A=>{!i&&A.currentTarget.contains(A.target)&&x(A,A.pointerType)}):(w.onTouchStart=()=>{o.ignoreEmulatedMouseEvents=!0},w.onMouseEnter=A=>{!o.ignoreEmulatedMouseEvents&&!e1&&b(A,"mouse"),o.ignoreEmulatedMouseEvents=!1},w.onMouseLeave=A=>{!i&&A.currentTarget.contains(A.target)&&x(A,"mouse")}),{hoverProps:w,triggerHoverEnd:x}},[e,n,r,i,o]);return te.useEffect(()=>{i&&p({currentTarget:o.target},o.pointerType)},[i]),{hoverProps:h,isHovered:s}}function tTe(t){let{ref:e,onInteractOutside:n,isDisabled:r,onInteractOutsideStart:i}=t,l=te.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1,onInteractOutside:n,onInteractOutsideStart:i}).current;l.onInteractOutside=n,l.onInteractOutsideStart=i,te.useEffect(()=>{if(r)return;let o=h=>{i_(h,e)&&l.onInteractOutside&&(l.onInteractOutsideStart&&l.onInteractOutsideStart(h),l.isPointerDown=!0)};if(typeof PointerEvent<"u"){let h=p=>{l.isPointerDown&&l.onInteractOutside&&i_(p,e)&&l.onInteractOutside(p),l.isPointerDown=!1};return document.addEventListener("pointerdown",o,!0),document.addEventListener("pointerup",h,!0),()=>{document.removeEventListener("pointerdown",o,!0),document.removeEventListener("pointerup",h,!0)}}else{let h=b=>{l.ignoreEmulatedMouseEvents?l.ignoreEmulatedMouseEvents=!1:l.isPointerDown&&l.onInteractOutside&&i_(b,e)&&l.onInteractOutside(b),l.isPointerDown=!1},p=b=>{l.ignoreEmulatedMouseEvents=!0,l.onInteractOutside&&l.isPointerDown&&i_(b,e)&&l.onInteractOutside(b),l.isPointerDown=!1};return document.addEventListener("mousedown",o,!0),document.addEventListener("mouseup",h,!0),document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",p,!0),()=>{document.removeEventListener("mousedown",o,!0),document.removeEventListener("mouseup",h,!0),document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",p,!0)}}},[e,l,r])}function i_(t,e){if(t.button>0)return!1;if(t.target){const n=t.target.ownerDocument;if(!n||!n.documentElement.contains(t.target)||t.target.closest("[data-react-aria-top-layer]"))return!1}return e.current&&!e.current.contains(t.target)}function VF(t){if(!t)return;let e=!0;return n=>{let r={...n,preventDefault(){n.preventDefault()},isDefaultPrevented(){return n.isDefaultPrevented()},stopPropagation(){console.error("stopPropagation is now the default behavior for events in React Spectrum. You can use continuePropagation() to revert this behavior.")},continuePropagation(){e=!1}};t(r),e&&n.stopPropagation()}}function nTe(t){return{keyboardProps:t.isDisabled?{}:{onKeyDown:VF(t.onKeyDown),onKeyUp:VF(t.onKeyUp)}}}const rTe=500;function Kj(t){let{isDisabled:e,onLongPressStart:n,onLongPressEnd:r,onLongPress:i,threshold:s=rTe,accessibilityDescription:l}=t;const o=te.useRef(null);let{addGlobalListener:h,removeGlobalListener:p}=Mj(),{pressProps:b}=O$({isDisabled:e,onPressStart(w){if((w.pointerType==="mouse"||w.pointerType==="touch")&&(n&&n({...w,type:"longpressstart"}),o.current=setTimeout(()=>{w.target.dispatchEvent(new PointerEvent("pointercancel",{bubbles:!0})),i&&i({...w,type:"longpress"}),o.current=null},s),w.pointerType==="touch")){let A=L=>{L.preventDefault()};h(w.target,"contextmenu",A,{once:!0}),h(window,"pointerup",()=>{setTimeout(()=>{p(w.target,"contextmenu",A)},30)},{once:!0})}},onPressEnd(w){o.current&&clearTimeout(o.current),r&&(w.pointerType==="mouse"||w.pointerType==="touch")&&r({...w,type:"longpressend"})}}),x=a2e(i&&!e?l:null);return{longPressProps:Vn(b,x)}}function Wd(t){if(Qb()==="virtual"){let e=document.activeElement;Rj(()=>{document.activeElement===e&&document.contains(t)&&Hl(t)})}else Hl(t)}function iTe(t){if(!(t instanceof HTMLElement)&&!(t instanceof SVGElement))return!1;let{display:e,visibility:n}=t.style,r=e!=="none"&&n!=="hidden"&&n!=="collapse";if(r){const{getComputedStyle:i}=t.ownerDocument.defaultView;let{display:s,visibility:l}=i(t);r=s!=="none"&&l!=="hidden"&&l!=="collapse"}return r}function sTe(t,e){return!t.hasAttribute("hidden")&&(t.nodeName==="DETAILS"&&e&&e.nodeName!=="SUMMARY"?t.hasAttribute("open"):!0)}function Xj(t,e){return t.nodeName!=="#comment"&&iTe(t)&&sTe(t,e)&&(!t.parentElement||Xj(t.parentElement,t))}const jF=le.createContext(null);let Or=null;function D$(t){let{children:e,contain:n,restoreFocus:r,autoFocus:i}=t,s=te.useRef(),l=te.useRef(),o=te.useRef([]),{parentNode:h}=te.useContext(jF)||{},p=te.useMemo(()=>new c3({scopeRef:o}),[o]);Ar(()=>{let w=h||fi.root;if(fi.getTreeNode(w.scopeRef)&&Or&&!n1(Or,w.scopeRef)){let A=fi.getTreeNode(Or);A&&(w=A)}w.addChild(p),fi.addNode(p)},[p,h]),Ar(()=>{let w=fi.getTreeNode(o);w.contain=n},[n]),Ar(()=>{let w=s.current.nextSibling,A=[];for(;w&&w!==l.current;)A.push(w),w=w.nextSibling;o.current=A},[e]),hTe(o,r,n),cTe(o,n),pTe(o,r,n),dTe(o,i),te.useEffect(()=>{if(o){let w=document.activeElement,A=null;if(Fs(w,o.current)){for(let L of fi.traverse())Fs(w,L.scopeRef.current)&&(A=L);A===fi.getTreeNode(o)&&(Or=A.scopeRef)}return()=>{let L=fi.getTreeNode(o).parent.scopeRef;(o===Or||n1(o,Or))&&(!L||fi.getTreeNode(L))&&(Or=L),fi.removeTreeNode(o)}}},[o]);let b=te.useMemo(()=>oTe(o),[]),x=te.useMemo(()=>({focusManager:b,parentNode:p}),[p,b]);return le.createElement(jF.Provider,{value:x},le.createElement("span",{"data-focus-scope-start":!0,hidden:!0,ref:s}),e,le.createElement("span",{"data-focus-scope-end":!0,hidden:!0,ref:l}))}function oTe(t){return{focusNext(e={}){let n=t.current,{from:r,tabbable:i,wrap:s,accept:l}=e,o=r||document.activeElement,h=n[0].previousElementSibling,p=Kl(bd(n),{tabbable:i,accept:l},n);p.currentNode=Fs(o,n)?o:h;let b=p.nextNode();return!b&&s&&(p.currentNode=h,b=p.nextNode()),b&&ql(b,!0),b},focusPrevious(e={}){let n=t.current,{from:r,tabbable:i,wrap:s,accept:l}=e,o=r||document.activeElement,h=n[n.length-1].nextElementSibling,p=Kl(bd(n),{tabbable:i,accept:l},n);p.currentNode=Fs(o,n)?o:h;let b=p.previousNode();return!b&&s&&(p.currentNode=h,b=p.previousNode()),b&&ql(b,!0),b},focusFirst(e={}){let n=t.current,{tabbable:r,accept:i}=e,s=Kl(bd(n),{tabbable:r,accept:i},n);s.currentNode=n[0].previousElementSibling;let l=s.nextNode();return l&&ql(l,!0),l},focusLast(e={}){let n=t.current,{tabbable:r,accept:i}=e,s=Kl(bd(n),{tabbable:r,accept:i},n);s.currentNode=n[n.length-1].nextElementSibling;let l=s.previousNode();return l&&ql(l,!0),l}}}const F$=["input:not([disabled]):not([type=hidden])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[contenteditable]"],aTe=F$.join(":not([hidden]),")+",[tabindex]:not([disabled]):not([hidden])";F$.push('[tabindex]:not([tabindex="-1"]):not([disabled])');const lTe=F$.join(':not([hidden]):not([tabindex="-1"]),');function bd(t){return t[0].parentElement}function s_(t){let e=fi.getTreeNode(Or);for(;e&&e.scopeRef!==t;){if(e.contain)return!1;e=e.parent}return!0}function cTe(t,e){let n=te.useRef(),r=te.useRef(null);Ar(()=>{let i=t.current;if(!e){r.current&&(cancelAnimationFrame(r.current),r.current=null);return}let s=h=>{if(h.key!=="Tab"||h.altKey||h.ctrlKey||h.metaKey||!s_(t))return;let p=document.activeElement,b=t.current;if(!Fs(p,b))return;let x=Kl(bd(b),{tabbable:!0},b);x.currentNode=p;let w=h.shiftKey?x.previousNode():x.nextNode();w||(x.currentNode=h.shiftKey?b[b.length-1].nextElementSibling:b[0].previousElementSibling,w=h.shiftKey?x.previousNode():x.nextNode()),h.preventDefault(),w&&ql(w,!0)},l=h=>{(!Or||n1(Or,t))&&Fs(h.target,t.current)?(Or=t,n.current=h.target):s_(t)&&!t1(h.target,t)?n.current?n.current.focus():Or&&r1(Or.current):s_(t)&&(n.current=h.target)},o=h=>{r.current&&cancelAnimationFrame(r.current),r.current=requestAnimationFrame(()=>{s_(t)&&!t1(document.activeElement,t)&&(Or=t,document.body.contains(h.target)?(n.current=h.target,n.current.focus()):Or&&r1(Or.current))})};return document.addEventListener("keydown",s,!1),document.addEventListener("focusin",l,!1),i.forEach(h=>h.addEventListener("focusin",l,!1)),i.forEach(h=>h.addEventListener("focusout",o,!1)),()=>{document.removeEventListener("keydown",s,!1),document.removeEventListener("focusin",l,!1),i.forEach(h=>h.removeEventListener("focusin",l,!1)),i.forEach(h=>h.removeEventListener("focusout",o,!1))}},[t,e]),te.useEffect(()=>()=>{r.current&&cancelAnimationFrame(r.current)},[r])}function Zj(t){return t1(t)}function Fs(t,e){return e.some(n=>n.contains(t))}function t1(t,e=null){if(t instanceof Element&&t.closest("[data-react-aria-top-layer]"))return!0;for(let{scopeRef:n}of fi.traverse(fi.getTreeNode(e)))if(Fs(t,n.current))return!0;return!1}function uTe(t){return t1(t,Or)}function n1(t,e){var n;let r=(n=fi.getTreeNode(e))===null||n===void 0?void 0:n.parent;for(;r;){if(r.scopeRef===t)return!0;r=r.parent}return!1}function ql(t,e=!1){if(t!=null&&!e)try{Wd(t)}catch{}else if(t!=null)try{t.focus()}catch{}}function r1(t,e=!0){let n=t[0].previousElementSibling,r=Kl(bd(t),{tabbable:e},t);r.currentNode=n;let i=r.nextNode();e&&!i&&(r=Kl(bd(t),{tabbable:!1},t),r.currentNode=n,i=r.nextNode()),ql(i)}function dTe(t,e){const n=le.useRef(e);te.useEffect(()=>{n.current&&(Or=t,Fs(document.activeElement,Or.current)||r1(t.current)),n.current=!1},[t])}function hTe(t,e,n){Ar(()=>{if(e||n)return;let r=t.current,i=s=>{let l=s.target;Fs(l,t.current)?Or=t:Zj(l)||(Or=null)};return document.addEventListener("focusin",i,!1),r.forEach(s=>s.addEventListener("focusin",i,!1)),()=>{document.removeEventListener("focusin",i,!1),r.forEach(s=>s.removeEventListener("focusin",i,!1))}},[t,e,n])}function fTe(t){let e=fi.getTreeNode(Or);for(;e&&e.scopeRef!==t;){if(e.nodeToRestore)return!1;e=e.parent}return(e==null?void 0:e.scopeRef)===t}function pTe(t,e,n){const r=te.useRef(typeof document<"u"?document.activeElement:null);Ar(()=>{let i=t.current;if(!e||n)return;let s=()=>{(!Or||n1(Or,t))&&(Or=t)};return document.addEventListener("focusin",s,!1),i.forEach(l=>l.addEventListener("focusin",s,!1)),()=>{document.removeEventListener("focusin",s,!1),i.forEach(l=>l.removeEventListener("focusin",s,!1))}},[t,n]),Ar(()=>{if(!e)return;fi.getTreeNode(t).nodeToRestore=r.current;let i=s=>{if(s.key!=="Tab"||s.altKey||s.ctrlKey||s.metaKey)return;let l=document.activeElement;if(!Fs(l,t.current))return;let o=fi.getTreeNode(t).nodeToRestore,h=Kl(document.body,{tabbable:!0});h.currentNode=l;let p=s.shiftKey?h.previousNode():h.nextNode();if((!document.body.contains(o)||o===document.body)&&(o=null,fi.getTreeNode(t).nodeToRestore=null),(!p||!Fs(p,t.current))&&o){h.currentNode=o;do p=s.shiftKey?h.previousNode():h.nextNode();while(Fs(p,t.current));s.preventDefault(),s.stopPropagation(),p?ql(p,!0):Zj(o)?ql(o,!0):l.blur()}};return n||document.addEventListener("keydown",i,!0),()=>{n||document.removeEventListener("keydown",i,!0);let s=fi.getTreeNode(t).nodeToRestore;if(e&&s&&(Fs(document.activeElement,t.current)||document.activeElement===document.body&&fTe(t))){let l=fi.clone();requestAnimationFrame(()=>{if(document.activeElement===document.body){let o=l.getTreeNode(t);for(;o;){if(o.nodeToRestore&&document.body.contains(o.nodeToRestore)){ql(o.nodeToRestore);return}o=o.parent}for(o=l.getTreeNode(t);o;){if(o.scopeRef&&fi.getTreeNode(o.scopeRef)){r1(o.scopeRef.current,!0);return}o=o.parent}}})}}},[t,e,n])}function Kl(t,e,n){let r=e!=null&&e.tabbable?lTe:aTe,i=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode(s){var l;return!(e==null||(l=e.from)===null||l===void 0)&&l.contains(s)?NodeFilter.FILTER_REJECT:s.matches(r)&&Xj(s)&&(!n||Fs(s,n))&&(!(e!=null&&e.accept)||e.accept(s))?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return e!=null&&e.from&&(i.currentNode=e.from),i}class N${get size(){return this.fastMap.size}getTreeNode(e){return this.fastMap.get(e)}addTreeNode(e,n,r){let i=this.fastMap.get(n??null),s=new c3({scopeRef:e});i.addChild(s),s.parent=i,this.fastMap.set(e,s),r&&(s.nodeToRestore=r)}addNode(e){this.fastMap.set(e.scopeRef,e)}removeTreeNode(e){if(e===null)return;let n=this.fastMap.get(e),r=n.parent;for(let s of this.traverse())s!==n&&n.nodeToRestore&&s.nodeToRestore&&n.scopeRef.current&&Fs(s.nodeToRestore,n.scopeRef.current)&&(s.nodeToRestore=n.nodeToRestore);let i=n.children;r.removeChild(n),i.size>0&&i.forEach(s=>r.addChild(s)),this.fastMap.delete(n.scopeRef)}*traverse(e=this.root){if(e.scopeRef!=null&&(yield e),e.children.size>0)for(let n of e.children)yield*this.traverse(n)}clone(){let e=new N$;for(let n of this.traverse())e.addTreeNode(n.scopeRef,n.parent.scopeRef,n.nodeToRestore);return e}constructor(){$r(this,"fastMap",new Map),this.root=new c3({scopeRef:null}),this.fastMap.set(null,this.root)}}class c3{addChild(e){this.children.add(e),e.parent=this}removeChild(e){this.children.delete(e),e.parent=void 0}constructor(e){$r(this,"children",new Set),$r(this,"contain",!1),this.scopeRef=e.scopeRef}}let fi=new N$;function Yj(t={}){let{autoFocus:e=!1,isTextInput:n,within:r}=t,i=te.useRef({isFocused:!1,isFocusVisible:e||wy()}),[s,l]=te.useState(!1),[o,h]=te.useState(()=>i.current.isFocused&&i.current.isFocusVisible),p=te.useCallback(()=>h(i.current.isFocused&&i.current.isFocusVisible),[]),b=te.useCallback(A=>{i.current.isFocused=A,l(A),p()},[p]);Q2e(A=>{i.current.isFocusVisible=A,p()},[],{isTextInput:n});let{focusProps:x}=qj({isDisabled:r,onFocusChange:b}),{focusWithinProps:w}=_x({isDisabled:!r,onFocusWithinChange:b});return{isFocused:s,isFocusVisible:i.current.isFocused&&o,focusProps:r?w:x}}function Ap(t){let{children:e,focusClass:n,focusRingClass:r}=t,{isFocused:i,isFocusVisible:s,focusProps:l}=Yj(t),o=le.Children.only(e);return le.cloneElement(o,Vn(o.props,{...l,className:px({[n||""]:i,[r||""]:s})}))}let mTe=le.createContext(null);function gTe(t){let e=te.useContext(mTe)||{};C$(e,t);let{ref:n,...r}=e;return r}function Jj(t,e){let{focusProps:n}=qj(t),{keyboardProps:r}=nTe(t),i=Vn(n,r),s=gTe(e),l=t.isDisabled?{}:s,o=te.useRef(t.autoFocus);return te.useEffect(()=>{o.current&&e.current&&Wd(e.current),o.current=!1},[e]),{focusableProps:Vn({...i,tabIndex:t.excludeFromTabOrder&&!t.isDisabled?-1:void 0},l)}}function yTe(t,e){t=Su(t,"text");let{children:n,...r}=t,{styleProps:i}=mi(r),s=io(e);return le.createElement("span",{...Hi(r),...i,ref:s},n)}const wa=te.forwardRef(yTe);function vTe(t,e){t=Su(t,"heading");let{children:n,level:r=3,...i}=t,{styleProps:s}=mi(i),l=io(e),o=`h${r}`;return le.createElement(o,{...Hi(i),...s,ref:l},n)}const i1=te.forwardRef(vTe);function bx(t,e){let{elementType:n="button",isDisabled:r,onPress:i,onPressStart:s,onPressEnd:l,onPressChange:o,preventFocusOnPress:h,allowFocusWhenDisabled:p,onClick:b,href:x,target:w,rel:A,type:L="button"}=t,M;n==="button"?M={type:L,disabled:r}:M={role:"button",tabIndex:r?void 0:0,href:n==="a"&&r?void 0:x,target:n==="a"?w:void 0,type:n==="input"?L:void 0,disabled:n==="input"?r:void 0,"aria-disabled":!r||n==="input"?void 0:r,rel:n==="a"?A:void 0};let{pressProps:U,isPressed:D}=O$({onPressStart:s,onPressEnd:l,onPressChange:o,onPress:i,isDisabled:r,preventFocusOnPress:h,ref:e}),{focusableProps:$}=Jj(t,e);p&&($.tabIndex=r?-1:$.tabIndex);let N=Vn($,U,Hi(t,{labelable:!0}));return{isPressed:D,buttonProps:Vn(M,N,{"aria-haspopup":t["aria-haspopup"],"aria-expanded":t["aria-expanded"],"aria-controls":t["aria-controls"],"aria-pressed":t["aria-pressed"],onClick:B=>{b&&(b(B),console.warn("onClick is deprecated, please use onPress"))}})}}const GF={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function _Te(t={}){let{style:e,isFocusable:n}=t,[r,i]=te.useState(!1),{focusWithinProps:s}=_x({isDisabled:!n,onFocusWithinChange:o=>i(o)}),l=te.useMemo(()=>r?e:e?{...GF,...e}:GF,[r]);return{visuallyHiddenProps:{...s,style:l}}}function bTe(t){let{children:e,elementType:n="div",isFocusable:r,style:i,...s}=t,{visuallyHiddenProps:l}=_Te(t);return le.createElement(n,Vn(s,l),e)}function xTe(t){return t&&t.__esModule?t.default:t}const WF={top:"top",bottom:"top",left:"left",right:"left"},s1={top:"bottom",bottom:"top",left:"right",right:"left"},wTe={top:"left",left:"top"},u3={top:"height",left:"width"},TTe={width:"totalWidth",height:"totalHeight"},o_={};let qh=typeof window<"u"&&window.visualViewport;function ETe(t){let e=0,n=0,r=0,i=0,s=0,l=0,o={};if(t.tagName==="BODY"){let b=document.documentElement;r=b.clientWidth,i=b.clientHeight;var h;e=(h=qh==null?void 0:qh.width)!==null&&h!==void 0?h:r;var p;n=(p=qh==null?void 0:qh.height)!==null&&p!==void 0?p:i,o.top=b.scrollTop||t.scrollTop,o.left=b.scrollLeft||t.scrollLeft}else({width:e,height:n,top:s,left:l}=Df(t)),o.top=t.scrollTop,o.left=t.scrollLeft,r=e,i=n;return{width:e,height:n,totalWidth:r,totalHeight:i,scroll:o,top:s,left:l}}function STe(t){return{top:t.scrollTop,left:t.scrollLeft,width:t.scrollWidth,height:t.scrollHeight}}function HF(t,e,n,r,i){let s=r.scroll[t],l=r[u3[t]],o=e-i-s,h=e+i-s+n;return o<0?-o:h>l?Math.max(l-h,-o):0}function ATe(t){let e=window.getComputedStyle(t);return{top:parseInt(e.marginTop,10)||0,bottom:parseInt(e.marginBottom,10)||0,left:parseInt(e.marginLeft,10)||0,right:parseInt(e.marginRight,10)||0}}function qF(t){if(o_[t])return o_[t];let[e,n]=t.split(" "),r=WF[e]||"right",i=wTe[r];WF[n]||(n="center");let s=u3[r],l=u3[i];return o_[t]={placement:e,crossPlacement:n,axis:r,crossAxis:i,size:s,crossSize:l},o_[t]}function CT(t,e,n,r,i,s,l,o,h,p){let{placement:b,crossPlacement:x,axis:w,crossAxis:A,size:L,crossSize:M}=r,U={};U[A]=t[A],x==="center"?U[A]+=(t[M]-n[M])/2:x!==A&&(U[A]+=t[M]-n[M]),U[A]+=s;const D=t[A]-n[M]+h+p,$=t[A]+t[M]-h-p;if(U[A]=_y(U[A],D,$),b===w){const N=o?l[L]:e[TTe[L]];U[s1[w]]=Math.floor(N-t[w]+i)}else U[w]=Math.floor(t[w]+t[L]+i);return U}function PTe(t,e,n,r,i,s){return t.top!=null?Math.max(0,e.height+e.top+e.scroll.top-(n.top+t.top)-(i.top+i.bottom+s)):Math.max(0,r.top+n.top-(e.top+e.scroll.top)-(i.top+i.bottom+s))}function KF(t,e,n,r,i,s){let{placement:l,axis:o,size:h}=s;return l===o?Math.max(0,n[o]-t[o]-t.scroll[o]+e[o]-r[o]-r[s1[o]]-i):Math.max(0,t[h]+t[o]+t.scroll[o]-e[o]-n[o]-n[h]-r[o]-r[s1[o]]-i)}function CTe(t,e,n,r,i,s,l,o,h,p,b,x,w,A,L){let M=qF(t),{size:U,crossAxis:D,crossSize:$,placement:N,crossPlacement:B}=M,Z=CT(e,o,n,M,p,b,h,x,A,L),ie=p,re=KF(o,h,e,i,s+p,M);if(l&&r[U]>re){let rn=qF(`${s1[N]} ${B}`),ot=CT(e,o,n,rn,p,b,h,x,A,L);KF(o,h,e,i,s+p,rn)>re&&(M=rn,Z=ot,ie=p)}let ve=HF(D,Z[D],n[$],o,s);Z[D]+=ve;let Te=PTe(Z,o,h,e,i,s);w&&w<Te&&(Te=w),n.height=Math.min(n.height,Te),Z=CT(e,o,n,M,ie,b,h,x,A,L),ve=HF(D,Z[D],n[$],o,s),Z[D]+=ve;let Ae={},fe=e[D]+.5*e[$]-n[D];const Pe=A/2+L,_e=n[$]-A/2-L,ke=e[D]-n[D]+A/2,Vt=e[D]+e[$]-n[D]-A/2,ut=_y(fe,ke,Vt);return Ae[D]=_y(ut,Pe,_e),{position:Z,maxHeight:Te,arrowOffsetLeft:Ae.left,arrowOffsetTop:Ae.top,placement:M.placement}}function LTe(t){let{placement:e,targetNode:n,overlayNode:r,scrollNode:i,padding:s,shouldFlip:l,boundaryElement:o,offset:h,crossOffset:p,maxHeight:b,arrowSize:x,arrowBoundaryOffset:w=0}=t,A=r instanceof HTMLElement?ITe(r):document.documentElement,L=A===document.documentElement;const M=window.getComputedStyle(A).position;let U=!!M&&M!=="static",D=L?Df(n):XF(n,A);if(!L){let{marginTop:re,marginLeft:ve}=window.getComputedStyle(n);D.top+=parseInt(re,10)||0,D.left+=parseInt(ve,10)||0}let $=Df(r),N=ATe(r);$.width+=N.left+N.right,$.height+=N.top+N.bottom;let B=STe(i),Z=ETe(o),ie=o.tagName==="BODY"?Df(A):XF(A,o);return CTe(e,D,$,B,N,s,l,Z,ie,h,p,U,b,x,w)}function Df(t){let{top:e,left:n,width:r,height:i}=t.getBoundingClientRect(),{scrollTop:s,scrollLeft:l,clientTop:o,clientLeft:h}=document.documentElement;return{top:e+s-o,left:n+l-h,width:r,height:i}}function XF(t,e){let n=window.getComputedStyle(t),r;if(n.position==="fixed"){let{top:i,left:s,width:l,height:o}=t.getBoundingClientRect();r={top:i,left:s,width:l,height:o}}else{r=Df(t);let i=Df(e),s=window.getComputedStyle(e);i.top+=(parseInt(s.borderTopWidth,10)||0)-e.scrollTop,i.left+=(parseInt(s.borderLeftWidth,10)||0)-e.scrollLeft,r.top-=i.top,r.left-=i.left}return r.top-=parseInt(n.marginTop,10)||0,r.left-=parseInt(n.marginLeft,10)||0,r}function ITe(t){let e=t.offsetParent;if(e&&e===document.body&&window.getComputedStyle(e).position==="static"&&!ZF(e)&&(e=document.documentElement),e==null)for(e=t.parentElement;e&&!ZF(e);)e=e.parentElement;return e||document.documentElement}function ZF(t){let e=window.getComputedStyle(t);return e.transform!=="none"||/transform|perspective/.test(e.willChange)||e.filter!=="none"||e.contain==="paint"||"backdropFilter"in e&&e.backdropFilter!=="none"||"WebkitBackdropFilter"in e&&e.WebkitBackdropFilter!=="none"}const Qj=new WeakMap;function RTe(t){let{triggerRef:e,isOpen:n,onClose:r}=t;te.useEffect(()=>{if(!n||r===null)return;let i=s=>{let l=s.target;if(!e.current||l instanceof Node&&!l.contains(e.current))return;let o=r||Qj.get(e.current);o&&o()};return window.addEventListener("scroll",i,!0),()=>{window.removeEventListener("scroll",i,!0)}},[n,r,e])}let Vo=typeof window<"u"&&window.visualViewport;function MTe(t){let{direction:e}=Ra(),{arrowSize:n=0,targetRef:r,overlayRef:i,scrollRef:s=i,placement:l="bottom",containerPadding:o=12,shouldFlip:h=!0,boundaryElement:p=typeof document<"u"?document.body:null,offset:b=0,crossOffset:x=0,shouldUpdatePosition:w=!0,isOpen:A=!0,onClose:L,maxHeight:M,arrowBoundaryOffset:U=0}=t,[D,$]=te.useState({position:{},arrowOffsetLeft:void 0,arrowOffsetTop:void 0,maxHeight:void 0,placement:void 0}),N=[w,l,i.current,r.current,s.current,o,h,p,b,x,A,e,M,U,n],B=te.useCallback(()=>{if(w===!1||!A||!i.current||!r.current||!s.current||!p)return;let re=LTe({placement:kTe(l,e),overlayNode:i.current,targetNode:r.current,scrollNode:s.current,padding:o,shouldFlip:h,boundaryElement:p,offset:b,crossOffset:x,maxHeight:M,arrowSize:n,arrowBoundaryOffset:U});Object.keys(re.position).forEach(ve=>i.current.style[ve]=re.position[ve]+"px"),i.current.style.maxHeight=re.maxHeight!=null?re.maxHeight+"px":void 0,$(re)},N);Ar(B,N),$Te(B),P$({ref:i,onResize:B});let Z=te.useRef(!1);Ar(()=>{let re,ve=()=>{Z.current=!0,clearTimeout(re),re=setTimeout(()=>{Z.current=!1},500),B()};return Vo==null||Vo.addEventListener("resize",ve),Vo==null||Vo.addEventListener("scroll",ve),()=>{Vo==null||Vo.removeEventListener("resize",ve),Vo==null||Vo.removeEventListener("scroll",ve)}},[B]);let ie=te.useCallback(()=>{Z.current||L()},[L,Z]);return RTe({triggerRef:r,isOpen:A,onClose:L&&ie}),{overlayProps:{style:{position:"absolute",zIndex:1e5,...D.position,maxHeight:D.maxHeight}},placement:D.placement,arrowProps:{style:{left:D.arrowOffsetLeft,top:D.arrowOffsetTop}},updatePosition:B}}function $Te(t){Ar(()=>(window.addEventListener("resize",t,!1),()=>{window.removeEventListener("resize",t,!1)}),[t])}function kTe(t,e){return e==="rtl"?t.replace("start","right").replace("end","left"):t.replace("start","left").replace("end","right")}const Ol=[];function eG(t,e){let{onClose:n,shouldCloseOnBlur:r,isOpen:i,isDismissable:s=!1,isKeyboardDismissDisabled:l=!1,shouldCloseOnInteractOutside:o}=t;te.useEffect(()=>(i&&Ol.push(e),()=>{let L=Ol.indexOf(e);L>=0&&Ol.splice(L,1)}),[i,e]);let h=()=>{Ol[Ol.length-1]===e&&n&&n()},p=L=>{(!o||o(L.target))&&Ol[Ol.length-1]===e&&(L.stopPropagation(),L.preventDefault())},b=L=>{(!o||o(L.target))&&(Ol[Ol.length-1]===e&&(L.stopPropagation(),L.preventDefault()),h())},x=L=>{L.key==="Escape"&&!l&&(L.stopPropagation(),L.preventDefault(),h())};tTe({ref:e,onInteractOutside:s?b:null,onInteractOutsideStart:p});let{focusWithinProps:w}=_x({isDisabled:!r,onBlurWithin:L=>{L.relatedTarget&&uTe(L.relatedTarget)||(!o||o(L.relatedTarget))&&n()}}),A=L=>{L.target===L.currentTarget&&L.preventDefault()};return{overlayProps:{onKeyDown:x,...w},underlayProps:{onPointerDown:A}}}function tG(t,e,n){let{type:r}=t,{isOpen:i}=e;te.useEffect(()=>{n&&n.current&&Qj.set(n.current,e.close)});let s;r==="menu"?s=!0:r==="listbox"&&(s="listbox");let l=ta();return{triggerProps:{"aria-haspopup":s,"aria-expanded":i,"aria-controls":i?l:null,onPress:e.toggle},overlayProps:{id:l}}}const LT=typeof window<"u"&&window.visualViewport,OTe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let a_=0,IT;function nG(t={}){let{isDisabled:e}=t;Ar(()=>{if(!e)return a_++,a_===1&&(mx()?IT=FTe():IT=DTe()),()=>{a_--,a_===0&&IT()}},[e])}function DTe(){return xy(Ug(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),Ug(document.documentElement,"overflow","hidden"))}function FTe(){let t,e=0,n=x=>{t=Xb(x.target),!(t===document.documentElement&&t===document.body)&&(e=x.changedTouches[0].pageY)},r=x=>{if(t===document.documentElement||t===document.body){x.preventDefault();return}let w=x.changedTouches[0].pageY,A=t.scrollTop,L=t.scrollHeight-t.clientHeight;(A<=0&&w>e||A>=L&&w<e)&&x.preventDefault(),e=w},i=x=>{let w=x.target;JF(w)&&w!==document.activeElement&&(x.preventDefault(),w.style.transform="translateY(-2000px)",w.focus(),requestAnimationFrame(()=>{w.style.transform=""}))},s=x=>{let w=x.target;JF(w)&&(w.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{w.style.transform="",LT&&(LT.height<window.innerHeight?requestAnimationFrame(()=>{YF(w)}):LT.addEventListener("resize",()=>YF(w),{once:!0}))}))},l=()=>{window.scrollTo(0,0)},o=window.pageXOffset,h=window.pageYOffset,p=xy(Ug(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),Ug(document.documentElement,"overflow","hidden"),Ug(document.body,"marginTop",`-${h}px`));window.scrollTo(0,0);let b=xy(Ym(document,"touchstart",n,{passive:!1,capture:!0}),Ym(document,"touchmove",r,{passive:!1,capture:!0}),Ym(document,"touchend",i,{passive:!1,capture:!0}),Ym(document,"focus",s,!0),Ym(window,"scroll",l));return()=>{p(),b(),window.scrollTo(o,h)}}function Ug(t,e,n){let r=t.style[e];return t.style[e]=n,()=>{t.style[e]=r}}function Ym(t,e,n,r){return t.addEventListener(e,n,r),()=>{t.removeEventListener(e,n,r)}}function YF(t){let e=document.scrollingElement||document.documentElement;for(;t&&t!==e;){let n=Xb(t);if(n!==document.documentElement&&n!==document.body&&n!==t){let r=n.getBoundingClientRect().top,i=t.getBoundingClientRect().top;i>r+t.clientHeight&&(n.scrollTop+=i-r)}t=n.parentElement}}function JF(t){return t instanceof HTMLInputElement&&!OTe.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}const d3=le.createContext(null);function NTe(t){let{children:e}=t,n=te.useContext(d3),[r,i]=te.useState(0),s=te.useMemo(()=>({parent:n,modalCount:r,addModal(){i(l=>l+1),n&&n.addModal()},removeModal(){i(l=>l-1),n&&n.removeModal()}}),[n,r]);return le.createElement(d3.Provider,{value:s},e)}function zTe(){let t=te.useContext(d3);return{modalProviderProps:{"aria-hidden":t&&t.modalCount>0?!0:null}}}var rG={},iG={};iG={dismiss:""};var sG={};sG={dismiss:""};var oG={};oG={dismiss:"Odstranit"};var aG={};aG={dismiss:"Luk"};var lG={};lG={dismiss:"Schlieen"};var cG={};cG={dismiss:""};var uG={};uG={dismiss:"Dismiss"};var dG={};dG={dismiss:"Descartar"};var hG={};hG={dismiss:"Lpeta"};var fG={};fG={dismiss:"Hylk"};var pG={};pG={dismiss:"Rejeter"};var mG={};mG={dismiss:""};var gG={};gG={dismiss:"Odbaci"};var yG={};yG={dismiss:"Elutasts"};var vG={};vG={dismiss:"Ignora"};var _G={};_G={dismiss:""};var bG={};bG={dismiss:""};var xG={};xG={dismiss:"Atmesti"};var wG={};wG={dismiss:"Nerdt"};var TG={};TG={dismiss:"Lukk"};var EG={};EG={dismiss:"Negeren"};var SG={};SG={dismiss:"Zignoruj"};var AG={};AG={dismiss:"Descartar"};var PG={};PG={dismiss:"Dispensar"};var CG={};CG={dismiss:"Revocare"};var LG={};LG={dismiss:""};var IG={};IG={dismiss:"Zrui"};var RG={};RG={dismiss:"Opusti"};var MG={};MG={dismiss:"Odbaci"};var $G={};$G={dismiss:"Avvisa"};var kG={};kG={dismiss:"Kapat"};var OG={};OG={dismiss:""};var DG={};DG={dismiss:""};var FG={};FG={dismiss:""};rG={"ar-AE":iG,"bg-BG":sG,"cs-CZ":oG,"da-DK":aG,"de-DE":lG,"el-GR":cG,"en-US":uG,"es-ES":dG,"et-EE":hG,"fi-FI":fG,"fr-FR":pG,"he-IL":mG,"hr-HR":gG,"hu-HU":yG,"it-IT":vG,"ja-JP":_G,"ko-KR":bG,"lt-LT":xG,"lv-LV":wG,"nb-NO":TG,"nl-NL":EG,"pl-PL":SG,"pt-BR":AG,"pt-PT":PG,"ro-RO":CG,"ru-RU":LG,"sk-SK":IG,"sl-SI":RG,"sr-SP":MG,"sv-SE":$G,"tr-TR":kG,"uk-UA":OG,"zh-CN":DG,"zh-TW":FG};function hp(t){let{onDismiss:e,...n}=t,r=dc(xTe(rG)),i=Kb(n,r.format("dismiss")),s=()=>{e&&e()};return le.createElement(bTe,null,le.createElement("button",{...i,tabIndex:-1,onClick:s}))}let Jm=new WeakMap,jo=[];function z$(t,e=document.body){let n=new Set(t),r=new Set,i=h=>{for(let w of h.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))n.add(w);let p=w=>{if(n.has(w)||r.has(w.parentElement)&&w.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let A of n)if(w.contains(A))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},b=document.createTreeWalker(h,NodeFilter.SHOW_ELEMENT,{acceptNode:p}),x=p(h);if(x===NodeFilter.FILTER_ACCEPT&&s(h),x!==NodeFilter.FILTER_REJECT){let w=b.nextNode();for(;w!=null;)s(w),w=b.nextNode()}},s=h=>{var p;let b=(p=Jm.get(h))!==null&&p!==void 0?p:0;h.getAttribute("aria-hidden")==="true"&&b===0||(b===0&&h.setAttribute("aria-hidden","true"),r.add(h),Jm.set(h,b+1))};jo.length&&jo[jo.length-1].disconnect(),i(e);let l=new MutationObserver(h=>{for(let p of h)if(!(p.type!=="childList"||p.addedNodes.length===0)&&![...n,...r].some(b=>b.contains(p.target))){for(let b of p.removedNodes)b instanceof Element&&(n.delete(b),r.delete(b));for(let b of p.addedNodes)(b instanceof HTMLElement||b instanceof SVGElement)&&(b.dataset.liveAnnouncer==="true"||b.dataset.reactAriaTopLayer==="true")?n.add(b):b instanceof Element&&i(b)}});l.observe(e,{childList:!0,subtree:!0});let o={observe(){l.observe(e,{childList:!0,subtree:!0})},disconnect(){l.disconnect()}};return jo.push(o),()=>{l.disconnect();for(let h of r){let p=Jm.get(h);p===1?(h.removeAttribute("aria-hidden"),Jm.delete(h)):Jm.set(h,p-1)}o===jo[jo.length-1]?(jo.pop(),jo.length&&jo[jo.length-1].observe()):jo.splice(jo.indexOf(o),1)}}function BTe(t,e){let{triggerRef:n,popoverRef:r,isNonModal:i,isKeyboardDismissDisabled:s,...l}=t,{overlayProps:o,underlayProps:h}=eG({isOpen:e.isOpen,onClose:e.close,shouldCloseOnBlur:!0,isDismissable:!i,isKeyboardDismissDisabled:s},r),{overlayProps:p,arrowProps:b,placement:x}=MTe({...l,targetRef:n,overlayRef:r,isOpen:e.isOpen,onClose:null});return nG({isDisabled:i}),Ar(()=>{if(e.isOpen&&!i&&r.current)return z$([r.current])},[i,e.isOpen,r]),{popoverProps:Vn(o,p),arrowProps:b,underlayProps:h,placement:x}}const NG=le.createContext(null);function UTe(t){let e=Sp(),{portalContainer:n=e?null:document.body}=t,[r,i]=te.useState(!1),s=te.useMemo(()=>({contain:r,setContain:i}),[r,i]);if(!n)return null;let l=le.createElement(NG.Provider,{value:s},le.createElement(D$,{restoreFocus:!0,contain:r},t.children));return vd.createPortal(l,n)}function zG(){let t=te.useContext(NG),e=t==null?void 0:t.setContain;Ar(()=>{e==null||e(!0)},[e])}function VTe(t,e,n){let{overlayProps:r,underlayProps:i}=eG({...t,isOpen:e.isOpen,onClose:e.close},n);return nG({isDisabled:!e.isOpen}),zG(),te.useEffect(()=>{if(e.isOpen)return z$([n.current])},[e.isOpen,n]),{modalProps:Vn(r),underlayProps:i}}function QF(t){return t&&t.__esModule?t.default:t}function xx(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}const B$=le.createContext(null);B$.displayName="ProviderContext";var BG={};xx(BG,"spectrum",()=>h3,t=>h3=t);var h3;h3="spectrum_b37d53";var wx={};xx(wx,"spectrum",()=>f3,t=>f3=t);xx(wx,"spectrum-Body",()=>p3,t=>p3=t);xx(wx,"spectrum-Body--italic",()=>m3,t=>m3=t);var f3,p3,m3;f3="spectrum_2a241c";p3="spectrum-Body_2a241c";m3="spectrum-Body--italic_2a241c";function jTe(t,e){let n=n3("(prefers-color-scheme: dark)"),r=n3("(prefers-color-scheme: light)");return t.dark&&n?"dark":t.light&&r?"light":t.dark&&e==="dark"?"dark":t.light&&e==="light"||!t.dark||t.light?"light":"dark"}function GTe(t){return n3("(any-pointer: fine)")&&t.medium?"medium":t.large?"large":"medium"}var UG={};UG=JSON.parse('{"name":"@react-spectrum/provider","version":"3.7.1","description":"Spectrum UI components in React","license":"Apache-2.0","main":"dist/main.js","module":"dist/module.js","exports":{"types":"./dist/types.d.ts","import":"./dist/import.mjs","require":"./dist/main.js"},"types":"dist/types.d.ts","source":"src/index.ts","files":["dist","src"],"sideEffects":["*.css"],"targets":{"main":{"includeNodeModules":["@adobe/spectrum-css-temp"]},"module":{"includeNodeModules":["@adobe/spectrum-css-temp"]}},"repository":{"type":"git","url":"https://github.com/adobe/react-spectrum"},"dependencies":{"@react-aria/i18n":"^3.7.1","@react-aria/overlays":"^3.14.0","@react-aria/utils":"^3.16.0","@react-spectrum/utils":"^3.9.1","@react-types/provider":"^3.6.1","@react-types/shared":"^3.18.0","@swc/helpers":"^0.4.14","clsx":"^1.1.1"},"devDependencies":{"@adobe/spectrum-css-temp":"3.0.0-alpha.1"},"peerDependencies":{"react":"^16.8.0 || ^17.0.0-rc.1 || ^18.0.0","react-dom":"^16.8.0 || ^17.0.0-rc.1 || ^18.0.0"},"publishConfig":{"access":"public"}}');const WTe={S:640,M:768,L:1024,XL:1280,XXL:1536};function HTe(t,e){let n=rh(),r=n&&n.colorScheme,i=n&&n.breakpoints,{theme:s=n&&n.theme,defaultColorScheme:l}=t;if(!s)throw new Error("theme not found, the parent provider must have a theme provided");let o=jTe(s,l),h=GTe(s),{locale:p}=Ra(),b=!!s[r],{colorScheme:x=b?r:o,scale:w=n?n.scale:h,locale:A=n?p:null,breakpoints:L=n?i:WTe,children:M,isQuiet:U,isEmphasized:D,isDisabled:$,isRequired:N,isReadOnly:B,validationState:Z,...ie}=t,re={version:UG.version,theme:s,breakpoints:L,colorScheme:x,scale:w,isQuiet:U,isEmphasized:D,isDisabled:$,isRequired:N,isReadOnly:B,validationState:Z},ve=C2e(L),Te={};Object.entries(re).forEach(([ke,Vt])=>Vt!==void 0&&(Te[ke]=Vt));let Ae=Object.assign({},n,Te),fe=M,Pe=Hi(ie),{styleProps:_e}=mi(ie,void 0,{matchedBreakpoints:ve});return(!n||t.locale||s!==n.theme||x!==n.colorScheme||w!==n.scale||Object.keys(Pe).length>0||ie.UNSAFE_className||Object.keys(_e.style).length>0)&&(fe=le.createElement(qTe,{...t,UNSAFE_style:{isolation:n?void 0:"isolate",..._e.style},ref:e},fe)),le.createElement(B$.Provider,{value:Ae},le.createElement(E2e,{locale:A},le.createElement(P2e,{matchedBreakpoints:ve},le.createElement(NTe,null,fe))))}let VG=le.forwardRef(HTe);const qTe=le.forwardRef(function(e,n){let{children:r,...i}=e,{locale:s,direction:l}=Ra(),{theme:o,colorScheme:h,scale:p}=rh(),{modalProviderProps:b}=zTe(),{styleProps:x}=mi(i),w=io(n),A=Object.keys(o[h])[0],L=Object.keys(o[p])[0],M=px(x.className,QF(BG).spectrum,QF(wx).spectrum,Object.values(o[h]),Object.values(o[p]),o.global?Object.values(o.global):null,{"react-spectrum-provider":n_,spectrum:n_,[A]:n_,[L]:n_});var U,D;let $={...x.style,colorScheme:(D=(U=e.colorScheme)!==null&&U!==void 0?U:h)!==null&&D!==void 0?D:Object.keys(o).filter(B=>B==="light"||B==="dark").join(" ")},N=te.useRef(!1);return te.useEffect(()=>{if(l&&w.current){let B=w.current.parentElement.closest("[dir]"),Z=B&&B.getAttribute("dir");Z&&Z!==l&&!N.current&&(console.warn(`Language directions cannot be nested. ${l} inside ${Z}.`),N.current=!0)}},[l,w,N]),le.createElement("div",{...Hi(i),...x,...b,className:M,style:$,lang:s,dir:l,ref:w},r)});function rh(){return te.useContext(B$)}function Tx(t){let e=rh();return e?Object.assign({},{isQuiet:e.isQuiet,isEmphasized:e.isEmphasized,isDisabled:e.isDisabled,isRequired:e.isRequired,isReadOnly:e.isReadOnly,validationState:e.validationState},t):t}var jG={};Object.defineProperty(jG,"__esModule",{value:!0});var KTe=jG.CornerTriangle=GG,RT=XTe(te);function XTe(t){return t&&t.__esModule?t:{default:t}}function g3(){return g3=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},g3.apply(this,arguments)}function ZTe(t,e){if(t==null)return{};var n=YTe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function YTe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function GG(t){var e=t.scale,n=e===void 0?"M":e,r=ZTe(t,["scale"]);return RT.default.createElement("svg",g3({},r,r),n==="L"&&RT.default.createElement("path",{d:"M5.74.01a.25.25 0 0 0-.177.073l-5.48 5.48a.25.25 0 0 0 .177.427h5.48a.25.25 0 0 0 .25-.25V.26a.25.25 0 0 0-.25-.25z"}),n==="M"&&RT.default.createElement("path",{d:"M4.74.01a.25.25 0 0 0-.177.073l-4.48 4.48a.25.25 0 0 0 .177.427h4.48a.25.25 0 0 0 .25-.25V.26a.25.25 0 0 0-.25-.25z"}))}GG.displayName="CornerTriangle";function JTe(t){return t&&t.__esModule?t.default:t}function cn(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var an={};cn(an,"spectrum-Icon",()=>y3,t=>y3=t);cn(an,"spectrum-UIIcon",()=>v3,t=>v3=t);cn(an,"spectrum-Icon--sizeXXS",()=>_3,t=>_3=t);cn(an,"spectrum-Icon--sizeXS",()=>b3,t=>b3=t);cn(an,"spectrum-Icon--sizeS",()=>x3,t=>x3=t);cn(an,"spectrum-Icon--sizeM",()=>w3,t=>w3=t);cn(an,"spectrum-Icon--sizeL",()=>T3,t=>T3=t);cn(an,"spectrum-Icon--sizeXL",()=>E3,t=>E3=t);cn(an,"spectrum-Icon--sizeXXL",()=>S3,t=>S3=t);cn(an,"spectrum--medium",()=>A3,t=>A3=t);cn(an,"spectrum-UIIcon--large",()=>P3,t=>P3=t);cn(an,"spectrum-UIIcon--medium",()=>C3,t=>C3=t);cn(an,"spectrum--large",()=>L3,t=>L3=t);cn(an,"spectrum-UIIcon-AlertMedium",()=>I3,t=>I3=t);cn(an,"spectrum-UIIcon-AlertSmall",()=>R3,t=>R3=t);cn(an,"spectrum-UIIcon-ArrowDownSmall",()=>M3,t=>M3=t);cn(an,"spectrum-UIIcon-ArrowLeftMedium",()=>$3,t=>$3=t);cn(an,"spectrum-UIIcon-Asterisk",()=>k3,t=>k3=t);cn(an,"spectrum-UIIcon-CheckmarkMedium",()=>O3,t=>O3=t);cn(an,"spectrum-UIIcon-CheckmarkSmall",()=>D3,t=>D3=t);cn(an,"spectrum-UIIcon-ChevronDownMedium",()=>F3,t=>F3=t);cn(an,"spectrum-UIIcon-ChevronDownSmall",()=>N3,t=>N3=t);cn(an,"spectrum-UIIcon-ChevronLeftLarge",()=>z3,t=>z3=t);cn(an,"spectrum-UIIcon-ChevronLeftMedium",()=>B3,t=>B3=t);cn(an,"spectrum-UIIcon-ChevronRightLarge",()=>U3,t=>U3=t);cn(an,"spectrum-UIIcon-ChevronRightMedium",()=>V3,t=>V3=t);cn(an,"spectrum-UIIcon-ChevronRightSmall",()=>j3,t=>j3=t);cn(an,"spectrum-UIIcon-ChevronUpSmall",()=>G3,t=>G3=t);cn(an,"spectrum-UIIcon-CornerTriangle",()=>W3,t=>W3=t);cn(an,"spectrum-UIIcon-CrossLarge",()=>H3,t=>H3=t);cn(an,"spectrum-UIIcon-CrossMedium",()=>q3,t=>q3=t);cn(an,"spectrum-UIIcon-CrossSmall",()=>K3,t=>K3=t);cn(an,"spectrum-UIIcon-DashSmall",()=>X3,t=>X3=t);cn(an,"spectrum-UIIcon-DoubleGripper",()=>Z3,t=>Z3=t);cn(an,"spectrum-UIIcon-FolderBreadcrumb",()=>Y3,t=>Y3=t);cn(an,"spectrum-UIIcon-HelpMedium",()=>J3,t=>J3=t);cn(an,"spectrum-UIIcon-HelpSmall",()=>Q3,t=>Q3=t);cn(an,"spectrum-UIIcon-InfoMedium",()=>eA,t=>eA=t);cn(an,"spectrum-UIIcon-InfoSmall",()=>tA,t=>tA=t);cn(an,"spectrum-UIIcon-ListGripper",()=>nA,t=>nA=t);cn(an,"spectrum-UIIcon-Magnifier",()=>rA,t=>rA=t);cn(an,"spectrum-UIIcon-SkipLeft",()=>iA,t=>iA=t);cn(an,"spectrum-UIIcon-SkipRight",()=>sA,t=>sA=t);cn(an,"spectrum-UIIcon-Star",()=>oA,t=>oA=t);cn(an,"spectrum-UIIcon-StarOutline",()=>aA,t=>aA=t);cn(an,"spectrum-UIIcon-SuccessMedium",()=>lA,t=>lA=t);cn(an,"spectrum-UIIcon-SuccessSmall",()=>cA,t=>cA=t);cn(an,"spectrum-UIIcon-TripleGripper",()=>uA,t=>uA=t);var y3,v3,_3,b3,x3,w3,T3,E3,S3,A3,P3,C3,L3,I3,R3,M3,$3,k3,O3,D3,F3,N3,z3,B3,U3,V3,j3,G3,W3,H3,q3,K3,X3,Z3,Y3,J3,Q3,eA,tA,nA,rA,iA,sA,oA,aA,lA,cA,uA;y3="spectrum-Icon_368b34";v3="spectrum-UIIcon_368b34";_3="spectrum-Icon--sizeXXS_368b34";b3="spectrum-Icon--sizeXS_368b34";x3="spectrum-Icon--sizeS_368b34";w3="spectrum-Icon--sizeM_368b34";T3="spectrum-Icon--sizeL_368b34";E3="spectrum-Icon--sizeXL_368b34";S3="spectrum-Icon--sizeXXL_368b34";A3="spectrum--medium_368b34";P3="spectrum-UIIcon--large_368b34";C3="spectrum-UIIcon--medium_368b34";L3="spectrum--large_368b34";I3="spectrum-UIIcon-AlertMedium_368b34";R3="spectrum-UIIcon-AlertSmall_368b34";M3="spectrum-UIIcon-ArrowDownSmall_368b34";$3="spectrum-UIIcon-ArrowLeftMedium_368b34";k3="spectrum-UIIcon-Asterisk_368b34";O3="spectrum-UIIcon-CheckmarkMedium_368b34";D3="spectrum-UIIcon-CheckmarkSmall_368b34";F3="spectrum-UIIcon-ChevronDownMedium_368b34";N3="spectrum-UIIcon-ChevronDownSmall_368b34";z3="spectrum-UIIcon-ChevronLeftLarge_368b34";B3="spectrum-UIIcon-ChevronLeftMedium_368b34";U3="spectrum-UIIcon-ChevronRightLarge_368b34";V3="spectrum-UIIcon-ChevronRightMedium_368b34";j3="spectrum-UIIcon-ChevronRightSmall_368b34";G3="spectrum-UIIcon-ChevronUpSmall_368b34";W3="spectrum-UIIcon-CornerTriangle_368b34";H3="spectrum-UIIcon-CrossLarge_368b34";q3="spectrum-UIIcon-CrossMedium_368b34";K3="spectrum-UIIcon-CrossSmall_368b34";X3="spectrum-UIIcon-DashSmall_368b34";Z3="spectrum-UIIcon-DoubleGripper_368b34";Y3="spectrum-UIIcon-FolderBreadcrumb_368b34";J3="spectrum-UIIcon-HelpMedium_368b34";Q3="spectrum-UIIcon-HelpSmall_368b34";eA="spectrum-UIIcon-InfoMedium_368b34";tA="spectrum-UIIcon-InfoSmall_368b34";nA="spectrum-UIIcon-ListGripper_368b34";rA="spectrum-UIIcon-Magnifier_368b34";iA="spectrum-UIIcon-SkipLeft_368b34";sA="spectrum-UIIcon-SkipRight_368b34";oA="spectrum-UIIcon-Star_368b34";aA="spectrum-UIIcon-StarOutline_368b34";lA="spectrum-UIIcon-SuccessMedium_368b34";cA="spectrum-UIIcon-SuccessSmall_368b34";uA="spectrum-UIIcon-TripleGripper_368b34";function QTe(t){return`var(--spectrum-semantic-${t}-color-icon)`}({...gx});function Pp(t){t=Su(t,"icon");let{children:e,"aria-label":n,"aria-hidden":r,...i}=t,{styleProps:s}=mi(i),l=rh(),o="M";return l!==null&&(o=l.scale==="large"?"L":"M"),r||(r=void 0),le.cloneElement(e,{...Hi(i),...s,scale:o,focusable:"false","aria-label":n,"aria-hidden":n?r||void 0:!0,role:"img",className:ct(JTe(an),e.props.className,"spectrum-Icon",{[`spectrum-UIIcon-${e.type.displayName}`]:e.type.displayName},s.className)})}function eEe(t){return le.createElement(Pp,t,le.createElement(KTe,null))}var WG={};Object.defineProperty(WG,"__esModule",{value:!0});var tEe=WG.CrossSmall=HG,MT=nEe(te);function nEe(t){return t&&t.__esModule?t:{default:t}}function dA(){return dA=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dA.apply(this,arguments)}function rEe(t,e){if(t==null)return{};var n=iEe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function iEe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function HG(t){var e=t.scale,n=e===void 0?"M":e,r=rEe(t,["scale"]);return MT.default.createElement("svg",dA({},r,r),n==="L"&&MT.default.createElement("path",{d:"M9.317 8.433L5.884 5l3.433-3.433a.625.625 0 1 0-.884-.884L5 4.116 1.567.683a.625.625 0 1 0-.884.884C.83 1.713 2.77 3.657 4.116 5L.683 8.433a.625.625 0 1 0 .884.884L5 5.884l3.433 3.433a.625.625 0 0 0 .884-.884z"}),n==="M"&&MT.default.createElement("path",{d:"M7.317 6.433L4.884 4l2.433-2.433a.625.625 0 1 0-.884-.884L4 3.116 1.567.683a.625.625 0 1 0-.884.884L3.116 4 .683 6.433a.625.625 0 1 0 .884.884L4 4.884l2.433 2.433a.625.625 0 0 0 .884-.884z"}))}HG.displayName="CrossSmall";function sEe(t){return le.createElement(Pp,t,le.createElement(tEe,null))}function _a(t){return t&&t.__esModule?t.default:t}function or(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var Cn={};or(Cn,"spectrum-Button",()=>hA,t=>hA=t);or(Cn,"spectrum-ActionButton",()=>fA,t=>fA=t);or(Cn,"spectrum-LogicButton",()=>pA,t=>pA=t);or(Cn,"spectrum-FieldButton",()=>mA,t=>mA=t);or(Cn,"spectrum-ClearButton",()=>gA,t=>gA=t);or(Cn,"focus-ring",()=>yA,t=>yA=t);or(Cn,"spectrum-FieldButton--quiet",()=>vA,t=>vA=t);or(Cn,"spectrum-Icon",()=>_A,t=>_A=t);or(Cn,"is-hovered",()=>bA,t=>bA=t);or(Cn,"spectrum-Button-label",()=>xA,t=>xA=t);or(Cn,"spectrum-Button--iconOnly",()=>wA,t=>wA=t);or(Cn,"spectrum-ActionButton-label",()=>TA,t=>TA=t);or(Cn,"spectrum-ActionButton-hold",()=>EA,t=>EA=t);or(Cn,"spectrum-ActionButton--quiet",()=>SA,t=>SA=t);or(Cn,"is-disabled",()=>AA,t=>AA=t);or(Cn,"is-open",()=>PA,t=>PA=t);or(Cn,"spectrum-ClearButton--small",()=>CA,t=>CA=t);or(Cn,"is-active",()=>LA,t=>LA=t);or(Cn,"spectrum-ClearButton--overBackground",()=>IA,t=>IA=t);or(Cn,"is-selected",()=>RA,t=>RA=t);or(Cn,"spectrum-ActionButton--emphasized",()=>MA,t=>MA=t);or(Cn,"spectrum-ActionButton--staticWhite",()=>$A,t=>$A=t);or(Cn,"spectrum-ActionButton--staticBlack",()=>kA,t=>kA=t);or(Cn,"spectrum-ActionButton--staticColor",()=>OA,t=>OA=t);or(Cn,"spectrum-LogicButton--and",()=>DA,t=>DA=t);or(Cn,"spectrum-LogicButton--or",()=>FA,t=>FA=t);or(Cn,"is-focused",()=>NA,t=>NA=t);or(Cn,"is-placeholder",()=>zA,t=>zA=t);or(Cn,"spectrum-FieldButton--invalid",()=>BA,t=>BA=t);or(Cn,"spectrum-Button--overBackground",()=>UA,t=>UA=t);var hA,fA,pA,mA,gA,yA,vA,_A,bA,xA,wA,TA,EA,SA,AA,PA,CA,LA,IA,RA,MA,$A,kA,OA,DA,FA,NA,zA,BA,UA;hA="spectrum-Button_e2d99e";fA="spectrum-ActionButton_e2d99e";pA="spectrum-LogicButton_e2d99e";mA="spectrum-FieldButton_e2d99e";gA="spectrum-ClearButton_e2d99e";yA="focus-ring_e2d99e";vA="spectrum-FieldButton--quiet_e2d99e";_A="spectrum-Icon_e2d99e";bA="is-hovered_e2d99e";xA="spectrum-Button-label_e2d99e";wA="spectrum-Button--iconOnly_e2d99e";TA="spectrum-ActionButton-label_e2d99e";EA="spectrum-ActionButton-hold_e2d99e";SA="spectrum-ActionButton--quiet_e2d99e";AA="is-disabled_e2d99e";PA="is-open_e2d99e";CA="spectrum-ClearButton--small_e2d99e";LA="is-active_e2d99e";IA="spectrum-ClearButton--overBackground_e2d99e";RA="is-selected_e2d99e";MA="spectrum-ActionButton--emphasized_e2d99e";$A="spectrum-ActionButton--staticWhite_e2d99e";kA="spectrum-ActionButton--staticBlack_e2d99e";OA="spectrum-ActionButton--staticColor_e2d99e";DA="spectrum-LogicButton--and_e2d99e";FA="spectrum-LogicButton--or_e2d99e";NA="is-focused_e2d99e";zA="is-placeholder_e2d99e";BA="spectrum-FieldButton--invalid_e2d99e";UA="spectrum-Button--overBackground_e2d99e";function oEe(t,e){t=Tx(t),t=Su(t,"actionButton");let{isQuiet:n,isDisabled:r,staticColor:i,children:s,autoFocus:l,holdAffordance:o,...h}=t,p=s0(e),{buttonProps:b,isPressed:x}=bx(t,p),{hoverProps:w,isHovered:A}=Au({isDisabled:r}),{styleProps:L}=mi(h),M=le.Children.toArray(t.children).every(U=>!le.isValidElement(U));return le.createElement(Ap,{focusRingClass:ct(_a(Cn),"focus-ring"),autoFocus:l},le.createElement("button",{...L,...Vn(b,w),ref:p,className:ct(_a(Cn),"spectrum-ActionButton",{"spectrum-ActionButton--quiet":n,"spectrum-ActionButton--staticColor":!!i,"spectrum-ActionButton--staticWhite":i==="white","spectrum-ActionButton--staticBlack":i==="black","is-active":x,"is-disabled":r,"is-hovered":A},L.className)},o&&le.createElement(eEe,{UNSAFE_className:ct(_a(Cn),"spectrum-ActionButton-hold")}),le.createElement(yx,{slots:{icon:{size:"S",UNSAFE_className:ct(_a(Cn),"spectrum-Icon")},text:{UNSAFE_className:ct(_a(Cn),"spectrum-ActionButton-label")}}},typeof s=="string"||M?le.createElement(wa,null,s):s)))}let aEe=le.forwardRef(oEe);function lEe(t,e){t=Su(t,"button");let{isQuiet:n,isDisabled:r,validationState:i,children:s,autoFocus:l,isActive:o,focusRingClass:h,...p}=t,b=s0(e),{buttonProps:x,isPressed:w}=bx(t,b),{hoverProps:A,isHovered:L}=Au({isDisabled:r}),{styleProps:M}=mi(p);return le.createElement(Ap,{focusRingClass:ct(_a(Cn),"focus-ring",h),autoFocus:l},le.createElement("button",{...Vn(x,A),ref:b,className:ct(_a(Cn),"spectrum-FieldButton",{"spectrum-FieldButton--quiet":n,"is-active":o||w,"is-disabled":r,"spectrum-FieldButton--invalid":i==="invalid","is-hovered":L},M.className)},le.createElement(yx,{slots:{icon:{size:"S",UNSAFE_className:ct(_a(Cn),"spectrum-Icon")}}},s)))}let cEe=le.forwardRef(lEe);function uEe(t,e){let{children:n=le.createElement(sEe,{UNSAFE_className:_a(Cn)["spectrum-Icon"]}),focusClassName:r,variant:i,autoFocus:s,isDisabled:l,preventFocus:o,elementType:h=o?"div":"button",...p}=t,b=s0(e),{buttonProps:x,isPressed:w}=bx({...t,elementType:h},b),{hoverProps:A,isHovered:L}=Au({isDisabled:l}),{styleProps:M}=mi(p);o&&delete x.tabIndex;let U=h;return le.createElement(Ap,{focusRingClass:ct(_a(Cn),"focus-ring",r),autoFocus:s},le.createElement(U,{...M,...Vn(x,A),ref:b,className:ct(_a(Cn),"spectrum-ClearButton",{[`spectrum-ClearButton--${i}`]:i,"is-disabled":l,"is-active":w,"is-hovered":L},M.className)},n))}let dEe=le.forwardRef(uEe);var qG={};Object.defineProperty(qG,"__esModule",{value:!0});var hEe=qG.ChevronDownMedium=KG,$T=fEe(te);function fEe(t){return t&&t.__esModule?t:{default:t}}function VA(){return VA=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},VA.apply(this,arguments)}function pEe(t,e){if(t==null)return{};var n=mEe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function mEe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function KG(t){var e=t.scale,n=e===void 0?"M":e,r=pEe(t,["scale"]);return $T.default.createElement("svg",VA({},r,r),n==="L"&&$T.default.createElement("path",{d:"M11.99 1.51a1 1 0 0 0-1.707-.707L6 5.086 1.717.803A1 1 0 1 0 .303 2.217l4.99 4.99a1 1 0 0 0 1.414 0l4.99-4.99a.997.997 0 0 0 .293-.707z"}),n==="M"&&$T.default.createElement("path",{d:"M9.99 1.01A1 1 0 0 0 8.283.303L5 3.586 1.717.303A1 1 0 1 0 .303 1.717l3.99 3.98a1 1 0 0 0 1.414 0l3.99-3.98a.997.997 0 0 0 .293-.707z"}))}KG.displayName="ChevronDownMedium";function XG(t){return le.createElement(Pp,t,le.createElement(hEe,null))}function jA(){return jA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jA.apply(this,arguments)}function gEe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function GA(t,e){return GA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},GA(t,e)}function yEe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,GA(t,e)}const eN={disabled:!1},ZG=le.createContext(null);var vEe=function(e){return e.scrollTop},_g="unmounted",dd="exited",hd="entering",ef="entered",WA="exiting",hc=function(t){yEe(e,t);function e(r,i){var s;s=t.call(this,r,i)||this;var l=i,o=l&&!l.isMounting?r.enter:r.appear,h;return s.appearStatus=null,r.in?o?(h=dd,s.appearStatus=hd):h=ef:r.unmountOnExit||r.mountOnEnter?h=_g:h=dd,s.state={status:h},s.nextCallback=null,s}e.getDerivedStateFromProps=function(i,s){var l=i.in;return l&&s.status===_g?{status:dd}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(i){var s=null;if(i!==this.props){var l=this.state.status;this.props.in?l!==hd&&l!==ef&&(s=hd):(l===hd||l===ef)&&(s=WA)}this.updateStatus(!1,s)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var i=this.props.timeout,s,l,o;return s=l=o=i,i!=null&&typeof i!="number"&&(s=i.exit,l=i.enter,o=i.appear!==void 0?i.appear:l),{exit:s,enter:l,appear:o}},n.updateStatus=function(i,s){if(i===void 0&&(i=!1),s!==null)if(this.cancelNextCallback(),s===hd){if(this.props.unmountOnExit||this.props.mountOnEnter){var l=this.props.nodeRef?this.props.nodeRef.current:vd.findDOMNode(this);l&&vEe(l)}this.performEnter(i)}else this.performExit();else this.props.unmountOnExit&&this.state.status===dd&&this.setState({status:_g})},n.performEnter=function(i){var s=this,l=this.props.enter,o=this.context?this.context.isMounting:i,h=this.props.nodeRef?[o]:[vd.findDOMNode(this),o],p=h[0],b=h[1],x=this.getTimeouts(),w=o?x.appear:x.enter;if(!i&&!l||eN.disabled){this.safeSetState({status:ef},function(){s.props.onEntered(p)});return}this.props.onEnter(p,b),this.safeSetState({status:hd},function(){s.props.onEntering(p,b),s.onTransitionEnd(w,function(){s.safeSetState({status:ef},function(){s.props.onEntered(p,b)})})})},n.performExit=function(){var i=this,s=this.props.exit,l=this.getTimeouts(),o=this.props.nodeRef?void 0:vd.findDOMNode(this);if(!s||eN.disabled){this.safeSetState({status:dd},function(){i.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:WA},function(){i.props.onExiting(o),i.onTransitionEnd(l.exit,function(){i.safeSetState({status:dd},function(){i.props.onExited(o)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(i,s){s=this.setNextCallback(s),this.setState(i,s)},n.setNextCallback=function(i){var s=this,l=!0;return this.nextCallback=function(o){l&&(l=!1,s.nextCallback=null,i(o))},this.nextCallback.cancel=function(){l=!1},this.nextCallback},n.onTransitionEnd=function(i,s){this.setNextCallback(s);var l=this.props.nodeRef?this.props.nodeRef.current:vd.findDOMNode(this),o=i==null&&!this.props.addEndListener;if(!l||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var h=this.props.nodeRef?[this.nextCallback]:[l,this.nextCallback],p=h[0],b=h[1];this.props.addEndListener(p,b)}i!=null&&setTimeout(this.nextCallback,i)},n.render=function(){var i=this.state.status;if(i===_g)return null;var s=this.props,l=s.children;s.in,s.mountOnEnter,s.unmountOnExit,s.appear,s.enter,s.exit,s.timeout,s.addEndListener,s.onEnter,s.onEntering,s.onEntered,s.onExit,s.onExiting,s.onExited,s.nodeRef;var o=gEe(s,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return le.createElement(ZG.Provider,{value:null},typeof l=="function"?l(i,o):le.cloneElement(le.Children.only(l),o))},e}(le.Component);hc.contextType=ZG;hc.propTypes={};function Kh(){}hc.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Kh,onEntering:Kh,onEntered:Kh,onExit:Kh,onExiting:Kh,onExited:Kh};hc.UNMOUNTED=_g;hc.EXITED=dd;hc.ENTERING=hd;hc.ENTERED=ef;hc.EXITING=WA;const _Ee=hc;function hu(t){return t&&t.__esModule?t.default:t}function er(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}const bEe={entering:!1,entered:!0};function xEe(t){return le.createElement(_Ee,{timeout:{enter:0,exit:350},...t},e=>le.Children.map(t.children,n=>n&&le.cloneElement(n,{isOpen:!!bEe[e]})))}function wEe(t,e){let{children:n,isOpen:r,container:i,onEnter:s,onEntering:l,onEntered:o,onExit:h,onExiting:p,onExited:b,nodeRef:x}=t,[w,A]=te.useState(!r),L=te.useCallback(()=>{A(!1),o&&o()},[o]),M=te.useCallback(()=>{A(!0),b&&b()},[b]);return r||!w?le.createElement(UTe,{portalContainer:i},le.createElement(VG,{ref:e,UNSAFE_style:{background:"transparent",isolation:"isolate"},isDisabled:!1},le.createElement(xEe,{in:r,appear:!0,onExit:h,onExiting:p,onExited:M,onEnter:s,onEntering:l,onEntered:L,nodeRef:x},n))):null}let YG=le.forwardRef(wEe);var Ma={};er(Ma,"spectrum-Popover",()=>HA,t=>HA=t);er(Ma,"react-spectrum-Popover",()=>qA,t=>qA=t);er(Ma,"spectrum-Dialog-content",()=>KA,t=>KA=t);er(Ma,"spectrum-Modal-wrapper",()=>XA,t=>XA=t);er(Ma,"react-spectrum-Modal-wrapper",()=>ZA,t=>ZA=t);er(Ma,"spectrum-Modal",()=>YA,t=>YA=t);er(Ma,"react-spectrum-Modal",()=>JA,t=>JA=t);er(Ma,"spectrum-Tray",()=>QA,t=>QA=t);er(Ma,"react-spectrum-Tray",()=>eP,t=>eP=t);var HA,qA,KA,XA,ZA,YA,JA,QA,eP;HA="spectrum-Popover_38efea";qA="react-spectrum-Popover_38efea";KA="spectrum-Dialog-content_38efea";XA="spectrum-Modal-wrapper_38efea";ZA="react-spectrum-Modal-wrapper_38efea";YA="spectrum-Modal_38efea";JA="react-spectrum-Modal_38efea";QA="spectrum-Tray_38efea";eP="react-spectrum-Tray_38efea";var Ro={};er(Ro,"spectrum-Popover",()=>tP,t=>tP=t);er(Ro,"is-open",()=>nP,t=>nP=t);er(Ro,"spectrum-Popover--bottom",()=>rP,t=>rP=t);er(Ro,"spectrum-Popover--top",()=>iP,t=>iP=t);er(Ro,"spectrum-Popover--right",()=>sP,t=>sP=t);er(Ro,"spectrum-Popover--left",()=>oP,t=>oP=t);er(Ro,"spectrum-Popover-tip",()=>aP,t=>aP=t);er(Ro,"spectrum-Popover-tip-triangle",()=>lP,t=>lP=t);er(Ro,"spectrum-Popover--dialog",()=>cP,t=>cP=t);er(Ro,"spectrum-Popover--withTip",()=>uP,t=>uP=t);var tP,nP,rP,iP,sP,oP,aP,lP,cP,uP;tP="spectrum-Popover_6115b8";nP="is-open_6115b8";rP="spectrum-Popover--bottom_6115b8";iP="spectrum-Popover--top_6115b8";sP="spectrum-Popover--right_6115b8";oP="spectrum-Popover--left_6115b8";aP="spectrum-Popover-tip_6115b8";lP="spectrum-Popover-tip-triangle_6115b8";cP="spectrum-Popover--dialog_6115b8";uP="spectrum-Popover--withTip_6115b8";var Ex={};er(Ex,"spectrum-Underlay",()=>dP,t=>dP=t);er(Ex,"is-open",()=>hP,t=>hP=t);er(Ex,"spectrum-Underlay--transparent",()=>fP,t=>fP=t);var dP,hP,fP;dP="spectrum-Underlay_eb7615";hP="is-open_eb7615";fP="spectrum-Underlay--transparent_eb7615";function JG({isOpen:t,isTransparent:e}){return le.createElement("div",{className:ct(hu(Ex),"spectrum-Underlay",{"is-open":t,"spectrum-Underlay--transparent":e})})}let TEe={left:"right",right:"right",top:"bottom",bottom:"bottom"};function EEe(t,e){let{children:n,state:r,...i}=t,s=io(e),l=te.useRef(null);return le.createElement(YG,{...i,isOpen:r.isOpen,nodeRef:l},le.createElement(SEe,{ref:s,...t,wrapperRef:l},n))}const SEe=te.forwardRef((t,e)=>{let{children:n,isOpen:r,hideArrow:i,isNonModal:s,state:l,wrapperRef:o}=t,{styleProps:h}=mi(t),{size:p,borderWidth:b,arrowRef:x}=PEe();const w=AEe(e);let A=b*Math.SQRT2,L=p+A,M=L*2,{popoverProps:U,arrowProps:D,underlayProps:$,placement:N}=BTe({...t,popoverRef:e,maxHeight:null,arrowSize:i?0:M,arrowBoundaryOffset:w},l);return le.createElement("div",{ref:o},!s&&le.createElement(JG,{isTransparent:!0,...$,isOpen:r}),le.createElement("div",{...h,...U,style:{...h.style,...U.style},ref:e,className:ct(hu(Ro),"spectrum-Popover",`spectrum-Popover--${N}`,{"spectrum-Popover--withTip":!i,"is-open":r},ct(hu(Ma),"spectrum-Popover","react-spectrum-Popover"),h.className),role:"presentation","data-testid":"popover"},!s&&le.createElement(hp,{onDismiss:l.close}),n,i?null:le.createElement(CEe,{arrowProps:D,isLandscape:TEe[N]==="bottom",arrowRef:x,primary:L,secondary:M,borderDiagonal:A}),le.createElement(hp,{onDismiss:l.close})))});function AEe(t){let[e,n]=te.useState(0);return Ar(()=>{if(t.current){let r=window.getComputedStyle(t.current).borderRadius;r!==""&&n(parseInt(r,10))}},[t]),e}function PEe(){let[t,e]=te.useState(20),[n,r]=te.useState(1),i=te.useRef(null);return Ar(()=>{if(i.current){let s=window.getComputedStyle(i.current).getPropertyValue("--spectrum-popover-tip-size");s!==""&&e(parseInt(s,10)/2);let l=window.getComputedStyle(i.current).getPropertyValue("--spectrum-popover-tip-borderWidth");l!==""&&r(parseInt(l,10))}},[]),{size:t,borderWidth:n,arrowRef:i}}function CEe(t){let{primary:e,secondary:n,isLandscape:r,arrowProps:i,borderDiagonal:s,arrowRef:l}=t,o=s/2,h=0,p=e-o,b=o,x=n/2,w=n-o,A=r?["M",b,h,"L",x,p,"L",w,h]:["M",h,b,"L",p,x,"L",h,w];return le.createElement("svg",{xmlns:"http://www.w3.org/svg/2000",width:Math.ceil(r?n:e),height:Math.ceil(r?e:n),className:ct(hu(Ro),"spectrum-Popover-tip"),ref:l,...i},le.createElement("path",{className:ct(hu(Ro),"spectrum-Popover-tip-triangle"),d:A.join(" ")}))}let LEe=te.forwardRef(EEe);var Cp={};er(Cp,"spectrum-Modal",()=>pP,t=>pP=t);er(Cp,"is-open",()=>mP,t=>mP=t);er(Cp,"spectrum-Modal-wrapper",()=>gP,t=>gP=t);er(Cp,"spectrum-Modal--responsive",()=>yP,t=>yP=t);er(Cp,"spectrum-Modal--fullscreen",()=>vP,t=>vP=t);er(Cp,"spectrum-Modal--fullscreenTakeover",()=>_P,t=>_P=t);var pP,mP,gP,yP,vP,_P;pP="spectrum-Modal_f81956";mP="is-open_f81956";gP="spectrum-Modal-wrapper_f81956";yP="spectrum-Modal--responsive_f81956";vP="spectrum-Modal--fullscreen_f81956";_P="spectrum-Modal--fullscreenTakeover_f81956";var fp={};er(fp,"spectrum-Tray",()=>bP,t=>bP=t);er(fp,"is-open",()=>xP,t=>xP=t);er(fp,"spectrum-Tray-wrapper",()=>wP,t=>wP=t);er(fp,"spectrum-Tray--fixedHeight",()=>TP,t=>TP=t);var bP,xP,wP,TP;bP="spectrum-Tray_23bf66";xP="is-open_23bf66";wP="spectrum-Tray-wrapper_23bf66";TP="spectrum-Tray--fixedHeight_23bf66";function IEe(t,e){let{children:n,state:r,...i}=t,s=io(e),l=te.useRef(null);return le.createElement(YG,{...i,isOpen:r.isOpen,nodeRef:l},le.createElement(REe,{...t,wrapperRef:l,ref:s},n))}let REe=te.forwardRef(function(t,e){let{children:n,isOpen:r,isFixedHeight:i,state:s,wrapperRef:l}=t,{styleProps:o}=mi(t),{modalProps:h,underlayProps:p}=VTe({...t,isDismissable:!0},s,e),x={"--spectrum-visual-viewport-height":s2e().height+"px"},w=ct(hu(fp),"spectrum-Tray-wrapper"),A=ct(hu(fp),"spectrum-Tray",{"is-open":r,"spectrum-Tray--fixedHeight":i},ct(hu(Ma),"spectrum-Tray","react-spectrum-Tray"),o.className);return le.createElement("div",{ref:l},le.createElement(JG,{...p,isOpen:r}),le.createElement("div",{className:w,style:x},le.createElement("div",{...o,...h,className:A,ref:e,"data-testid":"tray"},le.createElement(hp,{onDismiss:s.close}),n,le.createElement(hp,{onDismiss:s.close}))))}),MEe=te.forwardRef(IEe);function QG(t){return X_()?t.altKey:t.ctrlKey}function tf(t){return i0()?t.metaKey:t.ctrlKey}const $Ee=1e3;function kEe(t){let{keyboardDelegate:e,selectionManager:n,onTypeSelect:r}=t,i=te.useRef({search:"",timeout:null}).current,s=l=>{let o=OEe(l.key);if(!o||l.ctrlKey||l.metaKey)return;o===" "&&i.search.trim().length>0&&(l.preventDefault(),"continuePropagation"in l||l.stopPropagation()),i.search+=o;let h=e.getKeyForSearch(i.search,n.focusedKey);h==null&&(h=e.getKeyForSearch(i.search)),h!=null&&(n.setFocusedKey(h),r&&r(h)),clearTimeout(i.timeout),i.timeout=setTimeout(()=>{i.search=""},$Ee)};return{typeSelectProps:{onKeyDownCapture:e.getKeyForSearch?s:null}}}function OEe(t){return t.length===1||!/^[A-Z]/i.test(t)?t:""}function eW(t){let{selectionManager:e,keyboardDelegate:n,ref:r,autoFocus:i=!1,shouldFocusWrap:s=!1,disallowEmptySelection:l=!1,disallowSelectAll:o=!1,selectOnFocus:h=e.selectionBehavior==="replace",disallowTypeAhead:p=!1,shouldUseVirtualFocus:b,allowsTabNavigation:x=!1,isVirtualized:w,scrollRef:A=r}=t,{direction:L}=Ra(),M=re=>{if(re.altKey&&re.key==="Tab"&&re.preventDefault(),!r.current.contains(re.target))return;const ve=(_e,ke)=>{_e!=null&&(e.setFocusedKey(_e,ke),re.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(_e):h&&!QG(re)&&e.replaceSelection(_e))};switch(re.key){case"ArrowDown":if(n.getKeyBelow){var Te,Ae;re.preventDefault();let _e=e.focusedKey!=null?n.getKeyBelow(e.focusedKey):(Te=n.getFirstKey)===null||Te===void 0?void 0:Te.call(n);_e==null&&s&&(_e=(Ae=n.getFirstKey)===null||Ae===void 0?void 0:Ae.call(n,e.focusedKey)),ve(_e)}break;case"ArrowUp":if(n.getKeyAbove){var fe,Pe;re.preventDefault();let _e=e.focusedKey!=null?n.getKeyAbove(e.focusedKey):(fe=n.getLastKey)===null||fe===void 0?void 0:fe.call(n);_e==null&&s&&(_e=(Pe=n.getLastKey)===null||Pe===void 0?void 0:Pe.call(n,e.focusedKey)),ve(_e)}break;case"ArrowLeft":if(n.getKeyLeftOf){re.preventDefault();let _e=n.getKeyLeftOf(e.focusedKey);ve(_e,L==="rtl"?"first":"last")}break;case"ArrowRight":if(n.getKeyRightOf){re.preventDefault();let _e=n.getKeyRightOf(e.focusedKey);ve(_e,L==="rtl"?"last":"first")}break;case"Home":if(n.getFirstKey){re.preventDefault();let _e=n.getFirstKey(e.focusedKey,tf(re));e.setFocusedKey(_e),tf(re)&&re.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(_e):h&&e.replaceSelection(_e)}break;case"End":if(n.getLastKey){re.preventDefault();let _e=n.getLastKey(e.focusedKey,tf(re));e.setFocusedKey(_e),tf(re)&&re.shiftKey&&e.selectionMode==="multiple"?e.extendSelection(_e):h&&e.replaceSelection(_e)}break;case"PageDown":if(n.getKeyPageBelow){re.preventDefault();let _e=n.getKeyPageBelow(e.focusedKey);ve(_e)}break;case"PageUp":if(n.getKeyPageAbove){re.preventDefault();let _e=n.getKeyPageAbove(e.focusedKey);ve(_e)}break;case"a":tf(re)&&e.selectionMode==="multiple"&&o!==!0&&(re.preventDefault(),e.selectAll());break;case"Escape":re.preventDefault(),l||e.clearSelection();break;case"Tab":if(!x){if(re.shiftKey)r.current.focus();else{let _e=Kl(r.current,{tabbable:!0}),ke,Vt;do Vt=_e.lastChild(),Vt&&(ke=Vt);while(Vt);ke&&!ke.contains(document.activeElement)&&Hl(ke)}break}}},U=te.useRef({top:0,left:0});f2e(A,"scroll",w?null:()=>{U.current={top:A.current.scrollTop,left:A.current.scrollLeft}});let D=re=>{if(e.isFocused){re.currentTarget.contains(re.target)||e.setFocused(!1);return}if(re.currentTarget.contains(re.target)){if(e.setFocused(!0),e.focusedKey==null){let Ae=Pe=>{Pe!=null&&(e.setFocusedKey(Pe),h&&e.replaceSelection(Pe))},fe=re.relatedTarget;var ve,Te;fe&&re.currentTarget.compareDocumentPosition(fe)&Node.DOCUMENT_POSITION_FOLLOWING?Ae((ve=e.lastSelectedKey)!==null&&ve!==void 0?ve:n.getLastKey()):Ae((Te=e.firstSelectedKey)!==null&&Te!==void 0?Te:n.getFirstKey())}else w||(A.current.scrollTop=U.current.top,A.current.scrollLeft=U.current.left);if(!w&&e.focusedKey!=null){let Ae=A.current.querySelector(`[data-key="${e.focusedKey}"]`);Ae&&(Hl(Ae),JS(A.current,Ae))}}},$=re=>{re.currentTarget.contains(re.relatedTarget)||e.setFocused(!1)};const N=te.useRef(i);te.useEffect(()=>{if(N.current){let re=null;i==="first"&&(re=n.getFirstKey()),i==="last"&&(re=n.getLastKey());let ve=e.selectedKeys;ve.size&&(re=ve.values().next().value),e.setFocused(!0),e.setFocusedKey(re),re==null&&!b&&Wd(r.current)}N.current=!1},[]),te.useEffect(()=>{let re=Qb();if(!w&&e.isFocused&&e.focusedKey!=null&&(A!=null&&A.current)){let ve=A.current.querySelector(`[data-key="${e.focusedKey}"]`);ve&&(JS(A.current,ve),re==="keyboard"&&$j(ve,{containingElement:r.current}))}},[w,A,e.focusedKey,e.isFocused,r]);let B={onKeyDown:M,onFocus:D,onBlur:$,onMouseDown(re){A.current===re.target&&re.preventDefault()}},{typeSelectProps:Z}=kEe({keyboardDelegate:n,selectionManager:e});p||(B=Vn(Z,B));let ie;return b||(ie=e.focusedKey==null?0:-1),{collectionProps:{...B,tabIndex:ie}}}function DEe(t){let{selectionManager:e,key:n,ref:r,shouldSelectOnPressUp:i,isVirtualized:s,shouldUseVirtualFocus:l,focus:o,isDisabled:h,onAction:p,allowsDifferentPressOrigin:b}=t,x=Pe=>{if(Pe.pointerType==="keyboard"&&QG(Pe))e.toggleSelection(n);else{if(e.selectionMode==="none")return;e.selectionMode==="single"?e.isSelected(n)&&!e.disallowEmptySelection?e.toggleSelection(n):e.replaceSelection(n):Pe&&Pe.shiftKey?e.extendSelection(n):e.selectionBehavior==="toggle"||Pe&&(tf(Pe)||Pe.pointerType==="touch"||Pe.pointerType==="virtual")?e.toggleSelection(n):e.replaceSelection(n)}};te.useEffect(()=>{n===e.focusedKey&&e.isFocused&&!l&&(o?o():document.activeElement!==r.current&&Wd(r.current))},[r,n,e.focusedKey,e.childFocusStrategy,e.isFocused,l]),h=h||e.isDisabled(n);let w={};!l&&!h?w={tabIndex:n===e.focusedKey?0:-1,onFocus(Pe){Pe.target===r.current&&e.setFocusedKey(n)}}:h&&(w.onMouseDown=Pe=>{Pe.preventDefault()});let A=!h&&e.canSelectItem(n),L=p&&!h,M=L&&(e.selectionBehavior==="replace"?!A:e.isEmpty),U=L&&A&&e.selectionBehavior==="replace",D=M||U,$=te.useRef(null),N=D&&A,B=te.useRef(!1),Z=te.useRef(!1),ie={};i?(ie.onPressStart=Pe=>{$.current=Pe.pointerType,B.current=N,Pe.pointerType==="keyboard"&&(!D||nN())&&x(Pe)},b?(ie.onPressUp=Pe=>{Pe.pointerType!=="keyboard"&&x(Pe)},ie.onPress=M?()=>p():null):ie.onPress=Pe=>{if(M||U&&Pe.pointerType!=="mouse"){if(Pe.pointerType==="keyboard"&&!tN())return;p()}else Pe.pointerType!=="keyboard"&&x(Pe)}):(ie.onPressStart=Pe=>{$.current=Pe.pointerType,B.current=N,Z.current=M,(Pe.pointerType==="mouse"&&!M||Pe.pointerType==="keyboard"&&(!p||nN()))&&x(Pe)},ie.onPress=Pe=>{(Pe.pointerType==="touch"||Pe.pointerType==="pen"||Pe.pointerType==="virtual"||Pe.pointerType==="keyboard"&&D&&tN()||Pe.pointerType==="mouse"&&Z.current)&&(D?p():x(Pe))}),s||(w["data-key"]=n),ie.preventFocusOnPress=l;let{pressProps:re,isPressed:ve}=O$(ie),Te=U?Pe=>{$.current==="mouse"&&(Pe.stopPropagation(),Pe.preventDefault(),p())}:void 0,{longPressProps:Ae}=Kj({isDisabled:!N,onLongPress(Pe){Pe.pointerType==="touch"&&(x(Pe),e.setSelectionBehavior("toggle"))}});return{itemProps:Vn(w,A||M?re:{},N?Ae:{},{onDoubleClick:Te,onDragStartCapture:Pe=>{$.current==="touch"&&B.current&&Pe.preventDefault()}}),isPressed:ve,isSelected:e.isSelected(n),isFocused:e.isFocused&&e.focusedKey===n,isDisabled:h,allowsSelection:A,hasAction:D}}function tN(){let t=window.event;return(t==null?void 0:t.key)==="Enter"}function nN(){let t=window.event;return(t==null?void 0:t.key)===" "||(t==null?void 0:t.code)==="Space"}class tW{getKeyBelow(e){for(e=this.collection.getKeyAfter(e);e!=null;){if(this.collection.getItem(e).type==="item"&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyAfter(e)}return null}getKeyAbove(e){for(e=this.collection.getKeyBefore(e);e!=null;){if(this.collection.getItem(e).type==="item"&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyBefore(e)}return null}getFirstKey(){let e=this.collection.getFirstKey();for(;e!=null;){if(this.collection.getItem(e).type==="item"&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyAfter(e)}return null}getLastKey(){let e=this.collection.getLastKey();for(;e!=null;){if(this.collection.getItem(e).type==="item"&&!this.disabledKeys.has(e))return e;e=this.collection.getKeyBefore(e)}return null}getItem(e){return this.ref.current.querySelector(`[data-key="${e}"]`)}getKeyPageAbove(e){let n=this.ref.current,r=this.getItem(e);if(!r)return null;let i=Math.max(0,r.offsetTop+r.offsetHeight-n.offsetHeight);for(;r&&r.offsetTop>i;)e=this.getKeyAbove(e),r=e==null?null:this.getItem(e);return e}getKeyPageBelow(e){let n=this.ref.current,r=this.getItem(e);if(!r)return null;let i=Math.min(n.scrollHeight,r.offsetTop-r.offsetHeight+n.offsetHeight);for(;r&&r.offsetTop<i;)e=this.getKeyBelow(e),r=e==null?null:this.getItem(e);return e}getKeyForSearch(e,n){if(!this.collator)return null;let r=this.collection,i=n||this.getFirstKey();for(;i!=null;){let s=r.getItem(i),l=s.textValue.slice(0,e.length);if(s.textValue&&this.collator.compare(l,e)===0)return i;i=this.getKeyBelow(i)}return null}constructor(e,n,r,i){this.collection=e,this.disabledKeys=n,this.ref=r,this.collator=i}}function FEe(t){let{selectionManager:e,collection:n,disabledKeys:r,ref:i,keyboardDelegate:s,autoFocus:l,shouldFocusWrap:o,isVirtualized:h,disallowEmptySelection:p,selectOnFocus:b=e.selectionBehavior==="replace",disallowTypeAhead:x,shouldUseVirtualFocus:w,allowsTabNavigation:A}=t,L=R$({usage:"search",sensitivity:"base"}),M=e.disabledBehavior,U=te.useMemo(()=>s||new tW(n,M==="selection"?new Set:r,i,L),[s,n,r,i,L,M]),{collectionProps:D}=eW({ref:i,selectionManager:e,keyboardDelegate:U,autoFocus:l,shouldFocusWrap:o,disallowEmptySelection:p,selectOnFocus:b,disallowTypeAhead:x,shouldUseVirtualFocus:w,allowsTabNavigation:A,isVirtualized:h,scrollRef:i});return{listProps:D}}function NEe(t){return t&&t.__esModule?t.default:t}var nW={},rW={};rW={longPressMessage:"     Alt +    "};var iW={};iW={longPressMessage:"    Alt+  ,    "};var sW={};sW={longPressMessage:"Dlouhm stiskem nebo stisknutm klves Alt + ipka dol otevete nabdku"};var oW={};oW={longPressMessage:"Langt tryk eller tryk p Alt + pil ned for at bne menuen"};var aW={};aW={longPressMessage:"Drcken Sie lange oder drcken Sie Alt + Nach-unten, um das Men zu ffnen"};var lW={};lW={longPressMessage:"    Alt +       "};var cW={};cW={longPressMessage:"Long press or press Alt + ArrowDown to open menu"};var uW={};uW={longPressMessage:"Mantenga pulsado o pulse Alt + flecha abajo para abrir el men"};var dW={};dW={longPressMessage:"Men avamiseks vajutage pikalt vi vajutage klahve Alt + allanool"};var hW={};hW={longPressMessage:"Avaa valikko painamalla pohjassa tai nppinyhdistelmll Alt + Alanuoli"};var fW={};fW={longPressMessage:"Appuyez de manire prolonge ou appuyez sur Alt+Flche vers le bas pour ouvrir le menu."};var pW={};pW={longPressMessage:"     Alt + ArrowDown    "};var mW={};mW={longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dolje za otvaranje izbornika"};var gW={};gW={longPressMessage:"Nyomja meg hosszan, vagy nyomja meg az Alt + lefele nyl gombot a men megnyitshoz"};var yW={};yW={longPressMessage:"Premere a lungo o premere Alt + Freccia gi per aprire il menu"};var vW={};vW={longPressMessage:" Alt+"};var _W={};_W={longPressMessage:"  Alt +     "};var bW={};bW={longPressMessage:"Nordami atidaryti meniu, nuspaud palaikykite arba paspauskite Alt + ArrowDown."};var xW={};xW={longPressMessage:"Lai atvrtu izvlni, turiet nospiestu vai nospiediet taustiu kombinciju Alt + lejupvrst bultia"};var wW={};wW={longPressMessage:"Langt trykk eller trykk Alt + PilNed for  pne menyen"};var TW={};TW={longPressMessage:"Druk lang op Alt + pijl-omlaag of druk op Alt om het menu te openen"};var EW={};EW={longPressMessage:"Nacinij i przytrzymaj lub nacinij klawisze Alt + Strzaka w d, aby otworzy menu"};var SW={};SW={longPressMessage:"Pressione e segure ou pressione Alt + Seta para baixo para abrir o menu"};var AW={};AW={longPressMessage:"Prima continuamente ou prima Alt + Seta Para Baixo para abrir o menu"};var PW={};PW={longPressMessage:"Apsai lung sau apsai pe Alt + sgeat n jos pentru a deschide meniul"};var CW={};CW={longPressMessage:"     Alt +  ,   "};var LW={};LW={longPressMessage:"Ponuku otvorte dlhm stlaenm alebo stlaenm klvesu Alt + klvesu so pkou nadol"};var IW={};IW={longPressMessage:"Za odprtje menija pritisnite in drite gumb ali pritisnite Alt+puica navzdol"};var RW={};RW={longPressMessage:"Dugo pritisnite ili pritisnite Alt + strelicu prema dole da otvorite meni"};var MW={};MW={longPressMessage:"Hll nedtryckt eller tryck p Alt + pil nedt fr att ppna menyn"};var $W={};$W={longPressMessage:"Meny amak iin uzun basn veya Alt + Aa Ok tuuna basn"};var kW={};kW={longPressMessage:"      Alt   ,   "};var OW={};OW={longPressMessage:" Alt + "};var DW={};DW={longPressMessage:" Alt+"};nW={"ar-AE":rW,"bg-BG":iW,"cs-CZ":sW,"da-DK":oW,"de-DE":aW,"el-GR":lW,"en-US":cW,"es-ES":uW,"et-EE":dW,"fi-FI":hW,"fr-FR":fW,"he-IL":pW,"hr-HR":mW,"hu-HU":gW,"it-IT":yW,"ja-JP":vW,"ko-KR":_W,"lt-LT":bW,"lv-LV":xW,"nb-NO":wW,"nl-NL":TW,"pl-PL":EW,"pt-BR":SW,"pt-PT":AW,"ro-RO":PW,"ru-RU":CW,"sk-SK":LW,"sl-SI":IW,"sr-SP":RW,"sv-SE":MW,"tr-TR":$W,"uk-UA":kW,"zh-CN":OW,"zh-TW":DW};function zEe(t,e,n){let{type:r="menu",isDisabled:i,trigger:s="press"}=t,l=ta(),{triggerProps:o,overlayProps:h}=tG({type:r},e,n),p=A=>{if(!i&&!(s==="longPress"&&!A.altKey)&&n&&n.current)switch(A.key){case"Enter":case" ":if(s==="longPress")return;case"ArrowDown":"continuePropagation"in A||A.stopPropagation(),A.preventDefault(),e.toggle("first");break;case"ArrowUp":"continuePropagation"in A||A.stopPropagation(),A.preventDefault(),e.toggle("last");break}},b=dc(NEe(nW)),{longPressProps:x}=Kj({isDisabled:i||s!=="longPress",accessibilityDescription:b.format("longPressMessage"),onLongPressStart(){e.close()},onLongPress(){e.open("first")}}),w={onPressStart(A){A.pointerType!=="touch"&&A.pointerType!=="keyboard"&&!i&&e.toggle(A.pointerType==="virtual"?"first":null)},onPress(A){A.pointerType==="touch"&&!i&&e.toggle()}};return delete o.onPress,{menuTriggerProps:{...o,...s==="press"?w:x,id:l,onKeyDown:p},menuProps:{...h,"aria-labelledby":l,autoFocus:e.focusStrategy||!0,onClose:e.close}}}function BEe(t){let[e,n]=fx(t.isOpen,t.defaultOpen||!1,t.onOpenChange);return{isOpen:e,setOpen:n,open(){n(!0)},close(){n(!1)},toggle(){n(!e)}}}function UEe(t){let e=BEe(t),[n,r]=te.useState(null);return{focusStrategy:n,...e,open(i=null){r(i),e.open()},toggle(i=null){r(i),e.toggle()}}}class ma extends Set{constructor(e,n,r){super(e),e instanceof ma?(this.anchorKey=n||e.anchorKey,this.currentKey=r||e.currentKey):(this.anchorKey=n,this.currentKey=r)}}function VEe(t,e){if(t.size!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0}function jEe(t){let{selectionMode:e="none",disallowEmptySelection:n,allowDuplicateSelectionEvents:r,selectionBehavior:i="toggle",disabledBehavior:s="all"}=t,l=te.useRef(!1),[,o]=te.useState(!1),h=te.useRef(null),p=te.useRef(null),[,b]=te.useState(null),x=te.useMemo(()=>rN(t.selectedKeys),[t.selectedKeys]),w=te.useMemo(()=>rN(t.defaultSelectedKeys,new ma),[t.defaultSelectedKeys]),[A,L]=fx(x,w,t.onSelectionChange),M=te.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),[U,D]=te.useState(i);i==="replace"&&U==="toggle"&&typeof A=="object"&&A.size===0&&D("replace");let $=te.useRef(i);return te.useEffect(()=>{i!==$.current&&(D(i),$.current=i)},[i]),{selectionMode:e,disallowEmptySelection:n,selectionBehavior:U,setSelectionBehavior:D,get isFocused(){return l.current},setFocused(N){l.current=N,o(N)},get focusedKey(){return h.current},get childFocusStrategy(){return p.current},setFocusedKey(N,B="first"){h.current=N,p.current=B,b(N)},selectedKeys:A,setSelectedKeys(N){(r||!VEe(N,A))&&L(N)},disabledKeys:M,disabledBehavior:s}}function rN(t,e){return t?t==="all"?"all":new ma(t):e}class GEe{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,n){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,n)}get selectedKeys(){return this.state.selectedKeys==="all"?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){return this.state.selectionMode==="none"?!1:(e=this.getKey(e),this.state.selectedKeys==="all"?this.canSelectItem(e):this.state.selectedKeys.has(e))}get isEmpty(){return this.state.selectedKeys!=="all"&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys==="all")return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),n=this.state.selectedKeys;return this._isSelectAll=e.every(r=>n.has(r)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let n of this.state.selectedKeys){let r=this.collection.getItem(n);(!e||r&&_T(this.collection,r,e)<0)&&(e=r)}return e==null?void 0:e.key}get lastSelectedKey(){let e=null;for(let n of this.state.selectedKeys){let r=this.collection.getItem(n);(!e||r&&_T(this.collection,r,e)>0)&&(e=r)}return e==null?void 0:e.key}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"){this.replaceSelection(e);return}e=this.getKey(e);let n;if(this.state.selectedKeys==="all")n=new ma([e],e,e);else{let r=this.state.selectedKeys,i=r.anchorKey||e;n=new ma(r,i,e);for(let s of this.getKeyRange(i,r.currentKey||e))n.delete(s);for(let s of this.getKeyRange(e,i))this.canSelectItem(s)&&n.add(s)}this.state.setSelectedKeys(n)}getKeyRange(e,n){let r=this.collection.getItem(e),i=this.collection.getItem(n);return r&&i?_T(this.collection,r,i)<=0?this.getKeyRangeInternal(e,n):this.getKeyRangeInternal(n,e):[]}getKeyRangeInternal(e,n){let r=[],i=e;for(;i;){let s=this.collection.getItem(i);if((s&&s.type==="item"||s.type==="cell"&&this.allowsCellSelection)&&r.push(i),i===n)return r;i=this.collection.getKeyAfter(i)}return[]}getKey(e){let n=this.collection.getItem(e);if(!n||n.type==="cell"&&this.allowsCellSelection)return e;for(;n.type!=="item"&&n.parentKey!=null;)n=this.collection.getItem(n.parentKey);return!n||n.type!=="item"?null:n.key}toggleSelection(e){if(this.selectionMode==="none")return;if(this.selectionMode==="single"&&!this.isSelected(e)){this.replaceSelection(e);return}if(e=this.getKey(e),e==null)return;let n=new ma(this.state.selectedKeys==="all"?this.getSelectAllKeys():this.state.selectedKeys);n.has(e)?n.delete(e):this.canSelectItem(e)&&(n.add(e),n.anchorKey=e,n.currentKey=e),!(this.disallowEmptySelection&&n.size===0)&&this.state.setSelectedKeys(n)}replaceSelection(e){if(this.selectionMode==="none"||(e=this.getKey(e),e==null))return;let n=this.canSelectItem(e)?new ma([e],e,e):new ma;this.state.setSelectedKeys(n)}setSelectedKeys(e){if(this.selectionMode==="none")return;let n=new ma;for(let r of e)if(r=this.getKey(r),r!=null&&(n.add(r),this.selectionMode==="single"))break;this.state.setSelectedKeys(n)}getSelectAllKeys(){let e=[],n=r=>{for(;r;){if(this.canSelectItem(r)){let i=this.collection.getItem(r);i.type==="item"&&e.push(r),i.hasChildNodes&&(this.allowsCellSelection||i.type!=="item")&&n(Wwe(dp(i,this.collection)).key)}r=this.collection.getKeyAfter(r)}};return n(this.collection.getFirstKey()),e}selectAll(){this.selectionMode==="multiple"&&this.state.setSelectedKeys("all")}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys==="all"||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new ma)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,n){this.selectionMode!=="none"&&(this.selectionMode==="single"?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior==="toggle"||n&&(n.pointerType==="touch"||n.pointerType==="virtual")?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let n=this.selectedKeys;if(e.size!==n.size)return!1;for(let r of e)if(!n.has(r))return!1;for(let r of n)if(!e.has(r))return!1;return!0}canSelectItem(e){if(this.state.selectionMode==="none"||this.state.disabledKeys.has(e))return!1;let n=this.collection.getItem(e);return!(!n||n.type==="cell"&&!this.allowsCellSelection)}isDisabled(e){return this.state.disabledKeys.has(e)&&this.state.disabledBehavior==="all"}constructor(e,n,r){this.collection=e,this.state=n;var i;this.allowsCellSelection=(i=r==null?void 0:r.allowsCellSelection)!==null&&i!==void 0?i:!1,this._isSelectAll=null}}var FW={};Object.defineProperty(FW,"__esModule",{value:!0});var WEe=FW.CheckmarkMedium=NW,kT=HEe(te);function HEe(t){return t&&t.__esModule?t:{default:t}}function EP(){return EP=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},EP.apply(this,arguments)}function qEe(t,e){if(t==null)return{};var n=KEe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function KEe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function NW(t){var e=t.scale,n=e===void 0?"M":e,r=qEe(t,["scale"]);return kT.default.createElement("svg",EP({},r,r),n==="L"&&kT.default.createElement("path",{d:"M6 14a1 1 0 0 1-.789-.385l-4-5a1 1 0 1 1 1.577-1.23L6 11.376l7.213-8.99a1 1 0 1 1 1.576 1.23l-8 10a1 1 0 0 1-.789.384z"}),n==="M"&&kT.default.createElement("path",{d:"M4.5 10a1.022 1.022 0 0 1-.799-.384l-2.488-3a1 1 0 0 1 1.576-1.233L4.5 7.376l4.712-5.991a1 1 0 1 1 1.576 1.23l-5.51 7A.978.978 0 0 1 4.5 10z"}))}NW.displayName="CheckmarkMedium";function U$(t){return le.createElement(Pp,t,le.createElement(WEe,null))}function OT(t){return t&&t.__esModule?t.default:t}function V$(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}const XEe={...gx,autoFlow:["gridAutoFlow",$i],autoColumns:["gridAutoColumns",o1],autoRows:["gridAutoRows",o1],areas:["gridTemplateAreas",YEe],columns:["gridTemplateColumns",iN],rows:["gridTemplateRows",iN],gap:["gap",Zn],rowGap:["rowGap",Zn],columnGap:["columnGap",Zn],justifyItems:["justifyItems",$i],justifyContent:["justifyContent",$i],alignItems:["alignItems",$i],alignContent:["alignContent",$i]};function ZEe(t,e){let{children:n,...r}=t,{styleProps:i}=mi(r,XEe);i.style.display="grid";let s=io(e);return le.createElement("div",{...Hi(r),...i,ref:s},n)}function YEe(t){return t.map(e=>`"${e}"`).join(`
`)}function o1(t){return/^max-content|min-content|minmax|auto|fit-content|repeat|subgrid/.test(t)?t:Zn(t)}function iN(t){return Array.isArray(t)?t.map(o1).join(" "):o1(t)}const JEe=te.forwardRef(ZEe);var Ff={};V$(Ff,"flex-container",()=>SP,t=>SP=t);V$(Ff,"flex",()=>AP,t=>AP=t);V$(Ff,"flex-gap",()=>PP,t=>PP=t);var SP,AP,PP;SP="flex-container_e15493";AP="flex_e15493";PP="flex-gap_e15493";const QEe={direction:["flexDirection",$i],wrap:["flexWrap",tSe],justifyContent:["justifyContent",DT],alignItems:["alignItems",DT],alignContent:["alignContent",DT]};function eSe(t,e){let{children:n,...r}=t,i=jj(),s=(i==null?void 0:i.matchedBreakpoints)||["base"],{styleProps:l}=mi(r),{styleProps:o}=mi(r,QEe),h=io(e),p=Sp();if((t.gap||t.rowGap||t.columnGap)&&(p||!nSe())){let x={...o.style,"--column-gap":t.columnGap!=null?Gh(t.columnGap,s):void 0,"--row-gap":t.rowGap!=null?Gh(t.rowGap,s):void 0,"--gap":t.gap!=null?Gh(t.gap,s):void 0};return le.createElement("div",{...Hi(r),...l,className:ct(OT(Ff),"flex-container",l.className),ref:h},le.createElement("div",{className:ct(OT(Ff),"flex","flex-gap"),style:x},n))}let b={...l.style,...o.style};return t.gap!=null&&(b.gap=Gh(t.gap,s)),t.columnGap!=null&&(b.columnGap=Gh(t.columnGap,s)),t.rowGap!=null&&(b.rowGap=Gh(t.rowGap,s)),le.createElement("div",{...Hi(r),className:ct(OT(Ff),"flex",l.className),style:b,ref:h},n)}function DT(t){return t==="start"?"flex-start":t==="end"?"flex-end":t}function tSe(t){return typeof t=="boolean"?t?"wrap":"nowrap":t}let l_=null;function nSe(){if(l_!=null)return l_;if(typeof document>"u")return!1;var t=document.createElement("div");return t.style.display="flex",t.style.flexDirection="column",t.style.rowGap="1px",t.appendChild(document.createElement("div")),t.appendChild(document.createElement("div")),document.body.appendChild(t),l_=t.scrollHeight===1,t.parentNode.removeChild(t),l_}const Ta=te.forwardRef(eSe);function zW(t){let e=Hi(t,{labelable:!0}),n;return t.orientation==="vertical"&&(n="vertical"),t.elementType!=="hr"?{separatorProps:{...e,role:"separator","aria-orientation":n}}:{separatorProps:e}}let rSe=Symbol.iterator;class CP{*[rSe](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let n=this.keyMap.get(e);return n?n.prevKey:null}getKeyAfter(e){let n=this.keyMap.get(e);return n?n.nextKey:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){return this.keyMap.get(e)}at(e){const n=[...this.getKeys()];return this.getItem(n[e])}getChildren(e){let n=this.keyMap.get(e);return(n==null?void 0:n.childNodes)||[]}constructor(e){$r(this,"keyMap",new Map),this.iterable=e;let n=s=>{if(this.keyMap.set(s.key,s),s.childNodes&&s.type==="section")for(let l of s.childNodes)n(l)};for(let s of e)n(s);let r,i=0;for(let[s,l]of this.keyMap)r?(r.nextKey=s,l.prevKey=r.key):(this.firstKey=s,l.prevKey=void 0),l.type==="item"&&(l.index=i++),r=l,r.nextKey=void 0;this.lastKey=r==null?void 0:r.key}}function BW(t){let{filter:e}=t,n=jEe(t),r=te.useMemo(()=>t.disabledKeys?new Set(t.disabledKeys):new Set,[t.disabledKeys]),i=p=>e?new CP(e(p)):new CP(p),s=te.useMemo(()=>({suppressTextValueWarning:t.suppressTextValueWarning}),[t.suppressTextValueWarning]),l=Gwe(t,i,s,[e]),o=te.useMemo(()=>new GEe(l,n),[l,n]);const h=te.useRef(null);return te.useEffect(()=>{if(n.focusedKey!=null&&!l.getItem(n.focusedKey)){const p=h.current.getItem(n.focusedKey),b=[...h.current.getKeys()].map(M=>{const U=h.current.getItem(M);return U.type==="item"?U:null}).filter(M=>M!==null),x=[...l.getKeys()].map(M=>{const U=l.getItem(M);return U.type==="item"?U:null}).filter(M=>M!==null),w=b.length-x.length;let A=Math.min(w>1?Math.max(p.index-w+1,0):p.index,x.length-1),L;for(;A>=0;){if(!o.isDisabled(x[A].key)){L=x[A];break}A<x.length-1?A++:(A>p.index&&(A=p.index),A--)}n.setFocusedKey(L?L.key:null)}h.current=l},[l,o,n,n.focusedKey]),{collection:l,disabledKeys:r,selectionManager:o}}function iSe(t){var e;let[n,r]=fx(t.selectedKey,(e=t.defaultSelectedKey)!==null&&e!==void 0?e:null,t.onSelectionChange),i=te.useMemo(()=>n!=null?[n]:[],[n]),{collection:s,disabledKeys:l,selectionManager:o}=BW({...t,selectionMode:"single",disallowEmptySelection:!0,allowDuplicateSelectionEvents:!0,selectedKeys:i,onSelectionChange:p=>{let b=p.values().next().value;b===n&&t.onSelectionChange&&t.onSelectionChange(b),r(b)}}),h=n!=null?s.getItem(n):null;return{collection:s,disabledKeys:l,selectionManager:o,selectedKey:n,setSelectedKey:r,selectedItem:h}}const UW=7e3;let FT=null;function NT(t,e="assertive",n=UW){FT||(FT=new sSe),FT.announce(t,e,n)}class sSe{createLog(e){let n=document.createElement("div");return n.setAttribute("role","log"),n.setAttribute("aria-live",e),n.setAttribute("aria-relevant","additions"),n}destroy(){this.node&&(document.body.removeChild(this.node),this.node=null)}announce(e,n="assertive",r=UW){if(!this.node)return;let i=document.createElement("div");i.textContent=e,n==="assertive"?this.assertiveLog.appendChild(i):this.politeLog.appendChild(i),e!==""&&setTimeout(()=>{i.remove()},r)}clear(e){this.node&&((!e||e==="assertive")&&(this.assertiveLog.innerHTML=""),(!e||e==="polite")&&(this.politeLog.innerHTML=""))}constructor(){this.node=document.createElement("div"),this.node.dataset.liveAnnouncer="true",Object.assign(this.node.style,{border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"}),this.assertiveLog=this.createLog("assertive"),this.node.appendChild(this.assertiveLog),this.politeLog=this.createLog("polite"),this.node.appendChild(this.politeLog),document.body.prepend(this.node)}}function Ei(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var Si={};Ei(Si,"spectrum-FieldLabel",()=>LP,t=>LP=t);Ei(Si,"spectrum-FieldLabel--positionSide",()=>IP,t=>IP=t);Ei(Si,"spectrum-FieldLabel-requiredIcon",()=>RP,t=>RP=t);Ei(Si,"spectrum-FieldLabel--alignEnd",()=>MP,t=>MP=t);Ei(Si,"spectrum-Field",()=>$P,t=>$P=t);Ei(Si,"spectrum-Field-contextualHelp",()=>kP,t=>kP=t);Ei(Si,"spectrum-Field--positionTop",()=>OP,t=>OP=t);Ei(Si,"spectrum-Field-field",()=>DP,t=>DP=t);Ei(Si,"spectrum-Field--alignEnd",()=>FP,t=>FP=t);Ei(Si,"spectrum-Field--positionSide",()=>NP,t=>NP=t);Ei(Si,"spectrum-Field-wrapper",()=>zP,t=>zP=t);Ei(Si,"spectrum-Field--hasContextualHelp",()=>BP,t=>BP=t);Ei(Si,"spectrum-Form",()=>UP,t=>UP=t);Ei(Si,"spectrum-Form--positionSide",()=>VP,t=>VP=t);Ei(Si,"spectrum-Field-labelCell",()=>jP,t=>jP=t);Ei(Si,"spectrum-Field-labelWrapper",()=>GP,t=>GP=t);Ei(Si,"spectrum-Form--positionTop",()=>WP,t=>WP=t);Ei(Si,"spectrum-LabeledValue",()=>HP,t=>HP=t);Ei(Si,"spectrum-Form-itemLabel",()=>qP,t=>qP=t);Ei(Si,"is-disabled",()=>KP,t=>KP=t);var LP,IP,RP,MP,$P,kP,OP,DP,FP,NP,zP,BP,UP,VP,jP,GP,WP,HP,qP,KP;LP="spectrum-FieldLabel_d2db1f";IP="spectrum-FieldLabel--positionSide_d2db1f";RP="spectrum-FieldLabel-requiredIcon_d2db1f";MP="spectrum-FieldLabel--alignEnd_d2db1f";$P="spectrum-Field_d2db1f";kP="spectrum-Field-contextualHelp_d2db1f";OP="spectrum-Field--positionTop_d2db1f";DP="spectrum-Field-field_d2db1f";FP="spectrum-Field--alignEnd_d2db1f";NP="spectrum-Field--positionSide_d2db1f";zP="spectrum-Field-wrapper_d2db1f";BP="spectrum-Field--hasContextualHelp_d2db1f";UP="spectrum-Form_d2db1f";VP="spectrum-Form--positionSide_d2db1f";jP="spectrum-Field-labelCell_d2db1f";GP="spectrum-Field-labelWrapper_d2db1f";WP="spectrum-Form--positionTop_d2db1f";HP="spectrum-LabeledValue_d2db1f";qP="spectrum-Form-itemLabel_d2db1f";KP="is-disabled_d2db1f";let oSe=le.createContext(null);function aSe(t){let e=te.useContext(oSe);return e?{...e,...t}:t}var VW={};Object.defineProperty(VW,"__esModule",{value:!0});var jW=VW.AlertMedium=GW,zT=lSe(te);function lSe(t){return t&&t.__esModule?t:{default:t}}function XP(){return XP=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},XP.apply(this,arguments)}function cSe(t,e){if(t==null)return{};var n=uSe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function uSe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function GW(t){var e=t.scale,n=e===void 0?"M":e,r=cSe(t,["scale"]);return zT.default.createElement("svg",XP({},r,r),n==="L"&&zT.default.createElement("path",{d:"M10.563 2.206l-9.249 16.55a.5.5 0 0 0 .436.744h18.5a.5.5 0 0 0 .436-.744l-9.251-16.55a.5.5 0 0 0-.872 0zm1.436 15.044a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-1.5a.25.25 0 0 1 .25-.25h1.5a.25.25 0 0 1 .25.25zm0-3.5a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-6a.25.25 0 0 1 .25-.25h1.5a.25.25 0 0 1 .25.25z"}),n==="M"&&zT.default.createElement("path",{d:"M8.564 1.289L.2 16.256A.5.5 0 0 0 .636 17h16.728a.5.5 0 0 0 .436-.744L9.436 1.289a.5.5 0 0 0-.872 0zM10 14.75a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-1.5a.25.25 0 0 1 .25-.25h1.5a.25.25 0 0 1 .25.25zm0-3a.25.25 0 0 1-.25.25h-1.5a.25.25 0 0 1-.25-.25v-6a.25.25 0 0 1 .25-.25h1.5a.25.25 0 0 1 .25.25z"}))}GW.displayName="AlertMedium";const WW=t=>le.createElement("svg",jA({viewBox:"0 0 18 18"},t),le.createElement("path",{d:"M9 10.5a1 1 0 0 1-1-1V5a1 1 0 1 1 2 0v4.5a1 1 0 0 1-1 1Zm0 1.25A1.25 1.25 0 1 0 10.25 13 1.25 1.25 0 0 0 9 11.75Zm8.497 3.589a3.49 3.49 0 0 0 .079-3.474L12 1.815a3.385 3.385 0 0 0-5.994-.007L.416 11.88a3.485 3.485 0 0 0 .089 3.459A3.375 3.375 0 0 0 3.416 17h11.169a3.375 3.375 0 0 0 2.912-1.661ZM10.244 2.77l5.575 10.05a1.497 1.497 0 0 1-.037 1.489 1.374 1.374 0 0 1-1.197.69H3.416a1.374 1.374 0 0 1-1.197-.69 1.493 1.493 0 0 1-.046-1.474l5.593-10.08a1.386 1.386 0 0 1 2.478.015Z"}));WW.displayName=jW.displayName;function j$(t){var e,n;let r=rh();return le.createElement(Pp,t,r!=null&&(e=r.theme)!=null&&(n=e.global)!=null&&n.express?le.createElement(WW,null):le.createElement(jW,null))}var HW={};Object.defineProperty(HW,"__esModule",{value:!0});var dSe=HW.Asterisk=qW,BT=hSe(te);function hSe(t){return t&&t.__esModule?t:{default:t}}function ZP(){return ZP=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ZP.apply(this,arguments)}function fSe(t,e){if(t==null)return{};var n=pSe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function pSe(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function qW(t){var e=t.scale,n=e===void 0?"M":e,r=fSe(t,["scale"]);return BT.default.createElement("svg",ZP({},r,r),n==="L"&&BT.default.createElement("path",{d:"M7.867 7.872c.061.062.103.145 0 .228l-1.283.827c-.104.061-.145.02-.186-.083L4.804 6.07l-2.09 2.297c-.021.042-.083.083-.145 0l-.994-1.035c-.103-.062-.082-.124 0-.186l2.36-1.966-2.691-1.014c-.042 0-.104-.083-.062-.186l.703-1.41a.11.11 0 0 1 .187-.04L4.43 4.06l.145-3.02A.109.109 0 0 1 4.7.917l1.718.227c.104 0 .124.042.104.145l-.808 2.96 2.734-.828c.061-.042.124-.042.165.082l.27 1.532c.02.103 0 .145-.084.145l-2.856.227z"}),n==="M"&&BT.default.createElement("path",{d:"M6.573 6.558c.056.055.092.13 0 .204l-1.148.74c-.093.056-.13.02-.167-.073L3.832 4.947l-1.87 2.055c-.02.037-.075.074-.13 0l-.889-.926c-.092-.055-.074-.111 0-.167l2.111-1.76-2.408-.906c-.037 0-.092-.074-.055-.167l.63-1.259a.097.097 0 0 1 .166-.036l2.111 1.37.13-2.704a.097.097 0 0 1 .111-.11L5.277.54c.092 0 .11.037.092.13l-.722 2.647 2.444-.74c.056-.038.111-.038.148.073l.241 1.37c.019.093 0 .13-.074.13l-2.556.204z"}))}qW.displayName="Asterisk";function mSe(t){return le.createElement(Pp,t,le.createElement(dSe,null))}function Eo(t){return t&&t.__esModule?t.default:t}function Pr(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var sl={};Pr(sl,"spectrum-HelpText",()=>YP,t=>YP=t);Pr(sl,"spectrum-HelpText-validationIcon",()=>JP,t=>JP=t);Pr(sl,"spectrum-HelpText-text",()=>QP,t=>QP=t);Pr(sl,"spectrum-HelpText--neutral",()=>eC,t=>eC=t);Pr(sl,"is-disabled",()=>tC,t=>tC=t);Pr(sl,"spectrum-HelpText--negative",()=>nC,t=>nC=t);var YP,JP,QP,eC,tC,nC;YP="spectrum-HelpText_f395de";JP="spectrum-HelpText-validationIcon_f395de";QP="spectrum-HelpText-text_f395de";eC="spectrum-HelpText--neutral_f395de";tC="is-disabled_f395de";nC="spectrum-HelpText--negative_f395de";function gSe(t,e){let{description:n,errorMessage:r,validationState:i,isDisabled:s,showErrorIcon:l,descriptionProps:o,errorMessageProps:h}=t,p=io(e),b=r&&i==="invalid",{styleProps:x}=mi(t);return le.createElement("div",{...x,className:ct(Eo(sl),"spectrum-HelpText",`spectrum-HelpText--${b?"negative":"neutral"}`,{"is-disabled":s},x.className),ref:p},b?le.createElement(le.Fragment,null,l&&le.createElement(j$,{UNSAFE_className:ct(Eo(sl),"spectrum-HelpText-validationIcon")}),le.createElement("div",{...h,className:ct(Eo(sl),"spectrum-HelpText-text")},r)):le.createElement("div",{...o,className:ct(Eo(sl),"spectrum-HelpText-text")},n))}const ySe=le.forwardRef(gSe);var KW={},XW={};XW={"(optional)":"()","(required)":"()"};var ZW={};ZW={"(optional)":"()","(required)":"()"};var YW={};YW={"(optional)":"(voliteln)","(required)":"(poadovno)"};var JW={};JW={"(optional)":"(valgfrit)","(required)":"(obligatorisk)"};var QW={};QW={"(optional)":"(optional)","(required)":"(erforderlich)"};var eH={};eH={"(optional)":"()","(required)":"()"};var tH={};tH={"(required)":"(required)","(optional)":"(optional)"};var nH={};nH={"(optional)":"(opcional)","(required)":"(obligatorio)"};var rH={};rH={"(optional)":"(valikuline)","(required)":"(nutav)"};var iH={};iH={"(optional)":"(valinnainen)","(required)":"(pakollinen)"};var sH={};sH={"(optional)":"(facultatif)","(required)":"(requis)"};var oH={};oH={"(optional)":"()","(required)":"()"};var aH={};aH={"(optional)":"(opcionalno)","(required)":"(obvezno)"};var lH={};lH={"(optional)":"(opcionlis)","(required)":"(ktelez)"};var cH={};cH={"(optional)":"(facoltativo)","(required)":"(obbligatorio)"};var uH={};uH={"(optional)":"","(required)":""};var dH={};dH={"(optional)":"( )","(required)":"( )"};var hH={};hH={"(optional)":"(pasirenkama)","(required)":"(privaloma)"};var fH={};fH={"(optional)":"(neobligti)","(required)":"(obligti)"};var pH={};pH={"(optional)":"(valgfritt)","(required)":"(obligatorisk)"};var mH={};mH={"(optional)":"(optioneel)","(required)":"(vereist)"};var gH={};gH={"(optional)":"(opcjonalne)","(required)":"(wymagane)"};var yH={};yH={"(optional)":"(opcional)","(required)":"(obrigatrio)"};var vH={};vH={"(optional)":"(opcional)","(required)":"(obrigatrio)"};var _H={};_H={"(optional)":"(opional)","(required)":"(obligatoriu)"};var bH={};bH={"(optional)":"()","(required)":"()"};var xH={};xH={"(optional)":"(nepovinn)","(required)":"(povinn)"};var wH={};wH={"(optional)":"(opcijsko)","(required)":"(obvezno)"};var TH={};TH={"(optional)":"(opciono)","(required)":"(obavezno)"};var EH={};EH={"(optional)":"(valfritt)","(required)":"(krvs)"};var SH={};SH={"(optional)":"(istee bal)","(required)":"(gerekli)"};var AH={};AH={"(optional)":"()","(required)":"()"};var PH={};PH={"(optional)":"","(required)":""};var CH={};CH={"(optional)":"()","(required)":"()"};KW={"ar-AE":XW,"bg-BG":ZW,"cs-CZ":YW,"da-DK":JW,"de-DE":QW,"el-GR":eH,"en-US":tH,"es-ES":nH,"et-EE":rH,"fi-FI":iH,"fr-FR":sH,"he-IL":oH,"hr-HR":aH,"hu-HU":lH,"it-IT":cH,"ja-JP":uH,"ko-KR":dH,"lt-LT":hH,"lv-LV":fH,"nb-NO":pH,"nl-NL":mH,"pl-PL":gH,"pt-BR":yH,"pt-PT":vH,"ro-RO":_H,"ru-RU":bH,"sk-SK":xH,"sl-SI":wH,"sr-SP":TH,"sv-SE":EH,"tr-TR":SH,"uk-UA":AH,"zh-CN":PH,"zh-TW":CH};var pr={};Pr(pr,"spectrum-FieldLabel",()=>rC,t=>rC=t);Pr(pr,"spectrum-FieldLabel--positionSide",()=>iC,t=>iC=t);Pr(pr,"spectrum-FieldLabel-requiredIcon",()=>sC,t=>sC=t);Pr(pr,"spectrum-FieldLabel--alignEnd",()=>oC,t=>oC=t);Pr(pr,"spectrum-Field",()=>aC,t=>aC=t);Pr(pr,"spectrum-Field-contextualHelp",()=>lC,t=>lC=t);Pr(pr,"spectrum-Field--positionTop",()=>cC,t=>cC=t);Pr(pr,"spectrum-Field-field",()=>uC,t=>uC=t);Pr(pr,"spectrum-Field--alignEnd",()=>dC,t=>dC=t);Pr(pr,"spectrum-Field--positionSide",()=>hC,t=>hC=t);Pr(pr,"spectrum-Field-wrapper",()=>fC,t=>fC=t);Pr(pr,"spectrum-Field--hasContextualHelp",()=>pC,t=>pC=t);Pr(pr,"spectrum-Form",()=>mC,t=>mC=t);Pr(pr,"spectrum-Form--positionSide",()=>gC,t=>gC=t);Pr(pr,"spectrum-Field-labelCell",()=>yC,t=>yC=t);Pr(pr,"spectrum-Field-labelWrapper",()=>vC,t=>vC=t);Pr(pr,"spectrum-Form--positionTop",()=>_C,t=>_C=t);Pr(pr,"spectrum-LabeledValue",()=>bC,t=>bC=t);Pr(pr,"spectrum-Form-itemLabel",()=>xC,t=>xC=t);Pr(pr,"is-disabled",()=>wC,t=>wC=t);var rC,iC,sC,oC,aC,lC,cC,uC,dC,hC,fC,pC,mC,gC,yC,vC,_C,bC,xC,wC;rC="spectrum-FieldLabel_d2db1f";iC="spectrum-FieldLabel--positionSide_d2db1f";sC="spectrum-FieldLabel-requiredIcon_d2db1f";oC="spectrum-FieldLabel--alignEnd_d2db1f";aC="spectrum-Field_d2db1f";lC="spectrum-Field-contextualHelp_d2db1f";cC="spectrum-Field--positionTop_d2db1f";uC="spectrum-Field-field_d2db1f";dC="spectrum-Field--alignEnd_d2db1f";hC="spectrum-Field--positionSide_d2db1f";fC="spectrum-Field-wrapper_d2db1f";pC="spectrum-Field--hasContextualHelp_d2db1f";mC="spectrum-Form_d2db1f";gC="spectrum-Form--positionSide_d2db1f";yC="spectrum-Field-labelCell_d2db1f";vC="spectrum-Field-labelWrapper_d2db1f";_C="spectrum-Form--positionTop_d2db1f";bC="spectrum-LabeledValue_d2db1f";xC="spectrum-Form-itemLabel_d2db1f";wC="is-disabled_d2db1f";function vSe(t,e){t=Tx(t);let{children:n,labelPosition:r="top",labelAlign:i=r==="side"?"start":null,isRequired:s,necessityIndicator:l=s!=null?"icon":null,includeNecessityIndicatorInAccessibilityName:o=!1,htmlFor:h,for:p,elementType:b="label",onClick:x,...w}=t,A=io(e),{styleProps:L}=mi(w),M=dc(Eo(KW)),U=s?M.format("(required)"):M.format("(optional)"),D=le.createElement(mSe,{UNSAFE_className:ct(Eo(pr),"spectrum-FieldLabel-requiredIcon"),"aria-label":o?M.format("(required)"):void 0}),$=ct(Eo(pr),"spectrum-FieldLabel",{"spectrum-FieldLabel--positionSide":r==="side","spectrum-FieldLabel--alignEnd":i==="end"},L.className);return le.createElement(b,{...Hi(w),...L,onClick:x,ref:A,className:$,htmlFor:b==="label"?p||h:void 0},n,(l==="label"||l==="icon"&&s)&&" ",l==="label"&&le.createElement("span",{"aria-hidden":o?void 0:s},U),l==="icon"&&s&&D)}let _Se=le.forwardRef(vSe);function bSe(t,e){let n=aSe(t),r=n!==t;t=n;let{label:i,labelPosition:s="top",labelAlign:l,isRequired:o,necessityIndicator:h,includeNecessityIndicatorInAccessibilityName:p,validationState:b,description:x,errorMessage:w,isDisabled:A,showErrorIcon:L,contextualHelp:M,children:U,labelProps:D,descriptionProps:$={},errorMessageProps:N={},elementType:B,wrapperClassName:Z,wrapperProps:ie={},...re}=t,{styleProps:ve}=mi(re),Te=!!x||w&&b==="invalid",Ae=ta(),fe=ct(Eo(pr),"spectrum-Field",{"spectrum-Field--positionTop":s==="top","spectrum-Field--positionSide":s==="side","spectrum-Field--alignEnd":l==="end","spectrum-Field--hasContextualHelp":!!t.contextualHelp},ve.className,Z);U=le.cloneElement(U,Vn(U.props,{className:ct(Eo(pr),"spectrum-Field-field")}));let Pe=()=>le.createElement(ySe,{descriptionProps:$,errorMessageProps:N,description:x,errorMessage:w,validationState:b,isDisabled:A,showErrorIcon:L,gridArea:"helpText"}),_e=()=>s==="side"?le.createElement(Ta,{direction:"column",UNSAFE_className:ct(Eo(pr),"spectrum-Field-wrapper")},U,Te&&Pe()):le.createElement(le.Fragment,null,U,Te&&Pe()),ke=le.createElement(le.Fragment,null,i&&le.createElement(_Se,{...D,labelPosition:s,labelAlign:l,isRequired:o,necessityIndicator:h,includeNecessityIndicatorInAccessibilityName:p,elementType:B},i),i&&M&&le.createElement(yx,{slots:{actionButton:{UNSAFE_className:ct(Eo(pr),"spectrum-Field-contextualHelp"),id:Ae,"aria-labelledby":D!=null&&D.id?`${D.id} ${Ae}`:void 0}}},M));return r&&s==="side"&&i&&M&&(ke=le.createElement("div",{className:ct(Eo(pr),"spectrum-Field-labelCell")},le.createElement("div",{className:ct(Eo(pr),"spectrum-Field-labelWrapper")},ke))),le.createElement("div",{...ve,...ie,ref:e,className:fe},ke,_e())}let G$=le.forwardRef(bSe);function W$(t){let{id:e,label:n,"aria-labelledby":r,"aria-label":i,labelElementType:s="label"}=t;e=ta(e);let l=ta(),o={};n?(r=r?`${r} ${l}`:l,o={id:l,htmlFor:s==="label"?e:void 0}):!r&&!i&&console.warn("If you do not provide a visible label, you must specify an aria-label or aria-labelledby attribute for accessibility");let h=Kb({id:e,"aria-label":i,"aria-labelledby":r});return{labelProps:o,fieldProps:h}}function LH(t){let{description:e,errorMessage:n,validationState:r}=t,{labelProps:i,fieldProps:s}=W$(t),l=by([!!e,!!n,r]),o=by([!!e,!!n,r]);return s=Vn(s,{"aria-describedby":[l,o,t["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:i,fieldProps:s,descriptionProps:{id:l},errorMessageProps:{id:o}}}const Sx=new WeakMap;function xSe(t){return typeof t=="string"?t.replace(/\s*/g,""):""+t}function IH(t,e){let n=Sx.get(t);if(!n)throw new Error("Unknown list");return`${n.id}-option-${xSe(e)}`}function wSe(t,e,n){let r=Hi(t,{labelable:!0}),{listProps:i}=FEe({...t,ref:n,selectionManager:e.selectionManager,collection:e.collection,disabledKeys:e.disabledKeys}),{focusWithinProps:s}=_x({onFocusWithin:t.onFocus,onBlurWithin:t.onBlur,onFocusWithinChange:t.onFocusChange}),l=ta(t.id);Sx.set(e,{id:l,shouldUseVirtualFocus:t.shouldUseVirtualFocus,shouldSelectOnPressUp:t.shouldSelectOnPressUp,shouldFocusOnHover:t.shouldFocusOnHover,isVirtualized:t.isVirtualized,onAction:t.onAction});let{labelProps:o,fieldProps:h}=W$({...t,id:l,labelElementType:"span"});return{labelProps:o,listBoxProps:Vn(r,s,e.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...Vn(h,i)})}}function TSe(t,e,n){let{key:r}=t,i=Sx.get(e);var s;let l=(s=t.isDisabled)!==null&&s!==void 0?s:e.disabledKeys.has(r);var o;let h=(o=t.isSelected)!==null&&o!==void 0?o:e.selectionManager.isSelected(r);var p;let b=(p=t.shouldSelectOnPressUp)!==null&&p!==void 0?p:i==null?void 0:i.shouldSelectOnPressUp;var x;let w=(x=t.shouldFocusOnHover)!==null&&x!==void 0?x:i==null?void 0:i.shouldFocusOnHover;var A;let L=(A=t.shouldUseVirtualFocus)!==null&&A!==void 0?A:i==null?void 0:i.shouldUseVirtualFocus;var M;let U=(M=t.isVirtualized)!==null&&M!==void 0?M:i==null?void 0:i.isVirtualized,D=by(),$=by(),N={role:"option","aria-disabled":l||void 0,"aria-selected":e.selectionManager.selectionMode!=="none"?h:void 0};if(i0()&&u2e()||(N["aria-label"]=t["aria-label"],N["aria-labelledby"]=D,N["aria-describedby"]=$),U){var B;let fe=Number((B=e.collection.getItem(r))===null||B===void 0?void 0:B.index);N["aria-posinset"]=Number.isNaN(fe)?void 0:fe+1,N["aria-setsize"]=Cj(e.collection)}let{itemProps:Z,isPressed:ie,isFocused:re,hasAction:ve,allowsSelection:Te}=DEe({selectionManager:e.selectionManager,key:r,ref:n,shouldSelectOnPressUp:b,allowsDifferentPressOrigin:b&&w,isVirtualized:U,shouldUseVirtualFocus:L,isDisabled:l,onAction:i!=null&&i.onAction?()=>{var fe;return i==null||(fe=i.onAction)===null||fe===void 0?void 0:fe.call(i,r)}:void 0}),{hoverProps:Ae}=Au({isDisabled:l||!w,onHoverStart(){wy()||(e.selectionManager.setFocused(!0),e.selectionManager.setFocusedKey(r))}});return{optionProps:{...N,...Vn(Z,Ae),id:IH(e,r)},labelProps:{id:D},descriptionProps:{id:$},isFocused:re,isFocusVisible:re&&wy(),isSelected:h,isDisabled:l,isPressed:ie,allowsSelection:Te,hasAction:ve}}function ESe(t){let{heading:e,"aria-label":n}=t,r=ta();return{itemProps:{role:"presentation"},headingProps:e?{id:r,"aria-hidden":!0}:{},groupProps:{role:"group","aria-label":n,"aria-labelledby":e?r:void 0}}}class SSe{shouldInvalidate(e,n){return e.width!==n.width||e.height!==n.height}validate(e){}getInitialLayoutInfo(e){return e}getFinalLayoutInfo(e){return e}}class pd{copy(){let e=new pd(this.type,this.key,this.rect.copy());return e.estimatedSize=this.estimatedSize,e.opacity=this.opacity,e.transform=this.transform,e.parentKey=this.parentKey,e.isSticky=this.isSticky,e.zIndex=this.zIndex,e.allowOverflow=this.allowOverflow,e}constructor(e,n,r){this.type=e,this.key=n,this.parentKey=null,this.rect=r,this.estimatedSize=!1,this.isSticky=!1,this.opacity=1,this.transform=null,this.zIndex=0,this.allowOverflow=!1}}class Ys{copy(){return new Ys(this.x,this.y)}equals(e){return this.x===e.x&&this.y===e.y}isOrigin(){return this.x===0&&this.y===0}constructor(e=0,n=0){this.x=e,this.y=n}}class Hr{get maxX(){return this.x+this.width}get maxY(){return this.y+this.height}get area(){return this.width*this.height}get topLeft(){return new Ys(this.x,this.y)}get topRight(){return new Ys(this.maxX,this.y)}get bottomLeft(){return new Ys(this.x,this.maxY)}get bottomRight(){return new Ys(this.maxX,this.maxY)}intersects(e){return this.x<=e.x+e.width&&e.x<=this.x+this.width&&this.y<=e.y+e.height&&e.y<=this.y+this.height}containsRect(e){return this.x<=e.x&&this.y<=e.y&&this.maxX>=e.maxX&&this.maxY>=e.maxY}containsPoint(e){return this.x<=e.x&&this.y<=e.y&&this.maxX>=e.x&&this.maxY>=e.y}getCornerInRect(e){for(let n of["topLeft","topRight","bottomLeft","bottomRight"])if(e.containsPoint(this[n]))return n;return null}equals(e){return e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height}pointEquals(e){return this.x===e.x&&this.y===e.y}sizeEquals(e){return this.width===e.width&&this.height===e.height}union(e){let n=Math.min(this.x,e.x),r=Math.min(this.y,e.y),i=Math.max(this.maxX,e.maxX)-n,s=Math.max(this.maxY,e.maxY)-r;return new Hr(n,r,i,s)}intersection(e){if(!this.intersects(e))return new Hr(0,0,0,0);let n=Math.max(this.x,e.x),r=Math.max(this.y,e.y);return new Hr(n,r,Math.min(this.maxX,e.maxX)-n,Math.min(this.maxY,e.maxY)-r)}copy(){return new Hr(this.x,this.y,this.width,this.height)}constructor(e=0,n=0,r=0,i=0){this.x=e,this.y=n,this.width=r,this.height=i}}class Hd{copy(){return new Hd(this.width,this.height)}equals(e){return this.width===e.width&&this.height===e.height}get area(){return this.width*this.height}constructor(e=0,n=0){this.width=e,this.height=n}}let ASe=0;class PSe{prepareForReuse(){this.content=null,this.rendered=null,this.layoutInfo=null}constructor(e){this.virtualizer=e,this.key=++ASe}}let nf=typeof window<"u"?window.performance:null,sN=nf&&(nf.now||nf.webkitNow||nf.msNow||nf.mozNow),UT=sN?sN.bind(nf):function(){return Date.now?Date.now():new Date().getTime()},VT;function CSe(t,e,n,r,i){let s=!1,l,o=new Promise(h=>{let p=UT(),b=e.x-t.x,x=e.y-t.y;l=requestAnimationFrame(function w(A){VT==null&&(VT=A>1e12!=UT()>1e12),VT&&(A=UT());let L=A-p;L>n?(i(e),h()):i(new Ys(t.x+b*r(L/n),t.y+x*r(L/n)))!==!1&&!s&&(l=requestAnimationFrame(w))})});return o.cancel=function(){s=!0,cancelAnimationFrame(l)},o}function LSe(t){return Math.sin(t*Math.PI/2)}function oN(t,e){let n=new Set;for(let r of t.keys())e.has(r)||n.add(r);return n}function ISe(t,e){let n=oN(t,e),r=oN(e,t),i=new Set;for(let s of t.keys())e.has(s)&&i.add(s);return{toRemove:n,toAdd:r,toUpdate:i}}function*RSe(...t){for(let e of t)yield*e}function MSe(t,e){if(t===e)return!0;if(t.size!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0}class c_{addSample(e){this.count++,this.value+=(e-this.value)/this.count}constructor(){$r(this,"count",0),$r(this,"value",0)}}class $Se{setVisibleRect(e){let n=performance.now()-this.startTime;n<500&&(this.averageTime.addSample(n),e.x!==this.visibleRect.x&&n>0&&(this.velocity.x=(e.x-this.visibleRect.x)/n),e.y!==this.visibleRect.y&&n>0&&(this.velocity.y=(e.y-this.visibleRect.y)/n)),this.startTime=performance.now(),this.visibleRect=e}collectMetrics(){let e=performance.now()-this.startTime;if(e<500&&this.averagePerf.addSample(e),this.visibleRect.height>0){let n=Math.abs(this.velocity.y*(this.averageTime.value+this.averagePerf.value));this.overscanY.addSample(n)}if(this.visibleRect.width>0){let n=Math.abs(this.velocity.x*(this.averageTime.value+this.averagePerf.value));this.overscanX.addSample(n)}}getOverscannedRect(){let e=this.visibleRect.copy(),n=Math.round(Math.min(this.visibleRect.height*2,this.overscanY.value)/100)*100;this.velocity.y>0?(e.y-=n*.2,e.height+=n+n*.2):(e.y-=n,e.height+=n+n*.2);let r=Math.round(Math.min(this.visibleRect.width*2,this.overscanX.value)/100)*100;return this.velocity.x>0?(e.x-=r*.2,e.width+=r+r*.2):(e.x-=r,e.width+=r+r*.2),e}constructor(){$r(this,"startTime",0),$r(this,"averagePerf",new c_),$r(this,"averageTime",new c_),$r(this,"velocity",new Ys(5,5)),$r(this,"overscanX",new c_),$r(this,"overscanY",new c_),$r(this,"visibleRect",new Hr)}}class kSe{constructor(){$r(this,"level",0),$r(this,"actions",[]),$r(this,"animated",!0),$r(this,"initialMap",new Map),$r(this,"finalMap",new Map),$r(this,"initialLayoutInfo",new Map),$r(this,"finalLayoutInfo",new Map),$r(this,"removed",new Map),$r(this,"toRemove",new Map)}}class OSe{_setContentSize(e){this._contentSize=e,this.delegate.setContentSize(e)}_setContentOffset(e){let n=new Hr(e.x,e.y,this._visibleRect.width,this._visibleRect.height);this.delegate.setVisibleRect(n)}get contentSize(){return this._contentSize}get visibleRect(){return this._visibleRect}set visibleRect(e){this._setVisibleRect(e)}_setVisibleRect(e,n=!1){let r=this._visibleRect;if(e.equals(r))return;this.shouldOverscan&&this._overscanManager.setVisibleRect(e);let i=this.layout&&this.layout.shouldInvalidate(e,this._visibleRect);this._resetAnimatedContentOffset(),this._visibleRect=e,i?this.relayout({offsetChanged:!e.pointEquals(r),sizeChanged:!e.sizeEquals(r)}):this.updateSubviews(n)}get collection(){return this._collection}set collection(e){this._setData(e)}_setData(e){e!==this._collection&&(this._collection?this._runTransaction(()=>{this._collection=e},this.transitionDuration>0):(this._collection=e,this.reloadData()))}reloadData(){this.relayout({contentChanged:!0})}getItem(e){return this._collection?this._collection.getItem(e):null}get persistedKeys(){return this._persistedKeys}set persistedKeys(e){MSe(e,this._persistedKeys)||(this._persistedKeys=e,this.updateSubviews())}isPersistedKey(e){if(this._persistedKeys.has(e))return!0;for(let n of this._persistedKeys)for(;n!=null;){let r=this.layout.getLayoutInfo(n);if(!r)break;if(n=r.parentKey,n===e)return!0}return!1}get layout(){return this._layout}set layout(e){this.setLayout(e)}setLayout(e,n=!1){if(e===this._layout)return;let r=()=>{this._layout&&(this._layout.virtualizer=null),e.virtualizer=this,this._layout=e};n?this._runTransaction(r):(r(),this.relayout())}_getReuseType(e,n){if(e.type==="item"&&n){let r=this.delegate.getType?this.delegate.getType(n):"item",i=r==="item"?"item":e.type+"_"+r;return{type:r,reuseType:i}}return{type:e.type,reuseType:e.type}}getReusableView(e){let n=this.getItem(e.key),{reuseType:r}=this._getReuseType(e,n);this._reusableViews[r]||(this._reusableViews[r]=[]);let i=this._reusableViews[r],s=i.length>0?i.pop():new PSe(this);return s.viewType=r,this._animatedContentOffset.isOrigin()||(e=e.copy(),e.rect.x+=this._animatedContentOffset.x,e.rect.y+=this._animatedContentOffset.y),s.layoutInfo=e,this._renderView(s),s}_renderView(e){let{type:n,key:r}=e.layoutInfo;e.content=this.getItem(r),e.rendered=this._renderContent(n,e.content)}_renderContent(e,n){let r=this._renderedContent.get(n);if(r!=null)return r;let i=this.delegate.renderView(e,n);return n&&this._renderedContent.set(n,i),i}get visibleViews(){return Array.from(this._visibleViews.values())}getView(e){return this._visibleViews.get(e)||null}getViewsOfType(e){return this.visibleViews.filter(n=>n.layoutInfo&&n.layoutInfo.type===e)}keyForView(e){return e&&e.layoutInfo?e.layoutInfo.key:null}keyAtPoint(e){let n=new Hr(e.x,e.y,1,1),r=this.layout.getVisibleLayoutInfos(n);for(let i of r)if(i.rect.intersects(n))return i.key;return null}willUnmount(){cancelAnimationFrame(this._relayoutRaf)}relayout(e={}){if(!(this._scrollAnimation||typeof requestAnimationFrame>"u")){if(this._invalidationContext){Object.assign(this._invalidationContext,e);return}this._invalidationContext=e,this._relayoutRaf=requestAnimationFrame(()=>{this._relayoutRaf=null,this.relayoutNow()})}}relayoutNow(e=this._invalidationContext||{}){if(this._relayoutRaf&&(cancelAnimationFrame(this._relayoutRaf),this._relayoutRaf=null,e={...this._invalidationContext,...e}),this._invalidationContext=null,!this.layout||!this._collection||this._scrollAnimation)return;let n=this._getScrollAnchor();typeof e.beforeLayout=="function"&&e.beforeLayout(),this.layout.validate(e),this._setContentSize(this.layout.getContentSize()),typeof e.afterLayout=="function"&&e.afterLayout();let r=this.getVisibleRect(),i=this._restoreScrollAnchor(n,e),s=e.contentChanged?0:i.x,l=e.contentChanged?0:i.y;s=Math.max(0,Math.min(this.contentSize.width-r.width,s)),l=Math.max(0,Math.min(this.contentSize.height-r.height,l));let o=!1;if(s!==r.x||l!==r.y?e.animated||!this._animatedContentOffset.isOrigin()?(this._animatedContentOffset.x+=r.x-s,this._animatedContentOffset.y+=r.y-l,o=this.updateSubviews(e.contentChanged)):this._setContentOffset(new Ys(s,l)):o=this.updateSubviews(e.contentChanged),e.transaction&&e.animated||this._applyLayoutInfos(),e.animated&&o){this._enableTransitions(),setTimeout(()=>{if(this._disableTransitions(),!this._animatedContentOffset.isOrigin()){let{x:p,y:b}=this.getVisibleRect();this._resetAnimatedContentOffset(),this._setContentOffset(new Ys(p,b))}typeof e.afterAnimation=="function"&&e.afterAnimation()},this.transitionDuration+100);return}else typeof e.afterAnimation=="function"&&e.afterAnimation()}_correctItemOrder(){if(!(this._isScrolling||this._transaction))for(let e of this._visibleLayoutInfos.keys()){let n=this._visibleViews.get(e);this._children.delete(n),this._children.add(n)}}_enableTransitions(){this.delegate.beginAnimations()}_disableTransitions(){this.delegate.endAnimations()}_getScrollAnchor(){if(!this.anchorScrollPosition)return null;let e=this.getVisibleRect();if(this.delegate.getScrollAnchor){let r=this.delegate.getScrollAnchor(e);if(r!=null){let i=this.layout.getLayoutInfo(r),s=i.rect.getCornerInRect(e);if(s){let l=i.key,o=i.rect[s].y-e.y;return{key:l,layoutInfo:i,corner:s,offset:o}}}}if(e.y===0&&!this.anchorScrollPositionAtTop)return null;let n=null;for(let[r,i]of this._visibleViews){let s=i.layoutInfo;if(s&&s.rect.area>0){let l=s.rect.getCornerInRect(e);if(l){let o=s.rect[l].y-e.y;(!n||o<n.offset)&&(n={key:r,layoutInfo:s,corner:l,offset:o})}}}return n}_restoreScrollAnchor(e,n){let r=this.getVisibleRect();if(e){var i;let s=!((i=n.transaction)===null||i===void 0)&&i.animated?n.transaction.finalMap.get(e.key):this.layout.getLayoutInfo(e.layoutInfo.key);if(s){let l=s.rect[e.corner].y-r.y-e.offset;r.y+=l}}return r}getVisibleRect(){let e=this.visibleRect,n=e.x-this._animatedContentOffset.x,r=e.y-this._animatedContentOffset.y;return new Hr(n,r,e.width,e.height)}getVisibleLayoutInfos(){let e=this.shouldOverscan?this._overscanManager.getOverscannedRect():this.getVisibleRect();return this._visibleLayoutInfos=this._getLayoutInfoMap(e),this._visibleLayoutInfos}_getLayoutInfoMap(e,n=!1){let r=this.layout.getVisibleLayoutInfos(e),i=new Map;for(let s of r)n&&(s=s.copy()),i.set(s.key,s);return i}updateSubviews(e=!1){if(!this._collection)return;let n=this.getVisibleLayoutInfos(),r=this._visibleViews,i,s,l;if(e)i=n,s=r,l=new Set;else{({toAdd:i,toRemove:s,toUpdate:l}=ISe(r,n));for(let p of l){let b=r.get(p);if(!b||!b.layoutInfo)continue;let x=this.getItem(n.get(p).key);if(b.content===x)l.delete(p);else{let{reuseType:w}=this._getReuseType(b.layoutInfo,x);b.viewType!==w&&(l.delete(p),i.add(p),s.add(p))}}if(i.size===0&&s.size===0&&l.size===0){this._transaction&&this._applyLayoutInfos();return}}let o=new Set;for(let p of s.keys()){let b=this._visibleViews.get(p);b&&(o.add(b),this._visibleViews.delete(p),this._transaction?this._transaction.toRemove.set(p,b):this.reuseView(b))}for(let p of i.keys()){let b=n.get(p),x;this._transaction&&(this._transaction.initialLayoutInfo.has(p)&&(b=this._transaction.initialLayoutInfo.get(p)),x=this._transaction.toRemove.get(p),x&&(this._transaction.toRemove.delete(p),this._applyLayoutInfo(x,b))),x||(x=this.getReusableView(b),o.has(x)||this._children.add(x)),this._visibleViews.set(p,x),o.delete(x)}for(let p of l){let b=r.get(p);this._renderedContent.delete(p),this._renderView(b)}this._transaction||this.removeViews(o),this._correctItemOrder(),this._flushVisibleViews();let h=this._transaction&&(i.size>0||s.size>0||this._hasLayoutUpdates());return h&&requestAnimationFrame(()=>{this._transaction&&requestAnimationFrame(()=>this._applyLayoutInfos())}),h}afterRender(){this.shouldOverscan&&this._overscanManager.collectMetrics()}_flushVisibleViews(){let e=new Map([[null,[]]]);for(let p of this._children){var n,r,i,s,l;((n=p.layoutInfo)===null||n===void 0?void 0:n.parentKey)!=null&&!e.has(p.layoutInfo.parentKey)&&e.set(p.layoutInfo.parentKey,[]),(r=e.get((i=p.layoutInfo)===null||i===void 0?void 0:i.parentKey))===null||r===void 0||r.push(p),e.has((s=p.layoutInfo)===null||s===void 0?void 0:s.key)||e.set((l=p.layoutInfo)===null||l===void 0?void 0:l.key,[])}let o=(p,b)=>b.map(x=>{let w=e.get(x.layoutInfo.key);return this.delegate.renderWrapper(p,x,w,A=>o(x,A))}),h=o(null,e.get(null));this.delegate.setVisibleViews(h)}_applyLayoutInfo(e,n){return e.layoutInfo===n?!1:(e.layoutInfo=n,!0)}_applyLayoutInfos(){let e=!1;for(let n of this._visibleViews.values()){let r=n.layoutInfo;if((r==null?void 0:r.key)!=null){let i=this.layout.getLayoutInfo(r.key);this._applyLayoutInfo(n,i)&&(e=!0)}}if(this._transaction){for(let n of this._transaction.toRemove.values()){let r=n.layoutInfo;if((r==null?void 0:r.key)!=null){let i=this.layout.getLayoutInfo(r.key);this._applyLayoutInfo(n,i)&&(e=!0)}}for(let n of this._transaction.removed.values()){let r=n.layoutInfo,i=this._transaction.finalLayoutInfo.get(r.key)||r;i=this.layout.getFinalLayoutInfo(i.copy()),this._applyLayoutInfo(n,i)&&(e=!0)}}e&&this._flushVisibleViews()}_hasLayoutUpdates(){if(!this._transaction)return!1;for(let e of this._visibleViews.values()){let n=e.layoutInfo;if(!n)return!0;let r=this.layout.getLayoutInfo(n.key);if(!n.rect.equals(r.rect)||n.opacity!==r.opacity||n.transform!==r.transform)return!0}return!1}reuseView(e){e.prepareForReuse(),this._reusableViews[e.viewType].push(e)}removeViews(e){for(let n of e)this._children.delete(n)}updateItemSize(e,n){if(!this.layout.updateItemSize)return;if(this._scrollAnimation){this._sizeUpdateQueue.set(e,n);return}this.layout.updateItemSize(e,n)&&this.relayout()}startScrolling(){this._isScrolling=!0}endScrolling(){this._isScrolling=!1,this._correctItemOrder(),this._flushVisibleViews()}_resetAnimatedContentOffset(){this._animatedContentOffset.isOrigin()||(this._animatedContentOffset=new Ys(0,0),this._applyLayoutInfos())}scrollToItem(e,n){if(e==null)return;let r=this.layout.getLayoutInfo(e);if(!r)return;let{duration:i=300,shouldScrollX:s=!0,shouldScrollY:l=!0,offsetX:o=0,offsetY:h=0}=n,p=this.visibleRect.x,b=this.visibleRect.y,x=r.rect.x-o,w=r.rect.y-h,A=p+this.visibleRect.width,L=b+this.visibleRect.height;return s&&(x<=p||A===0?p=x:r.rect.maxX>A&&(p+=r.rect.maxX-A)),l&&(w<=b||L===0?b=w:r.rect.maxY>L&&(b+=r.rect.maxY-L)),this.scrollTo(new Ys(p,b),i)}scrollTo(e,n=300){return this._scrollAnimation&&(this._scrollAnimation.cancel(),this._scrollAnimation=null),n<=0||this.visibleRect.pointEquals(e)?(this._setContentOffset(e),Promise.resolve()):(this.startScrolling(),this._scrollAnimation=CSe(this.visibleRect,e,n,LSe,r=>{this._setContentOffset(r)}),this._scrollAnimation.then(()=>{this._scrollAnimation=null;for(let[r,i]of this._sizeUpdateQueue)this.updateItemSize(r,i);this._sizeUpdateQueue.clear(),this.relayout(),this._processTransactionQueue(),this.endScrolling()}),this._scrollAnimation)}_runTransaction(e,n){this._startTransaction(),this._nextTransaction&&this._nextTransaction.actions.push(e),this._endTransaction(n)}_startTransaction(){this._nextTransaction||(this._nextTransaction=new kSe),this._nextTransaction.level++}_endTransaction(e){return!this._nextTransaction||(e!=null&&(this._nextTransaction.animated=e),--this._nextTransaction.level>0)?!1:this._nextTransaction.actions.length===0?(this._nextTransaction=null,!1):(this._nextTransaction.animated==null&&(this._nextTransaction.animated=!0),this._transactionQueue.push(this._nextTransaction),this._nextTransaction=null,this._processTransactionQueue(),!0)}_processTransactionQueue(){if(this._transaction||this._scrollAnimation)return;let e=this._transactionQueue.shift();e&&this._performTransaction(e)}_getContentRect(){return new Hr(0,0,this.contentSize.width,this.contentSize.height)}_performTransaction(e){this._transaction=e,this.relayoutNow({transaction:e,animated:e.animated,beforeLayout:()=>{e.animated&&(e.initialMap=this._getLayoutInfoMap(this._getContentRect(),!0));for(let n of e.actions)n()},afterLayout:()=>{e.animated?(e.finalMap=this._getLayoutInfoMap(this._getContentRect()),this._setupTransactionAnimations(e)):this._transaction=null},afterAnimation:()=>{if(e.toRemove.size>0||e.removed.size>0)for(let n of RSe(e.toRemove.values(),e.removed.values()))this._children.delete(n),this.reuseView(n);this._transaction=null,this._correctItemOrder(),this._flushVisibleViews(),this._processTransactionQueue()}})}_setupTransactionAnimations(e){let{initialMap:n,finalMap:r}=e;for(let[i,s]of n)r.has(i)?e.initialLayoutInfo.set(i,s):e.finalLayoutInfo.set(s.key,s);for(let[i,s]of r)if(!n.has(i)){let l=this.layout.getInitialLayoutInfo(s.copy());e.initialLayoutInfo.set(i,l)}for(let[i,s]of this._visibleViews)!r.has(i)&&s.layoutInfo.rect.width>0&&(e.removed.set(i,s),this._visibleViews.delete(i),s.layoutInfo&&(e.finalLayoutInfo.has(s.layoutInfo.key)||e.finalLayoutInfo.set(s.layoutInfo.key,s.layoutInfo)))}constructor(e={}){this._contentSize=new Hd,this._visibleRect=new Hr,this._reusableViews={},this._visibleLayoutInfos=new Map,this._visibleViews=new Map,this._renderedContent=new WeakMap,this._children=new Set,this._invalidationContext=null,this._overscanManager=new $Se,this._persistedKeys=new Set,this._scrollAnimation=null,this._isScrolling=!1,this._sizeUpdateQueue=new Map,this._animatedContentOffset=new Ys(0,0),this._transaction=null,this._nextTransaction=null,this._transactionQueue=[];var n;this.transitionDuration=(n=e.transitionDuration)!==null&&n!==void 0?n:500,this.anchorScrollPosition=e.anchorScrollPosition||!1,this.anchorScrollPositionAtTop=e.anchorScrollPositionAtTop||!1,this.shouldOverscan=e.shouldOverscan!==!1;for(let r of["delegate","size","layout","collection"])e[r]&&(this[r]=e[r])}}function DSe(t){let[e,n]=te.useState([]),[r,i]=te.useState(new Hd),[s,l]=te.useState(!1),[o,h]=te.useState(!1),p=te.useMemo(()=>new OSe,[]);p.delegate={setVisibleViews:n,setVisibleRect(L){p.visibleRect=L,t.onVisibleRectChange(L)},setContentSize:i,renderView:t.renderView,renderWrapper:t.renderWrapper,beginAnimations:()=>l(!0),endAnimations:()=>l(!1),getScrollAnchor:t.getScrollAnchor},p.layout=t.layout,p.collection=t.collection,p.transitionDuration=t.transitionDuration,Ar(()=>{p.afterRender()}),te.useEffect(()=>()=>p.willUnmount(),[]);let b=te.useCallback(L=>{p.visibleRect=L},[p]),x=te.useCallback(()=>{p.startScrolling(),h(!0)},[p]),w=te.useCallback(()=>{p.endScrolling(),h(!1)},[p]);return te.useMemo(()=>({virtualizer:p,visibleViews:e,setVisibleRect:b,contentSize:r,isAnimating:s,isScrolling:o,startScrolling:x,endScrolling:w}),[p,e,b,r,s,o,x,w])}const aN=48;class FSe extends SSe{getLayoutInfo(e){let n=this.layoutInfos.get(e);return!n&&this.validRect.area<this.contentSize.area&&this.lastCollection&&(this.lastValidRect=this.validRect,this.validRect=new Hr(0,0,1/0,1/0),this.rootNodes=this.buildCollection(),this.validRect=new Hr(0,0,this.contentSize.width,this.contentSize.height),n=this.layoutInfos.get(e)),n}getVisibleLayoutInfos(e){!this.validRect.containsRect(e)&&this.lastCollection&&(this.lastValidRect=this.validRect,this.validRect=this.validRect.union(e),this.rootNodes=this.buildCollection());let n=[],r=i=>{for(let s of i)this.isVisible(s,e)&&(n.push(s.layoutInfo),s.header&&n.push(s.header),s.children&&r(s.children))};return r(this.rootNodes),n}isVisible(e,n){return e.layoutInfo.rect.intersects(n)||e.layoutInfo.isSticky||this.virtualizer.isPersistedKey(e.layoutInfo.key)}shouldInvalidateEverything(e){return e.sizeChanged}validate(e){if(this.collection=this.virtualizer.collection,this.invalidateEverything=this.shouldInvalidateEverything(e),this.invalidateEverything&&(this.lastValidRect=this.validRect,this.validRect=this.virtualizer.getVisibleRect()),this.rootNodes=this.buildCollection(),this.lastCollection&&this.collection!==this.lastCollection){for(let r of this.lastCollection.getKeys())if(!this.collection.getItem(r)){let i=this.layoutNodes.get(r);if(i){var n;this.layoutInfos.delete(i.layoutInfo.key),this.layoutInfos.delete((n=i.header)===null||n===void 0?void 0:n.key),this.layoutNodes.delete(r)}}}this.lastWidth=this.virtualizer.visibleRect.width,this.lastCollection=this.collection,this.invalidateEverything=!1}buildCollection(){let e=this.padding,n=0,r=[];for(let o of this.collection){var i;let h=(i=this.rowHeight)!==null&&i!==void 0?i:this.estimatedRowHeight;if(o.type==="item"&&e+h<this.validRect.y&&!this.isValid(o,e)){e+=h,n++;continue}let p=this.buildChild(o,0,e);if(e=p.layoutInfo.rect.maxY,r.push(p),o.type==="item"&&e>this.validRect.maxY){e+=(this.collection.size-(r.length+n))*h;break}}if(this.isLoading){var s;let o=new Hr(0,e,this.virtualizer.visibleRect.width,(s=this.loaderHeight)!==null&&s!==void 0?s:this.virtualizer.visibleRect.height),h=new pd("loader","loader",o);this.layoutInfos.set("loader",h),r.push({layoutInfo:h}),e=h.rect.maxY}if(r.length===0){var l;let o=new Hr(0,e,this.virtualizer.visibleRect.width,(l=this.placeholderHeight)!==null&&l!==void 0?l:this.virtualizer.visibleRect.height),h=new pd("placeholder","placeholder",o);this.layoutInfos.set("placeholder",h),r.push({layoutInfo:h}),e=h.rect.maxY}return this.contentSize=new Hd(this.virtualizer.visibleRect.width,e+this.padding),r}isValid(e,n){let r=this.layoutNodes.get(e.key);return!this.invalidateEverything&&r&&r.node===e&&n===(r.header||r.layoutInfo).rect.y&&r.layoutInfo.rect.intersects(this.lastValidRect)&&r.validRect.containsRect(r.layoutInfo.rect.intersection(this.validRect))}buildChild(e,n,r){if(this.isValid(e,r))return this.layoutNodes.get(e.key);let i=this.buildNode(e,n,r);i.node=e;var s;return i.layoutInfo.parentKey=(s=e.parentKey)!==null&&s!==void 0?s:null,this.layoutInfos.set(i.layoutInfo.key,i.layoutInfo),i.header&&this.layoutInfos.set(i.header.key,i.header),this.layoutNodes.set(e.key,i),i}buildNode(e,n,r){switch(e.type){case"section":return this.buildSection(e,n,r);case"item":return this.buildItem(e,n,r)}}buildSection(e,n,r){let i=this.virtualizer.visibleRect.width,s=this.headingHeight,l=!1;if(s==null){let M=this.layoutNodes.get(e.key);if(M&&M.header){let U=this.collection.getItem(e.key),D=this.lastCollection?this.lastCollection.getItem(e.key):null;s=M.header.rect.height,l=i!==this.lastWidth||U!==D||M.header.estimatedSize}else s=e.rendered?this.estimatedHeadingHeight:0,l=!0}s==null&&(s=aN);let o=new Hr(0,r,i,s),h=new pd("header",e.key+":header",o);h.estimatedSize=l,h.parentKey=e.key,r+=h.rect.height;let p=new Hr(0,r,i,0),b=new pd(e.type,e.key,p),x=r,w=0,A=[];for(let M of dp(e,this.collection)){var L;let U=(L=this.rowHeight)!==null&&L!==void 0?L:this.estimatedRowHeight;if(r+U<this.validRect.y&&!this.isValid(e,r)){r+=U,w++;continue}let D=this.buildChild(M,n,r);if(r=D.layoutInfo.rect.maxY,A.push(D),r>this.validRect.maxY){r+=([...dp(e,this.collection)].length-(A.length+w))*U;break}}return p.height=r-x,{header:h,layoutInfo:b,children:A,validRect:b.rect.intersection(this.validRect)}}buildItem(e,n,r){let i=this.virtualizer.visibleRect.width,s=this.rowHeight,l=!1;if(s==null){let p=this.layoutNodes.get(e.key);p?(s=p.layoutInfo.rect.height,l=i!==this.lastWidth||e!==p.node||p.layoutInfo.estimatedSize):(s=this.estimatedRowHeight,l=!0)}s==null&&(s=aN),typeof this.indentationForItem=="function"&&(n+=this.indentationForItem(this.collection,e.key)||0);let o=new Hr(n,r,i-n,s),h=new pd(e.type,e.key,o);return h.allowOverflow=!0,h.estimatedSize=l,{layoutInfo:h,validRect:h.rect}}updateItemSize(e,n){let r=this.layoutInfos.get(e);if(!r)return!1;if(r.estimatedSize=!1,r.rect.height!==n.height){let i=r.copy();i.rect.height=n.height,this.layoutInfos.set(e,i),this.updateLayoutNode(e,r,i);let s=this.collection.getItem(r.parentKey);for(;s;)this.updateLayoutNode(s.key,r,i),s=this.collection.getItem(s.parentKey);return!0}return!1}updateLayoutNode(e,n,r){let i=this.layoutNodes.get(e);i&&(i.validRect=new Hr,i.header===n?i.header=r:i.layoutInfo===n&&(i.layoutInfo=r))}getContentSize(){return this.contentSize}getKeyAbove(e){let n=this.collection;for(e=n.getKeyBefore(e);e!=null;){let r=n.getItem(e);if(r.type==="item"&&(this.allowDisabledKeyFocus||!this.disabledKeys.has(r.key)))return e;e=n.getKeyBefore(e)}}getKeyBelow(e){let n=this.collection;for(e=n.getKeyAfter(e);e!=null;){let r=n.getItem(e);if(r.type==="item"&&(this.allowDisabledKeyFocus||!this.disabledKeys.has(r.key)))return e;e=n.getKeyAfter(e)}}getKeyPageAbove(e){let n=this.getLayoutInfo(e);if(n){let r=Math.max(0,n.rect.y+n.rect.height-this.virtualizer.visibleRect.height);for(;n&&n.rect.y>r;){let i=this.getKeyAbove(n.key);n=this.getLayoutInfo(i)}if(n)return n.key}return this.getFirstKey()}getKeyPageBelow(e){let n=this.getLayoutInfo(e??this.getFirstKey());if(n){let r=Math.min(this.virtualizer.contentSize.height,n.rect.y-n.rect.height+this.virtualizer.visibleRect.height);for(;n&&n.rect.y<r;){let i=this.getKeyBelow(n.key);n=this.getLayoutInfo(i)}if(n)return n.key}return this.getLastKey()}getFirstKey(){let e=this.collection,n=e.getFirstKey();for(;n!=null;){let r=e.getItem(n);if(r.type==="item"&&(this.allowDisabledKeyFocus||!this.disabledKeys.has(r.key)))return n;n=e.getKeyAfter(n)}}getLastKey(){let e=this.collection,n=e.getLastKey();for(;n!=null;){let r=e.getItem(n);if(r.type==="item"&&(this.allowDisabledKeyFocus||!this.disabledKeys.has(r.key)))return n;n=e.getKeyBefore(n)}}getKeyForSearch(e,n){if(!this.collator)return null;let r=this.collection,i=n||this.getFirstKey();for(;i!=null;){let s=r.getItem(i),l=s.textValue.slice(0,e.length);if(s.textValue&&this.collator.compare(l,e)===0)return i;i=this.getKeyBelow(i)}return null}getInitialLayoutInfo(e){return e.opacity=0,e.transform="scale3d(0.8, 0.8, 0.8)",e}getFinalLayoutInfo(e){return e.opacity=0,e.transform="scale3d(0.8, 0.8, 0.8)",e}getDropTargetFromPoint(e,n,r){e+=this.virtualizer.visibleRect.x,n+=this.virtualizer.visibleRect.y;let i=this.virtualizer.keyAtPoint(new Ys(e,n));if(i==null||this.collection.size===0)return{type:"root"};let s=this.getLayoutInfo(i),l=s.rect,o={type:"item",key:s.key,dropPosition:"on"};return r(o)?n<=l.y+10&&r({...o,dropPosition:"before"})?o.dropPosition="before":n>=l.maxY-10&&r({...o,dropPosition:"after"})&&(o.dropPosition="after"):n<=l.y+l.height/2&&r({...o,dropPosition:"before"})?o.dropPosition="before":r({...o,dropPosition:"after"})&&(o.dropPosition="after"),o}constructor(e={}){super(),$r(this,"disabledKeys",new Set),$r(this,"allowDisabledKeyFocus",!1),this.rowHeight=e.rowHeight,this.estimatedRowHeight=e.estimatedRowHeight,this.headingHeight=e.headingHeight,this.estimatedHeadingHeight=e.estimatedHeadingHeight,this.padding=e.padding||0,this.indentationForItem=e.indentationForItem,this.collator=e.collator,this.loaderHeight=e.loaderHeight,this.placeholderHeight=e.placeholderHeight,this.layoutInfos=new Map,this.layoutNodes=new Map,this.rootNodes=[],this.lastWidth=0,this.lastCollection=null,this.allowDisabledKeyFocus=e.allowDisabledKeyFocus,this.lastValidRect=new Hr,this.validRect=new Hr,this.contentSize=new Hd}}function NSe(t){let{value:e=0,minValue:n=0,maxValue:r=100,valueLabel:i,isIndeterminate:s,formatOptions:l={style:"percent"}}=t,o=Hi(t,{labelable:!0}),{labelProps:h,fieldProps:p}=W$({...t,labelElementType:"span"});e=_y(e,n,r);let b=(e-n)/(r-n),x=A2e(l);if(!s&&!i){let w=l.style==="percent"?b:e;i=x.format(w)}return{progressBarProps:Vn(o,{...p,"aria-valuenow":s?void 0:e,"aria-valuemin":n,"aria-valuemax":r,"aria-valuetext":s?void 0:i,role:"progressbar"}),labelProps:h}}function Dl(t){return t&&t.__esModule?t.default:t}function ar(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var so={};ar(so,"spectrum-BarLoader",()=>TC,t=>TC=t);ar(so,"spectrum-BarLoader--indeterminate",()=>EC,t=>EC=t);ar(so,"spectrum-BarLoader--sideLabel",()=>SC,t=>SC=t);ar(so,"spectrum-BarLoader-track",()=>AC,t=>AC=t);ar(so,"spectrum-BarLoader-fill",()=>PC,t=>PC=t);ar(so,"spectrum-BarLoader-label",()=>CC,t=>CC=t);ar(so,"spectrum-BarLoader-percentage",()=>LC,t=>LC=t);ar(so,"spectrum-BarLoader--small",()=>IC,t=>IC=t);ar(so,"indeterminate-loop-ltr",()=>RC,t=>RC=t);ar(so,"indeterminate-loop-rtl",()=>MC,t=>MC=t);ar(so,"spectrum-BarLoader--overBackground",()=>$C,t=>$C=t);ar(so,"is-positive",()=>kC,t=>kC=t);ar(so,"is-warning",()=>OC,t=>OC=t);ar(so,"is-critical",()=>DC,t=>DC=t);var TC,EC,SC,AC,PC,CC,LC,IC,RC,MC,$C,kC,OC,DC;TC="spectrum-BarLoader_48541f";EC="spectrum-BarLoader--indeterminate_48541f";SC="spectrum-BarLoader--sideLabel_48541f";AC="spectrum-BarLoader-track_48541f";PC="spectrum-BarLoader-fill_48541f";CC="spectrum-BarLoader-label_48541f";LC="spectrum-BarLoader-percentage_48541f";IC="spectrum-BarLoader--small_48541f";RC="indeterminate-loop-ltr_48541f";MC="indeterminate-loop-rtl_48541f";$C="spectrum-BarLoader--overBackground_48541f";kC="is-positive_48541f";OC="is-warning_48541f";DC="is-critical_48541f";var kr={};ar(kr,"spectrum-CircleLoader--indeterminate-fill-submask-2",()=>FC,t=>FC=t);ar(kr,"spectrum-fill-mask-2",()=>NC,t=>NC=t);ar(kr,"spectrum-CircleLoader",()=>zC,t=>zC=t);ar(kr,"spectrum-CircleLoader-track",()=>BC,t=>BC=t);ar(kr,"spectrum-CircleLoader-fills",()=>UC,t=>UC=t);ar(kr,"spectrum-CircleLoader-fill",()=>VC,t=>VC=t);ar(kr,"spectrum-CircleLoader-fillMask1",()=>jC,t=>jC=t);ar(kr,"spectrum-CircleLoader-fillMask2",()=>GC,t=>GC=t);ar(kr,"spectrum-CircleLoader-fillSubMask1",()=>WC,t=>WC=t);ar(kr,"spectrum-CircleLoader-fillSubMask2",()=>HC,t=>HC=t);ar(kr,"spectrum-CircleLoader--small",()=>qC,t=>qC=t);ar(kr,"spectrum-CircleLoader--large",()=>KC,t=>KC=t);ar(kr,"spectrum-CircleLoader--indeterminate",()=>XC,t=>XC=t);ar(kr,"spectrum-fills-rotate",()=>ZC,t=>ZC=t);ar(kr,"spectrum-fill-mask-1",()=>YC,t=>YC=t);ar(kr,"spectrum-CircleLoader--overBackground",()=>JC,t=>JC=t);var FC,NC,zC,BC,UC,VC,jC,GC,WC,HC,qC,KC,XC,ZC,YC,JC;FC="spectrum-CircleLoader--indeterminate-fill-submask-2_7c1153";NC="spectrum-fill-mask-2_7c1153";zC="spectrum-CircleLoader_7c1153";BC="spectrum-CircleLoader-track_7c1153";UC="spectrum-CircleLoader-fills_7c1153";VC="spectrum-CircleLoader-fill_7c1153";jC="spectrum-CircleLoader-fillMask1_7c1153";GC="spectrum-CircleLoader-fillMask2_7c1153";WC="spectrum-CircleLoader-fillSubMask1_7c1153";HC="spectrum-CircleLoader-fillSubMask2_7c1153";qC="spectrum-CircleLoader--small_7c1153";KC="spectrum-CircleLoader--large_7c1153";XC="spectrum-CircleLoader--indeterminate_7c1153";ZC="spectrum-fills-rotate_7c1153";YC="spectrum-fill-mask-1_7c1153";JC="spectrum-CircleLoader--overBackground_7c1153";function zSe(t,e){let{value:n=0,minValue:r=0,maxValue:i=100,size:s="M",variant:l,isIndeterminate:o=!1,"aria-label":h,"aria-labelledby":p,...b}=t,x=io(e),{styleProps:w}=mi(b);n=_y(n,r,i);let{progressBarProps:A}=NSe({...t,value:n}),L={},M={};if(!o){let U=(n-r)/(i-r)*100,D;U>0&&U<=50?(D=-180+U/50*180,L.transform=`rotate(${D}deg)`,M.transform="rotate(-180deg)"):U>50&&(D=-180+(U-50)/50*180,L.transform="rotate(0deg)",M.transform=`rotate(${D}deg)`)}return!h&&!p&&console.warn("ProgressCircle requires an aria-label or aria-labelledby attribute for accessibility"),le.createElement("div",{...w,...A,ref:x,className:ct(Dl(kr),"spectrum-CircleLoader",{"spectrum-CircleLoader--indeterminate":o,"spectrum-CircleLoader--small":s==="S","spectrum-CircleLoader--large":s==="L","spectrum-CircleLoader--overBackground":l==="overBackground"},w.className)},le.createElement("div",{className:ct(Dl(kr),"spectrum-CircleLoader-track")}),le.createElement("div",{className:ct(Dl(kr),"spectrum-CircleLoader-fills")},le.createElement("div",{className:ct(Dl(kr),"spectrum-CircleLoader-fillMask1")},le.createElement("div",{className:ct(Dl(kr),"spectrum-CircleLoader-fillSubMask1"),"data-testid":"fillSubMask1",style:L},le.createElement("div",{className:ct(Dl(kr),"spectrum-CircleLoader-fill")}))),le.createElement("div",{className:ct(Dl(kr),"spectrum-CircleLoader-fillMask2")},le.createElement("div",{className:ct(Dl(kr),"spectrum-CircleLoader-fillSubMask2"),"data-testid":"fillSubMask2",style:M},le.createElement("div",{className:ct(Dl(kr),"spectrum-CircleLoader-fill")})))))}let H$=le.forwardRef(zSe),Xh=null;function BSe(t=!1){if(Xh===null||t){const e=document.createElement("div"),n=e.style;n.width="50px",n.height="50px",n.overflow="scroll",n.direction="rtl";const r=document.createElement("div"),i=r.style;return i.width="100px",i.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?Xh="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?Xh="negative":Xh="positive-ascending"),document.body.removeChild(e),Xh}return Xh}function USe(t,e){let{scrollLeft:n}=t;if(e==="rtl"){let{scrollWidth:r,clientWidth:i}=t;switch(BSe()){case"negative":n=-n;break;case"positive-descending":n=r-i-n;break}}return n}function VSe(t,e){let{contentSize:n,onVisibleRectChange:r,children:i,innerStyle:s,sizeToFit:l,onScrollStart:o,onScrollEnd:h,scrollDirection:p="both",...b}=t,x=te.useRef();e=e||x;let w=te.useRef({scrollTop:0,scrollLeft:0,scrollEndTime:0,scrollTimeout:null,width:0,height:0,isScrolling:!1}).current,{direction:A}=Ra(),[L,M]=te.useState(!1),U=te.useCallback(N=>{N.target===N.currentTarget&&(t.onScroll&&t.onScroll(N),Ad.flushSync(()=>{let B=N.currentTarget.scrollTop,Z=USe(N.currentTarget,A);w.scrollTop=Math.max(0,Math.min(B,n.height-w.height)),w.scrollLeft=Math.max(0,Math.min(Z,n.width-w.width)),r(new Hr(w.scrollLeft,w.scrollTop,w.width,w.height)),w.isScrolling||(w.isScrolling=!0,M(!0),o&&o());let ie=Date.now();w.scrollEndTime<=ie+50&&(w.scrollEndTime=ie+300,clearTimeout(w.scrollTimeout),w.scrollTimeout=setTimeout(()=>{w.isScrolling=!1,M(!1),w.scrollTimeout=null,h&&h()},300))}))},[t,A,w,n,r,o,h]);te.useEffect(()=>()=>{clearTimeout(w.scrollTimeout)},[]);let D=te.useCallback(()=>{let N=e.current;if(!N)return;let B=N.clientWidth,Z=N.clientHeight;l&&n.width>0&&n.height>0&&(l==="width"?B=Math.min(B,n.width):l==="height"&&(Z=Math.min(Z,n.height))),(w.width!==B||w.height!==Z)&&(w.width=B,w.height=Z,r(new Hr(w.scrollLeft,w.scrollTop,B,Z)))},[r,e,w,l,n]);Ar(()=>{D()},[D]),P$({ref:e,onResize:D});let $={padding:0,...b.style};return p==="horizontal"?($.overflowX="auto",$.overflowY="hidden"):p==="vertical"?($.overflowY="auto",$.overflowX="hidden"):$.overflow="auto",le.createElement("div",{...b,style:$,ref:e,onScroll:U},le.createElement("div",{role:"presentation",style:{width:n.width,height:n.height,pointerEvents:L?"none":"auto",position:"relative",...s}},i))}const jSe=le.forwardRef(VSe);function RH(t){let{reusableView:{layoutInfo:e,virtualizer:n},ref:r}=t,i=te.useCallback(()=>{let s=GSe(r.current);n.updateItemSize(e.key,s)},[n,e.key,r]);return Ar(()=>{e.estimatedSize&&i()}),{updateSize:i}}function GSe(t){let e=t.style.height;t.style.height="";let n=new Hd(t.scrollWidth,t.scrollHeight);return t.style.height=e,n}function MH(t){let{className:e,reusableView:n,parent:r}=t,{direction:i}=Ra(),s=te.useRef();return RH({reusableView:n,ref:s}),le.createElement("div",{role:"presentation",ref:s,className:e,style:QC(n.layoutInfo,i,r&&r.layoutInfo)},n.rendered)}let lN=new WeakMap;function QC(t,e,n){let r=e==="rtl"?"right":"left",i=lN.get(t);if(i&&i[r]!=null){if(!n)return i;let l=t.rect.y-n.rect.y,o=t.rect.x-n.rect.x;if(i.top===l&&i[r]===o)return i}let s={position:t.isSticky?"sticky":"absolute",display:t.isSticky?"inline-block":void 0,overflow:t.allowOverflow?"visible":"hidden",top:t.rect.y-(n?n.rect.y:0),[r]:t.rect.x-(n?n.rect.x:0),transition:"all",WebkitTransition:"all",WebkitTransitionDuration:"inherit",transitionDuration:"inherit",width:t.rect.width,height:t.rect.height,opacity:t.opacity,zIndex:t.zIndex,transform:t.transform,contain:"size layout style"};return lN.set(t,s),s}function WSe(t,e){let{children:n,renderWrapper:r,layout:i,collection:s,sizeToFit:l,scrollDirection:o,transitionDuration:h,isLoading:p,onLoadMore:b,focusedKey:x,shouldUseVirtualFocus:w,scrollToItem:A,...L}=t,M=te.useRef();e=e||M;let U=DSe({transitionDuration:h,layout:i,collection:s,renderView:n,renderWrapper:r||KSe,onVisibleRectChange(N){e.current.scrollLeft=N.x,e.current.scrollTop=N.y}}),{virtualizerProps:D}=HSe(t,U,e),$=te.useCallback(N=>{if(U.setVisibleRect(N),!p&&b){let B=U.virtualizer.contentSize.height-N.height*2;N.y>B&&b()}},[p,b,U]);return Ar(()=>{!p&&b&&!U.isAnimating&&U.contentSize.height>0&&U.contentSize.height<=U.virtualizer.visibleRect.height&&b()},[U.contentSize,U.isAnimating,U.virtualizer,b,p]),le.createElement(jSe,{...Vn(L,D),ref:e,innerStyle:U.isAnimating?{transition:`none ${U.virtualizer.transitionDuration}ms`}:void 0,contentSize:U.contentSize,onVisibleRectChange:$,onScrollStart:U.startScrolling,onScrollEnd:U.endScrolling,sizeToFit:l,scrollDirection:o},U.visibleViews)}function HSe(t,e,n){let{focusedKey:r,scrollToItem:i,shouldUseVirtualFocus:s}=t,{virtualizer:l}=e,o=te.useRef(null),h=te.useRef(!1);te.useEffect(()=>{if(l.visibleRect.height===0)return;let A=Qb();r!==o.current&&(A!=="pointer"||!h.current)&&(i?i(r):(l.scrollToItem(r,{duration:0}),A==="keyboard"&&n.current.contains(document.activeElement)&&$j(document.activeElement,{containingElement:n.current}))),o.current=r},[r,l.visibleRect.height,l,o,i,n]),l.persistedKeys=te.useMemo(()=>r?new Set([r]):new Set,[r]);let p=te.useCallback(A=>{let L=Qb();!h.current&&n.current.contains(A.target)&&L!=="pointer"&&(i?i(r):l.scrollToItem(r,{duration:0})),h.current=A.target!==n.current},[n,l,r,i]),b=te.useCallback(A=>{h.current=n.current.contains(A.relatedTarget)},[n]),x=l.getView(r);te.useEffect(()=>{r&&!x&&h.current&&document.activeElement!==n.current&&Hl(n.current)});let w;return s||(w=x?-1:0,l.collection.size===0&&t.tabIndex!=null&&(w=t.tabIndex)),{virtualizerProps:{tabIndex:w,onFocus:p,onBlur:b}}}const qSe=le.forwardRef(WSe);function KSe(t,e){return le.createElement(MH,{key:e.key,reusableView:e,parent:t})}function wo(t){return t&&t.__esModule?t.default:t}function jr(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var $H={},kH={};kH={loading:" ...",loadingMore:"  ..."};var OH={};OH={loading:"...",loadingMore:"  ..."};var DH={};DH={loading:"Natn...",loadingMore:"Natn dalch..."};var FH={};FH={loading:"Indlser ...",loadingMore:"Indlser flere ..."};var NH={};NH={loading:"Laden...",loadingMore:"Mehr laden ..."};var zH={};zH={loading:"...",loadingMore:" ..."};var BH={};BH={loading:"Loading",loadingMore:"Loading more"};var UH={};UH={loading:"Cargando",loadingMore:"Cargando ms"};var VH={};VH={loading:"Laadimine...",loadingMore:"Laadi rohkem..."};var jH={};jH={loading:"Ladataan",loadingMore:"Ladataan lis"};var GH={};GH={loading:"Chargement...",loadingMore:"Chargement supplmentaire..."};var WH={};WH={loading:"...",loadingMore:" ..."};var HH={};HH={loading:"Uitavam...",loadingMore:"Uitavam jo..."};var qH={};qH={loading:"Betlts folyamatban",loadingMore:"Tovbbiak betltse folyamatban"};var KH={};KH={loading:"Caricamento...",loadingMore:"Caricamento altri..."};var XH={};XH={loading:"...",loadingMore:"..."};var ZH={};ZH={loading:" ",loadingMore:"  "};var YH={};YH={loading:"keliama...",loadingMore:"keliama daugiau..."};var JH={};JH={loading:"Notiek ielde...",loadingMore:"Tiek ieldts vl..."};var QH={};QH={loading:"Laster inn ...",loadingMore:"Laster inn flere ..."};var eq={};eq={loading:"Laden...",loadingMore:"Meer laden..."};var tq={};tq={loading:"adowanie...",loadingMore:"Wczytywanie wikszej liczby..."};var nq={};nq={loading:"Carregando...",loadingMore:"Carregando mais..."};var rq={};rq={loading:"A carregar...",loadingMore:"A carregar mais..."};var iq={};iq={loading:"Se ncarc...",loadingMore:"Se ncarc mai multe..."};var sq={};sq={loading:"...",loadingMore:" ..."};var oq={};oq={loading:"Natava sa...",loadingMore:"Natava sa viac..."};var aq={};aq={loading:"Nalaganje...",loadingMore:"Nalaganje ve vsebine..."};var lq={};lq={loading:"Uitavam...",loadingMore:"Uitavam jo..."};var cq={};cq={loading:"Lser in...",loadingMore:"Lser in mer..."};var uq={};uq={loading:"Ykleniyor...",loadingMore:"Daha fazla ykleniyor..."};var dq={};dq={loading:"",loadingMore:"  ..."};var hq={};hq={loading:"...",loadingMore:"..."};var fq={};fq={loading:"",loadingMore:""};$H={"ar-AE":kH,"bg-BG":OH,"cs-CZ":DH,"da-DK":FH,"de-DE":NH,"el-GR":zH,"en-US":BH,"es-ES":UH,"et-EE":VH,"fi-FI":jH,"fr-FR":GH,"he-IL":WH,"hr-HR":HH,"hu-HU":qH,"it-IT":KH,"ja-JP":XH,"ko-KR":ZH,"lt-LT":YH,"lv-LV":JH,"nb-NO":QH,"nl-NL":eq,"pl-PL":tq,"pt-BR":nq,"pt-PT":rq,"ro-RO":iq,"ru-RU":sq,"sk-SK":oq,"sl-SI":aq,"sr-SP":lq,"sv-SE":cq,"tr-TR":uq,"uk-UA":dq,"zh-CN":hq,"zh-TW":fq};const q$=le.createContext(null);var Bn={};jr(Bn,"spectrum-Menu-popover",()=>eL,t=>eL=t);jr(Bn,"spectrum-Menu",()=>tL,t=>tL=t);jr(Bn,"spectrum-Menu-sectionHeading",()=>nL,t=>nL=t);jr(Bn,"spectrum-Menu-checkmark",()=>rL,t=>rL=t);jr(Bn,"spectrum-Menu-item",()=>iL,t=>iL=t);jr(Bn,"is-selected",()=>sL,t=>sL=t);jr(Bn,"spectrum-Icon",()=>oL,t=>oL=t);jr(Bn,"spectrum-Menu-itemLabel",()=>aL,t=>aL=t);jr(Bn,"spectrum-Menu-itemIcon",()=>lL,t=>lL=t);jr(Bn,"spectrum-Menu-itemLabel--wrapping",()=>cL,t=>cL=t);jr(Bn,"spectrum-Menu-divider",()=>uL,t=>uL=t);jr(Bn,"spectrum-Menu-itemGrid",()=>dL,t=>dL=t);jr(Bn,"is-selectable",()=>hL,t=>hL=t);jr(Bn,"spectrum-Menu-end",()=>fL,t=>fL=t);jr(Bn,"spectrum-Menu-icon",()=>pL,t=>pL=t);jr(Bn,"spectrum-Menu-description",()=>mL,t=>mL=t);jr(Bn,"spectrum-Menu-keyboard",()=>gL,t=>gL=t);jr(Bn,"focus-ring",()=>yL,t=>yL=t);jr(Bn,"is-focused",()=>vL,t=>vL=t);jr(Bn,"is-hovered",()=>_L,t=>_L=t);jr(Bn,"is-highlighted",()=>bL,t=>bL=t);jr(Bn,"is-open",()=>xL,t=>xL=t);jr(Bn,"is-active",()=>wL,t=>wL=t);jr(Bn,"is-disabled",()=>TL,t=>TL=t);var eL,tL,nL,rL,iL,sL,oL,aL,lL,cL,uL,dL,hL,fL,pL,mL,gL,yL,vL,_L,bL,xL,wL,TL;eL="spectrum-Menu-popover_7ea47c";tL="spectrum-Menu_7ea47c";nL="spectrum-Menu-sectionHeading_7ea47c";rL="spectrum-Menu-checkmark_7ea47c";iL="spectrum-Menu-item_7ea47c";sL="is-selected_7ea47c";oL="spectrum-Icon_7ea47c";aL="spectrum-Menu-itemLabel_7ea47c";lL="spectrum-Menu-itemIcon_7ea47c";cL="spectrum-Menu-itemLabel--wrapping_7ea47c";uL="spectrum-Menu-divider_7ea47c";dL="spectrum-Menu-itemGrid_7ea47c";hL="is-selectable_7ea47c";fL="spectrum-Menu-end_7ea47c";pL="spectrum-Menu-icon_7ea47c";mL="spectrum-Menu-description_7ea47c";gL="spectrum-Menu-keyboard_7ea47c";yL="focus-ring_7ea47c";vL="is-focused_7ea47c";_L="is-hovered_7ea47c";bL="is-highlighted_7ea47c";xL="is-open_7ea47c";wL="is-active_7ea47c";TL="is-disabled_7ea47c";function XSe(t){let{item:e,shouldSelectOnPressUp:n,shouldFocusOnHover:r,shouldUseVirtualFocus:i}=t,{rendered:s,key:l}=e,o=Hi(e.props);delete o.id;let h=te.useContext(q$),p=te.useRef(),{optionProps:b,labelProps:x,descriptionProps:w,isSelected:A,isDisabled:L,isFocused:M}=TSe({"aria-label":e["aria-label"],key:l,shouldSelectOnPressUp:n,shouldFocusOnHover:r,isVirtualized:!0,shouldUseVirtualFocus:i},h,p),{hoverProps:U,isHovered:D}=Au({...t,isDisabled:L}),$=typeof s=="string"?le.createElement(wa,null,s):s,N=wy();return le.createElement(Ap,{focusRingClass:ct(wo(Bn),"focus-ring")},le.createElement("div",{...Vn(b,r?{}:U,o),ref:p,className:ct(wo(Bn),"spectrum-Menu-item",{"is-focused":i&&M&&N,"is-disabled":L,"is-selected":A,"is-selectable":h.selectionManager.selectionMode!=="none","is-hovered":D&&!r||M&&!N})},le.createElement(JEe,{UNSAFE_className:ct(wo(Bn),"spectrum-Menu-itemGrid")},le.createElement(k$,null,le.createElement(yx,{slots:{text:{UNSAFE_className:wo(Bn)["spectrum-Menu-itemLabel"],...x},icon:{size:"S",UNSAFE_className:wo(Bn)["spectrum-Menu-icon"]},description:{UNSAFE_className:wo(Bn)["spectrum-Menu-description"],...w}}},$,A&&le.createElement(U$,{slot:"checkmark",UNSAFE_className:ct(wo(Bn),"spectrum-Menu-checkmark")}))))))}function ZSe(t){let{children:e,reusableView:n,header:r}=t,i=n.content,{headingProps:s,groupProps:l}=ESe({heading:i.rendered,"aria-label":i["aria-label"]}),{separatorProps:o}=zW({elementType:"li"}),h=te.useRef();RH({reusableView:r,ref:h});let{direction:p}=Ra(),b=te.useContext(q$);return le.createElement(te.Fragment,null,le.createElement("div",{role:"presentation",ref:h,style:QC(r.layoutInfo,p)},i.key!==b.collection.getFirstKey()&&le.createElement("div",{...o,className:ct(wo(Bn),"spectrum-Menu-divider")}),i.rendered&&le.createElement("div",{...s,className:ct(wo(Bn),"spectrum-Menu-sectionHeading")},i.rendered)),le.createElement("div",{...l,style:QC(n.layoutInfo,p),className:ct(wo(Bn),"spectrum-Menu")},e))}function K$(t){let{scale:e}=rh(),n=R$({usage:"search",sensitivity:"base"}),r=te.useMemo(()=>new FSe({estimatedRowHeight:e==="large"?48:32,estimatedHeadingHeight:e==="large"?33:26,padding:e==="large"?5:4,loaderHeight:40,placeholderHeight:e==="large"?48:32,collator:n}),[n,e]);return r.collection=t.collection,r.disabledKeys=t.disabledKeys,r}function YSe(t,e){let{layout:n,state:r,shouldSelectOnPressUp:i,focusOnPointerEnter:s,shouldUseVirtualFocus:l,domProps:o={},transitionDuration:h=0,onScroll:p}=t,{listBoxProps:b}=wSe({...t,keyboardDelegate:n,isVirtualized:!0},r,e),{styleProps:x}=mi(t),w=dc(wo($H));n.isLoading=t.isLoading;let A=(L,M,U,D)=>M.viewType==="section"?le.createElement(ZSe,{key:M.key,reusableView:M,header:U.find($=>$.viewType==="header")},D(U.filter($=>$.viewType==="item"))):le.createElement(MH,{key:M.key,reusableView:M,parent:L});return le.createElement(q$.Provider,{value:r},le.createElement(D$,null,le.createElement(qSe,{...x,...Vn(b,o),ref:e,focusedKey:r.selectionManager.focusedKey,sizeToFit:"height",scrollDirection:"vertical",className:ct(wo(Bn),"spectrum-Menu",x.className),layout:n,collection:r.collection,renderWrapper:A,transitionDuration:h,isLoading:t.isLoading,onLoadMore:t.onLoadMore,shouldUseVirtualFocus:l,onScroll:p},(L,M)=>{if(L==="item")return le.createElement(XSe,{item:M,shouldSelectOnPressUp:i,shouldFocusOnHover:s,shouldUseVirtualFocus:l});if(L==="loader")return le.createElement("div",{role:"option",style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}},le.createElement(H$,{isIndeterminate:!0,size:"S","aria-label":r.collection.size>0?w.format("loadingMore"):w.format("loading"),UNSAFE_className:ct(wo(Bn),"spectrum-Dropdown-progressCircle")}));if(L==="placeholder"){let U=t.renderEmptyState?t.renderEmptyState():null;return U==null?null:le.createElement("div",{role:"option"},U)}})))}const X$=le.forwardRef(YSe);function JSe(t,e){let n=BW(t),r=K$(n),i=io(e);return le.createElement(X$,{...t,ref:i,state:n,layout:r})}const QSe=le.forwardRef(JSe);function e3e(t,e){let{inputElementType:n="input",isDisabled:r=!1,isRequired:i=!1,isReadOnly:s=!1,validationState:l,type:o="text",onChange:h=()=>{}}=t,{focusableProps:p}=Jj(t,e),{labelProps:b,fieldProps:x,descriptionProps:w,errorMessageProps:A}=LH(t),L=Hi(t,{labelable:!0});const M={type:o,pattern:t.pattern};return{labelProps:b,inputProps:Vn(L,n==="input"&&M,{disabled:r,readOnly:s,"aria-required":i||void 0,"aria-invalid":l==="invalid"||void 0,"aria-errormessage":t["aria-errormessage"],"aria-activedescendant":t["aria-activedescendant"],"aria-autocomplete":t["aria-autocomplete"],"aria-haspopup":t["aria-haspopup"],value:t.value,defaultValue:t.value?void 0:t.defaultValue,onChange:U=>h(U.target.value),autoComplete:t.autoComplete,maxLength:t.maxLength,minLength:t.minLength,name:t.name,placeholder:t.placeholder,inputMode:t.inputMode,onCopy:t.onCopy,onCut:t.onCut,onPaste:t.onPaste,onCompositionEnd:t.onCompositionEnd,onCompositionStart:t.onCompositionStart,onCompositionUpdate:t.onCompositionUpdate,onSelect:t.onSelect,onBeforeInput:t.onBeforeInput,onInput:t.onInput,...p,...x}),descriptionProps:w,errorMessageProps:A}}function Qm(t){return t&&t.__esModule?t.default:t}function qi(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var Xr={};qi(Xr,"spectrum-Textfield-input",()=>EL,t=>EL=t);qi(Xr,"spectrum-Textfield",()=>SL,t=>SL=t);qi(Xr,"focus-ring",()=>AL,t=>AL=t);qi(Xr,"spectrum-Textfield--quiet",()=>PL,t=>PL=t);qi(Xr,"spectrum-Textfield--multiline",()=>CL,t=>CL=t);qi(Xr,"is-placeholder",()=>LL,t=>LL=t);qi(Xr,"is-hovered",()=>IL,t=>IL=t);qi(Xr,"spectrum-Textfield--valid",()=>RL,t=>RL=t);qi(Xr,"spectrum-Textfield--invalid",()=>ML,t=>ML=t);qi(Xr,"spectrum-Textfield--loadable",()=>$L,t=>$L=t);qi(Xr,"spectrum-Textfield-wrapper",()=>kL,t=>kL=t);qi(Xr,"spectrum-Textfield-wrapper--quiet",()=>OL,t=>OL=t);qi(Xr,"spectrum-Textfield-validationIcon",()=>DL,t=>DL=t);qi(Xr,"spectrum-Textfield-icon",()=>FL,t=>FL=t);qi(Xr,"spectrum-Textfield-inputIcon",()=>NL,t=>NL=t);qi(Xr,"spectrum-Textfield-circleLoader",()=>zL,t=>zL=t);qi(Xr,"is-focused",()=>BL,t=>BL=t);qi(Xr,"is-disabled",()=>UL,t=>UL=t);var EL,SL,AL,PL,CL,LL,IL,RL,ML,$L,kL,OL,DL,FL,NL,zL,BL,UL;EL="spectrum-Textfield-input_73bc77";SL="spectrum-Textfield_73bc77";AL="focus-ring_73bc77";PL="spectrum-Textfield--quiet_73bc77";CL="spectrum-Textfield--multiline_73bc77";LL="is-placeholder_73bc77";IL="is-hovered_73bc77";RL="spectrum-Textfield--valid_73bc77";ML="spectrum-Textfield--invalid_73bc77";$L="spectrum-Textfield--loadable_73bc77";kL="spectrum-Textfield-wrapper_73bc77";OL="spectrum-Textfield-wrapper--quiet_73bc77";DL="spectrum-Textfield-validationIcon_73bc77";FL="spectrum-Textfield-icon_73bc77";NL="spectrum-Textfield-inputIcon_73bc77";zL="spectrum-Textfield-circleLoader_73bc77";BL="is-focused_73bc77";UL="is-disabled_73bc77";function t3e(t,e){let{validationState:n,icon:r,isQuiet:i=!1,isDisabled:s,multiLine:l,autoFocus:o,inputClassName:h,wrapperChildren:p,labelProps:b,inputProps:x,descriptionProps:w,errorMessageProps:A,inputRef:L,isLoading:M,loadingIndicator:U,validationIconClassName:D,disableFocusRing:$}=t,{hoverProps:N,isHovered:B}=Au({isDisabled:s}),Z=te.useRef(null),ie=te.useRef(null),re=L||ie;te.useImperativeHandle(e,()=>({...Uj(Z,re),select(){re.current&&re.current.select()},getInputElement(){return re.current}}));let ve=l?"textarea":"input",Te=n==="invalid"&&!s;if(r){let Vt=ct(Qm(Xr),r.props&&r.props.UNSAFE_className,"spectrum-Textfield-icon");r=te.cloneElement(r,{UNSAFE_className:Vt,size:"S"})}let Ae=Te?le.createElement(j$,null):le.createElement(U$,null),fe=te.cloneElement(Ae,{UNSAFE_className:ct(Qm(Xr),"spectrum-Textfield-validationIcon",D)}),{focusProps:Pe,isFocusVisible:_e}=Yj({isTextInput:!0,autoFocus:o}),ke=le.createElement("div",{className:ct(Qm(Xr),"spectrum-Textfield",{"spectrum-Textfield--invalid":Te,"spectrum-Textfield--valid":n==="valid"&&!s,"spectrum-Textfield--loadable":U,"spectrum-Textfield--quiet":i,"spectrum-Textfield--multiline":l,"focus-ring":!$&&_e})},le.createElement(ve,{...Vn(x,N,Pe),ref:re,rows:l?1:void 0,className:ct(Qm(Xr),"spectrum-Textfield-input",{"spectrum-Textfield-inputIcon":r,"is-hovered":B},h)}),r,n&&!M&&!s?fe:null,M&&U,p);return le.createElement(G$,{...t,labelProps:b,descriptionProps:w,errorMessageProps:A,wrapperClassName:ct(Qm(Xr),"spectrum-Textfield-wrapper",{"spectrum-Textfield-wrapper--quiet":i}),showErrorIcon:!1,ref:Z},ke)}const pq=te.forwardRef(t3e);function n3e(t){return t&&t.__esModule?t.default:t}var mq={},gq={};gq={buttonLabel:" ",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} `,other:()=>`${e.number(t.optionCount)} `})} .`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`  ${t.groupTitle},  ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} `,other:()=>`${e.number(t.groupCount)} `})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ",other:""},t.isSelected)}`,listboxLabel:"",selectedAnnouncement:t=>`${t.optionText} `};var yq={};yq={buttonLabel:" ",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} `,other:()=>`${e.number(t.optionCount)} `})}  .`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`  ${t.groupTitle},  ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} `,other:()=>`${e.number(t.groupCount)} `})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ",other:""},t.isSelected)}`,listboxLabel:"",selectedAnnouncement:t=>`${t.optionText}, `};var vq={};vq={buttonLabel:"Zobrazit doporuen",countAnnouncement:(t,e)=>`K dispozici ${e.plural(t.optionCount,{one:()=>`je ${e.number(t.optionCount)} monost`,other:()=>`jsou/je ${e.number(t.optionCount)} monosti/-`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Zadan skupina ${t.groupTitle} ${e.plural(t.groupCount,{one:()=>`s ${e.number(t.groupCount)} monost`,other:()=>`se ${e.number(t.groupCount)} monostmi`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:" (vybrno)",other:""},t.isSelected)}`,listboxLabel:"Nvrhy",selectedAnnouncement:t=>`${t.optionText}, vybrno`};var _q={};_q={buttonLabel:"Vis forslag",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} mulighed tilgngelig`,other:()=>`${e.number(t.optionCount)} muligheder tilgngelige`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Angivet gruppe ${t.groupTitle}, med ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} mulighed`,other:()=>`${e.number(t.groupCount)} muligheder`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", valgt",other:""},t.isSelected)}`,listboxLabel:"Forslag",selectedAnnouncement:t=>`${t.optionText}, valgt`};var bq={};bq={buttonLabel:"Empfehlungen anzeigen",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} Option`,other:()=>`${e.number(t.optionCount)} Optionen`})} verfgbar.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Eingetretene Gruppe ${t.groupTitle}, mit ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} Option`,other:()=>`${e.number(t.groupCount)} Optionen`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ausgewhlt",other:""},t.isSelected)}`,listboxLabel:"Empfehlungen",selectedAnnouncement:t=>`${t.optionText}, ausgewhlt`};var xq={};xq={buttonLabel:" ",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} `,other:()=>`${e.number(t.optionCount)}  `})} .`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`  ${t.groupTitle},  ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} `,other:()=>`${e.number(t.groupCount)} `})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ",other:""},t.isSelected)}`,listboxLabel:"",selectedAnnouncement:t=>`${t.optionText}, `};var wq={};wq={focusAnnouncement:(t,e)=>`${e.select({true:()=>`Entered group ${t.groupTitle}, with ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} option`,other:()=>`${e.number(t.groupCount)} options`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", selected",other:""},t.isSelected)}`,countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} option`,other:()=>`${e.number(t.optionCount)} options`})} available.`,selectedAnnouncement:t=>`${t.optionText}, selected`,buttonLabel:"Show suggestions",listboxLabel:"Suggestions"};var Tq={};Tq={buttonLabel:"Mostrar sugerencias",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcin`,other:()=>`${e.number(t.optionCount)} opciones`})} disponible(s).`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Se ha unido al grupo ${t.groupTitle}, con ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opcin`,other:()=>`${e.number(t.groupCount)} opciones`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", seleccionado",other:""},t.isSelected)}`,listboxLabel:"Sugerencias",selectedAnnouncement:t=>`${t.optionText}, seleccionado`};var Eq={};Eq={buttonLabel:"Kuva soovitused",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} valik`,other:()=>`${e.number(t.optionCount)} valikud`})} saadaval.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Sisestatud rhm ${t.groupTitle}, valikuga ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} valik`,other:()=>`${e.number(t.groupCount)} valikud`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", valitud",other:""},t.isSelected)}`,listboxLabel:"Soovitused",selectedAnnouncement:t=>`${t.optionText}, valitud`};var Sq={};Sq={buttonLabel:"Nyt ehdotukset",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} vaihtoehto`,other:()=>`${e.number(t.optionCount)} vaihtoehdot`})} saatavilla.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Mentiin ryhmn ${t.groupTitle}, ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} vaihtoehdon`,other:()=>`${e.number(t.groupCount)} vaihtoehdon`})} kanssa.`,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", valittu",other:""},t.isSelected)}`,listboxLabel:"Ehdotukset",selectedAnnouncement:t=>`${t.optionText}, valittu`};var Aq={};Aq={buttonLabel:"Afficher les suggestions",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} option`,other:()=>`${e.number(t.optionCount)} options`})} disponible(s).`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Groupe ${t.groupTitle} saisi, avec ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} option`,other:()=>`${e.number(t.groupCount)} options`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", slectionn(s)",other:""},t.isSelected)}`,listboxLabel:"Suggestions",selectedAnnouncement:t=>`${t.optionText}, slectionn`};var Pq={};Pq={buttonLabel:" ",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>` ${e.number(t.optionCount)}`,other:()=>`${e.number(t.optionCount)} `})}  .`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`  ${t.groupTitle},  ${e.plural(t.groupCount,{one:()=>` ${e.number(t.groupCount)}`,other:()=>`${e.number(t.groupCount)} `})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ",other:""},t.isSelected)}`,listboxLabel:"",selectedAnnouncement:t=>`${t.optionText}, `};var Cq={};Cq={buttonLabel:"Prikai prijedloge",countAnnouncement:(t,e)=>`Dostupno jo: ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcija`,other:()=>`${e.number(t.optionCount)} opcije/a`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Unesena skupina ${t.groupTitle}, s ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opcijom`,other:()=>`${e.number(t.groupCount)} opcije/a`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", odabranih",other:""},t.isSelected)}`,listboxLabel:"Prijedlozi",selectedAnnouncement:t=>`${t.optionText}, odabrano`};var Lq={};Lq={buttonLabel:"Javaslatok megjelentse",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} lehetsg`,other:()=>`${e.number(t.optionCount)} lehetsg`})} ll rendelkezsre.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Belpett a(z) ${t.groupTitle} csoportba, amely ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} lehetsget`,other:()=>`${e.number(t.groupCount)} lehetsget`})} tartalmaz. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", kijellve",other:""},t.isSelected)}`,listboxLabel:"Javaslatok",selectedAnnouncement:t=>`${t.optionText}, kijellve`};var Iq={};Iq={buttonLabel:"Mostra suggerimenti",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opzione disponibile`,other:()=>`${e.number(t.optionCount)} opzioni disponibili`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Ingresso nel gruppo ${t.groupTitle}, con ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opzione`,other:()=>`${e.number(t.groupCount)} opzioni`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", selezionato",other:""},t.isSelected)}`,listboxLabel:"Suggerimenti",selectedAnnouncement:t=>`${t.optionText}, selezionato`};var Rq={};Rq={buttonLabel:"",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} `,other:()=>`${e.number(t.optionCount)} `})}`,focusAnnouncement:(t,e)=>`${e.select({true:()=>` ${t.groupTitle}${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} `,other:()=>`${e.number(t.groupCount)} `})}`,other:""},t.isGroupChange)}${t.optionText}${e.select({true:"",other:""},t.isSelected)}`,listboxLabel:"",selectedAnnouncement:t=>`${t.optionText}`};var Mq={};Mq={buttonLabel:"  ",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} `,other:()=>`${e.number(t.optionCount)} `})}   .`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`  ${t.groupTitle}, ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} `,other:()=>`${e.number(t.groupCount)} `})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ",other:""},t.isSelected)}`,listboxLabel:"",selectedAnnouncement:t=>`${t.optionText}, `};var $q={};$q={buttonLabel:"Rodyti pasilymus",countAnnouncement:(t,e)=>`Yra ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} parinktis`,other:()=>`${e.number(t.optionCount)} parinktys (-i)`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`vesta grup ${t.groupTitle}, su ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} parinktimi`,other:()=>`${e.number(t.groupCount)} parinktimis (-i)`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", pasirinkta",other:""},t.isSelected)}`,listboxLabel:"Pasilymai",selectedAnnouncement:t=>`${t.optionText}, pasirinkta`};var kq={};kq={buttonLabel:"Rdt ieteikumus",countAnnouncement:(t,e)=>`Pieejamo opciju skaits: ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcija`,other:()=>`${e.number(t.optionCount)} opcijas`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Ievadta grupa ${t.groupTitle}, ar ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opciju`,other:()=>`${e.number(t.groupCount)} opcijm`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", atlasta",other:""},t.isSelected)}`,listboxLabel:"Ieteikumi",selectedAnnouncement:t=>`${t.optionText}, atlasta`};var Oq={};Oq={buttonLabel:"Vis forslag",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} alternativ`,other:()=>`${e.number(t.optionCount)} alternativer`})} finnes.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Angitt gruppe ${t.groupTitle}, med ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} alternativ`,other:()=>`${e.number(t.groupCount)} alternativer`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", valgt",other:""},t.isSelected)}`,listboxLabel:"Forslag",selectedAnnouncement:t=>`${t.optionText}, valgt`};var Dq={};Dq={buttonLabel:"Suggesties weergeven",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} optie`,other:()=>`${e.number(t.optionCount)} opties`})} beschikbaar.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Groep ${t.groupTitle} ingevoerd met ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} optie`,other:()=>`${e.number(t.groupCount)} opties`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", geselecteerd",other:""},t.isSelected)}`,listboxLabel:"Suggesties",selectedAnnouncement:t=>`${t.optionText}, geselecteerd`};var Fq={};Fq={buttonLabel:"Wywietlaj sugestie",countAnnouncement:(t,e)=>`dostpna/dostpne(-nych) ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcja`,other:()=>`${e.number(t.optionCount)} opcje(-i)`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Doczono do grupy ${t.groupTitle}, z ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opcj`,other:()=>`${e.number(t.groupCount)} opcjami`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", wybrano",other:""},t.isSelected)}`,listboxLabel:"Sugestie",selectedAnnouncement:t=>`${t.optionText}, wybrano`};var Nq={};Nq={buttonLabel:"Mostrar sugestes",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opo`,other:()=>`${e.number(t.optionCount)} opes`})} disponvel.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Grupo inserido ${t.groupTitle}, com ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opo`,other:()=>`${e.number(t.groupCount)} opes`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", selecionado",other:""},t.isSelected)}`,listboxLabel:"Sugestes",selectedAnnouncement:t=>`${t.optionText}, selecionado`};var zq={};zq={buttonLabel:"Apresentar sugestes",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opo`,other:()=>`${e.number(t.optionCount)} opes`})} disponvel.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Grupo introduzido ${t.groupTitle}, com ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opo`,other:()=>`${e.number(t.groupCount)} opes`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", selecionado",other:""},t.isSelected)}`,listboxLabel:"Sugestes",selectedAnnouncement:t=>`${t.optionText}, selecionado`};var Bq={};Bq={buttonLabel:"Afiare sugestii",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opiune`,other:()=>`${e.number(t.optionCount)} opiuni`})} disponibile.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Grup ${t.groupTitle} introdus, cu ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opiune`,other:()=>`${e.number(t.groupCount)} opiuni`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", selectat",other:""},t.isSelected)}`,listboxLabel:"Sugestii",selectedAnnouncement:t=>`${t.optionText}, selectat`};var Uq={};Uq={buttonLabel:" ",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} `,other:()=>`${e.number(t.optionCount)} `})} .`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`  ${t.groupTitle},  ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} `,other:()=>`${e.number(t.groupCount)} `})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ",other:""},t.isSelected)}`,listboxLabel:"",selectedAnnouncement:t=>`${t.optionText}, `};var Vq={};Vq={buttonLabel:"Zobrazi nvrhy",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} monos`,other:()=>`${e.number(t.optionCount)} monosti/-`})} k dispozcii.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Zadan skupina ${t.groupTitle}, s ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} monosou`,other:()=>`${e.number(t.groupCount)} monosami`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", vybrat",other:""},t.isSelected)}`,listboxLabel:"Nvrhy",selectedAnnouncement:t=>`${t.optionText}, vybrat`};var jq={};jq={buttonLabel:"Prikai predloge",countAnnouncement:(t,e)=>`Na voljo je ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcija`,other:()=>`${e.number(t.optionCount)} opcije`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Vnesena skupina ${t.groupTitle}, z ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opcija`,other:()=>`${e.number(t.groupCount)} opcije`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", izbrano",other:""},t.isSelected)}`,listboxLabel:"Predlogi",selectedAnnouncement:t=>`${t.optionText}, izbrano`};var Gq={};Gq={buttonLabel:"Prikai predloge",countAnnouncement:(t,e)=>`Dostupno jo: ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} opcija`,other:()=>`${e.number(t.optionCount)} opcije/a`})}.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Unesena grupa ${t.groupTitle}, s ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} opcijom`,other:()=>`${e.number(t.groupCount)} optione/a`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", izabranih",other:""},t.isSelected)}`,listboxLabel:"Predlozi",selectedAnnouncement:t=>`${t.optionText}, izabrano`};var Wq={};Wq={buttonLabel:"Visa frslag",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} alternativ`,other:()=>`${e.number(t.optionCount)} alternativ`})} tillgngliga.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Ingick i gruppen ${t.groupTitle} med ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} alternativ`,other:()=>`${e.number(t.groupCount)} alternativ`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", valda",other:""},t.isSelected)}`,listboxLabel:"Frslag",selectedAnnouncement:t=>`${t.optionText}, valda`};var Hq={};Hq={buttonLabel:"nerileri gster",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} seenek`,other:()=>`${e.number(t.optionCount)} seenekler`})} kullanlabilir.`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`Girilen grup ${t.groupTitle}, ile ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} seenek`,other:()=>`${e.number(t.groupCount)} seenekler`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", seildi",other:""},t.isSelected)}`,listboxLabel:"neriler",selectedAnnouncement:t=>`${t.optionText}, seildi`};var qq={};qq={buttonLabel:" ",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} `,other:()=>`${e.number(t.optionCount)} (-)`})} .`,focusAnnouncement:(t,e)=>`${e.select({true:()=>`  ${t.groupTitle},  ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} `,other:()=>`${e.number(t.groupCount)} (-)`})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ",other:""},t.isSelected)}`,listboxLabel:"",selectedAnnouncement:t=>`${t.optionText}, `};var Kq={};Kq={buttonLabel:"",countAnnouncement:(t,e)=>` ${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} `,other:()=>`${e.number(t.optionCount)} `})}`,focusAnnouncement:(t,e)=>`${e.select({true:()=>` ${t.groupTitle}  ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} `,other:()=>`${e.number(t.groupCount)} `})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ",other:""},t.isSelected)}`,listboxLabel:"",selectedAnnouncement:t=>`${t.optionText}, `};var Xq={};Xq={buttonLabel:"",countAnnouncement:(t,e)=>`${e.plural(t.optionCount,{one:()=>`${e.number(t.optionCount)} `,other:()=>`${e.number(t.optionCount)} `})} `,focusAnnouncement:(t,e)=>`${e.select({true:()=>` ${t.groupTitle},  ${e.plural(t.groupCount,{one:()=>`${e.number(t.groupCount)} `,other:()=>`${e.number(t.groupCount)} `})}. `,other:""},t.isGroupChange)}${t.optionText}${e.select({true:", ",other:""},t.isSelected)}`,listboxLabel:"",selectedAnnouncement:t=>`${t.optionText}, `};mq={"ar-AE":gq,"bg-BG":yq,"cs-CZ":vq,"da-DK":_q,"de-DE":bq,"el-GR":xq,"en-US":wq,"es-ES":Tq,"et-EE":Eq,"fi-FI":Sq,"fr-FR":Aq,"he-IL":Pq,"hr-HR":Cq,"hu-HU":Lq,"it-IT":Iq,"ja-JP":Rq,"ko-KR":Mq,"lt-LT":$q,"lv-LV":kq,"nb-NO":Oq,"nl-NL":Dq,"pl-PL":Fq,"pt-BR":Nq,"pt-PT":zq,"ro-RO":Bq,"ru-RU":Uq,"sk-SK":Vq,"sl-SI":jq,"sr-SP":Gq,"sv-SE":Wq,"tr-TR":Hq,"uk-UA":qq,"zh-CN":Kq,"zh-TW":Xq};function Zq(t,e){let{buttonRef:n,popoverRef:r,inputRef:i,listBoxRef:s,keyboardDelegate:l,shouldFocusWrap:o,isReadOnly:h,isDisabled:p}=t,b=dc(n3e(mq)),{menuTriggerProps:x,menuProps:w}=zEe({type:"listbox",isDisabled:p||h},e,n);Sx.set(e,{id:w.id});let A=te.useMemo(()=>l||new tW(e.collection,e.disabledKeys,s),[l,e.collection,e.disabledKeys,s]),{collectionProps:L}=eW({selectionManager:e.selectionManager,keyboardDelegate:A,disallowTypeAhead:!0,disallowEmptySelection:!0,shouldFocusWrap:o,ref:i,isVirtualized:!0}),M=Ke=>{switch(Ke.key){case"Enter":case"Tab":e.isOpen&&Ke.key==="Enter"&&Ke.preventDefault(),e.commit();break;case"Escape":(e.selectedKey!==null||e.inputValue===""||t.allowsCustomValue)&&Ke.continuePropagation(),e.revert();break;case"ArrowDown":e.open("first","manual");break;case"ArrowUp":e.open("last","manual");break;case"ArrowLeft":case"ArrowRight":e.selectionManager.setFocusedKey(null);break}},U=Ke=>{var Je;Ke.relatedTarget===(n==null?void 0:n.current)||!((Je=r.current)===null||Je===void 0)&&Je.contains(Ke.relatedTarget)||(t.onBlur&&t.onBlur(Ke),e.setFocused(!1))},D=Ke=>{e.isFocused||(t.onFocus&&t.onFocus(Ke),e.setFocused(!0))},{labelProps:$,inputProps:N,descriptionProps:B,errorMessageProps:Z}=e3e({...t,onChange:e.setInputValue,onKeyDown:!h&&xy(e.isOpen&&L.onKeyDown,M,t.onKeyDown),onBlur:U,value:e.inputValue,onFocus:D,autoComplete:"off"},i),ie=Ke=>{Ke.pointerType==="touch"&&(i.current.focus(),e.toggle(null,"manual"))},re=Ke=>{Ke.pointerType!=="touch"&&(i.current.focus(),e.toggle(Ke.pointerType==="keyboard"||Ke.pointerType==="virtual"?"first":null,"manual"))},ve=Kb({id:x.id,"aria-label":b.format("buttonLabel"),"aria-labelledby":t["aria-labelledby"]||$.id}),Te=Kb({id:w.id,"aria-label":b.format("listboxLabel"),"aria-labelledby":t["aria-labelledby"]||$.id}),Ae=te.useRef(0),fe=Ke=>{if(p||h)return;if(Ke.timeStamp-Ae.current<500){Ke.preventDefault(),i.current.focus();return}let Je=Ke.target.getBoundingClientRect(),kt=Ke.changedTouches[0],ft=Math.ceil(Je.left+.5*Je.width),Pt=Math.ceil(Je.top+.5*Je.height);kt.clientX===ft&&kt.clientY===Pt&&(Ke.preventDefault(),i.current.focus(),e.toggle(null,"manual"),Ae.current=Ke.timeStamp)},Pe=e.selectionManager.focusedKey!=null&&e.isOpen?e.collection.getItem(e.selectionManager.focusedKey):void 0;var _e;let ke=(_e=Pe==null?void 0:Pe.parentKey)!==null&&_e!==void 0?_e:null;var Vt;let ut=(Vt=e.selectionManager.focusedKey)!==null&&Vt!==void 0?Vt:null,rn=te.useRef(ke),ot=te.useRef(ut);te.useEffect(()=>{if(X_()&&Pe!=null&&ut!==ot.current){let Ke=e.selectionManager.isSelected(ut),Je=ke!=null?e.collection.getItem(ke):null,kt=(Je==null?void 0:Je["aria-label"])||(typeof(Je==null?void 0:Je.rendered)=="string"?Je.rendered:"")||"",ft=b.format("focusAnnouncement",{isGroupChange:Je&&ke!==rn.current,groupTitle:kt,groupCount:Je?[...dp(Je,e.collection)].length:0,optionText:Pe["aria-label"]||Pe.textValue||"",isSelected:Ke});NT(ft)}rn.current=ke,ot.current=ut});let yt=Cj(e.collection),at=te.useRef(yt),Mt=te.useRef(e.isOpen);te.useEffect(()=>{let Ke=e.isOpen!==Mt.current&&(e.selectionManager.focusedKey==null||X_());if(e.isOpen&&(Ke||yt!==at.current)){let Je=b.format("countAnnouncement",{optionCount:yt});NT(Je)}at.current=yt,Mt.current=e.isOpen});let Re=te.useRef(e.selectedKey);return te.useEffect(()=>{if(X_()&&e.isFocused&&e.selectedItem&&e.selectedKey!==Re.current){let Ke=e.selectedItem["aria-label"]||e.selectedItem.textValue||"",Je=b.format("selectedAnnouncement",{optionText:Ke});NT(Je)}Re.current=e.selectedKey}),te.useEffect(()=>{if(e.isOpen)return z$([i.current,r.current])},[e.isOpen,i,r]),{labelProps:$,buttonProps:{...x,...ve,excludeFromTabOrder:!0,onPress:ie,onPressStart:re,isDisabled:p||h},inputProps:Vn(N,{role:"combobox","aria-expanded":x["aria-expanded"],"aria-controls":e.isOpen?w.id:void 0,"aria-autocomplete":"list","aria-activedescendant":Pe?IH(e,Pe.key):void 0,onTouchEnd:fe,autoCorrect:"off",spellCheck:"false"}),listBoxProps:Vn(w,Te,{autoFocus:e.focusStrategy,shouldUseVirtualFocus:!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0}),descriptionProps:B,errorMessageProps:Z}}function Yq(t){var e;let{defaultFilter:n,menuTrigger:r="input",allowsEmptyCollection:i=!1,allowsCustomValue:s,shouldCloseOnBlur:l=!0}=t,[o,h]=te.useState(!1),[p,b]=te.useState(!1);var x;let[w,A]=fx(t.inputValue,(x=t.defaultInputValue)!==null&&x!==void 0?x:"",t.onInputChange),L=St=>{t.onSelectionChange&&t.onSelectionChange(St),St===$&&(ot(),ut())};var M;let{collection:U,selectionManager:D,selectedKey:$,setSelectedKey:N,selectedItem:B,disabledKeys:Z}=iSe({...t,onSelectionChange:L,items:(M=t.items)!==null&&M!==void 0?M:t.defaultItems}),ie=U,re=te.useMemo(()=>t.items!=null||!n?U:r3e(U,w,n),[U,w,n,t.items]),[ve,Te]=te.useState(re),Ae=te.useRef("focus"),Pe=UEe({...t,onOpenChange:St=>{t.onOpenChange&&t.onOpenChange(St,St?Ae.current:void 0),D.setFocused(St),St||D.setFocusedKey(null)},isOpen:void 0,defaultOpen:void 0}),_e=(St,bt)=>{let hn=bt==="manual"||bt==="focus"&&r==="focus";(i||re.size>0||hn&&ie.size>0||t.items)&&(hn&&!Pe.isOpen&&t.items===void 0&&h(!0),Ae.current=bt,Pe.open(St))},ke=(St,bt)=>{let hn=bt==="manual"||bt==="focus"&&r==="focus";!(i||re.size>0||hn&&ie.size>0||t.items)&&!Pe.isOpen||(hn&&!Pe.isOpen&&t.items===void 0&&h(!0),Pe.isOpen||(Ae.current=bt),Vt(St))},Vt=te.useCallback(St=>{Pe.isOpen&&Te(re),Pe.toggle(St)},[Pe,re]),ut=te.useCallback(()=>{Pe.isOpen&&(Te(re),Pe.close())},[Pe,re]),rn=te.useRef(w),ot=()=>{var St,bt;let hn=(bt=(St=U.getItem($))===null||St===void 0?void 0:St.textValue)!==null&&bt!==void 0?bt:"";rn.current=hn,A(hn)},yt=te.useRef(!0);var at,Mt;let Re=te.useRef((Mt=(at=t.selectedKey)!==null&&at!==void 0?at:t.defaultSelectedKey)!==null&&Mt!==void 0?Mt:null);var Ke;let Je=te.useRef((Ke=(e=U.getItem($))===null||e===void 0?void 0:e.textValue)!==null&&Ke!==void 0?Ke:"");te.useEffect(()=>{var St;p&&(re.size>0||i)&&!Pe.isOpen&&w!==rn.current&&r!=="manual"&&_e(null,"input"),!o&&!i&&Pe.isOpen&&re.size===0&&ut(),$!=null&&$!==Re.current&&ut(),w!==rn.current&&(D.setFocusedKey(null),h(!1),w===""&&(t.inputValue===void 0||t.selectedKey===void 0)&&N(null)),yt.current&&t.inputValue===void 0&&t.defaultInputValue===void 0&&ot(),$!==Re.current&&(t.inputValue===void 0||t.selectedKey===void 0)?ot():rn.current=w;var bt;let hn=(bt=(St=U.getItem($))===null||St===void 0?void 0:St.textValue)!==null&&bt!==void 0?bt:"";!p&&$!=null&&t.inputValue===void 0&&$===Re.current&&Je.current!==hn&&(rn.current=hn,A(hn)),yt.current=!1,Re.current=$,Je.current=hn});let kt=()=>{s&&$==null?ft():Pt()},ft=()=>{Re.current=null,N(null),ut()},Pt=()=>{if(t.selectedKey!==void 0&&t.inputValue!==void 0){var St;t.onSelectionChange($);var bt;let hn=(bt=(St=U.getItem($))===null||St===void 0?void 0:St.textValue)!==null&&bt!==void 0?bt:"";rn.current=hn,ut()}else ot(),ut()},qt=()=>{Pe.isOpen&&D.focusedKey!=null?$===D.focusedKey?Pt():N(D.focusedKey):s?ft():Pt()},lt=()=>{var St,bt;let hn=(bt=(St=U.getItem($))===null||St===void 0?void 0:St.textValue)!==null&&bt!==void 0?bt:"";s&&w!==hn?ft():Pt(),ut()},tn=St=>{St?r==="focus"&&_e(null,"focus"):l&&lt(),b(St)},Fn=te.useMemo(()=>Pe.isOpen?o?ie:re:ve,[Pe.isOpen,ie,re,o,ve]);return{...Pe,toggle:ke,open:_e,close:lt,selectionManager:D,selectedKey:$,setSelectedKey:N,disabledKeys:Z,isFocused:p,setFocused:tn,selectedItem:B,collection:Fn,inputValue:w,setInputValue:A,commit:qt,revert:kt}}function r3e(t,e,n){return new CP(Jq(t,t,e,n))}function Jq(t,e,n,r){let i=[];for(let s of e)if(s.type==="section"&&s.hasChildNodes){let l=Jq(t,dp(s,t),n,r);[...l].some(o=>o.type==="item")&&i.push({...s,childNodes:l})}else s.type==="item"&&r(s.textValue,n)?i.push({...s}):s.type!=="item"&&i.push({...s});return i}function i3e(t,e){let{role:n="dialog"}=t,r=by();r=t["aria-label"]?void 0:r;let i=te.useRef(!1);return te.useEffect(()=>{if(e.current&&!e.current.contains(document.activeElement)){Wd(e.current);let s=setTimeout(()=>{document.activeElement===e.current&&(i.current=!0,e.current.blur(),Wd(e.current),i.current=!1)},500);return()=>{clearTimeout(s)}}},[e]),zG(),{dialogProps:{...Hi(t,{labelable:!0}),role:n,tabIndex:-1,"aria-labelledby":t["aria-labelledby"]||r,onBlur:s=>{i.current&&s.stopPropagation()}},titleProps:{id:r}}}function Tn(t){return t&&t.__esModule?t.default:t}function nt(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var ji={};nt(ji,"no-results",()=>VL,t=>VL=t);nt(ji,"mobile-combobox",()=>jL,t=>jL=t);nt(ji,"mobile-input",()=>GL,t=>GL=t);nt(ji,"mobile-value",()=>WL,t=>WL=t);nt(ji,"tray-dialog",()=>HL,t=>HL=t);nt(ji,"tray-textfield",()=>qL,t=>qL=t);nt(ji,"has-label",()=>KL,t=>KL=t);nt(ji,"tray-textfield-input",()=>XL,t=>XL=t);nt(ji,"tray-listbox",()=>ZL,t=>ZL=t);var VL,jL,GL,WL,HL,qL,KL,XL,ZL;VL="no-results_743018";jL="mobile-combobox_743018";GL="mobile-input_743018";WL="mobile-value_743018";HL="tray-dialog_743018";qL="tray-textfield_743018";KL="has-label_743018";XL="tray-textfield-input_743018";ZL="tray-listbox_743018";var o0={},Qq={};Qq={clear:"",invalid:"( )",loading:" ...",noResults:"  "};var eK={};eK={clear:"",invalid:"()",loading:"...",noResults:" "};var tK={};tK={clear:"Vymazat",invalid:"(neplatn)",loading:"Natn...",noResults:"dn vsledky"};var nK={};nK={clear:"Ryd",invalid:"(ugyldig)",loading:"Indlser ...",noResults:"Ingen resultater"};var rK={};rK={clear:"Lschen",invalid:"(ungltig)",loading:"Wird geladen...",noResults:"Keine Ergebnisse"};var iK={};iK={clear:"",invalid:"( )",loading:"...",noResults:" "};var sK={};sK={loading:"Loading...",noResults:"No results",clear:"Clear",invalid:"(invalid)"};var oK={};oK={clear:"Borrar",invalid:"(no vlido)",loading:"Cargando...",noResults:"Sin resultados"};var aK={};aK={clear:"Puhasta",invalid:"(kehtetu)",loading:"Laadimine...",noResults:"Tulemusi pole"};var lK={};lK={clear:"Kirkas",invalid:"(epkelpo)",loading:"Ladataan...",noResults:"Ei tuloksia"};var cK={};cK={clear:"Effacer",invalid:"(non valide)",loading:"Chargement en cours...",noResults:"Aucun rsultat"};var uK={};uK={clear:"",invalid:"( )",loading:"...",noResults:" "};var dK={};dK={clear:"Izbrii",invalid:"(nevaee)",loading:"Uitavam...",noResults:"Nema rezultata"};var hK={};hK={clear:"Trls",invalid:"(rvnytelen)",loading:"Betlts folyamatban",noResults:"Nincsenek tallatok"};var fK={};fK={clear:"Cancella",invalid:"(non valido)",loading:"Caricamento in corso...",noResults:"Nessun risultato"};var pK={};pK={clear:"",invalid:"()",loading:"...",noResults:""};var mK={};mK={clear:"",invalid:"( )",loading:" ...",noResults:" "};var gK={};gK={clear:"Skaidrus",invalid:"(netinkama)",loading:"keliama...",noResults:"Be rezultat"};var yK={};yK={clear:"Notrt",invalid:"(nedergs)",loading:"Notiek ielde...",noResults:"Nav rezulttu"};var vK={};vK={clear:"Tm",invalid:"(ugyldig)",loading:"Laster inn ...",noResults:"Ingen resultater"};var _K={};_K={clear:"Helder",invalid:"(ongeldig)",loading:"Laden...",noResults:"Geen resultaten"};var bK={};bK={clear:"Wyczy",invalid:"(nieprawidowy)",loading:"Trwa adowanie...",noResults:"Brak wynikw"};var xK={};xK={clear:"Limpar",invalid:"(invlido)",loading:"Carregando...",noResults:"Nenhum resultado"};var wK={};wK={clear:"Limpar",invalid:"(invlido)",loading:"A carregar...",noResults:"Sem resultados"};var TK={};TK={clear:"Golire",invalid:"(nevalid)",loading:"Se ncarc...",noResults:"Niciun rezultat"};var EK={};EK={clear:"",invalid:"()",loading:"...",noResults:" "};var SK={};SK={clear:"Vymaza",invalid:"(neplatn)",loading:"Natava sa...",noResults:"iadne vsledky"};var AK={};AK={clear:"Jasen",invalid:"(neveljavno)",loading:"Nalaganje...",noResults:"Ni rezultatov"};var PK={};PK={clear:"Izbrii",invalid:"(nevaee)",loading:"Uitavam...",noResults:"Nema rezultata"};var CK={};CK={clear:"Rensa",invalid:"(ogiltigt)",loading:"Lser in...",noResults:"Inga resultat"};var LK={};LK={clear:"Temizle",invalid:"(geersiz)",loading:"Ykleniyor...",noResults:"Sonu yok"};var IK={};IK={clear:"",invalid:"()",loading:"...",noResults:" "};var RK={};RK={clear:"",invalid:"",loading:"...",noResults:""};var MK={};MK={clear:"",invalid:"()",loading:"...",noResults:""};o0={"ar-AE":Qq,"bg-BG":eK,"cs-CZ":tK,"da-DK":nK,"de-DE":rK,"el-GR":iK,"en-US":sK,"es-ES":oK,"et-EE":aK,"fi-FI":lK,"fr-FR":cK,"he-IL":uK,"hr-HR":dK,"hu-HU":hK,"it-IT":fK,"ja-JP":pK,"ko-KR":mK,"lt-LT":gK,"lv-LV":yK,"nb-NO":vK,"nl-NL":_K,"pl-PL":bK,"pt-BR":xK,"pt-PT":wK,"ro-RO":TK,"ru-RU":EK,"sk-SK":SK,"sl-SI":AK,"sr-SP":PK,"sv-SE":CK,"tr-TR":LK,"uk-UA":IK,"zh-CN":RK,"zh-TW":MK};var rr={};nt(rr,"spectrum-Button",()=>YL,t=>YL=t);nt(rr,"spectrum-ActionButton",()=>JL,t=>JL=t);nt(rr,"spectrum-LogicButton",()=>QL,t=>QL=t);nt(rr,"spectrum-FieldButton",()=>eI,t=>eI=t);nt(rr,"spectrum-ClearButton",()=>tI,t=>tI=t);nt(rr,"focus-ring",()=>nI,t=>nI=t);nt(rr,"spectrum-FieldButton--quiet",()=>rI,t=>rI=t);nt(rr,"spectrum-Icon",()=>iI,t=>iI=t);nt(rr,"is-hovered",()=>sI,t=>sI=t);nt(rr,"spectrum-Button-label",()=>oI,t=>oI=t);nt(rr,"spectrum-Button--iconOnly",()=>aI,t=>aI=t);nt(rr,"spectrum-ActionButton-label",()=>lI,t=>lI=t);nt(rr,"spectrum-ActionButton-hold",()=>cI,t=>cI=t);nt(rr,"spectrum-ActionButton--quiet",()=>uI,t=>uI=t);nt(rr,"is-disabled",()=>dI,t=>dI=t);nt(rr,"is-open",()=>hI,t=>hI=t);nt(rr,"spectrum-ClearButton--small",()=>fI,t=>fI=t);nt(rr,"is-active",()=>pI,t=>pI=t);nt(rr,"spectrum-ClearButton--overBackground",()=>mI,t=>mI=t);nt(rr,"is-selected",()=>gI,t=>gI=t);nt(rr,"spectrum-ActionButton--emphasized",()=>yI,t=>yI=t);nt(rr,"spectrum-ActionButton--staticWhite",()=>vI,t=>vI=t);nt(rr,"spectrum-ActionButton--staticBlack",()=>_I,t=>_I=t);nt(rr,"spectrum-ActionButton--staticColor",()=>bI,t=>bI=t);nt(rr,"spectrum-LogicButton--and",()=>xI,t=>xI=t);nt(rr,"spectrum-LogicButton--or",()=>wI,t=>wI=t);nt(rr,"is-focused",()=>TI,t=>TI=t);nt(rr,"is-placeholder",()=>EI,t=>EI=t);nt(rr,"spectrum-FieldButton--invalid",()=>SI,t=>SI=t);nt(rr,"spectrum-Button--overBackground",()=>AI,t=>AI=t);var YL,JL,QL,eI,tI,nI,rI,iI,sI,oI,aI,lI,cI,uI,dI,hI,fI,pI,mI,gI,yI,vI,_I,bI,xI,wI,TI,EI,SI,AI;YL="spectrum-Button_e2d99e";JL="spectrum-ActionButton_e2d99e";QL="spectrum-LogicButton_e2d99e";eI="spectrum-FieldButton_e2d99e";tI="spectrum-ClearButton_e2d99e";nI="focus-ring_e2d99e";rI="spectrum-FieldButton--quiet_e2d99e";iI="spectrum-Icon_e2d99e";sI="is-hovered_e2d99e";oI="spectrum-Button-label_e2d99e";aI="spectrum-Button--iconOnly_e2d99e";lI="spectrum-ActionButton-label_e2d99e";cI="spectrum-ActionButton-hold_e2d99e";uI="spectrum-ActionButton--quiet_e2d99e";dI="is-disabled_e2d99e";hI="is-open_e2d99e";fI="spectrum-ClearButton--small_e2d99e";pI="is-active_e2d99e";mI="spectrum-ClearButton--overBackground_e2d99e";gI="is-selected_e2d99e";yI="spectrum-ActionButton--emphasized_e2d99e";vI="spectrum-ActionButton--staticWhite_e2d99e";_I="spectrum-ActionButton--staticBlack_e2d99e";bI="spectrum-ActionButton--staticColor_e2d99e";xI="spectrum-LogicButton--and_e2d99e";wI="spectrum-LogicButton--or_e2d99e";TI="is-focused_e2d99e";EI="is-placeholder_e2d99e";SI="spectrum-FieldButton--invalid_e2d99e";AI="spectrum-Button--overBackground_e2d99e";var gi={};nt(gi,"spectrum-FieldLabel",()=>PI,t=>PI=t);nt(gi,"spectrum-FieldLabel--positionSide",()=>CI,t=>CI=t);nt(gi,"spectrum-FieldLabel-requiredIcon",()=>LI,t=>LI=t);nt(gi,"spectrum-FieldLabel--alignEnd",()=>II,t=>II=t);nt(gi,"spectrum-Field",()=>RI,t=>RI=t);nt(gi,"spectrum-Field-contextualHelp",()=>MI,t=>MI=t);nt(gi,"spectrum-Field--positionTop",()=>$I,t=>$I=t);nt(gi,"spectrum-Field-field",()=>kI,t=>kI=t);nt(gi,"spectrum-Field--alignEnd",()=>OI,t=>OI=t);nt(gi,"spectrum-Field--positionSide",()=>DI,t=>DI=t);nt(gi,"spectrum-Field-wrapper",()=>FI,t=>FI=t);nt(gi,"spectrum-Field--hasContextualHelp",()=>NI,t=>NI=t);nt(gi,"spectrum-Form",()=>zI,t=>zI=t);nt(gi,"spectrum-Form--positionSide",()=>BI,t=>BI=t);nt(gi,"spectrum-Field-labelCell",()=>UI,t=>UI=t);nt(gi,"spectrum-Field-labelWrapper",()=>VI,t=>VI=t);nt(gi,"spectrum-Form--positionTop",()=>jI,t=>jI=t);nt(gi,"spectrum-LabeledValue",()=>GI,t=>GI=t);nt(gi,"spectrum-Form-itemLabel",()=>WI,t=>WI=t);nt(gi,"is-disabled",()=>HI,t=>HI=t);var PI,CI,LI,II,RI,MI,$I,kI,OI,DI,FI,NI,zI,BI,UI,VI,jI,GI,WI,HI;PI="spectrum-FieldLabel_d2db1f";CI="spectrum-FieldLabel--positionSide_d2db1f";LI="spectrum-FieldLabel-requiredIcon_d2db1f";II="spectrum-FieldLabel--alignEnd_d2db1f";RI="spectrum-Field_d2db1f";MI="spectrum-Field-contextualHelp_d2db1f";$I="spectrum-Field--positionTop_d2db1f";kI="spectrum-Field-field_d2db1f";OI="spectrum-Field--alignEnd_d2db1f";DI="spectrum-Field--positionSide_d2db1f";FI="spectrum-Field-wrapper_d2db1f";NI="spectrum-Field--hasContextualHelp_d2db1f";zI="spectrum-Form_d2db1f";BI="spectrum-Form--positionSide_d2db1f";UI="spectrum-Field-labelCell_d2db1f";VI="spectrum-Field-labelWrapper_d2db1f";jI="spectrum-Form--positionTop_d2db1f";GI="spectrum-LabeledValue_d2db1f";WI="spectrum-Form-itemLabel_d2db1f";HI="is-disabled_d2db1f";var Ds={};nt(Ds,"spectrum-Search",()=>qI,t=>qI=t);nt(Ds,"spectrum-ClearButton",()=>KI,t=>KI=t);nt(Ds,"is-quiet",()=>XI,t=>XI=t);nt(Ds,"spectrum-Search-input",()=>ZI,t=>ZI=t);nt(Ds,"spectrum-Search--invalid",()=>YI,t=>YI=t);nt(Ds,"spectrum-Search--valid",()=>JI,t=>JI=t);nt(Ds,"spectrum-Search--loadable",()=>QI,t=>QI=t);nt(Ds,"spectrum-Search-circleLoader",()=>e4,t=>e4=t);nt(Ds,"spectrum-Search-validationIcon",()=>t4,t=>t4=t);nt(Ds,"spectrum-Textfield",()=>n4,t=>n4=t);var qI,KI,XI,ZI,YI,JI,QI,e4,t4,n4;qI="spectrum-Search_d3c0f3";KI="spectrum-ClearButton_d3c0f3";XI="is-quiet_d3c0f3";ZI="spectrum-Search-input_d3c0f3";YI="spectrum-Search--invalid_d3c0f3";JI="spectrum-Search--valid_d3c0f3";QI="spectrum-Search--loadable_d3c0f3";e4="spectrum-Search-circleLoader_d3c0f3";t4="spectrum-Search-validationIcon_d3c0f3";n4="spectrum-Textfield_d3c0f3";var Rn={};nt(Rn,"spectrum-InputGroup",()=>r4,t=>r4=t);nt(Rn,"focus-ring",()=>i4,t=>i4=t);nt(Rn,"spectrum-InputGroup--quiet",()=>s4,t=>s4=t);nt(Rn,"spectrum-FieldButton",()=>o4,t=>o4=t);nt(Rn,"is-disabled",()=>a4,t=>a4=t);nt(Rn,"spectrum-InputGroup--invalid",()=>l4,t=>l4=t);nt(Rn,"spectrum-InputGroup-field",()=>c4,t=>c4=t);nt(Rn,"spectrum-InputGroup-input-validationIcon",()=>u4,t=>u4=t);nt(Rn,"spectrum-InputGroup-input-circleLoader",()=>d4,t=>d4=t);nt(Rn,"spectrum-InputGroup-input",()=>h4,t=>h4=t);nt(Rn,"spectrum-InputGroup-icon",()=>f4,t=>f4=t);nt(Rn,"spectrum-InputGroup-popover--quiet",()=>p4,t=>p4=t);nt(Rn,"spectrum-Datepicker--range",()=>m4,t=>m4=t);nt(Rn,"spectrum-Datepicker--datetimeRange",()=>g4,t=>g4=t);nt(Rn,"spectrum-Datepicker-startField",()=>y4,t=>y4=t);nt(Rn,"spectrum-Datepicker-endField",()=>v4,t=>v4=t);nt(Rn,"spectrum-Datepicker--rangeDash",()=>_4,t=>_4=t);nt(Rn,"is-focused",()=>b4,t=>b4=t);nt(Rn,"spectrum-Datepicker-focusRing",()=>x4,t=>x4=t);nt(Rn,"is-hovered",()=>w4,t=>w4=t);nt(Rn,"is-selected",()=>T4,t=>T4=t);nt(Rn,"spectrum-FieldButton--invalid",()=>E4,t=>E4=t);var r4,i4,s4,o4,a4,l4,c4,u4,d4,h4,f4,p4,m4,g4,y4,v4,_4,b4,x4,w4,T4,E4;r4="spectrum-InputGroup_a0942f";i4="focus-ring_a0942f";s4="spectrum-InputGroup--quiet_a0942f";o4="spectrum-FieldButton_a0942f";a4="is-disabled_a0942f";l4="spectrum-InputGroup--invalid_a0942f";c4="spectrum-InputGroup-field_a0942f";u4="spectrum-InputGroup-input-validationIcon_a0942f";d4="spectrum-InputGroup-input-circleLoader_a0942f";h4="spectrum-InputGroup-input_a0942f";f4="spectrum-InputGroup-icon_a0942f";p4="spectrum-InputGroup-popover--quiet_a0942f";m4="spectrum-Datepicker--range_a0942f";g4="spectrum-Datepicker--datetimeRange_a0942f";y4="spectrum-Datepicker-startField_a0942f";v4="spectrum-Datepicker-endField_a0942f";_4="spectrum-Datepicker--rangeDash_a0942f";b4="is-focused_a0942f";x4="spectrum-Datepicker-focusRing_a0942f";w4="is-hovered_a0942f";T4="is-selected_a0942f";E4="spectrum-FieldButton--invalid_a0942f";var Yr={};nt(Yr,"spectrum-Textfield-input",()=>S4,t=>S4=t);nt(Yr,"spectrum-Textfield",()=>A4,t=>A4=t);nt(Yr,"focus-ring",()=>P4,t=>P4=t);nt(Yr,"spectrum-Textfield--quiet",()=>C4,t=>C4=t);nt(Yr,"spectrum-Textfield--multiline",()=>L4,t=>L4=t);nt(Yr,"is-placeholder",()=>I4,t=>I4=t);nt(Yr,"is-hovered",()=>R4,t=>R4=t);nt(Yr,"spectrum-Textfield--valid",()=>M4,t=>M4=t);nt(Yr,"spectrum-Textfield--invalid",()=>$4,t=>$4=t);nt(Yr,"spectrum-Textfield--loadable",()=>k4,t=>k4=t);nt(Yr,"spectrum-Textfield-wrapper",()=>O4,t=>O4=t);nt(Yr,"spectrum-Textfield-wrapper--quiet",()=>D4,t=>D4=t);nt(Yr,"spectrum-Textfield-validationIcon",()=>F4,t=>F4=t);nt(Yr,"spectrum-Textfield-icon",()=>N4,t=>N4=t);nt(Yr,"spectrum-Textfield-inputIcon",()=>z4,t=>z4=t);nt(Yr,"spectrum-Textfield-circleLoader",()=>B4,t=>B4=t);nt(Yr,"is-focused",()=>U4,t=>U4=t);nt(Yr,"is-disabled",()=>V4,t=>V4=t);var S4,A4,P4,C4,L4,I4,R4,M4,$4,k4,O4,D4,F4,N4,z4,B4,U4,V4;S4="spectrum-Textfield-input_73bc77";A4="spectrum-Textfield_73bc77";P4="focus-ring_73bc77";C4="spectrum-Textfield--quiet_73bc77";L4="spectrum-Textfield--multiline_73bc77";I4="is-placeholder_73bc77";R4="is-hovered_73bc77";M4="spectrum-Textfield--valid_73bc77";$4="spectrum-Textfield--invalid_73bc77";k4="spectrum-Textfield--loadable_73bc77";O4="spectrum-Textfield-wrapper_73bc77";D4="spectrum-Textfield-wrapper--quiet_73bc77";F4="spectrum-Textfield-validationIcon_73bc77";N4="spectrum-Textfield-icon_73bc77";z4="spectrum-Textfield-inputIcon_73bc77";B4="spectrum-Textfield-circleLoader_73bc77";U4="is-focused_73bc77";V4="is-disabled_73bc77";const s3e=le.forwardRef(function(e,n){e=Tx(e);let{isQuiet:r,isDisabled:i,validationState:s,isReadOnly:l}=e,{contains:o}=zj({sensitivity:"base"}),h=Yq({...e,defaultFilter:o,allowsEmptyCollection:!0,shouldCloseOnBlur:!1}),p=te.useRef(),b=s0(n,p),{triggerProps:x,overlayProps:w}=tG({type:"listbox"},h,p),{labelProps:A,fieldProps:L}=LH({...e,labelElementType:"span"});return A.onClick=()=>{e.isDisabled||(p.current.focus(),Y2e("keyboard"))},le.createElement(le.Fragment,null,le.createElement(G$,{...e,labelProps:A,elementType:"span",ref:b,includeNecessityIndicatorInAccessibilityName:!0},le.createElement(o3e,{...Vn(x,L,{autoFocus:e.autoFocus}),ref:p,isQuiet:r,isDisabled:i,isPlaceholder:!h.inputValue,validationState:s,onPress:()=>!l&&h.open(null,"manual")},h.inputValue||e.placeholder||"")),le.createElement(MEe,{state:h,isFixedHeight:!0,...w},le.createElement(a3e,{...e,onClose:h.close,overlayProps:w,state:h})))}),o3e=le.forwardRef(function(e,n){let{isQuiet:r,isDisabled:i,isPlaceholder:s,validationState:l,children:o,style:h,className:p}=e,b=dc(Tn(o0)),x=ta(),w=ta(),A=l==="invalid"?le.createElement(j$,{id:w,"aria-label":b.format("invalid")}):le.createElement(U$,null),L=le.cloneElement(A,{UNSAFE_className:ct(Tn(Yr),"spectrum-Textfield-validationIcon",ct(Tn(Rn),"spectrum-InputGroup-input-validationIcon"))}),{hoverProps:M,isHovered:U}=Au({}),{buttonProps:D,isPressed:$}=bx({...e,"aria-labelledby":[e["aria-labelledby"],e["aria-label"]&&!e["aria-labelledby"]?e.id:null,x,l==="invalid"?w:null].filter(Boolean).join(" "),elementType:"div"},n);return le.createElement(Ap,{focusClass:ct(Tn(Rn),"is-focused"),focusRingClass:ct(Tn(Rn),"focus-ring")},le.createElement("div",{...Vn(M,D),"aria-haspopup":"dialog",ref:n,style:{...h,outline:"none"},className:ct(Tn(Rn),"spectrum-InputGroup",{"spectrum-InputGroup--quiet":r,"is-disabled":i,"spectrum-InputGroup--invalid":l==="invalid"&&!i,"is-hovered":U},ct(Tn(ji),"mobile-combobox"),p)},le.createElement("div",{className:ct(Tn(Yr),"spectrum-Textfield",{"spectrum-Textfield--invalid":l==="invalid"&&!i,"spectrum-Textfield--valid":l==="valid"&&!i,"spectrum-Textfield--quiet":r},ct(Tn(Rn),"spectrum-InputGroup-field"))},le.createElement("div",{className:ct(Tn(Yr),"spectrum-Textfield-input",{"is-hovered":U,"is-placeholder":s,"is-disabled":i},ct(Tn(Rn),"spectrum-InputGroup-input",ct(Tn(gi),"spectrum-Field-field")),ct(Tn(ji),"mobile-input"))},le.createElement("span",{id:x,className:ct(Tn(ji),"mobile-value")},o)),l&&!i?L:null),le.createElement("div",{className:ct(Tn(rr),"spectrum-FieldButton",{"spectrum-FieldButton--quiet":r,"is-active":$,"is-disabled":i,"spectrum-FieldButton--invalid":l==="invalid"&&!i,"is-hovered":U},ct(Tn(Rn),"spectrum-FieldButton"))},le.createElement(XG,{UNSAFE_className:ct(Tn(Rn),"spectrum-Dropdown-chevron")}))))});function a3e(t){let{state:e,isDisabled:n,validationState:r,label:i,overlayProps:s,loadingState:l,onLoadMore:o,onClose:h}=t,p=te.useRef(null),[b,x]=te.useState(!1),w=te.useRef(),A=te.useRef(),L=te.useRef(),M=te.useRef(),U=K$(e),D=dc(Tn(o0)),{inputProps:$,listBoxProps:N,labelProps:B}=Zq({...t,keyboardDelegate:U,buttonRef:Vj(A),popoverRef:L,listBoxRef:M,inputRef:w},e);le.useEffect(()=>(Wd(w.current),()=>{e.setFocused(!1)}),[]);let{dialogProps:Z}=i3e({"aria-labelledby":ta(B.id)},L);$.role="searchbox",$["aria-haspopup"]="listbox",delete $["aria-expanded"],delete $.onTouchEnd;let ie=le.createElement(dEe,{preventFocus:!0,"aria-label":D.format("clear"),excludeFromTabOrder:!0,onPress:()=>{e.setInputValue(""),w.current.focus()},UNSAFE_className:ct(Tn(Ds),"spectrum-ClearButton"),isDisabled:n}),re=le.createElement(H$,{"aria-label":D.format("loading"),size:"S",isIndeterminate:!0,UNSAFE_className:ct(Tn(Ds),"spectrum-Search-circleLoader",ct(Tn(Yr),"spectrum-Textfield-circleLoader"))}),ve=te.useRef(!1),Te=()=>{ve.current=!0},Ae=()=>{ve.current=!1},fe=te.useCallback(()=>{!w.current||document.activeElement!==w.current||!ve.current||L.current.focus()},[w,L,ve]),Pe=$.value,_e=te.useRef(Pe);te.useEffect(()=>{l==="filtering"&&!b?(p.current===null&&(p.current=setTimeout(()=>{x(!0)},500)),Pe!==_e.current&&(clearTimeout(p.current),p.current=setTimeout(()=>{x(!0)},500))):l!=="filtering"&&(x(!1),clearTimeout(p.current),p.current=null),_e.current=Pe},[l,Pe,b]);let ke=Vt=>{Vt.key==="Enter"&&e.selectionManager.focusedKey==null?L.current.focus():$.onKeyDown(Vt)};return le.createElement(D$,{restoreFocus:!0,contain:!0},le.createElement("div",{...Vn(s,Z),ref:L,className:ct(Tn(ji),"tray-dialog")},le.createElement(hp,{onDismiss:h}),le.createElement(pq,{label:i,labelProps:B,inputProps:{...$,onKeyDown:ke},inputRef:w,isDisabled:n,isLoading:b&&l==="filtering",loadingIndicator:l!=null&&re,validationState:r,labelAlign:"start",labelPosition:"top",wrapperChildren:(e.inputValue!==""||l==="filtering"||r!=null)&&!t.isReadOnly&&ie,UNSAFE_className:ct(Tn(Ds),"spectrum-Search","spectrum-Textfield","spectrum-Search--loadable",{"spectrum-Search--invalid":r==="invalid"&&!n,"spectrum-Search--valid":r==="valid"&&!n},ct(Tn(ji),"tray-textfield",{"has-label":!!t.label})),inputClassName:ct(Tn(ji),"tray-textfield-input",ct(Tn(Ds),"spectrum-Search-input")),validationIconClassName:ct(Tn(Ds),"spectrum-Search-validationIcon")}),le.createElement(X$,{...N,domProps:{onTouchStart:Te,onTouchEnd:Ae},disallowEmptySelection:!0,shouldSelectOnPressUp:!0,focusOnPointerEnter:!0,layout:U,state:e,shouldUseVirtualFocus:!0,renderEmptyState:()=>l!=="loading"&&le.createElement("span",{className:ct(Tn(ji),"no-results")},D.format("noResults")),UNSAFE_className:ct(Tn(ji),"tray-listbox"),ref:M,onScroll:fe,onLoadMore:o,isLoading:l==="loading"||l==="loadingMore"}),le.createElement(hp,{onDismiss:h})))}function l3e(t,e){return t=Tx(t),t.placeholder&&console.warn("Placeholders are deprecated due to accessibility issues. Please use help text instead. See the docs for details: https://react-spectrum.adobe.com/react-spectrum/ComboBox.html#help-text"),N2e()?le.createElement(s3e,{...t,menuTrigger:"input",ref:e}):le.createElement(c3e,{...t,ref:e})}const c3e=le.forwardRef(function(e,n){let{menuTrigger:r="input",shouldFlip:i=!0,direction:s="bottom",isQuiet:l,loadingState:o,onLoadMore:h}=e,p=dc(Tn(o0)),b=o!=null,x=te.useRef(),w=kF(x),A=te.useRef(),L=kF(A),M=te.useRef(),U=te.useRef(),D=s0(n,U),{contains:$}=zj({sensitivity:"base"}),N=Yq({...e,defaultFilter:$,allowsEmptyCollection:b}),B=K$(N),{buttonProps:Z,inputProps:ie,listBoxProps:re,labelProps:ve,descriptionProps:Te,errorMessageProps:Ae}=Zq({...e,keyboardDelegate:B,buttonRef:L,popoverRef:w,listBoxRef:M,inputRef:U,menuTrigger:r},N),[fe,Pe]=te.useState(null),{scale:_e}=rh(),ke=te.useCallback(()=>{if(L.current&&U.current){let ut=L.current.offsetWidth,rn=U.current.offsetWidth;Pe(ut+rn)}},[L,U,Pe]);P$({ref:D,onResize:ke}),Ar(ke,[_e,ke]);let Vt={width:l?null:fe,minWidth:l?`calc(${fe}px + calc(2 * var(--spectrum-dropdown-quiet-offset)))`:fe};return le.createElement(le.Fragment,null,le.createElement(G$,{...e,descriptionProps:Te,errorMessageProps:Ae,labelProps:ve,ref:D},le.createElement(u3e,{...e,isOpen:N.isOpen,loadingState:o,inputProps:ie,inputRef:U,triggerProps:Z,triggerRef:A})),le.createElement(LEe,{state:N,UNSAFE_style:Vt,UNSAFE_className:ct(Tn(Rn),"spectrum-InputGroup-popover",{"spectrum-InputGroup-popover--quiet":l}),ref:x,triggerRef:L,scrollRef:M,placement:`${s} end`,hideArrow:!0,isNonModal:!0,shouldFlip:i},le.createElement(X$,{...re,ref:M,disallowEmptySelection:!0,autoFocus:N.focusStrategy,shouldSelectOnPressUp:!0,focusOnPointerEnter:!0,layout:B,state:N,shouldUseVirtualFocus:!0,isLoading:o==="loadingMore",onLoadMore:h,renderEmptyState:()=>b&&le.createElement("span",{className:ct(Tn(ji),"no-results")},o==="loading"?p.format("loading"):p.format("noResults"))})))}),u3e=le.forwardRef(function(e,n){let{isQuiet:r,isDisabled:i,validationState:s,inputProps:l,inputRef:o,triggerProps:h,triggerRef:p,autoFocus:b,style:x,className:w,loadingState:A,isOpen:L,menuTrigger:M}=e,{hoverProps:U,isHovered:D}=Au({}),$=dc(Tn(o0)),N=te.useRef(null),[B,Z]=te.useState(!1),ie=le.createElement(H$,{"aria-label":$.format("loading"),size:"S",isIndeterminate:!0,UNSAFE_className:ct(Tn(Yr),"spectrum-Textfield-circleLoader",ct(Tn(Rn),"spectrum-InputGroup-input-circleLoader"))}),re=A==="loading"||A==="filtering",ve=l.value,Te=te.useRef(ve);return te.useEffect(()=>{re&&!B?(N.current===null&&(N.current=setTimeout(()=>{Z(!0)},500)),ve!==Te.current&&(clearTimeout(N.current),N.current=setTimeout(()=>{Z(!0)},500))):re||(Z(!1),clearTimeout(N.current),N.current=null),Te.current=ve},[re,B,ve]),le.createElement(Ap,{within:!0,isTextInput:!0,focusClass:ct(Tn(Rn),"is-focused"),focusRingClass:ct(Tn(Rn),"focus-ring"),autoFocus:b},le.createElement("div",{...U,ref:n,style:x,className:ct(Tn(Rn),"spectrum-InputGroup",{"spectrum-InputGroup--quiet":r,"is-disabled":i,"spectrum-InputGroup--invalid":s==="invalid"&&!i,"is-hovered":D},w)},le.createElement(pq,{inputProps:l,inputRef:o,UNSAFE_className:ct(Tn(Rn),"spectrum-InputGroup-field"),inputClassName:ct(Tn(Rn),"spectrum-InputGroup-input"),validationIconClassName:ct(Tn(Rn),"spectrum-InputGroup-input-validationIcon"),isDisabled:i,isQuiet:r,validationState:s,isLoading:B&&(L||M==="manual"||A==="loading"),loadingIndicator:A!=null&&ie,disableFocusRing:!0}),le.createElement(G2e,{preventFocusOnPress:!0,isPressed:L},le.createElement(cEe,{...h,ref:p,UNSAFE_className:ct(Tn(Rn),"spectrum-FieldButton"),isQuiet:r,validationState:s},le.createElement(XG,{UNSAFE_className:ct(Tn(Rn),"spectrum-Dropdown-chevron")})))))}),d3e=le.forwardRef(l3e);function h3e(t,e){t=Su(t);let{elementType:n="div",children:r,...i}=t,{styleProps:s}=mi(t,L2e),l=io(e);return le.createElement(n,{...Hi(i),...s,ref:l},le.createElement(k$,null,r))}const f3e=te.forwardRef(h3e);function p3e(t,e){t=Su(t,"header");let{children:n,...r}=t,{styleProps:i}=mi(r),s=io(e);return le.createElement("header",{...Hi(r),...i,ref:s},le.createElement(k$,null,n))}const m3e=te.forwardRef(p3e);function g3e(t){return t&&t.__esModule?t.default:t}function Lp(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var ih={};Lp(ih,"spectrum-Rule",()=>j4,t=>j4=t);Lp(ih,"spectrum-Rule--large",()=>G4,t=>G4=t);Lp(ih,"spectrum-Rule--medium",()=>W4,t=>W4=t);Lp(ih,"spectrum-Rule--small",()=>H4,t=>H4=t);Lp(ih,"spectrum-Rule--horizontal",()=>q4,t=>q4=t);Lp(ih,"spectrum-Rule--vertical",()=>K4,t=>K4=t);var j4,G4,W4,H4,q4,K4;j4="spectrum-Rule_612bb8";G4="spectrum-Rule--large_612bb8";W4="spectrum-Rule--medium_612bb8";H4="spectrum-Rule--small_612bb8";q4="spectrum-Rule--horizontal_612bb8";K4="spectrum-Rule--vertical_612bb8";let y3e={S:"small",M:"medium",L:"large"};function v3e(t,e){t=Su(t,"divider");let{size:n="L",orientation:r="horizontal",...i}=t,s=io(e),{styleProps:l}=mi(i),o=y3e[n],h="hr";r==="vertical"&&(h="div");let{separatorProps:p}=zW({...t,elementType:h});return le.createElement(h,{...l,className:ct(g3e(ih),"spectrum-Rule",`spectrum-Rule--${o}`,{"spectrum-Rule--vertical":r==="vertical","spectrum-Rule--horizontal":r==="horizontal"},l.className),ref:s,...p})}let cN=le.forwardRef(v3e);function eg(t){return t&&t.__esModule?t.default:t}function $a(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var $K={};$a($K,"spectrum--darkest",()=>X4,t=>X4=t);var X4;X4="spectrum--darkest_256eeb";var Pu={};$a(Pu,"spectrum",()=>Z4,t=>Z4=t);$a(Pu,"spectrum--medium",()=>Y4,t=>Y4=t);$a(Pu,"spectrum--large",()=>J4,t=>J4=t);$a(Pu,"spectrum--darkest",()=>Q4,t=>Q4=t);$a(Pu,"spectrum--dark",()=>eR,t=>eR=t);$a(Pu,"spectrum--light",()=>tR,t=>tR=t);$a(Pu,"spectrum--lightest",()=>nR,t=>nR=t);var Z4,Y4,J4,Q4,eR,tR,nR;Z4="spectrum_9e130c";Y4="spectrum--medium_9e130c";J4="spectrum--large_9e130c";Q4="spectrum--darkest_9e130c";eR="spectrum--dark_9e130c";tR="spectrum--light_9e130c";nR="spectrum--lightest_9e130c";var kK={};$a(kK,"spectrum--large",()=>rR,t=>rR=t);var rR;rR="spectrum--large_c40598";var OK={};$a(OK,"spectrum--lightest",()=>iR,t=>iR=t);var iR;iR="spectrum--lightest_ddefb6";var DK={};$a(DK,"spectrum--medium",()=>sR,t=>sR=t);var sR;sR="spectrum--medium_4b172c";let _3e={global:eg(Pu),light:eg(OK),dark:eg($K),medium:eg(DK),large:eg(kK)};const b3e=()=>{const t=Ja(Sj);if(t===null)return null;const e=t.users.map(n=>({id:n.user_id,label:n.user_id}));return Yt.jsxs("div",{children:[Yt.jsxs(m3e,{children:["Group has ",t.users.length," Users"]}),Yt.jsx("div",{style:{height:"200px",overflowY:"auto"},children:Yt.jsx(QSe,{children:e.map(n=>Yt.jsx(Pj,{id:n.id,children:n.label}))})})]})},x3e=()=>{const t=Ja(Fwe);return Yt.jsxs(f3e,{children:[Yt.jsxs(i1,{children:["Run: ",t.name]}),Yt.jsxs(Ta,{direction:"row",justifyContent:"space-between",children:[Yt.jsx(wa,{children:"Target Min Cluster Size"})," ",t.minOccupancy??"None"]}),Yt.jsxs(Ta,{direction:"row",justifyContent:"space-between",children:[Yt.jsx(wa,{children:"Target Max Cluster Size "}),t.maxOccupancy??"None"]}),Yt.jsxs(Ta,{direction:"row",justifyContent:"space-between",children:[Yt.jsx(wa,{children:"Max iterations "}),t.maxIters??"10"]}),Yt.jsxs(Ta,{direction:"row",justifyContent:"space-between",children:[Yt.jsx(wa,{children:"Strategy  "}),t.meetingPointMethod]})]})};var O={},w3e={get exports(){return O},set exports(t){O=t}},T3e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",E3e=T3e,S3e=E3e;function FK(){}function NK(){}NK.resetWarningCache=FK;var A3e=function(){function t(r,i,s,l,o,h){if(h!==S3e){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:NK,resetWarningCache:FK};return n.PropTypes=n,n};w3e.exports=A3e();var a1={},P3e={get exports(){return a1},set exports(t){a1=t}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var r=[],i=0;i<arguments.length;i++){var s=arguments[i];if(s){var l=typeof s;if(l==="string"||l==="number")r.push(s);else if(Array.isArray(s)){if(s.length){var o=n.apply(null,s);o&&r.push(o)}}else if(l==="object"){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){r.push(s.toString());continue}for(var h in s)e.call(s,h)&&s[h]&&r.push(h)}}}return r.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(P3e);const Xo=a1;var C3e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},L3e=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n};function Nf(t){var e=t.top,n=e===void 0?0:e,r=t.left,i=r===void 0?0:r,s=t.transform,l=t.className,o=t.children,h=L3e(t,["top","left","transform","className","children"]);return le.createElement("g",C3e({className:Xo("vx-group",l),transform:s||"translate("+i+", "+n+")"},h),o)}function zK(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function I3e(t){return t.length===1&&(t=R3e(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)<0?r=s+1:i=s}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var s=r+i>>>1;t(e[s],n)>0?i=s:r=s+1}return r}}}function R3e(t){return function(e,n){return zK(t(e),n)}}var M3e=I3e(zK),Z$=M3e.right;function oR(t,e){var n=t.length,r=-1,i,s,l;if(e==null){for(;++r<n;)if((i=t[r])!=null&&i>=i)for(s=l=i;++r<n;)(i=t[r])!=null&&(s>i&&(s=i),l<i&&(l=i))}else for(;++r<n;)if((i=e(t[r],r,t))!=null&&i>=i)for(s=l=i;++r<n;)(i=e(t[r],r,t))!=null&&(s>i&&(s=i),l<i&&(l=i));return[s,l]}var $3e=Array.prototype,k3e=$3e.slice;function u_(t){return function(){return t}}function O3e(t){return t}function BK(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}var aR=Math.sqrt(50),lR=Math.sqrt(10),cR=Math.sqrt(2);function UK(t,e,n){var r,i=-1,s,l,o;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(s=t,t=e,e=s),(o=Ed(t,e,n))===0||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),l=new Array(s=Math.ceil(e-t+1));++i<s;)l[i]=(t+i)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),l=new Array(s=Math.ceil(t-e+1));++i<s;)l[i]=(t-i)/o;return r&&l.reverse(),l}function Ed(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),s=r/Math.pow(10,i);return i>=0?(s>=aR?10:s>=lR?5:s>=cR?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(s>=aR?10:s>=lR?5:s>=cR?2:1)}function Y$(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),s=r/i;return s>=aR?i*=10:s>=lR?i*=5:s>=cR&&(i*=2),e<t?-i:i}function D3e(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1}function F3e(){var t=O3e,e=oR,n=D3e;function r(i){var s,l=i.length,o,h=new Array(l);for(s=0;s<l;++s)h[s]=t(i[s],s,i);var p=e(h),b=p[0],x=p[1],w=n(h,b,x);Array.isArray(w)||(w=Y$(b,x,w),w=BK(Math.ceil(b/w)*w,x,w));for(var A=w.length;w[0]<=b;)w.shift(),--A;for(;w[A-1]>x;)w.pop(),--A;var L=new Array(A+1),M;for(s=0;s<=A;++s)M=L[s]=[],M.x0=s>0?w[s-1]:b,M.x1=s<A?w[s]:x;for(s=0;s<l;++s)o=h[s],b<=o&&o<=x&&L[Z$(w,o,0,A)].push(i[s]);return L}return r.value=function(i){return arguments.length?(t=typeof i=="function"?i:u_(i),r):t},r.domain=function(i){return arguments.length?(e=typeof i=="function"?i:u_([i[0],i[1]]),r):e},r.thresholds=function(i){return arguments.length?(n=typeof i=="function"?i:Array.isArray(i)?u_(k3e.call(i)):u_(i),r):n},r}function N3e(t,e){var n=t.length,r=-1,i,s;if(e==null){for(;++r<n;)if((i=t[r])!=null&&i>=i)for(s=i;++r<n;)(i=t[r])!=null&&i>s&&(s=i)}else for(;++r<n;)if((i=e(t[r],r,t))!=null&&i>=i)for(s=i;++r<n;)(i=e(t[r],r,t))!=null&&i>s&&(s=i);return s}function J$(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var Go="$";function l1(){}l1.prototype=c1.prototype={constructor:l1,has:function(t){return Go+t in this},get:function(t){return this[Go+t]},set:function(t,e){return this[Go+t]=e,this},remove:function(t){var e=Go+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===Go&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===Go&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===Go&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===Go&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===Go&&++t;return t},empty:function(){for(var t in this)if(t[0]===Go)return!1;return!0},each:function(t){for(var e in this)e[0]===Go&&t(this[e],e.slice(1),this)}};function c1(t,e){var n=new l1;if(t instanceof l1)t.each(function(o,h){n.set(h,o)});else if(Array.isArray(t)){var r=-1,i=t.length,s;if(e==null)for(;++r<i;)n.set(r,t[r]);else for(;++r<i;)n.set(e(s=t[r],r,t),s)}else if(t)for(var l in t)n.set(l,t[l]);return n}function uN(){}var sd=c1.prototype;uN.prototype={constructor:uN,has:sd.has,add:function(t){return t+="",this[Go+t]=t,this},remove:sd.remove,clear:sd.clear,values:sd.keys,size:sd.size,empty:sd.empty,each:sd.each};var VK=Array.prototype,z3e=VK.map,uR=VK.slice,dN={name:"implicit"};function jK(){var t=c1(),e=[],n=[],r=dN;function i(s){var l=s+"",o=t.get(l);if(!o){if(r!==dN)return r;t.set(l,o=e.push(s))}return n[(o-1)%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=c1();for(var l=-1,o=s.length,h,p;++l<o;)t.has(p=(h=s[l])+"")||t.set(p,e.push(h));return i},i.range=function(s){return arguments.length?(n=uR.call(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return jK(e,n).unknown(r)},J$.apply(i,arguments),i}function GK(){var t=jK().unknown(void 0),e=t.domain,n=t.range,r=[0,1],i,s,l=!1,o=0,h=0,p=.5;delete t.unknown;function b(){var x=e().length,w=r[1]<r[0],A=r[w-0],L=r[1-w];i=(L-A)/Math.max(1,x-o+h*2),l&&(i=Math.floor(i)),A+=(L-A-i*(x-o))*p,s=i*(1-o),l&&(A=Math.round(A),s=Math.round(s));var M=BK(x).map(function(U){return A+i*U});return n(w?M.reverse():M)}return t.domain=function(x){return arguments.length?(e(x),b()):e()},t.range=function(x){return arguments.length?(r=[+x[0],+x[1]],b()):r.slice()},t.rangeRound=function(x){return r=[+x[0],+x[1]],l=!0,b()},t.bandwidth=function(){return s},t.step=function(){return i},t.round=function(x){return arguments.length?(l=!!x,b()):l},t.padding=function(x){return arguments.length?(o=Math.min(1,h=+x),b()):o},t.paddingInner=function(x){return arguments.length?(o=Math.min(1,x),b()):o},t.paddingOuter=function(x){return arguments.length?(h=+x,b()):h},t.align=function(x){return arguments.length?(p=Math.max(0,Math.min(1,x)),b()):p},t.copy=function(){return GK(e(),r).round(l).paddingInner(o).paddingOuter(h).align(p)},J$.apply(b(),arguments)}function Ax(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Q$(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Ip(){}var qd=.7,pp=1/qd,zf="\\s*([+-]?\\d+)\\s*",Ty="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ll="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",B3e=/^#([0-9a-f]{3,8})$/,U3e=new RegExp("^rgb\\("+[zf,zf,zf]+"\\)$"),V3e=new RegExp("^rgb\\("+[ll,ll,ll]+"\\)$"),j3e=new RegExp("^rgba\\("+[zf,zf,zf,Ty]+"\\)$"),G3e=new RegExp("^rgba\\("+[ll,ll,ll,Ty]+"\\)$"),W3e=new RegExp("^hsl\\("+[Ty,ll,ll]+"\\)$"),H3e=new RegExp("^hsla\\("+[Ty,ll,ll,Ty]+"\\)$"),hN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ax(Ip,Ey,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:fN,formatHex:fN,formatHsl:q3e,formatRgb:pN,toString:pN});function fN(){return this.rgb().formatHex()}function q3e(){return HK(this).formatHsl()}function pN(){return this.rgb().formatRgb()}function Ey(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=B3e.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?mN(e):n===3?new Ns(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?d_(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?d_(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=U3e.exec(t))?new Ns(e[1],e[2],e[3],1):(e=V3e.exec(t))?new Ns(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=j3e.exec(t))?d_(e[1],e[2],e[3],e[4]):(e=G3e.exec(t))?d_(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=W3e.exec(t))?vN(e[1],e[2]/100,e[3]/100,1):(e=H3e.exec(t))?vN(e[1],e[2]/100,e[3]/100,e[4]):hN.hasOwnProperty(t)?mN(hN[t]):t==="transparent"?new Ns(NaN,NaN,NaN,0):null}function mN(t){return new Ns(t>>16&255,t>>8&255,t&255,1)}function d_(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ns(t,e,n,r)}function WK(t){return t instanceof Ip||(t=Ey(t)),t?(t=t.rgb(),new Ns(t.r,t.g,t.b,t.opacity)):new Ns}function dR(t,e,n,r){return arguments.length===1?WK(t):new Ns(t,e,n,r??1)}function Ns(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Ax(Ns,dR,Q$(Ip,{brighter:function(t){return t=t==null?pp:Math.pow(pp,t),new Ns(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?qd:Math.pow(qd,t),new Ns(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gN,formatHex:gN,formatRgb:yN,toString:yN}));function gN(){return"#"+jT(this.r)+jT(this.g)+jT(this.b)}function yN(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function jT(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function vN(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new nl(t,e,n,r)}function HK(t){if(t instanceof nl)return new nl(t.h,t.s,t.l,t.opacity);if(t instanceof Ip||(t=Ey(t)),!t)return new nl;if(t instanceof nl)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),l=NaN,o=s-i,h=(s+i)/2;return o?(e===s?l=(n-r)/o+(n<r)*6:n===s?l=(r-e)/o+2:l=(e-n)/o+4,o/=h<.5?s+i:2-s-i,l*=60):o=h>0&&h<1?0:l,new nl(l,o,h,t.opacity)}function K3e(t,e,n,r){return arguments.length===1?HK(t):new nl(t,e,n,r??1)}function nl(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Ax(nl,K3e,Q$(Ip,{brighter:function(t){return t=t==null?pp:Math.pow(pp,t),new nl(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?qd:Math.pow(qd,t),new nl(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ns(GT(t>=240?t-240:t+120,i,r),GT(t,i,r),GT(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function GT(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}var X3e=Math.PI/180,Z3e=180/Math.PI,qK=-.14861,ek=1.78277,tk=-.29227,Px=-.90649,Sy=1.97294,_N=Sy*Px,bN=Sy*ek,xN=ek*tk-Px*qK;function Y3e(t){if(t instanceof Sd)return new Sd(t.h,t.s,t.l,t.opacity);t instanceof Ns||(t=WK(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(xN*r+_N*e-bN*n)/(xN+_N-bN),s=r-i,l=(Sy*(n-i)-tk*s)/Px,o=Math.sqrt(l*l+s*s)/(Sy*i*(1-i)),h=o?Math.atan2(l,s)*Z3e-120:NaN;return new Sd(h<0?h+360:h,o,i,t.opacity)}function dl(t,e,n,r){return arguments.length===1?Y3e(t):new Sd(t,e,n,r??1)}function Sd(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Ax(Sd,dl,Q$(Ip,{brighter:function(t){return t=t==null?pp:Math.pow(pp,t),new Sd(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?qd:Math.pow(qd,t),new Sd(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*X3e,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Ns(255*(e+n*(qK*r+ek*i)),255*(e+n*(tk*r+Px*i)),255*(e+n*(Sy*r)),this.opacity)}}));function Cx(t){return function(){return t}}function KK(t,e){return function(n){return t+n*e}}function J3e(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Q3e(t,e){var n=e-t;return n?KK(t,n>180||n<-180?n-360*Math.round(n/360):n):Cx(isNaN(t)?e:t)}function eAe(t){return(t=+t)==1?Bf:function(e,n){return n-e?J3e(e,n,t):Cx(isNaN(e)?n:e)}}function Bf(t,e){var n=e-t;return n?KK(t,n):Cx(isNaN(t)?e:t)}const wN=function t(e){var n=eAe(e);function r(i,s){var l=n((i=dR(i)).r,(s=dR(s)).r),o=n(i.g,s.g),h=n(i.b,s.b),p=Bf(i.opacity,s.opacity);return function(b){return i.r=l(b),i.g=o(b),i.b=h(b),i.opacity=p(b),i+""}}return r.gamma=t,r}(1);function tAe(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function nAe(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function rAe(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),l;for(l=0;l<r;++l)i[l]=a0(t[l],e[l]);for(;l<n;++l)s[l]=e[l];return function(o){for(l=0;l<r;++l)s[l]=i[l](o);return s}}function iAe(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function va(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function sAe(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=a0(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var hR=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,WT=new RegExp(hR.source,"g");function oAe(t){return function(){return t}}function aAe(t){return function(e){return t(e)+""}}function lAe(t,e){var n=hR.lastIndex=WT.lastIndex=0,r,i,s,l=-1,o=[],h=[];for(t=t+"",e=e+"";(r=hR.exec(t))&&(i=WT.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[l]?o[l]+=s:o[++l]=s),(r=r[0])===(i=i[0])?o[l]?o[l]+=i:o[++l]=i:(o[++l]=null,h.push({i:l,x:va(r,i)})),n=WT.lastIndex;return n<e.length&&(s=e.slice(n),o[l]?o[l]+=s:o[++l]=s),o.length<2?h[0]?aAe(h[0].x):oAe(e):(e=h.length,function(p){for(var b=0,x;b<e;++b)o[(x=h[b]).i]=x.x(p);return o.join("")})}function a0(t,e){var n=typeof e,r;return e==null||n==="boolean"?Cx(e):(n==="number"?va:n==="string"?(r=Ey(e))?(e=r,wN):lAe:e instanceof Ey?wN:e instanceof Date?iAe:nAe(e)?tAe:Array.isArray(e)?rAe:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?sAe:va)(t,e)}function XK(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var TN=180/Math.PI,EN={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function cAe(t,e,n,r,i,s){var l,o,h;return(l=Math.sqrt(t*t+e*e))&&(t/=l,e/=l),(h=t*n+e*r)&&(n-=t*h,r-=e*h),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,h/=o),t*r<e*n&&(t=-t,e=-e,h=-h,l=-l),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*TN,skewX:Math.atan(h)*TN,scaleX:l,scaleY:o}}var h_;function uAe(t){return t==null||(h_||(h_=document.createElementNS("http://www.w3.org/2000/svg","g")),h_.setAttribute("transform",t),!(t=h_.transform.baseVal.consolidate()))?EN:(t=t.matrix,cAe(t.a,t.b,t.c,t.d,t.e,t.f))}function dAe(t,e,n,r){function i(p){return p.length?p.pop()+" ":""}function s(p,b,x,w,A,L){if(p!==x||b!==w){var M=A.push("translate(",null,e,null,n);L.push({i:M-4,x:va(p,x)},{i:M-2,x:va(b,w)})}else(x||w)&&A.push("translate("+x+e+w+n)}function l(p,b,x,w){p!==b?(p-b>180?b+=360:b-p>180&&(p+=360),w.push({i:x.push(i(x)+"rotate(",null,r)-2,x:va(p,b)})):b&&x.push(i(x)+"rotate("+b+r)}function o(p,b,x,w){p!==b?w.push({i:x.push(i(x)+"skewX(",null,r)-2,x:va(p,b)}):b&&x.push(i(x)+"skewX("+b+r)}function h(p,b,x,w,A,L){if(p!==x||b!==w){var M=A.push(i(A)+"scale(",null,",",null,")");L.push({i:M-4,x:va(p,x)},{i:M-2,x:va(b,w)})}else(x!==1||w!==1)&&A.push(i(A)+"scale("+x+","+w+")")}return function(p,b){var x=[],w=[];return p=t(p),b=t(b),s(p.translateX,p.translateY,b.translateX,b.translateY,x,w),l(p.rotate,b.rotate,x,w),o(p.skewX,b.skewX,x,w),h(p.scaleX,p.scaleY,b.scaleX,b.scaleY,x,w),p=b=null,function(A){for(var L=-1,M=w.length,U;++L<M;)x[(U=w[L]).i]=U.x(A);return x.join("")}}}var hAe=dAe(uAe,", ",")",")");function ZK(t){return function e(n){n=+n;function r(i,s){var l=t((i=dl(i)).h,(s=dl(s)).h),o=Bf(i.s,s.s),h=Bf(i.l,s.l),p=Bf(i.opacity,s.opacity);return function(b){return i.h=l(b),i.s=o(b),i.l=h(Math.pow(b,n)),i.opacity=p(b),i+""}}return r.gamma=e,r}(1)}ZK(Q3e);var nk=ZK(Bf);function fAe(t){return function(){return t}}function pAe(t){return+t}var SN=[0,1];function bf(t){return t}function fR(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:fAe(isNaN(e)?NaN:.5)}function AN(t){var e=t[0],n=t[t.length-1],r;return e>n&&(r=e,e=n,n=r),function(i){return Math.max(e,Math.min(n,i))}}function mAe(t,e,n){var r=t[0],i=t[1],s=e[0],l=e[1];return i<r?(r=fR(i,r),s=n(l,s)):(r=fR(r,i),s=n(s,l)),function(o){return s(r(o))}}function gAe(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),l=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=fR(t[l],t[l+1]),s[l]=n(e[l],e[l+1]);return function(o){var h=Z$(t,o,1,r)-1;return s[h](i[h](o))}}function yAe(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function vAe(){var t=SN,e=SN,n=a0,r,i,s,l=bf,o,h,p;function b(){return o=Math.min(t.length,e.length)>2?gAe:mAe,h=p=null,x}function x(w){return isNaN(w=+w)?s:(h||(h=o(t.map(r),e,n)))(r(l(w)))}return x.invert=function(w){return l(i((p||(p=o(e,t.map(r),va)))(w)))},x.domain=function(w){return arguments.length?(t=z3e.call(w,pAe),l===bf||(l=AN(t)),b()):t.slice()},x.range=function(w){return arguments.length?(e=uR.call(w),b()):e.slice()},x.rangeRound=function(w){return e=uR.call(w),n=XK,b()},x.clamp=function(w){return arguments.length?(l=w?AN(t):bf,x):l!==bf},x.interpolate=function(w){return arguments.length?(n=w,b()):n},x.unknown=function(w){return arguments.length?(s=w,x):s},function(w,A){return r=w,i=A,b()}}function _Ae(t,e){return vAe()(t,e)}function bAe(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function u1(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function mp(t){return t=u1(Math.abs(t)),t?t[1]:NaN}function xAe(t,e){return function(n,r){for(var i=n.length,s=[],l=0,o=t[0],h=0;i>0&&o>0&&(h+o+1>r&&(o=Math.max(1,r-h)),s.push(n.substring(i-=o,i+o)),!((h+=o+1)>r));)o=t[l=(l+1)%t.length];return s.reverse().join(e)}}function wAe(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var TAe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ay(t){if(!(e=TAe.exec(t)))throw new Error("invalid format: "+t);var e;return new rk({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Ay.prototype=rk.prototype;function rk(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}rk.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function EAe(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var YK;function SAe(t,e){var n=u1(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(YK=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return s===l?r:s>l?r+new Array(s-l+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+u1(t,Math.max(0,e+s-1))[0]}function PN(t,e){var n=u1(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const CN={"%":function(t,e){return(t*100).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:bAe,e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return PN(t*100,e)},r:PN,s:SAe,X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function LN(t){return t}var IN=Array.prototype.map,RN=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function AAe(t){var e=t.grouping===void 0||t.thousands===void 0?LN:xAe(IN.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?LN:wAe(IN.call(t.numerals,String)),l=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"-":t.minus+"",h=t.nan===void 0?"NaN":t.nan+"";function p(x){x=Ay(x);var w=x.fill,A=x.align,L=x.sign,M=x.symbol,U=x.zero,D=x.width,$=x.comma,N=x.precision,B=x.trim,Z=x.type;Z==="n"?($=!0,Z="g"):CN[Z]||(N===void 0&&(N=12),B=!0,Z="g"),(U||w==="0"&&A==="=")&&(U=!0,w="0",A="=");var ie=M==="$"?n:M==="#"&&/[boxX]/.test(Z)?"0"+Z.toLowerCase():"",re=M==="$"?r:/[%p]/.test(Z)?l:"",ve=CN[Z],Te=/[defgprs%]/.test(Z);N=N===void 0?6:/[gprs]/.test(Z)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function Ae(fe){var Pe=ie,_e=re,ke,Vt,ut;if(Z==="c")_e=ve(fe)+_e,fe="";else{fe=+fe;var rn=fe<0||1/fe<0;if(fe=isNaN(fe)?h:ve(Math.abs(fe),N),B&&(fe=EAe(fe)),rn&&+fe==0&&L!=="+"&&(rn=!1),Pe=(rn?L==="("?L:o:L==="-"||L==="("?"":L)+Pe,_e=(Z==="s"?RN[8+YK/3]:"")+_e+(rn&&L==="("?")":""),Te){for(ke=-1,Vt=fe.length;++ke<Vt;)if(ut=fe.charCodeAt(ke),48>ut||ut>57){_e=(ut===46?i+fe.slice(ke+1):fe.slice(ke))+_e,fe=fe.slice(0,ke);break}}}$&&!U&&(fe=e(fe,1/0));var ot=Pe.length+fe.length+_e.length,yt=ot<D?new Array(D-ot+1).join(w):"";switch($&&U&&(fe=e(yt+fe,yt.length?D-_e.length:1/0),yt=""),A){case"<":fe=Pe+fe+_e+yt;break;case"=":fe=Pe+yt+fe+_e;break;case"^":fe=yt.slice(0,ot=yt.length>>1)+Pe+fe+_e+yt.slice(ot);break;default:fe=yt+Pe+fe+_e;break}return s(fe)}return Ae.toString=function(){return x+""},Ae}function b(x,w){var A=p((x=Ay(x),x.type="f",x)),L=Math.max(-8,Math.min(8,Math.floor(mp(w)/3)))*3,M=Math.pow(10,-L),U=RN[8+L/3];return function(D){return A(M*D)+U}}return{format:p,formatPrefix:b}}var f_,ik,sk;PAe({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function PAe(t){return f_=AAe(t),ik=f_.format,sk=f_.formatPrefix,f_}function JK(t){return Math.max(0,-mp(Math.abs(t)))}function QK(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(mp(e)/3)))*3-mp(Math.abs(t)))}function eX(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,mp(e)-mp(t))+1}function CAe(t,e,n,r){var i=Y$(t,e,n),s;switch(r=Ay(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=QK(i,l))&&(r.precision=s),sk(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=eX(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=JK(i))&&(r.precision=s-(r.type==="%")*2);break}}return ik(r)}function LAe(t){var e=t.domain;return t.ticks=function(n){var r=e();return UK(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return CAe(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,l=r[i],o=r[s],h;return o<l&&(h=l,l=o,o=h,h=i,i=s,s=h),h=Ed(l,o,n),h>0?(l=Math.floor(l/h)*h,o=Math.ceil(o/h)*h,h=Ed(l,o,n)):h<0&&(l=Math.ceil(l*h)/h,o=Math.floor(o*h)/h,h=Ed(l,o,n)),h>0?(r[i]=Math.floor(l/h)*h,r[s]=Math.ceil(o/h)*h,e(r)):h<0&&(r[i]=Math.ceil(l*h)/h,r[s]=Math.floor(o*h)/h,e(r)),t},t}function tX(){var t=_Ae(bf,bf);return t.copy=function(){return yAe(t,tX())},J$.apply(t,arguments),LAe(t)}var IAe=function(t){var e=t.range,n=t.rangeRound,r=t.domain,i=t.padding,s=t.paddingInner,l=t.paddingOuter,o=t.align,h=t.tickFormat,p=GK();return p.type="band",e&&p.range(e),n&&p.rangeRound(n),r&&p.domain(r),i&&p.padding(i),s&&p.paddingInner(s),l&&p.paddingOuter(l),o&&p.align(o),h&&(p.tickFormat=h),p},MN=function(t){var e=t.range,n=t.rangeRound,r=t.domain,i=t.nice,s=i===void 0?!1:i,l=t.clamp,o=l===void 0?!1:l,h=tX();return h.type="linear",e&&h.range(e),n&&h.rangeRound(n),r&&h.domain(r),s&&h.nice(),o&&h.clamp(!0),h},nX={},RAe=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},MAe=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),Vl=function(){function t(e){var n=e.x,r=n===void 0?0:n,i=e.y,s=i===void 0?0:i;RAe(this,t),this.x=r,this.y=s}return MAe(t,[{key:"value",value:function(){return{x:this.x,y:this.y}}},{key:"toArray",value:function(){return[this.x,this.y]}}]),t}();const $Ae=Object.freeze(Object.defineProperty({__proto__:null,Point:Vl},Symbol.toStringTag,{value:"Module"})),kAe=lz($Ae);Object.defineProperty(nX,"__esModule",{value:!0});var OAe=nX.default=DAe,$N=kAe;function DAe(t,e){if(t){if(t.target)for(e=t,t=e.target.ownerSVGElement;t.ownerSVGElement;)t=t.ownerSVGElement;var n=e,r=n.clientX,i=n.clientY;if(e.changedTouches&&(r=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY),t.createSVGPoint){var s=t.createSVGPoint();return s.x=r,s.y=i,s=s.matrixTransform(t.getScreenCTM().inverse()),new $N.Point({x:s.x,y:s.y})}var l=t.getBoundingClientRect();return new $N.Point({x:r-l.left-t.clientLeft,y:i-l.top-t.clientTop})}}var Lx={};Object.defineProperty(Lx,"__esModule",{value:!0});Lx.withTooltipPropTypes=void 0;var kN=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},FAe=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),NAe=Lx.default=GAe,zAe=te,HT=rX(zAe),BAe=O,od=rX(BAe);function rX(t){return t&&t.__esModule?t:{default:t}}function UAe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VAe(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t}function jAe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Lx.withTooltipPropTypes={tooltipOpen:od.default.bool,tooltipLeft:od.default.number,tooltipTop:od.default.number,tooltipData:od.default.object,updateTooltip:od.default.func,showTooltip:od.default.func,hideTooltip:od.default.func};function GAe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{style:{position:"relative",width:"inherit",height:"inherit"}},n=function(r){jAe(i,r);function i(s){UAe(this,i);var l=VAe(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,s));return l.state={tooltipOpen:!1,tooltipLeft:void 0,tooltipTop:void 0,tooltipData:void 0},l.updateTooltip=l.updateTooltip.bind(l),l.showTooltip=l.showTooltip.bind(l),l.hideTooltip=l.hideTooltip.bind(l),l}return FAe(i,[{key:"updateTooltip",value:function(l){var o=l.tooltipOpen,h=l.tooltipLeft,p=l.tooltipTop,b=l.tooltipData;this.setState(function(x){return kN({},x,{tooltipOpen:o,tooltipLeft:h,tooltipTop:p,tooltipData:b})})}},{key:"showTooltip",value:function(l){var o=l.tooltipLeft,h=l.tooltipTop,p=l.tooltipData;this.updateTooltip({tooltipOpen:!0,tooltipLeft:o,tooltipTop:h,tooltipData:p})}},{key:"hideTooltip",value:function(){this.updateTooltip({tooltipOpen:!1,tooltipLeft:void 0,tooltipTop:void 0,tooltipData:void 0})}},{key:"render",value:function(){return HT.default.createElement("div",e,HT.default.createElement(t,kN({updateTooltip:this.updateTooltip,showTooltip:this.showTooltip,hideTooltip:this.hideTooltip},this.state,this.props)))}}]),i}(HT.default.PureComponent);return n}var ok={},WAe=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},HAe=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),qAe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},KAe=function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},XAe=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t},ON={top:0,right:0,bottom:0,left:0,width:0,height:0},DN=O.shape({top:O.number.isRequired,right:O.number.isRequired,bottom:O.number.isRequired,left:O.number.isRequired,width:O.number.isRequired,height:O.number.isRequired}),ZAe={getRects:O.func,rect:DN,parentRect:DN};function YAe(t){var e=function(n){KAe(r,n);function r(i){WAe(this,r);var s=XAe(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,i));return s.state={rect:void 0,parentRect:void 0},s.getRects=s.getRects.bind(s),s}return HAe(r,[{key:"componentDidMount",value:function(){var s=this;this.node=vd.findDOMNode(this),this.setState(function(){return s.getRects()})}},{key:"getRects",value:function(){if(!this.node)return this.state;var s=this.node,l=this.node.parentNode,o=s.getBoundingClientRect?s.getBoundingClientRect():ON,h=l&&l.getBoundingClientRect?l.getBoundingClientRect():ON;return{rect:o,parentRect:h}}},{key:"render",value:function(){return le.createElement(t,qAe({getRects:this.getRects},this.state,this.props))}}]),r}(le.PureComponent);return e.propTypes=t.propTypes,e.defaultProps=t.defaultProps,e.displayName="withBoundingRects("+(t.displayName||"")+")",e}const JAe=Object.freeze(Object.defineProperty({__proto__:null,withBoundingRects:YAe,withBoundingRectsProps:ZAe},Symbol.toStringTag,{value:"Module"})),QAe=lz(JAe);var ak={};Object.defineProperty(ak,"__esModule",{value:!0});var FN=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};ak.default=iX;var ePe=te,tPe=lk(ePe),nPe=O,Fl=lk(nPe),rPe=a1,iPe=lk(rPe);function lk(t){return t&&t.__esModule?t:{default:t}}function sPe(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function iX(t){var e=t.className,n=t.top,r=t.left,i=t.style,s=t.children,l=sPe(t,["className","top","left","style","children"]);return tPe.default.createElement("div",FN({className:(0,iPe.default)("vx-tooltip-portal",e),style:FN({position:"absolute",backgroundColor:"white",color:"#666666",padding:".3rem .5rem",borderRadius:"3px",fontSize:"14px",boxShadow:"0 1px 2px rgba(33,33,33,0.2)",lineHeight:"1em",pointerEvents:"none",top:n,left:r},i)},l),s)}iX.propTypes={left:Fl.default.oneOfType([Fl.default.number,Fl.default.string]),top:Fl.default.oneOfType([Fl.default.number,Fl.default.string]),className:Fl.default.string,style:Fl.default.object,children:Fl.default.any};Object.defineProperty(ok,"__esModule",{value:!0});var pR=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oPe=O,NN=ck(oPe),aPe=te,lPe=ck(aPe),sX=QAe,cPe=ak,oX=ck(cPe);function ck(t){return t&&t.__esModule?t:{default:t}}function uPe(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}var dPe=pR({},sX.withBoundingRectsProps,oX.default.propTypes,{offsetLeft:NN.default.number,offsetTop:NN.default.number}),hPe={};function uk(t){var e=t.left,n=t.top,r=t.offsetLeft,i=r===void 0?10:r,s=t.offsetTop,l=s===void 0?10:s,o=t.rect,h=t.parentRect;t.getRects;var p=t.children,b=t.style,x=uPe(t,["left","top","offsetLeft","offsetTop","rect","parentRect","getRects","children","style"]),w=e,A=n;return o&&h&&(w=i+o.right>h.right||i+o.right>window.innerWidth?w-o.width-i:w+i,A=l+o.bottom>h.bottom||l+o.bottom>window.innerHeight?A-o.height-l:A+l),lPe.default.createElement(oX.default,pR({style:pR({top:0,transform:"translate("+w+"px, "+A+"px)"},b)},x),p)}uk.propTypes=dPe;uk.defaultProps=hPe;var fPe=ok.default=(0,sX.withBoundingRects)(uk);function pPe(t,e){if(t==null)return{};var n,r,i={},s=Object.keys(t);for(r=0;r<s.length;r++)n=s[r],0<=e.indexOf(n)||(i[n]=t[n]);return i}function mPe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function p_(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Uf(){return Uf=Object.assign||function(t){for(var e,n=1;n<arguments.length;n++)for(var r in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Uf.apply(this,arguments)}var gPe={onMouseMove:O.func,onMouseLeave:O.func,tooltipData:O.any},yPe=Uf({},ok.withTooltipPropTypes,{children:O.oneOfType([O.object,O.func]).isRequired,className:O.string,HoverStyles:O.oneOfType([O.object,O.func]),renderTooltip:O.func,styles:O.objectOf(O.oneOfType([O.string,O.number])),TooltipComponent:O.oneOfType([O.object,O.func]),tooltipProps:O.object,tooltipTimeout:O.number}),vPe={className:null,HoverStyles:function(){return le.createElement("style",{type:"text/css"},`
      .vx-arc:hover,
      .vx-bar:hover,
      .vx-glyph-dot:hover {
        opacity: 0.7;
      }
    `)},renderTooltip:null,styles:{display:"inline-block",position:"relative"},TooltipComponent:fPe,tooltipProps:null,tooltipTimeout:200},mR=function(t){function e(r){var i;return i=t.call(this,r)||this,i.handleMouseMove=i.handleMouseMove.bind(p_(p_(i))),i.handleMouseLeave=i.handleMouseLeave.bind(p_(p_(i))),i.tooltipTimeout=null,i}mPe(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.tooltipTimeout&&clearTimeout(this.tooltipTimeout)},n.handleMouseMove=function(i){var s=i.event,l=i.datum,o=i.coords,h=pPe(i,["event","datum","coords"]),p=this.props.showTooltip;this.tooltipTimeout&&clearTimeout(this.tooltipTimeout);var b={x:0,y:0};s&&s.target&&s.type!=="focus"&&s.target.ownerSVGElement&&(b=OAe(s.target.ownerSVGElement,s)),b=Uf({},b,o),p({tooltipLeft:b.x,tooltipTop:b.y,tooltipData:Uf({event:s,datum:l},h)})},n.handleMouseLeave=function(){var i=this.props,s=i.tooltipTimeout,l=i.hideTooltip;this.tooltipTimeout=setTimeout(function(){l()},s)},n.render=function(){var i=this.props,s=i.children,l=i.className,o=i.HoverStyles,h=i.tooltipData,p=i.tooltipOpen,b=i.tooltipLeft,x=i.tooltipTop,w=i.tooltipProps,A=i.renderTooltip,L=i.styles,M=i.TooltipComponent,U={onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,tooltipData:h},D=A&&p&&M&&A(h);return le.createElement("div",{style:L,className:l},typeof s=="function"?s(U):le.cloneElement(le.Children.only(s),U),!!D&&le.createElement(M,Uf({key:Math.random(),top:x,left:b},w),D),o&&le.createElement(o,null))},e}(le.PureComponent);mR.propTypes=yPe,mR.defaultProps=vPe;const _Pe=NAe(mR);function bPe(t){return/axis/gi.test(t)}function aX(t){return/series/gi.test(t)}function xPe(t){var e=0;t.forEach(function(r){e+=isNaN(r.count)?0:r.count,r.cumulative=e});var n=e;t.forEach(function(r){r.density=r.count/n,r.cumulativeDensity=r.cumulative/n})}var lX=Array.prototype,wPe=lX.map,zN=lX.slice;function TPe(t){return function(){return t}}function EPe(t){return+t}var BN=[0,1];function cX(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:TPe(e)}function SPe(t){return function(e,n){var r=t(e=+e,n=+n);return function(i){return i<=e?0:i>=n?1:r(i)}}}function APe(t){return function(e,n){var r=t(e=+e,n=+n);return function(i){return i<=0?e:i>=1?n:r(i)}}}function PPe(t,e,n,r){var i=t[0],s=t[1],l=e[0],o=e[1];return s<i?(i=n(s,i),l=r(o,l)):(i=n(i,s),l=r(l,o)),function(h){return l(i(h))}}function CPe(t,e,n,r){var i=Math.min(t.length,e.length)-1,s=new Array(i),l=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)s[o]=n(t[o],t[o+1]),l[o]=r(e[o],e[o+1]);return function(h){var p=Z$(t,h,1,i)-1;return l[p](s[p](h))}}function LPe(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function IPe(t,e){var n=BN,r=BN,i=a0,s=!1,l,o,h;function p(){return l=Math.min(n.length,r.length)>2?CPe:PPe,o=h=null,b}function b(x){return(o||(o=l(n,r,s?SPe(t):t,i)))(+x)}return b.invert=function(x){return(h||(h=l(r,n,cX,s?APe(e):e)))(+x)},b.domain=function(x){return arguments.length?(n=wPe.call(x,EPe),p()):n.slice()},b.range=function(x){return arguments.length?(r=zN.call(x),p()):r.slice()},b.rangeRound=function(x){return r=zN.call(x),i=XK,p()},b.clamp=function(x){return arguments.length?(s=!!x,p()):s},b.interpolate=function(x){return arguments.length?(i=x,p()):i},p()}function RPe(t,e,n){var r=t[0],i=t[t.length-1],s=Y$(r,i,e??10),l;switch(n=Ay(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(r),Math.abs(i));return n.precision==null&&!isNaN(l=QK(s,o))&&(n.precision=l),sk(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(l=eX(s,Math.max(Math.abs(r),Math.abs(i))))&&(n.precision=l-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(l=JK(s))&&(n.precision=l-(n.type==="%")*2);break}}return ik(n)}function MPe(t){var e=t.domain;return t.ticks=function(n){var r=e();return UK(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){return RPe(e(),n,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,l=r[i],o=r[s],h;return o<l&&(h=l,l=o,o=h,h=i,i=s,s=h),h=Ed(l,o,n),h>0?(l=Math.floor(l/h)*h,o=Math.ceil(o/h)*h,h=Ed(l,o,n)):h<0&&(l=Math.ceil(l*h)/h,o=Math.floor(o*h)/h,h=Ed(l,o,n)),h>0?(r[i]=Math.floor(l/h)*h,r[s]=Math.ceil(o/h)*h,e(r)):h<0&&(r[i]=Math.ceil(l*h)/h,r[s]=Math.floor(o*h)/h,e(r)),t},t}function uX(){var t=IPe(cX,va);return t.copy=function(){return LPe(t,uX())},MPe(t)}function Cu(t){return t.match(/.{6}/g).map(function(e){return"#"+e})}Cu("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");Cu("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6");Cu("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9");Cu("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5");nk(dl(300,.5,0),dl(-240,.5,1));nk(dl(-100,.75,.35),dl(80,1.5,.8));nk(dl(260,.75,.35),dl(80,1.5,.8));dl();function Ix(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}Ix(Cu("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));Ix(Cu("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));Ix(Cu("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));Ix(Cu("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));var $Pe=10;function kPe(t){var e=t.allData,n=t.binCount,r=n===void 0?$Pe:n,i=t.binValues,s=t.limits,l=t.rawDataByIndex,o=t.valueAccessor,h=Array.isArray(i)?i.length:r,p={},b=F3e(),x=oR(e,o);if(i){var w=oR(i);x=[Math.min(w[0],x[0]),Math.max(w[1],x[1])]}var A=uX().domain(x).nice(h);return b.domain(s||A.domain()).thresholds(i||A.ticks(h)),Object.keys(l).forEach(function(L){var M=l[L],U=b.value(o)(M),D=U.length-1,$=U[D],N=U[D-1],B=N&&N.x1===$.x0&&$.x1===$.x0,Z=B?U.slice(0,-1):U;p[L]=Z.map(function(ie,re){return{bin0:ie.x0,bin1:ie.x0===ie.x1?re>0&&ie.x0+ie.x0-U[re-1].x0||ie.x1+1:ie.x1,data:[].concat(ie).concat(B&&(B&&re===D-1?$:[])),count:ie.length+(B&&re===D-1&&$.length||0),id:re.toString()}})}),p}function dX(t,e){return!t.toLowerCase||!e.toLowerCase?t-e:t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}var OPe=function(e,n){return dX(e.bin,n.bin)};function DPe(t){var e=t.rawDataByIndex,n=t.valueAccessor,r=t.binValues,i=r===void 0?null:r,s={};return Object.keys(e).forEach(function(l){var o=e[l],h={};o.forEach(function(p){var b=n(p);h[b]=h[b]||{bin:b,data:[],count:0,id:b},h[b].data.push(p),h[b].count+=1}),i?s[l]=i.map(function(p){return h[p]||{bin:p,count:0,data:[]}}):s[l]=Object.values(h).sort(OPe)}),s}function hX(t){return t&&t.type&&(t.type.displayName||t.type.name)||"Component"}function FPe(t){var e=[],n=[],r={},i={};return te.Children.forEach(t,function(s,l){var o=hX(s);if(aX(o)){var h=s.props.rawData,p=s.props.binnedData;h&&h.length>0&&(r[l]=h,e=e.concat(h)),p&&p.length>0&&(i[l]=p,n=n.concat(p))}}),{allBinnedData:n,allRawData:e,binnedDataByIndex:i,rawDataByIndex:r}}function NPe(t){var e=t.children,n=t.binCount,r=t.binType,i=t.binValues,s=t.limits,l=t.valueAccessor,o=FPe(e),h=o.allRawData,p=o.rawDataByIndex,b=o.binnedDataByIndex,x=b;if(Object.keys(b).length===0){var w=r==="numeric"?kPe:DPe;x=w({allData:h,rawDataByIndex:p,valueAccessor:l,limits:s,binCount:n,binValues:i})}return Object.values(x).forEach(function(A){xPe(A)}),x}function zPe(t){var e=t.binsByIndex,n=t.binType,r=t.valueKey,i=t.binValues,s,l;if(Object.values(e).forEach(function(h){var p=N3e(h,function(b){return b[r]});l?l[1]=Math.max(p,l[1]):l=[0,p],n==="numeric"?s?(s[0]=Math.min(h[0].bin0,s[0]),s[1]=Math.max(h[h.length-1].bin1,s[1])):s=[h[0].bin0,h[h.length-1].bin1]:(s||(s={}),h.forEach(function(b){s[b.bin]=!0}))}),Array.isArray(i)){var o=!0;i.forEach(function(h){h in s||(o=!1)}),o&&(s=i)}return Array.isArray(s)||(s=Object.keys(s).sort(dX)),{binDomain:s,valueDomain:l}}function BPe(t){var e=t.normalized,n=t.cumulative;return e&&n?"cumulativeDensity":n?"cumulative":e?"density":"count"}function UPe(t,e){var n=Object.keys(t),r=Object.keys(e);return n.length!==r.length?!1:n.every(function(i){return t[i]===e[i]})}var VPe=O.shape({id:O.string.isRequired,bin0:O.number.isRequired,bin1:O.number.isRequired,count:O.number.isRequired,cumulative:O.number,density:O.number,cumulativeDensity:O.number}),jPe=O.shape({id:O.string.isRequired,bin:O.string.isRequired,count:O.number.isRequired,cumulative:O.number,density:O.number,cumulativeDensity:O.number}),fX=O.arrayOf(O.oneOfType([VPe,jPe])),d1=O.shape({stroke:O.string,strokeWidth:O.number,label:O.shape({left:O.object,right:O.object,bottom:O.object,top:O.object})}),h1=O.shape({stroke:O.string,tickLength:O.number,label:O.shape({left:O.object,right:O.object,bottom:O.object,top:O.object})}),GPe=O.shape({stroke:O.string,strokeWidth:O.number}),WPe=O.shape({gridStyles:GPe,xAxisStyles:d1,xTickStyles:h1,yAxisStyles:d1,yTickStyles:h1});function HPe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function Kc(){return Kc=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kc.apply(this,arguments)}var qPe=Kc({},gPe,{ariaLabel:O.string.isRequired,binValues:O.arrayOf(O.oneOfType([O.number,O.string])),binCount:O.number,binType:O.oneOf(["numeric","categorical"]),children:O.node.isRequired,cumulative:O.bool,height:O.number.isRequired,horizontal:O.bool,limits:O.arrayOf(O.number),margin:O.shape({top:O.number,right:O.number,bottom:O.number,left:O.number}),normalized:O.bool,renderTooltip:O.func,theme:WPe,width:O.number.isRequired,valueAccessor:O.func}),pX={binCount:10,binType:"numeric",binValues:null,cumulative:!1,horizontal:!1,limits:null,margin:{top:32,right:32,bottom:64,left:64},normalized:!1,renderTooltip:null,theme:{},valueAccessor:function(e){return e}},Rx=function(t){HPe(e,t);function e(r){var i;return i=t.call(this,r)||this,i.state=i.getStateFromProps(r),i}var n=e.prototype;return n.componentWillReceiveProps=function(i){var s=this,l=!1;["width","height","children"].some(function(o){return s.props[o]!==i[o]})&&(l=!0),["margin"].some(function(o){return!UPe(s.props[o],i[o])})&&(l=!0),l&&this.setState(this.getStateFromProps(i))},n.getStateFromProps=function(i){var s=this.getDimmensions(i),l=this.getBinnedData(i),o=this.getScales(i,l,s);return Kc({binsByIndex:l},s,o)},n.getDimmensions=function(i){var s=i||this.props,l=s.margin,o=s.width,h=s.height,p=Kc({},pX.margin,l);return{margin:p,innerHeight:h-p.top-p.bottom,innerWidth:o-p.left-p.right}},n.getBinnedData=function(i){var s=i||this.props,l=s.children,o=s.binCount,h=s.binType,p=s.binValues,b=s.limits,x=s.valueAccessor;return NPe({children:l,binCount:o,binType:h,binValues:p,limits:b,valueAccessor:x})},n.getScales=function(i,s,l){var o=l.innerHeight,h=l.innerWidth,p=i||this.props,b=p.binType,x=p.binValues,w=p.cumulative,A=p.horizontal,L=p.normalized,M=b==="numeric"?MN:IAe,U=BPe({normalized:L,cumulative:w}),D=zPe({binsByIndex:s,binType:b,binValues:x,valueKey:U}),$=D.binDomain,N=D.valueDomain,B=A?[o,0]:[0,h],Z=A?[0,h]:[o,0];return A&&b==="categorical"&&B.reverse(),{binScale:M({range:B,domain:$}),valueScale:MN({range:Z,domain:N}),valueKey:U}},n.render=function(){var i=this.props.renderTooltip;if(i)return le.createElement(_Pe,{renderTooltip:i},le.createElement(e,Kc({},this.props,{renderTooltip:null})));var s=this.props,l=s.ariaLabel,o=s.binType,h=s.binValues,p=s.children,b=s.height,x=s.horizontal,w=s.onMouseLeave,A=s.onMouseMove,L=s.theme,M=s.valueAccessor,U=s.width,D=this.state,$=D.binsByIndex,N=D.binScale,B=D.innerHeight,Z=D.innerWidth,ie=D.margin,re=D.valueKey,ve=D.valueScale;return le.createElement("svg",{"aria-label":l,role:"img",width:U,height:b},le.createElement(Nf,{left:ie.left,top:ie.top},le.Children.map(p,function(Te,Ae){var fe=hX(Te);if(aX(fe)){var Pe=$[Ae];return le.cloneElement(Te,{binScale:N,binType:o,binnedData:Pe,horizontal:x,valueAccessor:M,valueKey:re,valueScale:ve,onMouseLeave:w,onMouseMove:A})}else if(bPe(fe)){var _e=fe[0].toLowerCase(),ke=fe==="XAxis"&&!x||fe==="YAxis"&&x?"bin":"value",Vt=Te.props.tickValues||(ke==="bin"&&h?h:null);return le.cloneElement(Te,{top:fe==="YAxis"||Te.props.orientation==="top"?0:B,left:fe==="XAxis"||Te.props.orientation==="left"?0:Z,label:Te.props.label||(ke==="value"?re:null),scale:ke==="value"?ve:N,axisStyles:Kc({},L[_e+"AxisStyles"],Te.props.axisStyles),tickStyles:Kc({},L[_e+"TickStyles"],Te.props.tickStyles),tickValues:Vt})}return Te})))},e}(le.PureComponent);Rx.propTypes=qPe;Rx.defaultProps=pX;Rx.displayName="Histogram";const KPe=Rx;var fu={red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e8f7ff","#ccedff","#a3daff","#72c3fc","#4dadf7","#329af0","#228ae6","#1c7cd6","#1b6ec2","#1862ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"]},Uc=fu.gray,mX=6,XPe=2,UN=function(t,e){t===void 0&&(t=mX),e===void 0&&(e=["cyan","yellow","pink","grape","blue","lime","teal","red","violet","orange","indigo","green"]);var n=Math.max(0,Math.min(t,fu.red.length-1));return e.map(function(r){return fu[r]&&fu[r][n]}).filter(function(r){return r})},qT="cyan";Object.keys(fu).sort();var xf=Uc[7];const ZPe={default:fu[qT][5],dark:fu[qT][7],light:fu[qT][3],disabled:xf,lightDisabled:Uc[3],text:xf,black:Uc[9],darkGray:Uc[8],lightGray:Uc[3],grid:Uc[4],gridDark:Uc[8],label:xf,tickLabel:xf,grays:Uc,categories:[].concat(UN(mX),UN(XPe))};function wf(){return wf=Object.assign||function(t){for(var e,n=1;n<arguments.length;n++)for(var r in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},wf.apply(this,arguments)}var m_=function(t){var e=t.fontFamily,n=t.fontSize,r=t.letterSpacing,i=r===void 0?0:r,s=t.lineHeight,l=t.padding;return{color:xf,fontFamily:e,fontSize:n,letterSpacing:i,lineHeight:s+"px",paddingBottom:l,paddingTop:l}},tg="BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif";const YPe={fontFamily:tg,light:{fontWeight:200},bold:{fontWeight:700},tiny:wf({},m_({fontFamily:tg,fontSize:10,lineHeight:12,letterSpacing:.4})),small:wf({},m_({fontFamily:tg,fontSize:12,lineHeight:16,letterSpacing:.4})),regular:wf({},m_({fontFamily:tg,fontSize:14,lineHeight:18,letterSpacing:.2})),large:wf({},m_({fontFamily:tg,fontSize:18,lineHeight:24,spacing:0}))};var gX=8;function Tf(){return Tf=Object.assign||function(t){for(var e,n=1;n<arguments.length;n++)for(var r in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Tf.apply(this,arguments)}var g_=function(t){var e=t.fontFamily,n=t.fontSize,r=t.letterSpacing;return{fill:xf,stroke:"none",fontFamily:e,fontSize:n,letterSpacing:r}},ng="BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif";const Pa={fontFamily:ng,light:{fontWeight:200},bold:{fontWeight:700},start:{textAnchor:"start"},middle:{textAnchor:"middle"},end:{textAnchor:"end"},tiny:Tf({},g_({fontFamily:ng,fontSize:10,letterSpacing:.4})),small:Tf({},g_({fontFamily:ng,fontSize:12,letterSpacing:.4})),regular:Tf({},g_({fontFamily:ng,fontSize:14,letterSpacing:.2})),large:Tf({},g_({fontFamily:ng,fontSize:18,spacing:0}))};function Xl(){return Xl=Object.assign||function(t){for(var e,n=1;n<arguments.length;n++)for(var r in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Xl.apply(this,arguments)}var Py=Xl({},Pa.small,Pa.bold,Pa.middle,{pointerEvents:"none"});Xl({},Pa.tiny,Pa.bold,Pa.middle,{pointerEvents:"none"});var y_=Xl({},Pa.small,Pa.light,Pa.middle,{pointerEvents:"none"}),f1={top:Xl({},y_,{dy:"-0.25em"}),right:Xl({},y_,Pa.start,{dx:"0.25em",dy:"0.25em"}),bottom:Xl({},y_,{dy:"0.25em"}),left:Xl({},y_,Pa.end,{dx:"-0.25em",dy:"0.25em"})};function Ia(){return Ia=Object.assign||function(t){for(var e,n=1;n<arguments.length;n++)for(var r in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Ia.apply(this,arguments)}var Rp=ZPe,JPe=Ia({},Py,YPe.light),QPe={stroke:Rp.grid,strokeWidth:1},eCe={stroke:Rp.gridDark,strokeWidth:2,label:{bottom:Ia({},Py),top:Ia({},Py)}},tCe={stroke:Rp.grid,strokeWidth:1,label:{left:Ia({},Py),right:Ia({},Py)}},nCe={stroke:Rp.grid,length:+gX,label:{bottom:Ia({},f1.bottom),top:Ia({},f1.top)}},rCe={stroke:Rp.grid,length:+gX,label:{left:Ia({},f1.left),right:Ia({},f1.right)}};const yX={colors:Rp,labelStyles:JPe,gridStyles:QPe,xAxisStyles:eCe,xTickStyles:nCe,yAxisStyles:tCe,yTickStyles:rCe};function iCe(t,e){return typeof t=="function"?t(e):t}function vX(t,e){return Object.keys(t).reduce(function(n,r){return n[r]=iCe(t[r],e),n},{})}var _X=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},bX=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n};O.string,O.any,O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]);O.string,O.number,O.number,O.array,O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.func,O.func,O.oneOfType([O.func,O.number]),O.func;gR.propTypes={innerRef:O.func};function gR(t){var e=t.from,n=e===void 0?new Vl({x:0,y:0}):e,r=t.to,i=r===void 0?new Vl({x:1,y:1}):r,s=t.stroke,l=s===void 0?"black":s,o=t.strokeWidth,h=o===void 0?1:o,p=t.strokeDasharray,b=p===void 0?"":p,x=t.transform,w=x===void 0?"":x,A=t.className,L=A===void 0?"":A,M=t.data,U=t.innerRef,D=bX(t,["from","to","stroke","strokeWidth","strokeDasharray","transform","className","data","innerRef"]);return le.createElement("line",_X({ref:U,className:Xo("vx-line",L),x1:n.x,y1:n.y,x2:i.x,y2:i.y,stroke:l,strokeWidth:h,strokeDasharray:b,transform:w},vX(D,M)))}O.func,O.func,O.func,O.array,O.func,O.func,O.func,O.string,O.number,O.func,O.func;O.func;O.func,O.func,O.func,O.func,O.func,O.func,O.func,O.func,O.array,O.func,O.oneOfType([O.string,O.bool,O.object,O.array]),O.func,O.string,O.number,O.string,O.string,O.func;O.func;O.string,O.number,O.number,O.array,O.array,O.func,O.oneOfType([O.func,O.bool]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.bool,O.bool;dk.propTypes={innerRef:O.func};function dk(t){var e=t.className,n=t.innerRef,r=t.data,i=t.x,s=i===void 0?0:i,l=t.y,o=l===void 0?0:l,h=t.width,p=t.height,b=t.rx,x=t.ry,w=t.fill,A=w===void 0?"steelblue":w,L=t.fillOpacity,M=t.stroke,U=t.strokeWidth,D=t.strokeDasharray,$=t.strokeLinecap,N=t.strokeLinejoin,B=t.strokeMiterlimit,Z=t.strokeOpacity,ie=bX(t,["className","innerRef","data","x","y","width","height","rx","ry","fill","fillOpacity","stroke","strokeWidth","strokeDasharray","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity"]);return le.createElement("rect",_X({ref:n,className:Xo("vx-bar",e),x:s,y:o,width:h,height:p,rx:b,ry:x,fill:A,fillOpacity:L,stroke:M,strokeWidth:U,strokeDasharray:D,strokeLinecap:$,strokeLinejoin:N,strokeMiterlimit:B,strokeOpacity:Z},vX(ie,r)))}O.array.isRequired,O.func.isRequired,O.func.isRequired,O.func.isRequired,O.func.isRequired,O.func.isRequired,O.array.isRequired,O.number.isRequired,O.string,O.number,O.number;O.array.isRequired,O.func.isRequired,O.func.isRequired,O.func.isRequired,O.func.isRequired,O.func.isRequired,O.array.isRequired,O.number.isRequired,O.string,O.number,O.number;O.array.isRequired,O.func.isRequired,O.func.isRequired,O.func.isRequired,O.func.isRequired,O.array.isRequired,O.string,O.number,O.number,O.number,O.number;O.array.isRequired,O.func.isRequired,O.func.isRequired,O.func.isRequired,O.func.isRequired,O.array.isRequired,O.string,O.number,O.number,O.number,O.number;O.string,O.number,O.number,O.array,O.array,O.func,O.oneOfType([O.func,O.bool]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.number]),O.oneOfType([O.func,O.array,O.string]),O.oneOfType([O.func,O.array,O.string]),O.func,O.bool;O.func,O.func,O.func,O.func,O.func,O.func;O.func,O.func,O.func,O.func,O.func,O.func;O.func,O.func,O.func,O.func,O.func,O.func;O.func,O.number,O.func,O.func,O.func,O.func,O.func;O.func,O.number,O.func,O.func,O.func,O.func,O.func;O.func,O.number,O.func,O.func,O.func,O.func,O.func;O.func,O.func,O.func,O.func,O.func,O.func;O.func,O.func,O.func,O.func,O.func,O.func;O.func,O.func,O.func,O.func,O.func,O.func;O.func,O.number,O.func,O.func,O.func,O.func,O.func;O.func,O.number,O.func,O.func,O.func,O.func,O.func;O.func,O.func,O.func,O.func,O.func,O.func;O.number.isRequired,O.number.isRequired,O.string,O.number;function sCe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function VN(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,KV(r.key),r)}}function oCe(t,e,n){return e&&VN(t.prototype,e),n&&VN(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Nl(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aCe(t,e){if(e&&(Vd(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nl(t)}function yR(t){return yR=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},yR(t)}function vR(t,e){return vR=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},vR(t,e)}function lCe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&vR(t,e)}function xX(){var t=this.constructor.getDerivedStateFromProps(this.props,this.state);t!=null&&this.setState(t)}function wX(t){function e(n){var r=this.constructor.getDerivedStateFromProps(t,n);return r??null}this.setState(e.bind(this))}function TX(t,e){try{var n=this.props,r=this.state;this.props=t,this.state=e,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}xX.__suppressDeprecationWarning=!0;wX.__suppressDeprecationWarning=!0;TX.__suppressDeprecationWarning=!0;function cCe(t){var e=t.prototype;if(!e||!e.isReactComponent)throw new Error("Can only polyfill class components");if(typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function")return t;var n=null,r=null,i=null;if(typeof e.componentWillMount=="function"?n="componentWillMount":typeof e.UNSAFE_componentWillMount=="function"&&(n="UNSAFE_componentWillMount"),typeof e.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof e.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof e.componentWillUpdate=="function"?i="componentWillUpdate":typeof e.UNSAFE_componentWillUpdate=="function"&&(i="UNSAFE_componentWillUpdate"),n!==null||r!==null||i!==null){var s=t.displayName||t.name,l=typeof t.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+s+" uses "+l+" but also contains the following legacy lifecycles:"+(n!==null?`
  `+n:"")+(r!==null?`
  `+r:"")+(i!==null?`
  `+i:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof t.getDerivedStateFromProps=="function"&&(e.componentWillMount=xX,e.componentWillReceiveProps=wX),typeof e.getSnapshotBeforeUpdate=="function"){if(typeof e.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");e.componentWillUpdate=TX;var o=e.componentDidUpdate;e.componentDidUpdate=function(p,b,x){var w=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:x;o.call(this,p,b,w)}}return t}var gp=0,bg=0,rg=0,EX=1e3,p1,xg,m1=0,Kd=0,Mx=0,Cy=typeof performance=="object"&&performance.now?performance:Date,SX=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function $x(){return Kd||(SX(uCe),Kd=Cy.now()+Mx)}function uCe(){Kd=0}function Ly(){this._call=this._time=this._next=null}Ly.prototype=AX.prototype={constructor:Ly,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?$x():+n)+(e==null?0:+e),!this._next&&xg!==this&&(xg?xg._next=this:p1=this,xg=this),this._call=t,this._time=n,_R()},stop:function(){this._call&&(this._call=null,this._time=1/0,_R())}};function AX(t,e,n){var r=new Ly;return r.restart(t,e,n),r}function dCe(){$x(),++gp;for(var t=p1,e;t;)(e=Kd-t._time)>=0&&t._call.call(null,e),t=t._next;--gp}function jN(){Kd=(m1=Cy.now())+Mx,gp=bg=0;try{dCe()}finally{gp=0,fCe(),Kd=0}}function hCe(){var t=Cy.now(),e=t-m1;e>EX&&(Mx-=e,m1=t)}function fCe(){for(var t,e=p1,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:p1=n);xg=t,_R(r)}function _R(t){if(!gp){bg&&(bg=clearTimeout(bg));var e=t-Kd;e>24?(t<1/0&&(bg=setTimeout(jN,t-Cy.now()-Mx)),rg&&(rg=clearInterval(rg))):(rg||(m1=Cy.now(),rg=setInterval(hCe,EX)),gp=1,SX(jN))}}function GN(t,e,n){var r=new Ly;return e=e==null?0:+e,r.restart(function(i){r.stop(),t(i+e)},e,n),r}function pCe(t,e,n){var r=new Ly,i=e;return e==null?(r.restart(t,e,n),r):(e=+e,n=n==null?$x():+n,r.restart(function s(l){l+=i,r.restart(s,i+=e,n),t(l)},e,n),r)}function WN(t,e){for(var n in e)t[n]=e[n];return t}function PX(t,e,n){this.key=t,this.data=e,this.type=n,this.state={}}WN(PX.prototype,{setState:function(e){var n=this.state;WN(n,typeof e=="function"?e(n):e)},updateData:function(e){return this.data=e,this},updateType:function(e){return this.type=e,this}});function mCe(t,e,n,r){for(var i=[],s=0;s<n.length;s++)i[s]=n[s];for(var l=0;l<t.length;l++)r[t[l]]===void 0&&i.push(t[l]);return i.sort(function(o,h){var p=r[o],b=r[h],x=e[o],w=e[h];if(p!=null&&b!=null)return r[o]-r[h];if(x!=null&&w!=null)return e[o]-e[h];if(p!=null){for(var A=0;A<n.length;A++){var L=n[A];if(e[L]){if(p<r[L]&&w>e[L])return-1;if(p>r[L]&&w<e[L])return 1}}return 1}for(var M=0;M<n.length;M++){var U=n[M];if(e[U]){if(b<r[U]&&x>e[U])return 1;if(b>r[U]&&x<e[U])return-1}}return-1})}var HN="ENTER",gCe="UPDATE",KT="LEAVE";function Xc(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&r.push.apply(r,Object.getOwnPropertySymbols(n).filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),r.forEach(function(i){on(t,i,n[i])})}return t}function yCe(t){return t==="transform"?hAe:a0}function vCe(t,e,n){return function(){var i=this,s=t?this.state[t][e]:this.state[e];if(s===n)return null;var l=yCe(e)(s,n),o;return t===null?o=function(p){i.setState(function(){return on({},e,l(p))})}:o=function(p){i.setState(function(b){return on({},t,Xc({},b[t],on({},e,l(p))))})},o}}function Zh(t,e,n){return vCe.call(this,t,e,n)}var _Ce=0,qN=1,KN=2,XT=3,XN=4,ZN=5,ZT=6;function bCe(t,e,n,r,i){var s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},l=t.TRANSITION_SCHEDULES;if(!l)t.TRANSITION_SCHEDULES={};else if(n in l)return;var o=Xc({stateKey:e,events:s,tweens:i},r,{timer:null,state:_Ce});xCe(t,n,o)}function xCe(t,e,n){var r=t.TRANSITION_SCHEDULES,i=Xc({},n),s=i.tweens.length,l=new Array(s);r[e]=i,i.timer=AX(o,0,i.time);function o(x){i.state=qN,i.timer.restart(h,i.delay,i.time),i.delay<=x&&h(x-i.delay)}function h(x){if(i.state!==qN)return b();for(var w in r){var A=r[w];if(A.stateKey===i.stateKey){if(A.state===XT)return GN(h);A.state===XN?(A.state=ZT,A.timer.stop(),A.events.interrupt&&typeof A.events.interrupt=="function"&&A.events.interrupt.call(this),delete r[w]):+w<e&&(A.state=ZT,A.timer.stop(),delete r[w])}}if(GN(function(){i.state===XT&&(i.state=XN,i.timer.restart(p,i.delay,i.time),p(x))}),i.state=KN,i.events.start&&typeof i.events.start=="function"&&i.events.start.call(t),i.state===KN){i.state=XT;for(var L=-1,M=0;M<s;++M){var U=i.tweens[M].call(t);U&&(l[++L]=U)}l.length=L+1}}function p(x){var w=1;x<i.duration?w=i.ease.call(null,x/i.duration):(i.timer.restart(b),i.state=ZN);for(var A=-1;++A<l.length;)l[A].call(null,w);i.state===ZN&&(i.events.end&&typeof i.events.end=="function"&&i.events.end.call(t),b())}function b(){i.state=ZT,i.timer.stop(),delete r[e];for(var x in r)return;delete t.TRANSITION_SCHEDULES}}function wCe(t){var e=!1;return function(){e||(e=!0,t.call(this))}}var TCe=0;function ECe(){return++TCe}function SCe(t){return+t}var ACe={time:null,delay:0,duration:250,ease:SCe};function YN(){var t=this,e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Xc({},e),r=n.events||{};delete n.events,Object.keys(r).forEach(function(s){if(typeof r[s]!="function")throw new Error("Event handlers must be a function");r[s]=wCe(r[s])});var i=n.timing||{};delete n.timing,Object.keys(n).forEach(function(s){var l=[];if(Vd(n[s])==="object"&&Array.isArray(n[s])===!1)Object.keys(n[s]).forEach(function(b){var x=n[s][b];if(Array.isArray(x))x.length===1?l.push(Zh.call(t,s,b,x[0])):(t.setState(function(A){return on({},s,Xc({},A[s],on({},b,x[0])))}),l.push(Zh.call(t,s,b,x[1])));else if(typeof x=="function"){var w=function(){var L=function(U){t.setState(function(D){return on({},s,Xc({},D[s],on({},b,x(U))))})};return L};l.push(w)}else t.setState(function(A){return on({},s,Xc({},A[s],on({},b,x)))}),l.push(Zh.call(t,s,b,x))});else{var o=n[s];if(Array.isArray(o))o.length===1?l.push(Zh.call(t,null,s,o[0])):(t.setState(function(){return on({},s,o[0])}),l.push(Zh.call(t,null,s,o[1])));else if(typeof o=="function"){var h=function(){var x=function(A){t.setState(function(){return on({},s,o(A))})};return x};l.push(h)}else t.setState(function(){return on({},s,o)}),l.push(Zh.call(t,null,s,o))}var p=Xc({},ACe,i,{time:$x()});bCe(t,s,ECe(),p,l,r)})}function YT(t){var e=this;Array.isArray(t)?t.forEach(function(n){YN.call(e,n)}):YN.call(this,t)}function PCe(){var t=this.TRANSITION_SCHEDULES;t&&Object.keys(t).forEach(function(e){t[e].timer.stop()})}var kx=function(t){lCe(e,t);function e(){var n,r;sCe(this,e);for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];return r=aCe(this,(n=yR(e)).call.apply(n,[this].concat(s))),on(Nl(Nl(r)),"state",{nodeKeys:[],nodeHash:{},nodes:[],data:null}),on(Nl(Nl(r)),"animate",function(){var o=r.state,h=o.nodeKeys,p=o.nodeHash;if(!r.unmounting){for(var b=!1,x=[],w=h.length,A=0;A<w;A++){var L=h[A],M=p[L];M.TRANSITION_SCHEDULES&&(b=!0),M.type===KT&&!M.TRANSITION_SCHEDULES?delete p[L]:x.push(L)}b||r.interval.stop(),r.setState(function(){return{nodeKeys:x,nodes:x.map(function(U){return p[U]})}})}}),on(Nl(Nl(r)),"interval",null),on(Nl(Nl(r)),"unmounting",!1),r}return oCe(e,[{key:"componentDidMount",value:function(){this.startInterval()}},{key:"componentDidUpdate",value:function(r){r.data!==this.props.data&&!this.unmounting&&this.startInterval()}},{key:"startInterval",value:function(){this.interval?this.interval.restart(this.animate):this.interval=pCe(this.animate)}},{key:"componentWillUnmount",value:function(){var r=this.state,i=r.nodeKeys,s=r.nodeHash;this.unmounting=!0,this.interval&&this.interval.stop(),i.forEach(function(l){PCe.call(s[l])})}},{key:"render",value:function(){var r=this.props.children(this.state.nodes);return r&&le.Children.only(r)}}],[{key:"getDerivedStateFromProps",value:function(r,i){if(r.data!==i.data){for(var s=r.data,l=r.keyAccessor,o=r.start,h=r.enter,p=r.update,b=r.leave,x=i.nodeKeys,w=i.nodeHash,A={},L=0;L<x.length;L++)A[x[L]]=L;for(var M={},U=[],D=0;D<s.length;D++){var $=s[D],N=l($,D);M[N]=D,U.push(N),A[N]===void 0&&(w[N]=new PX(N,$,HN))}for(var B=0;B<x.length;B++){var Z=x[B],ie=w[Z];M[Z]!==void 0?(ie.updateData(s[M[Z]]),ie.updateType(gCe)):ie.updateType(KT)}for(var re=mCe(x,A,U,M),ve=0;ve<re.length;ve++){var Te=re[ve],Ae=w[Te],fe=Ae.data;Ae.type===HN?(Ae.setState(o(fe,M[Te])),YT.call(Ae,h(fe,M[Te]))):Ae.type===KT?YT.call(Ae,b(fe,A[Te])):YT.call(Ae,p(fe,M[Te]))}return{data:s,nodes:re.map(function(Pe){return w[Pe]}),nodeHash:w,nodeKeys:re}}return null}}]),e}(te.Component);kx.propTypes={};kx.defaultProps={enter:function(){},update:function(){},leave:function(){}};cCe(kx);function ga(t){if(typeof t=="function"){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,n)}return t}var CCe={rawData:O.arrayOf(O.oneOfType([O.number,O.string])),binnedData:fX,fill:O.oneOfType([O.func,O.string]),fillOpacity:O.oneOfType([O.func,O.number]),horizontal:O.bool,stroke:O.oneOfType([O.func,O.string]),strokeWidth:O.oneOfType([O.func,O.number]),valueKey:O.string,onClick:O.func,binScale:O.func,valueScale:O.func,onMouseMove:O.func,onMouseLeave:O.func,keyAccessor:O.func},LCe={rawData:[],binnedData:[],binScale:null,fill:yX.colors.default,fillOpacity:.7,horizontal:!1,onClick:null,onMouseMove:null,onMouseLeave:null,stroke:"#FFFFFF",strokeWidth:1,valueKey:"count",valueScale:null,keyAccessor:function(e){return e.id}},JT=10,ICe=function(e){return typeof e.bin>"u"?e.bin0:e.bin},RCe=function(e){return typeof e.bin>"u"?e.bin1:e.bin};function hk(t){var e=t.binnedData,n=t.valueScale,r=t.binScale,i=t.horizontal,s=t.keyAccessor,l=t.fill,o=t.fillOpacity,h=t.onClick,p=t.onMouseMove,b=t.onMouseLeave,x=t.stroke,w=t.strokeWidth,A=t.valueKey,L=Math.max.apply(Math,n.range()),M=e.map(function(Z,ie){return r.bandwidth?r.bandwidth():Math.abs(r(e[ie].bin1)-r(e[ie].bin0))}),U=function(ie){return ie[A]},D=i?U:ICe,$=i?RCe:U,N=i?n:r,B=i?r:n;return le.createElement(kx,{data:e,keyAccessor:s,start:function(ie,re){return{x:i?0:N(D(ie)),y:i?B($(ie)):L,fill:ie.fill||ga(l,ie,re),width:i?0:M[re],height:i?M[re]:0}},enter:function(ie,re){return{x:[i?0:N(D(ie))],y:[B($(ie))],width:[i?N(D(ie)):M[re]],height:[i?M[re]:L-B($(ie))],fill:[ie.fill||ga(l,ie,re)],stroke:[ie.stroke||ga(x,ie,re)],timing:{duration:300,delay:JT*re}}},update:function(ie,re){return{x:[i?0:N(D(ie))],y:[B($(ie))],width:[i?N(D(ie)):M[re]],height:[i?M[re]:L-B($(ie))],fill:[ie.fill||ga(l,ie,re)],stroke:[ie.stroke||ga(x,ie,re)],timing:{duration:300,delay:JT*re}}},leave:function(ie,re){return{x:i?0:N(D(ie)),y:i?B($(ie)):L,width:i?0:M[re],height:i?M[re]:0,timing:{duration:300,delay:JT/2*re}}}},function(Z){return le.createElement(Nf,null,Z.map(function(ie,re){var ve=ie.key,Te=ie.data,Ae=ie.state;return le.createElement(dk,{key:"bar"+ve,x:Ae.x,y:Ae.y,width:Ae.width,height:Ae.height,fill:Ae.fill,stroke:Ae.stroke,fillOpacity:typeof o>"u"?ga(o,Te,re):o,strokeWidth:Te.strokeWidth||ga(w,Te,re),onClick:h&&function(){return function(fe){h({event:fe,datum:Te,data:e,color:Ae.fill,index:re})}},onMouseMove:p&&function(){return function(fe){p({event:fe,datum:Te,data:e,color:Ae.fill,index:re})}},onMouseLeave:b&&function(){return b}})}))})}hk.propTypes=CCe;hk.defaultProps=LCe;var MCe={animated:O.bool,rawData:O.arrayOf(O.oneOfType([O.number,O.string])),binnedData:fX,fill:O.oneOfType([O.func,O.string]),fillOpacity:O.oneOfType([O.func,O.number]),horizontal:O.bool,stroke:O.oneOfType([O.func,O.string]),strokeWidth:O.oneOfType([O.func,O.number]),valueKey:O.string,onClick:O.func,binScale:O.func,valueScale:O.func,onMouseMove:O.func,onMouseLeave:O.func},$Ce={animated:!0,rawData:[],binnedData:[],binScale:null,fill:yX.colors.default,fillOpacity:.7,horizontal:!1,onClick:null,onMouseMove:null,onMouseLeave:null,stroke:"#FFFFFF",strokeWidth:1,valueKey:"count",valueScale:null};function Ox(t){var e=t.animated,n=t.binnedData,r=t.binScale,i=t.fill,s=t.fillOpacity,l=t.horizontal,o=t.onClick,h=t.onMouseMove,p=t.onMouseLeave,b=t.stroke,x=t.strokeWidth,w=t.valueKey,A=t.valueScale;if(!r||!A||!n||n.length===0)return null;var L=Math.max.apply(Math,A.range());return le.createElement(Nf,null,e&&le.createElement(hk,{binnedData:n,binScale:r,horizontal:l,fill:i,fillOpacity:s,onClick:o,onMouseMove:h,onMouseLeave:p,stroke:b,strokeWidth:x,valueKey:w,valueScale:A}),!e&&n.map(function(M,U){var D=r(M.bin||(l?M.bin1:M.bin0)),$=l?A(M[w]):L-A(M[w]),N=r.bandwidth?r.bandwidth():Math.abs(r(n[U].bin1)-r(n[U].bin0)),B=M.fill||ga(i,M,U);return le.createElement(dk,{key:"bar-"+D,x:l?0:D,y:l?D:L-$,width:l?$:N,height:l?N:$,fill:B,fillOpacity:typeof s>"u"?ga(s,M,U):s,stroke:M.stroke||ga(b,M,U),strokeWidth:M.strokeWidth||ga(x,M,U),onClick:o&&function(){return function(Z){o({event:Z,data:n,datum:M,color:B,index:U})}},onMouseMove:h&&function(){return function(Z){h({event:Z,data:n,datum:M,color:B,index:U})}},onMouseLeave:p&&function(){return p}})}))}Ox.propTypes=MCe;Ox.defaultProps=$Ce;Ox.displayName="BarSeries";var kCe=CX;function CX(t,e,n){t instanceof RegExp&&(t=JN(t,n)),e instanceof RegExp&&(e=JN(e,n));var r=LX(t,e,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+t.length,r[1]),post:n.slice(r[1]+e.length)}}function JN(t,e){var n=e.match(t);return n?n[0]:null}CX.range=LX;function LX(t,e,n){var r,i,s,l,o,h=n.indexOf(t),p=n.indexOf(e,h+1),b=h;if(h>=0&&p>0){for(r=[],s=n.length;b>=0&&!o;)b==h?(r.push(b),h=n.indexOf(t,b+1)):r.length==1?o=[r.pop(),p]:(i=r.pop(),i<s&&(s=i,l=p),p=n.indexOf(e,b+1)),b=h<p&&h>=0?h:p;r.length&&(o=[s,l])}return o}var OCe=IX;function IX(t,e,n){t instanceof RegExp&&(t=QN(t,n)),e instanceof RegExp&&(e=QN(e,n));var r=RX(t,e,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+t.length,r[1]),post:n.slice(r[1]+e.length)}}function QN(t,e){var n=e.match(t);return n?n[0]:null}IX.range=RX;function RX(t,e,n){var r,i,s,l,o,h=n.indexOf(t),p=n.indexOf(e,h+1),b=h;if(h>=0&&p>0){if(t===e)return[h,p];for(r=[],s=n.length;b>=0&&!o;)b==h?(r.push(b),h=n.indexOf(t,b+1)):r.length==1?o=[r.pop(),p]:(i=r.pop(),i<s&&(s=i,l=p),p=n.indexOf(e,b+1)),b=h<p&&h>=0?h:p;r.length&&(o=[s,l])}return o}var DCe=OCe,FCe=MX;function MX(t,e,n){var r=t;return NCe(t,e).reduce(function(i,s){return i.replace(s.functionIdentifier+"("+s.matches.body+")",zCe(s.matches.body,s.functionIdentifier,n,r,e))},t)}function NCe(t,e){var n=[],r=typeof e=="string"?new RegExp("\\b("+e+")\\("):e;do{var i=r.exec(t);if(!i)return n;if(i[1]===void 0)throw new Error("Missing the first couple of parenthesis to get the function identifier in "+e);var s=i[1],l=i.index,o=DCe("(",")",t.substring(l));if(!o||o.start!==i[0].length-1)throw new SyntaxError(s+"(): missing closing ')' in the value '"+t+"'");n.push({matches:o,functionIdentifier:s}),t=o.post}while(r.test(t));return n}function zCe(t,e,n,r,i){return n(MX(t,i,n),e,r)}var Rs=function(t){this.value=t};Rs.math={isDegree:!0,acos:function(t){return Rs.math.isDegree?180/Math.PI*Math.acos(t):Math.acos(t)},add:function(t,e){return t+e},asin:function(t){return Rs.math.isDegree?180/Math.PI*Math.asin(t):Math.asin(t)},atan:function(t){return Rs.math.isDegree?180/Math.PI*Math.atan(t):Math.atan(t)},acosh:function(t){return Math.log(t+Math.sqrt(t*t-1))},asinh:function(t){return Math.log(t+Math.sqrt(t*t+1))},atanh:function(t){return Math.log((1+t)/(1-t))},C:function(t,e){var n=1,r=t-e,i=e;i<r&&(i=r,r=e);for(var s=i+1;s<=t;s++)n*=s;return n/Rs.math.fact(r)},changeSign:function(t){return-t},cos:function(t){return Rs.math.isDegree&&(t=Rs.math.toRadian(t)),Math.cos(t)},cosh:function(t){return(Math.pow(Math.E,t)+Math.pow(Math.E,-1*t))/2},div:function(t,e){return t/e},fact:function(t){if(t%1!==0)return"NaN";for(var e=1,n=2;n<=t;n++)e*=n;return e},inverse:function(t){return 1/t},log:function(t){return Math.log(t)/Math.log(10)},mod:function(t,e){return t%e},mul:function(t,e){return t*e},P:function(t,e){for(var n=1,r=Math.floor(t)-Math.floor(e)+1;r<=Math.floor(t);r++)n*=r;return n},Pi:function(t,e,n){for(var r=1,i=t;i<=e;i++)r*=Number(n.postfixEval({n:i}));return r},pow10x:function(t){for(var e=1;t--;)e*=10;return e},sigma:function(t,e,n){for(var r=0,i=t;i<=e;i++)r+=Number(n.postfixEval({n:i}));return r},sin:function(t){return Rs.math.isDegree&&(t=Rs.math.toRadian(t)),Math.sin(t)},sinh:function(t){return(Math.pow(Math.E,t)-Math.pow(Math.E,-1*t))/2},sub:function(t,e){return t-e},tan:function(t){return Rs.math.isDegree&&(t=Rs.math.toRadian(t)),Math.tan(t)},tanh:function(t){return Rs.sinha(t)/Rs.cosha(t)},toRadian:function(t){return t*Math.PI/180},and:function(t,e){return t&e}};Rs.Exception=function(t){this.message=t};var BCe=Rs,wn=BCe;function Is(t,e){for(var n=0;n<t.length;n++)t[n]+=e;return t}var pu=[{token:"sin",show:"sin",type:0,value:wn.math.sin},{token:"cos",show:"cos",type:0,value:wn.math.cos},{token:"tan",show:"tan",type:0,value:wn.math.tan},{token:"pi",show:"&pi;",type:3,value:"PI"},{token:"(",show:"(",type:4,value:"("},{token:")",show:")",type:5,value:")"},{token:"P",show:"P",type:10,value:wn.math.P},{token:"C",show:"C",type:10,value:wn.math.C},{token:" ",show:" ",type:14,value:" ".anchor},{token:"asin",show:"asin",type:0,value:wn.math.asin},{token:"acos",show:"acos",type:0,value:wn.math.acos},{token:"atan",show:"atan",type:0,value:wn.math.atan},{token:"7",show:"7",type:1,value:"7"},{token:"8",show:"8",type:1,value:"8"},{token:"9",show:"9",type:1,value:"9"},{token:"int",show:"Int",type:0,value:Math.floor},{token:"cosh",show:"cosh",type:0,value:wn.math.cosh},{token:"acosh",show:"acosh",type:0,value:wn.math.acosh},{token:"ln",show:" ln",type:0,value:Math.log},{token:"^",show:"^",type:10,value:Math.pow},{token:"root",show:"root",type:0,value:Math.sqrt},{token:"4",show:"4",type:1,value:"4"},{token:"5",show:"5",type:1,value:"5"},{token:"6",show:"6",type:1,value:"6"},{token:"/",show:"&divide;",type:2,value:wn.math.div},{token:"!",show:"!",type:7,value:wn.math.fact},{token:"tanh",show:"tanh",type:0,value:wn.math.tanh},{token:"atanh",show:"atanh",type:0,value:wn.math.atanh},{token:"Mod",show:" Mod ",type:2,value:wn.math.mod},{token:"1",show:"1",type:1,value:"1"},{token:"2",show:"2",type:1,value:"2"},{token:"3",show:"3",type:1,value:"3"},{token:"*",show:"&times;",type:2,value:wn.math.mul},{token:"sinh",show:"sinh",type:0,value:wn.math.sinh},{token:"asinh",show:"asinh",type:0,value:wn.math.asinh},{token:"e",show:"e",type:3,value:"E"},{token:"log",show:" log",type:0,value:wn.math.log},{token:"0",show:"0",type:1,value:"0"},{token:".",show:".",type:6,value:"."},{token:"+",show:"+",type:9,value:wn.math.add},{token:"-",show:"-",type:9,value:wn.math.sub},{token:",",show:",",type:11,value:","},{token:"Sigma",show:"&Sigma;",type:12,value:wn.math.sigma},{token:"n",show:"n",type:13,value:"n"},{token:"Pi",show:"&Pi;",type:12,value:wn.math.Pi},{token:"pow",show:"pow",type:8,value:Math.pow,numberOfArguments:2},{token:"&",show:"&",type:9,value:wn.math.and}],bR={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1,15:11};for(var v_=0;v_<pu.length;v_++)pu[v_].precedence=bR[pu[v_].type];var Xa={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0,15:!0},Yh={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,15:!0},UCe={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0,15:!0},da={},ig={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0,15:!0},VCe={1:!0},$s=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," ","&"],["pi","ln","Pi"],["sin","cos","tan","Del","int","Mod","log","pow"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]];function jCe(t,e,n,r){for(var i=0;i<r;i++)if(t[n+i]!==e[i])return!1;return!0}wn.tokenTypes={FUNCTION_WITH_ONE_ARG:0,NUMBER:1,BINARY_OPERATOR_HIGH_PRECENDENCE:2,CONSTANT:3,OPENING_PARENTHESIS:4,CLOSING_PARENTHESIS:5,DECIMAL:6,POSTFIX_FUNCTION_WITH_ONE_ARG:7,FUNCTION_WITH_N_ARGS:8,BINARY_OPERATOR_LOW_PRECENDENCE:9,BINARY_OPERATOR_PERMUTATION:10,COMMA:11,EVALUATED_FUNCTION:12,EVALUATED_FUNCTION_PARAMETER:13,SPACE:14};wn.addToken=function(t){for(var e=0;e<t.length;e++){var n=t[e].token.length,r=-1;t[e].type===wn.tokenTypes.FUNCTION_WITH_N_ARGS&&t[e].numberOfArguments===void 0&&(t[e].numberOfArguments=2),$s[n]=$s[n]||[];for(var i=0;i<$s[n].length;i++)if(t[e].token===$s[n][i]){r=$X($s[n][i],pu);break}r===-1?(pu.push(t[e]),t[e].precedence=bR[t[e].type],$s.length<=t[e].token.length&&($s[t[e].token.length]=[]),$s[t[e].token.length].push(t[e].token)):(pu[r]=t[e],t[e].precedence=bR[t[e].type])}};function $X(t,e){for(var n=0;n<e.length;n++)if(e[n].token===t)return n;return-1}function GCe(t){for(var e=[],n=t.length,r,i,s,l=0;l<n;l++)if(!(l<n-1&&t[l]===" "&&t[l+1]===" ")){for(r="",i=t.length-l>$s.length-2?$s.length-1:t.length-l;i>0;i--)if($s[i]!==void 0)for(s=0;s<$s[i].length;s++)jCe(t,$s[i][s],l,i)&&(r=$s[i][s],s=$s[i].length,i=0);if(l+=r.length-1,r==="")throw new wn.Exception("Can't understand after "+t.slice(l));e.push(pu[$X(r,pu)])}return e}var WCe={value:wn.math.changeSign,type:0,pre:21,show:"-"},__={value:")",show:")",type:5,pre:0},sg={value:"(",type:4,pre:0,show:"("};wn.lex=function(t,e){var n=[sg],r=[],i=t,s=Xa,l=0,o=da,h="",p;typeof e<"u"&&wn.addToken(e);var b={},x=GCe(i);for(p=0;p<x.length;p++){var w=x[p];if(w.type===14){if(p>0&&p<x.length-1&&x[p+1].type===1&&(x[p-1].type===1||x[p-1].type===6))throw new wn.Exception("Unexpected Space");continue}var A=w.token,L=w.type,M=w.value,U=w.precedence,D=w.show,$=n[n.length-1],N;for(N=r.length;N--&&r[N]===0;)if([0,2,3,4,5,9,11,12,13].indexOf(L)!==-1){if(s[L]!==!0)throw new wn.Exception(A+" is not allowed after "+h);n.push(__),s=Yh,o=ig,r.pop()}if(s[L]!==!0)throw new wn.Exception(A+" is not allowed after "+h);if(o[L]===!0&&(L=2,M=wn.math.mul,D="&times;",U=3,p=p-1),b={value:M,type:L,pre:U,show:D,numberOfArguments:w.numberOfArguments},L===0)s=Xa,o=da,Is(r,2),n.push(b),x[p+1].type!==4&&(n.push(sg),r.push(2));else if(L===1)$.type===1?($.value+=M,Is(r,1)):n.push(b),s=Yh,o=UCe;else if(L===2)s=Xa,o=da,Is(r,2),n.push(b);else if(L===3)n.push(b),s=Yh,o=ig;else if(L===4)Is(r,1),l++,s=Xa,o=da,n.push(b);else if(L===5){if(!l)throw new wn.Exception("Closing parenthesis are more than opening one, wait What!!!");l--,s=Yh,o=ig,n.push(b),Is(r,1)}else if(L===6){if($.hasDec)throw new wn.Exception("Two decimals are not allowed in one number");$.type!==1&&($={value:0,type:1,pre:0},n.push($)),s=VCe,Is(r,1),o=da,$.value+=M,$.hasDec=!0}else L===7&&(s=Yh,o=ig,Is(r,1),n.push(b));L===8?(s=Xa,o=da,Is(r,w.numberOfArguments+2),n.push(b),x[p+1].type!==4&&(n.push(sg),r.push(w.numberOfArguments+2))):L===9?($.type===9?$.value===wn.math.add?($.value=M,$.show=D,Is(r,1)):$.value===wn.math.sub&&D==="-"&&($.value=wn.math.add,$.show="+",Is(r,1)):$.type!==5&&$.type!==7&&$.type!==1&&$.type!==3&&$.type!==13?A==="-"&&(s=Xa,o=da,Is(r,2).push(2),n.push(WCe),n.push(sg)):(n.push(b),Is(r,2)),s=Xa,o=da):L===10?(s=Xa,o=da,Is(r,2),n.push(b)):L===11?(s=Xa,o=da,n.push(b)):L===12?(s=Xa,o=da,Is(r,6),n.push(b),x[p+1].type!==4&&(n.push(sg),r.push(6))):L===13&&(s=Yh,o=ig,n.push(b)),Is(r,-1),h=A}for(N=r.length;N--;)n.push(__);if(s[5]!==!0)throw new wn.Exception("complete the expression");for(;l--;)n.push(__);return n.push(__),new wn(n)};var HCe=wn,xR=HCe;xR.prototype.toPostfix=function(){for(var t=[],e,n,r,i,s,l=[{value:"(",type:4,pre:0}],o=this.value,h=1;h<o.length;h++)if(o[h].type===1||o[h].type===3||o[h].type===13)o[h].type===1&&(o[h].value=Number(o[h].value)),t.push(o[h]);else if(o[h].type===4)l.push(o[h]);else if(o[h].type===5)for(;(n=l.pop()).type!==4;)t.push(n);else if(o[h].type===11){for(;(n=l.pop()).type!==4;)t.push(n);l.push(n)}else{e=o[h],i=e.pre,s=l[l.length-1],r=s.pre;var p=s.value=="Math.pow"&&e.value=="Math.pow";if(i>r)l.push(e);else{for(;r>=i&&!p||p&&i<r;)n=l.pop(),s=l[l.length-1],t.push(n),r=s.pre,p=e.value=="Math.pow"&&s.value=="Math.pow";l.push(e)}}return new xR(t)};var qCe=xR,Vg=qCe;Vg.prototype.postfixEval=function(t){t=t||{},t.PI=Math.PI,t.E=Math.E;for(var e=[],n,r,i,s=this.value,l=typeof t.n<"u",o=0;o<s.length;o++)if(s[o].type===1)e.push({value:s[o].value,type:1});else if(s[o].type===3)e.push({value:t[s[o].value],type:1});else if(s[o].type===0)typeof e[e.length-1].type>"u"?e[e.length-1].value.push(s[o]):e[e.length-1].value=s[o].value(e[e.length-1].value);else if(s[o].type===7)typeof e[e.length-1].type>"u"?e[e.length-1].value.push(s[o]):e[e.length-1].value=s[o].value(e[e.length-1].value);else if(s[o].type===8){for(var h=[],p=0;p<s[o].numberOfArguments;p++)h.push(e.pop().value);e.push({type:1,value:s[o].value.apply(s[o],h.reverse())})}else s[o].type===10?(n=e.pop(),r=e.pop(),typeof r.type>"u"?(r.value=r.concat(n),r.value.push(s[o]),e.push(r)):typeof n.type>"u"?(n.unshift(r),n.push(s[o]),e.push(n)):e.push({type:1,value:s[o].value(r.value,n.value)})):s[o].type===2||s[o].type===9?(n=e.pop(),r=e.pop(),typeof r.type>"u"?(r=r.concat(n),r.push(s[o]),e.push(r)):typeof n.type>"u"?(n.unshift(r),n.push(s[o]),e.push(n)):e.push({type:1,value:s[o].value(r.value,n.value)})):s[o].type===12?(n=e.pop(),typeof n.type<"u"&&(n=[n]),r=e.pop(),i=e.pop(),e.push({type:1,value:s[o].value(i.value,r.value,new Vg(n))})):s[o].type===13&&(l?e.push({value:t[s[o].value],type:3}):e.push([s[o]]));if(e.length>1)throw new Vg.Exception("Uncaught Syntax error");return e[0].value>1e15?"Infinity":parseFloat(e[0].value.toFixed(15))};Vg.eval=function(t,e,n){return typeof e>"u"?this.lex(t).toPostfix().postfixEval():typeof n>"u"?typeof e.length<"u"?this.lex(t,e).toPostfix().postfixEval():this.lex(t).toPostfix().postfixEval(e):this.lex(t,e).toPostfix().postfixEval(n)};var KCe=Vg,kX=KCe;kX.prototype.formulaEval=function(){for(var t,e,n,r=[],i=this.value,s=0;s<i.length;s++)i[s].type===1||i[s].type===3?r.push({value:i[s].type===3?i[s].show:i[s].value,type:1}):i[s].type===13?r.push({value:i[s].show,type:1}):i[s].type===0?r[r.length-1]={value:i[s].show+(i[s].show!="-"?"(":"")+r[r.length-1].value+(i[s].show!="-"?")":""),type:0}:i[s].type===7?r[r.length-1]={value:(r[r.length-1].type!=1?"(":"")+r[r.length-1].value+(r[r.length-1].type!=1?")":"")+i[s].show,type:7}:i[s].type===10?(t=r.pop(),e=r.pop(),i[s].show==="P"||i[s].show==="C"?r.push({value:"<sup>"+e.value+"</sup>"+i[s].show+"<sub>"+t.value+"</sub>",type:10}):r.push({value:(e.type!=1?"(":"")+e.value+(e.type!=1?")":"")+"<sup>"+t.value+"</sup>",type:1})):i[s].type===2||i[s].type===9?(t=r.pop(),e=r.pop(),r.push({value:(e.type!=1?"(":"")+e.value+(e.type!=1?")":"")+i[s].show+(t.type!=1?"(":"")+t.value+(t.type!=1?")":""),type:i[s].type})):i[s].type===12&&(t=r.pop(),e=r.pop(),n=r.pop(),r.push({value:i[s].show+"("+n.value+","+e.value+","+t.value+")",type:12}));return r[0].value};var XCe=kX,ZCe=kCe,YCe=FCe,JCe=XCe,QCe=100,eLe=/(\+|\-|\*|\\|[^a-z]|)(\s*)(\()/g,QT,eE=tLe;function tLe(t,e){QT=0,e=Math.pow(10,e===void 0?5:e),t=t.replace(/\n+/g," ");function n(i,s,l){if(QT++>QCe)throw QT=0,new Error("Call stack overflow for "+l);if(i==="")throw new Error(s+"(): '"+l+"' must contain a non-whitespace string");i=r(i,l);var o=nLe(i);if(o.length>1||i.indexOf("var(")>-1)return s+"("+i+")";var h=o[0]||"";h==="%"&&(i=i.replace(/\b[0-9\.]+%/g,function(x){return parseFloat(x.slice(0,-1))*.01}));var p=i.replace(new RegExp(h,"gi"),""),b;try{b=JCe.eval(p)}catch{return s+"("+i+")"}return h==="%"&&(b*=100),(s.length||h==="%")&&(b=Math.round(b*e)/e),b+=h,b}function r(i,s){i=i.replace(/((?:\-[a-z]+\-)?calc)/g,"");for(var l="",o=i,h;h=eLe.exec(o);){h[0].index>0&&(l+=o.substring(0,h[0].index));var p=ZCe("(",")",o.substring([0].index));if(p.body==="")throw new Error("'"+i+"' must contain a non-whitespace string");var b=n(p.body,"",s);l+=p.pre+b,o=p.post}return l+o}return YCe(t,/((?:\-[a-z]+\-)?calc)\(/,n)}function nLe(t){for(var e=[],n=[],r=/[\.0-9]([%a-z]+)/gi,i=r.exec(t);i;)!i||!i[1]||(n.indexOf(i[1].toLowerCase())===-1&&(e.push(i[1]),n.push(i[1].toLowerCase())),i=r.exec(t));return e}var b_=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},rLe=typeof b_=="object"&&b_&&b_.Object===Object&&b_,iLe=rLe,sLe=typeof self=="object"&&self&&self.Object===Object&&self,oLe=iLe||sLe||Function("return this")(),fk=oLe,aLe=fk.Symbol,g1=aLe,OX=Object.prototype,lLe=OX.hasOwnProperty,cLe=OX.toString,og=g1?g1.toStringTag:void 0;function uLe(t){var e=lLe.call(t,og),n=t[og];try{t[og]=void 0}catch{}var r=cLe.call(t);return e?t[og]=n:delete t[og],r}var dLe=uLe,hLe=Object.prototype,fLe=hLe.toString;function pLe(t){return fLe.call(t)}var mLe=pLe,gLe="[object Null]",yLe="[object Undefined]",ez=g1?g1.toStringTag:void 0;function vLe(t){return t==null?t===void 0?yLe:gLe:ez&&ez in Object(t)?dLe(t):mLe(t)}var _Le=vLe;function bLe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var DX=bLe,xLe="[object AsyncFunction]",wLe="[object Function]",TLe="[object GeneratorFunction]",ELe="[object Proxy]";function SLe(t){if(!DX(t))return!1;var e=_Le(t);return e==wLe||e==TLe||e==xLe||e==ELe}var ALe=SLe,PLe=fk["__core-js_shared__"],tE=PLe,tz=function(){var t=/[^.]+$/.exec(tE&&tE.keys&&tE.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function CLe(t){return!!tz&&tz in t}var LLe=CLe,ILe=Function.prototype,RLe=ILe.toString;function MLe(t){if(t!=null){try{return RLe.call(t)}catch{}try{return t+""}catch{}}return""}var $Le=MLe,kLe=/[\\^$.*+?()[\]{}|]/g,OLe=/^\[object .+?Constructor\]$/,DLe=Function.prototype,FLe=Object.prototype,NLe=DLe.toString,zLe=FLe.hasOwnProperty,BLe=RegExp("^"+NLe.call(zLe).replace(kLe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ULe(t){if(!DX(t)||LLe(t))return!1;var e=ALe(t)?BLe:OLe;return e.test($Le(t))}var VLe=ULe;function jLe(t,e){return t==null?void 0:t[e]}var GLe=jLe;function WLe(t,e){var n=GLe(t,e);return VLe(n)?n:void 0}var FX=WLe,HLe=FX(Object,"create"),Iy=HLe;function qLe(){this.__data__=Iy?Iy(null):{},this.size=0}var KLe=qLe;function XLe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var ZLe=XLe,YLe="__lodash_hash_undefined__",JLe=Object.prototype,QLe=JLe.hasOwnProperty;function eIe(t){var e=this.__data__;if(Iy){var n=e[t];return n===YLe?void 0:n}return QLe.call(e,t)?e[t]:void 0}var tIe=eIe,nIe=Object.prototype,rIe=nIe.hasOwnProperty;function iIe(t){var e=this.__data__;return Iy?e[t]!==void 0:rIe.call(e,t)}var sIe=iIe,oIe="__lodash_hash_undefined__";function aIe(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Iy&&e===void 0?oIe:e,this}var lIe=aIe;function Mp(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Mp.prototype.clear=KLe;Mp.prototype.delete=ZLe;Mp.prototype.get=tIe;Mp.prototype.has=sIe;Mp.prototype.set=lIe;var nz=Mp;function cIe(){this.__data__=[],this.size=0}var uIe=cIe;function dIe(t,e){return t===e||t!==t&&e!==e}var hIe=dIe;function fIe(t,e){for(var n=t.length;n--;)if(hIe(t[n][0],e))return n;return-1}var Dx=fIe,pIe=Array.prototype,mIe=pIe.splice;function gIe(t){var e=this.__data__,n=Dx(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():mIe.call(e,n,1),--this.size,!0}var yIe=gIe;function vIe(t){var e=this.__data__,n=Dx(e,t);return n<0?void 0:e[n][1]}var _Ie=vIe;function bIe(t){return Dx(this.__data__,t)>-1}var xIe=bIe;function wIe(t,e){var n=this.__data__,r=Dx(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var TIe=wIe;function $p(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}$p.prototype.clear=uIe;$p.prototype.delete=yIe;$p.prototype.get=_Ie;$p.prototype.has=xIe;$p.prototype.set=TIe;var EIe=$p,SIe=FX(fk,"Map"),AIe=SIe;function PIe(){this.size=0,this.__data__={hash:new nz,map:new(AIe||EIe),string:new nz}}var CIe=PIe;function LIe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var IIe=LIe;function RIe(t,e){var n=t.__data__;return IIe(e)?n[typeof e=="string"?"string":"hash"]:n.map}var Fx=RIe;function MIe(t){var e=Fx(this,t).delete(t);return this.size-=e?1:0,e}var $Ie=MIe;function kIe(t){return Fx(this,t).get(t)}var OIe=kIe;function DIe(t){return Fx(this,t).has(t)}var FIe=DIe;function NIe(t,e){var n=Fx(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var zIe=NIe;function kp(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}kp.prototype.clear=CIe;kp.prototype.delete=$Ie;kp.prototype.get=OIe;kp.prototype.has=FIe;kp.prototype.set=zIe;var NX=kp,BIe="Expected a function";function pk(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(BIe);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var l=t.apply(this,r);return n.cache=s.set(i,l)||s,l};return n.cache=new(pk.Cache||NX),n}pk.Cache=NX;var UIe=pk,rz="__react_svg_text_measurement_id";function VIe(t,e){try{var n=document.getElementById(rz);if(!n){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.style.width=0,r.style.height=0,r.style.position="absolute",r.style.top="-100%",r.style.left="-100%",n=document.createElementNS("http://www.w3.org/2000/svg","text"),n.setAttribute("id",rz),r.appendChild(n),document.body.appendChild(r)}return Object.assign(n.style,e),n.textContent=t,n.getComputedTextLength()}catch{return null}}var iz=UIe(VIe,function(t,e){return t+"_"+JSON.stringify(e)}),jIe=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},GIe=function(){function t(e,n){for(var r=0;r<n.length;r++){var i=n[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),WIe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},HIe=function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},qIe=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},KIe=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:t},y1=function(t){HIe(e,t);function e(n){jIe(this,e);var r=KIe(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n));return r.state={wordsByLines:[]},r}return GIe(e,[{key:"componentWillMount",value:function(){this.updateWordsByLines(this.props,!0)}},{key:"componentWillReceiveProps",value:function(r){var i=this.props.children!==r.children||this.props.style!==r.style;this.updateWordsByLines(r,i)}},{key:"updateWordsByLines",value:function(r,i){if(r.width||r.scaleToFit){if(i){var s=r.children?r.children.toString().split(/\s+/):[];this.wordsWithComputedWidth=s.map(function(o){return{word:o,width:iz(o,r.style)}}),this.spaceWidth=iz("",r.style)}var l=this.calculateWordsByLines(this.wordsWithComputedWidth,this.spaceWidth,r.width);this.setState({wordsByLines:l})}else this.updateWordsWithoutCalculate(r)}},{key:"updateWordsWithoutCalculate",value:function(r){var i=r.children?r.children.toString().split(/\s+/):[];this.setState({wordsByLines:[{words:i}]})}},{key:"calculateWordsByLines",value:function(r,i,s){var l=this.props.scaleToFit;return r.reduce(function(o,h){var p=h.word,b=h.width,x=o[o.length-1];if(x&&(s==null||l||x.width+b+i<s))x.words.push(p),x.width+=b+i;else{var w={words:[p],width:b};o.push(w)}return o},[])}},{key:"render",value:function(){var r=this.props,i=r.dx,s=r.dy,l=r.textAnchor,o=r.verticalAnchor,h=r.scaleToFit,p=r.angle,b=r.lineHeight,x=r.capHeight,w=r.innerRef,A=qIe(r,["dx","dy","textAnchor","verticalAnchor","scaleToFit","angle","lineHeight","capHeight","innerRef"]),L=this.state.wordsByLines,M=A.x,U=A.y,D=void 0;switch(o){case"start":D=eE("calc("+x+")");break;case"middle":D=eE("calc("+(L.length-1)/2+" * -"+b+" + ("+x+" / 2))");break;default:D=eE("calc("+(L.length-1)+" * -"+b+")");break}var $=[];if(h&&L.length){var N=L[0].width,B=this.props.width/N,Z=B,ie=M-B*M,re=U-Z*U;$.push("matrix("+B+", 0, 0, "+Z+", "+ie+", "+re+")")}return p&&$.push("rotate("+p+", "+M+", "+U+")"),$.length&&(A.transform=$.join(" ")),le.createElement("svg",{ref:w,x:i,y:s,fontSize:A.fontSize,style:{overflow:"visible"}},le.createElement("text",WIe({},A,{textAnchor:l}),L.map(function(ve,Te){return le.createElement("tspan",{x:M,dy:Te===0?D:b,key:Te},ve.words.join(" "))})))}}]),e}(te.Component);y1.defaultProps={x:0,y:0,dx:0,dy:0,lineHeight:"1em",capHeight:"0.71em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end"};y1.propTypes={scaleToFit:O.bool,angle:O.number,textAnchor:O.oneOf(["start","middle","end","inherit"]),verticalAnchor:O.oneOf(["start","middle","end"]),style:O.object,innerRef:O.func,x:O.oneOfType([O.number,O.string]),y:O.oneOfType([O.number,O.string]),dx:O.oneOfType([O.number,O.string]),dy:O.oneOfType([O.number,O.string]),lineHeight:O.oneOfType([O.number,O.string]),capHeight:O.oneOfType([O.number,O.string])};function XIe(t){var e=t.bandwidth()/2;return t.round()&&(e=Math.round(e)),function(n){return t(n)+e}}function sz(t){return t}var Gi={top:"top",left:"left",right:"right",bottom:"bottom"};function ZIe(t){var e=t.labelOffset,n=t.labelProps,r=t.orientation,i=t.range,s=t.tickLabelFontSize,l=t.tickLength,o=r===Gi.left||r===Gi.top?-1:1,h=void 0,p=void 0,b=null;return r===Gi.top||r===Gi.bottom?(h=(i[0]+i[i.length-1])/2,p=o*(l+e+s+(r===Gi.bottom?n.fontSize:0))):(h=o*((i[0]+i[i.length-1])/2),p=-(l+e),b="rotate("+o*90+")"),{x:h,y:p,transform:b}}var nE=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},YIe={axisClassName:O.string,axisLineClassName:O.string,hideAxisLine:O.bool,hideTicks:O.bool,hideZero:O.bool,label:O.string,labelClassName:O.string,labelOffset:O.number,labelProps:O.object,left:O.number,numTicks:O.number,orientation:O.oneOf([Gi.top,Gi.right,Gi.bottom,Gi.left]),rangePadding:O.number,scale:O.func.isRequired,stroke:O.string,strokeWidth:O.number,strokeDasharray:O.string,tickClassName:O.string,tickFormat:O.func,tickLabelProps:O.func,tickLength:O.number,tickStroke:O.string,tickTransform:O.string,tickValues:O.array,tickComponent:O.func,top:O.number,children:O.func};function l0(t){var e=t.children,n=t.axisClassName,r=t.axisLineClassName,i=t.hideAxisLine,s=i===void 0?!1:i,l=t.hideTicks,o=l===void 0?!1:l,h=t.hideZero,p=h===void 0?!1:h,b=t.label,x=b===void 0?"":b,w=t.labelClassName,A=t.labelOffset,L=A===void 0?14:A,M=t.labelProps,U=M===void 0?{textAnchor:"middle",fontFamily:"Arial",fontSize:10,fill:"black"}:M,D=t.left,$=D===void 0?0:D,N=t.numTicks,B=N===void 0?10:N,Z=t.orientation,ie=Z===void 0?Gi.bottom:Z,re=t.rangePadding,ve=re===void 0?0:re,Te=t.scale,Ae=t.stroke,fe=Ae===void 0?"black":Ae,Pe=t.strokeWidth,_e=Pe===void 0?1:Pe,ke=t.strokeDasharray,Vt=t.tickClassName,ut=t.tickFormat,rn=t.tickLabelProps,ot=rn===void 0?function(vn,Nr){return{textAnchor:"middle",fontFamily:"Arial",fontSize:10,fill:"black"}}:rn,yt=t.tickLength,at=yt===void 0?8:yt,Mt=t.tickStroke,Re=Mt===void 0?"black":Mt,Ke=t.tickTransform,Je=t.tickValues,kt=t.tickComponent,ft=t.top,Pt=ft===void 0?0:ft,qt=Te.ticks?Te.ticks(B):Te.domain();Je&&(qt=Je);var lt=Te.tickFormat?Te.tickFormat():sz;ut&&(lt=ut);var tn=Te.range(),Fn=tn[0]+.5-ve,St=tn[tn.length-1]+.5+ve,bt=ie!==Gi.left&&ie!==Gi.right,hn=ie===Gi.left,ur=ie===Gi.top,On=hn||ur?-1:1,Ln=(Te.bandwidth?XIe:sz)(Te.copy()),is=new Vl({x:bt?Fn:0,y:bt?0:Fn}),dn=new Vl({x:bt?St:0,y:bt?0:St}),mr=10;return e?le.createElement(Nf,{className:Xo("vx-axis",n),top:Pt,left:$},e({axisFromPoint:is,axisToPoint:dn,horizontal:bt,tickSign:On,numTicks:B,label:x,rangePadding:ve,tickLength:at,tickFormat:lt,tickPosition:Ln,ticks:qt.map(function(vn,Nr){var bs=new Vl({x:bt?Ln(vn):0,y:bt?0:Ln(vn)}),Cr=new Vl({x:bt?Ln(vn):On*at,y:bt?at*On:Ln(vn)});return{value:vn,index:Nr,from:bs,to:Cr,formattedValue:lt(vn,Nr)}})})):le.createElement(Nf,{className:Xo("vx-axis",n),top:Pt,left:$},qt.map(function(vn,Nr){if(p&&vn===0)return null;var bs=new Vl({x:bt?Ln(vn):0,y:bt?0:Ln(vn)}),Cr=new Vl({x:bt?Ln(vn):On*at,y:bt?at*On:Ln(vn)}),ai=ot(vn,Nr);return mr=Math.max(mr,ai.fontSize||0),le.createElement(Nf,{key:"vx-tick-"+vn+"-"+Nr,className:Xo("vx-axis-tick",Vt),transform:Ke},!o&&le.createElement(gR,{from:bs,to:Cr,stroke:Re}),kt?kt(nE({x:Cr.x,y:Cr.y+(bt&&!ur?mr:0),formattedValue:lt(vn,Nr)},ai)):le.createElement(y1,nE({x:Cr.x,y:Cr.y+(bt&&!ur?mr:0)},ai),lt(vn,Nr)))}),!s&&le.createElement(gR,{className:Xo("vx-axis-line",r),from:is,to:dn,stroke:fe,strokeWidth:_e,strokeDasharray:ke}),x&&le.createElement(y1,nE({className:Xo("vx-axis-label",w)},ZIe({labelOffset:L,labelProps:U,orientation:ie,range:tn,tickLabelFontSize:mr,tickLength:at}),U),x))}l0.propTypes=YIe;var JIe={axisClassName:O.string,axisLineClassName:O.string,hideAxisLine:O.bool,hideTicks:O.bool,hideZero:O.bool,label:O.string,labelClassName:O.string,labelOffset:O.number,labelProps:O.object,left:O.number,numTicks:O.number,rangePadding:O.number,scale:O.func.isRequired,stroke:O.string,strokeWidth:O.number,strokeDasharray:O.string,tickClassName:O.string,tickFormat:O.func,tickLabelProps:O.func,tickLength:O.number,tickStroke:O.string,tickTransform:O.string,tickValues:O.array,tickComponent:O.func,top:O.number,children:O.func};function zX(t){var e=t.children,n=t.axisClassName,r=t.axisLineClassName,i=t.hideAxisLine,s=t.hideTicks,l=t.hideZero,o=t.label,h=t.labelClassName,p=t.labelOffset,b=p===void 0?36:p,x=t.labelProps,w=t.left,A=t.numTicks,L=t.rangePadding,M=t.scale,U=t.stroke,D=t.strokeWidth,$=t.strokeDasharray,N=t.tickClassName,B=t.tickFormat,Z=t.tickLabelProps,ie=Z===void 0?function(ke){return ke.tick,ke.index,{dx:"-0.25em",dy:"0.25em",fill:"black",fontFamily:"Arial",fontSize:10,textAnchor:"end"}}:Z,re=t.tickLength,ve=re===void 0?8:re,Te=t.tickStroke,Ae=t.tickTransform,fe=t.tickValues,Pe=t.tickComponent,_e=t.top;return le.createElement(l0,{axisClassName:Xo("vx-axis-left",n),axisLineClassName:r,hideAxisLine:i,hideTicks:s,hideZero:l,label:o,labelClassName:h,labelOffset:b,labelProps:x,left:w,numTicks:A,orientation:Gi.left,rangePadding:L,scale:M,stroke:U,strokeWidth:D,strokeDasharray:$,tickClassName:N,tickFormat:B,tickLabelProps:ie,tickLength:ve,tickStroke:Te,tickTransform:Ae,tickValues:fe,tickComponent:Pe,top:_e,children:e})}zX.propTypes=JIe;var QIe={axisClassName:O.string,axisLineClassName:O.string,hideAxisLine:O.bool,hideTicks:O.bool,hideZero:O.bool,label:O.string,labelClassName:O.string,labelOffset:O.number,labelProps:O.object,left:O.number,numTicks:O.number,rangePadding:O.number,scale:O.func.isRequired,stroke:O.string,strokeWidth:O.number,strokeDasharray:O.string,tickClassName:O.string,tickFormat:O.func,tickLabelProps:O.func,tickLength:O.number,tickStroke:O.string,tickTransform:O.string,tickValues:O.array,tickComponent:O.func,top:O.number,children:O.func};function BX(t){var e=t.children,n=t.axisClassName,r=t.axisLineClassName,i=t.hideAxisLine,s=t.hideTicks,l=t.hideZero,o=t.label,h=t.labelClassName,p=t.labelOffset,b=p===void 0?36:p,x=t.labelProps,w=t.left,A=t.numTicks,L=t.rangePadding,M=t.scale,U=t.stroke,D=t.strokeWidth,$=t.strokeDasharray,N=t.tickClassName,B=t.tickFormat,Z=t.tickLabelProps,ie=Z===void 0?function(ke){return ke.tick,ke.index,{dx:"0.25em",dy:"0.25em",fill:"black",fontFamily:"Arial",fontSize:10,textAnchor:"start"}}:Z,re=t.tickLength,ve=re===void 0?8:re,Te=t.tickStroke,Ae=t.tickTransform,fe=t.tickValues,Pe=t.tickComponent,_e=t.top;return le.createElement(l0,{axisClassName:Xo("vx-axis-right",n),axisLineClassName:r,hideAxisLine:i,hideTicks:s,hideZero:l,label:o,labelClassName:h,labelOffset:b,labelProps:x,left:w,numTicks:A,orientation:Gi.right,rangePadding:L,scale:M,stroke:U,strokeWidth:D,strokeDasharray:$,tickClassName:N,tickFormat:B,tickLabelProps:ie,tickLength:ve,tickStroke:Te,tickTransform:Ae,tickValues:fe,tickComponent:Pe,top:_e,children:e})}BX.propTypes=QIe;var e4e={axisClassName:O.string,axisLineClassName:O.string,hideAxisLine:O.bool,hideTicks:O.bool,hideZero:O.bool,label:O.string,labelClassName:O.string,labelOffset:O.number,labelProps:O.object,left:O.number,numTicks:O.number,rangePadding:O.number,scale:O.func.isRequired,stroke:O.string,strokeWidth:O.number,strokeDasharray:O.string,tickClassName:O.string,tickFormat:O.func,tickLabelProps:O.func,tickLength:O.number,tickStroke:O.string,tickTransform:O.string,tickValues:O.array,tickComponent:O.func,top:O.number,children:O.func};function UX(t){var e=t.children,n=t.axisClassName,r=t.axisLineClassName,i=t.hideAxisLine,s=t.hideTicks,l=t.hideZero,o=t.label,h=t.labelClassName,p=t.labelOffset,b=p===void 0?8:p,x=t.labelProps,w=t.left,A=t.numTicks,L=t.rangePadding,M=t.scale,U=t.stroke,D=t.strokeWidth,$=t.strokeDasharray,N=t.tickClassName,B=t.tickFormat,Z=t.tickLabelProps,ie=Z===void 0?function(ke){return ke.tick,ke.index,{dy:"-0.25em",fill:"black",fontFamily:"Arial",fontSize:10,textAnchor:"middle"}}:Z,re=t.tickLength,ve=re===void 0?8:re,Te=t.tickStroke,Ae=t.tickTransform,fe=t.tickValues,Pe=t.tickComponent,_e=t.top;return le.createElement(l0,{axisClassName:Xo("vx-axis-top",n),axisLineClassName:r,hideAxisLine:i,hideTicks:s,hideZero:l,label:o,labelClassName:h,labelOffset:b,labelProps:x,left:w,numTicks:A,orientation:Gi.top,rangePadding:L,scale:M,stroke:U,strokeWidth:D,strokeDasharray:$,tickClassName:N,tickFormat:B,tickLabelProps:ie,tickLength:ve,tickStroke:Te,tickTransform:Ae,tickValues:fe,tickComponent:Pe,top:_e,children:e})}UX.propTypes=e4e;var t4e={axisClassName:O.string,axisLineClassName:O.string,hideAxisLine:O.bool,hideTicks:O.bool,hideZero:O.bool,label:O.string,labelClassName:O.string,labelOffset:O.number,labelProps:O.object,left:O.number,numTicks:O.number,rangePadding:O.number,scale:O.func.isRequired,stroke:O.string,strokeWidth:O.number,strokeDasharray:O.string,tickClassName:O.string,tickFormat:O.func,tickLabelProps:O.func,tickLength:O.number,tickStroke:O.string,tickTransform:O.string,tickValues:O.array,tickComponent:O.func,top:O.number,children:O.func};function VX(t){var e=t.children,n=t.axisClassName,r=t.axisLineClassName,i=t.hideAxisLine,s=t.hideTicks,l=t.hideZero,o=t.label,h=t.labelClassName,p=t.labelOffset,b=p===void 0?8:p,x=t.labelProps,w=t.left,A=t.numTicks,L=t.rangePadding,M=t.scale,U=t.stroke,D=t.strokeWidth,$=t.strokeDasharray,N=t.tickClassName,B=t.tickFormat,Z=t.tickLabelProps,ie=Z===void 0?function(ke){return ke.tick,ke.index,{dy:"0.25em",fill:"black",fontFamily:"Arial",fontSize:10,textAnchor:"middle"}}:Z,re=t.tickLength,ve=re===void 0?8:re,Te=t.tickStroke,Ae=t.tickTransform,fe=t.tickValues,Pe=t.tickComponent,_e=t.top;return le.createElement(l0,{axisClassName:Xo("vx-axis-bottom",n),axisLineClassName:r,hideAxisLine:i,hideTicks:s,hideZero:l,label:o,labelClassName:h,labelOffset:b,labelProps:x,left:w,numTicks:A,orientation:Gi.bottom,rangePadding:L,scale:M,stroke:U,strokeWidth:D,strokeDasharray:$,tickClassName:N,tickFormat:B,tickLabelProps:ie,tickLength:ve,tickStroke:Te,tickTransform:Ae,tickValues:fe,tickComponent:Pe,top:_e,children:e})}VX.propTypes=t4e;var n4e={axisStyles:d1,label:O.oneOfType([O.string,O.element]),labelProps:O.object,numTicks:O.number,orientation:O.oneOf(["bottom","top"]),tickStyles:h1,tickLabelProps:O.func,tickFormat:O.func,tickValues:O.arrayOf(O.oneOfType([O.number,O.string])),top:O.number,left:O.number,scale:O.func},r4e={axisStyles:{},label:null,labelProps:null,left:0,numTicks:null,orientation:"bottom",scale:null,tickFormat:null,tickLabelProps:void 0,tickStyles:{},top:0,tickValues:void 0};function Nx(t){var e=t.axisStyles,n=t.label,r=t.labelProps,i=t.top,s=t.left,l=t.numTicks,o=t.orientation,h=t.scale,p=t.tickFormat,b=t.tickLabelProps,x=t.tickStyles,w=t.tickValues;if(!h)return null;var A=o==="bottom"?VX:UX,L=b;return L||(L=x.label&&x.label[o]?function(){return x.label[o]}:void 0),le.createElement(A,{top:i,left:s,hideTicks:!1,hideZero:!1,label:n,labelProps:r||(e.label||{})[o],numTicks:l,scale:h,stroke:e.stroke,strokeWidth:e.strokeWidth,tickFormat:p,tickLength:x.tickLength,tickLabelProps:L,tickStroke:x.stroke,tickValues:w})}Nx.propTypes=n4e;Nx.defaultProps=r4e;Nx.displayName="XAxis";var i4e={axisStyles:d1,label:O.string,labelProps:O.object,numTicks:O.number,orientation:O.oneOf(["left","right"]),tickStyles:h1,tickLabelProps:O.func,tickFormat:O.func,tickValues:O.arrayOf(O.oneOfType([O.number,O.string])),top:O.number,left:O.number,scale:O.func},s4e={axisStyles:{},label:null,labelProps:null,left:0,numTicks:5,orientation:"left",scale:null,tickFormat:null,tickLabelProps:void 0,tickStyles:{},tickValues:void 0,top:0};function zx(t){var e=t.axisStyles,n=t.label,r=t.labelProps,i=t.top,s=t.left,l=t.numTicks,o=t.orientation,h=t.scale,p=t.tickFormat,b=t.tickLabelProps,x=t.tickStyles,w=t.tickValues;if(!h)return null;var A=o==="left"?zX:BX,L=b;return L||(L=x.label&&x.label[o]?function(){return x.label[o]}:void 0),le.createElement(A,{top:i,left:s,hideTicks:!1,hideZero:!1,label:n,labelProps:r||(e.label||{})[o],numTicks:l,scale:h,stroke:e.stroke,strokeWidth:e.strokeWidth,tickFormat:p,tickLabelProps:L,tickLength:x.tickLength,tickStroke:x.stroke,tickValues:w})}zx.propTypes=i4e;zx.defaultProps=s4e;zx.displayName="YAxis";const o4e=()=>{const t=Ja(Dwe);return Yt.jsxs(KPe,{width:400,height:300,ariaLabel:"Group Size Distrobution",orientation:"vertical",cumulative:!1,normalized:!0,binCount:25,valueAccessor:e=>e,binType:"numeric",children:[Yt.jsx(Ox,{animated:!0,rawData:Object.values(t)}),Yt.jsx(Nx,{}),Yt.jsx(zx,{})]})},a4e=()=>{const t=Ja(Ej),[e,n]=oS(E$),r=t.map(i=>({id:`${i}`,name:`${i}`}));return Yt.jsx("div",{style:{width:"400px",height:"95vh",top:"2.5vh",left:"20px",position:"absolute",zIndex:1,backgroundColor:"white",boxSizing:"border-box",padding:"10px",boxShadow:"1px 1px 26px 2px rgba(0,0,0,0.75)"},children:Yt.jsxs(Ta,{direction:"column",gap:"size-200",children:[Yt.jsx(x3e,{}),Yt.jsx(cN,{size:"M",orientation:"horizontal"}),Yt.jsx(i1,{children:e!==null?Yt.jsxs(Ta,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[Yt.jsxs(wa,{children:["Selected Group : ",e]}),Yt.jsx(aEe,{onPress:()=>n(null),children:" Clear"})]}):Yt.jsx(wa,{children:"Select a group to see occupancy"})}),Yt.jsx(d3e,{width:"90%",label:"Select a group to view",defaultItems:r,selectedKey:e,onSelectionChange:i=>n(parseInt(i)),children:i=>Yt.jsx(Pj,{children:i.name},i.id)}),Yt.jsx(b3e,{}),Yt.jsx(cN,{size:"M",orientation:"horizontal"}),Yt.jsx(i1,{children:"Cluster Sizes"}),Yt.jsx(o4e,{})]})})},oz=({size:t,color:e})=>Yt.jsx("span",{style:{height:`${t}px`,width:`${t}px`,backgroundColor:`rgb(${e.join(",")})`,borderRadius:"50%",display:"inline-block"}}),l4e=({size:t,color:e})=>Yt.jsx("span",{style:{height:"5px",width:`${t}px`,backgroundColor:`rgb(${e.join(",")})`,borderRadius:"5px",display:"inline-block"}}),c4e=()=>Yt.jsx("div",{style:{width:"200px",height:"150px",bottom:"2.5vh",right:"20px",position:"absolute",zIndex:1,backgroundColor:"white",boxSizing:"border-box",padding:"10px",boxShadow:"1px 1px 26px 2px rgba(0,0,0,0.75)"},children:Yt.jsxs(Ta,{direction:"column",gap:"size-100",children:[Yt.jsx(i1,{children:"Legend"}),Yt.jsxs(Ta,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[Yt.jsx(oz,{size:25,color:Of.user}),Yt.jsx(wa,{children:"User"})]}),Yt.jsxs(Ta,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[Yt.jsx(oz,{size:25,color:Of.meetingPoint}),Yt.jsx(wa,{children:"Meeting Point"})]}),Yt.jsxs(Ta,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[Yt.jsx(l4e,{size:25,color:Of.groupBoundary}),Yt.jsx(wa,{children:"Group Region"})]})]})});function u4e(){return Yt.jsx(VG,{theme:_3e,children:Yt.jsx(Zoe,{children:Yt.jsxs(le.Suspense,{fallback:Yt.jsx("h1",{children:"Loading"}),children:[Yt.jsx(Bwe,{}),Yt.jsx(a4e,{}),Yt.jsx(c4e,{})]})})})}rE.createRoot(document.getElementById("root")).render(Yt.jsx(u4e,{}));export{MY as c};
